<!DOCTYPE html>
<html lang="en-us">
<title>从零开始用 Emacs 管理笔记 | Dump brain with Emacs</title>
<meta charset="utf-8">
<meta name="generator" content="Hugo 0.83.1" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="http://coldnight.github.io/dump-brain-with-emacs/css/index.css">
<link rel="canonical" href="http://coldnight.github.io/dump-brain-with-emacs/posts/dump-brain-with-emacs/">
<link rel="alternate" type="application/rss+xml" href="" title="Dump brain with Emacs">

<header>
  
    <a href="http://coldnight.github.io/dump-brain-with-emacs/" class="title">Dump brain with Emacs</a>
  
  
</header>

<article>
  <header>
    <h1>从零开始用 Emacs 管理笔记</h1>
    <time datetime="2021-07-28T00:00:00Z">July 28, 2021</time>
  </header>
  <!-- raw HTML omitted -->
<p>其他入门教程：</p>
<ul>
<li><a href="https://github.com/redguardtoo/mastering-emacs-in-one-year-guide">一年成为Emacs高手 (像神一样使用编辑器)</a></li>
<li><a href="https://github.com/w0mTea/An.Emacs.Tutorial.for.Vim.User">An Emacs Tutorial for Vim User</a></li>
<li><a href="https://book.emacs-china.org/">Master Emacs in 21 Days</a></li>
</ul>
<h2 id="前言">前言</h2>
<p>不同于其他 Emacs 教程，本文着重于从零开始通过 Emacs 做笔记管理，这样做的好处如下：</p>
<ul>
<li>不着眼于替换你现在的编辑器或者 IDE 避免降低工作效率；</li>
<li>org-mode 是一种非常具有表达力的文档标记格式，并且配合 org-babel 可以执行代码块保存实验结果（类似 Jupyter Notebook）；</li>
<li><a href="https://github.com/org-roam/org-roam">org-roam</a> 基于 org-mode 实现 Roam Research<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup><!-- raw HTML omitted -->, <!-- raw HTML omitted --><sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup> 的方式进行先进的笔记管理；</li>
<li>在 GitHub 上进行免费托管和发布（<a href="#%E5%8F%91%E5%B8%83-github-pages">发布 GitHub Pages</a>）。</li>
</ul>
<p>也许通过记录笔记你会爱上 Emacs 并开始慢慢掌握它，将它作为主要编辑器！</p>
<h2 id="安装-启动-退出">安装、启动、退出</h2>
<p>目前（2021-07-29）最新稳定版是 27.2，主线版本 Emacs 28 并且已经合并了 Native Comp，我日常使用的就是编译了 Native Comp 的主线版本。</p>
<p>我们这里选择最新的稳定版本 27.2。</p>
<h3 id="linux">Linux</h3>
<ul>
<li>
<p>yum（CentOS/RHEL/Fedora）</p>
<pre><code class="language-nil" data-lang="nil">
</code></pre></li>
<li>
<p>apt（Debian/Ubuntu）</p>
<pre><code class="language-nil" data-lang="nil">
</code></pre></li>
<li>
<p>pacman（Archlinux）</p>
</li>
</ul>
<h3 id="macos">macOS</h3>
<p>macOS 默认安装了 Emacs，但是版本比较低，建议大家从社区安装最新版。我之前比较常用的是 emacs-mac 这个版本，可以通过 <a href="https://brew.sh/">Homebrew</a> 安装：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ brew tap railwaycat/emacsmacport
$ brew install emacs-mac
</code></pre></div><p>然后在终端里通过以下命令打开 Emacs：</p>
<pre><code class="language-nil" data-lang="nil">$ open -a /usr/local/opt/emacs-mac/Emacs.app/
</code></pre><h3 id="windows">Windows</h3>
<p>可以通过 Powershell 和 <a href="https://chocolatey.org/">Chocolatey</a><sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup> 安装：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">PS&gt; choco install emacs-full
</code></pre></div><p>安装后可以在 Powershell 中启动 Emacs：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">PS&gt; emacs
</code></pre></div><h3 id="退出-emacs">退出 Emacs</h3>
<p>快捷键按 <code>C-x C-c</code> （就是按住 <code>Ctrl</code> 不松开继续按 <code>x</code> ，然后再按住 <code>Ctrl</code> 不松开继续按 <code>c</code> ，聪明的你肯定发现只要按住 <code>Ctrl</code> 不松开依次按 <code>x</code> 和 <code>c</code> 键就可以了）。</p>
<h2 id="黑话">黑话</h2>
<p>Emacs 诞生的时间比较早，有些概念也是很早就确定了，带着时代的气息，可能不是很好理解。所以为了便于大家理解，我们在此提前进行解释，大家遇到不懂的可以随时翻回来查看:</p>
<h3 id="快捷键">快捷键</h3>
<table>
<thead>
<tr>
<th>黑话</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>C-c</code></td>
<td>按住 <code>Ctrl</code> 不松开然后按 <code>c</code></td>
</tr>
<tr>
<td><code>C-x b</code></td>
<td>按住 <code>Ctrl</code> 不松开按 <code>x</code>, 然后松开以上按键后再按 <code>b</code></td>
</tr>
<tr>
<td><code>C-x C-c</code> <sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup></td>
<td>组合快捷键，你需要先按出 <code>C-x</code> ，然后继续按出 <code>Ctrl-c</code> ，两段快捷键中间可以间隔任意时间</td>
</tr>
<tr>
<td><code>C-g</code></td>
<td>假如你快捷键按到一半想要放弃，可以通过这个快捷键放弃。（当然不仅是放弃快捷键，很多操作都可以通过这个快捷键终止）</td>
</tr>
<tr>
<td><code>M-x</code></td>
<td><code>Meta</code> + <code>c</code> ，Meta 键一般意味着 Alt 或者 ESC</td>
</tr>
<tr>
<td><code>s-l</code></td>
<td><code>Super</code> + <code>l</code> , Super 键现在比较少见，可以通过 <code>C-x @-s</code> 按出 <code>s-</code> 前缀，所以这个完整的快捷键是 <code>C-x @-s l</code></td>
</tr>
<tr>
<td><code>M-x org-id-get-create RET</code></td>
<td><code>M-x</code> 会弹出命令输出框，然后输入 <code>org-id-get-create</code> 按回车（ <code>RET</code> 表示回车）</td>
</tr>
</tbody>
</table>
<h3 id="概念">概念</h3>
<table>
<thead>
<tr>
<th>黑话</th>
<th>解释</th>
</tr>
</thead>
<tbody>
<tr>
<td>frame</td>
<td>图形界面的窗口：通过 <code>C-x 5 2</code> 创建一个试试，然后 <code>C-x 5 0</code> 关闭</td>
</tr>
<tr>
<td>window</td>
<td>分割面板：通过 <code>C-x 2</code> 水平分割， <code>C-x 3</code> 垂直分割， <code>C-x o</code> 切换面板， <code>C-x 0</code> 关闭当前面板</td>
</tr>
<tr>
<td>face</td>
<td>文本显示方式，字体等</td>
</tr>
<tr>
<td>fringe</td>
<td>分割面板的边缘</td>
</tr>
<tr>
<td>kill</td>
<td>剪切， <code>C-k</code> 剪切光标后面到行尾</td>
</tr>
<tr>
<td>kill-ring</td>
<td>剪切板，可以保存多个，可以通过 <code>M-y</code> 选择</td>
</tr>
<tr>
<td>mode-line</td>
<td>窗口底部的一个显示状态的横条</td>
</tr>
<tr>
<td>minibuffers</td>
<td>mode-line 下面的消息回显区，同时某些命令下输入区也会在这</td>
</tr>
</tbody>
</table>
<h3 id="buffer">buffer</h3>
<p>这个可能和大多数编辑器不太一样，Emacs 突出了 buffer 的语义，从而弱化了编辑文件语义，比如在其他编辑器或者 IDE 你可能是想的切换编辑文件，
但是 Emacs 更突出了是切换到对应的 buffer（ <code>C-x b</code> ） 编辑，而后通过 <code>C-x C-s</code> 将 buffer 的内容保存到文件中（如果是生成的 buffer 则会提示选择要保存的文件名）。</p>
<p>同时 Emacs 有很多临时的 buffer 来充当日志的角色，比如默认的 <code>*Messages*</code> (<code>C-x b *Messages* RET</code>) 就是一个只读 buffer 显示一些日志信息，某些操作失败了之后也会保存一些错误消息到指定的 buffer 中，我们只要切换过去就能看到。</p>
<h2 id="基本增强">基本增强</h2>
<p>默认安装的 Emacs 可以说是又丑又不好用，所以为了使用更加顺畅或者更贴合现代编辑器，我们需要修改一些配置并做一些插件的扩展。</p>
<figure><img src="/dump-brain-with-emacs/ox-hugo/00-installation.png"/>
</figure>

<h3 id="创建配置文件">创建配置文件</h3>
<p>Emacs 的配置文件都写在 <code>$HOME/.emacs.d/init.el</code> 中，其中 <code>$HOME</code> 就是用户的家目录，对应到不同的系统位置会有细微的差异：</p>
<ul>
<li>
<p>Linux 或者 macOS:</p>
<pre><code class="language-nil" data-lang="nil">mkdir ~/.emacs.d/
touch ~/.emacs.d/init.el
</code></pre></li>
<li>
<p>Windows: C:/Users/<!-- raw HTML omitted -->/AppData/Roaming/.emacs.d/init.el（这个目录很深，而且默认状态下AppData目录是隐藏的。）<sup id="fnref:5"><a href="#fn:5" class="footnote-ref" role="doc-noteref">5</a></sup></p>
</li>
</ul>
<h3 id="共享系统剪切板">共享系统剪切板</h3>
<p>默认 Emacs 的剪切板和系统是不共享的，也就是说下面的配置你可能没有办法粘贴到 Emacs 中，这给我们抄配置或者记笔记带来了很大的困扰，
所以我们先配置 Emacs 和系统共享剪切板。</p>
<p>打开上面新创建的 <code>init.el</code> 配置文件（当然，用你熟悉的那个编辑器），追加如下内容：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-elisp" data-lang="elisp"><span style="color:#75715e">;; 系统共享剪切板</span>
<span style="color:#75715e">;; see also:</span>
<span style="color:#75715e">;;   https://www.emacswiki.org/emacs/CopyAndPaste</span>
<span style="color:#75715e">;;   https://www.reddit.com/r/emacs/comments/5n9t3f/copypaste_from_system_clipboard_on_windows/</span>
(defun copy-from-osx ()
  (shell-command-to-string <span style="color:#e6db74">&#34;pbpaste&#34;</span>))

(defun paste-to-osx (text <span style="color:#66d9ef">&amp;optional</span> push)
  (let ((process-connection-type <span style="color:#66d9ef">nil</span>))
    (let ((proc (<span style="color:#a6e22e">start-process</span> <span style="color:#e6db74">&#34;pbcopy&#34;</span> <span style="color:#e6db74">&#34;*Messages*&#34;</span> <span style="color:#e6db74">&#34;pbcopy&#34;</span>)))
      (<span style="color:#a6e22e">process-send-string</span> proc text)
      (<span style="color:#a6e22e">process-send-eof</span> proc))))

(cond
 ((<span style="color:#a6e22e">memq</span> <span style="color:#a6e22e">window-system</span> <span style="color:#f92672">&#39;</span>(x))
  (setq x-select-enable-primary <span style="color:#66d9ef">t</span>
        x-select-enable-clipboard <span style="color:#66d9ef">nil</span>))
 ((<span style="color:#a6e22e">memq</span> <span style="color:#a6e22e">window-system</span> <span style="color:#f92672">&#39;</span>(mac ns))
  (setq interprogram-cut-function <span style="color:#e6db74">&#39;paste-to-osx</span>
        interprogram-paste-function <span style="color:#e6db74">&#39;copy-from-osx</span>))
 ((<span style="color:#a6e22e">memq</span> <span style="color:#a6e22e">window-system</span> <span style="color:#f92672">&#39;</span>(win32 pc))
  (setq select-enable-primary <span style="color:#66d9ef">t</span>
        select-enable-clipboard <span style="color:#66d9ef">t</span>
        save-interprogram-paste-before-kill <span style="color:#66d9ef">t</span>)))
</code></pre></div><h3 id="基本配置">基本配置</h3>
<p>此时我们打开 Emacs 进行如下操作，按下 <code>C-x C-f ~/.emacs.d/init.el RET</code> 打开 Emacs 配置文件，接下来将下面的配置内容粘贴进来，建议操作：</p>
<ol>
<li>首先拷贝下面内容，然后在 <code>init.el</code> buffer 里（ <code>C-x b init.el RET</code> 可以切换过来，如果当前不是那个 buffer 的话）</li>
<li><code>M-.</code> 切换到文件末尾</li>
<li><code>C-y</code> 进行粘贴</li>
</ol>
<p>（大家记住上面这些操作，下面所有追加配置内容都可以这样操作！）</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-elisp" data-lang="elisp"><span style="color:#75715e">;; 指定自定义配置文件，防止自定义配置污染 init.el，并加载该配置文件</span>
(setq custom-file (<span style="color:#a6e22e">expand-file-name</span> <span style="color:#e6db74">&#34;~/.emacs.d/custom.el&#34;</span>))
(if (<span style="color:#a6e22e">file-exists-p</span> custom-file)
    (<span style="color:#a6e22e">load</span> custom-file))

<span style="color:#75715e">;; Font</span>
<span style="color:#75715e">;; Download Victor Mono at https://rubjo.github.io/victor-mono/</span>
(set-face-attribute <span style="color:#e6db74">&#39;default</span> <span style="color:#66d9ef">nil</span>
                    :family <span style="color:#e6db74">&#34;Victor Mono&#34;</span> :height <span style="color:#ae81ff">145</span> :weight <span style="color:#e6db74">&#39;normal</span>)
<span style="color:#75715e">;; 中文显示</span>
(set-language-environment <span style="color:#e6db74">&#34;utf-8&#34;</span>)
(set-buffer-file-coding-system <span style="color:#e6db74">&#39;utf-8</span>)
(set-terminal-coding-system <span style="color:#e6db74">&#39;utf-8</span>)
(set-keyboard-coding-system <span style="color:#e6db74">&#39;utf-8</span>)
(set-selection-coding-system <span style="color:#e6db74">&#39;utf-8</span>)
(set-default-coding-systems <span style="color:#e6db74">&#39;utf-8</span>)
(set-clipboard-coding-system <span style="color:#e6db74">&#39;utf-8</span>)
(modify-coding-system-alist <span style="color:#e6db74">&#39;process</span> <span style="color:#e6db74">&#34;*&#34;</span> <span style="color:#e6db74">&#39;utf-8</span>)
(prefer-coding-system <span style="color:#e6db74">&#39;utf-8</span>)
(setq-default pathname-coding-system <span style="color:#e6db74">&#39;utf-8</span>)
(setq
 default-process-coding-system <span style="color:#f92672">&#39;</span>(utf-8 <span style="color:#f92672">.</span> utf-8)
 locale-coding-system <span style="color:#e6db74">&#39;utf-8</span>
 file-name-coding-system <span style="color:#e6db74">&#39;utf-8</span>
 default-buffer-file-coding-system <span style="color:#e6db74">&#39;utf-8</span>
 slime-net-coding-system <span style="color:#e6db74">&#39;utf-8-unix</span>)

(setenv <span style="color:#e6db74">&#34;LC_CTYPE&#34;</span> <span style="color:#e6db74">&#34;UTF-8&#34;</span>)
(setenv <span style="color:#e6db74">&#34;LC_ALL&#34;</span> <span style="color:#e6db74">&#34;en_US.UTF-8&#34;</span>)
(setenv <span style="color:#e6db74">&#34;LANG&#34;</span> <span style="color:#e6db74">&#34;en_US.UTF-8&#34;</span>)                           <span style="color:#75715e">; Iterate through CamelCase words</span>

<span style="color:#75715e">;; 基本设置</span>
(setq-default
 indicate-buffer-boundaries <span style="color:#e6db74">&#39;left</span> <span style="color:#75715e">;; 在窗口边缘上显示一个小箭头指示当前 buffer 的边界</span>
 delete-by-moving-to-trash <span style="color:#66d9ef">t</span>                      <span style="color:#75715e">;; 删除文件移动到垃圾箱</span>
 window-combination-resize <span style="color:#66d9ef">t</span>                      <span style="color:#75715e">;; 新窗口平均其他左右窗口</span>
 x-stretch-cursor <span style="color:#66d9ef">t</span>                               <span style="color:#75715e">;; 将光标拉伸到字形宽度</span>
 kill-whole-line <span style="color:#66d9ef">t</span>)  <span style="color:#75715e">;; C-k时,同时删除该行</span>

(setq
 fringes-outside-margins <span style="color:#66d9ef">t</span>   <span style="color:#75715e">;; fringe 放在外面</span>
 echo-keystrokes <span style="color:#ae81ff">0.1</span>         <span style="color:#75715e">;; 尽快显示按键序列</span>
 system-time-locale <span style="color:#e6db74">&#34;zh_CN&#34;</span>  <span style="color:#75715e">;; 设置系统时间显示格式</span>
 tab-always-indent <span style="color:#e6db74">&#39;complete</span> <span style="color:#75715e">;; Tab 键优先格式化再补全</span>
 font-lock-global-modes <span style="color:#f92672">&#39;</span>(not shell-mode text-mode) <span style="color:#75715e">;; 设置语法高亮.除shell-mode和text-mode之外的模式</span>
 mouse-yank-at-point <span style="color:#66d9ef">t</span>       <span style="color:#75715e">;; 不在鼠标点击的地方插入剪贴板内容</span>
 kill-ring-max <span style="color:#ae81ff">200</span>           <span style="color:#75715e">;; 设置 kill ring 个数</span>
 default-fill-column <span style="color:#ae81ff">60</span>      <span style="color:#75715e">;; 把fill-column设为60.让文字更好读</span>
 enable-recursive-minibuffers <span style="color:#66d9ef">t</span>  <span style="color:#75715e">;; 递归的使用minibuffer</span>
 scroll-margin <span style="color:#ae81ff">3</span>             <span style="color:#75715e">;; 在靠近屏幕边沿 3 行时就开始滚动,可很好看到上下文</span>
 scroll-conservatively <span style="color:#ae81ff">10000</span> <span style="color:#75715e">;; 防止页面滚动时跳动</span>
 select-enable-clipboard <span style="color:#66d9ef">t</span>   <span style="color:#75715e">;; 允许emacs和外部程序进行粘贴</span>
 track-eol <span style="color:#66d9ef">t</span>                 <span style="color:#75715e">;; 当光标在行尾上下移动的时候,始终保持在行尾</span>
 next-line-add-newlines <span style="color:#66d9ef">nil</span>  <span style="color:#75715e">;; 按C-n或down时不添加新行</span>
 <span style="color:#75715e">;; emacs启动时显示的内容可以通过变量initial-scratch-message来设置</span>
 initial-scratch-message <span style="color:#66d9ef">nil</span>
 dired-listing-switches <span style="color:#e6db74">&#34;-vha&#34;</span> <span style="color:#75715e">;;  dired 列出文件的参数（man ls）</span>
 show-paren-style <span style="color:#e6db74">&#39;parenthesis</span> <span style="color:#75715e">;; 括号匹配时高亮显示另一边的括号，而不是跳到另一个括号处</span>
 undo-limit <span style="color:#ae81ff">80000000</span>           <span style="color:#75715e">;; 提升撤销限制</span>
 auto-save-default <span style="color:#66d9ef">t</span>           <span style="color:#75715e">;; 打开自动保存</span>
 truncate-string-ellipsis <span style="color:#e6db74">&#34;…&#34;</span>  <span style="color:#75715e">;; Unicode ellispis are nicer than &#34;...&#34;, and also save /precious/ space</span>
 <span style="color:#75715e">;; 当寻找一个同名的文件,改变两个buffer的名字,前面加上目录名</span>
 uniquify-buffer-name-style <span style="color:#e6db74">&#39;post-forward-angle-brackets</span>)
(if (display-graphic-p)
    (progn
      (menu-bar-mode <span style="color:#ae81ff">-1</span>)            <span style="color:#75715e">;; 取消菜单栏</span>
      (scroll-bar-mode <span style="color:#ae81ff">-1</span>)          <span style="color:#75715e">;; 取消滚动条（在 Emacs 26 中无效）</span>
      (tool-bar-mode <span style="color:#ae81ff">-1</span>)))          <span style="color:#75715e">;; 取消工具栏</span>
(<span style="color:#a6e22e">fset</span> <span style="color:#e6db74">&#39;yes-or-no-p</span> <span style="color:#e6db74">&#39;y-or-n-p</span>) <span style="color:#75715e">;; 按y或space表示yes,n表示no</span>
(global-font-lock-mode <span style="color:#66d9ef">t</span>)     <span style="color:#75715e">;; 语法高亮</span>
(show-paren-mode <span style="color:#66d9ef">t</span>)           <span style="color:#75715e">;; 打开括号匹配显示模式</span>
(mouse-avoidance-mode <span style="color:#e6db74">&#39;animate</span>) <span style="color:#75715e">;; 鼠标靠近光标指针时,让鼠标自动让开</span>
(auto-compression-mode <span style="color:#ae81ff">1</span>) <span style="color:#75715e">;; 打开压缩文件时自动解压缩</span>
(global-auto-revert-mode <span style="color:#ae81ff">1</span>)       <span style="color:#75715e">;; 自动重载更改的文件</span>
(blink-cursor-mode <span style="color:#ae81ff">-1</span>)            <span style="color:#75715e">;; 指针不要闪</span>
(toggle-truncate-lines <span style="color:#66d9ef">t</span>)         <span style="color:#75715e">;; 当一行文字太长时,不自动换行</span>
(column-number-mode <span style="color:#66d9ef">t</span>)            <span style="color:#75715e">;; 在minibuffer上面的状态栏显示文件的行号,列号</span>
(line-number-mode <span style="color:#66d9ef">t</span>)              <span style="color:#75715e">;;设定显示文件的参数,以版本/人性化的显示,就是ls的参数</span>
(global-linum-mode <span style="color:#66d9ef">t</span>)             <span style="color:#75715e">;; 显示行号</span>
(require <span style="color:#e6db74">&#39;saveplace</span>)
(save-place-mode <span style="color:#ae81ff">1</span>)               <span style="color:#75715e">;; 记住上次打开文件光标的位置</span>
(global-subword-mode <span style="color:#ae81ff">1</span>)           <span style="color:#75715e">;; 拆分连字符：oneWord 会被当作两个单词处理</span>

<span style="color:#75715e">;; 设置4个空格缩进</span>
(setq-default indent-tabs-mode <span style="color:#66d9ef">nil</span>)
(setq tab-width <span style="color:#ae81ff">4</span>) <span style="color:#75715e">; or any other preferred value</span>

<span style="color:#75715e">;; 时间显示设置</span>
(display-time-mode <span style="color:#ae81ff">1</span>)   <span style="color:#75715e">;; 启用时间显示设置,在minibuffer上面的那个杠上</span>
(setq display-time-24hr-format <span style="color:#66d9ef">t</span>   <span style="color:#75715e">;; 时间使用24小时制</span>
      display-time-day-and-date <span style="color:#66d9ef">t</span>   <span style="color:#75715e">;; 时间显示包括日期和具体时间</span>
      display-time-use-mail-icon <span style="color:#66d9ef">t</span>   <span style="color:#75715e">;; 时间栏旁边启用邮件设置</span>
      display-time-interval <span style="color:#ae81ff">10</span>   <span style="color:#75715e">;; 时间的变化频率</span>
      display-time-format <span style="color:#e6db74">&#34;%A %H:%M&#34;</span>)   <span style="color:#75715e">;; 显示时间的格式</span>

(unless (string-match-p <span style="color:#e6db74">&#34;^Power N/A&#34;</span> (battery))   <span style="color:#75715e">; 笔记本上显示电量</span>
  (display-battery-mode <span style="color:#ae81ff">1</span>))
</code></pre></div><p>此时我们可以运行当前 buffer 让配置生效： <code>M-x eval-buffer RET</code> ，然后通过 <code>C-x C-s</code> 进行保存。
此时效果如下：</p>
<figure><img src="/dump-brain-with-emacs/ox-hugo/01-basic.png"/>
</figure>

<p>对比上面可以看到中间灰色的就是 mode-line，其上面增加显示了时间、电量，并且去掉了菜单栏滚动条等，并且在左边显示了行号。同时我觉得有必要解释下 mode-line 各个部分的值：</p>
<ul>
<li><code>U:**-</code> 可以简单的理解为 U 表示编码系统（UTF-8）， <code>**</code> 表示 buffer 更改（未保存）<sup id="fnref:6"><a href="#fn:6" class="footnote-ref" role="doc-noteref">6</a></sup></li>
<li><code>Bot(100,27)</code> 表示光标位置 Bot 即 Bottom 的缩写，即 Bottom(row,column) 。</li>
<li><code>(Emacs-Lisp, ElDoc)</code> 表示当前 buffer 的主模式和次模式（主模式只能有一个，但是次模式可以有多个）。</li>
</ul>
<h3 id="插件包管理">插件包管理</h3>
<p>Emacs 安装插件的方式多种多样，一般可以：</p>
<ul>
<li>简单粗暴：直接拷贝 elisp 文件到指定位置；</li>
<li>内置的 package.el 可以安装 <a href="https://melpa.org/#/getting-started">MELPA</a> 的包。</li>
<li><a href="https://github.com/dimitri/el-get">el-get</a> 可以支持多种源，如 MELPA、EmacsWiki、GitHub 等等</li>
<li><a href="https://github.com/raxod502/straight.el">straight.el</a> 同样支持很多种源，并集成了 el-get 的源，同时还支持版本锁定、集成 <code>use-package</code> 、指向 fork、本地修改等。</li>
</ul>
<p>这里我们就以 <code>use-package</code> + <code>straight.el</code> 作为我们的插件包管理方案。<sup id="fnref:7"><a href="#fn:7" class="footnote-ref" role="doc-noteref">7</a></sup></p>
<p>为了启动整个包管理世界，我们需要先安装包管理，手动的安装：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ cd ~/.emacs.d/
$ git clone git@github.com:jwiegley/use-package.git
$ git clone git@github.com:raxod502/straight.el.git straight/repos/straight.el
</code></pre></div><p>然后在 <code>init.el</code> 中追加下面配置内容：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-elisp" data-lang="elisp"><span style="color:#75715e">;; use package</span>
(eval-when-compile
  (add-to-list <span style="color:#e6db74">&#39;load-path</span> <span style="color:#e6db74">&#34;~/.emacs.d/use-package&#34;</span>)
  (require <span style="color:#e6db74">&#39;use-package</span>))

<span style="color:#75715e">;; straight.el to manage package</span>
(defvar bootstrap-version)
(let ((bootstrap-file
       (<span style="color:#a6e22e">expand-file-name</span> <span style="color:#e6db74">&#34;straight/repos/straight.el/bootstrap.el&#34;</span> user-emacs-directory))
      (bootstrap-version <span style="color:#ae81ff">5</span>))
  (unless (<span style="color:#a6e22e">file-exists-p</span> bootstrap-file)
    (with-current-buffer
        (url-retrieve-synchronously
         <span style="color:#e6db74">&#34;https://raw.githubusercontent.com/raxod502/straight.el/develop/install.el&#34;</span>
         <span style="color:#e6db74">&#39;silent</span> <span style="color:#e6db74">&#39;inhibit-cookies</span>)
      (<span style="color:#a6e22e">goto-char</span> (<span style="color:#a6e22e">point-max</span>))
      (eval-print-last-sexp)))
  (<span style="color:#a6e22e">load</span> bootstrap-file <span style="color:#66d9ef">nil</span> <span style="color:#e6db74">&#39;nomessage</span>))
</code></pre></div><p>然后我们开始执行当前 buffer： <code>M-x eval-buffer RET</code> ，然后 straight.el 就会开始同步源：
<img src="/dump-brain-with-emacs/ox-hugo/02-package.png" alt=""></p>
<h3 id="外观">外观</h3>
<p>经过漫长的等待之后，我们终于可以进行下一步了：美化！我们将安装配置以下插件：</p>
<ul>
<li>doom-theme</li>
<li>doom-modeline</li>
<li>nyan-mode</li>
<li>all-the-icons</li>
<li>emojify</li>
<li>dashboard</li>
<li>centaur-tabs</li>
</ul>
<p>将以下配置追加到 <code>init.el</code> 中：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-elisp" data-lang="elisp"><span style="color:#75715e">;;; Appearance</span>
(use-package doom-themes
  :ensure <span style="color:#66d9ef">t</span>
  :straight (doom-themes :host github :repo <span style="color:#e6db74">&#34;hlissner/emacs-doom-themes&#34;</span>
                         :files (<span style="color:#e6db74">&#34;*.el&#34;</span> <span style="color:#e6db74">&#34;themes&#34;</span>))
  :init
  <span style="color:#75715e">;; Global settings (defaults)</span>
  (setq doom-themes-enable-bold <span style="color:#66d9ef">t</span>    <span style="color:#75715e">; if nil, bold is universally disabled</span>
        doom-themes-enable-italic <span style="color:#66d9ef">t</span>) <span style="color:#75715e">; if nil, italics is universally disabled</span>
  <span style="color:#75715e">;; Load the theme (doom-one, doom-molokai, etc); keep in mind that each theme</span>
  <span style="color:#75715e">;; may have their own settings.</span>
  <span style="color:#75715e">;; (load-theme &#39;doom-nord t)</span>
  (load-theme <span style="color:#e6db74">&#39;doom-vibrant</span> <span style="color:#66d9ef">t</span>)

  <span style="color:#75715e">;; Enable flashing mode-line on errors</span>
  (doom-themes-visual-bell-config)

  <span style="color:#75715e">;; Enable custom neotree theme</span>
  (doom-themes-neotree-config)  <span style="color:#75715e">; all-the-icons fonts must be installed!</span>

  <span style="color:#75715e">;; Corrects (and improves) org-mode&#39;s native fontification.</span>
  (doom-themes-org-config))

(use-package doom-modeline
  :straight <span style="color:#66d9ef">t</span>
  :after nyan-mode
  :custom
  (doom-modeline-mu4e <span style="color:#66d9ef">nil</span>)
  (doom-modeline-gnus <span style="color:#66d9ef">nil</span>)
  (doom-modeline-buffer-file-name-style <span style="color:#e6db74">&#39;truncate-all</span>)
  :init
  (doom-modeline-mode <span style="color:#ae81ff">1</span>))

(use-package nyan-mode
  :straight <span style="color:#66d9ef">t</span>
  :init
  (nyan-mode <span style="color:#ae81ff">1</span>))

(use-package emojify
  :straight (emojify :host github :repo <span style="color:#e6db74">&#34;iqbalansari/emacs-emojify&#34;</span>
                     :files (<span style="color:#e6db74">&#34;*.el&#34;</span> <span style="color:#e6db74">&#34;data&#34;</span>))
  :hook
  (after-init <span style="color:#f92672">.</span> global-emojify-mode)
  :init
  (setq emojify-emoji-styles <span style="color:#f92672">&#39;</span>(unicode github)))

(use-package dashboard
  :straight (dashboard :host github :repo <span style="color:#e6db74">&#34;emacs-dashboard/emacs-dashboard&#34;</span>
                       :files (<span style="color:#e6db74">&#34;*.el&#34;</span> <span style="color:#e6db74">&#34;banners&#34;</span>))
  :custom
  (dashboard-center-content <span style="color:#ae81ff">1</span>)
  (dashboard-set-heading-icons <span style="color:#66d9ef">t</span>)
  (dashboard-set-file-icons <span style="color:#66d9ef">t</span>)
  (dashboard-items <span style="color:#f92672">&#39;</span>((projects <span style="color:#f92672">.</span> <span style="color:#ae81ff">5</span>)
                     (recents <span style="color:#f92672">.</span> <span style="color:#ae81ff">5</span>)
                     (agenda <span style="color:#f92672">.</span> <span style="color:#ae81ff">5</span>)
                     (registers <span style="color:#f92672">.</span> <span style="color:#ae81ff">5</span>)))
  :init
  (dashboard-setup-startup-hook)
  (setq initial-buffer-choice (lambda () (<span style="color:#a6e22e">get-buffer</span> <span style="color:#e6db74">&#34;*dashboard*&#34;</span>))))

(use-package all-the-icons :straight <span style="color:#66d9ef">t</span>)

(use-package centaur-tabs
  :straight <span style="color:#66d9ef">t</span>
  :demand
  :config
  (centaur-tabs-mode <span style="color:#66d9ef">t</span>)
  :custom
  (centaur-tabs-set-icons <span style="color:#66d9ef">t</span>)
  (centaur-tabs-style <span style="color:#e6db74">&#34;wave&#34;</span>)
  :bind
  (<span style="color:#e6db74">&#34;C-c t p&#34;</span> <span style="color:#f92672">.</span> centaur-tabs-backward)
  (<span style="color:#e6db74">&#34;C-c t n&#34;</span> <span style="color:#f92672">.</span> centaur-tabs-forward))
</code></pre></div><p>又是一次漫长的等待！</p>
<figure><img src="/dump-brain-with-emacs/ox-hugo/03-install-pretty.png"/>
</figure>

<p>好了，现在我们还需要安装一下 <code>all-the-icons</code> 的字体： <code>M-x all-the-icons-install-fonts RET</code> 。现在再看我们的 Emacs：</p>
<figure><img src="/dump-brain-with-emacs/ox-hugo/04-pretty.png"/>
</figure>

<p>是不是漂亮多了（特意放大了窗体）！</p>
<h3 id="操作">操作</h3>
<p>在上面的配置过程中你可能已经感觉了 <code>M-x</code> 、 buffer 切换、文件打开等不太好用，其实社区已经有成熟的补全框架，可以对类似的场景进行补全，
我们将通过一下插件增强操作性：</p>
<ul>
<li>ivy + counsel + swiper</li>
<li>goto-line-preview 预览要跳转的行</li>
<li>which-key 忘记下面该按哪个键的时候可以对你进行提醒</li>
</ul>
<p>将以下内容追加到 <code>init.el</code> ：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-elisp" data-lang="elisp">(use-package counsel
  :straight <span style="color:#66d9ef">t</span>
  :custom
  (counsel-find-file-at-point <span style="color:#66d9ef">t</span>)
  :init
  (counsel-mode <span style="color:#ae81ff">+1</span>)
  :bind
  (<span style="color:#e6db74">&#34;C-x b&#34;</span> <span style="color:#f92672">.</span> counsel-switch-buffer)
  (<span style="color:#e6db74">&#34;C-c a p&#34;</span> <span style="color:#f92672">.</span> counsel-ag)
  (<span style="color:#e6db74">&#34;M-y&#34;</span> <span style="color:#f92672">.</span> counsel-yank-pop)
  (<span style="color:#e6db74">&#34;M-x&#34;</span> <span style="color:#f92672">.</span> counsel-M-x)
  (<span style="color:#e6db74">&#34;C-x C-f&#34;</span> <span style="color:#f92672">.</span> counsel-find-file)
  (<span style="color:#e6db74">&#34;&lt;f1&gt; f&#34;</span> <span style="color:#f92672">.</span> counsel-describe-function)
  (<span style="color:#e6db74">&#34;&lt;f1&gt; v&#34;</span> <span style="color:#f92672">.</span> counsel-describe-variable)
  (<span style="color:#e6db74">&#34;&lt;f1&gt; o&#34;</span> <span style="color:#f92672">.</span> counsel-describe-symbol)
  (<span style="color:#e6db74">&#34;&lt;f1&gt; l&#34;</span> <span style="color:#f92672">.</span> counsel-find-library)
  (<span style="color:#e6db74">&#34;&lt;f2&gt; i&#34;</span> <span style="color:#f92672">.</span> counsel-info-lookup-symbol)
  (<span style="color:#e6db74">&#34;&lt;f2&gt; u&#34;</span> <span style="color:#f92672">.</span> counsel-unicode-char)
  (<span style="color:#e6db74">&#34;C-c g&#34;</span> <span style="color:#f92672">.</span> counsel-git)
  <span style="color:#75715e">;; (&#34;C-c j&#34; . counsel-git-grep)</span>
  (<span style="color:#e6db74">&#34;C-c k&#34;</span> <span style="color:#f92672">.</span> counsel-ag)
  (<span style="color:#e6db74">&#34;C-x l&#34;</span> <span style="color:#f92672">.</span> counsel-locate)
  (<span style="color:#e6db74">&#34;C-S-o&#34;</span> <span style="color:#f92672">.</span> counsel-rhythmbox)
  (:map minibuffer-local-map
        ((<span style="color:#e6db74">&#34;C-r&#34;</span> <span style="color:#f92672">.</span> counsel-minibuffer-history))))

(use-package ivy
  :straight <span style="color:#66d9ef">t</span>
  :init
  (ivy-mode <span style="color:#ae81ff">1</span>)
  :custom
  (ivy-use-virtual-buffers <span style="color:#66d9ef">t</span>)
  (enable-recursive-minibuffers <span style="color:#66d9ef">t</span>)
  (ivy-wrap <span style="color:#66d9ef">t</span>)
  :bind
  (<span style="color:#e6db74">&#34;\C-s&#34;</span> <span style="color:#f92672">.</span> swiper)
  (<span style="color:#e6db74">&#34;\C-r&#34;</span> <span style="color:#f92672">.</span> swiper-backward)
  (<span style="color:#e6db74">&#34;C-c C-r&#34;</span> <span style="color:#f92672">.</span> ivy-resume)
  (<span style="color:#e6db74">&#34;&lt;f6&gt;&#34;</span> <span style="color:#f92672">.</span> ivy-resume))

(use-package ivy-posframe
  :straight <span style="color:#66d9ef">t</span>
  :custom
  (ivy-posframe-display-functions-alist <span style="color:#f92672">&#39;</span>((<span style="color:#66d9ef">t</span> <span style="color:#f92672">.</span> ivy-posframe-display)))
  :init
  (ivy-posframe-mode <span style="color:#ae81ff">1</span>))

(use-package ivy-rich
  :straight <span style="color:#66d9ef">t</span>
  :after (ivy)
  :init
  (<span style="color:#a6e22e">setcdr</span> (<span style="color:#a6e22e">assq</span> <span style="color:#66d9ef">t</span> ivy-format-functions-alist) <span style="color:#a6e22e">#&#39;</span>ivy-format-function-line)
  (ivy-rich-mode <span style="color:#ae81ff">+1</span>)
  (ivy-rich-project-root-cache-mode <span style="color:#ae81ff">+1</span>))

(use-package all-the-icons-ivy-rich
  :straight <span style="color:#66d9ef">t</span>
  :after (ivy-rich)
  :init (all-the-icons-ivy-rich-mode <span style="color:#ae81ff">1</span>))

(use-package goto-line-preview :straight <span style="color:#66d9ef">t</span>
  :bind ((<span style="color:#e6db74">&#34;M-g g&#34;</span> <span style="color:#f92672">.</span> goto-line-preview)))

(use-package which-key
  :straight <span style="color:#66d9ef">t</span>
  :hook
  (lsp-mode <span style="color:#f92672">.</span> lsp-enable-which-key-integration)
  :custom
  (which-key-show-early-on-C-h <span style="color:#66d9ef">t</span>)
  :init
  (which-key-mode))
</code></pre></div><p>看下现在的操作：</p>
<figure><img src="/dump-brain-with-emacs/ox-hugo/08QtGtwill.gif"/>
</figure>

<h2 id="改变操作习惯">改变操作习惯</h2>
<p>现在我们已经有了一套非常先进的编辑器，但是继续使用之前还有一些基本的操作需要我们掌握（前面已经有一些尝试），这部分没有特别好的办法，只能建议大家多练习几遍形成肌肉记忆。</p>
<h3 id="移动">移动</h3>
<table>
<thead>
<tr>
<th>操作</th>
<th>快捷键</th>
</tr>
</thead>
<tbody>
<tr>
<td>按字符移动</td>
<td>⬇ <code>C-n</code> ⬆ <code>C-p</code> ⬅ <code>C-b</code> ➡ <code>C-f</code></td>
</tr>
<tr>
<td>行首尾</td>
<td>ahead： <code>C-a</code> end： <code>C-e</code></td>
</tr>
<tr>
<td>buffer 头尾</td>
<td><code>M-,</code> （就是 M-&lt; 不按 shift）， <code>M-.</code> (M-&gt; 不按 shift)</td>
</tr>
<tr>
<td>向上/向下</td>
<td><code>C-v</code> <code>M-v</code></td>
</tr>
</tbody>
</table>
<h3 id="选择和复制粘贴">选择和复制粘贴</h3>
<p><code>C-SPC</code> (SPC 即空格)开始选择，然后通过上面快捷键移动。</p>
<ul>
<li><code>M-w</code> 将选择内容放入 <code>king-ring</code> 但不删除选择区域</li>
<li><code>C-w</code> 删除选择区域并将内容放入 <code>king-ring</code></li>
<li><code>M-y</code> 从 <code>king-ring</code> 中选择粘贴</li>
<li><code>C-y</code> 将放入 <code>king-ring</code> 的最后一条进行粘贴</li>
</ul>
<h2 id="准备记录笔记">准备记录笔记</h2>
<p>我们接下来准备通过 hugo 发布站点，所以现在先让我们通过 hugo 创建一个站点：</p>
<ol>
<li>
<p><a href="https://gohugo.io/getting-started/installing/">安装 Hugo</a></p>
</li>
<li>
<p>创建一个 hugo 站点</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ hugo new site ~/notes/
</code></pre></div></li>
<li>
<p>创建相关目录</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ mkdir -p ~/notes/content-org
</code></pre></div></li>
</ol>
<p>我们需要用到以下插件：</p>
<ul>
<li>org-mode</li>
<li>org-roam</li>
<li>org-superstar</li>
</ul>
<p>让我们将以下配置追加到 <code>init.el</code> 中：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-elisp" data-lang="elisp">(setq my/dump-brain-root <span style="color:#e6db74">&#34;~/notes/&#34;</span>)
(use-package org
  :straight (:type git :host github :repo <span style="color:#e6db74">&#34;bzg/org-mode&#34;</span>)
  :after ein
  :bind
  (<span style="color:#e6db74">&#34;C-c c&#34;</span> <span style="color:#f92672">.</span> org-capture)
  (<span style="color:#e6db74">&#34;C-c a o&#34;</span> <span style="color:#f92672">.</span> org-agenda)
  (<span style="color:#e6db74">&#34;C-c C-.&#34;</span> <span style="color:#f92672">.</span> org-mark-ring-goto)
  :custom
  (org-startup-indented <span style="color:#66d9ef">t</span>)
  (org-hide-leading-stars <span style="color:#66d9ef">t</span>)
  (org-odd-level-only <span style="color:#66d9ef">nil</span>)
  (org-insert-heading-respect-content <span style="color:#66d9ef">nil</span>)
  (org-M-RET-may-split-line <span style="color:#f92672">&#39;</span>((item) (default <span style="color:#f92672">.</span> <span style="color:#66d9ef">t</span>)))
  (org-special-ctrl-a/e <span style="color:#66d9ef">t</span>)
  (org-return-follows-link <span style="color:#66d9ef">nil</span>)
  (org-use-speed-commands <span style="color:#66d9ef">t</span>)
  (org-startup-align-all-tables <span style="color:#66d9ef">nil</span>)
  (org-log-into-drawer <span style="color:#66d9ef">nil</span>)
  (org-tags-column <span style="color:#ae81ff">1</span>)
  (org-ellipsis <span style="color:#e6db74">&#34; \u25bc&#34;</span> )
  (org-speed-commands-user <span style="color:#66d9ef">nil</span>)
  (org-blank-before-new-entry <span style="color:#f92672">&#39;</span>((heading <span style="color:#f92672">.</span> <span style="color:#66d9ef">nil</span>) (plain-list-item <span style="color:#f92672">.</span> <span style="color:#66d9ef">nil</span>)))
  (org-completion-use-ido <span style="color:#66d9ef">t</span>)
  (org-indent-mode <span style="color:#66d9ef">t</span>)
  (org-startup-truncated <span style="color:#66d9ef">nil</span>)
  :custom-face
  (org-headline-done ((<span style="color:#66d9ef">nil</span> (:strike-through <span style="color:#66d9ef">t</span>))))
  :init
  (require <span style="color:#e6db74">&#39;org-id</span>)
  (defun my/org-id-update-id-locations-current-dir()
    <span style="color:#e6db74">&#34;Update id locations from current dir.&#34;</span>
    (interactive)
    (org-id-update-id-locations (<span style="color:#a6e22e">directory-files</span> <span style="color:#e6db74">&#34;.&#34;</span> <span style="color:#66d9ef">t</span> <span style="color:#e6db74">&#34;\.org\$&#34;</span> <span style="color:#66d9ef">t</span>)))
  (org-babel-do-load-languages
   <span style="color:#e6db74">&#39;org-babel-load-languages</span>
   <span style="color:#f92672">&#39;</span>((ein <span style="color:#f92672">.</span> <span style="color:#66d9ef">t</span>)
     (dot <span style="color:#f92672">.</span> <span style="color:#66d9ef">t</span>))))

(use-package org-roam
  :after org
  :straight <span style="color:#66d9ef">t</span>
  :config
  (org-roam-setup)
  <span style="color:#75715e">;; If using org-roam-protocol</span>
  (require <span style="color:#e6db74">&#39;org-roam-protocol</span>)
  :bind
  (<span style="color:#e6db74">&#34;C-c n l&#34;</span> <span style="color:#f92672">.</span> org-roam-buffer-toggle)
  (<span style="color:#e6db74">&#34;C-c n f&#34;</span> <span style="color:#f92672">.</span> org-roam-node-find)
  (<span style="color:#e6db74">&#34;C-c n g&#34;</span> <span style="color:#f92672">.</span> org-roam-graph)
  (<span style="color:#e6db74">&#34;C-c n i&#34;</span> <span style="color:#f92672">.</span> org-roam-node-insert)
  (<span style="color:#e6db74">&#34;C-c n c&#34;</span> <span style="color:#f92672">.</span> org-roam-capture)
  <span style="color:#75715e">;; Dailies</span>
  (<span style="color:#e6db74">&#34;C-c n j&#34;</span> <span style="color:#f92672">.</span> org-roam-dailies-capture-today)
  :custom
  (org-roam-v2-ack <span style="color:#66d9ef">t</span>)
  (org-roam-directory (string-join (<span style="color:#a6e22e">cons</span> my/dump-brain-root <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;content-org&#34;</span>)) <span style="color:#e6db74">&#34;/&#34;</span>))
  (org-roam-capture-templates <span style="color:#f92672">`</span>((<span style="color:#e6db74">&#34;d&#34;</span> <span style="color:#e6db74">&#34;default&#34;</span> plain <span style="color:#e6db74">&#34;%?&#34;</span>
                                 :unnarrowed <span style="color:#66d9ef">t</span>
                                 :if-new (file+head <span style="color:#e6db74">&#34;%&lt;%Y%m%d%H%M%S&gt;-${slug}.org&#34;</span>
                                                    <span style="color:#e6db74">&#34;#+TITLE: ${title}
</span><span style="color:#e6db74">#+AUTHOR: Gray King
</span><span style="color:#e6db74">#+DATE: %U
</span><span style="color:#e6db74">#+HUGO_BASE_DIR: ../
</span><span style="color:#e6db74">#+HUGO_SECTION: notes
</span><span style="color:#e6db74">&#34;</span>)))))

(use-package org-superstar
  :straight <span style="color:#66d9ef">t</span>
  :hook
  (org-mode <span style="color:#f92672">.</span> (lambda () (org-superstar-mode <span style="color:#ae81ff">1</span>))))
</code></pre></div><p>然后通过 <code>M-x eval-buffer RET</code> 使其生效（现在输出这个命令是不是愉快多了？）！</p>
<h2 id="开始记录笔记">开始记录笔记</h2>
<p>漫长的等待之后我们终于可以开始记录了。</p>
<p>好吧，真正的开始之前你可能还需要学习以下 Org-mode 的语法，这里不做深入展开建议参考以下文章，或者随时询问搜索引擎（如 Org-mode 如何插入链接等）：</p>
<ul>
<li><a href="https://www.zmonster.me/2015/07/12/org-mode-introduction.html">Org-mode的语法解读</a></li>
</ul>
<p>那么，接下来请放松，跟着我来一步一步做（如果一遍不够就多来几遍）。</p>
<p>现在让我们敲下 <code>C-c n f</code> ，是不是能看到一个弹出层让我们输入 <code>Node:</code> ，现在没有任何节点，让我们输入 <code>Notes</code> 作为我们的根节点（当然你可以选择别的主题）。
接下来我们可以按下 <code>C-c C-c</code> 完成（或者 <code>C-c C-k</code> 中止）。</p>
<p>好了，现在我们有了第一篇笔记，假如我们不在 <code>Notes</code> 这个 Buffer 里，我们该如何找到这篇笔记呢？还是上面的 <code>C-c n f</code> （find），现在是不是能看到我们刚刚添加的 <code>Notes</code> 了？</p>
<p>接下来我们想添加第二篇并在 <code>Notes</code> 中引用它，我们需要先切换到 <code>Notes</code> （ <code>C-c n f Notes RET</code> ），然后直接在这篇笔记中的任意位置按下 <code>C-c n i</code> 继续我们的创作，输入标题： <code>技术</code> ，然后按下 <code>C-c C-c</code> 。</p>
<p>现在我们就能在 <code>Notes</code> 这个 buffer 下看到一个指向 <code>技术</code> 的链接，那么如何跳转过去呢？光标移动到上面按下 <code>C-c C-o</code> 即可！那么返回呢？
按下 <code>C-c C-.</code> ！其实 org-roam 提供了 Backlinks 机制，但是我很少使用，这里不做进一步的展开讨论。</p>
<p>org-roam 刚刚发布了 v2（我们现在用的也是 v2），支持基于 headline 创建节点，我们可以通过 Org-mode 语法创建一个 headline（以 <code>*</code> 开头），
然后光标移动上去执行 <code>M-x org-id-get-create</code> ，这时候（或许等一会）你再次通过 <code>C-c n f</code> 就能看到一个指向该 Headline 的节点。</p>
<p>只有亲自试一下你才能感受到 org-roam 的强大！</p>
<figure><img src="/dump-brain-with-emacs/ox-hugo/cYKhCjkqQN.gif"/>
</figure>

<h2 id="进阶">进阶</h2>
<h3 id="导出-hugo-站点">导出 Hugo 站点</h3>
<p>如果我们想要方便的查阅我们的笔记，或者想要通过这种方式写播客然后发布出去，我们可以配合
<a href="https://github.com/kaushalmodi/ox-hugo">ox-hugo</a> 插件，这个插件可以将 <code>Org-mode</code> 格式的文件导出 Hugo 格式的 markdown 文件。</p>
<p>我们将如下配置内容追加到 <code>init.el</code> 中：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-elisp" data-lang="elisp">(use-package ox-hugo
  :straight <span style="color:#66d9ef">t</span>
  :after (ox org-mode))
</code></pre></div><p>执行当前 buffer： <code>M-x eval-buffer RET</code> 。</p>
<p>完成之后，我们需要配置在笔记目录下，每次保存 Org-mode 文件时自动使用 <code>ox-hugo</code> 进行转换。</p>
<p>在 Emacs 中，按如下步骤操作：</p>
<ol>
<li>
<p>创建 <code>~/notes/.dir-locals.el</code>: <code>C-x C-f ~/notes/.dir-locals.el</code></p>
</li>
<li>
<p>追加如下内容到 <code>.dir-locals.el</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-elisp" data-lang="elisp">((<span style="color:#e6db74">&#34;content-org/&#34;</span> <span style="color:#f92672">.</span> ((org-mode <span style="color:#f92672">.</span> ((<span style="color:#a6e22e">eval</span> org-hugo-auto-export-mode))))))
</code></pre></div></li>
<li>
<p>按下 <code>C-x C-s</code> 保存，然后按下 <code>C-x C-k</code> 关闭当前 Buffer；</p>
</li>
<li>
<p>重新打开 Emacs 或者反复使用 <code>C-x C-k</code> 关闭所有 <code>~/notes</code> 目录下的 Buffer；</p>
</li>
<li>
<p>按下 <code>C-c n f Notes RET</code>  切换到 <code>Notes</code> 节点，做一些无用的改动，然后按下 <code>C-x C-s</code> 保存；</p>
</li>
<li>
<p>这时候你会看到消息回显区显示已经写入了 Markdown 文件。</p>
</li>
</ol>
<p>你可能需要依次打开现有的 Org-mode 文件，做一些无用的改动然后保存，以生成对应的 Markdown 文件。</p>
<p>最后，通过在 <code>~/notes</code> 目录下运行如下命令，即可启动本地 Hugo 站点：</p>
<pre><code class="language-nil" data-lang="nil">$ hugo server -D --disableFastRender --navigateToChanged
</code></pre><p>按照提示打开页面是不是什么都没显示？这是因为我们需要配置一个主题，我们这里使用 <a href="https://github.com/niklasbuschmann/contrast-hugo">contrast</a>：</p>
<pre><code class="language-nil" data-lang="nil">$ cd ~/notes/themes/
$ git clone https://github.com/niklasbuschmann/contrast-hugo.git contrast
</code></pre><p>然后在 <code>config.toml</code> 中指定使用该主题：</p>
<pre><code class="language-nil" data-lang="nil">theme = &quot;contrast&quot;
</code></pre><p>现在我们在运行一下我们的 Hugo 站点：</p>
<pre><code class="language-nil" data-lang="nil">$ hugo server -D --disableFastRender --navigateToChanged
</code></pre><p>再次打开浏览器就可以看到内容了！</p>
<h3 id="发布-github-pages">发布 GitHub Pages</h3>
<p>如果你想要将内容发布到网上，<a href="https://pages.github.com/">GitHub Pages</a> 是一个非常好的选择，原因如下：</p>
<ul>
<li>免费</li>
<li>自动化</li>
<li>内容托管防丢失</li>
</ul>
<p>首先你需要准备一个仓库，仓库名必须是 <code>username.github.com</code> ，其中 <code>username</code> 要替换成你自己的 GitHub 用户名。
比如我的就是 <a href="https://github.com/coldnight/coldnight.github.com">coldnight.github.com</a>。接下来需要将笔记通过 Git 推送到 GitHub 上：</p>
<pre><code class="language-nil" data-lang="nil">$ cd ~/notes
$ git init  # 初始化项目
$ git remote add origin https://github.com/coldnight/coldnight.github.com.git  # 一样 username 需要替换成你自己的 GitHub 用户名
$ git add . &amp;&amp; git commit -m 'init'
$ git push origin master
</code></pre><p>接下来配置 <a href="https://docs.github.com/cn/actions">GitHub Actions</a> 进行自动化发布，首先创建配置文件：</p>
<pre><code class="language-nil" data-lang="nil">$ cd ~/notes
$ mkdir -p .github/workflows
$ touch .github/workflows/main.yml
</code></pre><p>接下来通过 Emacs 打开 <code>.github/workflows/main.yml</code>, 按下 <code>C-x C-f ~/notes/.github/workflows/main.yml RET</code> ，填充如下内容：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#75715e"># This is a basic workflow to help you get started with Actions</span>
<span style="color:#f92672">name</span>: <span style="color:#ae81ff">Build hugo site</span>

<span style="color:#75715e"># Controls when the action will run.</span>
<span style="color:#f92672">on</span>:
  <span style="color:#75715e"># Triggers the workflow on push or pull request events but only for the master branch</span>
  <span style="color:#f92672">push</span>:
    <span style="color:#f92672">branches</span>: [ <span style="color:#ae81ff">master ]</span>
  <span style="color:#75715e"># Allows you to run this workflow manually from the Actions tab</span>
  <span style="color:#f92672">workflow_dispatch</span>:

<span style="color:#f92672">jobs</span>:
  <span style="color:#f92672">deploy</span>:
    <span style="color:#f92672">runs-on</span>: <span style="color:#ae81ff">ubuntu-20.04</span>
    <span style="color:#f92672">concurrency</span>:
      <span style="color:#f92672">group</span>: <span style="color:#ae81ff">${{ github.workflow }}-${{ github.ref }}</span>
    <span style="color:#f92672">steps</span>:
      - <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">actions/checkout@v2</span>
        <span style="color:#f92672">with</span>:
          <span style="color:#f92672">submodules</span>: <span style="color:#66d9ef">true</span>  <span style="color:#75715e"># Fetch Hugo themes (true OR recursive)</span>
          <span style="color:#f92672">fetch-depth</span>: <span style="color:#ae81ff">0</span>    <span style="color:#75715e"># Fetch all history for .GitInfo and .Lastmod</span>

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Setup Hugo</span>
        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">peaceiris/actions-hugo@v2</span>
        <span style="color:#f92672">with</span>:
          <span style="color:#f92672">hugo-version</span>: <span style="color:#e6db74">&#39;0.85.0&#39;</span>
          <span style="color:#75715e"># extended: true</span>

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Build</span>
        <span style="color:#f92672">run</span>: <span style="color:#ae81ff">hugo --minify</span>

      - <span style="color:#f92672">name</span>: <span style="color:#ae81ff">Deploy</span>
        <span style="color:#f92672">uses</span>: <span style="color:#ae81ff">peaceiris/actions-gh-pages@v3</span>
        <span style="color:#f92672">if</span>: <span style="color:#ae81ff">${{ github.ref == &#39;refs/heads/master&#39; }}</span>
        <span style="color:#f92672">with</span>:
          <span style="color:#f92672">github_token</span>: <span style="color:#ae81ff">${{ secrets.GITHUB_TOKEN }}</span>
          <span style="color:#f92672">publish_dir</span>: <span style="color:#ae81ff">./public</span>
</code></pre></div><p>接下来我们还需要调整一下 hugo 的配置，按下 <code>C-x C-f ~/notes/config.toml RET</code> 增加如下配置内容：</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-yaml" data-lang="yaml"><span style="color:#ae81ff">baseURL = &#34;http://username.github.io/&#34;    </span> <span style="color:#75715e"># 替换 username 为你自己的用户名</span>
</code></pre></div><p>然后将配置文件提交，提交完成就会触发自动构建 GitHub Pages：</p>
<pre><code class="language-nil" data-lang="nil">$ git add .github config.toml
$ git ci -m 'add workflow'
$ git push origin master
</code></pre><p>一旦构建完成就可以通过浏览器打开 <a href="http://username.github.io">http://username.github.io</a> (注意替换 <code>username</code> 为你的 GitHub 账号)访问。</p>
<h2 id="超阶">超阶</h2>
<p>这里给出一些「更高级」的主题，如果有兴趣可以自行探索。</p>
<h3 id="项目管理-projectile">项目管理：projectile</h3>
<p>我们一般使用的 IDE 都是按照项目进行管理，Emacs 也有类似功能的插件 <a href="https://github.com/bbatsov/projectile">projectile</a>：</p>
<ul>
<li>快速的在多个项目中间切换；</li>
<li>快速的在项目中全文查找（配合 <a href="https://github.com/ggreer/the%5Fsilver%5Fsearcher">the_silver_searcher</a>）；</li>
<li>快速测试、编译和运行。</li>
</ul>
<p>可以将如下配置内容追加到 <code>init.el</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-elisp" data-lang="elisp">(use-package projectile
  :straight <span style="color:#66d9ef">t</span>
  :custom
  (projectile-enable-caching <span style="color:#66d9ef">t</span>)
  :init
  (projectile-mode <span style="color:#ae81ff">+1</span>)

  (setq projectile-globally-ignored-directories
        (<span style="color:#a6e22e">append</span> <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;.git&#34;</span>
                  <span style="color:#e6db74">&#34;.svn&#34;</span>
                  <span style="color:#e6db74">&#34;.tox&#34;</span>
                  <span style="color:#e6db74">&#34;.venv&#34;</span>
                  <span style="color:#e6db74">&#34;.gradle&#34;</span>
                  <span style="color:#e6db74">&#34;.meghanada&#34;</span>
                  <span style="color:#e6db74">&#34;.clangd&#34;</span>
                  <span style="color:#e6db74">&#34;eln-cache&#34;</span>
                  <span style="color:#e6db74">&#34;out&#34;</span>
                  <span style="color:#e6db74">&#34;repl&#34;</span>
                  <span style="color:#e6db74">&#34;target&#34;</span>
                  <span style="color:#e6db74">&#34;venv&#34;</span>)
                projectile-globally-ignored-directories))

  (setq projectile-globally-ignored-files
        (<span style="color:#a6e22e">append</span> <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;.DS_Store&#34;</span>
                  <span style="color:#e6db74">&#34;*.gz&#34;</span>
                  <span style="color:#e6db74">&#34;*.pyc&#34;</span>
                  <span style="color:#e6db74">&#34;*.jar&#34;</span>
                  <span style="color:#e6db74">&#34;*.tar.gz&#34;</span>
                  <span style="color:#e6db74">&#34;*.tgz&#34;</span>
                  <span style="color:#e6db74">&#34;*.zip&#34;</span>
                  <span style="color:#e6db74">&#34;*.eln&#34;</span>
                  <span style="color:#e6db74">&#34;*.elc&#34;</span>
                  )
                projectile-globally-ignored-files))
  (<span style="color:#a6e22e">define-key</span> projectile-mode-map (kbd <span style="color:#e6db74">&#34;C-c p&#34;</span>) <span style="color:#e6db74">&#39;projectile-command-map</span>)
  (projectile-register-project-type <span style="color:#e6db74">&#39;hugo</span> <span style="color:#f92672">&#39;</span>(<span style="color:#e6db74">&#34;config.toml&#34;</span> <span style="color:#e6db74">&#34;archetypes&#34;</span> <span style="color:#e6db74">&#34;content&#34;</span>)
                                  :project-file <span style="color:#e6db74">&#34;config.toml&#34;</span>
                                  :compile <span style="color:#e6db74">&#34;hugo&#34;</span>
                                  :test <span style="color:#e6db74">&#34;open http://localhost:1313/&#34;</span>
                                  :run <span style="color:#e6db74">&#34;hugo server -D --disableFastRender --navigateToChanged&#34;</span>))
</code></pre></div><p>然后执行当前 buffer 即可： <code>M-x eval-buffer RET</code> 。</p>
<p>常用快捷键：</p>
<ul>
<li><code>C-c p p</code> 切换项目</li>
<li><code>C-c p U</code> 运行项目（上面配置如果在一个笔记项目中会弹出 hugo 的运行命令）</li>
<li><code>C-c a p</code> 项目内全局搜索</li>
</ul>
<h3 id="使用-emacs-作为-git-客户端-magit">使用 Emacs 作为 Git 客户端：magit</h3>
<p>Emacs 的一个非常强大的插件 <a href="https://magit.vc/">magit</a>，作为 Git 客户端非常好用，建议大家学习。</p>
<p>将如下配置内容追加到 <code>init.el</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-elisp" data-lang="elisp">(use-package magit
  :straight (magit :host github :repo <span style="color:#e6db74">&#34;magit/magit&#34;</span>)
  :bind
  (<span style="color:#e6db74">&#34;C-c m s&#34;</span> <span style="color:#f92672">.</span> magit-status)
  (<span style="color:#e6db74">&#34;C-c m p&#34;</span> <span style="color:#f92672">.</span> magit-push-current)
  (<span style="color:#e6db74">&#34;C-c m c&#34;</span> <span style="color:#f92672">.</span> magit-branch-checkout)
  (<span style="color:#e6db74">&#34;C-c m b&#34;</span> <span style="color:#f92672">.</span> magit-branch-and-checkout)
  (<span style="color:#e6db74">&#34;C-c m f&#34;</span> <span style="color:#f92672">.</span> magit-fetch)
  (<span style="color:#e6db74">&#34;C-c m m&#34;</span> <span style="color:#f92672">.</span> magit-merge)
  (<span style="color:#e6db74">&#34;C-c m r&#34;</span> <span style="color:#f92672">.</span> magit-rebase))
</code></pre></div><p>执行当前 buffer： <code>M-x eval-buffer RET</code> 。</p>
<p>快捷键就在上面配置文件内，如果需要更复杂的操作可以：</p>
<ol>
<li><code>M-x magit-</code> 看补全的命令；</li>
<li>或 <code>C-c m-s</code> 打开状态面板，然后按下 <code>?</code> 看允许的操作。</li>
</ol>
<h3 id="专注编辑">专注编辑</h3>
<p>你可能用过类似的功能，当文章比较长的时候，我们可能只想聚焦于某一节进行编辑或查看，这时候可以通过两个快捷键来实现：</p>
<ol>
<li><code>C-x n s</code> 聚焦当前子内容</li>
<li><code>C-x n w</code> 退出聚焦</li>
</ol>
<p>单纯的描述可能无法理解，我们可以看一段操作：
<img src="/dump-brain-with-emacs/ox-hugo/F6SrSTKLHo.gif" alt=""></p>
<h3 id="连接可视化-org-roam-ui">连接可视化：org-roam-ui</h3>
<p><a href="https://github.com/org-roam/org-roam-ui">org-roam-ui</a> 可以对连接可视化（不仅如此），效果如下：
<img src="https://user-images.githubusercontent.com/21983833/127746882-4ba00691-3be4-49d6-8c8c-e139a14596c2.png" alt=""></p>
<p>如下配置追加到 <code>init.el</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-elisp" data-lang="elisp">(use-package org-roam-ui
  :straight
    (:host github :repo <span style="color:#e6db74">&#34;org-roam/org-roam-ui&#34;</span> :branch <span style="color:#e6db74">&#34;main&#34;</span> :files (<span style="color:#e6db74">&#34;*.el&#34;</span> <span style="color:#e6db74">&#34;out&#34;</span>))
    :after org-roam
    :hook (org-roam <span style="color:#f92672">.</span> org-roam-ui-mode))
</code></pre></div><p>执行当前 buffer： <code>M-x eval-buffer RET</code> 。然后运行 <code>M-x org-roam-ui-mode RET</code> ，然后通过浏览器打开 <a href="http://127.0.0.1:35901/">http://127.0.0.1:35901/</a> 即可看到效果！</p>
<h3 id="收集笔记-org-protocol">收集笔记：org-protocol</h3>
<p>相信你可能用过一些选中然后发送给笔记客户端进行记录笔记的操作，通过  Emacs 也可以做到，
基本思路就是在各个系统或应用注册一个 <code>org-protocol://</code> 的协议，然后通过这个协议结合
Emacs 的 client/server 模式，来将内容发送到 Emacs。可以参考：</p>
<ul>
<li><a href="https://www.orgroam.com/manual.html#Org%5F002droam-Protocol">Org-roam Protocol</a></li>
</ul>
<h2 id="接下来">接下来？</h2>
<p>遇到不会的 <code>C-h</code> 是你的好帮手（which-key 会帮你弹出所有帮助主题），常用的有：</p>
<ul>
<li><code>C-h f</code> 函数（major mode 和 minor mode 也是一个函数）</li>
<li><code>C-h v</code> 变量</li>
<li><code>C-h b</code> 按键绑定</li>
</ul>
<p>然后就去问搜索引擎、社区或身边的人，同时也欢迎大家创建 issue 进行讨论，掌握 Emacs 无他，但手熟尔!</p>
<section class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1" role="doc-endnote">
<p><a href="https://www.nateliason.com/blog/roam">https://www.nateliason.com/blog/roam</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2" role="doc-endnote">
<p><a href="https://fortelabs.co/blog/how-to-take-smart-notes/">How To Take Smart Notes: 10 Principles to Revolutionize Your Note-Taking and Writing</a>&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3" role="doc-endnote">
<p><a href="https://zhuanlan.zhihu.com/p/111673670">在 Windows 上安装 GNU Emacs</a>&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4" role="doc-endnote">
<p>这是退出 Emacs 的快捷键，非常有用，相信我&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:5" role="doc-endnote">
<p><a href="https://www.jianshu.com/p/186a3409e878">https://www.jianshu.com/p/186a3409e878</a>&#160;<a href="#fnref:5" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:6" role="doc-endnote">
<p>其实这里要复杂的多，具体的可以参见文档 <a href="https://www.gnu.org/software/emacs/manual/html%5Fnode/emacs/Mode-Line.html">Mode Line</a>&#160;<a href="#fnref:6" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:7" role="doc-endnote">
<p>一些网上给的配置如果不是 <code>use-package</code> 的格式，我们可以简单的将配置放在 <code>use-package</code> 的 <code>:init</code> 下。&#160;<a href="#fnref:7" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</section>

</article>



</html>
