<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Articles on Taking Smart Notes With Org-mode</title>
    <link>https://www.linuxzen.com/notes/articles/</link>
    <description>Recent content in Articles on Taking Smart Notes With Org-mode</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-cn</language>
    <lastBuildDate>Thu, 26 Aug 2021 07:40:00 +0800</lastBuildDate><atom:link href="https://www.linuxzen.com/notes/articles/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Airflow powers AI</title>
      <link>https://www.linuxzen.com/notes/articles/20210826074053-airflow_powers_ai/</link>
      <pubDate>Thu, 26 Aug 2021 07:40:00 +0800</pubDate>
      
      <guid>https://www.linuxzen.com/notes/articles/20210826074053-airflow_powers_ai/</guid>
      <description>æœ€è¿‘æ¥æ‰‹äº†ä¸€ä¸ªé¡¹ç›®ï¼Œç»è¿‡éœ€æ±‚è°ƒç ”å†³å®šå°è¯•ä½¿ç”¨ Airflow è°ƒåº¦æ•°æ®ç”Ÿäº§ï¼Œè¿‡ç¨‹æ¶‰åŠï¼š
 ä»å¤§æ•°æ® Hive æ•°æ®åº“æ•´åˆæ•°æ®å®½è¡¨ï¼› åœ¨ Spark ä¸Šè¿è¡Œ IRT ç®—æ³•æ¨¡å‹æ±‡æ€» ADS è¡¨ã€‚  ä»ä¸­å­¦ä¹ äº†å¾ˆå¤šå…³äºå¤§æ•°æ®çš„çŸ¥è¯†ï¼ŒåŒæ—¶ä¹Ÿç§¯ç´¯äº†å¦‚ä½•é€šè¿‡ Airflow æäº¤ Spark ä»»åŠ¡çš„ç»éªŒï¼Œåº”å½“æŠ½æ—¶é—´æ€»ç»“ä¸€ä¸‹ã€‚
å†°å±±ä¹‹ä¸‹ å¦‚ã€Œå†°å±±ç†è®ºã€æ‰€æè¿°ï¼Œæˆ‘ä»¬æ‰€åšçš„åªæ˜¯å†°å±±éœ²åœ¨æ°´é¢çš„ä¸€è§’ï¼Œéšè—åœ¨å†°å±±ä¹‹ä¸‹æ›´å¤§çš„ä¸€éƒ¨ä»½æ˜¯ï¼š
 Airflow + Celery Docker æ­å»ºå¥½çš„ Hadoop é›†ç¾¤ æ­å»ºå¥½çš„ Hive æ•°æ®åº“ æ­å»ºå¥½çš„ Spark é›†ç¾¤  æ¥ä¸‹æ¥æˆ‘ä»¬å°†å…³æ³¨åœ¨ã€Œå†°å±±æ°´é¢ä¸Šçš„ä¸€è§’ã€æ¥é˜è¿°æˆ‘ä»¬å¦‚ä½•åˆ©ç”¨è¿™äº›å·²æœ‰çš„æŠ€æœ¯è¿ç»“äº†æ•´ä¸ªç³»ç»Ÿã€‚
Make DAG great again ä¹‹å‰éƒ¨é—¨é‡Œæœ‰ä½ç®—æ³•å¤§ä½¬ç”¨ DAGï¼ˆå¤§ä½¬å¿µåšã€Œæˆ´æ ¼ã€ï¼‰å®ç°äº†ä¸€å¥—éå¸¸ç‰›é€¼çš„æ–‡æœ¬å’Œè¯†åˆ«å¤„ç†ç®—æ³•ï¼Œç„¶åæ¯æ¬¡è®¨è®ºæ–¹æ¡ˆå¿…è°ˆ DAGï¼Œ æ‰€ä»¥ DAG æˆäº†éƒ¨é—¨é‡Œéƒ½çŸ¥é“çš„ä¸€ä¸ªæ¢—ï¼Œè™½ç„¶å¤§ä½¬èµ°äº†ä¹‹åå¾ˆå°‘å†æœ‰äººæèµ· DAGï¼Œä½†æ˜¯æ¥ä¸‹æ¥æˆ‘ä»¬ä¼šè¿›è¡Œæ–‡è‰ºå¤å…´ï¼Œè®© DAG å†æ¬¡å‡ºç°åœ¨æˆ‘ä»¬çš„æ—¥å¸¸æŠ€æœ¯è®¨è®ºä¸­ã€‚
Make DAG Great Again!
Airflow ä»‹ç» æ¶æ„ ç¼–ç¨‹æ¦‚å¿µ  DAG Operator Connection  Spark ä»‹ç» æ¶æ„ å‰èœ é¸Ÿç°å›¾ Spark SQL Hive Table ç¤ºä¾‹ Airflow + Spark å¹³å°åŒ– Celery Worker as a Spark Driver Celery Worker running on specific platform Windows Bigdata Hive client DAGs åˆ†å‘ æäº¤ DAG Python ä¾èµ–è§£å†³  Spark Airflow  å¤–éƒ¨ä¾èµ– æœªæ¥  æ‰¿æ¥æ›´å¤šçš„æŠ¥å‘Šéœ€æ±‚ å¯¹å†…æ‰¿æ¥åˆ†æä»»åŠ¡ å¯ç¼–ç¨‹ã€å¹³å°åŒ–çš„åˆ†æ  </description>
      <content>&lt;p&gt;æœ€è¿‘æ¥æ‰‹äº†ä¸€ä¸ªé¡¹ç›®ï¼Œç»è¿‡éœ€æ±‚è°ƒç ”å†³å®šå°è¯•ä½¿ç”¨ Airflow è°ƒåº¦æ•°æ®ç”Ÿäº§ï¼Œè¿‡ç¨‹æ¶‰åŠï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä»å¤§æ•°æ® Hive æ•°æ®åº“æ•´åˆæ•°æ®å®½è¡¨ï¼›&lt;/li&gt;
&lt;li&gt;åœ¨ Spark ä¸Šè¿è¡Œ IRT ç®—æ³•æ¨¡å‹æ±‡æ€» ADS è¡¨ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä»ä¸­å­¦ä¹ äº†å¾ˆå¤šå…³äºå¤§æ•°æ®çš„çŸ¥è¯†ï¼ŒåŒæ—¶ä¹Ÿç§¯ç´¯äº†å¦‚ä½•é€šè¿‡ Airflow æäº¤ Spark ä»»åŠ¡çš„ç»éªŒï¼Œåº”å½“æŠ½æ—¶é—´æ€»ç»“ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å†°å±±ä¹‹ä¸‹&#34;&gt;å†°å±±ä¹‹ä¸‹&lt;/h2&gt;
&lt;p&gt;å¦‚ã€Œå†°å±±ç†è®ºã€æ‰€æè¿°ï¼Œæˆ‘ä»¬æ‰€åšçš„åªæ˜¯å†°å±±éœ²åœ¨æ°´é¢çš„ä¸€è§’ï¼Œéšè—åœ¨å†°å±±ä¹‹ä¸‹æ›´å¤§çš„ä¸€éƒ¨ä»½æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Airflow + Celery&lt;/li&gt;
&lt;li&gt;Docker&lt;/li&gt;
&lt;li&gt;æ­å»ºå¥½çš„ Hadoop é›†ç¾¤&lt;/li&gt;
&lt;li&gt;æ­å»ºå¥½çš„ Hive æ•°æ®åº“&lt;/li&gt;
&lt;li&gt;æ­å»ºå¥½çš„ Spark é›†ç¾¤&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬å°†å…³æ³¨åœ¨ã€Œå†°å±±æ°´é¢ä¸Šçš„ä¸€è§’ã€æ¥é˜è¿°æˆ‘ä»¬å¦‚ä½•åˆ©ç”¨è¿™äº›å·²æœ‰çš„æŠ€æœ¯è¿ç»“äº†æ•´ä¸ªç³»ç»Ÿã€‚&lt;/p&gt;
&lt;h2 id=&#34;make-dag-great-again&#34;&gt;Make DAG great again&lt;/h2&gt;
&lt;p&gt;ä¹‹å‰éƒ¨é—¨é‡Œæœ‰ä½ç®—æ³•å¤§ä½¬ç”¨ DAGï¼ˆå¤§ä½¬å¿µåšã€Œæˆ´æ ¼ã€ï¼‰å®ç°äº†ä¸€å¥—éå¸¸ç‰›é€¼çš„æ–‡æœ¬å’Œè¯†åˆ«å¤„ç†ç®—æ³•ï¼Œç„¶åæ¯æ¬¡è®¨è®ºæ–¹æ¡ˆå¿…è°ˆ DAGï¼Œ
æ‰€ä»¥ DAG æˆäº†éƒ¨é—¨é‡Œéƒ½çŸ¥é“çš„ä¸€ä¸ªæ¢—ï¼Œè™½ç„¶å¤§ä½¬èµ°äº†ä¹‹åå¾ˆå°‘å†æœ‰äººæèµ· DAGï¼Œä½†æ˜¯æ¥ä¸‹æ¥æˆ‘ä»¬ä¼šè¿›è¡Œæ–‡è‰ºå¤å…´ï¼Œè®© DAG å†æ¬¡å‡ºç°åœ¨æˆ‘ä»¬çš„æ—¥å¸¸æŠ€æœ¯è®¨è®ºä¸­ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Make DAG Great Again&lt;/strong&gt;!&lt;/p&gt;
&lt;h2 id=&#34;airflow-ä»‹ç»&#34;&gt;Airflow ä»‹ç»&lt;/h2&gt;
&lt;h3 id=&#34;æ¶æ„&#34;&gt;æ¶æ„&lt;/h3&gt;
&lt;h3 id=&#34;ç¼–ç¨‹æ¦‚å¿µ&#34;&gt;ç¼–ç¨‹æ¦‚å¿µ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;DAG&lt;/li&gt;
&lt;li&gt;Operator&lt;/li&gt;
&lt;li&gt;Connection&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;spark-ä»‹ç»&#34;&gt;Spark ä»‹ç»&lt;/h2&gt;
&lt;h3 id=&#34;æ¶æ„&#34;&gt;æ¶æ„&lt;/h3&gt;
&lt;h3 id=&#34;å‰èœ&#34;&gt;å‰èœ&lt;/h3&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;é¸Ÿç°å›¾&#34;&gt;é¸Ÿç°å›¾&lt;/h3&gt;
&lt;h3 id=&#34;spark-sql-hive-table-ç¤ºä¾‹&#34;&gt;Spark SQL Hive Table ç¤ºä¾‹&lt;/h3&gt;
&lt;h2 id=&#34;airflow-plus-spark-å¹³å°åŒ–&#34;&gt;Airflow + Spark å¹³å°åŒ–&lt;/h2&gt;
&lt;h3 id=&#34;celery-worker-as-a-spark-driver&#34;&gt;Celery Worker as a Spark Driver&lt;/h3&gt;
&lt;h3 id=&#34;celery-worker-running-on-specific-platform&#34;&gt;Celery Worker running on specific platform&lt;/h3&gt;
&lt;h4 id=&#34;windows&#34;&gt;Windows&lt;/h4&gt;
&lt;h4 id=&#34;bigdata-hive-client&#34;&gt;Bigdata Hive client&lt;/h4&gt;
&lt;h3 id=&#34;dags-åˆ†å‘&#34;&gt;DAGs åˆ†å‘&lt;/h3&gt;
&lt;h2 id=&#34;æäº¤-dag&#34;&gt;æäº¤ DAG&lt;/h2&gt;
&lt;h2 id=&#34;python-ä¾èµ–è§£å†³&#34;&gt;Python ä¾èµ–è§£å†³&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Spark&lt;/li&gt;
&lt;li&gt;Airflow&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;å¤–éƒ¨ä¾èµ–&#34;&gt;å¤–éƒ¨ä¾èµ–&lt;/h2&gt;
&lt;h2 id=&#34;æœªæ¥&#34;&gt;æœªæ¥&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;æ‰¿æ¥æ›´å¤šçš„æŠ¥å‘Šéœ€æ±‚&lt;/li&gt;
&lt;li&gt;å¯¹å†…æ‰¿æ¥åˆ†æä»»åŠ¡&lt;/li&gt;
&lt;li&gt;å¯ç¼–ç¨‹ã€å¹³å°åŒ–çš„åˆ†æ&lt;/li&gt;
&lt;/ul&gt;
</content>
    </item>
    
    <item>
      <title>Understanding Rust futures by going way too deep</title>
      <link>https://www.linuxzen.com/notes/articles/20210726105711-understanding_rust_futures_by_going_way_too_deep/</link>
      <pubDate>Mon, 26 Jul 2021 10:57:00 +0800</pubDate>
      
      <guid>https://www.linuxzen.com/notes/articles/20210726105711-understanding_rust_futures_by_going_way_too_deep/</guid>
      <description>åŸæ–‡é“¾æ¥ï¼šUnderstanding Rust futures by going way too deepã€‚
è¯‘è€…æ³¨ï¼šåŸæ–‡å¤§é‡çš„å¼•å…¥äº†æœ‰è¶£çš„å¯¹è¯ï¼Œè¿«äºæ’ç‰ˆé—®é¢˜è¿™é‡Œä¸è¿›è¡Œç¿»è¯‘ï¼Œå¿…è¦çš„å¯¹è¯é€šè¿‡å¼•ç”¨å—æ¥è§£é‡Šã€‚
æ·±å…¥ç†è§£ Rust future ç”¨ Rust futureï¼å°±æ˜¯è¿™ä¹ˆç®€å•ï¼ç›´åˆ°æˆ‘ä»¬å‘ç°å¹¶éå¦‚æ­¤ã€‚æ‰€ä»¥æˆ‘ä»¬å…ˆæ¢ç´¢ç®€å•çš„éƒ¨åˆ†ï¼Œç„¶åç»§ç»­æ¢ç´¢å›°éš¾éƒ¨åˆ†è€Œä¸æ˜¯ç­‰å®ƒæ…¢æ…¢é è¿‘æˆ‘ä»¬ã€‚
èµ·æ­¥  Choo choo here comes the easy part ğŸš‚ğŸ’¨
 æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®ï¼š
$ cargo new waytoodeep Created binary (application) `waytoodeep` package æˆ‘ä»¬éœ€è¦å®‰è£… cargo-edit å¦‚æœä¹‹å‰æ²¡æœ‰å®‰è£…è¿‡çš„è¯ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥ç›´æ¥ cargo add ï¼š
$ cargo install cargo-edit Updating crates.io index Downloaded cargo-edit v0.7.0 Downloaded 1 crate (57.6 KB) in 0.47s Ignored package `cargo-edit v0.7.0` is already installed, use --force to override  å› ä¸º cargo-edit å¾ˆæ–¹ä¾¿ï¼Œæ‰€ä»¥ä½ å¯èƒ½å·²ç»å®‰è£…è¿‡å®ƒã€‚éƒ¨åˆ†è¯»è€…ä¼šæ„Ÿåˆ°å›°æƒ‘æ˜¯å› ä¸ºåƒ cargo new, cargo build, cargo test, cargo run ç­‰å­å‘½ä»¤éƒ½å†…ç½®åœ¨ cargo ä¸­ï¼Œ ä½†æ˜¯ cargo add æ²¡æœ‰ã€‚</description>
      <content>&lt;p&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href=&#34;https://fasterthanli.me/articles/understanding-rust-futures-by-going-way-too-deep&#34;&gt;Understanding Rust futures by going way too deep&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šåŸæ–‡å¤§é‡çš„å¼•å…¥äº†æœ‰è¶£çš„å¯¹è¯ï¼Œè¿«äºæ’ç‰ˆé—®é¢˜è¿™é‡Œä¸è¿›è¡Œç¿»è¯‘ï¼Œå¿…è¦çš„å¯¹è¯é€šè¿‡å¼•ç”¨å—æ¥è§£é‡Šã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ·±å…¥ç†è§£-rust-future&#34;&gt;æ·±å…¥ç†è§£ Rust future&lt;/h2&gt;
&lt;p&gt;ç”¨ Rust futureï¼å°±æ˜¯è¿™ä¹ˆç®€å•ï¼ç›´åˆ°æˆ‘ä»¬å‘ç°å¹¶éå¦‚æ­¤ã€‚æ‰€ä»¥æˆ‘ä»¬å…ˆæ¢ç´¢ç®€å•çš„éƒ¨åˆ†ï¼Œç„¶åç»§ç»­æ¢ç´¢å›°éš¾éƒ¨åˆ†è€Œä¸æ˜¯ç­‰å®ƒæ…¢æ…¢é è¿‘æˆ‘ä»¬ã€‚&lt;/p&gt;
&lt;h2 id=&#34;èµ·æ­¥&#34;&gt;èµ·æ­¥&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Choo choo here comes the easy part ğŸš‚ğŸ’¨&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo new waytoodeep
     Created binary (application) `waytoodeep` package
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ‘ä»¬éœ€è¦å®‰è£… &lt;code&gt;cargo-edit&lt;/code&gt; å¦‚æœä¹‹å‰æ²¡æœ‰å®‰è£…è¿‡çš„è¯ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥ç›´æ¥ &lt;code&gt;cargo add&lt;/code&gt; ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo install cargo-edit
    Updating crates.io index
  Downloaded cargo-edit v0.7.0
  Downloaded 1 crate (57.6 KB) in 0.47s
     Ignored package `cargo-edit v0.7.0` is already installed, use --force to override
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;å› ä¸º &lt;code&gt;cargo-edit&lt;/code&gt; å¾ˆæ–¹ä¾¿ï¼Œæ‰€ä»¥ä½ å¯èƒ½å·²ç»å®‰è£…è¿‡å®ƒã€‚éƒ¨åˆ†è¯»è€…ä¼šæ„Ÿåˆ°å›°æƒ‘æ˜¯å› ä¸ºåƒ
&lt;code&gt;cargo new&lt;/code&gt;, &lt;code&gt;cargo build&lt;/code&gt;, &lt;code&gt;cargo test&lt;/code&gt;, &lt;code&gt;cargo run&lt;/code&gt; ç­‰å­å‘½ä»¤éƒ½å†…ç½®åœ¨ cargo ä¸­ï¼Œ
ä½†æ˜¯ &lt;code&gt;cargo add&lt;/code&gt; æ²¡æœ‰ã€‚&lt;/p&gt;
&lt;p&gt;å®é™…ä¸Šï¼Œæœ‰ä¸€å¤§å †åƒè¿™æ ·çš„åŒ…ï¼Œå¦‚ &lt;a href=&#34;https://lib.rs/crates/cargo-hack&#34;&gt;cargo-hack&lt;/a&gt;,&lt;a href=&#34;https://lib.rs/crates/cargo-udeps&#34;&gt;cargo-udeps&lt;/a&gt;,&lt;a href=&#34;https://lib.rs/crates/cargo-expand&#34;&gt;cargo-expand&lt;/a&gt;&amp;hellip;&lt;a href=&#34;https://lib.rs/keywords/cargo&#34;&gt;ç­‰ç­‰&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬éœ€è¦é€‰æ‹©ä¸€ä¸ªã€Œå¼‚æ­¥è¿è¡Œæ—¶ã€ï¼ˆasync runtimeï¼‰ï¼Œå› ä¸ºè¿™äº› future å¯¹è±¡ä¸ä¼šè½®è¯¢ï¼ˆpollï¼‰è‡ªå·±ã€‚ã€‚ã€‚
æˆ‘ä»¬æ¯«æ— ç†ç”±çš„é€‰æ‹© tokioï¼Œå”¯ä¸€çš„åŸå› æ˜¯ï¼šè¿‡å»å‡ ä¸ªæœˆæˆ‘ä¸€ç›´åœ¨ç”¨å®ƒã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo add tokio@1.9.0 --features full
    Updating &#39;https://github.com/rust-lang/crates.io-index&#39; index
      Adding tokio v1.9.0 to dependencies with features: [&amp;quot;full&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç„¶åæˆ‘ä»¬ä¿®æ”¹ &lt;code&gt;main&lt;/code&gt; å‡½æ•°ä½¿ç”¨ tokio é»˜è®¤æ‰§è¡Œå™¨ï¼ˆexecutorï¼‰ï¼ˆ &lt;code&gt;cargo new&lt;/code&gt; ä¸ºæˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ª &lt;code&gt;main&lt;/code&gt; å‡½æ•°ï¼Œä½†æ˜¯è¿™é‡Œå¹¶ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// in `src/main.rs`
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() {
    println&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Hello from a (so far completely unnecessary) async runtime&amp;#34;&lt;/span&gt;);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo run                                                                                                                                                                                          3s 209ms
   Compiling waytoodeep v0.1.0 (/Users/wh/codes/rust/waytoodeep)
    Finished dev [unoptimized + debuginfo] target(s) in 3.47s
     Running `target/debug/waytoodeep`
Hello from a (so far completely unnecessary) async runtime
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;é…·ï¼&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥è®©æˆ‘ä»¬æ·»åŠ å…¶ä»–ä¸€äº›æˆ‘å–œæ¬¢åœ¨æˆ‘çš„é¡¹ç›®ä¸­ä½¿ç”¨çš„å¥½ä¸œè¥¿ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œå¯¹äºé”™è¯¯å¤„ç† - æˆ‘ä»¬ç¼–å†™ç¨‹åºå°±éœ€è¦å¤„ç†ä¸€å †ä¸åŒåº“é‡Œä¸åŒçš„é”™è¯¯ç±»å‹ï¼Œå¦‚æœèƒ½é€šè¿‡ä¸€ä¸ªç±»å‹ç»Ÿä¸€å®ƒä»¬å°±ä¼šéå¸¸æ•´æ´ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://lib.rs/crates/eyre&#34;&gt;eyre&lt;/a&gt; å¯ä»¥èµ‹äºˆæˆ‘ä»¬è¿™äº›ï¼ˆå°±åƒ &lt;code&gt;anyhow&lt;/code&gt; ï¼‰ï¼&lt;/p&gt;
&lt;p&gt;å¹¶ä¸”å› ä¸ºæˆ‘å–œæ¬¢æ¼‚äº®çš„é¢œè‰²æˆ‘å°†ä½¿ç”¨ &lt;a href=&#34;https://lib.rs/crates/color-eyre&#34;&gt;color-eyre&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo add color-eyre@0.5.11
    Updating &#39;https://github.com/rust-lang/crates.io-index&#39; index
      Adding color-eyre v0.5.11 to dependencies
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç°åœ¨æˆ‘ä»¬éœ€è¦å®‰è£… &lt;code&gt;color-eyre&lt;/code&gt; ä½œä¸ºé»˜è®¤çš„å´©æºƒï¼ˆpanicï¼‰å¤„ç†å™¨ï¼Œæˆ‘æ‚„æ‚„ä¿®æ”¹äº†ä¸€äº›ç¯å¢ƒå˜é‡æ¥é»˜è®¤è¾“å‡ºè°ƒç”¨å †æ ˆï¼ˆbacktracksï¼‰ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; color_eyre::Report;

&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    setup()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    println&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Hello from a (so far completely unnecessary) async runtime&amp;#34;&lt;/span&gt;);

    Ok(())
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;setup&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; std::env::var(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;RUST_LIB_BACKTRACE&amp;#34;&lt;/span&gt;).is_err() {
        std::env::set_var(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;RUST_LIB_BACKTRACE&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;)
    }
    color_eyre::install()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo run
    Finished dev [unoptimized + debuginfo] target(s) in 0.02s
     Running `target/debug/waytoodeep`
Hello from a (so far completely unnecessary) async runtime
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¾ˆå¥½ï¼ç°åœ¨å¦‚æœæˆ‘ä»¬æŸå¤„å‡ºç°äº†ä¸€ä¸ªé”™è¯¯ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å®Œæ•´çš„å †æ ˆè·Ÿè¸ªï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š
&lt;img src=&#34;https://fasterthanli.me/content/articles/understanding-rust-futures-by-going-way-too-deep/assets/color-eyre.78931d5fc80841f6.webp&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œå› ä¸ºæˆ‘å–œæ¬¢ç»“æ„åŒ–æ—¥å¿—ï¼Œè®©æˆ‘ä»¬æ·»åŠ  &lt;a href=&#34;https://lib.rs/crates/tracing&#34;&gt;tracing&lt;/a&gt; ç„¶åé€šè¿‡æ¼‚äº®çš„é¢œè‰²æ‰“å°å®ƒä»¬ï¼Œè®©æˆ‘ä»¬æ·»åŠ  &lt;a href=&#34;https://lib.rs/crates/tracing-subscriber&#34;&gt;tracing-subscriber&lt;/a&gt;.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo add tracing@0.1.26 tracing-subscriber@0.2.19
    Updating &#39;https://github.com/rust-lang/crates.io-index&#39; index
      Adding tracing v0.1.26 to dependencies
      Adding tracing-subscriber v0.2.19 to dependencies
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ‘ä»¬å·²ç»æœ‰ä¸€ä¸ª &lt;code&gt;setup&lt;/code&gt; å‡½æ•°ï¼Œæ‰€ä»¥ç›´æ¥åœ¨é‚£é‡Œå®‰è£… &lt;code&gt;tracing-subscriber&lt;/code&gt;.. ç„¶åæˆ‘ä»¬å°† &lt;code&gt;println!&lt;/code&gt; æ”¹æˆ &lt;code&gt;info!&lt;/code&gt; ï¼
ç„¶åï¼Œä¸ºäº†æ¼”ç¤ºå¦‚ä½•è®¾ç½®è®©æˆ‘ä»¬å†æ¬¡ä¿®æ”¹ä¸€äº›ç¯å¢ƒå˜é‡ï¼šå¯¹æ‰€æœ‰åŒ…ï¼ˆcratesï¼‰é»˜è®¤ &lt;code&gt;info&lt;/code&gt; æ—¥å¿—çº§åˆ«ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; color_eyre::Report;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; tracing::info;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; tracing_subscriber::EnvFilter;

&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    setup()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Hello from a comfy nest we&amp;#39;ve made for ourselves&amp;#34;&lt;/span&gt;);

    Ok(())
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;setup&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; std::env::var(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;RUST_LIB_BACKTRACE&amp;#34;&lt;/span&gt;).is_err() {
        std::env::set_var(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;RUST_LIB_BACKTRACE&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;)
    }
    color_eyre::install()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; std::env::var(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;RUST_LOG&amp;#34;&lt;/span&gt;).is_err() {
        std::env::set_var(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;RUST_LOG&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;info&amp;#34;&lt;/span&gt;)
    }
    tracing_subscriber::fmt::fmt()
        .with_env_filter(EnvFilter::from_default_env())
        .init();

    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo run
    Finished dev [unoptimized + debuginfo] target(s) in 0.02s
     Running `target/debug/waytoodeep`
Jul 25 17:03:46.993  INFO waytoodeep: Hello from a comfy nest we&#39;ve made for ourselves
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¥½äº†ï¼Œæˆ‘ä»¬å‡†å¤‡å¥½åšä¸€äº›æœ‰ç”¨çš„äº‹æƒ…äº†ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åšä¸€äº›æœ‰ç”¨çš„äº‹æƒ…&#34;&gt;åšä¸€äº›æœ‰ç”¨çš„äº‹æƒ…&lt;/h3&gt;
&lt;p&gt;å½“å†³å®šåœ¨å’–å•¡é—´éš™é˜…è¯»å“ªä¸€ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œäººä»¬é€šå¸¸åŒæ—¶æ‰“å¼€å‡ ä¸ªç½‘ç«™ï¼Œç„¶åè¯»æœ€å…ˆåŠ è½½å‡ºæ¥çš„é‚£ä¸€ç¯‡ã€‚&lt;/p&gt;
&lt;p&gt;äº‹å®å¦‚æ­¤ã€‚ä½ å¯ä»¥å¼•ç”¨æˆ‘çš„è¯ï¼Œè°ä¼šå»éªŒè¯å‘¢ï¼Ÿæ¯•ç«Ÿè¿™å¬èµ·æ¥éœ€è¦å¾ˆå¤šå·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è®©æˆ‘ä»¬æ¥ç¼–å†™ä¸€ä¸ªç¨‹åºåšç›¸åŒçš„äº‹æƒ…ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬å¼•å…¥ &lt;a href=&#34;https://lib.rs/crates/reqwest&#34;&gt;reqwest&lt;/a&gt; &amp;ndash; å°½ç®¡æˆ‘ä¸å–œæ¬¢å®ƒçš„ APIï¼Œä½†å®ƒä¼šå¾ˆå¥½çš„å®Œæˆæ¥ä¸‹æ¥çš„å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;åŒæ—¶ï¼Œå› ä¸º &lt;a href=&#34;https://www.openssl.org/news/vulnerabilities.html&#34;&gt;screw OpenSSL&lt;/a&gt; æˆ‘ä»¬å°†æ ‡è®° reqwest ä½¿ç”¨ &lt;a href=&#34;https://lib.rs/crates/rustls&#34;&gt;rustls&lt;/a&gt;ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo add reqwest@0.11.4 --no-default-features --features rustls-tls
    Updating &#39;https://github.com/rust-lang/crates.io-index&#39; index
      Adding reqwest v0.11.4 to dependencies with features: [&amp;quot;rustls-tls&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ‘ä»¬å‡†å¤‡å¥½å‘é€ä¸€ä¸ªè¯·æ±‚äº†ï¼&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; color_eyre::Report;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; tracing::info;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; tracing_subscriber::EnvFilter;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; reqwest::Client;

&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    setup()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Hello from a comfy nest we&amp;#39;ve made for ourselves&amp;#34;&lt;/span&gt;);

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; client &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Client::new();
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; url &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;https://fasterthanli.me&amp;#34;&lt;/span&gt;;
    &lt;span style=&#34;color:#75715e&#34;&gt;// this will turn non-200 HTTP status codes into rust errors,
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;// so the first `?` propagates &amp;#34;we had a connection problem&amp;#34; and
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;// the second `?` propagates &amp;#34;we had a chat with the server and they
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;// were not pleased&amp;#34;
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; res &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; client.get(url).send().&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;.error_for_status()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt;url, content_type &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;res.headers().get(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;content-type&amp;#34;&lt;/span&gt;), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Got a response!&amp;#34;&lt;/span&gt;);


    Ok(())
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;setup&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; std::env::var(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;RUST_LIB_BACKTRACE&amp;#34;&lt;/span&gt;).is_err() {
        std::env::set_var(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;RUST_LIB_BACKTRACE&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;)
    }
    color_eyre::install()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; std::env::var(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;RUST_LOG&amp;#34;&lt;/span&gt;).is_err() {
        std::env::set_var(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;RUST_LOG&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;info&amp;#34;&lt;/span&gt;)
    }
    tracing_subscriber::fmt::fmt()
        .with_env_filter(EnvFilter::from_default_env())
        .init();

    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å‡ºå‘äº†ï¼&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;cargo run
   Compiling waytoodeep v0.1.0 (/Users/wh/codes/rust/waytoodeep)
    Finished dev [unoptimized + debuginfo] target(s) in 7.16s
     Running `target/debug/waytoodeep`
Jul 26 16:50:57.778  INFO waytoodeep: Hello from a comfy nest we&#39;ve made for ourselves
Jul 26 16:50:59.090  INFO waytoodeep: Got a response! url=https://fasterthanli.me content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™å°±æ˜¯æˆ‘æ‰€è¯´çš„ã€Œç»“æ„åŒ–æ—¥å¿—ã€ã€‚å—¯ï¼Œå…¶ä¸­çš„ä¸€éƒ¨åˆ†ã€‚è®©æˆ‘ä»¬çœ‹ä¸‹è¿™è¡Œä»£ç ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt;url, content_type &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;res.headers().get(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;content-type&amp;#34;&lt;/span&gt;), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Got a response!&amp;#34;&lt;/span&gt;);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬è¾“å‡ºæ¥ä¸€ä¸ªæ¶ˆæ¯ï¼š &lt;code&gt;Got a response!&lt;/code&gt; ï¼Œä¸€ä¸ªåä¸º &lt;code&gt;url&lt;/code&gt; çš„æ ‡ç­¾ï¼šå€¼ä¸ºå˜é‡ &lt;code&gt;url&lt;/code&gt; çš„ &lt;a href=&#34;https://doc.rust-lang.org/stable/std/fmt/trait.Display.html&#34;&gt;Display&lt;/a&gt; æ ¼å¼ï¼Œ
ä¸€ä¸ªåä¸º &lt;code&gt;content_type&lt;/code&gt; çš„æ ‡ç­¾ï¼šå€¼ä¸ºè¡¨è¾¾å¼çš„ &lt;a href=&#34;https://doc.rust-lang.org/stable/std/fmt/trait.Debug.html&#34;&gt;Debug&lt;/a&gt; æ ¼å¼ã€‚&lt;/p&gt;
&lt;p&gt;å°±æ˜¯è¿™ä¹ˆç®€å•ï¼ &lt;code&gt;name = %value&lt;/code&gt; è¾“å‡º &lt;code&gt;Display&lt;/code&gt; ï¼Œ &lt;code&gt;name = ?value&lt;/code&gt; è¾“å‡º &lt;code&gt;Debug&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œè¿˜æœ‰éå¸¸æ£’çš„è·¨åº¦ï¼ˆspansï¼‰ï¼Œé‡ç‚¹æ˜¯ä½ å¯ä»¥å°†å®ƒä»¬å‘é€åˆ° APMï¼ˆAppliation Performance Monitoringï¼‰ï¼Œæ¯”å¦‚ Datadog æˆ–è€… Honeycomb ç­‰ï¼Œä½†æ˜¯è¿™ä¸æ˜¯ä¸€ç¯‡å…³äºè·Ÿè¸ªçš„æ–‡ç« ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ä¸¾ä¾‹è¯´æ˜ï¼Œå¦‚æœæˆ‘ä»¬å®‰è£…ä¸€ä¸ª JSON çš„ tracing subscriberï¼Œæˆ‘ä»¬å°†è·å¾—å¦‚ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo run
   Compiling waytoodeep v0.1.0 (/home/amos/ftl/waytoodeep)
    Finished dev [unoptimized + debuginfo] target(s) in 3.09s
     Running `target/debug/waytoodeep`
{&amp;quot;timestamp&amp;quot;:&amp;quot;Jul 25 17:17:21.531&amp;quot;,&amp;quot;level&amp;quot;:&amp;quot;INFO&amp;quot;,&amp;quot;fields&amp;quot;:{&amp;quot;message&amp;quot;:&amp;quot;Hello from a comfy nest we&#39;ve made for ourselves&amp;quot;},&amp;quot;target&amp;quot;:&amp;quot;waytoodeep&amp;quot;}
{&amp;quot;timestamp&amp;quot;:&amp;quot;Jul 25 17:17:21.709&amp;quot;,&amp;quot;level&amp;quot;:&amp;quot;INFO&amp;quot;,&amp;quot;fields&amp;quot;:{&amp;quot;message&amp;quot;:&amp;quot;Got a response!&amp;quot;,&amp;quot;url&amp;quot;:&amp;quot;https://fasterthanli.me&amp;quot;,&amp;quot;content_type&amp;quot;:&amp;quot;Some(\&amp;quot;text/html; charset=utf-8\&amp;quot;)&amp;quot;},&amp;quot;target&amp;quot;:&amp;quot;waytoodeep&amp;quot;}
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™åº”è¯¥è¶³ä»¥æ¿€èµ·ä½ çš„å…´è¶£ã€‚&lt;/p&gt;
&lt;h3 id=&#34;åŒæ—¶è·å–ä¸¤ä¸ªåœ°å€&#34;&gt;åŒæ—¶è·å–ä¸¤ä¸ªåœ°å€&lt;/h3&gt;
&lt;p&gt;ç°åœ¨è®©æˆ‘ä»¬è·å–ä¸¤ä¸ªåœ°å€ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;pub&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; URL_1: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;str&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;https://fasterthanli.me/articles/whats-in-the-box&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;pub&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; URL_2: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;str&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;https://fasterthanli.me/series/advent-of-code-2020/part-13&amp;#34;&lt;/span&gt;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ã€‚ã€‚ã€‚è¿™æ˜¯ä¸€ä¸ªå…¬å¹³çš„æ¯”è¾ƒã€‚ è¿™ä¸¤ç¯‡æ–‡ç« éƒ½æ‰˜ç®¡åœ¨æˆ‘è‡ªå·±çš„ç½‘ç«™ä¸Šï¼Œç»å¯¹ä¸æ˜¯ä¸ºäº†æ¨å¹¿ï¼Œè€Œæ˜¯ä¸ºäº†ä½¿è·å–æ—¶é—´å…·æœ‰å¯æ¯”æ€§ï¼Œå¹¶ä¸”ä»»ä¸€éƒ½æœ‰å¯èƒ½å…ˆåŠ è½½å®Œæˆï¼ˆå¹¶ä¸”ä¼šéšç€æ—¶é—´çš„æ¨ç§»éšæœºå˜åŒ–ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå‡½æ•°æ¥è·å–å†…å®¹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;fetch_thing&lt;/span&gt;(client: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;Client&lt;/span&gt;, url: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;str&lt;/span&gt;) -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; res &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; client.get(url).send().&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;.error_for_status()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt;url, content_type &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;res.headers().get(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;content-type&amp;#34;&lt;/span&gt;), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Got a response!&amp;#34;&lt;/span&gt;);
    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¹¶ä½¿ç”¨å®ƒï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    setup()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Hello from a comfy nest we&amp;#39;ve made for ourselves&amp;#34;&lt;/span&gt;);

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; client &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Client::new();
    fetch_thing(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;client, URL_1);
    fetch_thing(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;client, URL_2);

    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶åè¿è¡Œå®ƒ:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;$&lt;/span&gt; cargo run
   Compiling waytoodeep v0.&lt;span style=&#34;color:#ae81ff&#34;&gt;1.0&lt;/span&gt; (&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;home&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;amos&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;ftl&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;waytoodeep)
warning: &lt;span style=&#34;color:#a6e22e&#34;&gt;unused&lt;/span&gt; implementer of &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;`&lt;/span&gt;Future&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;`&lt;/span&gt; that must be used
  &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;-&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;src&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;main.rs:&lt;span style=&#34;color:#ae81ff&#34;&gt;15&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;
   &lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt;
&lt;span style=&#34;color:#ae81ff&#34;&gt;15&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt;     fetch_thing(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;client, URL_1);
   &lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;^^^^^^^^^^^^^^^^^^^^^^^^^^^^&lt;/span&gt;
   &lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt;
   &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; note: &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;`&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#[warn(unused_must_use)]&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;`&lt;/span&gt; on by default
   &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; note: &lt;span style=&#34;color:#a6e22e&#34;&gt;futures&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt; nothing unless you &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;`&lt;/span&gt;.&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;`&lt;/span&gt; or poll them

warning: &lt;span style=&#34;color:#a6e22e&#34;&gt;unused&lt;/span&gt; implementer of &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;`&lt;/span&gt;Future&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;`&lt;/span&gt; that must be used
  &lt;span style=&#34;color:#f92672&#34;&gt;-&lt;/span&gt;-&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;src&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;main.rs:&lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;
   &lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt;
&lt;span style=&#34;color:#ae81ff&#34;&gt;16&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt;     fetch_thing(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;client, URL_2);
   &lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt;     &lt;span style=&#34;color:#f92672&#34;&gt;^^^^^^^^^^^^^^^^^^^^^^^^^^^^&lt;/span&gt;
   &lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt;
   &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; note: &lt;span style=&#34;color:#a6e22e&#34;&gt;futures&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;do&lt;/span&gt; nothing unless you &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;`&lt;/span&gt;.&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;`&lt;/span&gt; or poll them

warning: &lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt; warnings emitted

    Finished dev [unoptimized &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; debuginfo] target(s) &lt;span style=&#34;color:#66d9ef&#34;&gt;in&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;3.01&lt;/span&gt;s
     Running &lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;`&lt;/span&gt;target&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;debug&lt;span style=&#34;color:#f92672&#34;&gt;/&lt;/span&gt;waytoodeep&lt;span style=&#34;color:#960050;background-color:#1e0010&#34;&gt;`&lt;/span&gt;
Jul &lt;span style=&#34;color:#ae81ff&#34;&gt;25&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;17&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;26&lt;/span&gt;:&lt;span style=&#34;color:#ae81ff&#34;&gt;31.571&lt;/span&gt;  INFO waytoodeep: &lt;span style=&#34;color:#a6e22e&#34;&gt;Hello&lt;/span&gt; from a comfy nest we&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;ve&lt;/span&gt; made &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; ourselves
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¥‡æ€ªçš„æ˜¯ï¼Œæ²¡æœ‰ä»»ä½•äº‹æƒ…å‘ç”Ÿã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é»„è‰²çš„æ³¢æµªçº¿å’Œæ¼äººçš„ Rust è­¦å‘Šå·²ç»ç»™å‡ºäº†æç¤ºã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è®©æˆ‘ä»¬æ¥ä¿®å¤å®ƒï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;fetch_thing(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;client, URL_1).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
fetch_thing(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;client, URL_2).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo run
   Compiling waytoodeep v0.1.0 (/home/amos/ftl/waytoodeep)
    Finished dev [unoptimized + debuginfo] target(s) in 3.17s
     Running `target/debug/waytoodeep`
Jul 25 17:27:29.768  INFO waytoodeep: Hello from a comfy nest we&#39;ve made for ourselves
Jul 25 17:27:29.891  INFO waytoodeep: Got a response! url=https://fasterthanli.me/articles/whats-in-the-box content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
Jul 25 17:27:29.974  INFO waytoodeep: Got a response! url=https://fasterthanli.me/series/advent-of-code-2020/part-13 content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ‰€ä»¥ï¼Œç¬¬é›¶è¯¾ï¼šfuture å¯¹è±¡ä¸åšä»»ä½•äº‹æƒ…ç›´åˆ°å®ƒä»¬è¢«è½®è¯¢ï¼ˆpolledï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯å› ä¸º future å¯¹è±¡å‡ ä¹å°±æ˜¯çŠ¶æ€ã€‚è®©æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// in `src/main.rs`
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;mod&lt;/span&gt; dumb;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// in `src/dumb.rs`
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; std::{
    future::Future,
    pin::Pin,
    task::{Context, Poll},
};

&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; tracing::info;

&lt;span style=&#34;color:#66d9ef&#34;&gt;pub&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;DumbFuture&lt;/span&gt; {}

&lt;span style=&#34;color:#66d9ef&#34;&gt;impl&lt;/span&gt; Future &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; DumbFuture {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;type&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Output&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ();

    &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;poll&lt;/span&gt;(self: &lt;span style=&#34;color:#a6e22e&#34;&gt;Pin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; Self&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;, _cx: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;mut&lt;/span&gt; Context&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;_&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Poll&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Self::Output&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
        info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Hello from a dumb future!&amp;#34;&lt;/span&gt;);
        Poll::Ready(())
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// back in `src/main.rs`
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    setup()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; fut &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; dumb::DumbFuture {};

    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä»¥ä¸Šï¼æˆ‘ä»¬å‡ ä¹å°±å®Œæˆäº†ï¼Œé™¤äº†æˆ‘ä»¬æ²¡æœ‰è¿›è¡Œ &lt;code&gt;.await&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;è¿è¡Œå®ƒé™¤äº†æ‰“å°è­¦å‘Šä¸ä¼šæœ‰ä»»ä½•æ•ˆæœï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo run
   Compiling waytoodeep v0.1.0 (/home/amos/ftl/waytoodeep)
warning: unused variable: `fut`
  --&amp;gt; src/main.rs:14:9
   |
14 |     let fut = dumb::DumbFuture {};
   |         ^^^ help: if this is intentional, prefix it with an underscore: `_fut`
   |
   = note: `#[warn(unused_variables)]` on by default

warning: 1 warning emitted

    Finished dev [unoptimized + debuginfo] target(s) in 2.11s
     Running `target/debug/waytoodeep`
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å› ä¸ºæ€ä¹ˆå¯èƒ½ï¼Ÿæˆ‘ä»¬å­—é¢ä¸Šä»…ä»…æ„å»ºäº†ä¸€ä¸ªç»“æ„ä½“ã€‚ä¸€ä¸ªé›¶å¤§å°çš„ç»“æ„ä½“ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬è°ƒç”¨å®ƒçš„ &lt;code&gt;.await&lt;/code&gt; ã€‚ã€‚ ç„¶åå½“æˆ‘ä»¬è¦æ±‚è¿è¡Œæ—¶è¿è¡Œå®ƒçš„äº‹ä»¶å¾ªç¯ç›´åˆ° future å¯¹è±¡è¢«è½®è¯¢ï¼ˆpolledï¼‰å¹¶ä¸”æœ€ç»ˆè¿”å› &lt;code&gt;Poll::Ready&lt;/code&gt; ï¼ˆæˆ‘ä»¬çš„ä»£ç ç«‹å³è¿”å›ï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    setup()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Building that dumb future...&amp;#34;&lt;/span&gt;);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; fut &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; dumb::DumbFuture {};
    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Awaiting that dumb future...&amp;#34;&lt;/span&gt;);
    fut.&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;;
    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Done awaiting that dumb future&amp;#34;&lt;/span&gt;);

    Ok(())
}

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo run
   Compiling waytoodeep v0.1.0 (/home/amos/ftl/waytoodeep)
    Finished dev [unoptimized + debuginfo] target(s) in 2.34s
     Running `target/debug/waytoodeep`
Jul 25 17:37:09.261  INFO waytoodeep: Building that dumb future...
Jul 25 17:37:09.261  INFO waytoodeep: Awaiting that dumb future...
Jul 25 17:37:09.261  INFO waytoodeep::dumb: Hello from a dumb future!
Jul 25 17:37:09.262  INFO waytoodeep: Done awaiting that dumb future
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™é‡Œä¸ ECMAScript çš„ &lt;code&gt;promise&lt;/code&gt; æœ‰ä¸€äº›ç•¥å¾®çš„åŒºåˆ«ï¼šå³ä½¿å®ƒä»¬å‹æ ¹æ²¡æœ‰è¢« await å…¶ä¸­åŒ…å«çš„å·¥ä½œä¾ç„¶ä¼šè¢«æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ Rust çš„ future å¯¹è±¡ä»…ä»…æ˜¯æ— èŠçš„çŠ¶æ€æœºï¼Œå¦‚æœä½ æ•…æ„åˆ¶é€ éº»çƒ¦å°±å¯ä»¥ç†è§£è¿™ä¸ªæœºåˆ¶ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// in `src/dumb.rs`
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;impl&lt;/span&gt; Future &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; DumbFuture {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;type&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Output&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ();

    &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;poll&lt;/span&gt;(self: &lt;span style=&#34;color:#a6e22e&#34;&gt;Pin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; Self&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;, _cx: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;mut&lt;/span&gt; Context&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;_&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Poll&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Self::Output&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
        panic&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Oh heck no&amp;#34;&lt;/span&gt;);
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_BACKTRACE=1 cargo run
   Compiling waytoodeep v0.1.0 (/home/amos/ftl/waytoodeep)
    Finished dev [unoptimized + debuginfo] target(s) in 2.28s
     Running `target/debug/waytoodeep`
Jul 25 17:41:18.956  INFO waytoodeep: Building that dumb future...
Jul 25 17:41:18.956  INFO waytoodeep: Awaiting that dumb future...
The application panicked (crashed).
Message:  Oh heck no
Location: src/dumb.rs:14

  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” BACKTRACE â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
                                â‹® 6 frames hidden â‹®
   7: &amp;lt;waytoodeep::dumb::DumbFuture as core::future::future::Future&amp;gt;::poll::h4a44780628f4c5f0
      at /home/amos/ftl/waytoodeep/src/dumb.rs:14
   8: waytoodeep::main::{{closure}}::h36de5a1f1f2a5c5b
      at /home/amos/ftl/waytoodeep/src/main.rs:17
   9: &amp;lt;core::future::from_generator::GenFuture&amp;lt;T&amp;gt; as core::future::future::Future&amp;gt;::poll::h20a96e082c7a581e
      at /home/amos/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80
  10: tokio::park::thread::CachedParkThread::block_on::{{closure}}::hdf98cb3c7fdf3de4
      at /home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/park/thread.rs:263
  11: tokio::coop::with_budget::{{closure}}::h6a86a24a246e220f
      at /home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/coop.rs:106
  12: std::thread::local::LocalKey&amp;lt;T&amp;gt;::try_with::h2ce0ac27c85965b6
      at /home/amos/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/thread/local.rs:376
  13: std::thread::local::LocalKey&amp;lt;T&amp;gt;::with::hc449f38c9f65fb53
      at /home/amos/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/thread/local.rs:352
  14: tokio::coop::with_budget::h5db157bd1e95e0e8
      at /home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/coop.rs:99
  15: tokio::coop::budget::h7b57383f1255ac24
      at /home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/coop.rs:76
  16: tokio::park::thread::CachedParkThread::block_on::hece399485213b91c
      at /home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/park/thread.rs:263
  17: tokio::runtime::enter::Enter::block_on::h89e9882e539e82d3
      at /home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/runtime/enter.rs:151
  18: tokio::runtime::thread_pool::ThreadPool::block_on::h1a0186470c00ba70
      at /home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/runtime/thread_pool/mod.rs:71
  19: tokio::runtime::Runtime::block_on::h7c21d6989b86d606
      at /home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/runtime/mod.rs:452
  20: waytoodeep::main::hb4dd5ffd46a5c032
      at /home/amos/ftl/waytoodeep/src/main.rs:20
  21: core::ops::function::FnOnce::call_once::hc1fcc87431f77d25
      at /home/amos/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ops/function.rs:227
                                â‹® 11 frames hidden â‹®

Run with COLORBT_SHOW_HIDDEN=1 environment variable to disable frame filtering.
Run with RUST_BACKTRACE=full to include source snippets.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¸Šé¢å †æ ˆè·Ÿè¸ªå¦‚æœåŠ ä¸Šé¢œè‰²æ•ˆæœä¼šæ›´å¥½ï¼Œæ‰€ä»¥æˆ‘å¸Œæœ›ä½ åœ¨æœ¬åœ°åšäº†ç›¸åŒçš„å°è¯•ï¼Œå³ä½¿å¦‚æ­¤æˆ‘ä»¬ä¾ç„¶å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çœŸæ­£çš„ main å‡½æ•°åœ¨ 20 å¸§ï¼Œç„¶åå¾€ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° &lt;code&gt;Runtime::block_on&lt;/code&gt;  ã€ä¸€ä¸ªçº¿ç¨‹æ± çš„ä¸œè¥¿ã€ä¸€äº›æŒ‚èµ·ï¼ˆparkedï¼‰çš„çº¿ç¨‹ã€thread-localï¼ˆå…¶ä»– TLSï¼‰ã€ä¸€ä¸ª &lt;strong&gt;&lt;strong&gt;ç”Ÿæˆçš„&lt;/strong&gt;&lt;/strong&gt; futureï¼ˆå¸§ 9 å’Œ 8ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ &lt;code&gt;async fn main&lt;/code&gt; çš„æœ€ç»ˆç»“æœï¼‰ï¼Œæœ€åæ˜¯æˆ‘ä»¬çš„ &lt;code&gt;DumbFuture&lt;/code&gt; poll æ–¹æ³•ï¼ˆå¸§ 7ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å¸§ 6 åˆ° 1 å°±æ˜¯ &lt;a href=&#34;https://doc.rust-lang.org/stable/std/panic/index.html&#34;&gt;panic&lt;/a&gt; æœºåˆ¶ï¼Œå†æ¬¡å®Œå…¨è¶…å‡ºæœ¬æ–‡è®¨è®ºçš„èŒƒå›´ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯è¯·ç«™èµ·æ¥ï¼Œäº²çˆ±çš„è§‚ä¼—ï¼Œç”¨ä½ çš„æ‰‹è‡‚ç»•è¿‡è¿™ä¸ªè£…ç½®ï¼Œä»¥ç¡®ä¿æ²¡æœ‰éšœçœ¼æ³•ï¼Œæ²¡æœ‰éšè—çš„çº¿ï¼Œæ²¡æœ‰ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;ã€‚ã€‚ã€‚æˆ‘è¦è¯´çš„æ˜¯å¯¹äºå¼‚æ­¥å †æ ˆè·Ÿè¸ªæ²¡æœ‰â€œç‰¹æ®Šå¤„ç†â€ï¼ˆspecial handlingï¼‰ã€‚å½“ç„¶ï¼Œè¿™é‡Œæˆ‘ä»¬å´©æºƒäº†ï¼Œä½†æ˜¯ä»…ä»…æ˜¯ Rustï¼Œæ“ä½œç³»ç»Ÿç”šè‡³ä¸çŸ¥é“æˆ‘å‡ ä¹é¿å…äº†ä¸€åœºç¾éš¾ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ¶é€ æ›´å¤§çš„æ··ä¹±ï¼Œå¦‚æœæˆ‘ä»¬æ„¿æ„ä½¿ç”¨ &lt;code&gt;unsafe&lt;/code&gt; ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;impl&lt;/span&gt; Future &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; DumbFuture {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;type&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Output&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ();

    &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;poll&lt;/span&gt;(self: &lt;span style=&#34;color:#a6e22e&#34;&gt;Pin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; Self&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;, _cx: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;mut&lt;/span&gt; Context&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;_&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Poll&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Self::Output&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
        &lt;span style=&#34;color:#66d9ef&#34;&gt;unsafe&lt;/span&gt; {
            &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;(&lt;span style=&#34;color:#ae81ff&#34;&gt;0xF00D&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;as&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;u64&lt;/span&gt;) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0x0&lt;/span&gt;;
        }
        unreachable&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(); &lt;span style=&#34;color:#75715e&#34;&gt;// pinky promise
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶åå°±ä¸ä¼šæœ‰ä¸€äº›åˆ—çš„å´©æºƒå¤„ç†æ¥æ‹¯æ•‘æˆ‘ä»¬ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_BACKTRACE=1 cargo run
   Compiling waytoodeep v0.1.0 (/home/amos/ftl/waytoodeep)
    Finished dev [unoptimized + debuginfo] target(s) in 2.18s
     Running `target/debug/waytoodeep`
Jul 25 17:46:53.926  INFO waytoodeep: Building that dumb future...
Jul 25 17:46:53.926  INFO waytoodeep: Awaiting that dumb future...
zsh: segmentation fault (core dumped)  RUST_BACKTRACE=1 cargo run
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä½†æ˜¯ GDB å¯ä»¥ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo build &amp;amp;&amp;amp; gdb --quiet --args ./target/debug/waytoodeep
    Finished dev [unoptimized + debuginfo] target(s) in 0.04s
Reading symbols from ./target/debug/waytoodeep...
warning: Missing auto-load script at offset 0 in section .debug_gdb_scripts
of file /home/amos/ftl/waytoodeep/target/debug/waytoodeep.
Use `info auto-load python-scripts [REGEXP]&#39; to list them.
(gdb) r
Starting program: /home/amos/ftl/waytoodeep/target/debug/waytoodeep
[Thread debugging using libthread_db enabled]
Using host libthread_db library &amp;quot;/lib/x86_64-linux-gnu/libthread_db.so.1&amp;quot;.
[New Thread 0x7ffff7c28700 (LWP 129418)]
[New Thread 0x7ffff7a27700 (LWP 129419)]
[New Thread 0x7ffff7826700 (LWP 129420)]
[New Thread 0x7ffff7625700 (LWP 129421)]
[New Thread 0x7ffff7424700 (LWP 129422)]
[New Thread 0x7ffff7223700 (LWP 129423)]
[New Thread 0x7ffff7022700 (LWP 129424)]
[New Thread 0x7ffff6e1e700 (LWP 129425)]
[New Thread 0x7ffff6c1a700 (LWP 129426)]
[New Thread 0x7ffff6a16700 (LWP 129427)]
[New Thread 0x7ffff6812700 (LWP 129428)]
[New Thread 0x7ffff660e700 (LWP 129429)]
[New Thread 0x7ffff640a700 (LWP 129430)]
[New Thread 0x7ffff6206700 (LWP 129431)]
[New Thread 0x7ffff6002700 (LWP 129432)]
Jul 25 17:47:13.278  INFO waytoodeep: Building that dumb future...
Jul 25 17:47:13.279  INFO waytoodeep: Awaiting that dumb future...

Thread 1 &amp;quot;waytoodeep&amp;quot; received signal SIGSEGV, Segmentation fault.
&amp;lt;waytoodeep::dumb::DumbFuture as core::future::future::Future&amp;gt;::poll (self=..., _cx=0x7fffffffd690) at src/dumb.rs:15
15                  *(0xF00D as *mut u64) = 0x0;
(gdb) bt
#0  &amp;lt;waytoodeep::dumb::DumbFuture as core::future::future::Future&amp;gt;::poll (self=..., _cx=0x7fffffffd690) at src/dumb.rs:15
#1  0x00005555555ab3a3 in waytoodeep::main::{{closure}} () at src/main.rs:17
#2  0x00005555555adb29 in &amp;lt;core::future::from_generator::GenFuture&amp;lt;T&amp;gt; as core::future::future::Future&amp;gt;::poll (self=..., cx=0x7fffffffd690)
    at /home/amos/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80
#3  0x00005555555adaa0 in tokio::park::thread::CachedParkThread::block_on::{{closure}} ()
    at /home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/park/thread.rs:263
#4  0x00005555555b1742 in tokio::coop::with_budget::{{closure}} (cell=0x7ffff7c2c412)
    at /home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/coop.rs:106
#5  0x00005555555a9f58 in std::thread::local::LocalKey&amp;lt;T&amp;gt;::try_with (self=0x555555925fc0, f=...)
    at /home/amos/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/thread/local.rs:376
#6  0x00005555555a9e3d in std::thread::local::LocalKey&amp;lt;T&amp;gt;::with (self=0x555555925fc0, f=...)
    at /home/amos/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/thread/local.rs:352
#7  0x00005555555ad7c8 in tokio::coop::with_budget (budget=..., f=...)
    at /home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/coop.rs:99
#8  tokio::coop::budget (f=...) at /home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/coop.rs:76
#9  tokio::park::thread::CachedParkThread::block_on (self=0x7fffffffd7a0, f=...)
    at /home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/park/thread.rs:263
#10 0x00005555555abcc9 in tokio::runtime::enter::Enter::block_on (self=0x7fffffffd7f0, f=...)
    at /home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/runtime/enter.rs:151
#11 0x00005555555acf2e in tokio::runtime::thread_pool::ThreadPool::block_on (self=0x7fffffffd908, future=...)
    at /home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/runtime/thread_pool/mod.rs:71
#12 0x00005555555b0dfd in tokio::runtime::Runtime::block_on (self=0x7fffffffd900, future=...)
    at /home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/runtime/mod.rs:452
#13 0x00005555555aa807 in waytoodeep::main () at src/main.rs:20
(gdb)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ‘ä»¬å†æ¬¡ä¸¢å¤±äº†é«˜äº®é¢œè‰²ï¼Œè¿™é‡Œå¯ä»¥çœ‹ä¸€ä¸‹ï¼š
&lt;img src=&#34;https://fasterthanli.me/content/articles/understanding-rust-futures-by-going-way-too-deep/assets/gdb-colors.b45af429c46a37d9.webp&#34; alt=&#34;&#34;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¯‘æ³¨ï¼šæˆ‘åœ¨æœ¬åœ°ç¯å¢ƒå¹¶æ²¡æœ‰é€šè¿‡ GDB å¤ç°å¸¦é«˜äº®çš„å †æ ˆè·Ÿè¸ªï¼Œåè€Œæ˜¯é€šè¿‡ LLDB å¯ä»¥çœ‹åˆ°é«˜äº®çš„å †æ ˆè·Ÿè¸ªã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ˜¯ä¸æ˜¯å¾ˆæ¼‚äº®ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç°åœ¨è®©æˆ‘ä»¬å›åˆ°æ­£å¸¸æœ‰ç”¨çš„ä»£ç ï¼Œç§»é™¤æ‰€æœ‰å…³äºè‡ªå·±å®ç°çš„ future ä»£ç ï¼š &lt;code&gt;src/dumb.rs&lt;/code&gt; å’Œ &lt;code&gt;mod dumb&lt;/code&gt; ã€‚å¹¶ä½¿ç”¨ä¸€ä¸ªè·å– future æ›¿ä»£ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    setup()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Building that fetch future...&amp;#34;&lt;/span&gt;);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; client &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Client::new();
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; fut &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fetch_thing(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;client, URL_1);
    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Awaiting that fetch future...&amp;#34;&lt;/span&gt;);
    fut.&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Done awaiting that fetch future&amp;#34;&lt;/span&gt;);

    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_BACKTRACE=1 cargo run
   Compiling waytoodeep v0.1.0 (/home/amos/ftl/waytoodeep)
    Finished dev [unoptimized + debuginfo] target(s) in 2.99s
     Running `target/debug/waytoodeep`
Jul 25 17:51:49.281  INFO waytoodeep: Building that fetch future...
Jul 25 17:51:49.282  INFO waytoodeep: Awaiting that fetch future...
Jul 25 17:51:49.437  INFO waytoodeep: Got a response! url=https://fasterthanli.me/articles/whats-in-the-box content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
Jul 25 17:51:49.438  INFO waytoodeep: Done awaiting that fetch future
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æœ‰ä¸¤ç§æ–¹å¼è€ƒè™‘æˆ‘ä»¬çš„å‡½æ•°ï¼Œä¸€ä¸ªæ˜¯è¯­æ³•ç³–å±‚ï¼šä¹Ÿå°±æ˜¯ &lt;code&gt;async fn&lt;/code&gt; ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;fetch_thing&lt;/span&gt;(client: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;Client&lt;/span&gt;, url: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;str&lt;/span&gt;) -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; res &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; client.get(url).send().&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;.error_for_status()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt;url, content_type &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;res.headers().get(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;content-type&amp;#34;&lt;/span&gt;), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Got a response!&amp;#34;&lt;/span&gt;);
    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶åæ˜¯æ ¸å¿ƒå®ç°å±‚ï¼šä¸€ä¸ªæ™®é€šçš„ &lt;code&gt;fn&lt;/code&gt; ä»…ç”¨æ¥è¿”å›ä¸€ä¸ª future å¯¹è±¡ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; std::future::Future;

&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;fetch_thing&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;(
    client: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt; Client,
    url: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;str&lt;/span&gt;,
) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;impl&lt;/span&gt; Future&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt; {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;move&lt;/span&gt; {
        &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; res &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; client.get(url).send().&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;.error_for_status()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
        info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt;url, content_type &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;res.headers().get(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;content-type&amp;#34;&lt;/span&gt;), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Got a response!&amp;#34;&lt;/span&gt;);
        Ok(())
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç”±äºå€Ÿç”¨ &lt;code&gt;client&lt;/code&gt; å’Œ &lt;code&gt;url&lt;/code&gt; ï¼Œæ‰€ä»¥ &lt;code&gt;Future&lt;/code&gt; å¯¹è±¡çš„å­˜æ´»æ—¶é—´ä¸èƒ½è¶…è¿‡ä¸¤è€…ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä¼šå°†ä¸Šé¢ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸå‘½åä¸º &lt;code&gt;&#39;a&lt;/code&gt; ï¼Œ
å¹¶ä¸”è¿”å›çš„å€¼ä¹Ÿæ˜¯ä»»æ„å®ç°äº† &lt;code&gt;Future&lt;/code&gt; ï¼ˆé€šè¿‡ &lt;code&gt;Output&lt;/code&gt; ï¼‰åŒæ—¶ç”Ÿå‘½å‘¨æœŸä¹Ÿæ˜¯ &lt;code&gt;&#39;a&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;æ•´ä¸ª &lt;code&gt;async move {}&lt;/code&gt; å¿«ä¹Ÿä»…ä»…æ˜¯â€œæ„å»ºçŠ¶æ€â€ &amp;ndash; ç­‰äºä¸€ä¸ªå®ç°äº† &lt;code&gt;Future&lt;/code&gt; çš„ç±»å‹ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åªæ˜¯æ— æ³•å‘½åå®ƒã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åªèƒ½å°½é‡è·å–å®ƒçš„æè¿°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;type_name_of&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;T&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;(_: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;T&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&amp;#39;static &lt;span style=&#34;color:#66d9ef&#34;&gt;str&lt;/span&gt; {
    std::any::type_name::&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;T&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;()
}

&lt;span style=&#34;color:#75715e&#34;&gt;// in main
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    setup()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Building that fetch future...&amp;#34;&lt;/span&gt;);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; client &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Client::new();
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; fut &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fetch_thing(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;client, URL_1);
    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(
        type_name &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; type_name_of(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;fut),
        &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;That fetch future has a type..&amp;#34;&lt;/span&gt;
    );
    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Awaiting that fetch future...&amp;#34;&lt;/span&gt;);
    fut.&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Done awaiting that fetch future&amp;#34;&lt;/span&gt;);

    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo run
    Finished dev [unoptimized + debuginfo] target(s) in 0.05s
     Running `target/debug/waytoodeep`
Jul 25 18:00:39.774  INFO waytoodeep: Building that fetch future...
Jul 25 18:00:39.775  INFO waytoodeep: That fetch future has a type.. type_name=&amp;quot;core::future::from_generator::GenFuture&amp;lt;waytoodeep::fetch_thing::{{closure}}&amp;gt;&amp;quot;
Jul 25 18:00:39.775  INFO waytoodeep: Awaiting that fetch future...
Jul 25 18:00:39.882  INFO waytoodeep: Got a response! url=https://fasterthanli.me/articles/whats-in-the-box content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
Jul 25 18:00:39.882  INFO waytoodeep: Done awaiting that fetch future
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ã€‚ã€‚ã€‚ä½†æ˜¯ç­‰ç­‰ï¼Œç”±äºæˆ‘ä»¬ä½¿ç”¨äº† &lt;code&gt;async&lt;/code&gt; è¯­æ³•æ‰€ä»¥å®ƒæ˜¯ä¸€ä¸ªç¼–è¯‘å™¨ç”Ÿæˆçš„ç±»å‹ã€‚æŸç§æ„ä¹‰ä¸Šæˆ‘ä»¬æ— æ³•å‘½åå®ƒä¹Ÿå°±æ„å‘³è¿™æˆ‘ä»¬æ— æ³•ç»‘å®šè¿™ä¸ªå¯¹è±¡ï¼Œæˆ–è€…ç¼–å†™ä¸€ä¸ªå‡½æ•°ä»…ä»…æ¥å—è¯¥ç±»å‹ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©æˆ‘ä»¬è‡ªå·±ç›¸ä¿¡ future å¯¹è±¡åœ¨æˆ‘ä»¬çœŸæ­£è½®è¯¢å®ƒä¹‹å‰å®ƒä¸ä¼šåšä»»ä½•å·¥ä½œï¼Œæˆ‘ä»¬å¯ä»¥æ‰“å¼€ &lt;code&gt;reqwest&lt;/code&gt; çš„è°ƒè¯•æ—¥å¿—ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info,reqwest=debug cargo run
   Compiling waytoodeep v0.1.0 (/home/amos/ftl/waytoodeep)
    Finished dev [unoptimized + debuginfo] target(s) in 3.07s
     Running `target/debug/waytoodeep`
Jul 25 18:05:07.384  INFO waytoodeep: Building that fetch future...
Jul 25 18:05:07.385  INFO waytoodeep: That fetch future has a type.. type_name=&amp;quot;core::future::from_generator::GenFuture&amp;lt;waytoodeep::fetch_thing::{{closure}}&amp;gt;&amp;quot;
Jul 25 18:05:07.385  INFO waytoodeep: Awaiting that fetch future...
Jul 25 18:05:07.385 DEBUG reqwest::connect: starting new connection: https://fasterthanli.me/
Jul 25 18:05:07.503 DEBUG reqwest::async_impl::client: response &#39;200 OK&#39; for https://fasterthanli.me/articles/whats-in-the-box
Jul 25 18:05:07.503  INFO waytoodeep: Got a response! url=https://fasterthanli.me/articles/whats-in-the-box content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
Jul 25 18:05:07.503  INFO waytoodeep: Done awaiting that fetch future
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç”šè‡³å¯¹äºæ¯ä¸€ä¸ªåŒ…ï¼ˆcrateï¼‰ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥é€šè¿‡ç›‘å¬ &lt;a href=&#34;https://lib.rs/crates/hyper&#34;&gt;hyper&lt;/a&gt; å’Œ &lt;a href=&#34;https://lib.rs/crates/h2&#34;&gt;h2&lt;/a&gt; æ¥è§‚å¯Ÿï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=debug cargo run
    Finished dev [unoptimized + debuginfo] target(s) in 0.04s
     Running `target/debug/waytoodeep`
Jul 25 18:05:59.973  INFO waytoodeep: Building that fetch future...
Jul 25 18:05:59.973  INFO waytoodeep: That fetch future has a type.. type_name=&amp;quot;core::future::from_generator::GenFuture&amp;lt;waytoodeep::fetch_thing::{{closure}}&amp;gt;&amp;quot;
Jul 25 18:05:59.973  INFO waytoodeep: Awaiting that fetch future...
Jul 25 18:05:59.974 DEBUG reqwest::connect: starting new connection: https://fasterthanli.me/
Jul 25 18:05:59.974 DEBUG hyper::client::connect::dns: resolving host=&amp;quot;fasterthanli.me&amp;quot;
Jul 25 18:05:59.989 DEBUG hyper::client::connect::http: connecting to 172.67.196.144:443
Jul 25 18:06:00.000 DEBUG hyper::client::connect::http: connected to 172.67.196.144:443
Jul 25 18:06:00.000 DEBUG rustls::client::hs: No cached session for DNSNameRef(&amp;quot;fasterthanli.me&amp;quot;)
Jul 25 18:06:00.000 DEBUG rustls::client::hs: Not resuming any session
Jul 25 18:06:00.016 DEBUG rustls::client::hs: Using ciphersuite TLS13_CHACHA20_POLY1305_SHA256
Jul 25 18:06:00.016 DEBUG rustls::client::tls13: Not resuming
Jul 25 18:06:00.017 DEBUG rustls::client::tls13: TLS1.3 encrypted extensions: [ServerNameAck, Protocols([PayloadU8([104, 50])])]
Jul 25 18:06:00.017 DEBUG rustls::client::hs: ALPN protocol is Some(b&amp;quot;h2&amp;quot;)
Jul 25 18:06:00.018 DEBUG h2::client: binding client connection
Jul 25 18:06:00.018 DEBUG h2::client: client connection bound
Jul 25 18:06:00.018 DEBUG h2::codec::framed_write: send frame=Settings { flags: (0x0), enable_push: 0, initial_window_size: 2097152, max_frame_size: 16384 }
Jul 25 18:06:00.019 DEBUG Connection{peer=Client}: h2::codec::framed_write: send frame=WindowUpdate { stream_id: StreamId(0), size_increment: 5177345 }
Jul 25 18:06:00.019 DEBUG hyper::client::pool: pooling idle connection for (&amp;quot;https&amp;quot;, fasterthanli.me)
Jul 25 18:06:00.020 DEBUG Connection{peer=Client}: h2::codec::framed_write: send frame=Headers { stream_id: StreamId(1), flags: (0x5: END_HEADERS | END_STREAM) }
Jul 25 18:06:00.029 DEBUG Connection{peer=Client}: rustls::client::tls13: Ticket saved
Jul 25 18:06:00.029 DEBUG Connection{peer=Client}: rustls::client::tls13: Ticket saved
Jul 25 18:06:00.029 DEBUG Connection{peer=Client}: h2::codec::framed_read: received frame=Settings { flags: (0x0), max_concurrent_streams: 256, initial_window_size: 65536, max_frame_size: 16777215 }
Jul 25 18:06:00.030 DEBUG Connection{peer=Client}: h2::codec::framed_write: send frame=Settings { flags: (0x1: ACK) }
Jul 25 18:06:00.030 DEBUG Connection{peer=Client}: h2::codec::framed_read: received frame=WindowUpdate { stream_id: StreamId(0), size_increment: 2147418112 }
Jul 25 18:06:00.041 DEBUG Connection{peer=Client}: h2::codec::framed_read: received frame=Settings { flags: (0x1: ACK) }
Jul 25 18:06:00.041 DEBUG Connection{peer=Client}: h2::proto::settings: received settings ACK; applying Settings { flags: (0x0), enable_push: 0, initial_window_size: 2097152, max_frame_size: 16384 }
Jul 25 18:06:00.120 DEBUG Connection{peer=Client}: h2::codec::framed_read: received frame=Headers { stream_id: StreamId(1), flags: (0x4: END_HEADERS) }
Jul 25 18:06:00.120 DEBUG Connection{peer=Client}: h2::codec::framed_read: received frame=Data { stream_id: StreamId(1) }
Jul 25 18:06:00.121 DEBUG reqwest::async_impl::client: response &#39;200 OK&#39; for https://fasterthanli.me/articles/whats-in-the-box
Jul 25 18:06:00.121  INFO waytoodeep: Got a response! url=https://fasterthanli.me/articles/whats-in-the-box content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
Jul 25 18:06:00.121  INFO waytoodeep: Done awaiting that fetch future
Jul 25 18:06:00.121 DEBUG Connection{peer=Client}: h2::codec::framed_read: received frame=Data { stream_id: StreamId(1) }
Jul 25 18:06:00.122 DEBUG Connection{peer=Client}: h2::codec::framed_write: send frame=Reset { stream_id: StreamId(1), error_code: CANCEL }
Jul 25 18:06:00.122 DEBUG Connection{peer=Client}: h2::codec::framed_write: send frame=GoAway { error_code: NO_ERROR, last_stream_id: StreamId(0) }
Jul 25 18:06:00.122 DEBUG Connection{peer=Client}: h2::proto::connection: Connection::poll; connection error error=NO_ERROR
Jul 25 18:06:00.122 DEBUG Connection{peer=Client}: rustls::session: Sending warning alert CloseNotify
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;ä¸Šé¢å‡ºç°äº† rustlsï¼Œå¹¶ä¸”ä½¿ç”¨äº† TLS 1.3ï¼Œä½œè€…åšè¿‡&lt;a href=&#34;https://www.youtube.com/watch?v=YHIiVsFybLA&#34;&gt;ä¸€æœŸè§†é¢‘&lt;/a&gt;ä»‹ç»è¿‡ TLS 1.3ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™äº›åº”è¯¥è¶³å¤Ÿè¯´æœä½ ï¼Œé™¤éä½ åªç›¸ä¿¡å†…æ ¸æ‰€è¯´çš„ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬çœ‹çœ‹è°ƒç”¨å †æ ˆåªä¸ºäº†æ›´åŠ ç¡®å®šã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨ &lt;code&gt;await&lt;/code&gt; future å¯¹è±¡ä¹‹å‰å¢åŠ ä¸€ç§’é’Ÿçš„ä¼‘çœ ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; tokio::time::sleep;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; std::time::Duration;

&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    setup()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Building that fetch future...&amp;#34;&lt;/span&gt;);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; client &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Client::new();
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; fut &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fetch_thing(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;client, URL_1);
    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Sleeping for a bit...&amp;#34;&lt;/span&gt;);
    sleep(Duration::from_secs(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;;
    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Awaiting that fetch future...&amp;#34;&lt;/span&gt;);
    fut.&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Done awaiting that fetch future&amp;#34;&lt;/span&gt;);

    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo build &amp;amp;&amp;amp; strace -e &#39;connect&#39; ./target/debug/waytoodeep
   Compiling waytoodeep v0.1.0 (/home/amos/ftl/waytoodeep)
    Finished dev [unoptimized + debuginfo] target(s) in 3.13s
Jul 25 18:09:36.595  INFO waytoodeep: Building that fetch future...
Jul 25 18:09:36.596  INFO waytoodeep: Sleeping for a bit...
Jul 25 18:09:37.599  INFO waytoodeep: Awaiting that fetch future...
connect(9, {sa_family=AF_INET, sin_port=htons(443), sin_addr=inet_addr(&amp;quot;104.21.92.169&amp;quot;)}, 16) = -1 EINPROGRESS (Operation now in progress)
Jul 25 18:09:37.720  INFO waytoodeep: Got a response! url=https://fasterthanli.me/articles/whats-in-the-box content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
Jul 25 18:09:37.721  INFO waytoodeep: Done awaiting that fetch future
+++ exited with 0 +++
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å†æ¬¡å¼ºè°ƒï¼Œé™„ä¸Šä¼šè®©æ˜¾è‘—æé«˜ä¸Šé¢ä¿¡æ¯çš„å¯è¯»æ€§ï¼Œå¦‚æœä¸è®©æˆ‘é€‰æ‹©å®ƒä»¬çš„è¯æˆ‘æ˜¯éå¸¸å–œæ¬¢é«˜äº®çš„ã€‚æˆ‘æœ¬åœ°çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š
&lt;img src=&#34;https://fasterthanli.me/content/articles/understanding-rust-futures-by-going-way-too-deep/assets/strace-colors.a4163f4bda179c2b.webp&#34; alt=&#34;&#34;&gt;
ç”±äº &lt;code&gt;tracing-subscriber&lt;/code&gt; é»˜è®¤æ ¼å¼ä¼šè¾“å‡ºæ—¶é—´æˆ³ï¼Œå¯ä»¥çœ‹åˆ°ç¨‹åºä¼‘çœ äº†1åˆ†é’Ÿï¼ˆå¤–åŠ 3æ¯«ç§’ï¼‰ï¼Œè€Œä¸”åªæœ‰æˆ‘ä»¬çœŸæ­£è°ƒç”¨ &lt;code&gt;await&lt;/code&gt; æ—¶æˆ‘ä»¬çš„ç¨‹åºæ‰ä¼šå¼€å§‹è¿æ¥åˆ°æ‰˜ç®¡æ–‡ç« çš„ CDN èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;å¥½äº†ï¼è®©æˆ‘ä»¬å†æ¬¡å°è¯•æ‹‰å–ä¸¤ç¯‡æ–‡ç« ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    setup()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; client &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Client::new();

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; fut1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fetch_thing(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;client, URL_1);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; fut2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fetch_thing(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;client, URL_2);

    fut1.&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    fut2.&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å†æ¬¡æ£€æŸ¥æ—¥å¿—ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info,reqwest=debug cargo run --quiet
Jul 25 18:31:47.396 DEBUG reqwest::connect: starting new connection: https://fasterthanli.me/
Jul 25 18:31:47.536 DEBUG reqwest::async_impl::client: response &#39;200 OK&#39; for https://fasterthanli.me/articles/whats-in-the-box
Jul 25 18:31:47.537  INFO waytoodeep: Got a response! url=https://fasterthanli.me/articles/whats-in-the-box content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
Jul 25 18:31:47.627 DEBUG reqwest::async_impl::client: response &#39;200 OK&#39; for https://fasterthanli.me/series/advent-of-code-2020/part-13
Jul 25 18:31:47.627  INFO waytoodeep: Got a response! url=https://fasterthanli.me/series/advent-of-code-2020/part-13 content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;éå¸¸æœ‰è¶£ã€‚ä»è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œ &lt;code&gt;reqwest&lt;/code&gt; ä¸ºä¸¤ä¸ªè¯·æ±‚å¤ç”¨äº†ç›¸åŒçš„è¿æ¥ã€‚æˆ‘ä¼šè¿™ä¹ˆè¯´æ˜¯å› æˆ‘åªçœ‹åˆ°äº†ä¸€è¡Œ &lt;code&gt;reqwest::connect&lt;/code&gt; æ—¥å¿—ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬å¿«é€Ÿé€šè¿‡ &lt;code&gt;strace&lt;/code&gt; æ£€æŸ¥ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo build --quiet &amp;amp;&amp;amp; strace -e &#39;connect&#39; ./target/debug/waytoodeep &amp;gt; /dev/null
connect(9, {sa_family=AF_INET, sin_port=htons(443), sin_addr=inet_addr(&amp;quot;172.67.196.144&amp;quot;)}, 16) = -1 EINPROGRESS (Operation now in progress)
+++ exited with 0 +++
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç°åœ¨å¯ä»¥ç¡®è®¤äº†ï¼Œåªæœ‰ä¸€æ¬¡è¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œç¬¬ä¸€ä¸ªè¯·æ±‚å®Œæˆåæ‰å¼€å§‹äº†ç¬¬äºŒä¸ªè¯·æ±‚ã€‚ç¬¬ä¸€ä¸ªè€—è´¹äº† &lt;code&gt;536-396 = 140&lt;/code&gt; æ¯«ç§’ï¼Œä½†æ˜¯ç¬¬äºŒä¸ªè€—è´¹äº† &lt;code&gt;627-537 = 90&lt;/code&gt; æ¯«ç§’ï¼&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Emmmï¼Œç°åœ¨æˆ‘ä»¬è¿è¡Œæ„å»ºçš„æ˜¯ debug ç‰ˆæœ¬ä¸æ˜¯å—ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™æ˜¯çœŸçš„ã€‚æˆ‘ç¡®ä¿¡æˆ‘ä»¬é¢ä¸´çš„æ˜¯ IO å¯†é›†å‹ï¼Œè€Œä¸æ˜¯ CPU å¯†é›†å‹ã€‚&lt;/p&gt;
&lt;p&gt;debug ç‰ˆæœ¬çš„æ„å»ºç»å¯¹æœ‰ä¸€äº›é¢å¤–çš„å¼€é”€ï¼Œä½†æ˜¯æˆ‘æ€€ç–‘è¿™é‡Œå®ƒä¸ä¼šå¤ªå½±å“å»¶è¿Ÿã€‚æ— è®ºå¦‚ä½•ï¼Œè®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹ï¼š
ï¼ˆæ³¨æ„ &amp;ndash;releaseï¼‰&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info,reqwest=debug cargo run --quiet --release
Jul 25 18:34:59.211 DEBUG reqwest::connect: starting new connection: https://fasterthanli.me/
Jul 25 18:34:59.343 DEBUG reqwest::async_impl::client: response &#39;200 OK&#39; for https://fasterthanli.me/articles/whats-in-the-box
Jul 25 18:34:59.343  INFO waytoodeep: Got a response! url=https://fasterthanli.me/articles/whats-in-the-box content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
Jul 25 18:34:59.427 DEBUG reqwest::async_impl::client: response &#39;200 OK&#39; for https://fasterthanli.me/series/advent-of-code-2020/part-13
Jul 25 18:34:59.427  INFO waytoodeep: Got a response! url=https://fasterthanli.me/series/advent-of-code-2020/part-13 content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ‘ä»¬è®¡ç®—ä¸€ä¸‹å»¶è¿Ÿ &lt;code&gt;343-211 = 132ms&lt;/code&gt; ï¼Œ &lt;code&gt;427-343 = 84ms&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;å‡ æ¯«ç§’çš„å·®å¼‚å¯èƒ½çš„è§£é‡Šæ˜¯é‚»å±…æ‰“å¼€äº†ä¸€ä¸ª YouTube è§†é¢‘å¯¼è‡´æ— çº¿ç”µæ³¢çˆ†å‘ï¼Œä»è€Œå¯¼è‡´å†²çªï¼ˆ802.11 æ²¡æœ‰ç©ºä¸­æµé‡æ§åˆ¶ï¼Œå…¨æ°‘è‡ªç”±ï¼ˆfree-for-allï¼‰ï¼‰å’Œé‡ä¼ ã€‚&lt;/p&gt;
&lt;p&gt;æˆ–è€…å¦å¤–ä¸€ç™¾ä¸‡ä¸ªåŸå› ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä¸ç»§ç»­åˆ†æçš„åŸå› ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬å›åˆ°æ–‡ç« çš„ä¸»é¢˜ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç­‰å¾…ç¬¬ä¸€ä¸ªå®Œæˆ&#34;&gt;ç­‰å¾…ç¬¬ä¸€ä¸ªå®Œæˆ&lt;/h3&gt;
&lt;p&gt;æ˜¯çš„ï¼ç­‰å¾…ç¬¬ä¸€ä¸ªå®Œæˆã€‚æ‰€ä»¥æˆ‘ä»¬å¦‚ä½•è®©ç¨‹åºåŒæ—¶è¯·æ±‚ä¸¤ä¸ªï¼Ÿ&lt;/p&gt;
&lt;p&gt;å…¶å®æœ‰ä¸€å¤§å †æ–¹å¼ï¼&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªæ‰§è¡Œå™¨ä¸Šæ‰§è¡Œï¼ˆ &lt;code&gt;spawn&lt;/code&gt; ï¼‰è¿™äº› future å¯¹è±¡ï¼Œç„¶åä¼‘çœ ä¸€ç§’é’Ÿã€‚1 ç§’é’Ÿè¶³å¤Ÿäº†å§ï¼Ÿ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    setup()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; client &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Client::new();

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; fut1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fetch_thing(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;client, URL_1);
    tokio::spawn(fut1);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; fut2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fetch_thing(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;client, URL_2);
    tokio::spawn(fut2);

    tokio::time::sleep(Duration::from_secs(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;;

    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info,reqwest=debug cargo run --quiet --release
error[E0597]: `client` does not live long enough
  --&amp;gt; src/main.rs:17:28
   |
17 |     let fut1 = fetch_thing(&amp;amp;client, URL_1);
   |                ------------^^^^^^^--------
   |                |           |
   |                |           borrowed value does not live long enough
   |                argument requires that `client` is borrowed for `&#39;static`
...
25 | }
   | - `client` dropped here while still borrowed

error: aborting due to previous error

For more information about this error, try `rustc --explain E0597`.
error: could not compile `waytoodeep`

To learn more, run the command again with --verbose.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;é¢ï¼Œé™¤éæˆ‘ä»¬ä¸å¯ä»¥ã€‚ä¸å¯ä»¥æ˜¯å› ä¸ºã€‚ã€‚ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æˆ‘ä»¬å°†ã€Œfuture å¯¹è±¡äº¤ç»™æ‰§è¡Œå™¨æ‰§è¡Œã€å¹¶å°† future å¯¹è±¡è½¬äº¤ç»™æ‰§è¡Œå™¨ï¼Œå¯¹å§ï¼Ÿæˆ‘ä»¬è½¬ç§»äº†å®ƒå’Œå®ƒçš„å†…å®¹çš„æ‰€æœ‰æƒã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå³ä½¿æˆ‘ä»¬ä¸å¯¹å…¶è¿›è¡Œ &lt;code&gt;await&lt;/code&gt; ï¼Œfuture å¯¹è±¡å› ä¸ºæ˜¯ã€Œæ‰§è¡Œå™¨éœ€è¦åšã€çš„ä¸€éƒ¨åˆ†ä¾ç„¶ä¼šè¢«æ‰§è¡Œï¼Œæ‰€ä»¥å³ä½¿æˆ‘ä»¬ä» &lt;code&gt;main&lt;/code&gt; è¿”å› future å¯¹è±¡ä¹Ÿä¼šè¢«è½®è¯¢ï¼ˆpolledï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å¦‚æœæˆ‘ä»¬ä» &lt;code&gt;main&lt;/code&gt; è¿”å›ï¼Œåˆ™æ•´ä¸ªç¨‹åºéƒ½ä¼šé€€å‡ºã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œä¹Ÿå¯ä»¥æ˜¯ä»»ä½•å‡½æ•°ï¼ˆè¿™é‡Œæ˜¯ &lt;code&gt;main&lt;/code&gt; ï¼‰ã€‚é‡è¦çš„æ˜¯å¦‚æœå‡½æ•°è¿”å›äº†ä½†æ˜¯ future å¯¹è±¡å€Ÿç”¨äº†éƒ¨åˆ†æ•°æ®å°†æ— æ³•é€šè¿‡å€Ÿç”¨æ£€æŸ¥å™¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™è®©æˆ‘å¾ˆé«˜å…´ï¼Œå› ä¸ºè¿™æ„å‘³ç€æˆ‘ä»¬ä¸ä¼šæ„å¤–è®¿é—®åˆ°ä¸€äº›è¢«é‡Šæ”¾çš„èµ„æºï¼š&lt;a href=&#34;https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=use+after+free&#34;&gt;UAF&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæˆ‘ä»¬çš„ä¾‹å­æ²¡æœ‰å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ã€‚ã€‚ã€‚æˆ‘ä»¬éœ€è¦è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å¦‚æœ &lt;code&gt;fetch_thing&lt;/code&gt; è¿”å›çš„ future å¯¹è±¡æ˜¯ &lt;code&gt;&#39;static&lt;/code&gt; çš„å‘¢ï¼Ÿæˆ–è€…å®ƒä¸å€Ÿç”¨ä»»ä½•ä¸œè¥¿ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç¨‹åºç°åœ¨çœ‹èµ·æ¥å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; std::future::Future;

&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;fetch_thing&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;(
    client: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt; Client,
    url: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;str&lt;/span&gt;,
) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;impl&lt;/span&gt; Future&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt; {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;move&lt;/span&gt; {
        &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; res &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; client.get(url).send().&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;.error_for_status()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
        info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt;url, content_type &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;res.headers().get(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;content-type&amp;#34;&lt;/span&gt;), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Got a response!&amp;#34;&lt;/span&gt;);
        Ok(())
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¥½å§ï¼Œä¹‹å‰æˆ‘ä»¬ç”¨äº† &lt;code&gt;async fn&lt;/code&gt; ï¼Œä½†æ˜¯ä¸ºäº†æ›´åŠ æ·±å…¥çš„ç†è§£ï¼Œæˆ‘ä»¬ä¸å¾—ä¸æ”¾å¼ƒæ¼‚äº®çš„è¯­æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å¹¸è¿çš„æ˜¯ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;fetch_thing&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;(
    client: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt; Client,
    url: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;str&lt;/span&gt;,
&lt;span style=&#34;color:#75715e&#34;&gt;//                                                 ğŸ‘‡
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;impl&lt;/span&gt; Future&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &amp;#39;static {}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬å€Ÿç”¨äº† &lt;code&gt;client&lt;/code&gt; å’Œ &lt;code&gt;url&lt;/code&gt; æˆ‘ä»¬å¿…é¡»é¿å…è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸º &lt;code&gt;url&lt;/code&gt; æœ¬èº«å°±æ˜¯å¸¸é‡ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“è§£å†³ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;pub&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; URL_1: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;str&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;https://fasterthanli.me/articles/whats-in-the-box&amp;#34;&lt;/span&gt;;
&lt;span style=&#34;color:#66d9ef&#34;&gt;pub&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;const&lt;/span&gt; URL_2: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;str&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;https://fasterthanli.me/series/advent-of-code-2020/part-13&amp;#34;&lt;/span&gt;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å®ƒä»¬æœ¬èº«å°±æ˜¯ &lt;code&gt;&#39;static&lt;/code&gt; ã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è°ƒæ•´éœ€è¦ &lt;code&gt;&#39;static&lt;/code&gt; å°±è¡Œ:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;fetch_thing&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;(
    client: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt; Client,
    &lt;span style=&#34;color:#75715e&#34;&gt;//       ğŸ‘‡
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    url: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&amp;#39;static &lt;span style=&#34;color:#66d9ef&#34;&gt;str&lt;/span&gt;,
) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;impl&lt;/span&gt; Future&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &amp;#39;static {}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;éå¸¸å¥½ï¼è§£å†³äº†ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œè¿˜å‰©ä¸‹ä¸€ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥è¦æ±‚ &lt;code&gt;client&lt;/code&gt; çš„ç”Ÿå‘½å‘¨æœŸä¸º &lt;code&gt;&#39;static&lt;/code&gt; ã€‚ç”±äºå®ƒæ˜¯ä¸€ä¸ª  &lt;code&gt;Client&lt;/code&gt; çš„å¼•ç”¨ï¼Œæ„å‘³ç€ &lt;code&gt;Cleint&lt;/code&gt; æœ¬èº«ä¹Ÿéœ€è¦æ˜¯ &lt;code&gt;&#39;static&lt;/code&gt; ç”Ÿå‘½å‘¨æœŸã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;fetch_thing&lt;/span&gt;(
    &lt;span style=&#34;color:#75715e&#34;&gt;//         ğŸ‘‡
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    client: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&amp;#39;static Client,
    url: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&amp;#39;static &lt;span style=&#34;color:#66d9ef&#34;&gt;str&lt;/span&gt;,
) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;impl&lt;/span&gt; Future&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &amp;#39;static {}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç”±äºå®ƒè¢« &lt;code&gt;main&lt;/code&gt; æ‰€æœ‰ï¼Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥ï¼Œå¯ä»¥ã€‚ã€‚ã€‚å¯ä»¥æ³„æ¼å®ƒï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    setup()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; client &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Client::new();
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; leaked_client &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Box::leak(Box::new(client));

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; fut1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fetch_thing(leaked_client, URL_1);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; fut2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fetch_thing(leaked_client, URL_2);

    tokio::spawn(fut1);
    tokio::spawn(fut2);

    tokio::time::sleep(Duration::from_secs(&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;)).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;;

    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å®Œç¾ï¼æ²¡æœ‰ç”Ÿå‘½å‘¨æœŸçš„é—®é¢˜äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä»…ä»…å°†æ‰€æœ‰ä¸œè¥¿æ³„æ¼å°±è¡Œã€‚çœ‹åˆ°æ²¡ï¼Ÿä½ ä¸éœ€è¦ Cï¼&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info,reqwest=debug cargo run --quiet --release
Jul 25 18:54:53.614 DEBUG reqwest::connect: starting new connection: https://fasterthanli.me/
Jul 25 18:54:53.614 DEBUG reqwest::connect: starting new connection: https://fasterthanli.me/
Jul 25 18:54:53.708 DEBUG reqwest::async_impl::client: response &#39;200 OK&#39; for https://fasterthanli.me/articles/whats-in-the-box
Jul 25 18:54:53.708  INFO waytoodeep: Got a response! url=https://fasterthanli.me/articles/whats-in-the-box content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
Jul 25 18:54:53.733 DEBUG reqwest::async_impl::client: response &#39;200 OK&#39; for https://fasterthanli.me/series/advent-of-code-2020/part-13
Jul 25 18:54:53.733  INFO waytoodeep: Got a response! url=https://fasterthanli.me/series/advent-of-code-2020/part-13 content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;éï½ï½å¸¸æœ‰è¶£ï¼&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„ä¸¤ä¸ªè¯·æ±‚è‚¯å®šæ˜¯å¹¶å‘çš„å‘å‡ºå»äº†ï¼Œæˆ‘ä»¬ä¹‹æ‰€ä»¥çŸ¥é“æ˜¯å› ä¸ºä»æˆ‘çš„ç¬”è®°æœ¬ä¸Šè¯·æ±‚æˆ‘çš„ç½‘ç«™å¤§æ¦‚è€—æ—¶ 80ms åˆ° 140ms ä¹‹é—´ï¼Œä½†æ˜¯åœ¨æ—¥å¿—ä¸­æˆ‘ä»¬çœ‹åˆ°ä¸¤ä¸ªå“åº”ä¹‹é—´åªæœ‰ ~25ms çš„é—´éš”ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ° &lt;code&gt;reqwest&lt;/code&gt; æœ‰è¿æ¥æ± æœºåˆ¶ï¼šåŒæ—¶åˆ›å»ºäº†ä¸¤ä¸ªè¿æ¥ã€‚å¯èƒ½æ˜¯å› ä¸ºæˆ‘ä»¬å¼€å§‹ç¬¬äºŒä¸ªè¿æ¥çš„æ—¶å€™ç¬¬ä¸€ä¸ªè¯·æ±‚çš„è¿æ¥è¿˜æ²¡æœ‰å»ºç«‹å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬é€šè¿‡ &lt;code&gt;strace&lt;/code&gt; å¯ä»¥çœ‹åˆ°ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo build --quiet --release &amp;amp;&amp;amp; strace -e &#39;connect&#39; ./target/release/waytoodeep
Jul 25 18:58:16.425  INFO waytoodeep: Got a response! url=https://fasterthanli.me/articles/whats-in-the-box content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
Jul 25 18:58:16.443  INFO waytoodeep: Got a response! url=https://fasterthanli.me/series/advent-of-code-2020/part-13 content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
+++ exited with 0 +++
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ã€‚ã€‚ã€‚ä¸¤ä¸ª &lt;code&gt;connect&lt;/code&gt; è°ƒç”¨ï¼å¦‚æˆ‘æ‰€æ–™ï¼&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è°¬è®ºï¼šä¸€ä¸ª &lt;code&gt;connect&lt;/code&gt; è°ƒç”¨éƒ½æ²¡çœ‹åˆ°ï¼Ÿå› ä¸º Rust æ„å»º HTTP/2 è¯·æ±‚çš„æ—¶å€™ç”šè‡³éƒ½éœ€è¦å»ºç«‹ TCP è¿æ¥ã€‚çœŸæ˜¯é©å‘½æ€§çš„ï¼&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™å½“ç„¶ä¸æ˜¯çœŸçš„ã€‚å¯èƒ½åœ¨å…¶ä»–çº¿ç¨‹æ‰§è¡Œäº†ï¼Ÿä¹Ÿè®¸ &lt;code&gt;strace&lt;/code&gt; é»˜è®¤ä»…è·Ÿè¸ªäº†ä¸»çº¿ç¨‹ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å•Šï¼Œå¯¹äº†ï¼Œ &lt;code&gt;-f&lt;/code&gt; å¯ä»¥è·Ÿè¸ªæ‰€æœ‰ã€Œå­è¿›ç¨‹ã€ï¼Œå°±åƒå¤§å®¶çŸ¥é“çš„é‚£æ · Linux çº¿ç¨‹ä»…ä»…æ˜¯æŠ«äº†ä»¶é£è¡£çš„è¿›ç¨‹ï¼ˆæˆ–è€…å…¶ä»–æ–¹å¼ï¼‰ã€‚æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo build --quiet --release &amp;amp;&amp;amp; strace -f -e &#39;connect&#39; ./target/release/waytoodeep
strace: Process 154612 attached
strace: Process 154613 attached
strace: Process 154614 attached
strace: Process 154615 attached
strace: Process 154616 attached
strace: Process 154617 attached
strace: Process 154618 attached
strace: Process 154619 attached
strace: Process 154620 attached
strace: Process 154621 attached
strace: Process 154622 attached
strace: Process 154623 attached
strace: Process 154624 attached
strace: Process 154625 attached
strace: Process 154626 attached
strace: Process 154627 attached
strace: Process 154628 attached
[pid 154627] connect(9, {sa_family=AF_UNIX, sun_path=&amp;quot;/var/run/nscd/socket&amp;quot;}, 110) = -1 ENOENT (No such file or directory)
[pid 154628] connect(10, {sa_family=AF_UNIX, sun_path=&amp;quot;/var/run/nscd/socket&amp;quot;}, 110) = -1 ENOENT (No such file or directory)
[pid 154627] connect(9, {sa_family=AF_UNIX, sun_path=&amp;quot;/var/run/nscd/socket&amp;quot;}, 110) = -1 ENOENT (No such file or directory)
[pid 154628] connect(9, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(&amp;quot;127.0.0.53&amp;quot;)}, 16) = 0
[pid 154627] connect(10, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(&amp;quot;127.0.0.53&amp;quot;)}, 16) = 0
[pid 154627] connect(9, {sa_family=AF_INET6, sin6_port=htons(0), sin6_flowinfo=htonl(0), inet_pton(AF_INET6, &amp;quot;2606:4700:3034::6815:5ca9&amp;quot;, &amp;amp;sin6_addr), sin6_scope_id=0}, 28) = -1 ENETUNREACH (Network is unreachable)
[pid 154627] connect(9, {sa_family=AF_UNSPEC, sa_data=&amp;quot;\0\0\0\0\0\0\0\0\0\0\0\0\0\0&amp;quot;}, 16) = 0
[pid 154627] connect(9, {sa_family=AF_INET6, sin6_port=htons(0), sin6_flowinfo=htonl(0), inet_pton(AF_INET6, &amp;quot;2606:4700:3031::ac43:c490&amp;quot;, &amp;amp;sin6_addr), sin6_scope_id=0}, 28) = -1 ENETUNREACH (Network is unreachable)
[pid 154627] connect(9, {sa_family=AF_UNSPEC, sa_data=&amp;quot;\0\0\0\0\0\0\0\0\0\0\0\0\0\0&amp;quot;}, 16) = 0
[pid 154627] connect(9, {sa_family=AF_INET, sin_port=htons(0), sin_addr=inet_addr(&amp;quot;104.21.92.169&amp;quot;)}, 16) = 0
[pid 154627] connect(9, {sa_family=AF_UNSPEC, sa_data=&amp;quot;\0\0\0\0\0\0\0\0\0\0\0\0\0\0&amp;quot;}, 16) = 0
[pid 154627] connect(9, {sa_family=AF_INET, sin_port=htons(0), sin_addr=inet_addr(&amp;quot;172.67.196.144&amp;quot;)}, 16) = 0
[pid 154628] connect(10, {sa_family=AF_INET6, sin6_port=htons(0), sin6_flowinfo=htonl(0), inet_pton(AF_INET6, &amp;quot;2606:4700:3034::6815:5ca9&amp;quot;, &amp;amp;sin6_addr), sin6_scope_id=0}, 28) = -1 ENETUNREACH (Network is unreachable)
[pid 154628] connect(10, {sa_family=AF_UNSPEC, sa_data=&amp;quot;\0\0\0\0\0\0\0\0\0\0\0\0\0\0&amp;quot;}, 16) = 0
[pid 154628] connect(10, {sa_family=AF_INET6, sin6_port=htons(0), sin6_flowinfo=htonl(0), inet_pton(AF_INET6, &amp;quot;2606:4700:3031::ac43:c490&amp;quot;, &amp;amp;sin6_addr), sin6_scope_id=0}, 28) = -1 ENETUNREACH (Network is unreachable)
[pid 154628] connect(10, {sa_family=AF_UNSPEC, sa_data=&amp;quot;\0\0\0\0\0\0\0\0\0\0\0\0\0\0&amp;quot;}, 16) = 0
[pid 154628] connect(10, {sa_family=AF_INET, sin_port=htons(0), sin_addr=inet_addr(&amp;quot;104.21.92.169&amp;quot;)}, 16) = 0
[pid 154628] connect(10, {sa_family=AF_UNSPEC, sa_data=&amp;quot;\0\0\0\0\0\0\0\0\0\0\0\0\0\0&amp;quot;}, 16) = 0
[pid 154628] connect(10, {sa_family=AF_INET, sin_port=htons(0), sin_addr=inet_addr(&amp;quot;172.67.196.144&amp;quot;)}, 16) = 0
[pid 154625] connect(9, {sa_family=AF_INET, sin_port=htons(443), sin_addr=inet_addr(&amp;quot;104.21.92.169&amp;quot;)}, 16) = -1 EINPROGRESS (Operation now in progress)
[pid 154626] connect(10, {sa_family=AF_INET, sin_port=htons(443), sin_addr=inet_addr(&amp;quot;104.21.92.169&amp;quot;)}, 16) = -1 EINPROGRESS (Operation now in progress)
Jul 25 19:00:53.862  INFO waytoodeep: Got a response! url=https://fasterthanli.me/articles/whats-in-the-box content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
Jul 25 19:00:53.880  INFO waytoodeep: Got a response! url=https://fasterthanli.me/series/advent-of-code-2020/part-13 content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
[pid 154628] +++ exited with 0 +++
[pid 154627] +++ exited with 0 +++
[pid 154618] +++ exited with 0 +++
[pid 154614] +++ exited with 0 +++
[pid 154612] +++ exited with 0 +++
[pid 154619] +++ exited with 0 +++
[pid 154617] +++ exited with 0 +++
[pid 154613] +++ exited with 0 +++
[pid 154615] +++ exited with 0 +++
[pid 154623] +++ exited with 0 +++
[pid 154616] +++ exited with 0 +++
[pid 154624] +++ exited with 0 +++
[pid 154621] +++ exited with 0 +++
[pid 154622] +++ exited with 0 +++
[pid 154626] +++ exited with 0 +++
[pid 154620] +++ exited with 0 +++
[pid 154625] +++ exited with 0 +++
+++ exited with 0 +++shell
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å“‡å“¦ï¼Œä¸€å¤§å † &lt;code&gt;connect&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ç¨‹åºé¦–å…ˆå°è¯•è¿æ¥ &lt;a href=&#34;https://jameshfisher.com/2018/02/05/dont-use-nscd/&#34;&gt;nscd&lt;/a&gt; å› ä¸ºæ˜¾ç„¶æˆ‘ä»¬ä¾ç„¶ç”Ÿæ´»åœ¨ 90 å¹´ä»£ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;[pid 154627] connect(9, {sa_family=AF_UNIX, sun_path=&amp;quot;/var/run/nscd/socket&amp;quot;}, 110) = -1 ENOENT (No such file or directory)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ã€‚ã€‚ã€‚å¹¸å¥½æˆ‘çš„ç³»ç»Ÿæ²¡æœ‰å®ƒï¼Œæ‰€ä»¥å®ƒç»§ç»­é€šè¿‡ &lt;code&gt;/etc/resolv.conf&lt;/code&gt; æŸ¥è¯¢ DNSï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;[pid 154628] connect(9, {sa_family=AF_INET, sin_port=htons(53), sin_addr=inet_addr(&amp;quot;127.0.0.53&amp;quot;)}, 16) = 0
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç„¶åæœ€ç»ˆè·å¾—ä¸€äº› &lt;a href=&#34;https://www.cloudflare.com/ips/&#34;&gt;Cloudflare çš„ IP åœ°å€&lt;/a&gt;ï¼Œå¦‚ &lt;code&gt;172.67.196.144&lt;/code&gt; å’Œ &lt;code&gt;104.21.92.169&lt;/code&gt; ã€‚è¿˜æœ‰ä¸€äº› IPv6 ç›¸å…³çš„ï¼Œç”±äºæˆ‘ç¦ç”¨äº† IPv6 æ‰€ä»¥å¹¶æ²¡æœ‰å·¥ä½œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;[pid 154627] connect(9, {sa_family=AF_INET6, sin6_port=htons(0), sin6_flowinfo=htonl(0), inet_pton(AF_INET6, &amp;quot;2606:4700:3034::6815:5ca9&amp;quot;, &amp;amp;sin6_addr), sin6_scope_id=0}, 28) = -1 ENETUNREACH (Network is unreachable)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç„¶åç»ˆäºç¨‹åºå†³å®šä½¿ç”¨ IPv4 çš„åœ°å€ &lt;code&gt;104.21.92.169&lt;/code&gt; å»æ„å»ºè¯·æ±‚ï¼ŒåŒæ—¶æˆ‘ä»¬èƒ½çœ‹åˆ°è¿™äº›éƒ½æ˜¯éé˜»å¡çš„ï¼ˆnon-blockingï¼‰è¿æ¥ï¼Œå› ä¸º &lt;code&gt;connect&lt;/code&gt; è¿”å› &lt;code&gt;-1&lt;/code&gt; è€Œä¸æ˜¯ &lt;code&gt;0&lt;/code&gt; è¡¨ç¤ºã€Œæ­£åœ¨è¿æ¥ã€æ­£åœ¨è¿æ¥ã€ç¨åå›æ¥æ£€æŸ¥ã€ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;[pid 154625] connect(9, {sa_family=AF_INET, sin_port=htons(443), sin_addr=inet_addr(&amp;quot;104.21.92.169&amp;quot;)}, 16) = -1 EINPROGRESS (Operation now in progress)
[pid 154626] connect(10, {sa_family=AF_INET, sin_port=htons(443), sin_addr=inet_addr(&amp;quot;104.21.92.169&amp;quot;)}, 16) = -1 EINPROGRESS (Operation now in progress)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¥½äº†ï¼æ‰€ä»¥å¿½ç•¥ &lt;a href=&#34;https://isitdns.com/&#34;&gt;DNS&lt;/a&gt; çš„è¯æˆ‘ä»¬çœ‹åˆ°äº†ä¸¤ä¸ªè¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ—¶æˆ‘ä»¬çœ‹åˆ°äº†ä¸€äº›çº¿ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯ Rust å¼‚æ­¥çš„å·¥ä½œæ–¹å¼ï¼Ÿæˆ‘ä»¬åªæ˜¯ç”¨äº†ä¸€äº›çº¿ç¨‹ï¼Ÿè¿™ä¹Ÿå°±æ˜¯å®ƒèƒ½åœ¨ã€Œåå°è¿è¡Œã€çš„åŸå› ï¼Ÿ&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬å›ç­”è¿™äº›é—®é¢˜å‰ï¼Œè®©æˆ‘ä»¬å…ˆè°ƒæ•´æˆ‘ä»¬çš„ä»£ç çœŸæ­£çš„å»ç­‰å¾… future å®Œæˆï¼Œè€Œä¸æ˜¯éšæ„çš„ä¼‘çœ  1 ç§’é’Ÿã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    setup()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; client &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Client::new();
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; leaked_client &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Box::leak(Box::new(client));

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; fut1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fetch_thing(leaked_client, URL_1);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; fut2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fetch_thing(leaked_client, URL_2);

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; handle1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; tokio::spawn(fut1);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; handle2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; tokio::spawn(fut2);

    handle1.&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;.unwrap()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    handle2.&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;.unwrap()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç­‰ç­‰ï¼Œæˆ‘ä»¬è¿™ä¸åˆå›åˆ°åŸç‚¹å—ï¼Ÿç­‰å¾…ç¬¬ä¸€ä¸ªè¯·æ±‚å®Œæˆï¼Œç„¶åæ‰å¼€å§‹ç¬¬äºŒä¸ªè¯·æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ä¸æ˜¯ï¼æˆ‘ä»¬è¿è¡Œå‡ æ¬¡å°±å¯ä»¥çœ‹åˆ°ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info cargo run --quiet --release
Jul 25 19:11:07.934  INFO waytoodeep: Got a response! url=https://fasterthanli.me/articles/whats-in-the-box content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
Jul 25 19:11:07.958  INFO waytoodeep: Got a response! url=https://fasterthanli.me/series/advent-of-code-2020/part-13 content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
$ RUST_LOG=info cargo run --quiet --release
Jul 25 19:11:08.676  INFO waytoodeep: Got a response! url=https://fasterthanli.me/articles/whats-in-the-box content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
Jul 25 19:11:08.680  INFO waytoodeep: Got a response! url=https://fasterthanli.me/series/advent-of-code-2020/part-13 content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
$ RUST_LOG=info cargo run --quiet --release
Jul 25 19:11:09.325  INFO waytoodeep: Got a response! url=https://fasterthanli.me/articles/whats-in-the-box content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
Jul 25 19:11:09.338  INFO waytoodeep: Got a response! url=https://fasterthanli.me/series/advent-of-code-2020/part-13 content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
$ RUST_LOG=info cargo run --quiet --release
Jul 25 19:11:10.134  INFO waytoodeep: Got a response! url=https://fasterthanli.me/series/advent-of-code-2020/part-13 content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
Jul 25 19:11:10.144  INFO waytoodeep: Got a response! url=https://fasterthanli.me/articles/whats-in-the-box content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ã€‚ã€‚ã€‚å¤§éƒ¨åˆ†æƒ…å†µä¸‹â€œwhats-in-the-boxâ€èƒœå‡ºäº†ï¼ˆå®ƒç¡®å®å…ˆå¼€å§‹ï¼‰ï¼Œä½†æ˜¯â€œadvent-of-code-2020â€ä¹Ÿé¦–å…ˆå®Œæˆäº†å‡ æ¬¡ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬å¸Œæœ›çœ‹åˆ°çš„ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è°¬è®ºï¼šä¹Ÿå°±æ˜¯è¯´å› ä¸ºæœ‰çº¿ç¨‹è¯·æ±‚è¢«å¹¶è¡Œï¼ˆparallelï¼‰çš„æ‰§è¡Œäº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸æ˜¯çš„ã€‚ä½†æ˜¯ä¸è¦ç›¸ä¿¡æˆ‘ï¼Œè®©æˆ‘ä»¬ç»§ç»­æ·±å…¥ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä¸æ˜¯å› ä¸ºçº¿ç¨‹&#34;&gt;ä¸æ˜¯å› ä¸ºçº¿ç¨‹&lt;/h3&gt;
&lt;p&gt;è®©æˆ‘ä»¬é€šè¿‡ GDB è¿è¡Œæˆ‘ä»¬çš„å°ç¨‹åºï¼Œå¤§éƒ¨åˆ†åŸå› æ˜¯æˆ‘è¿˜æ²¡æœ‰å¯¹ LLDB å½¢æˆè‚Œè‚‰è®°å¿†ï¼Œæˆ‘ç›¸ä¿¡è¿™æ˜¯æ°´åˆ°æ¸ æˆçš„äº‹ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo build --quiet &amp;amp;&amp;amp; gdb --quiet --args ./target/debug/waytoodeep
Reading symbols from ./target/debug/waytoodeep...
warning: Missing auto-load script at offset 0 in section .debug_gdb_scripts
of file /home/amos/ftl/waytoodeep/target/debug/waytoodeep.
Use `info auto-load python-scripts [REGEXP]&#39; to list them.
(gdb)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¸€åˆ‡å°±ç»ªï¼&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰å…ˆè®¾ç½®ä¸€ä¸‹æ–­ç‚¹ã€‚æˆ‘è¯´äº†æ–­ç‚¹ï¼Ÿåº”è¯¥æ˜¯æ•æ‰ç‚¹ï¼ˆcatchpointï¼‰ã€‚æˆ‘ä¸çŸ¥é“å‚ä¸æ„é€  HTTP/2 è¯·æ±‚çš„æ‰€æœ‰å‡½æ•°åï¼Œä½†æ˜¯æˆ‘çŸ¥é“ &lt;code&gt;connect&lt;/code&gt; å¯¹åº”çš„ç³»ç»Ÿè°ƒç”¨ï¼ˆsyscallï¼‰ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬éœ€è¦æ‰“æ–­ç‚¹çš„åœ°æ–¹ï¼Œæˆ–è€…æ•æ‰ï¼ˆcatchï¼‰ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;(gdb) catch syscall connect
Catchpoint 1 (syscall &#39;connect&#39; [42])
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç°åœ¨æˆ‘ä»¬å¼€å§‹ï¼&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ Starting program: /home/amos/ftl/waytoodeep/target/debug/waytoodeep
[Thread debugging using libthread_db enabled]
Using host libthread_db library &amp;quot;/lib/x86_64-linux-gnu/libthread_db.so.1&amp;quot;.
[New Thread 0x7ffff7c28700 (LWP 158945)]
[New Thread 0x7ffff7a27700 (LWP 158946)]
[New Thread 0x7fffef826700 (LWP 158947)]
[New Thread 0x7ffff7826700 (LWP 158948)]
[New Thread 0x7ffff7625700 (LWP 158949)]
[New Thread 0x7ffff7424700 (LWP 158950)]
[New Thread 0x7ffff7223700 (LWP 158951)]
[New Thread 0x7ffff701f700 (LWP 158952)]
[New Thread 0x7ffff6e1e700 (LWP 158953)]
[New Thread 0x7ffff6c1a700 (LWP 158954)]
[New Thread 0x7ffff6a16700 (LWP 158955)]
[New Thread 0x7ffff680f700 (LWP 158956)]
[New Thread 0x7ffff660e700 (LWP 158957)]
[New Thread 0x7ffff640a700 (LWP 158958)]
[New Thread 0x7ffff6206700 (LWP 158959)]
[New Thread 0x7ffff5f4b700 (LWP 158960)]
[New Thread 0x7ffff5d4a700 (LWP 158961)]
[Switching to Thread 0x7ffff5f4b700 (LWP 158960)]

Thread 17 &amp;quot;tokio-runtime-w&amp;quot; hit Catchpoint 1 (call to syscall connect), 0x00007ffff7d5033b in __libc_connect (fd=fd@entry=9, addr=..., addr@entry=...,
    len=len@entry=110) at ../sysdeps/unix/sysv/linux/connect.c:26
26      ../sysdeps/unix/sysv/linux/connect.c: No such file or directory.
(gdb)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¸é”™ä¸é”™ï¼ŒçœŸå¿«ï¼æˆ‘ä»¬åœåœ¨äº†åä¸º &lt;code&gt;tokio-runtime-w&lt;/code&gt; çš„ &lt;code&gt;Thread 17&lt;/code&gt; ä¸­ï¼Œå› ä¸ºæˆ‘çŒœå…¶ä»–æ‰€æœ‰å­—æ¯éƒ½è¢«ä½¿ç”¨äº†ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;w&lt;/code&gt; æ„å‘³è¿™ &lt;code&gt;worker&lt;/code&gt; ï¼Œå¦‚æœä½ ä¸æ˜¯ç¬¬ä¸€å¤©ç”¨ Unix å°±ä¼šçŸ¥é“ä»€ä¹ˆè¿™ä¹ˆç®€å†™ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¥½çš„ï¼Œ &lt;code&gt;Thread 17&lt;/code&gt; ï¼Œé‚£ä¹ˆå…¶ä»–çº¿ç¨‹åœ¨åšä»€ä¹ˆå‘¢ï¼Ÿ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;(gdb) info threads
  Id   Target Id                                            Frame
  1    Thread 0x7ffff7c2c6c0 (LWP 158941) &amp;quot;waytoodeep&amp;quot;      syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:38
  2    Thread 0x7ffff7c28700 (LWP 158945) &amp;quot;tokio-runtime-w&amp;quot; syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:38
  3    Thread 0x7ffff7a27700 (LWP 158946) &amp;quot;tokio-runtime-w&amp;quot; 0x00007ffff7d4f5ce in epoll_wait (epfd=3, events=0x555556338b60, maxevents=1024, timeout=-1)
    at ../sysdeps/unix/sysv/linux/epoll_wait.c:30
  4    Thread 0x7fffef826700 (LWP 158947) &amp;quot;tokio-runtime-w&amp;quot; syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:38
  5    Thread 0x7ffff7826700 (LWP 158948) &amp;quot;tokio-runtime-w&amp;quot; syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:38
  6    Thread 0x7ffff7625700 (LWP 158949) &amp;quot;tokio-runtime-w&amp;quot; syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:38
  7    Thread 0x7ffff7424700 (LWP 158950) &amp;quot;tokio-runtime-w&amp;quot; syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:38
  8    Thread 0x7ffff7223700 (LWP 158951) &amp;quot;tokio-runtime-w&amp;quot; syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:38
  9    Thread 0x7ffff701f700 (LWP 158952) &amp;quot;tokio-runtime-w&amp;quot; syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:38
  10   Thread 0x7ffff6e1e700 (LWP 158953) &amp;quot;tokio-runtime-w&amp;quot; syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:38
  11   Thread 0x7ffff6c1a700 (LWP 158954) &amp;quot;tokio-runtime-w&amp;quot; syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:38
  12   Thread 0x7ffff6a16700 (LWP 158955) &amp;quot;tokio-runtime-w&amp;quot; syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:38
  13   Thread 0x7ffff680f700 (LWP 158956) &amp;quot;tokio-runtime-w&amp;quot; syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:38
  14   Thread 0x7ffff660e700 (LWP 158957) &amp;quot;tokio-runtime-w&amp;quot; syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:38
  15   Thread 0x7ffff640a700 (LWP 158958) &amp;quot;tokio-runtime-w&amp;quot; syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:38
  16   Thread 0x7ffff6206700 (LWP 158959) &amp;quot;tokio-runtime-w&amp;quot; syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:38
 *17   Thread 0x7ffff5f4b700 (LWP 158960) &amp;quot;tokio-runtime-w&amp;quot; 0x00007ffff7d5033b in __libc_connect (fd=fd@entry=9, addr=..., addr@entry=..., len=len@entry=110)
    at ../sysdeps/unix/sysv/linux/connect.c:26
  18   Thread 0x7ffff5d4a700 (LWP 158961) &amp;quot;tokio-runtime-w&amp;quot; 0x00007ffff7d48a46 in __GI___mmap64 (offset=0, fd=-1, flags=16418, prot=0, len=134217728, addr=0x0)
    at ../sysdeps/unix/sysv/linux/mmap64.c:59
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;é¢ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥è·å¾—æ›´å¤šçš„æ ˆå¸§ï¼Ÿ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;(gdb) thread apply all backtrace 2

Thread 18 (Thread 0x7ffff5d4a700 (LWP 158961)):
#0  0x00007ffff7d48a46 in __GI___mmap64 (offset=0, fd=-1, flags=16418, prot=0, len=134217728, addr=0x0) at ../sysdeps/unix/sysv/linux/mmap64.c:59
#1  __GI___mmap64 (addr=addr@entry=0x0, len=len@entry=134217728, prot=prot@entry=0, flags=flags@entry=16418, fd=fd@entry=-1, offset=offset@entry=0) at ../sysdeps/unix/sysv/linux/mmap64.c:47
(More stack frames follow...)

Thread 17 (Thread 0x7ffff5f4b700 (LWP 158960)):
#0  0x00007ffff7d5033b in __libc_connect (fd=fd@entry=9, addr=..., addr@entry=..., len=len@entry=110) at ../sysdeps/unix/sysv/linux/connect.c:26
#1  0x00007ffff7d8b713 in open_socket (type=type@entry=GETFDHST, key=key@entry=0x7ffff7de5ccb &amp;quot;hosts&amp;quot;, keylen=keylen@entry=6) at nscd_helper.c:185
(More stack frames follow...)

Thread 16 (Thread 0x7ffff6206700 (LWP 158959)):
#0  syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:38
#1  0x0000555555b9f1d1 in parking_lot_core::thread_parker::imp::ThreadParker::futex_wait (self=0x7ffff6206498, ts=...) at /home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/parking_lot_core-0.8.3/src/thread_parker/linux.rs:112
(More stack frames follow...)

Thread 15 (Thread 0x7ffff640a700 (LWP 158958)):
#0  syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:38
#1  0x0000555555b9f1d1 in parking_lot_core::thread_parker::imp::ThreadParker::futex_wait (self=0x7ffff640a498, ts=...) at /home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/parking_lot_core-0.8.3/src/thread_parker/linux.rs:112
(More stack frames follow...)

Thread 14 (Thread 0x7ffff660e700 (LWP 158957)):
#0  syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:38
#1  0x0000555555b9f1d1 in parking_lot_core::thread_parker::imp::ThreadParker::futex_wait (self=0x7ffff660e498, ts=...) at /home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/parking_lot_core-0.8.3/src/thread_parker/linux.rs:112
(More stack frames follow...)

Thread 13 (Thread 0x7ffff680f700 (LWP 158956)):
#0  syscall () at ../sysdeps/unix/sysv/linux/x86_64/syscall.S:38
#1  0x0000555555b9f1d1 in parking_lot_core::thread_parker::imp::ThreadParker::futex_wait (self=0x7ffff680f498, ts=...) at /home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/parking_lot_core-0.8.3/src/thread_parker/linux.rs:112
(More stack frames follow...)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;é¢ã€‚å¤§éƒ¨åˆ†éƒ½æ˜¯æŒ‚èµ·çš„ã€‚ä¹Ÿå°±æ˜¯ç©ºé—²çš„ã€‚æ›´å‡†ç¡®çš„æ˜¯å®ƒä»¬åœ¨ç­‰å¾…å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ htop æŸ¥çœ‹è¿™äº›æ‰€æœ‰çº¿ç¨‹ï¼Œæˆ‘çŸ¥é“æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†ï¼Œä½†æ˜¯æˆ‘ä»…ä»…æ˜¯è§‰å¾— htop å¾ˆæ£’ã€‚æ„Ÿè°¢ &lt;a href=&#34;https://twitter.com/hisham%5Fhm&#34;&gt;Hisham&lt;/a&gt;ï¼
&lt;img src=&#34;https://fasterthanli.me/content/articles/understanding-rust-futures-by-going-way-too-deep/assets/htop-colors.571c5effbff8a0b3.webp&#34; alt=&#34;&#34;&gt;
æ‰€ä»¥ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ä¸€äº›çº¿ç¨‹ï¼ŒåŒæ—¶ä¹Ÿæœ‰ä¸€äº› CPU æ ¸å¿ƒã€‚å¯èƒ½æ˜¯ä¸€ä¸ª CPU æ ¸å¿ƒä¸€ä¸ªçº¿ç¨‹ï¼Ÿ
&lt;img src=&#34;https://fasterthanli.me/content/articles/understanding-rust-futures-by-going-way-too-deep/assets/worker-threads.64dbe39e33ccfc4f.webp&#34; alt=&#34;&#34;&gt;
æ˜¯çš„ã€‚ç„¶åè¿˜æœ‰ä¸€äº›é˜»å¡çš„çº¿ç¨‹ï¼Œæ­£å¦‚æˆ‘ä»¬ä»ä¸Šé¢ &lt;code&gt;strace&lt;/code&gt; è¾“å‡ºçœ‹åˆ°çš„é‚£æ ·ï¼Œ å®ƒä¼šè¿›è¡Œä¸€äº›é˜»å¡çš„ &lt;code&gt;connect&lt;/code&gt; è°ƒç”¨å»æŸ¥è¯¢ DNSï¼ˆå®é™…æ˜¯ glibc åœ¨æ‰§è¡Œï¼‰ï¼Œ
æ‰€ä»¥å®ƒé€šè¿‡è¿è¡Œåœ¨å·¥ä½œçº¿ç¨‹ä¹‹å¤–é¿å…é˜»å¡å…¶ä»–ä»»åŠ¡ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ‰€ä»¥å¤šä¸ªçº¿ç¨‹ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸€æ¬¡å¯ä»¥è¿è¡Œå¤šä¸ªè¯·æ±‚çš„åŸå› ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å®é™…ä¸Šæ–‡æ¡£ä¸Šè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªå•çº¿ç¨‹çš„æ‰§è¡Œå™¨ï¼Œæˆ‘ä¹Ÿä¸èƒ½ç¡®å®šï¼Œæ‰€ä»¥è®©æˆ‘ä»¬è¯•ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;//                           ğŸ‘‡
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main(flavor = &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;current_thread&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
        &lt;span style=&#34;color:#75715e&#34;&gt;// (same as before)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info cargo run --quiet --release
Jul 25 19:50:15.977  INFO waytoodeep: Got a response! url=https://fasterthanli.me/articles/whats-in-the-box content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
Jul 25 19:50:15.994  INFO waytoodeep: Got a response! url=https://fasterthanli.me/series/advent-of-code-2020/part-13 content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä¸¤ä¸ªå“åº”é—´éš” &lt;code&gt;17ms&lt;/code&gt; ï¼Œè¿™ä¸ªæ—¶é—´ä¸å¤Ÿæ„é€ ä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚ï¼Œæ‰€ä»¥è¯·æ±‚å¹¶è¡Œï¼ˆparallelï¼‰çš„æ‰§è¡Œäº†ã€‚å¦‚æœä½ ä¾ç„¶åšæŒå®ƒå†…éƒ¨ä½¿ç”¨äº†çº¿ç¨‹ï¼Œè®©æˆ‘ä»¬è¿›ä¸€æ­¥ç¡®è®¤æˆ‘ä»¬åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼š
&lt;img src=&#34;https://fasterthanli.me/content/articles/understanding-rust-futures-by-going-way-too-deep/assets/current-thread.cd7b619ed644899b.webp&#34; alt=&#34;&#34;&gt;
ç¡®å®æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œä½†æ˜¯è¿™äº›éƒ½æ˜¯é˜»å¡çº¿ç¨‹ã€‚ä»…ä»…æ˜¯ DNS æŸ¥è¯¢ã€‚å¯ä»¥é€šè¿‡ htop çœ‹åˆ°å·²ç»æ²¡æœ‰æ— æ•°ï¼ˆ15ï¼‰çš„å·¥ä½œçº¿ç¨‹äº†ï¼š
&lt;img src=&#34;https://fasterthanli.me/content/articles/understanding-rust-futures-by-going-way-too-deep/assets/htop-current-thread.fe28174abc5d15fa.webp&#34; alt=&#34;&#34;&gt;
ï¼ˆé¡ºä¾¿è¯´ä¸€ä¸‹ 15 ä¸ªå·¥ä½œçº¿ç¨‹çš„åŸå› ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘é¢„ç•™äº†ä¸€ä¸ª CPU æ ¸å¿ƒæ²¡æœ‰åˆ†é…ç»™è™šæ‹Ÿæœºï¼Œè¿™æ ·å³ä½¿è™šæ‹Ÿæœºå…¨é€Ÿè¿è¡Œä¹Ÿä¸ä¼šå¯¼è‡´å®¿ä¸»æœºåœæ­¢å“åº”ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬å°† DNS æŸ¥è¯¢æ’é™¤åœ¨å¤–ï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°å®é™…ä¸Šä»…ä»…ä½¿ç”¨äº†ä¸€ä¸ªçº¿ç¨‹ï¼Œæˆ‘ä»¬å°†ç»§ç»­ä¸‹å»ï¼Œä»¥é˜²ä½ ä¾ç„¶å­˜ç–‘ï¼&lt;/p&gt;
&lt;h3 id=&#34;æ’æ›²-è®©æˆ‘ä»¬é¿å…æ³„æ¼å†…å­˜&#34;&gt;æ’æ›²ï¼šè®©æˆ‘ä»¬é¿å…æ³„æ¼å†…å­˜&lt;/h3&gt;
&lt;p&gt;ä½†æ˜¯åœ¨é‚£ä¹‹å‰ï¼šæ­£åœ¨æ³„æ¼ reqwest çš„ &lt;code&gt;Client&lt;/code&gt; è®©æˆ‘å¾ˆä¸çˆ½ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†é¿å…ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªåŸå­å¼•ç”¨è®¡æ•°ï¼ˆatomically-reference-countedï¼‰ï¼Œè¿™æ ·å®ƒå°±å¯ä»¥éšç€ä»»åŠ¡è¿è¡Œè€Œå­˜æ´»ã€‚&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹èµ·æ¥éå¸¸ç®€å•ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;//             ğŸ‘‡ Atomically Reference Counted = Arc
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; std::sync::Arc;

&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main(flavor = &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;current_thread&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    setup()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#75715e&#34;&gt;//           ğŸ‘‡ there we go
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; client &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Arc::new(Client::new());

    &lt;span style=&#34;color:#75715e&#34;&gt;//                              ğŸ‘‡
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; fut1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fetch_thing(client.clone(), URL_1);
    &lt;span style=&#34;color:#75715e&#34;&gt;// (cloning it only increases the reference count)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; fut2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fetch_thing(client.clone(), URL_2);

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; handle1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; tokio::spawn(fut1);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; handle2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; tokio::spawn(fut2);

    handle1.&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;.unwrap()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    handle2.&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;.unwrap()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    Ok(())
}

&lt;span style=&#34;color:#75715e&#34;&gt;#[allow(clippy::manual_async_fn)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;fetch_thing&lt;/span&gt;(
    &lt;span style=&#34;color:#75715e&#34;&gt;//       ğŸ‘‡ now taking this, we have shared ownership of it
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    client: &lt;span style=&#34;color:#a6e22e&#34;&gt;Arc&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Client&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;,
    url: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&amp;#39;static &lt;span style=&#34;color:#66d9ef&#34;&gt;str&lt;/span&gt;,
) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;impl&lt;/span&gt; Future&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &amp;#39;static {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;move&lt;/span&gt; {
        &lt;span style=&#34;color:#75715e&#34;&gt;// luckily this  ğŸ‘‡ only requires `&amp;amp;self`
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; res &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; client.get(url).send().&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;.error_for_status()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
        info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt;url, content_type &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;res.headers().get(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;content-type&amp;#34;&lt;/span&gt;), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Got a response!&amp;#34;&lt;/span&gt;);
        Ok(())
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¥½äº†ï¼Œç°åœ¨æˆ‘æ„Ÿè§‰å¥½å¤šäº†ã€‚æˆ‘ä»¬çš„ç¨‹åºä¸å†æ³„æ¼ä¸€äº›å­—èŠ‚å³ä½¿å®ƒæ°¸è¿œä¸ä¼šè¿è¡Œè¶…è¿‡å‡ ç§’é’Ÿã€‚ä¸€åˆ‡éƒ½è¿˜å¥½ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ &lt;code&gt;reqwest&lt;/code&gt; çš„ &lt;code&gt;Client&lt;/code&gt; å®šä¹‰:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#[derive(Clone)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;pub&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Client&lt;/span&gt; {
    inner: &lt;span style=&#34;color:#a6e22e&#34;&gt;Arc&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;ClientRef&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;,
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å®ƒå·²ç»æ˜¯å¼•ç”¨è®¡æ•°çš„äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥æ¥å—ä¸€ä¸ª &lt;code&gt;Client&lt;/code&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main(flavor = &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;current_thread&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    setup()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#75715e&#34;&gt;//             ğŸ‘‡
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; client &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Client::new();

    &lt;span style=&#34;color:#75715e&#34;&gt;//                              ğŸ‘‡
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; fut1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fetch_thing(client.clone(), URL_1);
    &lt;span style=&#34;color:#75715e&#34;&gt;// no need to clone a second time
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; fut2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fetch_thing(client, URL_2);

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; handle1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; tokio::spawn(fut1);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; handle2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; tokio::spawn(fut2);

    handle1.&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;.unwrap()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    handle2.&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;.unwrap()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    Ok(())
}

&lt;span style=&#34;color:#75715e&#34;&gt;#[allow(clippy::manual_async_fn)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;fetch_thing&lt;/span&gt;(
    &lt;span style=&#34;color:#75715e&#34;&gt;//        ğŸ‘‡
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    client: &lt;span style=&#34;color:#a6e22e&#34;&gt;Client&lt;/span&gt;,
    url: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&amp;#39;static &lt;span style=&#34;color:#66d9ef&#34;&gt;str&lt;/span&gt;,
) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;impl&lt;/span&gt; Future&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; &amp;#39;static {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;move&lt;/span&gt; {
        &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; res &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; client.get(url).send().&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;.error_for_status()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
        info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt;url, content_type &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;res.headers().get(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;content-type&amp;#34;&lt;/span&gt;), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Got a response!&amp;#34;&lt;/span&gt;);
        Ok(())
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¥½äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äº†ï¼Œä»…ä¾›å‚è€ƒï¼Œæ›´ç®€å•çš„ &lt;code&gt;async fn&lt;/code&gt; ä¹Ÿå¯ä»¥å·¥ä½œäº†ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;fetch_thing&lt;/span&gt;(client: &lt;span style=&#34;color:#a6e22e&#34;&gt;Client&lt;/span&gt;, url: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;str&lt;/span&gt;) -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; res &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; client.get(url).send().&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;.error_for_status()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt;url, content_type &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;res.headers().get(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;content-type&amp;#34;&lt;/span&gt;), &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Got a response!&amp;#34;&lt;/span&gt;);
    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬ç”šè‡³ä¸éœ€è¦è¦æ±‚ &lt;code&gt;url&lt;/code&gt; çš„å€Ÿç”¨ç”Ÿå‘½å‘¨æœŸæ˜¯ &lt;code&gt;&#39;static&lt;/code&gt; ã€‚å¦‚æœ &lt;code&gt;url&lt;/code&gt; æ˜¯ &lt;code&gt;&#39;static&lt;/code&gt; çš„åˆ™è¿”å›çš„ Future ä¹Ÿæ˜¯ï¼Œåä¹‹äº¦ç„¶ã€‚&lt;/p&gt;
&lt;p&gt;ä½œä¸ºä¾‹å­ï¼Œä¸‹é¢ä»£ç æ— æ³•é€šè¿‡ç¼–è¯‘ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main(flavor = &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;current_thread&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    setup()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; client &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Client::new();

    &lt;span style=&#34;color:#75715e&#34;&gt;// this is a `String`, owned by main
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; url1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; String::from(URL_1);

    &lt;span style=&#34;color:#75715e&#34;&gt;// we&amp;#39;re borrowing from main           ğŸ‘‡
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; fut1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fetch_thing(client.clone(), &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;url1);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; fut2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; fetch_thing(client, URL_2);

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; handle1 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; tokio::spawn(fut1);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; handle2 &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; tokio::spawn(fut2);

    handle1.&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;.unwrap()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    handle2.&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;.unwrap()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo check
    Checking waytoodeep v0.1.0 (/home/amos/ftl/waytoodeep)

error[E0597]: `url1` does not live long enough
  --&amp;gt; src/main.rs:18:44
   |
18 |     let fut1 = fetch_thing(client.clone(), &amp;amp;url1);
   |                ----------------------------^^^^^-
   |                |                           |
   |                |                           borrowed value does not live long enough
   |                argument requires that `url1` is borrowed for `&#39;static`
...
28 | }
   | - `url1` dropped here while still borrowed
&lt;/code&gt;&lt;/pre&gt;&lt;blockquote&gt;
&lt;p&gt;ä½ é¢å¯¹çš„è€ƒéªŒå°±æ˜¯ï¼šä¿®æ”¹äº†ä¸€äº›ä»£ç ï¼Œç„¶åçªç„¶é—´æ•´ä¸ª &lt;code&gt;Future&lt;/code&gt; ä¸å†å®ç° &lt;code&gt;Send&lt;/code&gt; ï¼Œä½†æ˜¯ä½ éœ€è¦å®ƒå®ç° &lt;code&gt;Send&lt;/code&gt; ã€‚å‚è€ƒ&lt;a href=&#34;https://fasterthanli.me/articles/getting-in-and-out-of-trouble-with-rust-futures&#34;&gt;Getting in and out of trouble with Rust futures&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬è¿›ä¸€æ­¥æ·±å…¥ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜æƒ³æä¸€ä¸‹ï¼Œé™¤äº†é€šè¿‡ &lt;code&gt;tokio::spawn&lt;/code&gt; å¯ä»¥åŒæ—¶è¿è¡Œä¸¤ä¸ª future å¹¶ä¸”ç«‹å³ç­‰å¾…ä¸¤ä¸ª future å®Œæˆï¼Œè¿˜æ˜¯ä½¿ç”¨ &lt;code&gt;FuturesUnordered&lt;/code&gt; å®ç°ç›¸åŒç›®çš„ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo add futures@0.3.16
    Updating &#39;https://github.com/rust-lang/crates.io-index&#39; index
      Adding futures v0.3.16 to dependencies
&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; futures::{stream::FuturesUnordered, StreamExt};


&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main(flavor = &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;current_thread&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    setup()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; client &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Client::new();

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; group &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; vec&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;[
        fetch_thing(client.clone(), URL_1),
        fetch_thing(client, URL_2),
    ]
    .into_iter()
    .collect::&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;FuturesUnordered&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;_&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;();

    &lt;span style=&#34;color:#66d9ef&#34;&gt;while&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; Some(item) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; group.next().&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt; {
        &lt;span style=&#34;color:#75715e&#34;&gt;// propagate errors
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;        item&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    }

    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é€šè¿‡è¿™ä¸ªè§£å†³åŠå•ƒå•Šï¼Œæˆ‘ä»¬å¯ä»¥ await ä»»æ„æ•°é‡çš„ future å¯¹è±¡ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å¹¶å‘çš„è¢«è½®è¯¢ï¼ˆpolledï¼‰ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info cargo run --quiet --release
Jul 25 20:12:37.208  INFO waytoodeep: Got a response! url=https://fasterthanli.me/articles/whats-in-the-box content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
Jul 25 20:12:37.227  INFO waytoodeep: Got a response! url=https://fasterthanli.me/series/advent-of-code-2020/part-13 content_type=Some(&amp;quot;text/html; charset=utf-8&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ä»…ä»…ã€‚ã€‚ã€‚19 æ¯«ç§’çš„é—´éš” &amp;ndash; å¯ä»¥ç¡®å®šæ˜¯å¹¶å‘çš„ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å½»åº•æ‘†è„±-dns&#34;&gt;å½»åº•æ‘†è„± DNS&lt;/h3&gt;
&lt;p&gt;ç°åœ¨è®©æˆ‘ä»¬æš‚æ—¶å¿˜æ‰ &lt;code&gt;reqwest&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;HTTP &lt;a href=&#34;https://fasterthanli.me/articles/aiming-for-correctness-with-types&#34;&gt;å¹¶ä¸éš¾&lt;/a&gt; ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±æ„å»ºã€‚åªè¦ TCP å°±è¡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; std::net::SocketAddr;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; tokio::{
    io::{AsyncReadExt, AsyncWriteExt},
    net::TcpStream,
};

&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;fetch_thing&lt;/span&gt;(name: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;str&lt;/span&gt;) -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    &lt;span style=&#34;color:#75715e&#34;&gt;// look mom, no DNS!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; addr: &lt;span style=&#34;color:#a6e22e&#34;&gt;SocketAddr&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ([&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;], &lt;span style=&#34;color:#ae81ff&#34;&gt;80&lt;/span&gt;).into();
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; socket &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; TcpStream::connect(addr).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#75715e&#34;&gt;// we&amp;#39;re writing straight to the socket, there&amp;#39;s no buffering
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;// so no need to flush
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    socket.write_all(&lt;span style=&#34;color:#e6db74&#34;&gt;b&amp;#34;GET / HTTP/1.1&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\r\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    socket.write_all(&lt;span style=&#34;color:#e6db74&#34;&gt;b&amp;#34;Host: 1.1.1.1&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\r\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    socket.write_all(&lt;span style=&#34;color:#e6db74&#34;&gt;b&amp;#34;User-Agent: cool-bear&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\r\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    socket.write_all(&lt;span style=&#34;color:#e6db74&#34;&gt;b&amp;#34;Connection: close&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\r\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    socket.write_all(&lt;span style=&#34;color:#e6db74&#34;&gt;b&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\r\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; response &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; String::with_capacity(&lt;span style=&#34;color:#ae81ff&#34;&gt;256&lt;/span&gt;);
    socket.read_to_string(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; response).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; status &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; response.lines().next().unwrap_or_default();
    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt;status, , &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Got response!&amp;#34;&lt;/span&gt;);

    &lt;span style=&#34;color:#75715e&#34;&gt;// dropping the socket will close the connection
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯ä»¥æ­£å¸¸è¿è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info cargo run --quiet --release
Jul 25 20:24:05.158  INFO waytoodeep: Got response! status=HTTP/1.1 301 Moved Permanently name=second
Jul 25 20:24:05.159  INFO waytoodeep: Got response! status=HTTP/1.1 301 Moved Permanently name=first
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ï¼ˆçœ‹ï¼Œç¬¬äºŒä¸ªèµ¢å¾—äº†èƒœåˆ©ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ—¶å†ä¹Ÿæ²¡æœ‰ DNS æŸ¥è¯¢äº†ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ &lt;code&gt;http://1.1.1.1&lt;/code&gt; å°†æˆ‘ä»¬é‡å®šå‘åˆ° HTTPS çš„é¡µé¢ï¼ŒæŠ€æœ¯ä¸Šå®ç° TLS å¹¶ä¸å›°éš¾ï¼Œä½†æ˜¯æˆ‘ä»¬çš„ç¯‡å¹…å·²ç»å¾ˆé•¿äº†ï¼Œæ‰€ä»¥ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo add tokio-rustls@0.22.0
    Updating &#39;https://github.com/rust-lang/crates.io-index&#39; index
      Adding tokio-rustls v0.22.0 to dependencies
$ cargo add webpki@0.21.4
    Updating &#39;https://github.com/rust-lang/crates.io-index&#39; index
      Adding webpki v0.21.4 to dependencies
$ cargo add webpki-roots@0.21.1
    Updating &#39;https://github.com/rust-lang/crates.io-index&#39; index
      Adding webpki-roots v0.21.1 to dependencies
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç„¶åã€‚ã€‚ã€‚&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo rm reqwest
    Removing reqwest from dependencies
&lt;/code&gt;&lt;/pre&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; std::sync::Arc;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; webpki::DNSNameRef;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; tokio_rustls::{rustls::ClientConfig, TlsConnector};

&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;fetch_thing&lt;/span&gt;(name: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;str&lt;/span&gt;) -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    &lt;span style=&#34;color:#75715e&#34;&gt;// look out it&amp;#39;s port 443 now
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; addr: &lt;span style=&#34;color:#a6e22e&#34;&gt;SocketAddr&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ([&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;], &lt;span style=&#34;color:#ae81ff&#34;&gt;443&lt;/span&gt;).into();
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; socket &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; TcpStream::connect(addr).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#75715e&#34;&gt;// establish a TLS session...
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; connector: &lt;span style=&#34;color:#a6e22e&#34;&gt;TlsConnector&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {
        &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; config &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ClientConfig::new();
        config
            .root_store
            .add_server_trust_anchors(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;webpki_roots::TLS_SERVER_ROOTS);
        Arc::new(config).into()
    };
    &lt;span style=&#34;color:#75715e&#34;&gt;// we have to use the proper DNS name now      ğŸ‘‡
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; dnsname &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; DNSNameRef::try_from_ascii_str(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;one.one.one.one&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; socket &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; connector.connect(dnsname, socket).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#75715e&#34;&gt;// we&amp;#39;re writing straight to the socket, there&amp;#39;s no buffering
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;// so no need to flush
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    socket.write_all(&lt;span style=&#34;color:#e6db74&#34;&gt;b&amp;#34;GET / HTTP/1.1&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\r\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    &lt;span style=&#34;color:#75715e&#34;&gt;//                        ğŸ‘‡
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    socket.write_all(&lt;span style=&#34;color:#e6db74&#34;&gt;b&amp;#34;Host: one.one.one.one&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\r\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    socket.write_all(&lt;span style=&#34;color:#e6db74&#34;&gt;b&amp;#34;User-Agent: cool-bear&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\r\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    socket.write_all(&lt;span style=&#34;color:#e6db74&#34;&gt;b&amp;#34;Connection: close&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\r\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    socket.write_all(&lt;span style=&#34;color:#e6db74&#34;&gt;b&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\r\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; response &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; String::with_capacity(&lt;span style=&#34;color:#ae81ff&#34;&gt;256&lt;/span&gt;);
    socket.read_to_string(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; response).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; status &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; response.lines().next().unwrap_or_default();
    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt;status, , &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Got response!&amp;#34;&lt;/span&gt;);

    &lt;span style=&#34;color:#75715e&#34;&gt;// dropping the socket will close the connection
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info cargo run --quiet --release
Jul 25 20:31:32.627  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=second
Jul 25 20:31:32.658  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=first
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¥½äº†ï¼Œç°åœ¨è¿”å›çŠ¶æ€ç  200ï¼&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„ç›®æ ‡æ˜¯äº†è§£ Rust çš„ futureï¼Œæˆ‘ä»¬å·²ç»è·å¾—äº†ä¸é”™çš„è¿›å±•ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯è®©æˆ‘ä»¬è€ƒè™‘ä»¥ä¸‹åœºæ™¯ï¼šæˆ‘ä»¬æƒ³å¹¶å‘çš„æ‰§è¡Œä¸¤ä¸ªè¯·æ±‚ï¼Œä¸€æ—¦å…¶ä¸­ä¸€ä¸ªå¤±è´¥ï¼Œå¦å¤–ä¸€ä¸ªä¹Ÿåº”è¯¥ç«‹å³è¯·æ±‚å¤±è´¥ï¼Œæˆ–è€…ä¸¤ä¸ªä¸€èµ·æˆåŠŸã€‚&lt;/p&gt;
&lt;h3 id=&#34;tokio-çš„-try-join-å®&#34;&gt;tokio çš„ try_join å®&lt;/h3&gt;
&lt;p&gt;å®é™…ä¸Šï¼Œåˆä¸€ä¸ªå®å¯ä»¥åšè¿™ä¸ªï¼&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main(flavor = &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;current_thread&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    setup()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; res &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; tokio::try_join&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(fetch_thing(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;first&amp;#34;&lt;/span&gt;), fetch_thing(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;second&amp;#34;&lt;/span&gt;),)&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;res, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;All done!&amp;#34;&lt;/span&gt;);

    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info cargo run --quiet --release
Jul 25 20:44:52.150  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=first
Jul 25 20:44:52.165  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=second
Jul 25 20:44:52.165  INFO waytoodeep: All done! res=((), ())
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å†æ¬¡å¿«é€Ÿæ£€æŸ¥ä»¥ä¸‹ï¼šå“åº”é—´éš”åœ¨ 15ms &amp;ndash; ä¹Ÿå°±æ˜¯ç¡®å®šæ˜¯å¹¶å‘çš„å‘é€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;try_join!&lt;/code&gt; å¸®æˆ‘ä»¬è¿›è¡Œäº† &lt;code&gt;await&lt;/code&gt; ï¼ŒåŒæ—¶å¸®æˆ‘ä»¬å¤„ç†äº†ç»“æœã€‚å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œæˆ‘ä»¬å¾—åˆ°æ‰€æœ‰ future å¯¹è±¡çš„ç»“æœï¼šå†…å®¹ä¸º &lt;code&gt;Ok&lt;/code&gt; çš„ç©ºå…ƒç»„ï¼ˆæœ‰åºçš„ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å–åˆ°æˆ‘ä»¬ future è¿”å›çš„å¯¹è±¡ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;//                                          ğŸ‘‡
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;fetch_thing&lt;/span&gt;(name: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;str&lt;/span&gt;) -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;str&lt;/span&gt;, Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    &lt;span style=&#34;color:#75715e&#34;&gt;// (omitted)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;//  ğŸ‘‡
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    Ok(name)
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬è‡ªå·±ï¼Œå®ƒä»¬æŒ‰ç…§é¡ºåºè¿”å›ï¼Œæ— è®ºå“ªä¸ªå…ˆè¢«æ‰§è¡Œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info cargo run --quiet --release
Jul 25 20:47:56.967  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=second
Jul 25 20:47:56.967  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=first
Jul 25 20:47:56.967  INFO waytoodeep: All done! res=(&amp;quot;first&amp;quot;, &amp;quot;second&amp;quot;)
$ RUST_LOG=info cargo run --quiet --release
Jul 25 20:47:57.933  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=first
Jul 25 20:47:57.935  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=second
Jul 25 20:47:57.935  INFO waytoodeep: All done! res=(&amp;quot;first&amp;quot;, &amp;quot;second&amp;quot;)
$ RUST_LOG=info cargo run --quiet --release
Jul 25 20:47:58.942  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=second
Jul 25 20:47:58.946  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=first
Jul 25 20:47:58.946  INFO waytoodeep: All done! res=(&amp;quot;first&amp;quot;, &amp;quot;second&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬æ²¡æœ‰ DNS æŸ¥è¯¢ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¶ˆé™¤â€œåŒæ—¶â€è¯·æ±‚æ˜¯ç”±äºå¤šçº¿ç¨‹å®ç°çš„ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºï¼Œå¦‚æœæˆ‘ä»¬åœ¨ &lt;code&gt;strace&lt;/code&gt; ä¸‹è¿è¡Œç¨‹åºï¼Œå¹¶é€šè¿‡ &lt;code&gt;-f&lt;/code&gt; è¯·æ±‚è·Ÿè¸ªå­çº¿ç¨‹ï¼ˆ BTW &lt;code&gt;f&lt;/code&gt; æ„æ€æ˜¯è·Ÿè¸ªï¼ˆ &lt;code&gt;follow&lt;/code&gt; ï¼‰å­çº¿ç¨‹ï¼‰ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ cargo build --quiet --release &amp;amp;&amp;amp; strace -f -e &#39;connect&#39; ./target/release/waytoodeep
connect(9, {sa_family=AF_INET, sin_port=htons(443), sin_addr=inet_addr(&amp;quot;1.1.1.1&amp;quot;)}, 16) = -1 EINPROGRESS (Operation now in progress)
connect(10, {sa_family=AF_INET, sin_port=htons(443), sin_addr=inet_addr(&amp;quot;1.1.1.1&amp;quot;)}, 16) = -1 EINPROGRESS (Operation now in progress)
Jul 25 20:51:54.004  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=first
Jul 25 20:51:54.013  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=second
Jul 25 20:51:54.015  INFO waytoodeep: All done! res=(&amp;quot;first&amp;quot;, &amp;quot;second&amp;quot;)
+++ exited with 0 +++
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ã€‚ã€‚ã€‚ç°åœ¨æˆ‘ä»¬çœ‹åˆ°äº†é¢„æœŸçš„ä¸¤æ¬¡ &lt;code&gt;connect&lt;/code&gt; è°ƒç”¨ï¼Œä½†æ˜¯æ²¡æœ‰ä»»ä½•å­çº¿ç¨‹ã€‚è€Œä¸”åœ¨è¿™ä¸ªè¿è¡Œä¸­ï¼Œå“åº”ä¹‹é—´çš„é—´éš”æ—¶é—´æ˜¯ 9 æ¯«ç§’ï¼å°‘äºæˆ‘ç›´æ¥ ping 1.1.1.1:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ ping -c 1 1.1.1.1
PING 1.1.1.1 (1.1.1.1) 56(84) bytes of data.
64 bytes from 1.1.1.1: icmp_seq=1 ttl=57 time=13.7 ms

--- 1.1.1.1 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 13.748/13.748/13.748/0.000 ms
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™æ˜¯å› ä¸ºæ‰§è¡Œå™¨é€šè¿‡ Event Loop æ„å»ºéé˜»å¡çš„ç³»ç»Ÿè°ƒç”¨ï¼Œç„¶åè®¢é˜… Event Loop ç®¡ç†çš„èµ„æºç›¸å…³çš„äº‹ä»¶ï¼Œ
ç„¶åå°±å¯ä»¥çŸ¥é“ä¸€ä¸ª socket ä»€ä¹ˆæ—¶é—´å¯ä»¥è¿›è¡Œè¯»å†™ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œfuture å¯¹è±¡åªæ˜¯ä¸€äº›çŠ¶æ€ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥è¿›è¡Œ awaitï¼Œé‚£ä¹ˆåœ¨å“ªè®¢é˜…çš„äº‹ä»¶å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬å°è¯•åˆ›å»ºä¸€ä¸ªæˆ‘ä»¬è‡ªå·±çš„ &lt;code&gt;try_join&lt;/code&gt; &amp;ndash; ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”åªæ¥å—ä¸¤ä¸ª futureã€‚ç„¶åæˆ‘ä»¬å°±èƒ½çœ‹åˆ°å‘ç”Ÿäº†ä»€ä¹ˆã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å·²ç»å®ç°äº†è‡ªå·±çš„ futureï¼Œå®ç°ä¸€ä¸ª &lt;code&gt;try_join&lt;/code&gt; å‡½æ•°ä¼šæœ‰å¤šéº»çƒ¦ï¼Ÿ&lt;/p&gt;
&lt;h3 id=&#34;äº‹å®è¯æ˜å¾ˆéº»çƒ¦&#34;&gt;äº‹å®è¯æ˜å¾ˆéº»çƒ¦&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆä»ç®€å•çš„å¼€å§‹ï¼æˆ‘ä»¬æƒ³å®ç°ä¸€ä¸ªå‡½æ•°æ¥å—ä¸¤ä¸ª future å¯¹è±¡ç„¶åè¿”å›ä¸€ä¸ª future å¯¹è±¡ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// in `src/main.rs`
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mod&lt;/span&gt; tj;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// in `src/tj.rs`
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; std::future::Future;

&lt;span style=&#34;color:#66d9ef&#34;&gt;pub&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;try_join&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, B&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;(a: &lt;span style=&#34;color:#a6e22e&#34;&gt;A&lt;/span&gt;, b: &lt;span style=&#34;color:#a6e22e&#34;&gt;B&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;impl&lt;/span&gt; Future&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ()&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt;
    A: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;,
    B: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;,
{
    todo&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;implement me!&amp;#34;&lt;/span&gt;);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é¢ã€‚å‡½æ•°ä¸åº”è¯¥åªè¿”å›ä¸€ä¸ªç©ºå…ƒç»„ï¼Œå®ƒéœ€è¦è¿”å›ä¸€ä¸ªåŒ…å«æˆåŠŸç»“æœçš„å…ƒç»„ã€‚æˆ–è€…é‡åˆ°çš„ç¬¬ä¸€ä¸ªé”™è¯¯ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€äº›æ›´å¤šçš„èŒƒå‹å‚æ•°ï¼šä¸€ä¸ªé”™è¯¯ç±»å‹ï¼ˆæˆ‘ä»¬å‡è®¾ä¸¤ä¸ª future å¯¹è±¡è¿”å›åŒæ ·çš„é”™è¯¯ç±»å‹ï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯ future å¯¹è±¡è¿”å›çš„ &lt;code&gt;Ok&lt;/code&gt; çš„ç±»å‹ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;pub&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;try_join&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, B, AR, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;(a: &lt;span style=&#34;color:#a6e22e&#34;&gt;A&lt;/span&gt;, b: &lt;span style=&#34;color:#a6e22e&#34;&gt;B&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;impl&lt;/span&gt; Future&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(AR, BR), E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt;
    A: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;AR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
    B: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
{
    todo&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;implement me!&amp;#34;&lt;/span&gt;);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¥½äº†ï¼è¿™éå¸¸ç»•å£ï¼Œä½†æ˜¯æˆ‘ç›¸ä¿¡æˆ‘ä»¬å·²ç»å®ç°äº†éœ€æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬ä½¿ç”¨äº† &lt;code&gt;impl Trait&lt;/code&gt; è¯­æ³•ï¼Œè®©æˆ‘ä»¬ä¸ç”¨æš´éœ²æˆ‘ä»¬è‡ªå·±çš„ &lt;code&gt;try join future&lt;/code&gt; ã€‚è¿™ä¸é‡è¦ï¼Œä½†æ˜¯å¯ä»¥è®©æˆ‘ä»¬ç”¨æ›´å°‘çš„ &lt;code&gt;pub&lt;/code&gt; å…³é”®å­—ï¼ŒåŒæ—¶æˆ‘ä»¬çš„æ‰‹æŒ‡å·²ç»ç ç´¯äº†ã€‚éå¸¸ç´¯ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬æ¥åˆ›å»ºè¿™ä¸ªç±»å‹ï¼&lt;/p&gt;
&lt;p&gt;ç±»å‹éœ€è¦æŒç»­ &lt;code&gt;A&lt;/code&gt; å’Œ &lt;code&gt;B&lt;/code&gt; ï¼Œå¹¶æ³¨æ„ &lt;code&gt;AR&lt;/code&gt; ã€ &lt;code&gt;BR&lt;/code&gt; å’Œ &lt;code&gt;E&lt;/code&gt; ç±»å‹ã€‚æ‰€ä»¥ï¼Œå¸Œæœ›æ‚¨å¯¹è¿™äº›èŒƒå‹å‚æ•°æ²™æ‹‰æœ‰ä¸ªå¥½èƒƒå£ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;TryJoin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, B, AR, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt;
    A: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;AR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
    B: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
{
    a: &lt;span style=&#34;color:#a6e22e&#34;&gt;A&lt;/span&gt;,
    b: &lt;span style=&#34;color:#a6e22e&#34;&gt;B&lt;/span&gt;,
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶åå¯ä»¥åœ¨æˆ‘ä»¬çš„ &lt;code&gt;try_join&lt;/code&gt; å‡½æ•°ä¸­è¿”å›å®ƒï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;pub&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;try_join&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, B, AR, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;(a: &lt;span style=&#34;color:#a6e22e&#34;&gt;A&lt;/span&gt;, b: &lt;span style=&#34;color:#a6e22e&#34;&gt;B&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;impl&lt;/span&gt; Future&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(AR, BR), E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt;
    A: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;AR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
    B: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
{
    &lt;span style=&#34;color:#75715e&#34;&gt;// so simple!
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    TryJoin { a, b }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘è®¤ä¸ºè¿™å¾ˆå¥½çš„è¯´æ˜ä¸€ä¸ªäº‹å®ï¼šåˆ›å»º future å¯¹è±¡ä»…ä»…æ˜¯æ„å»ºçŠ¶æ€ã€‚ä¸éœ€è¦ä»»ä½•é¢å¤–çš„å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œè¿™ä¸ªä¸ä¼šé€šè¿‡ç¼–è¯‘ï¼Œå› ä¸º &lt;code&gt;TryJoin&lt;/code&gt; è¿˜æ²¡æœ‰å®ç° &lt;code&gt;Future&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ä¸è¦æ‹…å¿ƒï¼ &lt;code&gt;rust-analyzer&lt;/code&gt; å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç”Ÿæˆç¼ºå¤±çš„éƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; std::{
    future::Future,
    pin::Pin,
    task::{Context, Poll},
};

&lt;span style=&#34;color:#66d9ef&#34;&gt;impl&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, B, AR, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; Future &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; TryJoin&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, B, AR, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt;
    A: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;AR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
    B: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
{
    &lt;span style=&#34;color:#66d9ef&#34;&gt;type&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Output&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(AR, BR), E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;poll&lt;/span&gt;(self: &lt;span style=&#34;color:#a6e22e&#34;&gt;Pin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; Self&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;, cx: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;mut&lt;/span&gt; Context&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;_&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Poll&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Self::Output&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
        todo&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;()
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¦‚æœæˆ‘ä»¬çœŸæ­£çš„å®ç°äº†ï¼Œæˆ‘ä»¬å°†æŒ‰ç…§ä¸‹é¢æ–¹å¼ä½¿ç”¨ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main(flavor = &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;current_thread&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    setup()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; res &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; tj::try_join(fetch_thing(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;first&amp;#34;&lt;/span&gt;), fetch_thing(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;second&amp;#34;&lt;/span&gt;)).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;res, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;All done!&amp;#34;&lt;/span&gt;);

    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å½“ç„¶ï¼Œç°åœ¨åªæ˜¯ä¼šå´©æºƒï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info cargo run --quiet --release

The application panicked (crashed).
Message:  not yet implemented
Location: src/tj.rs:32

Backtrace omitted.
Run with RUST_BACKTRACE=1 environment variable to display it.
Run with RUST_BACKTRACE=full to include source snippets.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ‰€ä»¥ï¼Œæˆ‘çŒœæˆ‘ä»¬éœ€è¦å®ç°å®ƒï¼&lt;/p&gt;
&lt;p&gt;å¥½å§ï¼Œè®©æˆ‘ä»¬å…ˆå°è¯•è‡³å°‘è½®è¯¢ï¼ˆpollingï¼‰ä¸€ä¸ª future å¯¹è±¡ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;poll&lt;/span&gt;(self: &lt;span style=&#34;color:#a6e22e&#34;&gt;Pin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; Self&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;, cx: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;mut&lt;/span&gt; Context&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;_&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Poll&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Self::Output&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self.a.poll(cx);

    todo&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;()
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info cargo run --quiet --release
error[E0599]: no method named `poll` found for type parameter `A` in the current scope
   --&amp;gt; src/tj.rs:32:24
    |
32  |         let a = self.a.poll(cx);
    |                        ^^^^ method not found in `A`
    |
   ::: /home/amos/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/future.rs:100:8
    |
100 |     fn poll(self: Pin&amp;lt;&amp;amp;mut Self&amp;gt;, cx: &amp;amp;mut Context&amp;lt;&#39;_&amp;gt;) -&amp;gt; Poll&amp;lt;Self::Output&amp;gt;;
    |        ---- the method is available for `Pin&amp;lt;&amp;amp;mut A&amp;gt;` here
    |
help: consider wrapping the receiver expression with the appropriate type
    |
32  |         let a = Pin::new(&amp;amp;mut self.a).poll(cx);
    |                 ^^^^^^^^^^^^^       ^
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;é¢ï¼ä¸€ä¸ªå¥½çš„å¼€å§‹ï¼Œå¥½çš„å¼€å§‹ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å·²ç»åœ¨è¿™é‡Œ&lt;a href=&#34;https://fasterthanli.me/articles/pin-and-suffering&#34;&gt;è¯¦ç»†çš„è§£é‡Šäº†&lt;/a&gt; Pinï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å°±ç®€å•çš„ä»‹ç»ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;æ–¹æ³•é€šå¸¸é€šè¿‡å¦‚ä¸‹æ–¹å¼å®šä¹‰æ¥æ”¶è€…ï¼ˆreceiverï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;MyType&lt;/span&gt; {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;do_thing&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;self) {
        println&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;my value is {}&amp;#34;&lt;/span&gt;, self.value)
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¹Ÿå°±æ˜¯ä¸‹é¢çš„ç®€å†™ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;MyType&lt;/span&gt; {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;do_thing&lt;/span&gt;(self: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;Self&lt;/span&gt;) {
        println&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;my value is {}&amp;#34;&lt;/span&gt;, self.value)
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å› ä¸ºæˆ‘ä»¬åœ¨ &lt;code&gt;impl MyType&lt;/code&gt; ä»£ç å—ä¸­ &lt;code&gt;Self&lt;/code&gt; å°±æ˜¯ &lt;code&gt;MyType&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;å¾ˆæ¸…æ™°å§ï¼Ÿå¥½äº†ï¼Œè¿˜å¯ä»¥å®šä¹‰å…¶ä»–å¾ˆå¤šç±»å‹ä½œä¸ºæ¥æ”¶è€…ï¼Œ &lt;code&gt;Pin&amp;lt;&amp;amp;mut Self&amp;gt;&lt;/code&gt; å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;MyType&lt;/span&gt; {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;do_thing&lt;/span&gt;(self: &lt;span style=&#34;color:#a6e22e&#34;&gt;Pin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; Self&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;) {
        &lt;span style=&#34;color:#75715e&#34;&gt;// good luck!1
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é‚£ä¹ˆ &lt;code&gt;MyType&lt;/code&gt; å¿…é¡»æ˜¯å›ºå®šçš„ï¼ˆpinnedï¼‰æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿæ¯”å¦‚ï¼Œå®ƒä¿è¯ä¸è¿›è¡Œè½¬ç§»ï¼ˆmoveï¼‰ã€‚é™¤éå®ƒå®ç°äº† &lt;code&gt;Unpin&lt;/code&gt; ï¼Œ
ç„¶åå®ƒå°±å¯ä»¥æ˜¯éå›ºå®šçš„ï¼ˆunpinnedï¼‰ï¼Œå¯ç§»åŠ¨ï¼Œç„¶åè¢«å†ä¸€æ¬¡å›ºå®šã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºå‰©ä¸‹çš„æ–‡ç« ï¼Œæˆ‘ä»¬ä¸ä¼šå‡è®¾æˆ‘ä»¬çš„ future &lt;code&gt;A&lt;/code&gt; å’Œ &lt;code&gt;B&lt;/code&gt; éƒ½æ˜¯ &lt;code&gt;Unpin&lt;/code&gt; ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è‡ªå·±ä¸ä¼šç§»åŠ¨ï¼ˆmoveï¼‰å®ƒä»¬ï¼ˆåªé”€æ¯ï¼ˆdropï¼‰å®ƒä»¬ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä½ å¯ä»¥è¯´æˆ‘ä»¬ä¸éœ€è¦ &lt;code&gt;A&lt;/code&gt; å’Œ &lt;code&gt;B&lt;/code&gt; æ˜¯ &lt;code&gt;Unpin&lt;/code&gt; çš„ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰æ·»åŠ æŒ‡å®šçš„ where clause æ¥æ ‡è®°éœ€è¦å®ƒä»¬æ˜¯ &lt;code&gt;Unpin&lt;/code&gt; ã€‚
å› ä¸ºå¦‚æœæˆ‘ä»¬éœ€è¦ï¼Œæˆ‘ä»¬å°±è¦åƒä¸‹é¢è¿™æ ·æ·»åŠ é¢å¤–çš„ &lt;code&gt;trait bound&lt;/code&gt; ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;TryJoin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, B, AR, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt;
    &lt;span style=&#34;color:#75715e&#34;&gt;//                                    ğŸ‘‡
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    A: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;AR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; Unpin,
    B: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;+&lt;/span&gt; Unpin,
{}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½å‡è®¾ &lt;code&gt;A&lt;/code&gt; æˆ– &lt;code&gt;B&lt;/code&gt; æ˜¯ &lt;code&gt;Unpin&lt;/code&gt; çš„ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼æˆ‘ä»¬ç°åœ¨çœŸçš„åªæ˜¯é¢ä¸´å›ºå®šï¼ˆpinï¼‰ä¿æŠ¤çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç°åœ¨åªæŒæœ‰ä¸€ä¸ª &lt;code&gt;Pin&amp;lt;&amp;amp;mut TryJoin&amp;lt;A, B, ...&amp;gt;&amp;gt;&lt;/code&gt; ä½†æ˜¯æˆ‘å¸Œæœ›æŒç»­ä¸€ä¸ª &lt;code&gt;Pin&amp;lt;&amp;amp;mut A&amp;gt;&lt;/code&gt; ï¼ˆå› ä¸ºè¿™å°±æ˜¯æˆ‘ä»¬å› ä¸ºéœ€è¦è½®è¯¢ &lt;code&gt;A&lt;/code&gt; ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–ä¸€ä¸ªè§£å†³æ–¹æ³•ï¼Œæˆ‘å€¾å‘äºé€šè¿‡ä¸€äº›ç±»ä¼¼ &lt;a href=&#34;https://lib.rs/crates/pin-project&#34;&gt;pin-project&lt;/a&gt; åŒ…ï¼Œæˆ–è€…ç±»ä¼¼ &lt;a href=&#34;https://lib.rs/crates/pin-project-lite&#34;&gt;pin-project-lite&lt;/a&gt;ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬å‰è¿›çš„æ–¹å‘ç›´æ¥ä½¿ç”¨ &lt;code&gt;pin-project&lt;/code&gt; çœŸçš„å¾ˆå°´å°¬ï¼Œ
æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä½¿ç”¨ &lt;code&gt;unsafe&lt;/code&gt; ä½œä¸ºæ›¿ä»£ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;poll&lt;/span&gt;(self: &lt;span style=&#34;color:#a6e22e&#34;&gt;Pin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; Self&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;, cx: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;mut&lt;/span&gt; Context&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;_&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Poll&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Self::Output&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;unsafe&lt;/span&gt; { self.map_unchecked_mut(&lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt;this&lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; this.a) };
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; a.poll(cx);

    todo&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;()
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯ä»¥é€šè¿‡ç¼–è¯‘ã€‚ä½†æ˜¯æˆ‘ä»¬åœ¨ä½¿ç”¨ &lt;code&gt;unsafe&lt;/code&gt; ï¼Œä¹Ÿå°±æ„å‘³ç€ç¼–è¯‘å™¨æ­£å¼åœæ­¢ &lt;del&gt;ç…§é¡¾&lt;/del&gt; æ£€æŸ¥æˆ‘ä»¬çš„ä»£ç ã€‚
æˆ‘ä»¬è‡ªå·±å¿…é¡»å¼ºåˆ¶æ‰§è¡Œä¸€äº›ä¸å˜é‡ï¼ˆinvariantsï¼‰ï¼Œå¹¶ä¸”éå¸¸éå¸¸å°å¿ƒï¼ŒåŒæ—¶è®©å…¶ä»–äººå®¡æŸ¥ï¼ˆreviewï¼‰æˆ‘ä»¬çš„å·¥ä½œï¼Œ
ä½†æ˜¯ä¾ç„¶å¯èƒ½ä¼šå‡ºé”™ï¼Œå› ä¸ºä»–ä»¬ä¹Ÿä¼šä¼‘æ¯ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨ï¼Œéå¸¸æ£’çš„æ˜¯æˆ‘ä»¬å¯ä»¥è½®è¯¢ &lt;code&gt;a&lt;/code&gt; ã€‚å®ƒå¦‚æœå®Œæˆä¼šè¿”å› &lt;code&gt;Poll::Ready(Result&amp;lt;AR, E&amp;gt;)&lt;/code&gt; ï¼Œ
å¦åˆ™å°±æ˜¯ç­‰ä¼šä¼šå®Œæˆåˆ™è¿”å› &lt;code&gt;Poll::Pending&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;poll&lt;/span&gt;(self: &lt;span style=&#34;color:#a6e22e&#34;&gt;Pin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; Self&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;, cx: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;mut&lt;/span&gt; Context&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;_&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Poll&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Self::Output&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;unsafe&lt;/span&gt; { self.map_unchecked_mut(&lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt;this&lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; this.a) };
    &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; a.poll(cx) {
        Poll::Pending &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; {
            info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;A is pending...&amp;#34;&lt;/span&gt;);
            &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Poll::Pending;
        }
        Poll::Ready(res) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; res {
            Ok(_) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;A is ready!&amp;#34;&lt;/span&gt;),
            Err(e) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Poll::Ready(Err(e)),
        },
    }

    todo&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;()
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬é€šè¿‡æ‰“å°æ—¥å¿—â€œA is pendingâ€çŸ¥é“å‡†å¤‡å®Œæˆã€‚è¿™å¯èƒ½éœ€è¦å‡ ä¸ªå›åˆï¼šæ¯•ç«Ÿï¼Œæˆ‘ä»¬æ­£åœ¨åšä¸€äº›é‡è¦çš„äº‹æƒ…ã€‚
æˆ‘ä»¬å»ºç«‹ä¸€ä¸ª TCP è¿æ¥ï¼Œæ¥ç€åœ¨ä¸Šé¢è¿›è¡Œ TLS ä¼šè¯ï¼Œæ¥ç€æ˜¯ä¸€äº›åˆ†å¼€çš„å†™ï¼Œæœ€åè¯»åˆ° EOFï¼ˆend of fileï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬è¿è¡Œå®ƒçš„è¯ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;aytoodeep::tj: A is pending...
Jul 25 22:54:14.495  INFO waytoodeep::tj: A is pending...
Jul 25 22:54:14.495  INFO waytoodeep::tj: A is pending...
Jul 25 22:54:14.495  INFO waytoodeep::tj: A is pending...
Jul 25 22:54:14.495  INFO waytoodeep::tj: A is pending...
Jul 25 22:54:14.495  INFO waytoodeep::tj: A is pending...
Jul 25 22:54:14.495  INFO waytoodeep::tj: A is pending...
Jul 25 22:54:14.495  INFO waytoodeep::tj: A is pending...
Jul 25 22:54:14.513  INFO waytoodeep::tj: A is pending...
Jul 25 22:54:14.513  INFO waytoodeep::tj: A is pending...
Jul 25 22:54:14.513  INFO waytoodeep::tj: A is pending...
Jul 25 22:54:14.513  INFO waytoodeep::tj: A is pending...
Jul 25 22:54:14.513  INFO waytoodeep::tj: A is pending...
Jul 25 22:54:14.514  INFO waytoodeep::tj: A is pending...
Jul 25 22:54:14.522  INFO waytoodeep::tj: A is pending...
Jul 25 22:54:14.522  INFO waytoodeep::tj: A is pending...
Jul 25 22:54:14.522  INFO waytoodeep::tj: A is pending...
Jul 25 22:54:14.522  INFO waytoodeep::tj: A is pending...
Jul 25 22:54:14.522  INFO waytoodeep::tj: A is pending...
Jul 25 22:54:14.523  INFO waytoodeep::tj: A is pending...
Jul 25 22:54:14.523  INFO waytoodeep::tj: A is pending...
Jul 25 22:54:14.530  INFO waytoodeep::tj: A is pending...
Jul 25 22:54:14.530  INFO waytoodeep::tj: A is pending...
Jul 25 22:54:14.530  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=first
Jul 25 22:54:14.530  INFO waytoodeep::tj: A is ready!
The application panicked (crashed).
Message:  not yet implemented
Location: src/tj.rs:46

Backtrace omitted.
Run with RUST_BACKTRACE=1 environment variable to display it.
Run with RUST_BACKTRACE=full to include source snippets.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒç¡®å®èŠ±è´¹äº†å‡ ä¸ªå›åˆã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„å¦‚æœ &lt;code&gt;A&lt;/code&gt; è¿”å›é”™è¯¯æˆ‘ä»¬çš„ä»£ç ä¹Ÿä¼šè¿”å› &lt;code&gt;Poll:Ready&lt;/code&gt; ï¼Œå› ä¸ºæˆ‘ä»¬æƒ³æ”¶é›† A å’Œ B çš„ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å¯¹ B åšç›¸åŒçš„äº‹æƒ…ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;poll&lt;/span&gt;(self: &lt;span style=&#34;color:#a6e22e&#34;&gt;Pin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; Self&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;, cx: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;mut&lt;/span&gt; Context&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;_&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Poll&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Self::Output&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;unsafe&lt;/span&gt; { self.map_unchecked_mut(&lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt;this&lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; this.a) };
    &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; a.poll(cx) {
        Poll::Pending &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; {
            info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;A is pending...&amp;#34;&lt;/span&gt;);
            &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Poll::Pending;
        }
        Poll::Ready(res) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; res {
            Ok(_) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;A is ready!&amp;#34;&lt;/span&gt;),
            Err(e) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Poll::Ready(Err(e)),
        },
    }

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; b &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;unsafe&lt;/span&gt; { self.map_unchecked_mut(&lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt;this&lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; this.a) };
    &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; b.poll(cx) {
        Poll::Pending &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; {
            info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;B is pending...&amp;#34;&lt;/span&gt;);
            &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Poll::Pending;
        }
        Poll::Ready(res) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; res {
            Ok(_) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;B is ready!&amp;#34;&lt;/span&gt;),
            Err(e) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Poll::Ready(Err(e)),
        },
    }

    todo&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;()
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶åã€‚ã€‚whoopsï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;RUST_LOG=info cargo run --quiet --release
error[E0382]: use of moved value: `self`
   --&amp;gt; src/tj.rs:46:26
    |
33  |     fn poll(self: Pin&amp;lt;&amp;amp;mut Self&amp;gt;, cx: &amp;amp;mut Context&amp;lt;&#39;_&amp;gt;) -&amp;gt; Poll&amp;lt;Self::Output&amp;gt; {
    |             ---- move occurs because `self` has type `Pin&amp;lt;&amp;amp;mut TryJoin&amp;lt;A, B, AR, BR, E&amp;gt;&amp;gt;`, which does not implement the `Copy` trait
34  |         let a = unsafe { self.map_unchecked_mut(|this| &amp;amp;mut this.a) };
    |                               ------------------------------------- `self` moved due to this method call
...
46  |         let b = unsafe { self.map_unchecked_mut(|this| &amp;amp;mut this.a) };
    |                          ^^^^ value used here after move
    |
note: this function takes ownership of the receiver `self`, which moves `self`
   --&amp;gt; /home/amos/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/pin.rs:776:43
    |
776 |     pub unsafe fn map_unchecked_mut&amp;lt;U, F&amp;gt;(self, func: F) -&amp;gt; Pin&amp;lt;&amp;amp;&#39;a mut U&amp;gt;
    |                                           ^^^^
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;æ˜¯çš„ã€‚ &lt;code&gt;map_unchecked_mut&lt;/code&gt; å æœ‰äº† &lt;code&gt;self&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code&gt;.as_mut()&lt;/code&gt; ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;//       ğŸ‘‡
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;poll&lt;/span&gt;(&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; self: &lt;span style=&#34;color:#a6e22e&#34;&gt;Pin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; Self&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;, cx: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;mut&lt;/span&gt; Context&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;_&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Poll&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Self::Output&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    &lt;span style=&#34;color:#75715e&#34;&gt;//                      ğŸ‘‡
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;unsafe&lt;/span&gt; { self.as_mut().map_unchecked_mut(&lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt;this&lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; this.a) };
    &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; a.poll(cx) {
        Poll::Pending &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; {
            info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;A is pending...&amp;#34;&lt;/span&gt;);
            &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Poll::Pending;
        }
        Poll::Ready(res) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; res {
            Ok(_) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;A is ready!&amp;#34;&lt;/span&gt;),
            Err(e) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Poll::Ready(Err(e)),
        },
    }

    &lt;span style=&#34;color:#75715e&#34;&gt;//                      ğŸ‘‡
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; b &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;unsafe&lt;/span&gt; { self.as_mut().map_unchecked_mut(&lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt;this&lt;span style=&#34;color:#f92672&#34;&gt;|&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; this.a) };
    &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; b.poll(cx) {
        Poll::Pending &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; {
            info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;B is pending...&amp;#34;&lt;/span&gt;);
            &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Poll::Pending;
        }
        Poll::Ready(res) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; res {
            Ok(_) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;B is ready!&amp;#34;&lt;/span&gt;),
            Err(e) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Poll::Ready(Err(e)),
        },
    }

    todo&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;()
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä½†æ˜¯ä¾ç„¶æ— æ³•é€šè¿‡ç¼–è¯‘ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info cargo run --quiet --release
(cut)
Jul 25 22:57:07.913  INFO waytoodeep::tj: A is pending...
Jul 25 22:57:07.913  INFO waytoodeep::tj: A is pending...
Jul 25 22:57:07.913  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=first
Jul 25 22:57:07.913  INFO waytoodeep::tj: A is ready!
The application panicked (crashed).
Message:  `async fn` resumed after completion
Location: src/main.rs:24

Backtrace omitted.
Run with RUST_BACKTRACE=1 environment variable to display it.
Run with RUST_BACKTRACE=full to include source snippets.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œä¸€æ—¦ &lt;code&gt;Future&lt;/code&gt; è¿”å› &lt;code&gt;Poll::Ready&lt;/code&gt; æˆ‘ä»¬å°±ä¸èƒ½å†æ¬¡è½®è¯¢å®ƒäº†ã€‚æˆ‘ä»¬ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿå› ä¸º &lt;code&gt;Future&lt;/code&gt; å·²ç»è¿”å›äº†ç»“æœã€‚å¦‚æœç»“æœæ˜¯é &lt;code&gt;Copy&lt;/code&gt; çš„ï¼Œå®ƒå¯èƒ½åªèƒ½è¿”å›ä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦ 1ï¼‰è·Ÿè¸ª &lt;code&gt;A&lt;/code&gt; æ˜¯å¦å®Œæˆï¼Œç„¶å 2ï¼‰åœ¨æŸä¸ªåœ°æ–¹å­˜å‚¨å®ƒçš„è¿”å›ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åªéœ€è¦åœ¨æˆ‘ä»¬çš„ç»“æ„ä½“ä¸­æ·»åŠ ä¸€äº›å­—æ®µï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;TryJoin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, B, AR, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt;
    A: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;AR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
    B: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
{
    a: &lt;span style=&#34;color:#a6e22e&#34;&gt;A&lt;/span&gt;,
    b: &lt;span style=&#34;color:#a6e22e&#34;&gt;B&lt;/span&gt;,
    &lt;span style=&#34;color:#75715e&#34;&gt;// ğŸ‘‡
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    a_res: Option&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;AR&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;,
    b_res: Option&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;BR&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;,
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ä¸è¦å¿˜è®°åˆå§‹åŒ–å®ƒä»¬ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;pub&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;try_join&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, B, AR, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;(a: &lt;span style=&#34;color:#a6e22e&#34;&gt;A&lt;/span&gt;, b: &lt;span style=&#34;color:#a6e22e&#34;&gt;B&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;impl&lt;/span&gt; Future&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(AR, BR), E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt;
    A: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;AR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
    B: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
{
    TryJoin {
        a,
        b,
        &lt;span style=&#34;color:#75715e&#34;&gt;// ğŸ‘‡
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;        a_res: None,
        b_res: None,
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨è®¡åˆ’æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœ &lt;code&gt;a_res&lt;/code&gt; æ˜¯ &lt;code&gt;Some&lt;/code&gt; ï¼Œç„¶åæˆ‘ä»¬å°±ä¸éœ€è¦è½®è¯¢ &lt;code&gt;a&lt;/code&gt; ,å› ä¸ºå®ƒå·²ç»å®Œæˆäº†&lt;/li&gt;
&lt;li&gt;åŒæ ·çš„é€»è¾‘å¤„ç† &lt;code&gt;b_res&lt;/code&gt; å’Œ &lt;code&gt;b&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è®©æˆ‘ä»¬å®ç°å®ƒã€‚åŒæ—¶ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»åœ¨ä½¿ç”¨äº† &lt;code&gt;unsafe&lt;/code&gt; ï¼Œæ‰€ä»¥æˆ‘ä»¬å·²ç»è´Ÿè´£ç»´æŠ¤ä¸å˜é‡ï¼ˆinvariantsï¼‰ï¼Œ
æ‰€ä»¥æˆ‘å†³å®šåŒæ—¶å›ºå®š &lt;code&gt;a&lt;/code&gt; å’Œ &lt;code&gt;b&lt;/code&gt; ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;poll&lt;/span&gt;(self: &lt;span style=&#34;color:#a6e22e&#34;&gt;Pin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; Self&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;, cx: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;mut&lt;/span&gt; Context&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;_&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Poll&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Self::Output&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; this &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;unsafe&lt;/span&gt; { self.get_unchecked_mut() };
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; (a, b) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;unsafe&lt;/span&gt; {
        (
            Pin::new_unchecked(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; this.a),
            Pin::new_unchecked(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; this.b),
        )
    };

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; this.a_res.is_none() {
        &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; a.poll(cx) {
            Poll::Pending &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Poll::Pending,
            Poll::Ready(res) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; res {
                Ok(x) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; this.a_res &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Some(x),
                Err(e) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Poll::Ready(Err(e)),
            },
        }
    }

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; this.b_res.is_none() {
        &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; b.poll(cx) {
            Poll::Pending &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Poll::Pending,
            Poll::Ready(res) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; res {
                Ok(x) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; this.b_res &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Some(x),
                Err(e) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Poll::Ready(Err(e)),
            },
        }
    }

    todo&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;()
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¥½äº†ï¼Œè¿™ä¸ªåº”è¯¥èƒ½è®© &lt;code&gt;a&lt;/code&gt; å’Œ &lt;code&gt;b&lt;/code&gt; æœ‰æœºä¼šåœ¨æˆ‘ä»¬å´©æºƒä¹‹å‰å®Œæˆï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info cargo run --quiet --release
Jul 25 23:11:03.851  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=first
Jul 25 23:11:04.380  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=second
The application panicked (crashed).
Message:  not yet implemented
Location: src/tj.rs:69

Backtrace omitted.
Run with RUST_BACKTRACE=1 environment variable to display it.
Run with RUST_BACKTRACE=full to include source snippets.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¾ˆå¥½ï¼ç°åœ¨æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯è§£å‡ºä¸¤ä¸ªç»“æœå¹¶è¿”å›å®ƒä»¬ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// instead of the `todo!()`:
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; (Some(_), Some(_)) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;this.a_res, &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;this.b_res) {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; this.a_res.take().unwrap();
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; b &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; this.b_res.take().unwrap();
    Poll::Ready(Ok((a, b)))
} &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; {
    Poll::Pending
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å¯ä»¥å·¥ä½œï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info cargo run --quiet --release
Jul 25 23:13:32.497  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=first
Jul 25 23:13:32.829  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=second
Jul 25 23:13:32.829  INFO waytoodeep: All done! res=(&amp;quot;first&amp;quot;, &amp;quot;second&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ã€‚ã€‚ã€‚ä½†æ˜¯è¿™ä¸æ˜¯ &lt;code&gt;try_join&lt;/code&gt; çš„å®ç°ã€‚æˆ‘ä»¬æ­£åœ¨åšçš„å’Œè¿™ä¸ªå®Œå…¨ä¸€æ ·ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// (pseudo-code, buncha things are missing)
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;try_join&lt;/span&gt;(a: &lt;span style=&#34;color:#a6e22e&#34;&gt;A&lt;/span&gt;, b: &lt;span style=&#34;color:#a6e22e&#34;&gt;B&lt;/span&gt;) {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self.a.&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; b &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; self.b.&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    Ok((a, b))
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æ˜¯é¡ºåºçš„æ‰§è¡Œçš„ã€‚è¯·è®°ä½ï¼Œä»…ä»…æ˜¯å› ä¸º tokio çš„æ‰§è¡Œå™¨å¯èƒ½ç”¨äº†ä¸€å †çº¿ç¨‹å¹¶æ„å‘³ç€åŒæ—¶è¿è¡Œæ˜¯è‡ªåŠ¨çš„ã€‚
å‰é¢æˆ‘ä»¬ä¸å¾—ä¸ä½¿ç”¨ &lt;code&gt;tokio::spwan&lt;/code&gt; æˆ– &lt;code&gt;UnorderedFutures&lt;/code&gt; æˆ– &lt;code&gt;try_join!&lt;/code&gt; è®©å…¶åŒæ—¶è¿è¡Œã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è®©æˆ‘ä»¬é‡æ–°çœ‹ä¸€ä¸‹ã€‚ã€‚ã€‚å½“æˆ‘ä»¬è½®è¯¢ &lt;code&gt;a&lt;/code&gt; çš„æ˜¯åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; this.a_res.is_none() {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; a.poll(cx) {
        Poll::Pending &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Poll::Pending,
        Poll::Ready(res) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; res {
            Ok(x) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; this.a_res &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Some(x),
            Err(e) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Poll::Ready(Err(e)),
        },
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;é¢ï¼Œå½“è½®è¯¢ &lt;code&gt;a&lt;/code&gt; çš„æ—¶å€™è¿”å› &lt;code&gt;Poll::Pending&lt;/code&gt; æ—¶æˆ‘ä»¬ä¹Ÿä¼šè¿”å› &lt;code&gt;Poll::Pending&lt;/code&gt;  ã€‚æ‰€ä»¥è¿™å°±æ˜¯é—®é¢˜ã€‚
å¦‚æœ &lt;code&gt;a&lt;/code&gt; æ­£åœ¨ç­‰å¾…ï¼ˆpendingï¼‰æˆ‘ä»¬ä¸åº”è¯¥è¿”å›ã€‚å› ä¸ºå¦‚æœè¿™æ—¶å€™ &lt;code&gt;b&lt;/code&gt; å·²ç»å‡†å¤‡å¥½æˆ–è€…æœ‰é”™è¯¯å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æˆ–è€…å¦‚æœï¼Œæˆ‘ä»¬åƒè¿™æ ·è°ƒç”¨ &lt;code&gt;try_join&lt;/code&gt; å‘¢ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Joining...&amp;#34;&lt;/span&gt;);
&lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; res &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; tj::try_join(
    &lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;move&lt;/span&gt; {
        sleep(Duration::from_millis(&lt;span style=&#34;color:#ae81ff&#34;&gt;2000&lt;/span&gt;)).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;;
        Ok(())
    },
    &lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;move&lt;/span&gt; {
        sleep(Duration::from_millis(&lt;span style=&#34;color:#ae81ff&#34;&gt;10&lt;/span&gt;)).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;;
        Err::&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;(color_eyre::eyre::eyre&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;uh oh&amp;#34;&lt;/span&gt;))
    },
)
.&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ã€‚ã€‚ã€‚ç„¶å &lt;code&gt;a&lt;/code&gt; èŠ±è´¹äº† 2 ç§’é’Ÿæ‰å‡†å¤‡å¥½ï¼ŒåŒæ—¶ &lt;code&gt;b&lt;/code&gt; ä¼šåœ¨ 10æ¯«ç§’ä¹‹åè¿”å›ä¸€ä¸ªé”™è¯¯ï¼Œå¦‚æœæˆ‘ä»¬è½®è¯¢å®ƒï¼&lt;/p&gt;
&lt;p&gt;å—ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info cargo run --quiet --release
Jul 25 23:19:26.972  INFO waytoodeep: Joining...
Jul 25 23:19:28.990  INFO waytoodeep: All done! res=Err(
   0: uh oh

Location:
   src/main.rs:28
(cut)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ï¼ˆæ³¨æ„æ—¶é—´æˆ³ï¼‰&lt;/p&gt;
&lt;p&gt;é‡ç‚¹æ˜¯ &lt;code&gt;try_join&lt;/code&gt; ä¼šæå‰å¤±è´¥ï¼šä¸€æ—¦ Future è¿”å› &lt;code&gt;Result::Err~&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å¿…é¡»åŒæ—¶è½®è¯¢ &lt;code&gt;a&lt;/code&gt; å’Œ &lt;code&gt;b&lt;/code&gt; ã€‚å¥½å§ã€‚ã€‚ã€‚ä¸æ˜¯ä¸¥æ ¼æ„ä¹‰çš„åŒæ—¶ã€‚æˆ‘ä»¬å¿…é¡»æ¯æ¬¡æˆ‘ä»¬çš„ &lt;code&gt;TryJoin&lt;/code&gt; future å¯¹è±¡è¢«è½®è¯¢æ—¶å¹¶å‘ï¼ˆconcurrentlyï¼‰çš„è½®è¯¢å®ƒä»¬ï¼Œ
ç›´åˆ°å®ƒä»¬è¿”å›ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ä¸€ä¸ªç®€å•è§£å†³åŠæ³• &amp;ndash; åœ¨ä»»ä¸€ future å¯¹è±¡è¿”å› &lt;code&gt;Poll::Pending&lt;/code&gt; æ—¶ä¸è¿”å› &lt;code&gt;Poll::Pending&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ—¶ï¼Œæˆ‘åŒå€¦äº†è¾“å…¥ &lt;code&gt;Poll::Ready&lt;/code&gt; å¹¶ä¸” &lt;code&gt;Poll&amp;lt;T&amp;gt;&lt;/code&gt; å®ç°äº† &lt;code&gt;From&amp;lt;T&amp;gt;&lt;/code&gt; ,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code&gt;.into()&lt;/code&gt; äº†ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;poll&lt;/span&gt;(self: &lt;span style=&#34;color:#a6e22e&#34;&gt;Pin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; Self&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;, cx: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;mut&lt;/span&gt; Context&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;_&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Poll&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Self::Output&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; this &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;unsafe&lt;/span&gt; { self.get_unchecked_mut() };
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; (a, b) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;unsafe&lt;/span&gt; {
        (
            Pin::new_unchecked(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; this.a),
            Pin::new_unchecked(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; this.b),
        )
    };

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; this.a_res.is_none() {
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; Poll::Ready(res) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; a.poll(cx) {
            &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; res {
                Ok(x) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; this.a_res &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Some(x),
                Err(e) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Err(e).into(),
            }
        }
    }

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; this.b_res.is_none() {
        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; Poll::Ready(res) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; b.poll(cx) {
            &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; res {
                Ok(x) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; this.b_res &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Some(x),
                Err(e) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Err(e).into(),
            }
        }
    }

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; (Some(_), Some(_)) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; (&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;this.a_res, &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;this.b_res) {
        &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; this.a_res.take().unwrap();
        &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; b &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; this.b_res.take().unwrap();
        Ok((a, b)).into()
    } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; {
        Poll::Pending
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è®©æˆ‘ä»¬å†æ¬¡è¿è¡Œ&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info cargo run --quiet --release
Jul 25 23:22:40.238  INFO waytoodeep: Joining...
Jul 25 23:22:40.253  INFO waytoodeep: All done! res=Err(
   0: uh oh

Location:
   src/main.rs:28

(cut)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ã€‚ã€‚ã€‚å¯ä»¥äº†ï¼æˆ‘æ˜¯è¯´å®ƒæŒ‰ç…§é¢„æœŸçš„å¤±è´¥äº†ã€‚é¢„æœŸçš„å¤±è´¥å°±æ˜¯æˆåŠŸã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬å°†è¿™ä¸ªæ–¹æ³•åº”ç”¨åˆ°è°ƒç”¨ &lt;code&gt;try_join&lt;/code&gt; :&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main(flavor = &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;current_thread&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    setup()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Joining...&amp;#34;&lt;/span&gt;);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; res &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; tj::try_join(fetch_thing(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;first&amp;#34;&lt;/span&gt;), fetch_thing(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;second&amp;#34;&lt;/span&gt;)).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;res, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;All done!&amp;#34;&lt;/span&gt;);

    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç«äº‰åˆå›æ¥äº†ï¼šæœ‰æ—¶ &lt;code&gt;first&lt;/code&gt; å…ˆå®Œæˆï¼Œæœ‰æ—¶åˆ™ä¸æ˜¯ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info cargo run --quiet --release
Jul 25 23:25:25.925  INFO waytoodeep: Joining...
Jul 25 23:25:26.224  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=first
Jul 25 23:25:26.236  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=second
Jul 25 23:25:26.236  INFO waytoodeep: All done! res=(&amp;quot;first&amp;quot;, &amp;quot;second&amp;quot;)
$ RUST_LOG=info cargo run --quiet --release
Jul 25 23:25:26.937  INFO waytoodeep: Joining...
Jul 25 23:25:27.237  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=first
Jul 25 23:25:27.242  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=second
Jul 25 23:25:27.242  INFO waytoodeep: All done! res=(&amp;quot;first&amp;quot;, &amp;quot;second&amp;quot;)
$ RUST_LOG=info cargo run --quiet --release
Jul 25 23:25:27.865  INFO waytoodeep: Joining...
Jul 25 23:25:28.164  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=second
Jul 25 23:25:28.818  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=first
Jul 25 23:25:28.818  INFO waytoodeep: All done! res=(&amp;quot;first&amp;quot;, &amp;quot;second&amp;quot;)
$ RUST_LOG=info cargo run --quiet --release
Jul 25 23:25:30.153  INFO waytoodeep: Joining...
Jul 25 23:25:31.477  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=second
Jul 25 23:25:31.496  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=first
Jul 25 23:25:31.496  INFO waytoodeep: All done! res=(&amp;quot;first&amp;quot;, &amp;quot;second&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ã€‚ã€‚ã€‚åŒæ—¶ç»“æœçš„é¡ºåºæ˜¯æ­£ç¡®çš„ã€‚&lt;/p&gt;
&lt;p&gt;éå¸¸å¥½ï¼Œæˆ‘ä»¬å®ç°äº†å®ƒï¼&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼&lt;/p&gt;
&lt;h3 id=&#34;æˆ‘ä»¬å¯ä»¥åšçš„æ›´å¥½&#34;&gt;æˆ‘ä»¬å¯ä»¥åšçš„æ›´å¥½&lt;/h3&gt;
&lt;p&gt;å¹¸è¿çš„æ˜¯ï¼Œåå°±æ˜¯å¥½ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è¿™ä¸ªç±»å‹å›°æ‰°ç€æˆ‘ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;TryJoin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, B, AR, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt;
    A: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;AR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
    B: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
{
    a: &lt;span style=&#34;color:#a6e22e&#34;&gt;A&lt;/span&gt;,
    b: &lt;span style=&#34;color:#a6e22e&#34;&gt;B&lt;/span&gt;,
    a_res: Option&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;AR&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;,
    b_res: Option&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;BR&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;,
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;æˆ‘å…¶å®åªæœ‰åœ¨ &lt;code&gt;a&lt;/code&gt; å®Œæˆåæ‰éœ€è¦ &lt;code&gt;a_res&lt;/code&gt; ã€‚ä¸€æ—¦ &lt;code&gt;a&lt;/code&gt; å®Œæˆç„¶åå°†ç»“æœå­˜å‚¨åˆ° &lt;code&gt;a_res&lt;/code&gt; ï¼Œæˆ‘ä»¬å°±ä¸å†éœ€è¦ &lt;code&gt;a&lt;/code&gt; äº†ã€‚&lt;/p&gt;
&lt;p&gt;å®é™…ä¸Šï¼Œç”šè‡³æˆ‘ä»¬ä¸åº”è¯¥å†ç¢° &lt;code&gt;a&lt;/code&gt;  ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å¬èµ·æ¥æ›´åƒæˆ‘ä»¬è¦ä¹ˆæŒæœ‰ &lt;code&gt;A&lt;/code&gt; è¦ä¹ˆæŒæœ‰ &lt;code&gt;AR&lt;/code&gt; ï¼Œä½†æ˜¯æ°¸è¿œä¸ä¼šåŒæ—¶æŒæœ‰ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;SUM TYPES&lt;/code&gt; : Rust çš„æšä¸¾å°±æ˜¯ä¸€ä¸ªæ±‡æ€»ç±»å‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ‰€ä»¥ï¼æ±‡æ€»ç±»å‹ã€‚Rust æšä¸¾ã€‚è¿™å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå«åš &lt;code&gt;State&lt;/code&gt; çš„ç±»å‹ï¼Œç„¶åå®ƒæœ‰ä¸¤ä¸ªå˜ä½“ï¼š
ä¸€ä¸ªç”¨äºå®ƒè¿˜æ˜¯ future å¯¹è±¡ï¼Œä¸€ä¸ªç”¨äºå®ƒæ˜¯ä¸€ä¸ªç»“æœã€‚éå¸¸ç®€å•ï¼&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;enum&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;F, T, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt;
    F: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;T, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
{
    Future(F),
    Ok(T),
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™å°†ä¼šéå¸¸æ£’ï¼&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬èµ‹ç»™æˆ‘ä»¬çš„ &lt;code&gt;TryJoin&lt;/code&gt; ç»“æ„ä½“ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;TryJoin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, B, AR, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt;
    A: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;AR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
    B: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
{
    a: &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, AR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;,
    b: &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;B, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;,
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ï¼ˆæ˜¯ä¸æ˜¯éå¸¸æ¼‚äº®ï¼‰&lt;/p&gt;
&lt;p&gt;ç„¶ååˆå§‹åŒ–å®ƒä»¬ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;pub&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;try_join&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, B, AR, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;(a: &lt;span style=&#34;color:#a6e22e&#34;&gt;A&lt;/span&gt;, b: &lt;span style=&#34;color:#a6e22e&#34;&gt;B&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;impl&lt;/span&gt; Future&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(AR, BR), E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt;
    A: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;AR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
    B: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
{
    TryJoin {
        a: &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;::Future(a),
        b: &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;::Future(b),
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;éå¸¸é…·ã€‚ç„¶åæˆ‘ä»¬åªéœ€è¦ç¨å¾®è°ƒæ•´ä¸€ä¸‹æˆ‘ä»¬çš„ &lt;code&gt;poll&lt;/code&gt; æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦å°† &lt;code&gt;Pin&amp;lt;&amp;amp;mut Self&amp;gt;&lt;/code&gt; è½¬æ¢ä¸º &lt;code&gt;&amp;amp;mut Self&lt;/code&gt; ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;poll&lt;/span&gt;(self: &lt;span style=&#34;color:#a6e22e&#34;&gt;Pin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; Self&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;, cx: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;mut&lt;/span&gt; Context&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;_&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Poll&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Self::Output&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; this &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;unsafe&lt;/span&gt; { self.get_unchecked_mut() };
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™æ˜¯å¯ä»¥çš„ï¼Œå› ä¸ºæˆ‘ä»¬æ‰¿è¯ºç»´æŠ¤ä¸å˜é‡ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¸ä¼šè½¬ç§»ï¼ˆmoveï¼‰ &lt;code&gt;State::Future&lt;/code&gt; å†…éƒ¨ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå¦‚æœ &lt;code&gt;a&lt;/code&gt; æ˜¯ &lt;code&gt;State::Future&lt;/code&gt; æˆ‘ä»¬å°±è½®è¯¢å®ƒï¼Œç„¶åæˆ‘ä»¬å†ä¼ æ’­é”™è¯¯æˆ–è€…ä¿å­˜å®ƒçš„ç»“æœï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; State::Future(a) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; this.a {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;unsafe&lt;/span&gt; { Pin::new_unchecked(a) };
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; Poll::Ready(res) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; a.poll(cx) {
        &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; res {
            Ok(t) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; this.a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; State::Ok(t),
            Err(e) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;return&lt;/span&gt; Err(e).into(),
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶ååŒæ ·çš„ä¿®æ”¹ &lt;code&gt;b&lt;/code&gt; ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// you can figure that one out, I believe in you
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶åæˆ‘ä»¬å°±å®Œæˆäº†å¦‚æœå®ƒä»¬éƒ½æ˜¯ &lt;code&gt;State::Ok&lt;/code&gt; ï¼å¦åˆ™æˆ‘ä»¬å°±è¿”å› &lt;code&gt;Poll::Pending&lt;/code&gt; :&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; (this.a, this.b) {
    (State::Ok(a), State::Ok(b)) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; Ok((a, b)).into(),
    _ &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; Poll::Pending,
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;éå¸¸å¥½ã€‚&lt;/p&gt;
&lt;p&gt;é™¤äº†å®ƒæ— æ³•é€šè¿‡ç¼–è¯‘ï¼š&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info cargo run --quiet --release
error[E0507]: cannot move out of `this.a` which is behind a mutable reference
  --&amp;gt; src/tj.rs:65:16
   |
65 |         match (this.a, this.b) {
   |                ^^^^^^ move occurs because `this.a` has type `State&amp;lt;A, AR, E&amp;gt;`, which does not implement the `Copy` trait

error[E0507]: cannot move out of `this.b` which is behind a mutable reference
  --&amp;gt; src/tj.rs:65:24
   |
65 |         match (this.a, this.b) {
   |                        ^^^^^^ move occurs because `this.b` has type `State&amp;lt;B, BR, E&amp;gt;`, which does not implement the `Copy` trait

error: aborting due to 2 previous errors

For more information about this error, try `rustc --explain E0507`.
error: could not compile `waytoodeep`

To learn more, run the command again with --verbose.
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å› ä¸ºã€‚ã€‚ã€‚æˆ‘ä»¬åªæœ‰ &lt;code&gt;&amp;amp;mut Self&lt;/code&gt; è€Œä¸æ˜¯ &lt;code&gt;Self&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ²¡æœ‰è‡ªå·±çš„æ‰€æœ‰æƒï¼Œä»…ä»…æ˜¯å€Ÿç”¨æˆ‘ä»¬è‡ªå·±ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¸èƒ½å°†å°†æˆ‘ä»¬çš„æˆå‘˜è½¬ç§»ï¼ˆmoveï¼‰å‡ºå»ï¼Œå› ä¸ºæˆ‘ä»¬ä¸èƒ½é˜»æ­¢å…¶ä»–äººå†æ¬¡è½®è¯¢ &lt;code&gt;TryJoin&lt;/code&gt; ã€‚
æ‰€ä»¥è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦å´©æºƒï¼ˆpanicï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬åƒ &lt;code&gt;Option&amp;lt;T&amp;gt;&lt;/code&gt; é‚£æ ·æœ‰ä¸€ä¸ª &lt;code&gt;.take()&lt;/code&gt; æ–¹æ³•äº‹æƒ…å°±ä¼šå¤§å¤§ç®€åŒ–ã€‚
å®ƒè¿”å› Option æ‹¥æœ‰çš„ä»»ä½•å†…å®¹ï¼Œæˆ–è€… &lt;code&gt;None&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰ &lt;code&gt;None&lt;/code&gt; ã€‚æˆ‘ä»¬åªæœ‰ &lt;code&gt;State::Future&lt;/code&gt; å’Œ &lt;code&gt;State::OK&lt;/code&gt; ï¼Œæ²¡æœ‰â€œä¸­ç«‹â€ï¼ˆneutralï¼‰çŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;enum&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;F, T, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt;
    F: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;T, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
{
    Future(F),
    Ok(T),
    Gone,
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°† &lt;code&gt;this.a&lt;/code&gt; å’Œ &lt;code&gt;this.b&lt;/code&gt; æ›¿æ¢ä¸º &lt;code&gt;State::Gone&lt;/code&gt; ã€‚ã€‚ã€‚æˆ–è€…å®ƒçš„è¿”å›ç»“æœï¼ˆæˆ‘ä»¬æ‹¥æœ‰æ‰€æœ‰æƒï¼‰ã€‚
ç„¶åæˆ‘ä»¬å°±å¯ä»¥å°†å®ƒä»¬è½¬ç§»ï¼ˆmoveï¼‰å‡ºå»ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯åŒæ—¶ã€‚ã€‚ã€‚æˆ‘ä»¬éœ€è¦å†æ¬¡å¯¹å…¶è¿›è¡Œæ¨¡å¼åŒ¹é…ï¼ˆpattern matchï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å°±åƒï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; (&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;this.a, &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;this.b) {
    (State::Ok(_), State::Ok(_)) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; {
        &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; std::mem::replace(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; this.a, State::Gone) {
            State::Ok(t) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; t,
            _ &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; unreachable&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(),
        };
        &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; b &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; std::mem::replace(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; this.b, State::Gone) {
            State::Ok(t) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; t,
            _ &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; unreachable&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(),
        };
        Ok((a, b)).into()
    }
    _ &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; Poll::Pending,
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å®è¯è¯´ã€‚ã€‚ã€‚æˆ‘çœ‹è¿‡æ›´ç³Ÿçš„ä»£ç ã€‚å®ƒåªæ˜¯æ²¡é‚£ä¹ˆ&lt;a href=&#34;https://en.wikipedia.org/wiki/Don%27t%5Frepeat%5Fyourself&#34;&gt;DRY&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;éå¸¸å¥½çš„å®ç°ï¼&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info cargo run --quiet --release
Jul 25 23:52:24.097  INFO waytoodeep: Joining...
Jul 25 23:52:25.050  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=second
Jul 25 23:52:25.061  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=first
Jul 25 23:52:25.061  INFO waytoodeep: All done! res=(&amp;quot;first&amp;quot;, &amp;quot;second&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;çœ‹ï¼Œåªæœ‰ 11ms çš„é—´éš”ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ›´è¿›ä¸€æ­¥&#34;&gt;æ›´è¿›ä¸€æ­¥ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;è¿™æ®µä»£ç å†æ¬¡å›°æ‰°äº†æˆ‘ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;TryJoin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, B, AR, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt;
    A: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;AR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
    B: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
{
    a: &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, AR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;,
    b: &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;B, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;,
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;å› ä¸ºç°åœ¨ &lt;code&gt;a&lt;/code&gt; å’Œ &lt;code&gt;b&lt;/code&gt; æ˜¯ä¸‰æ€çš„ï¼ˆtri-stateï¼‰ï¼š &lt;code&gt;Future&lt;/code&gt; ã€ &lt;code&gt;Ok&lt;/code&gt; æˆ–è€… &lt;code&gt;Gone&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœ &lt;code&gt;a&lt;/code&gt; å’Œ &lt;code&gt;b&lt;/code&gt; éƒ½æ˜¯ &lt;code&gt;Gone&lt;/code&gt; å‘¢ï¼Ÿè¿™ä¸ªçŠ¶æ€ä¸åˆç†ï¼&lt;/p&gt;
&lt;p&gt;å¦‚æœå‘ç”Ÿäº†è¿™ä¸ªçŠ¶æ€ï¼Œæˆ‘ä»¬ç°åœ¨å°†ä¼šæ°¸è¿œè¿”å› &lt;code&gt;Poll::Pending&lt;/code&gt; &amp;ndash; è¿™ä¸å¤ªå¥½ &amp;ndash; ä¸€ä¸ªæ­»é”ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çœŸæ­£æƒ³è¦çš„æ˜¯ã€‚ã€‚ã€‚ä¸¤ä¸ªæšä¸¾ã€‚å®é™…ä¸Šæˆ‘ä»¬æƒ³è¦æ•´ä¸ª &lt;code&gt;TryJoin&lt;/code&gt; ç±»å‹æ˜¯ä¸€ä¸ª &lt;code&gt;enum&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;enum&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;TryJoin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, B, AR, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt;
    A: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;AR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
    B: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
{
    Polling {
        a: &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, AR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;,
        b: &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;B, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;,
    },
    Done,
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åƒè¿™æ ·åˆå§‹åŒ–ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;pub&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;try_join&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, B, AR, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;(a: &lt;span style=&#34;color:#a6e22e&#34;&gt;A&lt;/span&gt;, b: &lt;span style=&#34;color:#a6e22e&#34;&gt;B&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;impl&lt;/span&gt; Future&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(AR, BR), E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt;
    A: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;AR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
    B: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
{
    TryJoin::Polling {
        a: &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;::Future(a),
        b: &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;::Future(b),
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç„¶åï¼Œsurpriceï¼ &lt;code&gt;Poll&amp;lt;T&amp;gt;&lt;/code&gt; å®ç°äº† &lt;a href=&#34;https://doc.rust-lang.org/stable/std/ops/trait.Try.html&#34;&gt;Try&lt;/a&gt; traitã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code&gt;?&lt;/code&gt; ã€‚
æ‰€ä»¥æœ€ç»ˆæˆ‘ä»¬çš„ä»£ç å®é™…ä¸Šéå¸¸çŸ­å°ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;impl&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, B, AR, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; Future &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; TryJoin&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, B, AR, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt;
    A: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;AR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
    B: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
{
    &lt;span style=&#34;color:#66d9ef&#34;&gt;type&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Output&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(AR, BR), E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;poll&lt;/span&gt;(self: &lt;span style=&#34;color:#a6e22e&#34;&gt;Pin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; Self&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;, cx: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;mut&lt;/span&gt; Context&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;_&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Poll&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Self::Output&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
        &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; this &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;unsafe&lt;/span&gt; { self.get_unchecked_mut() };
        &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; (a, b) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; this {
            Self::Polling { a, b } &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; (a, b),
            Self::Done &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; panic&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;TryJoin future polled after completion&amp;#34;&lt;/span&gt;),
        };

        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; State::Future(fut) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; a {
            &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; Poll::Ready(res) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;unsafe&lt;/span&gt; { Pin::new_unchecked(fut) }.poll(cx) {
                &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; State::Ok(res&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;);
            }
        }

        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; State::Future(fut) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; b {
            &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; Poll::Ready(res) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;unsafe&lt;/span&gt; { Pin::new_unchecked(fut) }.poll(cx) {
                &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;b &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; State::Ok(res&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;);
            }
        }

        &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; (a, b) {
            (State::Ok(_), State::Ok(_)) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; std::mem::replace(this, Self::Done) {
                Self::Polling {
                    a: &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;::Ok(a),
                    b: &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;::Ok(b),
                } &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; Ok((a, b)).into(),
                _ &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; unreachable&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(),
            },
            _ &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; Poll::Pending,
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç°åœ¨ï¼Œæˆ‘çŸ¥é“ä½ åœ¨æƒ³ä»€ä¹ˆã€‚ &lt;code&gt;Pin&amp;lt;&amp;amp;mut T&amp;gt;&lt;/code&gt; ä¸æ˜¯æ°æ°ç”¨æ¥é¿å…åƒ &lt;code&gt;std::mem::swap&lt;/code&gt; å’Œ &lt;code&gt;std::mem::replace&lt;/code&gt; å—ï¼Ÿ
è¿™äº›æ‰€æœ‰çš„è½¬ç§»ï¼ˆmoveï¼‰éƒ½æ˜¯å›´ç»•ç€å†…å­˜ï¼è¿™æ˜¯è¢«ç¦æ­¢çš„ï¼æ˜¯çš„ï¼Œæˆ‘ä»¬æ‰¿è¯ºäº†ä¸å»è½¬ç§»ï¼ˆmoveï¼‰å®ƒã€‚
ä½†æ˜¯åœ¨è¿™ä¸ªæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªæ˜¯åœ¨å®Œæˆè½®è¯¢ä¸¤ä¸ª future å¯¹è±¡åè½¬ç§»äº† &lt;code&gt;self&lt;/code&gt; / &lt;code&gt;this&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬å°±å†ä¹Ÿæ²¡æœ‰ä½¿ç”¨è¿‡ä¸¤ä¸ª future å¯¹è±¡ï¼Œæ— è®ºå›ºå®šè¿˜æ˜¯éå›ºå®šã€‚åŒæ—¶æˆ‘ä»¬ä»æ¥ä¹Ÿæ²¡ä¿è¯è¿‡ç»“æœè‡ªèº«æ˜¯å¦å°†è¦è¢«å›ºå®šï¼ˆpinnedï¼‰ï¼&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åªéœ€è¦å†³å®šæŸäº›ä¸œè¥¿æ˜¯â€œæ°¸è¿œå›ºå®šâ€è¿˜æ˜¯â€œæ°¸ä¸å›ºå®šâ€ï¼Œç„¶åæˆ‘ä»¬å¯èƒ½ä¼šç¼–å†™ç»“æœæ­£ç¡®çš„ä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬çš„åœºæ™¯ä¸‹ï¼Œåªæœ‰ &lt;code&gt;TryJoin::Polling(State::Future(_))&lt;/code&gt; å°±æ˜¯â€œæ°¸è¿œå›ºå®šâ€ çš„ï¼Œå…¶ä»–éƒ½ä¸æ˜¯ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œæˆ‘ä»¬å¿«é€Ÿçš„ä» &lt;code&gt;Pin&amp;lt;&amp;amp;mut Self&amp;gt;&lt;/code&gt; åˆ‡æ¢åˆ° &lt;code&gt;&amp;amp;mut Self&lt;/code&gt; ï¼Œç„¶ååˆå›åˆ° &lt;code&gt;Pin&amp;lt;&amp;amp;mut A&amp;gt;&lt;/code&gt; ï¼Œ
ä½†åªè¦æˆ‘ä»¬ä¸è¦åœ¨ä¸­é—´ç§»åŠ¨å°±æ²¡æœ‰é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬åœ¨æŒæœ‰ future å¯¹è±¡çš„æƒ…å†µä¸‹ä½¿ç”¨ &lt;code&gt;std::mem:replace&lt;/code&gt; æˆ– &lt;code&gt;std::mem::swap&lt;/code&gt; å°±ä¼šä¸å¦™ã€‚
æ‰€ä»¥ï¼Œæˆ‘ä»¬è¿˜å¥½ï¼Œæˆ‘æƒ³ï¼Œæˆ‘ä¸å¤ªç¡®å®šã€‚å¦‚æœä¸æ˜¯ï¼Œæœ‰äººåº”è¯¥ä¼šç•™è¨€ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å°±è¿™æ ·&#34;&gt;å°±è¿™æ ·&lt;/h3&gt;
&lt;p&gt;è®©æˆ‘ä»¬å›é¡¾æˆ‘ä»¬çš„å·¥ä½œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// in `src/tj.rs`
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; std::{
    future::Future,
    pin::Pin,
    task::{Context, Poll},
};

&lt;span style=&#34;color:#66d9ef&#34;&gt;pub&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;try_join&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, B, AR, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;(a: &lt;span style=&#34;color:#a6e22e&#34;&gt;A&lt;/span&gt;, b: &lt;span style=&#34;color:#a6e22e&#34;&gt;B&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;impl&lt;/span&gt; Future&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(AR, BR), E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt;
    A: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;AR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
    B: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
{
    TryJoin::Polling {
        a: &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;::Future(a),
        b: &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;::Future(b),
    }
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;enum&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;F, T, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt;
    F: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;T, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
{
    Future(F),
    Ok(T),
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;enum&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;TryJoin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, B, AR, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt;
    A: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;AR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
    B: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
{
    Polling {
        a: &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, AR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;,
        b: &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;B, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;,
    },
    Done,
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;impl&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, B, AR, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; Future &lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; TryJoin&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;A, B, AR, BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;where&lt;/span&gt;
    A: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;AR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
    B: &lt;span style=&#34;color:#a6e22e&#34;&gt;Future&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Output &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;BR, E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&amp;gt;&lt;/span&gt;,
{
    &lt;span style=&#34;color:#66d9ef&#34;&gt;type&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Output&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(AR, BR), E&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;poll&lt;/span&gt;(self: &lt;span style=&#34;color:#a6e22e&#34;&gt;Pin&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; Self&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;, cx: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;mut&lt;/span&gt; Context&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;_&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Poll&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;Self::Output&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
        &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; this &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;unsafe&lt;/span&gt; { self.get_unchecked_mut() };
        &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; (a, b) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; this {
            Self::Polling { a, b } &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; (a, b),
            Self::Done &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; panic&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;TryJoin future polled after completion&amp;#34;&lt;/span&gt;),
        };

        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; State::Future(fut) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; a {
            &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; Poll::Ready(res) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;unsafe&lt;/span&gt; { Pin::new_unchecked(fut) }.poll(cx) {
                &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; State::Ok(res&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;);
            }
        }

        &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; State::Future(fut) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; b {
            &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; Poll::Ready(res) &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;unsafe&lt;/span&gt; { Pin::new_unchecked(fut) }.poll(cx) {
                &lt;span style=&#34;color:#f92672&#34;&gt;*&lt;/span&gt;b &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; State::Ok(res&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;);
            }
        }

        &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; (a, b) {
            (State::Ok(_), State::Ok(_)) &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;match&lt;/span&gt; std::mem::replace(this, Self::Done) {
                Self::Polling {
                    a: &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;::Ok(a),
                    b: &lt;span style=&#34;color:#a6e22e&#34;&gt;State&lt;/span&gt;::Ok(b),
                } &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; Ok((a, b)).into(),
                _ &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; unreachable&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(),
            },
            _ &lt;span style=&#34;color:#f92672&#34;&gt;=&amp;gt;&lt;/span&gt; Poll::Pending,
        }
    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿˜æœ‰æˆ‘ä»¬å°å°çš„ HTTPS å®¢æˆ·ç«¯ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#75715e&#34;&gt;// in `src/main.rs`
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; color_eyre::Report;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; std::{net::SocketAddr, sync::Arc};
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; tokio::{
    io::{AsyncReadExt, AsyncWriteExt},
    net::TcpStream,
};
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; tokio_rustls::{rustls::ClientConfig, TlsConnector};
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; tracing::info;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; tracing_subscriber::EnvFilter;
&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; webpki::DNSNameRef;

&lt;span style=&#34;color:#66d9ef&#34;&gt;mod&lt;/span&gt; tj;

&lt;span style=&#34;color:#75715e&#34;&gt;#[tokio::main(flavor = &lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;current_thread&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    setup()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Joining...&amp;#34;&lt;/span&gt;);
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; res &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; tj::try_join(fetch_thing(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;first&amp;#34;&lt;/span&gt;), fetch_thing(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;second&amp;#34;&lt;/span&gt;)).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;res, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;All done!&amp;#34;&lt;/span&gt;);

    Ok(())
}

&lt;span style=&#34;color:#75715e&#34;&gt;#[allow(dead_code)]&lt;/span&gt;
&lt;span style=&#34;color:#66d9ef&#34;&gt;async&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;fetch_thing&lt;/span&gt;(name: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;str&lt;/span&gt;) -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;str&lt;/span&gt;, Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    &lt;span style=&#34;color:#75715e&#34;&gt;// look out it&amp;#39;s port 443 now
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; addr: &lt;span style=&#34;color:#a6e22e&#34;&gt;SocketAddr&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ([&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;, &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;], &lt;span style=&#34;color:#ae81ff&#34;&gt;443&lt;/span&gt;).into();
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; socket &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; TcpStream::connect(addr).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#75715e&#34;&gt;// establish a TLS session...
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; connector: &lt;span style=&#34;color:#a6e22e&#34;&gt;TlsConnector&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; {
        &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; config &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ClientConfig::new();
        config
            .root_store
            .add_server_trust_anchors(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;webpki_roots::TLS_SERVER_ROOTS);
        Arc::new(config).into()
    };
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; dnsname &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; DNSNameRef::try_from_ascii_str(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;one.one.one.one&amp;#34;&lt;/span&gt;)&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; socket &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; connector.connect(dnsname, socket).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#75715e&#34;&gt;// we&amp;#39;re writing straight to the socket, there&amp;#39;s no buffering
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;// so no need to flush
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    socket.write_all(&lt;span style=&#34;color:#e6db74&#34;&gt;b&amp;#34;GET / HTTP/1.1&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\r\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    socket.write_all(&lt;span style=&#34;color:#e6db74&#34;&gt;b&amp;#34;Host: one.one.one.one&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\r\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    socket.write_all(&lt;span style=&#34;color:#e6db74&#34;&gt;b&amp;#34;User-Agent: cool-bear&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\r\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    socket.write_all(&lt;span style=&#34;color:#e6db74&#34;&gt;b&amp;#34;Connection: close&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\r\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;
    socket.write_all(&lt;span style=&#34;color:#e6db74&#34;&gt;b&amp;#34;&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;\r\n&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;&lt;/span&gt;).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; response &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; String::with_capacity(&lt;span style=&#34;color:#ae81ff&#34;&gt;256&lt;/span&gt;);
    socket.read_to_string(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; response).&lt;span style=&#34;color:#66d9ef&#34;&gt;await&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; status &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; response.lines().next().unwrap_or_default();
    info&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#f92672&#34;&gt;%&lt;/span&gt;status, , &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Got response!&amp;#34;&lt;/span&gt;);

    &lt;span style=&#34;color:#75715e&#34;&gt;// dropping the socket will close the connection
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;
    Ok(name)
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;setup&lt;/span&gt;() -&amp;gt; Result&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;(), Report&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; std::env::var(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;RUST_LIB_BACKTRACE&amp;#34;&lt;/span&gt;).is_err() {
        std::env::set_var(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;RUST_LIB_BACKTRACE&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;1&amp;#34;&lt;/span&gt;)
    }
    color_eyre::install()&lt;span style=&#34;color:#f92672&#34;&gt;?&lt;/span&gt;;

    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; std::env::var(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;RUST_LOG&amp;#34;&lt;/span&gt;).is_err() {
        std::env::set_var(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;RUST_LOG&amp;#34;&lt;/span&gt;, &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;info&amp;#34;&lt;/span&gt;)
    }
    tracing_subscriber::fmt::fmt()
        .with_env_filter(EnvFilter::from_default_env())
        .init();

    Ok(())
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;And it works.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;$ RUST_LOG=info cargo run --quiet --release
Jul 26 00:08:13.399  INFO waytoodeep: Joining...
Jul 26 00:08:13.707  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=first
Jul 26 00:08:13.709  INFO waytoodeep: Got response! status=HTTP/1.1 200 OK name=second
Jul 26 00:08:13.710  INFO waytoodeep: All done! res=(&amp;quot;first&amp;quot;, &amp;quot;second&amp;quot;)
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;2ms é—´éš”ï¼è¿™æ˜¯ä¸€ä¸ªæ–°çš„è®°å½•ã€‚&lt;/p&gt;
</content>
    </item>
    
    <item>
      <title>Surgical Reading: How to Read 12 Books at Once</title>
      <link>https://www.linuxzen.com/notes/articles/20200628134657-surgical_reading_how_to_read_12_books_at_once/</link>
      <pubDate>Sun, 28 Jun 2020 13:46:00 +0800</pubDate>
      
      <guid>https://www.linuxzen.com/notes/articles/20200628134657-surgical_reading_how_to_read_12_books_at_once/</guid>
      <description>åŸæ–‡é“¾æ¥ï¼šhttps://superorganizers.substack.com/p/surgical-reading-how-to-read-12-books
æ‰‹æœ¯é˜…è¯»æ³•ï¼šå¦‚ä½•åŒæ—¶é˜…è¯» 12 æœ¬ä¹¦  è¯‘è€…æ³¨ï¼šè¿™ç¯‡æ–‡ç« è®©æˆ‘æƒ³èµ·äº†ã€Šå¦‚ä½•é˜…è¯»ä¸€æœ¬ä¹¦ã€‹è¿™æœ¬ä¹¦ï¼Œæ–‡ç« ä¸­çš„å¤§éƒ¨åˆ†æŠ€å·§éƒ½èƒ½åœ¨è¿™æœ¬ä¹¦ä¸­æ‰¾å‡ºæ¥ï¼Œé˜…è¯»æ˜¯ä¸€é—¨éœ€è¦å­¦ä¹ çš„æŠ€èƒ½ã€‚
 å½“æœ‰äººé—®æˆ‘å¦‚ä½•é˜…è¯»æ—¶æˆ‘æ€»æ˜¯ä¼šæœ‰ç‚¹å°´å°¬ï¼Œå› ä¸ºæˆ‘ä¸€èˆ¬éƒ½æ˜¯åŒæ—¶é˜…è¯»åå‡ æœ¬ä¹¦ã€‚
ä½†æ˜¯æˆ‘è¿™æ ·é˜…è¯»å¹¶ä¸æ˜¯ä¸ºäº†ç‚«è€€ &amp;ndash; æˆ‘è¿™ä¹ˆåšæ˜¯å› ä¸ºæˆ‘è§‰å¾—è¿™ç§é˜…è¯»æ–¹å¼æ›´å¥½ï¼Œæœ€èµ·ç å¯¹æˆ‘æ¥è¯´ã€‚
è¿™æ˜¯ä¸€ä¸ªæˆ‘å¼€å‘ä¸€ä¸ªå«åš æ‰‹æœ¯é˜…è¯»æ³•ï¼ˆsurgical readingï¼‰ çš„è¿‡ç¨‹ï¼Œå®ƒæ„å‘³ç€å½“æˆ‘è¯»ä¸€æœ¬éå°è¯´çš„ä¹¦ç±æ—¶ï¼Œæˆ‘ä¼šä¸“æ³¨äºå°½å¯èƒ½å¿«çš„ä»ä¹¦ä¸­æ‰¾åˆ°æœ€æœ‰ä»·å€¼çš„éƒ¨åˆ†å¹¶å°†ä¹‹å‰”é™¤ã€‚ è¿™æ ·å…è®¸æˆ‘åœ¨ä¸€ä¸ªä¸»é¢˜ä¸ŠåŒæ—¶é˜…è¯»è®¸å¤šä¸åŒçš„ä¹¦ç±ï¼Œå¹¶ä»å¤šä¸ªè§’åº¦æ¥è§‚å¯Ÿè¿™ä¸€ä¸»é¢˜ã€‚æˆ‘çš„ç›®æ ‡æ˜¯å¿«é€Ÿåœ°æ‰¾åˆ°æœ‰ä»·å€¼çš„çŸ¥è¯†ï¼Œå¹¶ä½¿ç”¨ç°å®ä¸­è·å¾—çš„ä¿¡æ¯å»è§£å†³é—®é¢˜ã€‚
è¿™ç§æ–¹æ³•æœ‰å¾ˆå¤šéšè—çš„å¥½å¤„ã€‚é¦–å…ˆï¼Œæˆ‘å¯ä»¥å¿«é€Ÿäº†è§£è‡ªå·±å¯¹ä¸€æœ¬ä¹¦æ˜¯å¦æœ‰å…´è¶£ï¼Œå¹¶å› æ­¤å»èŠ±æ›´å¤šçš„æ—¶é—´è¯»æˆ‘çœŸæ­£æ„Ÿå…´è¶£ä¹¦ç±ã€‚å½“æˆ‘å¯¹ä¸€æœ¬ä¹¦ä¸æ„Ÿå…´è¶£æ—¶æˆ‘å°±å¯ä»¥å°†å…¶æ”¾ä¸‹å¹¶è½¬åˆ°å…¶ä»–äº‹æƒ…ä¸Šï¼Œå› ä¸ºæˆ‘çŸ¥é“æˆ‘å°†å®ƒæ”¾å›å»æ˜¯æœ‰åŸå› çš„ã€‚ é˜…è¯»ä¸åº”è¯¥æ˜¯å°†ä¹¦ç±åœ¨ ToDo äº‹é¡¹å®Œæˆï¼Œè€Œæ˜¯åº”è¯¥è§£é‡Šä»€ä¹ˆå¸å¼•äº†ä½ ã€‚
å…¶æ¬¡ï¼Œæˆ‘å¯ä»¥ä»å¤šä¸ªè§’åº¦è§‚å¯Ÿä¸€ä¸ªä¸»é¢˜ï¼Œå¹¶çœŸæ­£ç†è§£é—®é¢˜ã€‚æˆ‘å¯ä»¥çœ‹åˆ°æœ‰å¤šå°‘ä¸åŒçš„äººè®¨è®ºåŒä¸€ä¸ªæ—¶é—´å’Œæƒ³æ³•ï¼Œè€Œä¸æ˜¯ä¾é ä¸€ä½ä½œè€…çš„é™ˆè¿°ã€‚ è¿™ä½¿æˆ‘å¯¹å½“å‰æ„Ÿå…´è¶£çš„çš„ä»»ä½•ä¸»é¢˜éƒ½æœ‰æ›´ç»†å¾®çš„äº†è§£ã€‚
æœ€åï¼Œå®ƒå°†ä¹¦ç±è½¬å˜ä¸ºæ›´ä¸»åŠ¨å’Œæ›´ç§¯æçš„äº‹ç‰©ã€‚æˆ‘çš„ä¹¦æ¶ï¼ˆlibraryï¼‰å·²ç»ä¸å†æ˜¯æ­»æ¿çš„å­˜å‚¨ç©ºé—´ï¼Œè€Œæ˜¯ä¸€ä¸ªä¸æˆ‘ä¸æ–­äº’åŠ¨çš„é²œæ´»çš„äº‹ç‰©ã€‚
å½“ç„¶ï¼Œå½“æˆ‘æ‰¾åˆ°ä¸€æœ¬æˆ‘çœŸæ­£å–œæ¬¢çš„ä¹¦ï¼ˆç°åœ¨ä¹Ÿè¶Šæ¥è¶Šé¢‘ç¹ï¼‰ï¼Œæˆ‘ä¹Ÿå¯ä»¥å……åˆ†çš„åˆ©ç”¨å®ƒã€‚
æˆ‘æ˜¯è°ï¼ˆWho I Amï¼‰ æˆ‘çš„åå­—æ˜¯ Brian Tobalï¼Œæˆ‘è€—è´¹äº†æˆ‘çš„å¤§éƒ¨åˆ†æ—¶é—´æ¥æ€è€ƒå¦‚ä½•å­¦ä¹ ã€‚åœ¨è¿‡å» 15 å¹´ï¼Œæˆ‘åœ¨æ•™è‚²ç•Œè·å¾—äº†å¾ˆå¤šå¤´è¡”ï¼ˆhatsï¼‰ã€‚ æˆ‘æ›¾æ˜¯ä¸€åå°å­¦ç§‘å­¦è€å¸ˆã€ä¸€å®¶æ•™è‚²å…¬å¸çš„ç ”ç©¶å‘˜ã€å…­å®¶æ•™è‚²ç§‘æŠ€åˆåˆ›å…¬å¸çš„äº§å“è´Ÿè´£äººï¼Œæœ¬äººä¹Ÿæ˜¯ä¸€äº›åˆåˆ›å…¬å¸çš„åˆ›å§‹äººï¼Œ åŒ…æ‹¬æˆ‘äº 2018 å¹´å‡ºå”®çš„ä¸€å®¶åä¸º Hickory çš„å…¬å¸ã€‚
æˆ‘å–œæ¬¢åˆåˆ›å…¬å¸ã€‚ä»å­¦ä¹ è§’åº¦æ¥çœ‹ï¼Œå®ƒä»¬ä½¿ä½ å¯ä»¥å®Œå…¨æ²‰æµ¸äºæ–°çš„é¢†åŸŸï¼Œå¹¶æ ¹æ®å…¶æ€§è´¨è¿«ä½¿ä½ è§£å†³å®é™…é—®é¢˜ã€‚ è¿™ä¸ºæˆ‘è‡ªå·±çš„å­¦ä¹ æ–¹æ³•å’Œé˜…è¯»æ–¹æ³•æä¾›äº†åŠ¨åŠ›ã€‚æˆ‘ä¸æ˜¯ä¸ºäº†ä»…ä»…ç§¯ç´¯çŸ¥è¯†æ¥å»ºç«‹çŸ¥è¯†åº“ï¼Œé€šå¸¸æˆ‘å»ºç«‹å®ƒæ˜¯ä¸ºäº†å°½å¿«ä½¿ç”¨å®ƒã€‚
æ‰‹æœ¯é˜…è¯»æ³•å°±æ˜¯è®¾è®¡ç”¨æ¥å¸®åŠ©æˆ‘è¿™ä¹ˆåšçš„ã€‚
æ‰€ä»¥ä½ å‡†å¤‡å¥½è¯•ä¸€è¯•äº†å—ï¼Ÿè¯·ä»ä¹¦æ¶ä¸Šæ‹¿å‡ºä¸€äº›å·²ç»æç½®äº†ä¸€æ®µæ—¶é—´çš„ä¹¦ï¼Œå¸Œæœ›æ‚¨è¿˜æ²¡æœ‰è¯»è¿‡ã€‚è·Ÿç€æˆ‘ï¼Œäº²çœ¼çœ‹çœ‹æ‰‹æœ¯é˜…è¯»æ³•çš„æ„Ÿè§‰ã€‚
è®©æˆ‘ä»¬å¼€å§‹å§ï¼
æŠŠä¹¦å½“ä½œå…¶è‡ªèº«çš„åœ°å›¾ï¼ˆUse the Book Itself as a Mapï¼‰ ä»¥ä¸‹æ˜¯ä¸€ä»½æˆ‘å¦‚ä½•é˜…è¯»ä¸€æœ¬ä¹¦çš„æ­¥éª¤åˆ†è§£ï¼š
 äº†è§£ä¸€æœ¬ä¹¦ é€šè¿‡å°é¢è¯„åˆ¤è¿™æœ¬ä¹¦ ç´¢å¼•ï¼ˆindexï¼‰åŒ…å«äº†ä¸€åˆ‡ æŠŠç›®å½•ï¼ˆTOCï¼‰å½“ä½œéª¨æ¶ é€šè¿‡å‰è¨€ï¼ˆprefaceï¼‰è¿›è¡Œé¢„è§ˆ  æ­¤è¿‡ç¨‹çš„é‡ç‚¹æ˜¯è·å¾—åœ¨å¤§çº¦ 15 åˆ†é’Ÿå†…å¯¹ä»»ä½•ä¹¦ç±è¿›è¡Œâ€œåœ°å›¾ç»˜åˆ¶â€çš„èƒ½åŠ›ã€‚ä½ å¸Œæœ›å¯¹æœ‰ä»·å€¼çš„çŸ¥è¯†ä½äºä½•å¤„ã€ä»€ä¹ˆåœ°æ–¹æ‰“åŠ¨ä½ ä»¥åŠè¦èŠ±è´¹å¤šå°‘æ—¶é—´æ¥é˜…è¯»å®ƒæœ‰åŸºæœ¬çš„äº†è§£ã€‚
ä¸‹é¢ï¼Œæˆ‘ä»¬å°†é€æ­¥å®Œæˆä»ä¸€æœ¬ä¹¦ä¸­æå–è¦ç‚¹ï¼ˆæˆ–è€…è¯´çŸ¥è¯†å—ï¼‰çš„è¿‡ç¨‹ï¼Œå¦‚ä½•å¢åŠ é˜…è¯»ä¸€æœ¬ä¹¦çš„ä»·å€¼ï¼Œä»¥åŠå¦‚ä½•ç»“åˆæ‰€æœ‰å†…å®¹ä»¥ä¾¿æ‚¨å¯ä»¥è½»æ¾çš„ä¸€æ¬¡æå–å¤šæœ¬ä¹¦ã€‚
äº†è§£ä¸€æœ¬ä¹¦ï¼ˆApproaching a Book ï¼‰ å½“æˆ‘å¼€å§‹é˜…è¯»ä¸€æœ¬éå°è¯´çš„ä¹¦ç±ä¹‹å‰ï¼Œæˆ‘ä¼šè¯è´¹ 5-10 åˆ†é’Ÿçš„æ—¶é—´å°è¯•å»äº†è§£ä»–å¯¹æˆ‘å…·æœ‰ä»€ä¹ˆä»·å€¼ä»¥åŠå®ƒçš„ç»“æ„ã€‚å½“æˆ‘ä»¬å†³å®šè¦é˜…è¯»æ­¤ä¹¦æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡å¾ˆå¤šæ–¹å¼åšåˆ°è¿™ä¸€ç‚¹ã€‚ ä¹Ÿè®¸é€šè¿‡äºšé©¬é€Šé˜…è¯»ä¸€äº›è¯„è®ºå’Œåé¦ˆæˆ–è€…éšæœºæµè§ˆå…¶ä¸­ä¸€éƒ¨åˆ†ã€‚æˆ‘æ›´å–œæ¬¢ä½¿ç”¨è¿™æœ¬ä¹¦æœ¬èº«ã€‚</description>
      <content>&lt;p&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href=&#34;https://superorganizers.substack.com/p/surgical-reading-how-to-read-12-books&#34;&gt;https://superorganizers.substack.com/p/surgical-reading-how-to-read-12-books&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&#34;æ‰‹æœ¯é˜…è¯»æ³•-å¦‚ä½•åŒæ—¶é˜…è¯»-12-æœ¬ä¹¦&#34;&gt;æ‰‹æœ¯é˜…è¯»æ³•ï¼šå¦‚ä½•åŒæ—¶é˜…è¯» 12 æœ¬ä¹¦&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šè¿™ç¯‡æ–‡ç« è®©æˆ‘æƒ³èµ·äº†ã€Šå¦‚ä½•é˜…è¯»ä¸€æœ¬ä¹¦ã€‹è¿™æœ¬ä¹¦ï¼Œæ–‡ç« ä¸­çš„å¤§éƒ¨åˆ†æŠ€å·§éƒ½èƒ½åœ¨è¿™æœ¬ä¹¦ä¸­æ‰¾å‡ºæ¥ï¼Œé˜…è¯»æ˜¯ä¸€é—¨éœ€è¦å­¦ä¹ çš„æŠ€èƒ½ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å½“æœ‰äººé—®æˆ‘å¦‚ä½•é˜…è¯»æ—¶æˆ‘æ€»æ˜¯ä¼šæœ‰ç‚¹å°´å°¬ï¼Œå› ä¸ºæˆ‘ä¸€èˆ¬éƒ½æ˜¯åŒæ—¶é˜…è¯»åå‡ æœ¬ä¹¦ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯æˆ‘è¿™æ ·é˜…è¯»å¹¶ä¸æ˜¯ä¸ºäº†ç‚«è€€ &amp;ndash; æˆ‘è¿™ä¹ˆåšæ˜¯å› ä¸ºæˆ‘è§‰å¾—è¿™ç§é˜…è¯»æ–¹å¼æ›´å¥½ï¼Œæœ€èµ·ç å¯¹æˆ‘æ¥è¯´ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªæˆ‘å¼€å‘ä¸€ä¸ªå«åš &lt;strong&gt;&lt;strong&gt;æ‰‹æœ¯é˜…è¯»æ³•ï¼ˆsurgical readingï¼‰&lt;/strong&gt;&lt;/strong&gt; çš„è¿‡ç¨‹ï¼Œå®ƒæ„å‘³ç€å½“æˆ‘è¯»ä¸€æœ¬éå°è¯´çš„ä¹¦ç±æ—¶ï¼Œæˆ‘ä¼šä¸“æ³¨äºå°½å¯èƒ½å¿«çš„ä»ä¹¦ä¸­æ‰¾åˆ°æœ€æœ‰ä»·å€¼çš„éƒ¨åˆ†å¹¶å°†ä¹‹å‰”é™¤ã€‚
è¿™æ ·å…è®¸æˆ‘åœ¨ä¸€ä¸ªä¸»é¢˜ä¸ŠåŒæ—¶é˜…è¯»è®¸å¤šä¸åŒçš„ä¹¦ç±ï¼Œå¹¶ä»å¤šä¸ªè§’åº¦æ¥è§‚å¯Ÿè¿™ä¸€ä¸»é¢˜ã€‚æˆ‘çš„ç›®æ ‡æ˜¯å¿«é€Ÿåœ°æ‰¾åˆ°æœ‰ä»·å€¼çš„çŸ¥è¯†ï¼Œå¹¶ä½¿ç”¨ç°å®ä¸­è·å¾—çš„ä¿¡æ¯å»è§£å†³é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ç§æ–¹æ³•æœ‰å¾ˆå¤šéšè—çš„å¥½å¤„ã€‚é¦–å…ˆï¼Œæˆ‘å¯ä»¥å¿«é€Ÿäº†è§£è‡ªå·±å¯¹ä¸€æœ¬ä¹¦æ˜¯å¦æœ‰å…´è¶£ï¼Œå¹¶å› æ­¤å»èŠ±æ›´å¤šçš„æ—¶é—´è¯»æˆ‘çœŸæ­£æ„Ÿå…´è¶£ä¹¦ç±ã€‚å½“æˆ‘å¯¹ä¸€æœ¬ä¹¦ä¸æ„Ÿå…´è¶£æ—¶æˆ‘å°±å¯ä»¥å°†å…¶æ”¾ä¸‹å¹¶è½¬åˆ°å…¶ä»–äº‹æƒ…ä¸Šï¼Œå› ä¸ºæˆ‘çŸ¥é“æˆ‘å°†å®ƒæ”¾å›å»æ˜¯æœ‰åŸå› çš„ã€‚
é˜…è¯»ä¸åº”è¯¥æ˜¯å°†ä¹¦ç±åœ¨ ToDo äº‹é¡¹å®Œæˆï¼Œè€Œæ˜¯åº”è¯¥è§£é‡Šä»€ä¹ˆå¸å¼•äº†ä½ ã€‚&lt;/p&gt;
&lt;p&gt;å…¶æ¬¡ï¼Œæˆ‘å¯ä»¥ä»å¤šä¸ªè§’åº¦è§‚å¯Ÿä¸€ä¸ªä¸»é¢˜ï¼Œå¹¶çœŸæ­£ç†è§£é—®é¢˜ã€‚æˆ‘å¯ä»¥çœ‹åˆ°æœ‰å¤šå°‘ä¸åŒçš„äººè®¨è®ºåŒä¸€ä¸ªæ—¶é—´å’Œæƒ³æ³•ï¼Œè€Œä¸æ˜¯ä¾é ä¸€ä½ä½œè€…çš„é™ˆè¿°ã€‚
è¿™ä½¿æˆ‘å¯¹å½“å‰æ„Ÿå…´è¶£çš„çš„ä»»ä½•ä¸»é¢˜éƒ½æœ‰æ›´ç»†å¾®çš„äº†è§£ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œå®ƒå°†ä¹¦ç±è½¬å˜ä¸ºæ›´ä¸»åŠ¨å’Œæ›´ç§¯æçš„äº‹ç‰©ã€‚æˆ‘çš„ä¹¦æ¶ï¼ˆlibraryï¼‰å·²ç»ä¸å†æ˜¯æ­»æ¿çš„å­˜å‚¨ç©ºé—´ï¼Œè€Œæ˜¯ä¸€ä¸ªä¸æˆ‘ä¸æ–­äº’åŠ¨çš„é²œæ´»çš„äº‹ç‰©ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œå½“æˆ‘æ‰¾åˆ°ä¸€æœ¬æˆ‘çœŸæ­£å–œæ¬¢çš„ä¹¦ï¼ˆç°åœ¨ä¹Ÿè¶Šæ¥è¶Šé¢‘ç¹ï¼‰ï¼Œæˆ‘ä¹Ÿå¯ä»¥å……åˆ†çš„åˆ©ç”¨å®ƒã€‚&lt;/p&gt;
&lt;h3 id=&#34;æˆ‘æ˜¯è°-who-i-am&#34;&gt;æˆ‘æ˜¯è°ï¼ˆWho I Amï¼‰&lt;/h3&gt;
&lt;p&gt;æˆ‘çš„åå­—æ˜¯ Brian Tobalï¼Œæˆ‘è€—è´¹äº†æˆ‘çš„å¤§éƒ¨åˆ†æ—¶é—´æ¥æ€è€ƒå¦‚ä½•å­¦ä¹ ã€‚åœ¨è¿‡å» 15 å¹´ï¼Œæˆ‘åœ¨æ•™è‚²ç•Œè·å¾—äº†å¾ˆå¤šå¤´è¡”ï¼ˆhatsï¼‰ã€‚
æˆ‘æ›¾æ˜¯ä¸€åå°å­¦ç§‘å­¦è€å¸ˆã€ä¸€å®¶æ•™è‚²å…¬å¸çš„ç ”ç©¶å‘˜ã€å…­å®¶æ•™è‚²ç§‘æŠ€åˆåˆ›å…¬å¸çš„äº§å“è´Ÿè´£äººï¼Œæœ¬äººä¹Ÿæ˜¯ä¸€äº›åˆåˆ›å…¬å¸çš„åˆ›å§‹äººï¼Œ
åŒ…æ‹¬æˆ‘äº 2018 å¹´å‡ºå”®çš„ä¸€å®¶åä¸º Hickory çš„å…¬å¸ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å–œæ¬¢åˆåˆ›å…¬å¸ã€‚ä»å­¦ä¹ è§’åº¦æ¥çœ‹ï¼Œå®ƒä»¬ä½¿ä½ å¯ä»¥å®Œå…¨æ²‰æµ¸äºæ–°çš„é¢†åŸŸï¼Œå¹¶æ ¹æ®å…¶æ€§è´¨è¿«ä½¿ä½ è§£å†³å®é™…é—®é¢˜ã€‚
è¿™ä¸ºæˆ‘è‡ªå·±çš„å­¦ä¹ æ–¹æ³•å’Œé˜…è¯»æ–¹æ³•æä¾›äº†åŠ¨åŠ›ã€‚æˆ‘ä¸æ˜¯ä¸ºäº†ä»…ä»…ç§¯ç´¯çŸ¥è¯†æ¥å»ºç«‹çŸ¥è¯†åº“ï¼Œé€šå¸¸æˆ‘å»ºç«‹å®ƒæ˜¯ä¸ºäº†å°½å¿«ä½¿ç”¨å®ƒã€‚&lt;/p&gt;
&lt;p&gt;æ‰‹æœ¯é˜…è¯»æ³•å°±æ˜¯è®¾è®¡ç”¨æ¥å¸®åŠ©æˆ‘è¿™ä¹ˆåšçš„ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ä½ å‡†å¤‡å¥½è¯•ä¸€è¯•äº†å—ï¼Ÿè¯·ä»ä¹¦æ¶ä¸Šæ‹¿å‡ºä¸€äº›å·²ç»æç½®äº†ä¸€æ®µæ—¶é—´çš„ä¹¦ï¼Œå¸Œæœ›æ‚¨è¿˜æ²¡æœ‰è¯»è¿‡ã€‚è·Ÿç€æˆ‘ï¼Œäº²çœ¼çœ‹çœ‹æ‰‹æœ¯é˜…è¯»æ³•çš„æ„Ÿè§‰ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬å¼€å§‹å§ï¼&lt;/p&gt;
&lt;h3 id=&#34;æŠŠä¹¦å½“ä½œå…¶è‡ªèº«çš„åœ°å›¾-use-the-book-itself-as-a-map&#34;&gt;æŠŠä¹¦å½“ä½œå…¶è‡ªèº«çš„åœ°å›¾ï¼ˆUse the Book Itself as a Mapï¼‰&lt;/h3&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ä¸€ä»½æˆ‘å¦‚ä½•é˜…è¯»ä¸€æœ¬ä¹¦çš„æ­¥éª¤åˆ†è§£ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;äº†è§£ä¸€æœ¬ä¹¦&lt;/li&gt;
&lt;li&gt;é€šè¿‡å°é¢è¯„åˆ¤è¿™æœ¬ä¹¦&lt;/li&gt;
&lt;li&gt;ç´¢å¼•ï¼ˆindexï¼‰åŒ…å«äº†ä¸€åˆ‡&lt;/li&gt;
&lt;li&gt;æŠŠç›®å½•ï¼ˆTOCï¼‰å½“ä½œéª¨æ¶&lt;/li&gt;
&lt;li&gt;é€šè¿‡å‰è¨€ï¼ˆprefaceï¼‰è¿›è¡Œé¢„è§ˆ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ­¤è¿‡ç¨‹çš„é‡ç‚¹æ˜¯è·å¾—åœ¨å¤§çº¦ 15 åˆ†é’Ÿå†…å¯¹ä»»ä½•ä¹¦ç±è¿›è¡Œâ€œåœ°å›¾ç»˜åˆ¶â€çš„èƒ½åŠ›ã€‚ä½ å¸Œæœ›å¯¹æœ‰ä»·å€¼çš„çŸ¥è¯†ä½äºä½•å¤„ã€ä»€ä¹ˆåœ°æ–¹æ‰“åŠ¨ä½ ä»¥åŠè¦èŠ±è´¹å¤šå°‘æ—¶é—´æ¥é˜…è¯»å®ƒæœ‰åŸºæœ¬çš„äº†è§£ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢ï¼Œæˆ‘ä»¬å°†é€æ­¥å®Œæˆä»ä¸€æœ¬ä¹¦ä¸­æå–è¦ç‚¹ï¼ˆæˆ–è€…è¯´çŸ¥è¯†å—ï¼‰çš„è¿‡ç¨‹ï¼Œå¦‚ä½•å¢åŠ é˜…è¯»ä¸€æœ¬ä¹¦çš„ä»·å€¼ï¼Œä»¥åŠå¦‚ä½•ç»“åˆæ‰€æœ‰å†…å®¹ä»¥ä¾¿æ‚¨å¯ä»¥è½»æ¾çš„ä¸€æ¬¡æå–å¤šæœ¬ä¹¦ã€‚&lt;/p&gt;
&lt;h4 id=&#34;äº†è§£ä¸€æœ¬ä¹¦-approaching-a-book&#34;&gt;äº†è§£ä¸€æœ¬ä¹¦ï¼ˆApproaching a Book ï¼‰&lt;/h4&gt;
&lt;p&gt;å½“æˆ‘å¼€å§‹é˜…è¯»ä¸€æœ¬éå°è¯´çš„ä¹¦ç±ä¹‹å‰ï¼Œæˆ‘ä¼šè¯è´¹ 5-10 åˆ†é’Ÿçš„æ—¶é—´å°è¯•å»äº†è§£ä»–å¯¹æˆ‘å…·æœ‰ä»€ä¹ˆä»·å€¼ä»¥åŠå®ƒçš„ç»“æ„ã€‚å½“æˆ‘ä»¬å†³å®šè¦é˜…è¯»æ­¤ä¹¦æ—¶æˆ‘ä»¬å¯ä»¥é€šè¿‡å¾ˆå¤šæ–¹å¼åšåˆ°è¿™ä¸€ç‚¹ã€‚
ä¹Ÿè®¸é€šè¿‡äºšé©¬é€Šé˜…è¯»ä¸€äº›è¯„è®ºå’Œåé¦ˆæˆ–è€…éšæœºæµè§ˆå…¶ä¸­ä¸€éƒ¨åˆ†ã€‚æˆ‘æ›´å–œæ¬¢ä½¿ç”¨è¿™æœ¬ä¹¦æœ¬èº«ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ ·ï¼Œæˆ‘é€šå¸¸å¯¹ä»å¤´åˆ°å°¾é˜…è¯»ä¸€æœ¬ä¹¦ç±ä¸æ„Ÿå…´è¶£ï¼Œæ‰€ä»¥æˆ‘éœ€è¦åˆ é™¤æˆ‘éœ€è¦çš„ä¿¡æ¯ï¼Œå½“ç„¶éœ€è¦å…ˆæ‰¾æ‰¾å®ƒã€‚æˆ‘æƒ³è¦çš„æ˜¯ä¸€æœ¬å…³äºæœ¬ä¹¦å†…å®¹çš„åœ°å›¾ï¼ˆæ— è®ºæ˜¯æ€ç»´ä¸Šçš„è¿˜æ˜¯ä¹¦é¢ä¸Šçš„ï¼‰ã€‚
ä½ å¯ä»¥ä½¿ç”¨å¤§è„‘è®°å¿†ã€è®°äº‹æœ¬ã€Google Doc æˆ–æŸäº›ç²¾ç¾çš„ç¬”è®°è®°å½•ç³»ç»Ÿä½œä¸ºè®°å½•æœºåˆ¶ &amp;ndash; æ ¹æ®ä½ è‡ªå·±çš„å–œå¥½å°±è¡Œã€‚&lt;/p&gt;
&lt;h4 id=&#34;é€šè¿‡ä¹¦ç±çš„å°é¢è¿›è¡Œå“è¯„-judge-a-book-by-its-cover&#34;&gt;é€šè¿‡ä¹¦ç±çš„å°é¢è¿›è¡Œå“è¯„ï¼ˆJudge a Book by its Coverï¼‰&lt;/h4&gt;
&lt;p&gt;é¦–å…ˆï¼Œç»™æ ‡é¢˜å’Œå‰¯æ ‡é¢˜ä¸€äº›æƒ³æ³•ã€‚ æˆ‘çŸ¥é“è¿™å¬èµ·æ¥å¾ˆå¹³å‡¡ï¼Œä½†æ˜¯ä½œè€…èŠ±äº†å¾ˆå¤šæ—¶é—´æ€è€ƒè¿™äº›é—®é¢˜ï¼Œé€šå¸¸å®ƒä»¬ä»£è¡¨ä¸€ç§è§‚ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ã€Šç¾å›½ç®€å²ã€‹å’Œã€Šç¾å›½äººå†å²ã€‹ï¼Œä½œè€…å¼ºè°ƒâ€œäººâ€è€Œä¸æ˜¯â€œç®€â€æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿå†æ¯”å¦‚&lt;/p&gt;
</content>
    </item>
    
    <item>
      <title>Rust Borrow and Lifetimes</title>
      <link>https://www.linuxzen.com/notes/articles/20200325182450_rust_borrow_and_lifetimes/</link>
      <pubDate>Wed, 25 Mar 2020 00:00:00 +0800</pubDate>
      
      <guid>https://www.linuxzen.com/notes/articles/20200325182450_rust_borrow_and_lifetimes/</guid>
      <description>åŸæ–‡é“¾æ¥ï¼šRust Borrow and Lifetimesã€‚
Rust æ˜¯ä¸€é—¨å¤„äºå¾€ 1.0 æ´»è·ƒå¼€å‘çš„æ–°è¯­è¨€ï¼ˆè¯‘æ³¨ï¼š1.0 æ—©å·²å‘å¸ƒï¼Œç›®å‰æœ€æ–°ç¨³å®šç‰ˆæœ¬ 1.42ï¼‰ã€‚ æˆ‘å¿…é¡»å†å†™ä¸€ç¯‡å…³äºæˆ‘ä¸ºä»€ä¹ˆè§‰å¾— Rust ç‰›é€¼çš„æ–°åšå®¢ï¼Œä½†æ˜¯ä»Šå¤©æˆ‘å°†å…³æ³¨åœ¨å®ƒçš„å€Ÿç”¨ï¼ˆborrowï¼‰ å’Œç”Ÿå‘½å‘¨æœŸï¼ˆlifetimesï¼‰ç³»ç»Ÿï¼Œè¿™ä¹Ÿæ˜¯å¸¸å¸¸è®©åŒ…æ‹¬æˆ‘åœ¨å†…çš„ Rust æ–°æ‰‹é™·å…¥å›°å¢ƒçš„åœ°æ–¹ã€‚è¿™ç¯‡æ–‡ç« å‡è®¾ ä½ åŸºæœ¬äº†è§£ Rustï¼Œå¦‚æœè¿˜æ²¡æ¨èä½ å…ˆé˜…è¯»æŒ‡å—å’ŒæŒ‡é’ˆæŒ‡å—ã€‚
èµ„æºæ‰€æœ‰æƒå’Œå€Ÿç”¨ Rust é€šè¿‡ä¸€ä¸ªéš¾ç¼ çš„ï¼ˆsophisticatedï¼‰å€Ÿç”¨ç³»ç»Ÿåœ¨ä¸ç”¨ GC çš„æƒ…å†µä¸‹è¾¾åˆ°å†…å­˜å®‰å…¨ã€‚å¯¹äºä»»ä½•èµ„æº ï¼ˆæ ˆå†…å­˜ã€å †å†…å­˜ã€æ–‡ä»¶å¥æŸ„ç­‰ï¼‰ï¼Œä»–ä»¬éƒ½å¯¹åº”ä¸€ä¸ªå”¯ä¸€çš„æ‰€æœ‰è€…ï¼ˆownerï¼‰åœ¨éœ€è¦çš„æƒ…å†µä¸‹å¤„ç†èµ„æºå›æ”¶ã€‚ ä½ å¯ä»¥é€šè¿‡ &amp;amp; æˆ–è€… &amp;amp;mut åˆ›å»ºä¸€ä¸ªæ–°çš„ç»‘å®šæŒ‡å‘è¯¥èµ„æºï¼Œè¿™è¢«ç§°ä¹‹ä¸ºå€Ÿç”¨æˆ–å¯å˜å€Ÿç”¨ã€‚ç¼–è¯‘å™¨ç¡®ä¿ æ‰€æœ‰çš„æ‰€æœ‰è€…ï¼ˆownersï¼‰å’Œå€Ÿç”¨è€…ï¼ˆborrowersï¼‰è¡Œä¸ºæ­£ç¡®ã€‚
æ‹·è´å’Œè½¬ç§»ï¼ˆCopy and moveï¼‰ åœ¨æˆ‘ä»¬å¼€å§‹è¿›å…¥å€Ÿç”¨ç³»ç»Ÿä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ Rust å¦‚ä½•å¤„ç†æ‹·è´å’Œè½¬ç§»ã€‚è¿™ä¸ª StackOverflow ç­”æ¡ˆéå¸¸å€¼å¾—ä¸€è¯»ã€‚ åŸºæœ¬ä¸Šï¼Œåœ¨èµ‹å€¼å’Œå‡½æ•°è°ƒç”¨ä¸Šï¼š
 å¦‚æœå€¼æ˜¯å¯æ‹·è´çš„ï¼ˆcopyableï¼‰ï¼ˆä»…æ¶‰åŠåŸå§‹ï¼ˆprimitiveï¼‰ç±»å‹ï¼Œä¸æ¶‰åŠå¦‚å†…å­˜æˆ–æ–‡ä»¶å¥æŸ„çš„èµ„æºï¼‰ï¼Œç¼–è¯‘å™¨é»˜è®¤è¿›è¡Œæ‹·è´ã€‚ å…¶ä»–æƒ…å†µï¼Œç¼–è¯‘å™¨è½¬ç§»ï¼ˆmovesï¼‰æ‰€æœ‰æƒï¼ˆownershipï¼‰å¹¶ä½¿åŸæ¥çš„ç»‘å®šæ— æ•ˆã€‚  ç®€è€Œè¨€ä¹‹ï¼ŒPODï¼ˆPlan Old Dataï¼‰ =&amp;gt; æ‹·è´ï¼ŒNon-PODï¼ˆçº¿æ€§ç±»å‹ï¼ˆlinear typesï¼‰ï¼‰=&amp;gt; è½¬ç§»ã€‚
ä»¥ä¸‹æ˜¯ä¸€äº›é¢å¤–çš„æ³¨é‡Šä¾›ä½ å‚è€ƒï¼š
 Rust æ‹·è´åƒ Cã€‚æ¯ä¸€ä¸ªæŒ‰å€¼ï¼ˆby-valueï¼‰ä½¿ç”¨ä¸€ä¸ªå€¼éƒ½æ˜¯å­—èŠ‚æ‹·è´ï¼ˆé€šè¿‡ memcpy æµ…æ‹·è´ï¼‰ï¼Œè€Œä¸æ˜¯è¯­ä¹‰ä¸Šçš„æ‹·è´æˆ–å…‹éš†ã€‚ å¦‚æœæƒ³è¦è®©ä¸€ä¸ª POD ç»“æ„ä½“å˜æˆä¸å¯æ‹·è´çš„ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ª NoCopy æ ‡è®°ï¼Œæˆ–è€…å®ç° Drop ç‰¹æ€§ï¼ˆtraitï¼‰ã€‚  è½¬ç§»ä¹‹åï¼Œæ‰€æœ‰æƒå°±è½¬ç§»åˆ°äº†ä¸‹ä¸€ä¸ªæ‰€æœ‰è€…é‚£ã€‚
èµ„æºå›æ”¶ Rust ä¼šåœ¨ä»»ä½•èµ„æºçš„æ‰€æœ‰æƒæ¶ˆå¤±åç«‹åˆ»é‡Šæ”¾è¯¥èµ„æºï¼Œå°±è¿™äº›ï¼Œå½“ï¼š
 æ‰€æœ‰è€…è¶…å‡ºä½œç”¨åŸŸï¼Œæˆ– æ­£åœ¨æŒæœ‰çš„æ‰€æœ‰è€…æ”¹å˜ç»‘å®šï¼ˆåŸå§‹ç»‘å®šå˜æˆ voidï¼‰ã€‚  æ‰€æœ‰è€…å’Œå€Ÿç”¨è€…çš„æƒé™ï¼ˆprivilegesï¼‰å’Œé™åˆ¶ è¿™ä¸€èŠ‚åŸºäº Rust Guide åœ¨æƒé™ï¼ˆprivilegesï¼‰ä¸€éƒ¨åˆ†æåˆ°æ‹·è´å’Œè½¬ç§»ã€‚</description>
      <content>&lt;p&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href=&#34;http://arthurtw.github.io/2014/11/30/rust-borrow-lifetimes.html&#34;&gt;Rust Borrow and Lifetimes&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;Rust æ˜¯ä¸€é—¨å¤„äºå¾€ 1.0 æ´»è·ƒå¼€å‘çš„æ–°è¯­è¨€ï¼ˆè¯‘æ³¨ï¼š1.0 æ—©å·²å‘å¸ƒï¼Œç›®å‰æœ€æ–°ç¨³å®šç‰ˆæœ¬ &lt;a href=&#34;https://github.com/rust-lang/rust/releases/tag/1.42.0&#34;&gt;1.42&lt;/a&gt;ï¼‰ã€‚
æˆ‘å¿…é¡»å†å†™ä¸€ç¯‡å…³äºæˆ‘ä¸ºä»€ä¹ˆè§‰å¾— Rust ç‰›é€¼çš„æ–°åšå®¢ï¼Œä½†æ˜¯ä»Šå¤©æˆ‘å°†å…³æ³¨åœ¨å®ƒçš„å€Ÿç”¨ï¼ˆborrowï¼‰
å’Œç”Ÿå‘½å‘¨æœŸï¼ˆlifetimesï¼‰ç³»ç»Ÿï¼Œè¿™ä¹Ÿæ˜¯å¸¸å¸¸è®©åŒ…æ‹¬æˆ‘åœ¨å†…çš„ Rust æ–°æ‰‹é™·å…¥å›°å¢ƒçš„åœ°æ–¹ã€‚è¿™ç¯‡æ–‡ç« å‡è®¾
ä½ åŸºæœ¬äº†è§£ Rustï¼Œå¦‚æœè¿˜æ²¡æ¨èä½ å…ˆé˜…è¯»&lt;a href=&#34;http://doc.rust-lang.org/guide.html&#34;&gt;æŒ‡å—&lt;/a&gt;å’Œ&lt;a href=&#34;http://doc.rust-lang.org/guide-pointers.html&#34;&gt;æŒ‡é’ˆæŒ‡å—&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id=&#34;èµ„æºæ‰€æœ‰æƒå’Œå€Ÿç”¨&#34;&gt;èµ„æºæ‰€æœ‰æƒå’Œå€Ÿç”¨&lt;/h2&gt;
&lt;p&gt;Rust é€šè¿‡ä¸€ä¸ªéš¾ç¼ çš„ï¼ˆsophisticatedï¼‰å€Ÿç”¨ç³»ç»Ÿåœ¨ä¸ç”¨ GC çš„æƒ…å†µä¸‹è¾¾åˆ°å†…å­˜å®‰å…¨ã€‚å¯¹äºä»»ä½•èµ„æº
ï¼ˆæ ˆå†…å­˜ã€å †å†…å­˜ã€æ–‡ä»¶å¥æŸ„ç­‰ï¼‰ï¼Œä»–ä»¬éƒ½å¯¹åº”ä¸€ä¸ªå”¯ä¸€çš„æ‰€æœ‰è€…ï¼ˆownerï¼‰åœ¨éœ€è¦çš„æƒ…å†µä¸‹å¤„ç†èµ„æºå›æ”¶ã€‚
ä½ å¯ä»¥é€šè¿‡ &lt;code&gt;&amp;amp;&lt;/code&gt; æˆ–è€… &lt;code&gt;&amp;amp;mut&lt;/code&gt; åˆ›å»ºä¸€ä¸ªæ–°çš„ç»‘å®šæŒ‡å‘è¯¥èµ„æºï¼Œè¿™è¢«ç§°ä¹‹ä¸ºå€Ÿç”¨æˆ–å¯å˜å€Ÿç”¨ã€‚ç¼–è¯‘å™¨ç¡®ä¿
æ‰€æœ‰çš„æ‰€æœ‰è€…ï¼ˆownersï¼‰å’Œå€Ÿç”¨è€…ï¼ˆborrowersï¼‰è¡Œä¸ºæ­£ç¡®ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ‹·è´å’Œè½¬ç§»-copy-and-move&#34;&gt;æ‹·è´å’Œè½¬ç§»ï¼ˆCopy and moveï¼‰&lt;/h2&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬å¼€å§‹è¿›å…¥å€Ÿç”¨ç³»ç»Ÿä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ Rust å¦‚ä½•å¤„ç†æ‹·è´å’Œè½¬ç§»ã€‚è¿™ä¸ª &lt;a href=&#34;https://stackoverflow.com/questions/24253344/is-it-possible-to-make-a-type-only-movable-and-not-copyable/24253573#24253573&#34;&gt;StackOverflow ç­”æ¡ˆ&lt;/a&gt;éå¸¸å€¼å¾—ä¸€è¯»ã€‚
åŸºæœ¬ä¸Šï¼Œåœ¨èµ‹å€¼å’Œå‡½æ•°è°ƒç”¨ä¸Šï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¦‚æœå€¼æ˜¯å¯æ‹·è´çš„ï¼ˆcopyableï¼‰ï¼ˆä»…æ¶‰åŠåŸå§‹ï¼ˆprimitiveï¼‰ç±»å‹ï¼Œä¸æ¶‰åŠå¦‚å†…å­˜æˆ–æ–‡ä»¶å¥æŸ„çš„èµ„æºï¼‰ï¼Œç¼–è¯‘å™¨é»˜è®¤è¿›è¡Œæ‹·è´ã€‚&lt;/li&gt;
&lt;li&gt;å…¶ä»–æƒ…å†µï¼Œç¼–è¯‘å™¨è½¬ç§»ï¼ˆmovesï¼‰æ‰€æœ‰æƒï¼ˆownershipï¼‰å¹¶ä½¿åŸæ¥çš„ç»‘å®šæ— æ•ˆã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç®€è€Œè¨€ä¹‹ï¼ŒPODï¼ˆPlan Old Dataï¼‰ =&amp;gt; æ‹·è´ï¼ŒNon-PODï¼ˆçº¿æ€§ç±»å‹ï¼ˆlinear typesï¼‰ï¼‰=&amp;gt; è½¬ç§»ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ä¸€äº›é¢å¤–çš„æ³¨é‡Šä¾›ä½ å‚è€ƒï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Rust æ‹·è´åƒ Cã€‚æ¯ä¸€ä¸ªæŒ‰å€¼ï¼ˆby-valueï¼‰ä½¿ç”¨ä¸€ä¸ªå€¼éƒ½æ˜¯å­—èŠ‚æ‹·è´ï¼ˆé€šè¿‡ &lt;code&gt;memcpy&lt;/code&gt; æµ…æ‹·è´ï¼‰ï¼Œè€Œä¸æ˜¯è¯­ä¹‰ä¸Šçš„æ‹·è´æˆ–å…‹éš†ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœæƒ³è¦è®©ä¸€ä¸ª POD ç»“æ„ä½“å˜æˆä¸å¯æ‹·è´çš„ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ª &lt;a href=&#34;http://doc.rust-lang.org/std/kinds/marker/struct.NoCopy.html&#34;&gt;NoCopy&lt;/a&gt; æ ‡è®°ï¼Œæˆ–è€…å®ç° &lt;a href=&#34;http://doc.rust-lang.org/std/ops/trait.Drop.html&#34;&gt;Drop&lt;/a&gt; ç‰¹æ€§ï¼ˆtraitï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è½¬ç§»ä¹‹åï¼Œæ‰€æœ‰æƒå°±è½¬ç§»åˆ°äº†ä¸‹ä¸€ä¸ªæ‰€æœ‰è€…é‚£ã€‚&lt;/p&gt;
&lt;h2 id=&#34;èµ„æºå›æ”¶&#34;&gt;èµ„æºå›æ”¶&lt;/h2&gt;
&lt;p&gt;Rust ä¼šåœ¨ä»»ä½•èµ„æºçš„æ‰€æœ‰æƒæ¶ˆå¤±åç«‹åˆ»é‡Šæ”¾è¯¥èµ„æºï¼Œå°±è¿™äº›ï¼Œå½“ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ‰€æœ‰è€…è¶…å‡ºä½œç”¨åŸŸï¼Œæˆ–&lt;/li&gt;
&lt;li&gt;æ­£åœ¨æŒæœ‰çš„æ‰€æœ‰è€…æ”¹å˜ç»‘å®šï¼ˆåŸå§‹ç»‘å®šå˜æˆ voidï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;æ‰€æœ‰è€…å’Œå€Ÿç”¨è€…çš„æƒé™-privileges-å’Œé™åˆ¶&#34;&gt;æ‰€æœ‰è€…å’Œå€Ÿç”¨è€…çš„æƒé™ï¼ˆprivilegesï¼‰å’Œé™åˆ¶&lt;/h2&gt;
&lt;p&gt;è¿™ä¸€èŠ‚åŸºäº &lt;a href=&#34;http://doc.rust-lang.org/guide.html&#34;&gt;Rust Guide&lt;/a&gt; åœ¨æƒé™ï¼ˆprivilegesï¼‰ä¸€éƒ¨åˆ†æåˆ°æ‹·è´å’Œè½¬ç§»ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€æœ‰è€…æœ‰ä¸€äº›æƒé™ã€‚å®ƒå¯ä»¥ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ§åˆ¶èµ„æºå›æ”¶ã€‚&lt;/li&gt;
&lt;li&gt;å€Ÿå‡ºèµ„æºï¼Œä¸å¯å˜çš„ï¼ˆå¯å¤šæ¬¡å€Ÿç”¨ï¼‰æˆ–å¯å˜çš„ï¼ˆåªèƒ½ç‹¬å ï¼‰ï¼Œå’Œ&lt;/li&gt;
&lt;li&gt;äº¤å‡ºæ‰€æœ‰æƒï¼ˆé€šè¿‡è½¬ç§»ï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åŒæ—¶æ‰€æœ‰è€…ä¹Ÿå­˜åœ¨ä¸€äº›é™åˆ¶ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ä¸å¯å˜å€Ÿç”¨æœŸé—´ï¼Œæ‰€æœ‰è€…ä¸èƒ½&lt;/p&gt;
&lt;p&gt;a. æ”¹å˜èµ„æºï¼Œæˆ–è€…&lt;/p&gt;
&lt;p&gt;b. ä»¥å¯å˜çš„æ–¹å¼å€Ÿå‡ºèµ„æºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯å˜å€Ÿç”¨æœŸé—´æ‰€æœ‰è€…ä¸èƒ½&lt;/p&gt;
&lt;p&gt;a. è®¿é—®è¯¥èµ„æºï¼Œæˆ–è€…&lt;/p&gt;
&lt;p&gt;b. å†æ¬¡å€Ÿå‡ºè¯¥èµ„æºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å€Ÿç”¨è€…åŒæ—¶ä¹Ÿæœ‰ä¸€äº›æƒé™ã€‚é™¤äº†è®¿é—®æˆ–è€…æ›´æ”¹å€Ÿç”¨çš„èµ„æºå¤–ï¼Œå€Ÿç”¨è€…ä¹Ÿå¯ä»¥è¿›ä¸€æ­¥å€Ÿå‡ºï¼ˆshare the borrowï¼‰ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸å¯å˜å€Ÿç”¨è€…å¯ä»¥å€Ÿå‡ºï¼ˆæ‹·è´ï¼‰ä¸å¯å˜å€Ÿç”¨ï¼ˆè¯‘æ³¨ï¼šå†æ¬¡ä»¥ä¸å¯å˜å€Ÿç”¨å€Ÿå‡ºï¼‰&lt;/li&gt;
&lt;li&gt;å¯å˜å€Ÿç”¨è€…å¯ä»¥äº¤å‡ºï¼ˆè½¬ç§»ï¼‰å¯å˜å€Ÿç”¨ã€‚ï¼ˆå¯å˜å¼•ç”¨é»˜è®¤ä½¿ç”¨è½¬ç§»ã€‚ï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;ä»£ç ç¤ºä¾‹&#34;&gt;ä»£ç ç¤ºä¾‹&lt;/h2&gt;
&lt;p&gt;å…³äºå€Ÿç”¨æˆ‘ä»¬å·²ç»èŠçš„å¤Ÿå¤šäº†ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¥çœ‹ä¸€äº›ä»£ç å§ï¼ˆä½ å¯ä»¥é€šè¿‡ &lt;a href=&#34;https://play.rust-lang.org&#34;&gt;https://play.rust-lang.org&lt;/a&gt; è¿è¡Œè¿™äº› Rust ä»£ç ã€‚ï¼‰
åœ¨ä¸‹é¢æ‰€æœ‰çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸å¯æ‹·è´çš„ &lt;code&gt;struct Foo&lt;/code&gt; ï¼Œå› ä¸ºå®ƒåŒ…å«äº†ä¸€ä¸ªè£…ç®±ï¼ˆboxedï¼‰ï¼ˆå †åˆ†é…ï¼‰å€¼ã€‚
ä½¿ç”¨ä¸å¯æ‹·è´èµ„æºå¯ä»¥é™åˆ¶ç›¸å…³æ“ä½œï¼Œè®©æˆ‘ä»¬æ›´å¥½çš„å­¦ä¹ ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºæ¯ä¸€ä¸ªä»£ç ç¤ºä¾‹ï¼Œæˆ‘ä»¬è¿˜æä¾›äº†ä¸€ä¸ªâ€œä½œç”¨åŸŸå›¾è¡¨â€ï¼ˆscope chartï¼‰æ¥å±•ç¤ºæ‰€æœ‰è€…å’Œå€Ÿç”¨è€…çš„ä½œç”¨åŸŸã€‚
å›¾è¡¨ç¬¬ä¸€è¡Œçš„å¤§æ‹¬å·å’Œä»£ç ä¸­çš„å¤§æ‹¬å·ä¸€ä¸€å¯¹åº”ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ‰€æœ‰è€…åœ¨å¯å˜å€Ÿç”¨æœŸé—´ä¸èƒ½è®¿é—®èµ„æº&#34;&gt;æ‰€æœ‰è€…åœ¨å¯å˜å€Ÿç”¨æœŸé—´ä¸èƒ½è®¿é—®èµ„æº&lt;/h3&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬å°†ä»£ç ä¸­çš„ &lt;code&gt;println!&lt;/code&gt; è§£é™¤æ³¨é‡Šï¼Œä»£ç å°†ä¸èƒ½ç¼–è¯‘ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Foo&lt;/span&gt; {
    f: Box&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;int&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;,
}

&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Foo { f: &lt;span style=&#34;color:#a6e22e&#34;&gt;box&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; };
    &lt;span style=&#34;color:#75715e&#34;&gt;// mutable borrow
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; a;
    &lt;span style=&#34;color:#75715e&#34;&gt;// error: cannot borrow `a.f` as immutable because `a` is also borrowed as mutable
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;// println!(&amp;#34;{}&amp;#34;, a.f);
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;           { a x * }
   owner a   |_____|
borrower x     |___| x = &amp;amp;mut a
access a.f       |   error
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è¿™è¿åäº†æ‰€æœ‰è€…é™åˆ¶ #2(a)ã€‚å¦‚æœæˆ‘ä»¬å°† &lt;code&gt;let x = &amp;amp;mut a;&lt;/code&gt; åœ¨ä¸€ä¸ªåµŒå¥—çš„ä»£ç å—é‡Œï¼šå€Ÿç”¨
åœ¨ &lt;code&gt;println!&lt;/code&gt; ä¹‹å‰ç»“æŸï¼Œè¿™æ®µä»£ç å°†èƒ½æ­£å¸¸å·¥ä½œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Foo { f: &lt;span style=&#34;color:#a6e22e&#34;&gt;box&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; };
    {
        &lt;span style=&#34;color:#75715e&#34;&gt;// mutable borrow
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; a;
        &lt;span style=&#34;color:#75715e&#34;&gt;// mutable borrow ends here
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    }
    println&lt;span style=&#34;color:#f92672&#34;&gt;!&lt;/span&gt;(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;{}&amp;#34;&lt;/span&gt;, a.f);
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;           { a { x } * }
   owner a   |_________|
borrower x       |_|     x = &amp;amp;mut a
access a.f           |   OK
&lt;/code&gt;&lt;/pre&gt;&lt;h3 id=&#34;å€Ÿç”¨è€…å¯ä»¥è½¬ç§»å¯å˜å€Ÿç”¨åˆ°ä¸€ä¸ªæ–°çš„å€Ÿç”¨è€…&#34;&gt;å€Ÿç”¨è€…å¯ä»¥è½¬ç§»å¯å˜å€Ÿç”¨åˆ°ä¸€ä¸ªæ–°çš„å€Ÿç”¨è€…&lt;/h3&gt;
&lt;p&gt;è¿™æ®µä»£ç å±•ç¤ºå€Ÿç”¨è€…çš„æƒé™ #2: å¯å˜å€Ÿç”¨ &lt;code&gt;x&lt;/code&gt; å¯ä»¥å°†æ‰€æœ‰æƒè½¬ç§»å¯å˜å€Ÿç”¨åˆ°ä¸€ä¸ªæ–°çš„å€Ÿç”¨è€… &lt;code&gt;y&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Foo { f: &lt;span style=&#34;color:#a6e22e&#34;&gt;box&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; };
    &lt;span style=&#34;color:#75715e&#34;&gt;// mutable borrow
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; a;
    &lt;span style=&#34;color:#75715e&#34;&gt;// move the mutable borrow to new borrower y
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; y &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x;
    &lt;span style=&#34;color:#75715e&#34;&gt;// error: use of moved value: `x.f`
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;// println!(&amp;#34;{}&amp;#34;, x.f);
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;           { a x y * }
   owner a   |_______|
borrower x     |_|     x = &amp;amp;mut a
borrower y       |___| y = x
access x.f         |   error
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;è½¬ç§»ä¹‹åï¼ŒåŸå§‹çš„å€Ÿç”¨è€… &lt;code&gt;x&lt;/code&gt; ä¸å†èƒ½è®¿é—®å€Ÿç”¨çš„èµ„æºã€‚&lt;/p&gt;
&lt;h2 id=&#34;å€Ÿç”¨ä½œç”¨åŸŸ-borrow-scope&#34;&gt;å€Ÿç”¨ä½œç”¨åŸŸï¼ˆBorrow scopeï¼‰&lt;/h2&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬å¼€å§‹ä¼ é€’å¼•ç”¨ï¼ˆ &lt;code&gt;&amp;amp;&lt;/code&gt; å’Œ =&amp;amp;mut=ï¼‰äº‹æƒ…å°±å¼€å§‹å˜å¾—æœ‰è¶£ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ Rust æ–°æ‰‹ä»¬å¼€å§‹å›°æƒ‘çš„åœ°æ–¹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç”Ÿå‘½å‘¨æœŸ-lifetime&#34;&gt;ç”Ÿå‘½å‘¨æœŸï¼ˆLifetimeï¼‰&lt;/h3&gt;
&lt;p&gt;åœ¨æ•´ä¸ªå€Ÿç”¨è¿‡ç¨‹ä¸­ï¼ŒçŸ¥é“å€Ÿç”¨è€…çš„å€Ÿç”¨ä»€ä¹ˆæ—¶å€™å¼€å§‹å’Œç»“æŸéå¸¸é‡è¦ã€‚åœ¨&lt;a href=&#34;http://doc.rust-lang.org/guide-lifetimes.html&#34;&gt;ç”Ÿå‘½å‘¨æœŸæŒ‡å—&lt;/a&gt;ä¸­æ˜¯è¿™æ ·å®šä¹‰ç”Ÿå‘½å‘¨æœŸçš„ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A lifetime is a static approximation of the span of execution during which the pointer is valid: it always corresponds to some expression or block within the program.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;blockquote&gt;
&lt;p&gt;ç”Ÿå‘½å‘¨æœŸæ˜¯æŒ‡é’ˆæœ‰æ•ˆèŒƒå›´çš„é™æ€è¿‘ä¼¼å€¼ï¼šå®ƒå§‹ç»ˆå¯¹åº”ç¨‹åºä¸­çš„æŸäº›è¡¨è¾¾å¼æˆ–ä»£ç å—ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç„¶è€Œï¼Œæˆ‘æ›´å–œæ¬¢ä½¿ç”¨ &lt;strong&gt;å€Ÿç”¨ä½œç”¨åŸŸï¼ˆborrow scopeï¼‰&lt;/strong&gt; è¿™ä¸ªæœ¯è¯­å»æè¿°å€Ÿç”¨ç”Ÿæ•ˆçš„ä½œç”¨åŸŸã€‚è¯·æ³¨æ„å®ƒä¸åŒäºä¸Šé¢ç”Ÿå‘½å‘¨æœŸçš„å®šä¹‰ã€‚
ï¼ˆæˆ‘ç¬¬ä¸€æ¬¡è§åˆ°è¿™ä¸ªæœ¯è¯­æ˜¯åœ¨ä¸€ä¸ª Rust &lt;a href=&#34;https://github.com/rust-lang/rfcs/pull/431&#34;&gt;RFC è®¨è®º&lt;/a&gt; ä¸­ï¼Œå°½ç®¡æˆ‘çš„å®šä¹‰å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚ï¼‰æˆ‘ä¼šåœ¨ç¨åç»™å‡ºæˆ‘ä¸ºä»€ä¹ˆé¿å…ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸçš„åŸå› ã€‚
ç°åœ¨æˆ‘ä»¬å…ˆæŠŠç”Ÿå‘½å‘¨æœŸæ”¾åœ¨ä¸€è¾¹ã€‚&lt;/p&gt;
&lt;h3 id=&#34;and-borrow&#34;&gt;&amp;amp; = borrow&lt;/h3&gt;
&lt;p&gt;ä¸€äº›å…³äºå€Ÿç”¨çš„äº‹æƒ…ï¼š&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œåªéœ€è¦è®°ä½ &lt;code&gt;&amp;amp;&lt;/code&gt; = å€Ÿç”¨ï¼Œ &lt;code&gt;&amp;amp;mut&lt;/code&gt; = å¯å˜å€Ÿç”¨ã€‚ä»»ä½•åœ°æ–¹ä½ çœ‹åˆ°ä¸€ä¸ª &lt;code&gt;&amp;amp;&lt;/code&gt; ï¼Œé‚£å°±æ˜¯ä¸€ä¸ªå€Ÿç”¨ã€‚&lt;/p&gt;
&lt;p&gt;å…¶æ¬¡ï¼Œå½“ä¸€ä¸ª &lt;code&gt;&amp;amp;&lt;/code&gt; å‡ºç°åœ¨ä»»ä½•ç»“æ„ä½“ä¸­ï¼ˆåœ¨å®ƒçš„å­—æ®µä¸­ï¼‰æˆ–è€…å‡½æ•°/é—­åŒ…ï¼ˆè¿”å›å€¼æˆ–è€…æ•è·çš„å¼•ç”¨ï¼‰ï¼Œç»“æ„ä½“/å‡½æ•°/é—­åŒ…å°±æ˜¯ä¸€ä¸ªå€Ÿç”¨è€…ï¼Œ
å¹¶ä¸”åº”ç”¨æ‰€æœ‰çš„å€Ÿç”¨è§„åˆ™ã€‚&lt;/p&gt;
&lt;p&gt;å†æ¬¡ï¼Œå¯¹äºæ¯ä¸€ä¸ªå€Ÿç”¨ï¼Œéƒ½å­˜åœ¨ä¸€ä¸ªæ‰€æœ‰è€…å’Œä¸€ä¸ªæˆ–å¤šä¸ªå€Ÿç”¨è€…ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ‰©å±•å€Ÿç”¨ä½œç”¨åŸŸ&#34;&gt;æ‰©å±•å€Ÿç”¨ä½œç”¨åŸŸ&lt;/h3&gt;
&lt;p&gt;ä¸€äº›å…³äºå€Ÿç”¨ä½œç”¨åŸŸçš„äº‹æƒ…ï¼š&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œä¸€ä¸ªå€Ÿç”¨ä½œç”¨åŸŸï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ˜¯ä¸€ä¸ªå€Ÿç”¨ç”Ÿæ•ˆçš„èŒƒå›´ï¼Œå¹¶ä¸”&lt;/li&gt;
&lt;li&gt;ä¸ä¸€å®šæ˜¯å€Ÿç”¨è€…çš„è¯æ³•ä½œç”¨åŸŸï¼Œå› ä¸ºå€Ÿç”¨è€…å¯ä»¥æ‰©å±•å€Ÿç”¨ä½œç”¨åŸŸï¼ˆå‚è§ä¸‹é¢ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…¶æ¬¡ï¼Œå€Ÿç”¨è€…åœ¨èµ‹å€¼æˆ–è€…å‡½æ•°è°ƒç”¨ä¸­å¯ä»¥é€šè¿‡æ‹·è´ï¼ˆä¸å¯å˜å€Ÿç”¨ï¼‰æˆ–è€…è½¬ç§»ï¼ˆå¯å˜å€Ÿç”¨ï¼‰æ‰©å±•å€Ÿç”¨ä½œç”¨åŸŸã€‚
æ¥æ”¶è€…ï¼ˆreceiverï¼‰ï¼ˆå¯ä»¥æ˜¯æ–°çš„ç»‘å®šã€ç»“æ„ä½“ã€å‡½æ•°æˆ–è€…é—­åŒ…ï¼‰å˜æˆæ–°çš„å€Ÿç”¨è€…ã€‚&lt;/p&gt;
&lt;p&gt;å†æ¬¡ï¼Œå€Ÿç”¨ä½œç”¨åŸŸæ˜¯æ‰€æœ‰å€Ÿç”¨è€…ä½œç”¨åŸŸçš„å¹¶é›†ï¼Œå¹¶ä¸”è¢«å€Ÿç”¨çš„èµ„æºå¿…é¡»åœ¨æ•´ä¸ªå€Ÿç”¨ä½œç”¨åŸŸé‡Œæœ‰æ•ˆã€‚&lt;/p&gt;
&lt;h3 id=&#34;å€Ÿç”¨å…¬å¼&#34;&gt;å€Ÿç”¨å…¬å¼&lt;/h3&gt;
&lt;p&gt;æ ¹æ®æœ€åä¸€ç‚¹ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªå€Ÿç”¨å…¬å¼ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;èµ„æºä½œç”¨åŸŸ &amp;gt;= å€Ÿç”¨ä½œç”¨åŸŸ = æ‰€æœ‰å€Ÿç”¨è€…ä½œç”¨åŸŸçš„å¹¶é›†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&#34;ä»£ç ç¤ºä¾‹&#34;&gt;ä»£ç ç¤ºä¾‹&lt;/h3&gt;
&lt;p&gt;è®©æˆ‘ä»¬çœ‹ä¸€äº›æ‰©å±•ä½œç”¨åŸŸçš„ä»£ç ç¤ºä¾‹ã€‚ç»“æ„ä½“ &lt;code&gt;struct Foo&lt;/code&gt; å’Œå‰é¢çš„ä¸€æ ·ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Foo { f: &lt;span style=&#34;color:#a6e22e&#34;&gt;box&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; };
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; y: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;Foo&lt;/span&gt;;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt; {
        &lt;span style=&#34;color:#75715e&#34;&gt;// borrow
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;a;
        &lt;span style=&#34;color:#75715e&#34;&gt;// share the borrow with new borrower y, hence extend the borrow scope
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;        y &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; x;
    }
    &lt;span style=&#34;color:#75715e&#34;&gt;// error: cannot assign to `a.f` because it is borrowed
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    &lt;span style=&#34;color:#75715e&#34;&gt;// a.f = box 1;
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;             { a { x y } * }
  resource a   |___________|
  borrower x       |___|     x = &amp;amp;a
  borrower y         |_____| y = x
borrow scope       |=======|
  mutate a.f             |   error
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å³ä½¿å€Ÿç”¨å‘ç”Ÿåœ¨ &lt;code&gt;if&lt;/code&gt; ä»£ç å—ä¹‹å†…å¹¶ä¸”å€Ÿç”¨è€… &lt;code&gt;x&lt;/code&gt; åœ¨ &lt;code&gt;if&lt;/code&gt; ä»£ç å—ä¹‹åè¶…å‡ºä½œç”¨åŸŸï¼Œå®ƒå·²ç»é€šè¿‡èµ‹å€¼ &lt;code&gt;y=x;&lt;/code&gt; æ‰©å±•äº†å€Ÿç”¨ä½œç”¨åŸŸï¼Œ
æ‰€ä»¥å­˜åœ¨ä¸¤ä¸ªå€Ÿç”¨è€…ï¼š &lt;code&gt;x&lt;/code&gt; å’Œ &lt;code&gt;y&lt;/code&gt; ã€‚æ ¹æ®å€Ÿç”¨å…¬å¼ï¼šå€Ÿç”¨ä½œç”¨åŸŸæ˜¯å€Ÿç”¨è€… &lt;code&gt;x&lt;/code&gt; å’Œå€Ÿç”¨è€… &lt;code&gt;y&lt;/code&gt; ä½œç”¨åŸŸçš„å¹¶é›†ï¼š
èŒƒå›´å¼€å§‹ç¬¬ä¸€æ¬¡å€Ÿç”¨äº &lt;code&gt;let x = &amp;amp;a;&lt;/code&gt; ç›´åˆ° &lt;code&gt;main&lt;/code&gt; ä»£ç å—çš„ç»“å°¾ã€‚ï¼ˆæ³¨æ„ç»‘å®š &lt;code&gt;y&lt;/code&gt; åœ¨ &lt;code&gt;y=x;&lt;/code&gt; ä¹‹å‰ä¸æ˜¯å€Ÿç”¨è€…ã€‚ï¼‰&lt;/p&gt;
&lt;p&gt;ä½ å¯èƒ½æ³¨æ„åˆ°äº†ç”±äºæ¡ä»¶æ°¸è¿œæ˜¯ false &lt;code&gt;if&lt;/code&gt; ä»£ç å—æ°¸è¿œä¸ä¼šæ‰§è¡Œï¼Œä½†æ˜¯ç¼–è¯‘å™¨å§‹ç»ˆæ‹’ç»èµ„æºæ‰€æœ‰è€… &lt;code&gt;a&lt;/code&gt; å»è®¿é—®
å®ƒçš„èµ„æºã€‚è¿™æ˜¯å› ä¸ºæ‰€æœ‰çš„å€Ÿç”¨æ£€æŸ¥å‘ç”Ÿåœ¨ç¼–è¯‘æœŸï¼Œè¿™æ ·ç¨‹åºè¿è¡Œæ—¶å°±ä¸éœ€è¦åšä»»ä½•äº‹æƒ…ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å€Ÿç”¨å¤šä¸ªèµ„æº&#34;&gt;å€Ÿç”¨å¤šä¸ªèµ„æº&lt;/h2&gt;
&lt;p&gt;ç›®å‰ä¸ºæ­¢æˆ‘ä»¬åªå…³æ³¨å€Ÿç”¨å•ä¸ªèµ„æºã€‚å€Ÿç”¨è€…å¯ä»¥å€Ÿç”¨å¤šä¸ªèµ„æºå—ï¼Ÿå½“ç„¶ï¼æ¯”å¦‚ä¸€ä¸ªå‡½æ•°å¯ä»¥æ¥å—ä¸¤ä¸ªå¼•ç”¨ç„¶å
åŸºäºä¸€äº›æƒ…å†µè¿”å›å…¶ä¸­ä¸€ä¸ªï¼Œe.g. å…¶ä¸­å­—æ®µå€¼æ¯”è¾ƒå¤§çš„é‚£ä¸€ä¸ªã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;max&lt;/span&gt;(x: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;Foo&lt;/span&gt;, y: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;Foo&lt;/span&gt;) -&amp;gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;Foo&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;&lt;code&gt;max&lt;/code&gt; å‡½æ•°è¿”å›ä¸€ä¸ª &lt;code&gt;&amp;amp;&lt;/code&gt; æŒ‡é’ˆï¼Œå› æ­¤å®ƒæ˜¯ä¸€ä¸ªå€Ÿç”¨è€…ã€‚è¿”å›çš„ç»“æœå¯ä»¥æ˜¯è¾“å…¥å‚æ•°çš„ä»»æ„ä¸€ä¸ªï¼Œæ‰€ä»¥å®ƒå€Ÿç”¨äº†
ä¸¤é¥é¢èµ„æºã€‚&lt;/p&gt;
&lt;h3 id=&#34;å‘½åå€Ÿç”¨ä½œç”¨åŸŸ-named-borrow-scope&#34;&gt;å‘½åå€Ÿç”¨ä½œç”¨åŸŸï¼ˆNamed borrow scopeï¼‰&lt;/h3&gt;
&lt;p&gt;å½“å­˜åœ¨å¤šä¸ª &lt;code&gt;&amp;amp;&lt;/code&gt; æŒ‡é’ˆä½œä¸ºè¾“å…¥ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ &lt;strong&gt;å‘½åç”Ÿå‘½å‘¨æœŸï¼ˆnamed lifetimesï¼‰&lt;/strong&gt; æŒ‡å®šå®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼Œ
å‚è§ &lt;a href=&#34;http://doc.rust-lang.org/guide-lifetimes.html#named-lifetimes&#34;&gt;Lifetimes Guide&lt;/a&gt;ã€‚ä½†ç°åœ¨ï¼Œè®©æˆ‘ä»¬å«å®ƒä»¬ &lt;strong&gt;å‘½åå€Ÿç”¨ä½œç”¨åŸŸï¼ˆnamed borrow scopesï¼‰&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šé¢çš„ä»£ç æ²¡æœ‰ä½¿ç”¨ &lt;strong&gt;å‘½åç”Ÿå‘½å‘¨æœŸ&lt;/strong&gt; æŒ‡å®šå®ƒä»¬ä¹‹é—´çš„å…³ç³»æ˜¯ä¸ä¼šé€šè¿‡ç¼–è¯‘å™¨çš„ï¼Œi.e. å“ªäº›å€Ÿç”¨è€… &lt;strong&gt;åˆ†ç»„ï¼ˆgroupedï¼‰&lt;/strong&gt;
åˆ°å“ªä¸ªå€Ÿç”¨ä½œç”¨åŸŸã€‚ä¸‹é¢çš„å®ç°æ˜¯åˆæ³•çš„ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;max&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;(x: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt; Foo, y: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt; Foo) -&amp;gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt; Foo {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; x.f &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; y.f { x } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; { y }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;(All resources and borrowers are grouped in borrow scope &#39;a.)
                  max( {   } )
    resource *x &amp;lt;--------------&amp;gt;
    resource *y &amp;lt;--------------&amp;gt;
borrow scope &#39;a &amp;lt;==============&amp;gt;
     borrower x        |___|
     borrower y        |___|
   return value          |___|   pass to the caller
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå€Ÿç”¨ä½œç”¨åŸŸ &lt;code&gt;&#39;a&lt;/code&gt; å’Œä¸‰ä¸ªå€Ÿç”¨è€…ï¼šä¸¤ä¸ªè¾“å…¥å‚æ•°å’Œå‡½æ•°è¿”å›ç»“æœã€‚
å‰é¢æåˆ°çš„å€Ÿç”¨å…¬å¼ä¾ç„¶ç”Ÿæ•ˆï¼Œä½†æ˜¯ç°åœ¨æ¯ä¸ªè¢«å€Ÿç”¨çš„èµ„æºå¿…é¡»æ»¡è¶³å…¬å¼ã€‚å‚è§ä¸‹é¢çš„ä¾‹å­ï¼š&lt;/p&gt;
&lt;h3 id=&#34;ä»£ç ç¤ºä¾‹&#34;&gt;ä»£ç ç¤ºä¾‹&lt;/h3&gt;
&lt;p&gt;åœ¨æ¥ä¸‹æ¥çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ¥ä½¿ç”¨ä¸Šé¢çš„ &lt;code&gt;max&lt;/code&gt; å‡½æ•°åœ¨ &lt;code&gt;a&lt;/code&gt; å’Œ &lt;code&gt;b&lt;/code&gt; ä¹‹é—´é€‰æ‹©ä¸€ä¸ªæ›´å¤§ &lt;code&gt;Foo&lt;/code&gt; ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Foo { f: &lt;span style=&#34;color:#a6e22e&#34;&gt;box&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; };
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; y: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;Foo&lt;/span&gt;;
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt; {
        &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; b &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Foo { f: &lt;span style=&#34;color:#a6e22e&#34;&gt;box&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; };
        &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; max(&lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;a, &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;b);
        &lt;span style=&#34;color:#75715e&#34;&gt;// error: `b` does not live long enough
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;// y = x;
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;              { a { b x (  ) y } }
   resource a   |________________| pass
   resource b       |__________|   fail
 borrow scope         |==========|
temp borrower            |_|       &amp;amp;a
temp borrower            |_|       &amp;amp;b
   borrower x         |________|   x = max(&amp;amp;a, &amp;amp;b)
   borrower y                |___| y = x
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;ç›´åˆ° &lt;code&gt;let x = max(&amp;amp;a, &amp;amp;b)&lt;/code&gt; éƒ½ä¸€äº›æ­£å¸¸ï¼Œå› ä¸º &lt;code&gt;&amp;amp;a&lt;/code&gt; å’Œ &lt;code&gt;&amp;amp;b&lt;/code&gt; éƒ½æ˜¯å°½åœ¨è¡¨è¾¾å¼ä¸­æœ‰æ•ˆçš„ä¸´æ—¶å¼•ç”¨ï¼Œ
å¹¶ä¸”ç¬¬ä¸‰ä¸ªå€Ÿç”¨ &lt;code&gt;x&lt;/code&gt; å€Ÿç”¨äº†ä¸¤ä¸ªèµ„æºï¼ˆä¸ç®¡æœ€ç»ˆæ˜¯ &lt;code&gt;a&lt;/code&gt; æˆ– &lt;code&gt;b&lt;/code&gt; ï¼Œå¯¹äºå€Ÿç”¨æ£€æŸ¥å™¨è€Œè¨€å®ƒéƒ½å€Ÿç”¨äº†ï¼‰ç›´åˆ° &lt;code&gt;if&lt;/code&gt;
å—ç»“æŸï¼Œæ‰€ä»¥å€Ÿç”¨ä½œç”¨åŸŸæ˜¯ä» &lt;code&gt;let x = max(&amp;amp;a, &amp;amp;b);&lt;/code&gt; åˆ° &lt;code&gt;if&lt;/code&gt; å—ç»“å°¾ã€‚ä¸¤ä¸ªèµ„æº &lt;code&gt;a&lt;/code&gt; å’Œ &lt;code&gt;b&lt;/code&gt; åœ¨æ•´ä¸ªå€Ÿç”¨ä½œç”¨åŸŸ
éƒ½æœ‰æ•ˆ,å› æ­¤æ»¡è¶³å€Ÿç”¨å…¬å¼ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨å¦‚æœæˆ‘ä»¬è§£é™¤æœ€åä¸€ä¸ªèµ‹å€¼ &lt;code&gt;y = x;&lt;/code&gt; çš„æ³¨é‡Šï¼Œ &lt;code&gt;y&lt;/code&gt; å˜æˆç¬¬å››ä¸ªå€Ÿç”¨è€…ï¼Œç„¶åå€Ÿç”¨ä½œç”¨åŸŸè¢«æ‰©å±•åˆ° &lt;code&gt;main&lt;/code&gt;
å—çš„ç»“å°¾ï¼Œå¯¼è‡´èµ„æº &lt;code&gt;b&lt;/code&gt; ä¸èƒ½æ»¡è¶³å…¬å¼ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç»“æ„ä½“ä½œä¸ºå€Ÿç”¨è€…&#34;&gt;ç»“æ„ä½“ä½œä¸ºå€Ÿç”¨è€…&lt;/h2&gt;
&lt;p&gt;é™¤äº†å‡½æ•°å’Œé—­åŒ…ä¹‹å¤–ï¼Œä¸€ä¸ªç»“æ„ä½“ä¹Ÿå¯ä»¥é€šè¿‡å…¶å­—æ®µå­˜å‚¨å¤šä¸ªå¼•ç”¨æ¥å€Ÿç”¨å¤šä¸ªèµ„æºã€‚æˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„ä¸€äº›ä¾‹å­
æ¥çœ‹çœ‹å€Ÿç”¨å…¬å¼å¦‚ä½•ç”Ÿæ•ˆçš„ã€‚æˆ‘ä»¬æ¥ä½¿ç”¨ &lt;code&gt;Link&lt;/code&gt; ç»“æ„ä½“æ¥ä¿å­˜ä¸€ä¸ªå¼•ç”¨ï¼ˆä¸å¯å˜å€Ÿç”¨ï¼‰ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;struct&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;Link&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; {
  link: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt; Foo,
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id=&#34;ç»“æ„ä½“å€Ÿç”¨å¤šä¸ªèµ„æº&#34;&gt;ç»“æ„ä½“å€Ÿç”¨å¤šä¸ªèµ„æº&lt;/h3&gt;
&lt;p&gt;å³ä½¿åªæœ‰ä¸€ä¸ªå­—æ®µï¼Œç»“æ„ä½“ &lt;code&gt;Link&lt;/code&gt; ä¹Ÿå¯ä»¥å€Ÿç”¨å¤šä¸ªèµ„æºï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Foo { f: &lt;span style=&#34;color:#a6e22e&#34;&gt;box&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; };
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Link { link: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;a&lt;/span&gt; };
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt; {
        &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; b &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Foo { f: &lt;span style=&#34;color:#a6e22e&#34;&gt;box&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; };
        &lt;span style=&#34;color:#75715e&#34;&gt;// error: `b` does not live long enough
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;        &lt;span style=&#34;color:#75715e&#34;&gt;// x.link = &amp;amp;b;
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;             { a x { b * } }
  resource a   |___________| pass
  resource b         |___|   fail
borrow scope     |=========|
  borrower x     |_________| x.link = &amp;amp;a
  borrower x           |___| x.link = &amp;amp;b
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;åœ¨ä¸Šé¢ä¾‹å­ä¸­ï¼Œå€Ÿç”¨è€… &lt;code&gt;x&lt;/code&gt; ä»æ‰€æœ‰è€… &lt;code&gt;a&lt;/code&gt; å€Ÿç”¨èµ„æºï¼Œå€Ÿç”¨ä½œç”¨åŸŸåˆ° &lt;code&gt;main&lt;/code&gt; å—çš„ç»“å°¾ã€‚So far so goodã€‚
å¦‚æœæˆ‘ä»¬è§£é™¤æœ€åä¸€ä¸ªèµ‹å€¼ &lt;code&gt;x.link = &amp;amp;b;&lt;/code&gt; çš„æ³¨é‡Šï¼Œ &lt;code&gt;x&lt;/code&gt; ä¹Ÿå°è¯•ä»æ‰€æœ‰è€… &lt;code&gt;b&lt;/code&gt; å€Ÿç”¨èµ„æºï¼Œè¿™ä¼šè®©èµ„æº &lt;code&gt;b&lt;/code&gt;
ä¸èƒ½æ»¡è¶³å€Ÿç”¨å…¬å¼ã€‚&lt;/p&gt;
&lt;h3 id=&#34;æ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°æ‰©å±•å€Ÿç”¨ä½œç”¨åŸŸ&#34;&gt;æ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°æ‰©å±•å€Ÿç”¨ä½œç”¨åŸŸ&lt;/h3&gt;
&lt;p&gt;ä¸€ä¸ªæ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°åŒæ ·ä¹Ÿå¯ä»¥é€šè¿‡è¾“å‡ºå‚æ•°èƒ½æ‰©å±•å€Ÿç”¨ä½œç”¨åŸŸã€‚ä¾‹å¦‚ï¼Œè¿™ä¸ªå‡½æ•° &lt;code&gt;store_foo&lt;/code&gt; æ¥å—ä¸€ä¸ª
&lt;code&gt;Link&lt;/code&gt; çš„å¯å˜å¼•ç”¨ï¼Œç„¶åå­˜å‚¨ä¸€ä¸ªå¼•ç”¨ï¼ˆä¸å¯å˜å€Ÿç”¨ï¼‰åˆ° &lt;code&gt;Foo&lt;/code&gt; é‡Œï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;store_foo&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;(x: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;mut&lt;/span&gt; Link&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;, y: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt; Foo) {
  x.link &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; y;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;åœ¨æ¥ä¸‹æ¥çš„ä»£ç ä¸­ï¼Œè¢« &lt;code&gt;a&lt;/code&gt; æ‰€æœ‰çš„èµ„æºæ˜¯è¢«å€Ÿç”¨èµ„æºï¼› &lt;code&gt;Link&lt;/code&gt; ç»“æ„ä½“è¢«å€Ÿç”¨è€… &lt;code&gt;x&lt;/code&gt; å¯å˜çš„å¼•ç”¨ç€ï¼ˆi.e. &lt;code&gt;*x&lt;/code&gt; æ˜¯å€Ÿç”¨è€…ï¼‰ï¼›
å€Ÿç”¨ä½œç”¨åŸŸç›´åˆ° &lt;code&gt;main&lt;/code&gt; å—çš„ç»“å°¾ã€‚&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;main&lt;/span&gt;() {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; a &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Foo { f: &lt;span style=&#34;color:#a6e22e&#34;&gt;box&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt; };
    &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; x &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; &lt;span style=&#34;color:#f92672&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;mut&lt;/span&gt; Link { link: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;a&lt;/span&gt; };
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;false&lt;/span&gt; {
        &lt;span style=&#34;color:#66d9ef&#34;&gt;let&lt;/span&gt; b &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; Foo { f: &lt;span style=&#34;color:#a6e22e&#34;&gt;box&lt;/span&gt; &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt; };
        &lt;span style=&#34;color:#75715e&#34;&gt;// store_foo(x, &amp;amp;b);
&lt;/span&gt;&lt;span style=&#34;color:#75715e&#34;&gt;&lt;/span&gt;    }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;pre&gt;&lt;code class=&#34;language-nil&#34; data-lang=&#34;nil&#34;&gt;             { a x { b * } }
  resource a   |___________| pass
  resource b         |___|   fail
borrow scope     |=========|
 borrower *x     |_________| x.link = &amp;amp;a
 borrower *x           |___| x.link = &amp;amp;b
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;å¦‚æœæˆ‘ä»¬è§£é™¤æœ€åä¸€ä¸ªå‡½æ•°è°ƒç”¨ &lt;code&gt;store_foo(x, &amp;amp;b);&lt;/code&gt; ,è¿™ä¸ªå‡½æ•°å°†ä¼šå°è¯•å°† &lt;code&gt;&amp;amp;b&lt;/code&gt; å­˜å‚¨åˆ° &lt;code&gt;x.link&lt;/code&gt; ï¼Œ
å°†èµ„æº &lt;code&gt;b&lt;/code&gt; ä½œä¸ºå¦å¤–ä¸€ä¸ªè¢«å€Ÿç”¨çš„èµ„æºï¼Œç”±äº &lt;code&gt;b&lt;/code&gt; çš„ä½œç”¨åŸŸæ²¡æœ‰è¦†ç›–æ•´ä¸ªå€Ÿç”¨ä½œç”¨åŸŸï¼Œå¯¼è‡´ä¸æ»¡è¶³å€Ÿç”¨å…¬å¼ã€‚&lt;/p&gt;
&lt;h3 id=&#34;å¤šä¸ªå€Ÿç”¨ä½œç”¨åŸŸ&#34;&gt;å¤šä¸ªå€Ÿç”¨ä½œç”¨åŸŸ&lt;/h3&gt;
&lt;p&gt;ä¸€ä¸ªå‡½æ•°ä¸­å¯ä»¥å­˜åœ¨å¤šä¸ªå€Ÿç”¨ä½œç”¨åŸŸã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;superstore_foo&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt;, &lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;b&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;(x: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;mut&lt;/span&gt; Link&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;, y: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt; Foo,
                          x2: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;mut&lt;/span&gt; Link&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;b&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;, y2: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;b&lt;/span&gt; Foo) {
    x.link &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; y;
    x2.link &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; y2;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;è¿™ä¸ªçš„å‡½æ•°ï¼ˆå¯èƒ½ä¸æ˜¯ç‰¹åˆ«æœ‰ç”¨ï¼‰ä¸­ï¼Œæ¶‰åŠä¸¤ä¸ªä¸åŒçš„å€Ÿç”¨ä½œç”¨åŸŸã€‚æ¯ä¸ªå€Ÿç”¨ä½œç”¨åŸŸéƒ½æœ‰å®ƒä»¬è‡ªå·±çš„ä½œç”¨åŸŸå…¬å¼è¦æ»¡è¶³ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä¸ºä»€ä¹ˆç”Ÿå‘½å‘¨æœŸä¼šé€ æˆå›°æƒ‘&#34;&gt;ä¸ºä»€ä¹ˆç”Ÿå‘½å‘¨æœŸä¼šé€ æˆå›°æƒ‘&lt;/h2&gt;
&lt;p&gt;æœ€åï¼Œæˆ‘æƒ³è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆæˆ‘è®¤ä¸º Rust å€Ÿç”¨ç³»ç»Ÿä½¿ç”¨ &lt;strong&gt;ç”Ÿå‘½å‘¨æœŸ&lt;/strong&gt; æœ¯è¯­ä¼šé€ æˆå›°æƒ‘ï¼ˆåŒæ—¶é¿å…åœ¨è¿™ç‰‡åšæ–‡ä¸­ä½¿ç”¨å®ƒï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å½“æˆ‘ä»¬è®¨è®ºå€Ÿç”¨æ—¶ä¼šæ¶‰åŠåˆ°ä¸åŒç±»å‹çš„â€œç”Ÿå‘½å‘¨æœŸâ€ï¼š&lt;/p&gt;
&lt;p&gt;A. èµ„æºæ‰€æœ‰è€…çš„ç”Ÿå‘½å‘¨æœŸï¼ˆæˆ–è€… è¢«æ‰€æœ‰/è¢«å€Ÿç”¨ èµ„æº
B. è¢«å€Ÿç”¨çš„ç”Ÿå‘½å‘¨æœŸï¼Œi.e. ä»å¼€å§‹å€Ÿç”¨åˆ°æœ€åè¿”è¿˜
C. æ¯ä¸€ä¸ªç‹¬ç«‹çš„å€Ÿç”¨è€…æˆ–è¢«å€Ÿç”¨çš„æŒ‡é’ˆçš„ç”Ÿå‘½å‘¨æœŸ&lt;/p&gt;
&lt;p&gt;å½“æœ‰äººè¯´â€œç”Ÿå‘½å‘¨æœŸâ€ï¼Œå®ƒå¯ä»¥æŒ‡ä¸Šé¢çš„ä»»ä½•ä¸€ä¸ªã€‚å¦‚æœæ¶‰åŠå¤šä¸ªèµ„æºå’Œå€Ÿç”¨è€…å°±ä¼šå˜çš„æ›´åŠ å›°æƒ‘ã€‚
æ¯”å¦‚ï¼Œåœ¨å‡½æ•°æˆ–è€…ç»“æ„ä½“ç”Ÿå‘½ä¸­ä¸€ä¸ªâ€œå‘½åçš„ç”Ÿå‘½å‘¨æœŸâ€æŒ‡å“ªä¸ªï¼Ÿæ˜¯ Aã€B æˆ–è€… Cï¼Ÿ&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬çš„å‰ä¸€ä¸ª &lt;code&gt;max&lt;/code&gt; å‡½æ•°ä¸­ï¼š&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-rust&#34; data-lang=&#34;rust&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;fn&lt;/span&gt; &lt;span style=&#34;color:#a6e22e&#34;&gt;max&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt;(x: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt; Foo, y: &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt; Foo) -&amp;gt; &lt;span style=&#34;color:#66d9ef&#34;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&#34;color:#a6e22e&#34;&gt;&amp;#39;a&lt;/span&gt; Foo {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;if&lt;/span&gt; x.f &lt;span style=&#34;color:#f92672&#34;&gt;&amp;gt;&lt;/span&gt; y.f { x } &lt;span style=&#34;color:#66d9ef&#34;&gt;else&lt;/span&gt; { y }
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;ç”Ÿå‘½å‘¨æœŸ &lt;code&gt;&#39;a&lt;/code&gt; çš„æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿå®ƒä¸åº”è¯¥æ˜¯ Aï¼Œå› ä¸ºæ¶‰åŠä¸¤ä¸ªèµ„æºå¹¶ä¸”ä»–ä»¬æœ‰ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸã€‚ä¹Ÿä¸å¯èƒ½æ˜¯ Cï¼Œ
å› ä¸ºæœ‰ä¸‰ä¸ªå€Ÿç”¨è€…ï¼š &lt;code&gt;x&lt;/code&gt; ã€ &lt;code&gt;y&lt;/code&gt; å’Œå‡½æ•°çš„è¿”å›å€¼ï¼Œå¹¶ä¸”ä»–ä»¬ä¹Ÿéƒ½æœ‰ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸã€‚å®ƒæ˜¯ B å—ï¼Ÿå¯èƒ½ã€‚
ä½†æ˜¯æ•´ä¸ªå€Ÿç”¨ä½œç”¨åŸŸå¹¶ä¸æ˜¯ä¸€ä¸ªå…·ä½“çš„å¯¹è±¡ï¼Œå®ƒæ€ä¹ˆèƒ½æœ‰ä¸€ä¸ªâ€œç”Ÿå‘½å‘¨æœŸâ€å‘¢ï¼Ÿç§°å®ƒä¸ºç”Ÿå‘½å‘¨æœŸå°±ä¼šé€ æˆå›°æƒ‘ã€‚&lt;/p&gt;
&lt;p&gt;å¦ä¸€ç§è¯´æ³•æ˜¯å®ƒæ„å‘³ç€å¯¹è¢«å€Ÿç”¨èµ„æºçš„æœ€å°ç”Ÿå‘½å‘¨æœŸè¦æ±‚ã€‚ä¸€å®šç¨‹åº¦ä¸Šæ˜¯æœ‰é“ç†çš„ï¼Œ
ä½†æ˜¯æˆ‘ä»¬æ€ä¹ˆç§°å‘¼æœ€å°ç”Ÿå‘½å‘¨æœŸè¦æ±‚â€œç”Ÿå‘½å‘¨æœŸâ€ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ‰€æœ‰æƒ/å€Ÿç”¨æ¦‚å¿µè‡ªèº«å·²ç»å¤Ÿå¤æ‚äº†ã€‚æˆ‘ä¼šè¯´ï¼šå¯¹æœ¯è¯­â€œç”Ÿå‘½å‘¨æœŸâ€çš„å›°æƒ‘å¯¹å­¦ä¹ è¿™ä¸ªæ¦‚å¿µé€ æˆäº†æ›´å¤šçš„è«åå…¶å¦™ã€‚&lt;/p&gt;
&lt;p&gt;P.S. ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„ Aã€B å’Œ Cï¼Œå€Ÿç”¨å…¬å¼å˜æˆï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A &amp;gt;= B = C_1,UC_2U&amp;hellip;UC_n&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&#34;å­¦ä¹ -rust-æ˜¯å€¼å¾—çš„&#34;&gt;å­¦ä¹  Rust æ˜¯å€¼å¾—çš„ï¼&lt;/h2&gt;
&lt;p&gt;å°½ç®¡å€Ÿç”¨å’Œæ‰€æœ‰æƒå¯èƒ½è®©ä½ èŠ±ä¸€äº›æ—¶é—´æ¥æŒæ¡ï¼ˆto grokï¼‰ï¼Œä½†æ˜¯æ˜¯ä¸€ä¸ªéå¸¸æœ‰è¶£çš„å­¦ä¹ ã€‚Rust å°è¯•ä¸ç”¨ GC
æ¥å®ç°å†…å­˜å®‰å…¨ï¼Œå¹¶ä¸”ç›®å‰æ¥çœ‹åšçš„éå¸¸å¥½ã€‚ä¸€äº›äººè¯´ä»–ä»¬é€šè¿‡å­¦ä¹  Haskell æ”¹å˜äº†ä»–ä»¬ç¼–ç¨‹çš„æ–¹å¼ã€‚
æˆ‘è®¤ä¸ºRust åŒæ ·ä¹Ÿå€¼å¾—ä½ å­¦ä¹ ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ç¯‡åšæ–‡èƒ½æä¾›ä¸€äº›å¸®åŠ©ã€‚&lt;/p&gt;
</content>
    </item>
    
    <item>
      <title>Translate</title>
      <link>https://www.linuxzen.com/notes/articles/20200309112105_translate/</link>
      <pubDate>Mon, 09 Mar 2020 00:00:00 +0800</pubDate>
      
      <guid>https://www.linuxzen.com/notes/articles/20200309112105_translate/</guid>
      <description> Deep Learning Algorithms Rust Borrow and Lifetimes Rust Means Never Having to Close a Socket Surgical Reading: How to Read 12 Books at Once Python behind the scenes #1: how the CPython VM works Python behind the scenes #2: how the CPython compiler works Understanding Rust futures by going way too deep  </description>
      <content>&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.linuxzen.com/notes/notes/articles/20200309112133_deep_learning_algorithms/&#34;&gt;Deep Learning Algorithms&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.linuxzen.com/notes/notes/articles/20200325182450_rust_borrow_and_lifetimes/&#34;&gt;Rust Borrow and Lifetimes&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.linuxzen.com/notes/notes/notes/20200629181735-rust_means_never_having_to_close_a_socket/&#34;&gt;Rust Means Never Having to Close a Socket&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.linuxzen.com/notes/notes/articles/20200628134657-surgical_reading_how_to_read_12_books_at_once/&#34;&gt;Surgical Reading: How to Read 12 Books at Once&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.linuxzen.com/notes/notes/notes/20200908103647-python_behind_the_scenes_1_how_the_cpython_vm_works/&#34;&gt;Python behind the scenes #1: how the CPython VM works&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.linuxzen.com/notes/notes/notes/20201015182827-python_behind_the_scenes_2_how_the_cpython_compiler_works/&#34;&gt;Python behind the scenes #2: how the CPython compiler works&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.linuxzen.com/notes/notes/articles/20210726105711-understanding_rust_futures_by_going_way_too_deep/&#34;&gt;Understanding Rust futures by going way too deep&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content>
    </item>
    
    <item>
      <title>è¯‘ï¼šæ·±åº¦å­¦ä¹ ç®—æ³•ï¼šå®Œæ•´æŒ‡å—</title>
      <link>https://www.linuxzen.com/notes/articles/20200309112133_deep_learning_algorithms/</link>
      <pubDate>Mon, 09 Mar 2020 00:00:00 +0800</pubDate>
      
      <guid>https://www.linuxzen.com/notes/articles/20200309112133_deep_learning_algorithms/</guid>
      <description>åŸæ–‡é“¾æ¥ï¼šDeep Learning Algorithms : The Complete Guideã€‚
æ·±åº¦å­¦ä¹ æ­£åœ¨å½±å“æ•´ä¸ªä¸–ç•Œã€‚
æ·±åº¦å­¦ä¹ çš„ç‚’ä½œå§‹äº 2012 å¹´ï¼šä¸€ä¸ªç¥ç»ç½‘ç»œï¼ˆNeural Networkï¼‰åœ¨å›¾ç‰‡è¯†åˆ«ä»»åŠ¡ä¸Šè¡¨ç°å‡ºè¶…äººçš„æ€§èƒ½ï¼Œå¹¶ä¸”åªæœ‰å°‘æ•°äººèƒ½é¢„æµ‹å°†ä¼šå‘ç”Ÿä»€ä¹ˆã€‚
åœ¨è¿‡å» 10 å¹´ï¼Œè¶Šæ¥è¶Šå¤šçš„ç®—æ³•è½åœ°åˆ°æˆ‘ä»¬ç”Ÿæ´»ä¸­ã€‚è¶Šæ¥è¶Šå¤šçš„å…¬å¸å¼€å§‹å°†å…¶åŠ å…¥åˆ°æ—¥å¸¸ä¸šåŠ¡ä¸­ã€‚
è¿™é‡Œï¼Œæˆ‘å°è¯•è¦†ç›–è¿‘å‡ å¹´å„ç§åº”ç”¨å¦‚è®¡ç®—æœºè§†è§‰å’Œè‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNatural Language Processingï¼‰ä¸­æ‰€æ¶‰åŠçš„æ‰€æœ‰æœ€é‡è¦çš„ç®—æ³•å’Œæ„æ€ã€‚
å…¶ä¸­æœ‰ä¸€äº›ç®—æ³•æ¯”å…¶ä»–ä¸€äº›ä½¿ç”¨çš„æ›´åŠ é¢‘ç¹å¹¶ä¸”æ¯ä¸€ç§éƒ½æœ‰å…¶è‡ªèº«çš„ä¼˜ç‚¹å’Œç¼ºç‚¹ã€‚
æˆ‘çš„ä¸»è¦ç›®æ ‡æ˜¯ç»™ä½ ä¸€ä¸ªå½“å‰é¢†åŸŸé€šç”¨çš„æ€è·¯å»å¸®åŠ©ä½ ç†è§£æ¯ä¸€ç§æƒ…å†µåº”è¯¥ä½¿ç”¨ä»€ä¹ˆç®—æ³•ã€‚ å› æˆ‘çŸ¥é“å®ƒçœ‹èµ·æ¥ä¼šå¯¹ä¸€äº›ä»é›¶å¼€å§‹çš„äººé€ æˆä¸€å®šç¨‹åº¦çš„æ··ä¹±ã€‚
ä½†æ˜¯é€šè¿‡é˜…è¯»è¿™ä»½æŒ‡å—ï¼Œæˆ‘æœ‰ä¿¡å¿ƒä½ ä¼šè®¤è¯†åˆ°ä»€ä¹ˆæ˜¯ä»€ä¹ˆå¹¶ä¸”ä½ å¯ä»¥å‡†å¤‡å¥½å»ç«‹å³ä½¿ç”¨ä»–ä»¬ã€‚
æ‰€ä»¥å¦‚æœä½ æ­£åœ¨å¯»æ‰¾ä¸€ä»½æ·±åº¦å­¦ä¹ çœŸæ­£çš„å®Œæ•´æŒ‡å—ï¼Œé‚£å°±è®©æˆ‘ä»¬å¼€å§‹å§ã€‚
Contents   ä½†æ˜¯ä»€ä¹ˆæ˜¯æ·±åº¦å­¦ä¹ ?
  ç¥ç»ç½‘ç»œ
  å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆFNNï¼‰
  å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰
  å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰
  é€’å½’ç¥ç»ç½‘ç»œï¼ˆRecurisive Neural Networkï¼‰
  è‡ªç¼–ç å™¨ï¼ˆAutoEncodersï¼‰
  æ·±åº¦ä¿¡å¿µç½‘ç»œ (Deep belief network)å’Œå—é™ç»å°”å…¹æ›¼æœº (Restricted Boltzmann machine)
  ç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆGANï¼‰
  Transformers
  å›¾ç¥ç»ç½‘ç»œï¼ˆGNNï¼‰
  è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„æ·±åº¦å­¦ä¹ 
 è¯åµŒå…¥ (Word embedding) åºåˆ—å»ºæ¨¡ï¼ˆSequence Modelingï¼‰    è®¡ç®—æœºè§†è§‰ä¸­çš„æœºå™¨å­¦ä¹ </description>
      <content>&lt;p&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href=&#34;https://theaisummer.com/Deep-Learning-Algorithms/&#34;&gt;Deep Learning Algorithms : The Complete Guide&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æ·±åº¦å­¦ä¹ æ­£åœ¨å½±å“æ•´ä¸ªä¸–ç•Œã€‚&lt;/p&gt;
&lt;p&gt;æ·±åº¦å­¦ä¹ çš„ç‚’ä½œå§‹äº 2012 å¹´ï¼šä¸€ä¸ªç¥ç»ç½‘ç»œï¼ˆNeural Networkï¼‰åœ¨å›¾ç‰‡è¯†åˆ«ä»»åŠ¡ä¸Šè¡¨ç°å‡ºè¶…äººçš„æ€§èƒ½ï¼Œå¹¶ä¸”åªæœ‰å°‘æ•°äººèƒ½é¢„æµ‹å°†ä¼šå‘ç”Ÿä»€ä¹ˆã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿‡å» 10 å¹´ï¼Œè¶Šæ¥è¶Šå¤šçš„ç®—æ³•è½åœ°åˆ°æˆ‘ä»¬ç”Ÿæ´»ä¸­ã€‚è¶Šæ¥è¶Šå¤šçš„å…¬å¸å¼€å§‹å°†å…¶åŠ å…¥åˆ°æ—¥å¸¸ä¸šåŠ¡ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œï¼Œæˆ‘å°è¯•è¦†ç›–è¿‘å‡ å¹´å„ç§åº”ç”¨å¦‚è®¡ç®—æœºè§†è§‰å’Œè‡ªç„¶è¯­è¨€å¤„ç†ï¼ˆNatural Language Processingï¼‰ä¸­æ‰€æ¶‰åŠçš„æ‰€æœ‰æœ€é‡è¦çš„ç®—æ³•å’Œæ„æ€ã€‚&lt;/p&gt;
&lt;p&gt;å…¶ä¸­æœ‰ä¸€äº›ç®—æ³•æ¯”å…¶ä»–ä¸€äº›ä½¿ç”¨çš„æ›´åŠ é¢‘ç¹å¹¶ä¸”æ¯ä¸€ç§éƒ½æœ‰å…¶è‡ªèº«çš„ä¼˜ç‚¹å’Œç¼ºç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;strong&gt;æˆ‘çš„ä¸»è¦ç›®æ ‡æ˜¯ç»™ä½ ä¸€ä¸ªå½“å‰é¢†åŸŸé€šç”¨çš„æ€è·¯å»å¸®åŠ©ä½ ç†è§£æ¯ä¸€ç§æƒ…å†µåº”è¯¥ä½¿ç”¨ä»€ä¹ˆç®—æ³•ã€‚&lt;/strong&gt;&lt;/strong&gt; å› æˆ‘çŸ¥é“å®ƒçœ‹èµ·æ¥ä¼šå¯¹ä¸€äº›ä»é›¶å¼€å§‹çš„äººé€ æˆä¸€å®šç¨‹åº¦çš„æ··ä¹±ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯é€šè¿‡é˜…è¯»è¿™ä»½æŒ‡å—ï¼Œæˆ‘æœ‰ä¿¡å¿ƒä½ ä¼šè®¤è¯†åˆ°ä»€ä¹ˆæ˜¯ä»€ä¹ˆå¹¶ä¸”ä½ å¯ä»¥å‡†å¤‡å¥½å»ç«‹å³ä½¿ç”¨ä»–ä»¬ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å¦‚æœä½ æ­£åœ¨å¯»æ‰¾ä¸€ä»½æ·±åº¦å­¦ä¹ çœŸæ­£çš„å®Œæ•´æŒ‡å—ï¼Œé‚£å°±è®©æˆ‘ä»¬å¼€å§‹å§ã€‚&lt;/p&gt;
&lt;h2 id=&#34;contents&#34;&gt;Contents&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;#%E4%BD%86%E6%98%AF%E4%BB%80%E4%B9%88%E6%98%AF%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0&#34;&gt;ä½†æ˜¯ä»€ä¹ˆæ˜¯æ·±åº¦å­¦ä¹ ?&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;#%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C&#34;&gt;ç¥ç»ç½‘ç»œ&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;#%E5%89%8D%E9%A6%88%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C-fnn&#34;&gt;å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆFNNï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;#%E5%8D%B7%E7%A7%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C-cnn&#34;&gt;å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;#%E5%BE%AA%E7%8E%AF%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C-rnn&#34;&gt;å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;#%E9%80%92%E5%BD%92%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C&#34;&gt;é€’å½’ç¥ç»ç½‘ç»œ&lt;/a&gt;ï¼ˆRecurisive Neural Networkï¼‰&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;#%E8%87%AA%E7%BC%96%E7%A0%81%E5%99%A8-autoencoders&#34;&gt;è‡ªç¼–ç å™¨ï¼ˆAutoEncodersï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;#%E6%B7%B1%E5%BA%A6%E4%BF%A1%E5%BF%B5%E7%BD%91%E7%BB%9C--deep-belief-network--%E5%92%8C%E5%8F%97%E9%99%90%E7%8E%BB%E5%B0%94%E5%85%B9%E6%9B%BC%E6%9C%BA--restricted-boltzmann-machine&#34;&gt;æ·±åº¦ä¿¡å¿µç½‘ç»œ (Deep belief network)å’Œå—é™ç»å°”å…¹æ›¼æœº (Restricted Boltzmann machine)&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;#%E7%94%9F%E6%88%90%E5%AF%B9%E6%8A%97%E7%BD%91%E7%BB%9C-gan&#34;&gt;ç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆGANï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;#transformers&#34;&gt;Transformers&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;#%E5%9B%BE%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C-gnn&#34;&gt;å›¾ç¥ç»ç½‘ç»œï¼ˆGNNï¼‰&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;#%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E5%A4%84%E7%90%86%E4%B8%AD%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0&#34;&gt;è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„æ·±åº¦å­¦ä¹ &lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#%E8%AF%8D%E5%B5%8C%E5%85%A5--word-embedding&#34;&gt;è¯åµŒå…¥ (Word embedding)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#%E5%BA%8F%E5%88%97%E5%BB%BA%E6%A8%A1-sequence-modeling&#34;&gt;åºåˆ—å»ºæ¨¡ï¼ˆSequence Modelingï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;#%E8%AE%A1%E7%AE%97%E6%9C%BA%E8%A7%86%E8%A7%89%E4%B8%AD%E7%9A%84%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0&#34;&gt;è®¡ç®—æœºè§†è§‰ä¸­çš„æœºå™¨å­¦ä¹ &lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;#%E6%9C%AC%E5%9C%B0%E5%8C%96%E5%92%8C%E7%89%A9%E4%BD%93%E8%AF%86%E5%88%AB&#34;&gt;æœ¬åœ°åŒ–å’Œç‰©ä½“è¯†åˆ«&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#%E5%8D%95%E5%8F%91%E6%8E%A2%E6%B5%8B%E5%99%A8-single-shot-detectors&#34;&gt;å•å‘æ¢æµ‹å™¨ï¼ˆSingle shot detectorsï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#%E8%AF%AD%E4%B9%89%E5%88%86%E5%89%B2-semantic-segmentation&#34;&gt;è¯­ä¹‰åˆ†å‰²ï¼ˆSemantic Segmentationï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;#%E5%A7%BF%E5%8A%BF%E4%BC%B0%E8%AE%A1-pose-estimation&#34;&gt;å§¿åŠ¿ä¼°è®¡ï¼ˆPose Estimationï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ·±åº¦å­¦ä¹ åœ¨ç§‘å­¦å’Œä¼ä¸šç•Œå–å¾—äº†&lt;a href=&#34;https://theaisummer.com/Deep%5Flearning/&#34;&gt;ç–¯ç‹‚çš„äººæ°”&lt;/a&gt;ã€‚ä» 2012ï¼Œå·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰åœ¨å›¾åƒè¯†åˆ«ç«èµ›ï¼ˆ ImageNet Large Scale Visual Recognition Challengeï¼‰ä¸­è·å¾—äº†æƒŠäººçš„å‡†ç¡®æ€§ï¼Œ&lt;a href=&#34;https://www.technologyreview.com/s/612768/we-analyzed-16625-papers-to-figure-out-where-ai-is-headed-next/&#34;&gt;æ¯å¹´éƒ½å‡ºç°äº†è¶Šæ¥è¶Šå¤šçš„ç ”ç©¶è®ºæ–‡&lt;/a&gt;å¹¶ä¸”è¶Šæ¥è¶Šå¤šçš„ä¼ä¸šå°†ç¥ç»ç½‘ç»œæ”¶å½•åˆ°ä»–ä»¬çš„ä¸šåŠ¡ä¸­ã€‚æ®ä¼°è®¡ï¼Œæ·±åº¦å­¦ä¹ ç›®å‰çš„å¸‚åœºè§„æ¨¡ä¸º 25 äº¿ï¼Œé¢„è®¡åˆ° 2023 å¹´å°†è¾¾åˆ° 181.6 äº¿ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ä½†æ˜¯ä»€ä¹ˆæ˜¯æ·±åº¦å­¦ä¹ &#34;&gt;ä½†æ˜¯ä»€ä¹ˆæ˜¯æ·±åº¦å­¦ä¹ ?&lt;/h2&gt;
&lt;p&gt;æ ¹æ®&lt;a href=&#34;https://zh.wikipedia.org/wiki/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0&#34;&gt;ç»´åŸºç™¾ç§‘&lt;/a&gt;ï¼šã€Œæ·±åº¦å­¦ä¹ ï¼ˆè‹±èªï¼šdeep learningï¼‰æ˜¯æœºå™¨å­¦ä¹ çš„åˆ†æ”¯ï¼Œæ˜¯ä¸€ç¨®ä»¥äººå·¥ç¥ç¶“ç¶²è·¯ç‚ºæ¶æ§‹ï¼Œå°è³‡æ–™é€²è¡Œè¡¨å¾µå­¸ç¿’çš„ç®—æ³•ã€‚ã€&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘çœ‹æ¥ï¼Œ &lt;strong&gt;&lt;strong&gt;æ·±åº¦å­¦ä¹ æ˜¯ä¸€ç³»åˆ—å¯å‘äºäººè„‘åœ¨å¤„ç†æ•°æ®å’Œåˆ›å»ºç”¨äºå†³ç­–çš„æ¨¡å¼æ–¹é¢çš„å·¥ä½œçš„ç®—æ³•çš„é›†åˆï¼Œè¿™æ˜¯å¯¹æˆä¸ºäººå·¥ç¥ç»ç½‘ç»œï¼ˆArtificial Neural Networkï¼‰å¾—å•ä¸€æ¨¡å‹æ¶æ„çš„æ€æƒ³çš„æ‰©å±•å’Œæ”¹è¿›ã€‚&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id=&#34;ç¥ç»ç½‘ç»œ&#34;&gt;ç¥ç»ç½‘ç»œ&lt;/h2&gt;
&lt;p&gt;&lt;a href=&#34;http://karpathy.github.io/neuralnets/&#34;&gt;ç¥ç»ç½‘ç»œï¼ˆNeural Networksï¼‰&lt;/a&gt;å°±åƒäººè„‘ä¸€æ ·ç”±ç¥ç»å…ƒç»„æˆã€‚æ¯ä¸€ä¸ªç¥ç»å…ƒæ¥æ”¶ä¿¡å·ä½œä¸ºè¾“å…¥ï¼Œç”¨æƒé‡ç›¸ä¹˜ï¼Œå¯¹å®ƒä»¬æ±‚å’Œå¹¶åº”ç”¨éçº¿æ€§å‡½æ•°ã€‚è¿™äº›ç¥ç»å…ƒå½¼æ­¤ç›¸é‚»å †å å¹¶åˆ†å±‚ç»„ç»‡ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯é€šè¿‡è¿™äº›æˆ‘ä»¬èƒ½åšäº›ä»€ä¹ˆå‘¢ï¼Ÿ&lt;/p&gt;

  &lt;figure class=&#34;left&#34; &gt;
    &lt;img src=&#34;https://www.linuxzen.com/notes/images/deep-learning-complete-guide/neuron.jpg&#34;   /&gt;
    
  &lt;/figure&gt;


&lt;p&gt;äº‹å®è¯æ˜ï¼Œç¥ç»ç½‘ç»œæ˜¯å‡ºè‰²çš„ &lt;strong&gt;&lt;strong&gt;å‡½æ•°é€¼è¿‘å™¨ï¼ˆfunction approximatorsï¼‰&lt;/strong&gt;&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥å‡è®¾æ¯ä¸€ä¸ªè¡Œä¸ºå’Œç³»ç»Ÿå¯ä»¥æœ€ç»ˆè¢«è¡¨ç¤ºä¸ºä¸€ä¸ªæ•°å­¦å‡½æ•°ï¼ˆå¯èƒ½ä¼šå¼‚å¸¸å¤æ‚ï¼‰ã€‚å¦‚ä½•æˆ‘ä»¬è®¾æ³•æ‰¾åˆ°è¯¥å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä»æœ¬è´¨ä¸Šç†è§£ç³»ç»Ÿçš„æ‰€æœ‰å†…å®¹ã€‚ä½†æ˜¯æ‰¾åˆ°è¯¥å‡½æ•°å¯èƒ½éå¸¸å›°éš¾ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å¯¹å…¶è¿›è¡Œä¼°ç®—ã€‚è¾“å…¥ç¥ç»ç½‘ç»œã€‚&lt;/p&gt;
&lt;h3 id=&#34;åå‘ä¼ æ’­-backpropagation&#34;&gt;åå‘ä¼ æ’­ï¼ˆBackpropagationï¼‰&lt;/h3&gt;
&lt;p&gt;ç¥ç»ç½‘ç»œå¯ä»¥ä½¿ç”¨å¤§é‡æ•°æ®å’Œè¢«ç§°ä¸º &lt;a href=&#34;https://brilliant.org/wiki/backpropagation/&#34;&gt;backpropagation&lt;/a&gt; çš„ç®—æ³•å­¦ä¹ æè¿°å‡½æ•°ã€‚æˆ‘ä»¬å°†æ•°æ®è¾“å…¥åˆ°ç½‘ç»œï¼Œå®ƒç”Ÿäº§è¾“å‡ºï¼Œæˆ‘ä»¬å°†è¯¥è¾“å‡ºä¸æ‰€éœ€çš„è¾“å‡ºè¿›è¡Œå¯¹æ¯”ï¼ˆä½¿ç”¨æŸå¤±å‡½æ•°ï¼ˆloss functionï¼‰ï¼‰ï¼Œç„¶åæˆ‘ä»¬æ ¹æ®å·®å¼‚å†è°ƒæ•´æƒé‡ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åä¸€ç›´é‡å¤ã€‚ä½¿ç”¨ç§°ä¸ºéšæœºæ¢¯åº¦ä¸‹é™ï¼ˆ&lt;a href=&#34;https://ruder.io/optimizing-gradient-descent/&#34;&gt;stochastic gradient descent&lt;/a&gt;ï¼‰çš„éçº¿æ€§ä¼˜åŒ–æŠ€æœ¯æ‰§è¡Œæƒé‡çš„è°ƒæ•´ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€æ®µæ—¶é—´ä¹‹åï¼Œç½‘ç»œå°†åœ¨ç”Ÿäº§è¾“å‡ºä¸Šå˜çš„è¶³å¤Ÿå¥½ã€‚å› æ­¤ï¼Œè®­ç»ƒæ¥ç»“æŸäº†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬è®¾æ³•æ¥è¿‘æˆ‘ä»¬çš„å‡½æ•°ã€‚å¦‚æœæˆ‘ä»¬å°†è¾“å‡ºæœªçŸ¥çš„è¾“å…¥ä¼ é€’ç»™ç½‘ç»œï¼Œå®ƒä¼šåŸºäºè¿‘ä¼¼å‡½æ•°ï¼ˆapproximated functionï¼‰ç»™æˆ‘ä»¬ä¸€ä¸ªç­”æ¡ˆã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­è®©å…¶æ›´å®¹æ˜“ç†è§£ã€‚æ¯”å¦‚åŸºäºä¸€äº›åŸå› æˆ‘ä»¬æƒ³é‰´åˆ«ä¸€å¼ å›¾ç‰‡ä¸­æ˜¯å¦æœ‰æ ‘ã€‚æˆ‘ä»¬å°†ä»»æ„ç±»å‹çš„å›¾ç‰‡è¾“å…¥åˆ°ç½‘ç»œç„¶åç½‘ç»œäº§ç”Ÿè¾“å‡ºã€‚ç”±äºæˆ‘ä»¬çŸ¥é“ä¸€å¼ å›¾ç‰‡æ˜¯å¦åŒ…å«æ ‘ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹æ¯”ç½‘ç»œè¾“å‡ºå’Œäº‹å®å¹¶è°ƒæ•´ç½‘ç»œã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡è¶Šæ¥è¶Šå¤šçš„å›¾ç‰‡è¾“å…¥åˆ°ç½‘ç»œï¼Œç½‘ç»œå°†ä¼šè¶Šæ¥è¶Šç²¾å‡†ã€‚ç°åœ¨æˆ‘ä»¬è¾“å…¥ä¸€å¼ æœªçŸ¥çš„å›¾ç‰‡ï¼Œç„¶åå®ƒå°±ä¼šå‘Šè¯‰æˆ‘ä»¬å›¾ç‰‡ä¸­æ˜¯å¦åŒ…å«æ ‘ã€‚å¾ˆé…·å¯¹å§ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å¤šå¹´æ¥ï¼Œç ”ç©¶äººå‘˜å¯¹åŸå§‹æƒ³æ³•è¿›è¡Œäº†æƒŠäººçš„æ”¹è¿›ã€‚æ¯ç§æ–°æ¶æ„éƒ½é’ˆå¯¹ç‰¹å®šé—®é¢˜å®ç°äº†æ›´é«˜çš„å‡†ç¡®æ€§å’Œé€Ÿåº¦ã€‚æˆ‘ä»¬å°†æ‰€æœ‰è¿™äº›æ–°æ¨¡å‹å½’ä¸ºç‰¹å®šçš„ç±»åˆ«ï¼š&lt;/p&gt;
&lt;h2 id=&#34;å‰é¦ˆç¥ç»ç½‘ç»œ-fnn&#34;&gt;å‰é¦ˆç¥ç»ç½‘ç»œï¼ˆFNNï¼‰&lt;/h2&gt;
&lt;p&gt;FNN é€šå¸¸æ˜¯å…¨éƒ¨è¿æ¥çš„ï¼ˆ&lt;a href=&#34;https://theaisummer.com/Neural%5FNetwork%5Ffrom%5Fscratch/&#34;&gt;fully connected&lt;/a&gt;ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´å±‚ä¸­çš„æ¯ä¸€ä¸ªç¥ç»å…ƒéƒ½ä¸ä¸‹ä¸€å±‚ä¸­å…¶ä»–ç¥ç»å…ƒç›¸è¿ã€‚æ‰€æè¿°çš„ç»“æ„è¢«ç§°ä¸ºå¤šå±‚æ„ŸçŸ¥å™¨ (Multilayer Perceptron)ï¼Œèµ·æºäº 1958ã€‚å•å±‚æ„ŸçŸ¥å™¨åªèƒ½å­¦ä¹ çº¿æ€§å¯åˆ†ç¦»æ¨¡å¼ï¼Œä½†æ˜¯ä¸€ä¸ªå¤šå±‚æ„ŸçŸ¥å™¨å¯ä»¥å­¦ä¹ æ•°æ®é—´çš„éçº¿æ€§å…³ç³»ã€‚&lt;/p&gt;

  &lt;figure class=&#34;left&#34; &gt;
    &lt;img src=&#34;https://www.linuxzen.com/notes/images/deep-learning-complete-guide/neural-network.png&#34;   /&gt;
    
  &lt;/figure&gt;


&lt;p&gt;å®ƒä»¬åœ¨åˆ†ç±»å’Œå›å½’ç­‰ä»»åŠ¡ä¸Šè¡¨ç°çš„å¼‚å¸¸çš„å¥½ã€‚ä¸å…¶ä»–æœºå™¨å­¦ä¹ ç®—æ³•ç›¸åï¼Œå®ƒä»¬å¹¶ä¸é‚£ä¹ˆå®¹æ˜“æ”¶æ•›ã€‚å®ƒä»¬æ‹¥æœ‰çš„æ•°æ®è¶Šå¤šï¼Œå…¶å‡†ç¡®æ€§å°±è¶Šé«˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å·ç§¯ç¥ç»ç½‘ç»œ-cnn&#34;&gt;å·ç§¯ç¥ç»ç½‘ç»œï¼ˆCNNï¼‰&lt;/h2&gt;
&lt;p&gt;CNN é‡‡ç”¨äº†ä¸€ä¸ªå«åš&lt;a href=&#34;https://theaisummer.com/Neural%5FNetwork%5Ffrom%5Fscratch%5Fpart2/&#34;&gt;å·ç§¯ï¼ˆconvolutionï¼‰&lt;/a&gt;çš„å‡½æ•°ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å¾ªç¯ç¥ç»ç½‘ç»œ-rnn&#34;&gt;å¾ªç¯ç¥ç»ç½‘ç»œï¼ˆRNNï¼‰&lt;/h2&gt;
&lt;h2 id=&#34;é€’å½’ç¥ç»ç½‘ç»œ&#34;&gt;é€’å½’ç¥ç»ç½‘ç»œ&lt;/h2&gt;
&lt;h2 id=&#34;è‡ªç¼–ç å™¨-autoencoders&#34;&gt;è‡ªç¼–ç å™¨ï¼ˆAutoEncodersï¼‰&lt;/h2&gt;
&lt;h2 id=&#34;æ·±åº¦ä¿¡å¿µç½‘ç»œ--deep-belief-network--å’Œå—é™ç»å°”å…¹æ›¼æœº--restricted-boltzmann-machine&#34;&gt;æ·±åº¦ä¿¡å¿µç½‘ç»œ (Deep belief network)å’Œå—é™ç»å°”å…¹æ›¼æœº (Restricted Boltzmann machine)&lt;/h2&gt;
&lt;h2 id=&#34;ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ-gan&#34;&gt;ç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼ˆGANï¼‰&lt;/h2&gt;
&lt;h2 id=&#34;transformers&#34;&gt;Transformers&lt;/h2&gt;
&lt;h2 id=&#34;å›¾ç¥ç»ç½‘ç»œ-gnn&#34;&gt;å›¾ç¥ç»ç½‘ç»œï¼ˆGNNï¼‰&lt;/h2&gt;
&lt;h2 id=&#34;è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„æ·±åº¦å­¦ä¹ &#34;&gt;è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„æ·±åº¦å­¦ä¹ &lt;/h2&gt;
&lt;h3 id=&#34;è¯åµŒå…¥--word-embedding&#34;&gt;è¯åµŒå…¥ (Word embedding)&lt;/h3&gt;
&lt;h3 id=&#34;åºåˆ—å»ºæ¨¡-sequence-modeling&#34;&gt;åºåˆ—å»ºæ¨¡ï¼ˆSequence Modelingï¼‰&lt;/h3&gt;
&lt;h2 id=&#34;è®¡ç®—æœºè§†è§‰ä¸­çš„æœºå™¨å­¦ä¹ &#34;&gt;è®¡ç®—æœºè§†è§‰ä¸­çš„æœºå™¨å­¦ä¹ &lt;/h2&gt;
&lt;h3 id=&#34;æœ¬åœ°åŒ–å’Œç‰©ä½“è¯†åˆ«&#34;&gt;æœ¬åœ°åŒ–å’Œç‰©ä½“è¯†åˆ«&lt;/h3&gt;
&lt;h3 id=&#34;å•å‘æ¢æµ‹å™¨-single-shot-detectors&#34;&gt;å•å‘æ¢æµ‹å™¨ï¼ˆSingle shot detectorsï¼‰&lt;/h3&gt;
&lt;h3 id=&#34;è¯­ä¹‰åˆ†å‰²-semantic-segmentation&#34;&gt;è¯­ä¹‰åˆ†å‰²ï¼ˆSemantic Segmentationï¼‰&lt;/h3&gt;
&lt;h3 id=&#34;å§¿åŠ¿ä¼°è®¡-pose-estimation&#34;&gt;å§¿åŠ¿ä¼°è®¡ï¼ˆPose Estimationï¼‰&lt;/h3&gt;
</content>
    </item>
    
    <item>
      <title>Taking Smart Notes With Org-mode</title>
      <link>https://www.linuxzen.com/notes/articles/notes/</link>
      <pubDate>Sat, 07 Mar 2020 00:00:00 +0800</pubDate>
      
      <guid>https://www.linuxzen.com/notes/articles/notes/</guid>
      <description>See also:
 https://praxis.fortelabs.co/how-to-take-smart-notes/ https://www.nateliason.com/blog/roam  Topics  Financial Management è¯»ä¹¦ç¬”è®° æŠ€æœ¯ Translate Learning English è®¤åŒçš„è¯ To Complete  Links Sprint 1:2019-02-03 ~ 2019-02-19   LD_PRELOAD: The Hero We Need and Deserve
é€šè¿‡ LD_PRELOAD è¦†ç›–ä¸€äº›å‡½æ•°ï¼Œæ¯”å¦‚ faketime
  Going Solo, Successfully
  å˜èº«æˆä¸ºç‹¬ç«‹å¼€å‘è€…ã€‚
  Graceful Shutdown
  Why limiting work-in-progress works
  Practical Go: Real world advice for writing maintainable Go programs
è¯‘æ–‡ï¼šhttps://github.com/llitfkitfk/go-best-practice
  ç™¾ä¸‡ Go TCP è¿æ¥çš„æ€è€ƒ: epollæ–¹å¼å‡å°‘èµ„æºå ç”¨</description>
      <content>&lt;p&gt;See also:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://praxis.fortelabs.co/how-to-take-smart-notes/&#34;&gt;https://praxis.fortelabs.co/how-to-take-smart-notes/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.nateliason.com/blog/roam&#34;&gt;https://www.nateliason.com/blog/roam&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;topics&#34;&gt;Topics&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.linuxzen.com/notes/notes/notes/20200224132507/&#34;&gt;Financial Management&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.linuxzen.com/notes/notes/notes/20200307114122_%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/&#34;&gt;è¯»ä¹¦ç¬”è®°&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.linuxzen.com/notes/notes/notes/20200323104645_%E6%8A%80%E6%9C%AF/&#34;&gt;æŠ€æœ¯&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.linuxzen.com/notes/notes/articles/20200309112105_translate/&#34;&gt;Translate&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.linuxzen.com/notes/notes/notes/20210317141621-learning_english/&#34;&gt;Learning English&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.linuxzen.com/notes/notes/notes/20210612092853-%E8%AE%A4%E5%90%8C%E7%9A%84%E8%AF%9D/&#34;&gt;è®¤åŒçš„è¯&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.linuxzen.com/notes/notes/notes/20210728071540-to_complete/&#34;&gt;To Complete&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;links&#34;&gt;Links&lt;/h2&gt;
&lt;h3 id=&#34;sprint-1-2019-02-03-2019-02-19&#34;&gt;Sprint 1:2019-02-03 ~ 2019-02-19&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://blog.jessfraz.com/post/ld%5Fpreload/&#34;&gt;LD_PRELOAD: The Hero We Need and Deserve&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é€šè¿‡ LD_PRELOAD è¦†ç›–ä¸€äº›å‡½æ•°ï¼Œæ¯”å¦‚ &lt;a href=&#34;https://github.com/wolfcw/libfaketime&#34;&gt;faketime&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://kev.inburke.com/kevin/going-solo-successfully/?hn&#34;&gt;Going Solo, Successfully&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å˜èº«æˆä¸ºç‹¬ç«‹å¼€å‘è€…ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://250bpm.com/blog:146&#34;&gt;Graceful Shutdown&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://lethain.com/limiting-wip/&#34;&gt;Why limiting work-in-progress works&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://dave.cheney.net/practical-go/presentations/qcon-china.html&#34;&gt;Practical Go: Real world advice for writing maintainable Go programs&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¯‘æ–‡ï¼š&lt;a href=&#34;https://github.com/llitfkitfk/go-best-practice&#34;&gt;https://github.com/llitfkitfk/go-best-practice&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://colobu.com/2019/02/23/1m-go-tcp-connection/&#34;&gt;ç™¾ä¸‡ Go TCP è¿æ¥çš„æ€è€ƒ: epollæ–¹å¼å‡å°‘èµ„æºå ç”¨&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.jianshu.com/p/cceaaaf5d154&#34;&gt;å¤©æ± ä¸­é—´ä»¶å¤§èµ›Golangç‰ˆService Meshæ€è·¯åˆ†äº«&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://zeroequalsfalse.press/posts/programming-books-you-wish-you-read-earlier/&#34;&gt;Programming Books You Wish You Read Earlier&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ai-machine-learning-books&#34;&gt;AI/Machine Learning Books&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://cs229.stanford.edu/notes/cs229-notes1.pdf&#34;&gt;http://cs229.stanford.edu/notes/cs229-notes1.pdf&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://courses.csail.mit.edu/6.042/spring17/mcs.pdf&#34;&gt;https://courses.csail.mit.edu/6.042/spring17/mcs.pdf&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://bestofml.com/&#34;&gt;http://bestofml.com/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ascii-art&#34;&gt;ASCII Art&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.jianshu.com/p/fca56d635091&#34;&gt;https://www.jianshu.com/p/fca56d635091&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;sprint-2-2019-02-27-2019-03-12&#34;&gt;Sprint 2: 2019-02-27 ~ 2019-03-12&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://blogtitle.github.io/some-useful-patterns/&#34;&gt;Some useful patterns&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¯‘æ–‡ï¼š&lt;a href=&#34;https://colobu.com/2019/02/25/some-useful-patterns-in-go/&#34;&gt;Goå¼€å‘ä¸­ä¸€äº›æœ‰ç”¨çš„æ¨¡å¼&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://immersivemath.com/ila/learnmore.html&#34;&gt;immersive linear algebra&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;æ²‰æµ¸å¼çº¿æ€§ä»£æ•°&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://bofh.org.uk/2019/02/25/baking-with-emacs/&#34;&gt;Running a bakery on Emacs and PostgreSQL&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;é€šè¿‡ Emacs org-mode è®°å½•é¢åŒ…é…æ–¹&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://devs.cloudimmunity.com/gotchas-and-common-mistakes-in-go-golang/index.html&#34;&gt;50 Shades of Go: Traps, Gotchas, and Common Mistakes for New Golang Devs&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Go è¯­è¨€é™·é˜±å’Œå‘ï¼ˆGotchaï¼‰ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://go-traps.appspot.com/&#34;&gt;https://go-traps.appspot.com/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://programmerfriend.com/index.php/2019/03/01/git-best-practices/&#34;&gt;Git Best Practices&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://cs.lmu.edu/~ray/notes/nasmtutorial/&#34;&gt;NASM Tutorial&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.ibm.com/developerworks/cn/linux/l-gas-nasm.html&#34;&gt;Linux æ±‡ç¼–å™¨ï¼šå¯¹æ¯” GAS å’Œ NASM&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;http://bestofml.com/&#34;&gt;Best of Machine Learning&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://quickchart.io/&#34;&gt;Generate a Chart Image from URL&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://nullprogram.com/blog/2019/03/10/&#34;&gt;An Async / Await Library for Emacs Lisp&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;sprint-3-2019-03-13-2019-03-26&#34;&gt;Sprint 3: 2019-03-13 ~ 2019-03-26&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.remove.bg/&#34;&gt;Remove Image Background&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://leandromoreira.com.br/2019/01/25/how-to-build-a-distributed-throttling-system-with-nginx-lua-redis/&#34;&gt;How to build a distributed throttling system with Nginx + Lua + Redis&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://architecture-database.blogspot.com/&#34;&gt;How Database works&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://rust-lang-nursery.github.io/rust-cookbook/&#34;&gt;Rust Cookbook&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://dwheeler.com/essays/fixing-unix-linux-filenames.html&#34;&gt;Fixing Unix/Linux/POSIX Filenames&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;online-diagrams&#34;&gt;Online Diagrams&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://chartmage.com/intro.html&#34;&gt;Generate sequence diagrams and flowcharts at lightning speed.&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://bramp.github.io/js-sequence-diagrams/&#34;&gt;js-sequence-diagrams&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://flowchart.js.org/&#34;&gt;flowchart.js&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.zybuluo.com/cmd/&#34;&gt;Cmd Markdown&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://plantuml.com/zh/running&#34;&gt;Plantuml&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.yuque.com/yuque/help/editor-puml&#34;&gt;è¯­é›€&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.graphviz.org/&#34;&gt;Graphviz&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://haha98k.com/&#34;&gt;PlantUML Editor&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.websequencediagrams.com/&#34;&gt;https://www.websequencediagrams.com/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;animating-urls-with-javascript-and-emojis&#34;&gt;Animating URLs with Javascript and Emojis&lt;/h3&gt;
&lt;p&gt;&lt;a href=&#34;http://matthewrayfield.com/articles/animating-urls-with-javascript-and-emojis/&#34;&gt;http://matthewrayfield.com/articles/animating-urls-with-javascript-and-emojis/&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;x86&#34;&gt;x86&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://fsl.cs.illinois.edu/index.php/A%5FComplete%5FFormal%5FSemantics%5Fof%5Fx86-64%5FUser-Level%5FInstruction%5FSet%5FArchitecture&#34;&gt;A Complete Formal Semantics of x86-64 User-Level Instruction Set Architecture&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;others&#34;&gt;Others&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://learn.sparkfun.com/tutorials/how-to-read-a-schematic&#34;&gt;How to Read a Schematic&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://castel.dev/post/lecture-notes-2/#&#34;&gt;How I draw figures for my mathematical lecture notes using Inkscape&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;å¸ƒéš†è¿‡æ»¤å™¨&#34;&gt;å¸ƒéš†è¿‡æ»¤å™¨&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://llimllib.github.io/bloomfilter-tutorial/zh%5FCN/&#34;&gt;https://llimllib.github.io/bloomfilter-tutorial/zh%5FCN/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;rust&#34;&gt;Rust&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://way-cooler.org/blog/2019/04/29/rewriting-way-cooler-in-c.html&#34;&gt;Giving up on wlroots-rs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;memory-management&#34;&gt;Memory Management&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.microsoft.com/en-us/research/wp-content/uploads/2017/03/kedia2017mem.pdf&#34;&gt;Simple, Fast and Safe Manual Memory Management&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://akkadia.org/drepper/cpumemory.pdf&#34;&gt;What Every Programmer Should Know About Memory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.vldb.org/pvldb/vol8/p37-graefe.pdf&#34;&gt;In-Memory Performance for Big Data&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;pie-pic-load-time-relocation-hardenedlinux&#34;&gt;PIE/PIC/Load-time relocation/Hardenedlinux&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://hardenedlinux.github.io/system-security/2016/07/01/PIC%5FPIE%5Fand%5FASLR%5Fanalysis.html&#34;&gt;https://hardenedlinux.github.io/system-security/2016/07/01/PIC%5FPIE%5Fand%5FASLR%5Fanalysis.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.ibm.com/developerworks/cn/linux/l-seclnx3/index.html&#34;&gt;https://www.ibm.com/developerworks/cn/linux/l-seclnx3/index.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://wiki.archlinux.org/index.php/security#Rebuilding%5Fpackages&#34;&gt;https://wiki.archlinux.org/index.php/security#Rebuilding%5Fpackages&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;math&#34;&gt;Math&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://ourway.keybase.pub/mathematics%5Fcheat%5Fsheet.pdf&#34;&gt;https://ourway.keybase.pub/mathematics%5Fcheat%5Fsheet.pdf&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;ai&#34;&gt;AI&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=Jnunp-EymJQ&amp;amp;feature=youtu.be&#34;&gt;Flexible ML Systems&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://arxiv.org/pdf/1801.01442.pdf&#34;&gt;https://arxiv.org/pdf/1801.01442.pdf&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;common-lisp&#34;&gt;Common Lisp&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://www.quicklisp.org/beta/&#34;&gt;Quicklisp&lt;/a&gt; åŒ…ç®¡ç†&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://ultralisp.org/&#34;&gt;Ultralisp&lt;/a&gt; åŒ…ç®¡ç†å¢å¼º&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&#34;https://github.com/takagi/lake&#34;&gt;Lake&lt;/a&gt; ç±»ä¼¼ Makefile çš„ Common Lisp å·¥å…·&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</content>
    </item>
    
  </channel>
</rss>
