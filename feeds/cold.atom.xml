<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom"><title>cold's world - cold</title><link href="https://www.linuxzen.com/" rel="alternate"></link><link href="https://www.linuxzen.com/feeds/cold.atom.xml" rel="self"></link><id>https://www.linuxzen.com/</id><updated>2021-12-21T00:00:00+08:00</updated><subtitle>çº¸ä¸Šå¾—æ¥ç»ˆè§‰æµ…ï¼Œç»çŸ¥æ­¤äº‹è¦èº¬è¡Œ</subtitle><entry><title>Rust actix-web Extractors ç ”ç©¶</title><link href="https://www.linuxzen.com/rust-actix-web-extractors.html" rel="alternate"></link><published>2021-12-21T00:00:00+08:00</published><updated>2021-12-21T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2021-12-21:/rust-actix-web-extractors.html</id><content type="html">&lt;p&gt;å‚è§ &lt;a href="https://www.linuxzen.com/notes/articles/20211221174651-actix_web_extractor/"&gt;actix-web extractors æ”¯æŒæå–ä»»æ„é•¿åº¦çš„å‚æ•°&lt;/a&gt;ã€‚&lt;/p&gt;</content><category term="Rust"></category><category term="Rust"></category><category term="actix-web"></category><category term="trait"></category></entry><entry><title>ã€è¯‘ã€‘æ·±å…¥ç†è§£ Rust future</title><link href="https://www.linuxzen.com/understanding-rust-futures-by-going-way-too-deep.html" rel="alternate"></link><published>2021-07-29T00:00:00+08:00</published><updated>2021-07-29T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2021-07-29:/understanding-rust-futures-by-going-way-too-deep.html</id><summary type="html">&lt;p&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href="https://fasterthanli.me/articles/understanding-rust-futures-by-going-way-too-deep"&gt;Understanding Rust futures by going way too deep&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šåŸæ–‡å¤§é‡çš„å¼•å…¥äº†æœ‰è¶£çš„å¯¹è¯ï¼Œè¿«äºæ’ç‰ˆé—®é¢˜è¿™é‡Œä¸è¿›è¡Œç¿»è¯‘ï¼Œå¿…è¦çš„å¯¹è¯é€šè¿‡å¼•ç”¨ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href="https://fasterthanli.me/articles/understanding-rust-futures-by-going-way-too-deep"&gt;Understanding Rust futures by going way too deep&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šåŸæ–‡å¤§é‡çš„å¼•å…¥äº†æœ‰è¶£çš„å¯¹è¯ï¼Œè¿«äºæ’ç‰ˆé—®é¢˜è¿™é‡Œä¸è¿›è¡Œç¿»è¯‘ï¼Œå¿…è¦çš„å¯¹è¯é€šè¿‡å¼•ç”¨å—æ¥è§£é‡Šã€‚&lt;/p&gt;
&lt;h2 id="æ·±å…¥ç†è§£-rust-future"&gt;æ·±å…¥ç†è§£ Rust future&lt;/h2&gt;
&lt;p&gt;ç”¨ Rust futureï¼å°±æ˜¯è¿™ä¹ˆç®€å•ï¼ç›´åˆ°æˆ‘ä»¬å‘ç°å¹¶éå¦‚æ­¤ã€‚æ‰€ä»¥æˆ‘ä»¬å…ˆæ¢ç´¢ç®€å•çš„éƒ¨åˆ†ï¼Œç„¶åç»§ç»­æ¢ç´¢å›°éš¾éƒ¨åˆ†è€Œä¸æ˜¯ç­‰å®ƒæ…¢æ…¢é è¿‘æˆ‘ä»¬ã€‚&lt;/p&gt;
&lt;h2 id="èµ·æ­¥"&gt;èµ·æ­¥&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;Choo choo here comes the easy part ğŸš‚ğŸ’¨&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ–°çš„é¡¹ç›®ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;Created&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;binary&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;application&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`waytoodeep`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;package&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬éœ€è¦å®‰è£… &lt;code&gt;cargo-edit&lt;/code&gt; å¦‚æœä¹‹å‰æ²¡æœ‰å®‰è£…è¿‡çš„è¯ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥ç›´æ¥ &lt;code&gt;cargo add&lt;/code&gt; ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;install&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;edit&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Updating&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;crates&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;io&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;Downloaded&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;edit&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;v0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;7.0&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;Downloaded&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;crate&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;57.6&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;KB&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.47&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;Ignored&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;package&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;edit&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;v0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;7.0&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;already&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;installed&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;force&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;override&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;blockquote&gt;
&lt;p&gt;å› ä¸º &lt;code&gt;cargo-edit&lt;/code&gt; å¾ˆæ–¹ä¾¿ï¼Œæ‰€ä»¥ä½ å¯èƒ½å·²ç»å®‰è£…è¿‡å®ƒã€‚éƒ¨åˆ†è¯»è€…ä¼šæ„Ÿåˆ°å›°æƒ‘æ˜¯å› ä¸ºåƒ
&lt;code&gt;cargo new&lt;/code&gt;, &lt;code&gt;cargo build&lt;/code&gt;, &lt;code&gt;cargo test&lt;/code&gt;, &lt;code&gt;cargo run&lt;/code&gt; ç­‰å­å‘½ä»¤éƒ½å†…ç½®åœ¨ cargo ä¸­ï¼Œ
ä½†æ˜¯ &lt;code&gt;cargo add&lt;/code&gt; æ²¡æœ‰ã€‚&lt;/p&gt;
&lt;p&gt;å®é™…ä¸Šï¼Œæœ‰ä¸€å¤§å †åƒè¿™æ ·çš„åŒ…ï¼Œå¦‚ &lt;a href="https://lib.rs/crates/cargo-hack"&gt;cargo-hack&lt;/a&gt;,&lt;a href="https://lib.rs/crates/cargo-udeps"&gt;cargo-udeps&lt;/a&gt;,&lt;a href="https://lib.rs/crates/cargo-expand"&gt;cargo-expand&lt;/a&gt;...&lt;a href="https://lib.rs/keywords/cargo"&gt;ç­‰ç­‰&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬éœ€è¦é€‰æ‹©ä¸€ä¸ªã€Œå¼‚æ­¥è¿è¡Œæ—¶ã€ï¼ˆasync runtimeï¼‰ï¼Œå› ä¸ºè¿™äº› future å¯¹è±¡ä¸ä¼šè½®è¯¢ï¼ˆpollï¼‰è‡ªå·±ã€‚ã€‚ã€‚
æˆ‘ä»¬æ¯«æ— ç†ç”±çš„é€‰æ‹© tokioï¼Œå”¯ä¸€çš„åŸå› æ˜¯ï¼šè¿‡å»å‡ ä¸ªæœˆæˆ‘ä¸€ç›´åœ¨ç”¨å®ƒã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;&lt;span class="mf"&gt;@1.9.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;features&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;full&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Updating&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//github.com/rust-lang/crates.io-index&amp;#39; index&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;Adding&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;v1&lt;/span&gt;&lt;span class="mf"&gt;.9.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dependencies&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;with&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;features&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;full&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæˆ‘ä»¬ä¿®æ”¹ &lt;code&gt;main&lt;/code&gt; å‡½æ•°ä½¿ç”¨ tokio é»˜è®¤æ‰§è¡Œå™¨ï¼ˆexecutorï¼‰ï¼ˆ &lt;code&gt;cargo new&lt;/code&gt; ä¸ºæˆ‘ä»¬ç”Ÿæˆäº†ä¸€ä¸ª &lt;code&gt;main&lt;/code&gt; å‡½æ•°ï¼Œä½†æ˜¯è¿™é‡Œå¹¶ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ï¼‰ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;// in `src/main.rs`&lt;/span&gt;

&lt;span class="cp"&gt;#[tokio::main]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="fm"&gt;println!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Hello from a (so far completely unnecessary) async runtime&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt;                                                                                                                                                                                          &lt;/span&gt;3s&lt;span class="w"&gt; &lt;/span&gt;209ms
&lt;span class="w"&gt;   &lt;/span&gt;Compiling&lt;span class="w"&gt; &lt;/span&gt;waytoodeep&lt;span class="w"&gt; &lt;/span&gt;v0.1.0&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;/Users/wh/codes/rust/waytoodeep&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;Finished&lt;span class="w"&gt; &lt;/span&gt;dev&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;unoptimized&lt;span class="w"&gt; &lt;/span&gt;+&lt;span class="w"&gt; &lt;/span&gt;debuginfo&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;target&lt;span class="o"&gt;(&lt;/span&gt;s&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;.47s
&lt;span class="w"&gt;     &lt;/span&gt;Running&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;target/debug/waytoodeep&lt;span class="sb"&gt;`&lt;/span&gt;
Hello&lt;span class="w"&gt; &lt;/span&gt;from&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;so&lt;span class="w"&gt; &lt;/span&gt;far&lt;span class="w"&gt; &lt;/span&gt;completely&lt;span class="w"&gt; &lt;/span&gt;unnecessary&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;async&lt;span class="w"&gt; &lt;/span&gt;runtime
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é…·ï¼&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥è®©æˆ‘ä»¬æ·»åŠ å…¶ä»–ä¸€äº›æˆ‘å–œæ¬¢åœ¨æˆ‘çš„é¡¹ç›®ä¸­ä½¿ç”¨çš„å¥½ä¸œè¥¿ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œå¯¹äºé”™è¯¯å¤„ç† - æˆ‘ä»¬ç¼–å†™ç¨‹åºå°±éœ€è¦å¤„ç†ä¸€å †ä¸åŒåº“é‡Œä¸åŒçš„é”™è¯¯ç±»å‹ï¼Œå¦‚æœèƒ½é€šè¿‡ä¸€ä¸ªç±»å‹ç»Ÿä¸€å®ƒä»¬å°±ä¼šéå¸¸æ•´æ´ã€‚&lt;/p&gt;
&lt;p&gt;&lt;a href="https://lib.rs/crates/eyre"&gt;eyre&lt;/a&gt; å¯ä»¥èµ‹äºˆæˆ‘ä»¬è¿™äº›ï¼ˆå°±åƒ &lt;code&gt;anyhow&lt;/code&gt; ï¼‰ï¼&lt;/p&gt;
&lt;p&gt;å¹¶ä¸”å› ä¸ºæˆ‘å–œæ¬¢æ¼‚äº®çš„é¢œè‰²æˆ‘å°†ä½¿ç”¨ &lt;a href="https://lib.rs/crates/color-eyre"&gt;color-eyre&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;eyre&lt;/span&gt;&lt;span class="mf"&gt;@0.5.11&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Updating&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//github.com/rust-lang/crates.io-index&amp;#39; index&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;Adding&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;color&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;eyre&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;v0&lt;/span&gt;&lt;span class="mf"&gt;.5.11&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dependencies&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç°åœ¨æˆ‘ä»¬éœ€è¦å®‰è£… &lt;code&gt;color-eyre&lt;/code&gt; ä½œä¸ºé»˜è®¤çš„å´©æºƒï¼ˆpanicï¼‰å¤„ç†å™¨ï¼Œæˆ‘æ‚„æ‚„ä¿®æ”¹äº†ä¸€äº›ç¯å¢ƒå˜é‡æ¥é»˜è®¤è¾“å‡ºè°ƒç”¨å †æ ˆï¼ˆbacktracksï¼‰ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;color_eyre&lt;/span&gt;::&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#[tokio::main]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="fm"&gt;println!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Hello from a (so far completely unnecessary) async runtime&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;env&lt;/span&gt;::&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;RUST_LIB_BACKTRACE&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;is_err&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;env&lt;/span&gt;::&lt;span class="n"&gt;set_var&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;RUST_LIB_BACKTRACE&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;color_eyre&lt;/span&gt;::&lt;span class="n"&gt;install&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run
&lt;span class="w"&gt;    &lt;/span&gt;Finished&lt;span class="w"&gt; &lt;/span&gt;dev&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;unoptimized&lt;span class="w"&gt; &lt;/span&gt;+&lt;span class="w"&gt; &lt;/span&gt;debuginfo&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;target&lt;span class="o"&gt;(&lt;/span&gt;s&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.02s
&lt;span class="w"&gt;     &lt;/span&gt;Running&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;target/debug/waytoodeep&lt;span class="sb"&gt;`&lt;/span&gt;
Hello&lt;span class="w"&gt; &lt;/span&gt;from&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;so&lt;span class="w"&gt; &lt;/span&gt;far&lt;span class="w"&gt; &lt;/span&gt;completely&lt;span class="w"&gt; &lt;/span&gt;unnecessary&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;async&lt;span class="w"&gt; &lt;/span&gt;runtime
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¾ˆå¥½ï¼ç°åœ¨å¦‚æœæˆ‘ä»¬æŸå¤„å‡ºç°äº†ä¸€ä¸ªé”™è¯¯ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°å®Œæ•´çš„å †æ ˆè·Ÿè¸ªï¼Œå°±åƒä¸‹é¢è¿™æ ·ï¼š
&lt;img alt="" src="https://fasterthanli.me/content/articles/understanding-rust-futures-by-going-way-too-deep/assets/color-eyre.78931d5fc80841f6.webp"&gt;&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œå› ä¸ºæˆ‘å–œæ¬¢ç»“æ„åŒ–æ—¥å¿—ï¼Œè®©æˆ‘ä»¬æ·»åŠ  &lt;a href="https://lib.rs/crates/tracing"&gt;tracing&lt;/a&gt; ç„¶åé€šè¿‡æ¼‚äº®çš„é¢œè‰²æ‰“å°å®ƒä»¬ï¼Œè®©æˆ‘ä»¬æ·»åŠ  &lt;a href="https://lib.rs/crates/tracing-subscriber"&gt;tracing-subscriber&lt;/a&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tracing&lt;/span&gt;&lt;span class="mf"&gt;@0.1.26&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tracing&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;subscriber&lt;/span&gt;&lt;span class="mf"&gt;@0.2.19&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Updating&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//github.com/rust-lang/crates.io-index&amp;#39; index&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;Adding&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tracing&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;v0&lt;/span&gt;&lt;span class="mf"&gt;.1.26&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dependencies&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;Adding&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tracing&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;subscriber&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;v0&lt;/span&gt;&lt;span class="mf"&gt;.2.19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dependencies&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬å·²ç»æœ‰ä¸€ä¸ª &lt;code&gt;setup&lt;/code&gt; å‡½æ•°ï¼Œæ‰€ä»¥ç›´æ¥åœ¨é‚£é‡Œå®‰è£… &lt;code&gt;tracing-subscriber&lt;/code&gt;.. ç„¶åæˆ‘ä»¬å°† &lt;code&gt;println!&lt;/code&gt; æ”¹æˆ &lt;code&gt;info!&lt;/code&gt; ï¼
ç„¶åï¼Œä¸ºäº†æ¼”ç¤ºå¦‚ä½•è®¾ç½®è®©æˆ‘ä»¬å†æ¬¡ä¿®æ”¹ä¸€äº›ç¯å¢ƒå˜é‡ï¼šå¯¹æ‰€æœ‰åŒ…ï¼ˆcratesï¼‰é»˜è®¤ &lt;code&gt;info&lt;/code&gt; æ—¥å¿—çº§åˆ«ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;color_eyre&lt;/span&gt;::&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tracing&lt;/span&gt;::&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tracing_subscriber&lt;/span&gt;::&lt;span class="n"&gt;EnvFilter&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#[tokio::main]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Hello from a comfy nest we&amp;#39;ve made for ourselves&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;env&lt;/span&gt;::&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;RUST_LIB_BACKTRACE&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;is_err&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;env&lt;/span&gt;::&lt;span class="n"&gt;set_var&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;RUST_LIB_BACKTRACE&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;color_eyre&lt;/span&gt;::&lt;span class="n"&gt;install&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;env&lt;/span&gt;::&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;RUST_LOG&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;is_err&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;env&lt;/span&gt;::&lt;span class="n"&gt;set_var&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;RUST_LOG&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;info&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;tracing_subscriber&lt;/span&gt;::&lt;span class="n"&gt;fmt&lt;/span&gt;::&lt;span class="n"&gt;fmt&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;with_env_filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;EnvFilter&lt;/span&gt;::&lt;span class="n"&gt;from_default_env&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;init&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run
&lt;span class="w"&gt;    &lt;/span&gt;Finished&lt;span class="w"&gt; &lt;/span&gt;dev&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;unoptimized&lt;span class="w"&gt; &lt;/span&gt;+&lt;span class="w"&gt; &lt;/span&gt;debuginfo&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;target&lt;span class="o"&gt;(&lt;/span&gt;s&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.02s
&lt;span class="w"&gt;     &lt;/span&gt;Running&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;target/debug/waytoodeep&lt;span class="sb"&gt;`&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;17&lt;/span&gt;:03:46.993&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Hello&lt;span class="w"&gt; &lt;/span&gt;from&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;comfy&lt;span class="w"&gt; &lt;/span&gt;nest&lt;span class="w"&gt; &lt;/span&gt;we&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;ve&lt;span class="w"&gt; &lt;/span&gt;made&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;ourselves
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¥½äº†ï¼Œæˆ‘ä»¬å‡†å¤‡å¥½åšä¸€äº›æœ‰ç”¨çš„äº‹æƒ…äº†ã€‚&lt;/p&gt;
&lt;h3 id="åšä¸€äº›æœ‰ç”¨çš„äº‹æƒ…"&gt;åšä¸€äº›æœ‰ç”¨çš„äº‹æƒ…&lt;/h3&gt;
&lt;p&gt;å½“å†³å®šåœ¨å’–å•¡é—´éš™é˜…è¯»å“ªä¸€ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œäººä»¬é€šå¸¸åŒæ—¶æ‰“å¼€å‡ ä¸ªç½‘ç«™ï¼Œç„¶åè¯»æœ€å…ˆåŠ è½½å‡ºæ¥çš„é‚£ä¸€ç¯‡ã€‚&lt;/p&gt;
&lt;p&gt;äº‹å®å¦‚æ­¤ã€‚ä½ å¯ä»¥å¼•ç”¨æˆ‘çš„è¯ï¼Œè°ä¼šå»éªŒè¯å‘¢ï¼Ÿæ¯•ç«Ÿè¿™å¬èµ·æ¥éœ€è¦å¾ˆå¤šå·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è®©æˆ‘ä»¬æ¥ç¼–å†™ä¸€ä¸ªç¨‹åºåšç›¸åŒçš„äº‹æƒ…ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬å¼•å…¥ &lt;a href="https://lib.rs/crates/reqwest"&gt;reqwest&lt;/a&gt; -- å°½ç®¡æˆ‘ä¸å–œæ¬¢å®ƒçš„ APIï¼Œä½†å®ƒä¼šå¾ˆå¥½çš„å®Œæˆæ¥ä¸‹æ¥çš„å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;åŒæ—¶ï¼Œå› ä¸º &lt;a href="https://www.openssl.org/news/vulnerabilities.html"&gt;screw OpenSSL&lt;/a&gt; æˆ‘ä»¬å°†æ ‡è®° reqwest ä½¿ç”¨ &lt;a href="https://lib.rs/crates/rustls"&gt;rustls&lt;/a&gt;ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reqwest&lt;/span&gt;&lt;span class="mf"&gt;@0.11.4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;no&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="k"&gt;default&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;features&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;features&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rustls&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;tls&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Updating&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//github.com/rust-lang/crates.io-index&amp;#39; index&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;Adding&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reqwest&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;v0&lt;/span&gt;&lt;span class="mf"&gt;.11.4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dependencies&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;with&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;features&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;rustls-tls&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬å‡†å¤‡å¥½å‘é€ä¸€ä¸ªè¯·æ±‚äº†ï¼&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;color_eyre&lt;/span&gt;::&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tracing&lt;/span&gt;::&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tracing_subscriber&lt;/span&gt;::&lt;span class="n"&gt;EnvFilter&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reqwest&lt;/span&gt;::&lt;span class="n"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#[tokio::main]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Hello from a comfy nest we&amp;#39;ve made for ourselves&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://fasterthanli.me&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// this will turn non-200 HTTP status codes into rust errors,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// so the first `?` propagates &amp;quot;we had a connection problem&amp;quot; and&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// the second `?` propagates &amp;quot;we had a chat with the server and they&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// were not pleased&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error_for_status&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;content-type&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Got a response!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;


&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;env&lt;/span&gt;::&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;RUST_LIB_BACKTRACE&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;is_err&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;env&lt;/span&gt;::&lt;span class="n"&gt;set_var&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;RUST_LIB_BACKTRACE&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;color_eyre&lt;/span&gt;::&lt;span class="n"&gt;install&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;env&lt;/span&gt;::&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;RUST_LOG&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;is_err&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;env&lt;/span&gt;::&lt;span class="n"&gt;set_var&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;RUST_LOG&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;info&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;tracing_subscriber&lt;/span&gt;::&lt;span class="n"&gt;fmt&lt;/span&gt;::&lt;span class="n"&gt;fmt&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;with_env_filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;EnvFilter&lt;/span&gt;::&lt;span class="n"&gt;from_default_env&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;init&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å‡ºå‘äº†ï¼&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nt"&gt;cargo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;run&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="nt"&gt;Compiling&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;waytoodeep&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;v0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(/&lt;/span&gt;&lt;span class="nt"&gt;Users&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;wh&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;codes&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;rust&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;waytoodeep&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nt"&gt;Finished&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;dev&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="cp"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;unoptimized&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;debuginfo&lt;/span&gt;&lt;span class="cp"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;target&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;s&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;7&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;16s&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="nt"&gt;Running&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="nt"&gt;target&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nt"&gt;waytoodeep&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;
&lt;span class="nt"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;26&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;16&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;50&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;57&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;778&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="nt"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;waytoodeep&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;Hello&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;comfy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;nest&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;we&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="nt"&gt;ve&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;made&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;ourselves&lt;/span&gt;
&lt;span class="nt"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;26&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;16&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;50&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="nd"&gt;59&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;090&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="nt"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;waytoodeep&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;Got&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;response&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;https&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="nt"&gt;fasterthanli&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;me&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nt"&gt;Some&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™å°±æ˜¯æˆ‘æ‰€è¯´çš„ã€Œç»“æ„åŒ–æ—¥å¿—ã€ã€‚å—¯ï¼Œå…¶ä¸­çš„ä¸€éƒ¨åˆ†ã€‚è®©æˆ‘ä»¬çœ‹ä¸‹è¿™è¡Œä»£ç ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;content-type&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Got a response!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬è¾“å‡ºæ¥ä¸€ä¸ªæ¶ˆæ¯ï¼š &lt;code&gt;Got a response!&lt;/code&gt; ï¼Œä¸€ä¸ªåä¸º &lt;code&gt;url&lt;/code&gt; çš„æ ‡ç­¾ï¼šå€¼ä¸ºå˜é‡ &lt;code&gt;url&lt;/code&gt; çš„ &lt;a href="https://doc.rust-lang.org/stable/std/fmt/trait.Display.html"&gt;Display&lt;/a&gt; æ ¼å¼ï¼Œ
ä¸€ä¸ªåä¸º &lt;code&gt;content_type&lt;/code&gt; çš„æ ‡ç­¾ï¼šå€¼ä¸ºè¡¨è¾¾å¼çš„ &lt;a href="https://doc.rust-lang.org/stable/std/fmt/trait.Debug.html"&gt;Debug&lt;/a&gt; æ ¼å¼ã€‚&lt;/p&gt;
&lt;p&gt;å°±æ˜¯è¿™ä¹ˆç®€å•ï¼ &lt;code&gt;name = %value&lt;/code&gt; è¾“å‡º &lt;code&gt;Display&lt;/code&gt; ï¼Œ &lt;code&gt;name = ?value&lt;/code&gt; è¾“å‡º &lt;code&gt;Debug&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œè¿˜æœ‰éå¸¸æ£’çš„è·¨åº¦ï¼ˆspansï¼‰ï¼Œé‡ç‚¹æ˜¯ä½ å¯ä»¥å°†å®ƒä»¬å‘é€åˆ° APMï¼ˆAppliation Performance Monitoringï¼‰ï¼Œæ¯”å¦‚ Datadog æˆ–è€… Honeycomb ç­‰ï¼Œä½†æ˜¯è¿™ä¸æ˜¯ä¸€ç¯‡å…³äºè·Ÿè¸ªçš„æ–‡ç« ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ä¸¾ä¾‹è¯´æ˜ï¼Œå¦‚æœæˆ‘ä»¬å®‰è£…ä¸€ä¸ª JSON çš„ tracing subscriberï¼Œæˆ‘ä»¬å°†è·å¾—å¦‚ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run
&lt;span class="w"&gt;   &lt;/span&gt;Compiling&lt;span class="w"&gt; &lt;/span&gt;waytoodeep&lt;span class="w"&gt; &lt;/span&gt;v0.1.0&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;/home/amos/ftl/waytoodeep&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;Finished&lt;span class="w"&gt; &lt;/span&gt;dev&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;unoptimized&lt;span class="w"&gt; &lt;/span&gt;+&lt;span class="w"&gt; &lt;/span&gt;debuginfo&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;target&lt;span class="o"&gt;(&lt;/span&gt;s&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;.09s
&lt;span class="w"&gt;     &lt;/span&gt;Running&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;target/debug/waytoodeep&lt;span class="sb"&gt;`&lt;/span&gt;
&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;timestamp&amp;quot;&lt;/span&gt;:&lt;span class="s2"&gt;&amp;quot;Jul 25 17:17:21.531&amp;quot;&lt;/span&gt;,&lt;span class="s2"&gt;&amp;quot;level&amp;quot;&lt;/span&gt;:&lt;span class="s2"&gt;&amp;quot;INFO&amp;quot;&lt;/span&gt;,&lt;span class="s2"&gt;&amp;quot;fields&amp;quot;&lt;/span&gt;:&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;message&amp;quot;&lt;/span&gt;:&lt;span class="s2"&gt;&amp;quot;Hello from a comfy nest we&amp;#39;ve made for ourselves&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;,&lt;span class="s2"&gt;&amp;quot;target&amp;quot;&lt;/span&gt;:&lt;span class="s2"&gt;&amp;quot;waytoodeep&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;timestamp&amp;quot;&lt;/span&gt;:&lt;span class="s2"&gt;&amp;quot;Jul 25 17:17:21.709&amp;quot;&lt;/span&gt;,&lt;span class="s2"&gt;&amp;quot;level&amp;quot;&lt;/span&gt;:&lt;span class="s2"&gt;&amp;quot;INFO&amp;quot;&lt;/span&gt;,&lt;span class="s2"&gt;&amp;quot;fields&amp;quot;&lt;/span&gt;:&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;message&amp;quot;&lt;/span&gt;:&lt;span class="s2"&gt;&amp;quot;Got a response!&amp;quot;&lt;/span&gt;,&lt;span class="s2"&gt;&amp;quot;url&amp;quot;&lt;/span&gt;:&lt;span class="s2"&gt;&amp;quot;https://fasterthanli.me&amp;quot;&lt;/span&gt;,&lt;span class="s2"&gt;&amp;quot;content_type&amp;quot;&lt;/span&gt;:&lt;span class="s2"&gt;&amp;quot;Some(\&amp;quot;text/html; charset=utf-8\&amp;quot;)&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;,&lt;span class="s2"&gt;&amp;quot;target&amp;quot;&lt;/span&gt;:&lt;span class="s2"&gt;&amp;quot;waytoodeep&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™åº”è¯¥è¶³ä»¥æ¿€èµ·ä½ çš„å…´è¶£ã€‚&lt;/p&gt;
&lt;h3 id="åŒæ—¶è·å–ä¸¤ä¸ªåœ°å€"&gt;åŒæ—¶è·å–ä¸¤ä¸ªåœ°å€&lt;/h3&gt;
&lt;p&gt;ç°åœ¨è®©æˆ‘ä»¬è·å–ä¸¤ä¸ªåœ°å€ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_1&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kt"&gt;str&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://fasterthanli.me/articles/whats-in-the-box&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_2&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kt"&gt;str&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://fasterthanli.me/series/advent-of-code-2020/part-13&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ã€‚ã€‚ã€‚è¿™æ˜¯ä¸€ä¸ªå…¬å¹³çš„æ¯”è¾ƒã€‚ è¿™ä¸¤ç¯‡æ–‡ç« éƒ½æ‰˜ç®¡åœ¨æˆ‘è‡ªå·±çš„ç½‘ç«™ä¸Šï¼Œç»å¯¹ä¸æ˜¯ä¸ºäº†æ¨å¹¿ï¼Œè€Œæ˜¯ä¸ºäº†ä½¿è·å–æ—¶é—´å…·æœ‰å¯æ¯”æ€§ï¼Œå¹¶ä¸”ä»»ä¸€éƒ½æœ‰å¯èƒ½å…ˆåŠ è½½å®Œæˆï¼ˆå¹¶ä¸”ä¼šéšç€æ—¶é—´çš„æ¨ç§»éšæœºå˜åŒ–ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªå‡½æ•°æ¥è·å–å†…å®¹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kt"&gt;str&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error_for_status&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;content-type&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Got a response!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¹¶ä½¿ç”¨å®ƒï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="cp"&gt;#[tokio::main]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Hello from a comfy nest we&amp;#39;ve made for ourselves&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åè¿è¡Œå®ƒ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="cp"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;Compiling&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;v0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;amos&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ftl&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;warning&lt;/span&gt;: &lt;span class="nc"&gt;unused&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;implementer&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;of&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;that&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;must&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;be&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;used&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;:&lt;span class="mi"&gt;15&lt;/span&gt;:&lt;span class="mi"&gt;5&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="o"&gt;^^^^^^^^^^^^^^^^^^^^^^^^^^^^&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;note&lt;/span&gt;: &lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="cp"&gt;#[warn(unused_must_use)]&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;on&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;by&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;default&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;note&lt;/span&gt;: &lt;span class="nc"&gt;futures&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kr"&gt;do&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;nothing&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;unless&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;you&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;or&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;them&lt;/span&gt;

&lt;span class="n"&gt;warning&lt;/span&gt;: &lt;span class="nc"&gt;unused&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;implementer&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;of&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;that&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;must&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;be&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;used&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;:&lt;span class="mi"&gt;16&lt;/span&gt;:&lt;span class="mi"&gt;5&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="o"&gt;^^^^^^^^^^^^^^^^^^^^^^^^^^^^&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;note&lt;/span&gt;: &lt;span class="nc"&gt;futures&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kr"&gt;do&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;nothing&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;unless&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;you&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;or&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;them&lt;/span&gt;

&lt;span class="n"&gt;warning&lt;/span&gt;: &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;warnings&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;emitted&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Finished&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;unoptimized&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;debuginfo&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;3.01&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;Running&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt;:&lt;span class="mi"&gt;26&lt;/span&gt;:&lt;span class="mf"&gt;31.571&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;: &lt;span class="nc"&gt;Hello&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;comfy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;nest&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;we&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;ve&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;made&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ourselves&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¥‡æ€ªçš„æ˜¯ï¼Œæ²¡æœ‰ä»»ä½•äº‹æƒ…å‘ç”Ÿã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é»„è‰²çš„æ³¢æµªçº¿å’Œæ¼äººçš„ Rust è­¦å‘Šå·²ç»ç»™å‡ºäº†æç¤ºã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è®©æˆ‘ä»¬æ¥ä¿®å¤å®ƒï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_1&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_2&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run
&lt;span class="w"&gt;   &lt;/span&gt;Compiling&lt;span class="w"&gt; &lt;/span&gt;waytoodeep&lt;span class="w"&gt; &lt;/span&gt;v0.1.0&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;/home/amos/ftl/waytoodeep&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;Finished&lt;span class="w"&gt; &lt;/span&gt;dev&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;unoptimized&lt;span class="w"&gt; &lt;/span&gt;+&lt;span class="w"&gt; &lt;/span&gt;debuginfo&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;target&lt;span class="o"&gt;(&lt;/span&gt;s&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;.17s
&lt;span class="w"&gt;     &lt;/span&gt;Running&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;target/debug/waytoodeep&lt;span class="sb"&gt;`&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;17&lt;/span&gt;:27:29.768&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Hello&lt;span class="w"&gt; &lt;/span&gt;from&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;comfy&lt;span class="w"&gt; &lt;/span&gt;nest&lt;span class="w"&gt; &lt;/span&gt;we&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;ve&lt;span class="w"&gt; &lt;/span&gt;made&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;ourselves
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;17&lt;/span&gt;:27:29.891&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/articles/whats-in-the-box&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;17&lt;/span&gt;:27:29.974&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/series/advent-of-code-2020/part-13&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ‰€ä»¥ï¼Œç¬¬é›¶è¯¾ï¼šfuture å¯¹è±¡ä¸åšä»»ä½•äº‹æƒ…ç›´åˆ°å®ƒä»¬è¢«è½®è¯¢ï¼ˆpolledï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯å› ä¸º future å¯¹è±¡å‡ ä¹å°±æ˜¯çŠ¶æ€ã€‚è®©æˆ‘ä»¬æ¥åˆ›å»ºä¸€ä¸ªï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;// in `src/main.rs`&lt;/span&gt;

&lt;span class="k"&gt;mod&lt;/span&gt; &lt;span class="nn"&gt;dumb&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;// in `src/dumb.rs`&lt;/span&gt;

&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;future&lt;/span&gt;::&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;pin&lt;/span&gt;::&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;::&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tracing&lt;/span&gt;::&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;DumbFuture&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{}&lt;/span&gt;

&lt;span class="k"&gt;impl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DumbFuture&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;type&lt;/span&gt; &lt;span class="nc"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;: &lt;span class="nc"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_cx&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;_&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;Poll&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Hello from a dumb future!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;// back in `src/main.rs`&lt;/span&gt;

&lt;span class="cp"&gt;#[tokio::main]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dumb&lt;/span&gt;::&lt;span class="n"&gt;DumbFuture&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{};&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä»¥ä¸Šï¼æˆ‘ä»¬å‡ ä¹å°±å®Œæˆäº†ï¼Œé™¤äº†æˆ‘ä»¬æ²¡æœ‰è¿›è¡Œ &lt;code&gt;.await&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;è¿è¡Œå®ƒé™¤äº†æ‰“å°è­¦å‘Šä¸ä¼šæœ‰ä»»ä½•æ•ˆæœï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;Compiling&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;v0&lt;/span&gt;&lt;span class="mf"&gt;.1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;amos&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ftl&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;warning&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;unused&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;variable&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`fut`&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dumb&lt;/span&gt;&lt;span class="o"&gt;::&lt;/span&gt;&lt;span class="n"&gt;DumbFuture&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{}&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="o"&gt;^^^&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;help&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;intentional&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;prefix&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;with&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;an&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;underscore&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`_fut`&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;note&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`#[warn(unused_variables)]`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;on&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;by&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;default&lt;/span&gt;

&lt;span class="n"&gt;warning&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;warning&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;emitted&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Finished&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;[&lt;/span&gt;&lt;span class="n"&gt;unoptimized&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;debuginfo&lt;/span&gt;&lt;span class="err"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;2.11&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;Running&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`target/debug/waytoodeep`&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å› ä¸ºæ€ä¹ˆå¯èƒ½ï¼Ÿæˆ‘ä»¬å­—é¢ä¸Šä»…ä»…æ„å»ºäº†ä¸€ä¸ªç»“æ„ä½“ã€‚ä¸€ä¸ªé›¶å¤§å°çš„ç»“æ„ä½“ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬è°ƒç”¨å®ƒçš„ &lt;code&gt;.await&lt;/code&gt; ã€‚ã€‚ ç„¶åå½“æˆ‘ä»¬è¦æ±‚è¿è¡Œæ—¶è¿è¡Œå®ƒçš„äº‹ä»¶å¾ªç¯ç›´åˆ° future å¯¹è±¡è¢«è½®è¯¢ï¼ˆpolledï¼‰å¹¶ä¸”æœ€ç»ˆè¿”å› &lt;code&gt;Poll::Ready&lt;/code&gt; ï¼ˆæˆ‘ä»¬çš„ä»£ç ç«‹å³è¿”å›ï¼‰ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="cp"&gt;#[tokio::main]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Building that dumb future...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dumb&lt;/span&gt;::&lt;span class="n"&gt;DumbFuture&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{};&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Awaiting that dumb future...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;fut&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Done awaiting that dumb future&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run
&lt;span class="w"&gt;   &lt;/span&gt;Compiling&lt;span class="w"&gt; &lt;/span&gt;waytoodeep&lt;span class="w"&gt; &lt;/span&gt;v0.1.0&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;/home/amos/ftl/waytoodeep&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;Finished&lt;span class="w"&gt; &lt;/span&gt;dev&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;unoptimized&lt;span class="w"&gt; &lt;/span&gt;+&lt;span class="w"&gt; &lt;/span&gt;debuginfo&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;target&lt;span class="o"&gt;(&lt;/span&gt;s&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.34s
&lt;span class="w"&gt;     &lt;/span&gt;Running&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;target/debug/waytoodeep&lt;span class="sb"&gt;`&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;17&lt;/span&gt;:37:09.261&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Building&lt;span class="w"&gt; &lt;/span&gt;that&lt;span class="w"&gt; &lt;/span&gt;dumb&lt;span class="w"&gt; &lt;/span&gt;future...
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;17&lt;/span&gt;:37:09.261&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Awaiting&lt;span class="w"&gt; &lt;/span&gt;that&lt;span class="w"&gt; &lt;/span&gt;dumb&lt;span class="w"&gt; &lt;/span&gt;future...
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;17&lt;/span&gt;:37:09.261&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep::dumb:&lt;span class="w"&gt; &lt;/span&gt;Hello&lt;span class="w"&gt; &lt;/span&gt;from&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;dumb&lt;span class="w"&gt; &lt;/span&gt;future!
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;17&lt;/span&gt;:37:09.262&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Done&lt;span class="w"&gt; &lt;/span&gt;awaiting&lt;span class="w"&gt; &lt;/span&gt;that&lt;span class="w"&gt; &lt;/span&gt;dumb&lt;span class="w"&gt; &lt;/span&gt;future
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™é‡Œä¸ ECMAScript çš„ &lt;code&gt;promise&lt;/code&gt; æœ‰ä¸€äº›ç•¥å¾®çš„åŒºåˆ«ï¼šå³ä½¿å®ƒä»¬å‹æ ¹æ²¡æœ‰è¢« await å…¶ä¸­åŒ…å«çš„å·¥ä½œä¾ç„¶ä¼šè¢«æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ Rust çš„ future å¯¹è±¡ä»…ä»…æ˜¯æ— èŠçš„çŠ¶æ€æœºï¼Œå¦‚æœä½ æ•…æ„åˆ¶é€ éº»çƒ¦å°±å¯ä»¥ç†è§£è¿™ä¸ªæœºåˆ¶ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;// in `src/dumb.rs`&lt;/span&gt;

&lt;span class="k"&gt;impl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DumbFuture&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;type&lt;/span&gt; &lt;span class="nc"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;: &lt;span class="nc"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_cx&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;_&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;Poll&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="fm"&gt;panic!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Oh heck no&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_BACKTRACE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run
&lt;span class="w"&gt;   &lt;/span&gt;Compiling&lt;span class="w"&gt; &lt;/span&gt;waytoodeep&lt;span class="w"&gt; &lt;/span&gt;v0.1.0&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;/home/amos/ftl/waytoodeep&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;Finished&lt;span class="w"&gt; &lt;/span&gt;dev&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;unoptimized&lt;span class="w"&gt; &lt;/span&gt;+&lt;span class="w"&gt; &lt;/span&gt;debuginfo&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;target&lt;span class="o"&gt;(&lt;/span&gt;s&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.28s
&lt;span class="w"&gt;     &lt;/span&gt;Running&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;target/debug/waytoodeep&lt;span class="sb"&gt;`&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;17&lt;/span&gt;:41:18.956&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Building&lt;span class="w"&gt; &lt;/span&gt;that&lt;span class="w"&gt; &lt;/span&gt;dumb&lt;span class="w"&gt; &lt;/span&gt;future...
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;17&lt;/span&gt;:41:18.956&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Awaiting&lt;span class="w"&gt; &lt;/span&gt;that&lt;span class="w"&gt; &lt;/span&gt;dumb&lt;span class="w"&gt; &lt;/span&gt;future...
The&lt;span class="w"&gt; &lt;/span&gt;application&lt;span class="w"&gt; &lt;/span&gt;panicked&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;crashed&lt;span class="o"&gt;)&lt;/span&gt;.
Message:&lt;span class="w"&gt;  &lt;/span&gt;Oh&lt;span class="w"&gt; &lt;/span&gt;heck&lt;span class="w"&gt; &lt;/span&gt;no
Location:&lt;span class="w"&gt; &lt;/span&gt;src/dumb.rs:14

&lt;span class="w"&gt;  &lt;/span&gt;â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”&lt;span class="w"&gt; &lt;/span&gt;BACKTRACE&lt;span class="w"&gt; &lt;/span&gt;â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
&lt;span class="w"&gt;                                &lt;/span&gt;â‹®&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;6&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;frames&lt;span class="w"&gt; &lt;/span&gt;hidden&lt;span class="w"&gt; &lt;/span&gt;â‹®
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;7&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&amp;lt;waytoodeep::dumb::DumbFuture&lt;span class="w"&gt; &lt;/span&gt;as&lt;span class="w"&gt; &lt;/span&gt;core::future::future::Future&amp;gt;::poll::h4a44780628f4c5f0
&lt;span class="w"&gt;      &lt;/span&gt;at&lt;span class="w"&gt; &lt;/span&gt;/home/amos/ftl/waytoodeep/src/dumb.rs:14
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;8&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;waytoodeep::main::&lt;span class="o"&gt;{{&lt;/span&gt;closure&lt;span class="o"&gt;}}&lt;/span&gt;::h36de5a1f1f2a5c5b
&lt;span class="w"&gt;      &lt;/span&gt;at&lt;span class="w"&gt; &lt;/span&gt;/home/amos/ftl/waytoodeep/src/main.rs:17
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;9&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&amp;lt;core::future::from_generator::GenFuture&amp;lt;T&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;as&lt;span class="w"&gt; &lt;/span&gt;core::future::future::Future&amp;gt;::poll::h20a96e082c7a581e
&lt;span class="w"&gt;      &lt;/span&gt;at&lt;span class="w"&gt; &lt;/span&gt;/home/amos/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/future/mod.rs:80
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;tokio::park::thread::CachedParkThread::block_on::&lt;span class="o"&gt;{{&lt;/span&gt;closure&lt;span class="o"&gt;}}&lt;/span&gt;::hdf98cb3c7fdf3de4
&lt;span class="w"&gt;      &lt;/span&gt;at&lt;span class="w"&gt; &lt;/span&gt;/home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/park/thread.rs:263
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;tokio::coop::with_budget::&lt;span class="o"&gt;{{&lt;/span&gt;closure&lt;span class="o"&gt;}}&lt;/span&gt;::h6a86a24a246e220f
&lt;span class="w"&gt;      &lt;/span&gt;at&lt;span class="w"&gt; &lt;/span&gt;/home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/coop.rs:106
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;12&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;std::thread::local::LocalKey&amp;lt;T&amp;gt;::try_with::h2ce0ac27c85965b6
&lt;span class="w"&gt;      &lt;/span&gt;at&lt;span class="w"&gt; &lt;/span&gt;/home/amos/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/thread/local.rs:376
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;std::thread::local::LocalKey&amp;lt;T&amp;gt;::with::hc449f38c9f65fb53
&lt;span class="w"&gt;      &lt;/span&gt;at&lt;span class="w"&gt; &lt;/span&gt;/home/amos/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/std/src/thread/local.rs:352
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;14&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;tokio::coop::with_budget::h5db157bd1e95e0e8
&lt;span class="w"&gt;      &lt;/span&gt;at&lt;span class="w"&gt; &lt;/span&gt;/home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/coop.rs:99
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;15&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;tokio::coop::budget::h7b57383f1255ac24
&lt;span class="w"&gt;      &lt;/span&gt;at&lt;span class="w"&gt; &lt;/span&gt;/home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/coop.rs:76
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;tokio::park::thread::CachedParkThread::block_on::hece399485213b91c
&lt;span class="w"&gt;      &lt;/span&gt;at&lt;span class="w"&gt; &lt;/span&gt;/home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/park/thread.rs:263
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;17&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;tokio::runtime::enter::Enter::block_on::h89e9882e539e82d3
&lt;span class="w"&gt;      &lt;/span&gt;at&lt;span class="w"&gt; &lt;/span&gt;/home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/runtime/enter.rs:151
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;tokio::runtime::thread_pool::ThreadPool::block_on::h1a0186470c00ba70
&lt;span class="w"&gt;      &lt;/span&gt;at&lt;span class="w"&gt; &lt;/span&gt;/home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/runtime/thread_pool/mod.rs:71
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;tokio::runtime::Runtime::block_on::h7c21d6989b86d606
&lt;span class="w"&gt;      &lt;/span&gt;at&lt;span class="w"&gt; &lt;/span&gt;/home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/runtime/mod.rs:452
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;waytoodeep::main::hb4dd5ffd46a5c032
&lt;span class="w"&gt;      &lt;/span&gt;at&lt;span class="w"&gt; &lt;/span&gt;/home/amos/ftl/waytoodeep/src/main.rs:20
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;21&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;core::ops::function::FnOnce::call_once::hc1fcc87431f77d25
&lt;span class="w"&gt;      &lt;/span&gt;at&lt;span class="w"&gt; &lt;/span&gt;/home/amos/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/ops/function.rs:227
&lt;span class="w"&gt;                                &lt;/span&gt;â‹®&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;frames&lt;span class="w"&gt; &lt;/span&gt;hidden&lt;span class="w"&gt; &lt;/span&gt;â‹®

Run&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;COLORBT_SHOW_HIDDEN&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;environment&lt;span class="w"&gt; &lt;/span&gt;variable&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;disable&lt;span class="w"&gt; &lt;/span&gt;frame&lt;span class="w"&gt; &lt;/span&gt;filtering.
Run&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_BACKTRACE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;full&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;include&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;source&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;snippets.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šé¢å †æ ˆè·Ÿè¸ªå¦‚æœåŠ ä¸Šé¢œè‰²æ•ˆæœä¼šæ›´å¥½ï¼Œæ‰€ä»¥æˆ‘å¸Œæœ›ä½ åœ¨æœ¬åœ°åšäº†ç›¸åŒçš„å°è¯•ï¼Œå³ä½¿å¦‚æ­¤æˆ‘ä»¬ä¾ç„¶å¯ä»¥çœ‹åˆ°æˆ‘ä»¬çœŸæ­£çš„ main å‡½æ•°åœ¨ 20 å¸§ï¼Œç„¶åå¾€ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° &lt;code&gt;Runtime::block_on&lt;/code&gt;  ã€ä¸€ä¸ªçº¿ç¨‹æ± çš„ä¸œè¥¿ã€ä¸€äº›æŒ‚èµ·ï¼ˆparkedï¼‰çš„çº¿ç¨‹ã€thread-localï¼ˆå…¶ä»– TLSï¼‰ã€ä¸€ä¸ª &lt;strong&gt;&lt;em&gt;*ç”Ÿæˆçš„&lt;/em&gt;&lt;/strong&gt;* futureï¼ˆå¸§ 9 å’Œ 8ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬çš„ &lt;code&gt;async fn main&lt;/code&gt; çš„æœ€ç»ˆç»“æœï¼‰ï¼Œæœ€åæ˜¯æˆ‘ä»¬çš„ &lt;code&gt;DumbFuture&lt;/code&gt; poll æ–¹æ³•ï¼ˆå¸§ 7ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å¸§ 6 åˆ° 1 å°±æ˜¯ &lt;a href="https://doc.rust-lang.org/stable/std/panic/index.html"&gt;panic&lt;/a&gt; æœºåˆ¶ï¼Œå†æ¬¡å®Œå…¨è¶…å‡ºæœ¬æ–‡è®¨è®ºçš„èŒƒå›´ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯è¯·ç«™èµ·æ¥ï¼Œäº²çˆ±çš„è§‚ä¼—ï¼Œç”¨ä½ çš„æ‰‹è‡‚ç»•è¿‡è¿™ä¸ªè£…ç½®ï¼Œä»¥ç¡®ä¿æ²¡æœ‰éšœçœ¼æ³•ï¼Œæ²¡æœ‰éšè—çš„çº¿ï¼Œæ²¡æœ‰ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;p&gt;ã€‚ã€‚ã€‚æˆ‘è¦è¯´çš„æ˜¯å¯¹äºå¼‚æ­¥å †æ ˆè·Ÿè¸ªæ²¡æœ‰â€œç‰¹æ®Šå¤„ç†â€ï¼ˆspecial handlingï¼‰ã€‚å½“ç„¶ï¼Œè¿™é‡Œæˆ‘ä»¬å´©æºƒäº†ï¼Œä½†æ˜¯ä»…ä»…æ˜¯ Rustï¼Œæ“ä½œç³»ç»Ÿç”šè‡³ä¸çŸ¥é“æˆ‘å‡ ä¹é¿å…äº†ä¸€åœºç¾éš¾ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬å¯ä»¥åˆ¶é€ æ›´å¤§çš„æ··ä¹±ï¼Œå¦‚æœæˆ‘ä»¬æ„¿æ„ä½¿ç”¨ &lt;code&gt;unsafe&lt;/code&gt; ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;impl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DumbFuture&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;type&lt;/span&gt; &lt;span class="nc"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;: &lt;span class="nc"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_cx&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;_&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;Poll&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;unsafe&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0xF00D&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;u64&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="fm"&gt;unreachable!&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;// pinky promise&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åå°±ä¸ä¼šæœ‰ä¸€äº›åˆ—çš„å´©æºƒå¤„ç†æ¥æ‹¯æ•‘æˆ‘ä»¬ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_BACKTRACE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run
&lt;span class="w"&gt;   &lt;/span&gt;Compiling&lt;span class="w"&gt; &lt;/span&gt;waytoodeep&lt;span class="w"&gt; &lt;/span&gt;v0.1.0&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;/home/amos/ftl/waytoodeep&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;Finished&lt;span class="w"&gt; &lt;/span&gt;dev&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;unoptimized&lt;span class="w"&gt; &lt;/span&gt;+&lt;span class="w"&gt; &lt;/span&gt;debuginfo&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;target&lt;span class="o"&gt;(&lt;/span&gt;s&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.18s
&lt;span class="w"&gt;     &lt;/span&gt;Running&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;target/debug/waytoodeep&lt;span class="sb"&gt;`&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;17&lt;/span&gt;:46:53.926&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Building&lt;span class="w"&gt; &lt;/span&gt;that&lt;span class="w"&gt; &lt;/span&gt;dumb&lt;span class="w"&gt; &lt;/span&gt;future...
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;17&lt;/span&gt;:46:53.926&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Awaiting&lt;span class="w"&gt; &lt;/span&gt;that&lt;span class="w"&gt; &lt;/span&gt;dumb&lt;span class="w"&gt; &lt;/span&gt;future...
zsh:&lt;span class="w"&gt; &lt;/span&gt;segmentation&lt;span class="w"&gt; &lt;/span&gt;fault&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;core&lt;span class="w"&gt; &lt;/span&gt;dumped&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="nv"&gt;RUST_BACKTRACE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä½†æ˜¯ GDB å¯ä»¥ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;build&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;gdb&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;quiet&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;./&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Finished&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;unoptimized&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;debuginfo&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.04&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;
&lt;span class="n"&gt;Reading&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;symbols&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;./&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;warning&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Missing&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;auto&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nb"&gt;load&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;script&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;offset&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;section&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;debug_gdb_scripts&lt;/span&gt;
&lt;span class="n"&gt;of&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;amos&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ftl&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="n"&gt;Use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;auto&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="nb"&gt;load&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;python&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;scripts&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;REGEXP&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39; to list them.&lt;/span&gt;
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gdb&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;
&lt;span class="n"&gt;Starting&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;program&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;amos&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ftl&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;debugging&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;libthread_db&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;enabled&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;Using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;libthread_db&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;library&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/lib/x86_64-linux-gnu/libthread_db.so.1&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;New&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff7c28700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;129418&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;New&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff7a27700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;129419&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;New&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff7826700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;129420&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;New&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff7625700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;129421&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;New&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff7424700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;129422&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;New&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff7223700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;129423&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;New&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff7022700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;129424&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;New&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff6e1e700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;129425&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;New&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff6c1a700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;129426&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;New&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff6a16700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;129427&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;New&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff6812700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;129428&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;New&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff660e700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;129429&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;New&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff640a700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;129430&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;New&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff6206700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;129431&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;New&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff6002700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;129432&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;47&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;13.278&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Building&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;that&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dumb&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;future&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;47&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;13.279&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Awaiting&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;that&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dumb&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;future&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;

&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;waytoodeep&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;received&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;signal&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SIGSEGV&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Segmentation&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fault&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;dumb&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;DumbFuture&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;core&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;future&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;future&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;=...&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;_cx&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mh"&gt;0x7fffffffd690&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;dumb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;
&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="w"&gt;                  &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0xF00D&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;u64&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gdb&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bt&lt;/span&gt;
&lt;span class="c1"&gt;#0  &amp;lt;waytoodeep::dumb::DumbFuture as core::future::future::Future&amp;gt;::poll (self=..., _cx=0x7fffffffd690) at src/dumb.rs:15&lt;/span&gt;
&lt;span class="c1"&gt;#1  0x00005555555ab3a3 in waytoodeep::main::{{closure}} () at src/main.rs:17&lt;/span&gt;
&lt;span class="c1"&gt;#2  0x00005555555adb29 in &amp;lt;core::future::from_generator::GenFuture&amp;lt;T&amp;gt; as core::future::future::Future&amp;gt;::poll (self=..., cx=0x7fffffffd690)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;amos&lt;/span&gt;&lt;span class="o"&gt;/.&lt;/span&gt;&lt;span class="n"&gt;rustup&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;toolchains&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;stable&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;unknown&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;gnu&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lib&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;rustlib&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;rust&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;library&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;core&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;future&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mod&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;
&lt;span class="c1"&gt;#3  0x00005555555adaa0 in tokio::park::thread::CachedParkThread::block_on::{{closure}} ()&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;amos&lt;/span&gt;&lt;span class="o"&gt;/.&lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;registry&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;github&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;ecc6299db9ec823&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.9&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;park&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;thread&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;263&lt;/span&gt;
&lt;span class="c1"&gt;#4  0x00005555555b1742 in tokio::coop::with_budget::{{closure}} (cell=0x7ffff7c2c412)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;amos&lt;/span&gt;&lt;span class="o"&gt;/.&lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;registry&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;github&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;ecc6299db9ec823&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.9&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;coop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;106&lt;/span&gt;
&lt;span class="c1"&gt;#5  0x00005555555a9f58 in std::thread::local::LocalKey&amp;lt;T&amp;gt;::try_with (self=0x555555925fc0, f=...)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;amos&lt;/span&gt;&lt;span class="o"&gt;/.&lt;/span&gt;&lt;span class="n"&gt;rustup&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;toolchains&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;stable&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;unknown&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;gnu&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lib&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;rustlib&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;rust&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;library&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;thread&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;local&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;376&lt;/span&gt;
&lt;span class="c1"&gt;#6  0x00005555555a9e3d in std::thread::local::LocalKey&amp;lt;T&amp;gt;::with (self=0x555555925fc0, f=...)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;amos&lt;/span&gt;&lt;span class="o"&gt;/.&lt;/span&gt;&lt;span class="n"&gt;rustup&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;toolchains&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;stable&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;unknown&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;gnu&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lib&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;rustlib&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;rust&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;library&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;thread&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;local&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;352&lt;/span&gt;
&lt;span class="c1"&gt;#7  0x00005555555ad7c8 in tokio::coop::with_budget (budget=..., f=...)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;amos&lt;/span&gt;&lt;span class="o"&gt;/.&lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;registry&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;github&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;ecc6299db9ec823&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.9&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;coop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;99&lt;/span&gt;
&lt;span class="c1"&gt;#8  tokio::coop::budget (f=...) at /home/amos/.cargo/registry/src/github.com-1ecc6299db9ec823/tokio-1.9.0/src/coop.rs:76&lt;/span&gt;
&lt;span class="c1"&gt;#9  tokio::park::thread::CachedParkThread::block_on (self=0x7fffffffd7a0, f=...)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;amos&lt;/span&gt;&lt;span class="o"&gt;/.&lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;registry&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;github&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;ecc6299db9ec823&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.9&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;park&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;thread&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;263&lt;/span&gt;
&lt;span class="c1"&gt;#10 0x00005555555abcc9 in tokio::runtime::enter::Enter::block_on (self=0x7fffffffd7f0, f=...)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;amos&lt;/span&gt;&lt;span class="o"&gt;/.&lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;registry&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;github&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;ecc6299db9ec823&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.9&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;runtime&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;enter&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;151&lt;/span&gt;
&lt;span class="c1"&gt;#11 0x00005555555acf2e in tokio::runtime::thread_pool::ThreadPool::block_on (self=0x7fffffffd908, future=...)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;amos&lt;/span&gt;&lt;span class="o"&gt;/.&lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;registry&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;github&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;ecc6299db9ec823&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.9&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;runtime&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;thread_pool&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mod&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;71&lt;/span&gt;
&lt;span class="c1"&gt;#12 0x00005555555b0dfd in tokio::runtime::Runtime::block_on (self=0x7fffffffd900, future=...)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;amos&lt;/span&gt;&lt;span class="o"&gt;/.&lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;registry&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;github&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;ecc6299db9ec823&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.9&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;runtime&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mod&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;452&lt;/span&gt;
&lt;span class="c1"&gt;#13 0x00005555555aa807 in waytoodeep::main () at src/main.rs:20&lt;/span&gt;
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gdb&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬å†æ¬¡ä¸¢å¤±äº†é«˜äº®é¢œè‰²ï¼Œè¿™é‡Œå¯ä»¥çœ‹ä¸€ä¸‹ï¼š
&lt;img alt="" src="https://fasterthanli.me/content/articles/understanding-rust-futures-by-going-way-too-deep/assets/gdb-colors.b45af429c46a37d9.webp"&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¯‘æ³¨ï¼šæˆ‘åœ¨æœ¬åœ°ç¯å¢ƒå¹¶æ²¡æœ‰é€šè¿‡ GDB å¤ç°å¸¦é«˜äº®çš„å †æ ˆè·Ÿè¸ªï¼Œåè€Œæ˜¯é€šè¿‡ LLDB å¯ä»¥çœ‹åˆ°é«˜äº®çš„å †æ ˆè·Ÿè¸ªã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ˜¯ä¸æ˜¯å¾ˆæ¼‚äº®ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç°åœ¨è®©æˆ‘ä»¬å›åˆ°æ­£å¸¸æœ‰ç”¨çš„ä»£ç ï¼Œç§»é™¤æ‰€æœ‰å…³äºè‡ªå·±å®ç°çš„ future ä»£ç ï¼š &lt;code&gt;src/dumb.rs&lt;/code&gt; å’Œ &lt;code&gt;mod dumb&lt;/code&gt; ã€‚å¹¶ä½¿ç”¨ä¸€ä¸ªè·å– future æ›¿ä»£ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="cp"&gt;#[tokio::main]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Building that fetch future...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Awaiting that fetch future...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;fut&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Done awaiting that fetch future&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_BACKTRACE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run
&lt;span class="w"&gt;   &lt;/span&gt;Compiling&lt;span class="w"&gt; &lt;/span&gt;waytoodeep&lt;span class="w"&gt; &lt;/span&gt;v0.1.0&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;/home/amos/ftl/waytoodeep&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;Finished&lt;span class="w"&gt; &lt;/span&gt;dev&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;unoptimized&lt;span class="w"&gt; &lt;/span&gt;+&lt;span class="w"&gt; &lt;/span&gt;debuginfo&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;target&lt;span class="o"&gt;(&lt;/span&gt;s&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.99s
&lt;span class="w"&gt;     &lt;/span&gt;Running&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;target/debug/waytoodeep&lt;span class="sb"&gt;`&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;17&lt;/span&gt;:51:49.281&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Building&lt;span class="w"&gt; &lt;/span&gt;that&lt;span class="w"&gt; &lt;/span&gt;fetch&lt;span class="w"&gt; &lt;/span&gt;future...
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;17&lt;/span&gt;:51:49.282&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Awaiting&lt;span class="w"&gt; &lt;/span&gt;that&lt;span class="w"&gt; &lt;/span&gt;fetch&lt;span class="w"&gt; &lt;/span&gt;future...
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;17&lt;/span&gt;:51:49.437&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/articles/whats-in-the-box&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;17&lt;/span&gt;:51:49.438&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Done&lt;span class="w"&gt; &lt;/span&gt;awaiting&lt;span class="w"&gt; &lt;/span&gt;that&lt;span class="w"&gt; &lt;/span&gt;fetch&lt;span class="w"&gt; &lt;/span&gt;future
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æœ‰ä¸¤ç§æ–¹å¼è€ƒè™‘æˆ‘ä»¬çš„å‡½æ•°ï¼Œä¸€ä¸ªæ˜¯è¯­æ³•ç³–å±‚ï¼šä¹Ÿå°±æ˜¯ &lt;code&gt;async fn&lt;/code&gt; ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kt"&gt;str&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error_for_status&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;content-type&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Got a response!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæ˜¯æ ¸å¿ƒå®ç°å±‚ï¼šä¸€ä¸ªæ™®é€šçš„ &lt;code&gt;fn&lt;/code&gt; ä»…ç”¨æ¥è¿”å›ä¸€ä¸ª future å¯¹è±¡ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;future&lt;/span&gt;::&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;fetch_thing&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt; &lt;span class="nc"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt; &lt;span class="kt"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;impl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;move&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error_for_status&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;content-type&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Got a response!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç”±äºå€Ÿç”¨ &lt;code&gt;client&lt;/code&gt; å’Œ &lt;code&gt;url&lt;/code&gt; ï¼Œæ‰€ä»¥ &lt;code&gt;Future&lt;/code&gt; å¯¹è±¡çš„å­˜æ´»æ—¶é—´ä¸èƒ½è¶…è¿‡ä¸¤è€…ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä¼šå°†ä¸Šé¢ä¸¤ä¸ªç”Ÿå‘½å‘¨æœŸå‘½åä¸º &lt;code&gt;'a&lt;/code&gt; ï¼Œ
å¹¶ä¸”è¿”å›çš„å€¼ä¹Ÿæ˜¯ä»»æ„å®ç°äº† &lt;code&gt;Future&lt;/code&gt; ï¼ˆé€šè¿‡ &lt;code&gt;Output&lt;/code&gt; ï¼‰åŒæ—¶ç”Ÿå‘½å‘¨æœŸä¹Ÿæ˜¯ &lt;code&gt;'a&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;æ•´ä¸ª &lt;code&gt;async move {}&lt;/code&gt; å¿«ä¹Ÿä»…ä»…æ˜¯â€œæ„å»ºçŠ¶æ€â€ -- ç­‰äºä¸€ä¸ªå®ç°äº† &lt;code&gt;Future&lt;/code&gt; çš„ç±»å‹ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åªæ˜¯æ— æ³•å‘½åå®ƒã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åªèƒ½å°½é‡è·å–å®ƒçš„æè¿°ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;type_name_of&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;T&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;str&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;any&lt;/span&gt;::&lt;span class="n"&gt;type_name&lt;/span&gt;::&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;// in main&lt;/span&gt;

&lt;span class="cp"&gt;#[tokio::main]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Building that fetch future...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;type_name&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;type_name_of&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;fut&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;That fetch future has a type..&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Awaiting that fetch future...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;fut&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Done awaiting that fetch future&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run
&lt;span class="w"&gt;    &lt;/span&gt;Finished&lt;span class="w"&gt; &lt;/span&gt;dev&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;unoptimized&lt;span class="w"&gt; &lt;/span&gt;+&lt;span class="w"&gt; &lt;/span&gt;debuginfo&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;target&lt;span class="o"&gt;(&lt;/span&gt;s&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.05s
&lt;span class="w"&gt;     &lt;/span&gt;Running&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;target/debug/waytoodeep&lt;span class="sb"&gt;`&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:00:39.774&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Building&lt;span class="w"&gt; &lt;/span&gt;that&lt;span class="w"&gt; &lt;/span&gt;fetch&lt;span class="w"&gt; &lt;/span&gt;future...
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:00:39.775&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;That&lt;span class="w"&gt; &lt;/span&gt;fetch&lt;span class="w"&gt; &lt;/span&gt;future&lt;span class="w"&gt; &lt;/span&gt;has&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;type..&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;core::future::from_generator::GenFuture&amp;lt;waytoodeep::fetch_thing::{{closure}}&amp;gt;&amp;quot;&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:00:39.775&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Awaiting&lt;span class="w"&gt; &lt;/span&gt;that&lt;span class="w"&gt; &lt;/span&gt;fetch&lt;span class="w"&gt; &lt;/span&gt;future...
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:00:39.882&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/articles/whats-in-the-box&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:00:39.882&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Done&lt;span class="w"&gt; &lt;/span&gt;awaiting&lt;span class="w"&gt; &lt;/span&gt;that&lt;span class="w"&gt; &lt;/span&gt;fetch&lt;span class="w"&gt; &lt;/span&gt;future
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ã€‚ã€‚ã€‚ä½†æ˜¯ç­‰ç­‰ï¼Œç”±äºæˆ‘ä»¬ä½¿ç”¨äº† &lt;code&gt;async&lt;/code&gt; è¯­æ³•æ‰€ä»¥å®ƒæ˜¯ä¸€ä¸ªç¼–è¯‘å™¨ç”Ÿæˆçš„ç±»å‹ã€‚æŸç§æ„ä¹‰ä¸Šæˆ‘ä»¬æ— æ³•å‘½åå®ƒä¹Ÿå°±æ„å‘³è¿™æˆ‘ä»¬æ— æ³•ç»‘å®šè¿™ä¸ªå¯¹è±¡ï¼Œæˆ–è€…ç¼–å†™ä¸€ä¸ªå‡½æ•°ä»…ä»…æ¥å—è¯¥ç±»å‹ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è®©æˆ‘ä»¬è‡ªå·±ç›¸ä¿¡ future å¯¹è±¡åœ¨æˆ‘ä»¬çœŸæ­£è½®è¯¢å®ƒä¹‹å‰å®ƒä¸ä¼šåšä»»ä½•å·¥ä½œï¼Œæˆ‘ä»¬å¯ä»¥æ‰“å¼€ &lt;code&gt;reqwest&lt;/code&gt; çš„è°ƒè¯•æ—¥å¿—ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info,reqwest&lt;span class="o"&gt;=&lt;/span&gt;debug&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run
&lt;span class="w"&gt;   &lt;/span&gt;Compiling&lt;span class="w"&gt; &lt;/span&gt;waytoodeep&lt;span class="w"&gt; &lt;/span&gt;v0.1.0&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;/home/amos/ftl/waytoodeep&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;Finished&lt;span class="w"&gt; &lt;/span&gt;dev&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;unoptimized&lt;span class="w"&gt; &lt;/span&gt;+&lt;span class="w"&gt; &lt;/span&gt;debuginfo&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;target&lt;span class="o"&gt;(&lt;/span&gt;s&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;.07s
&lt;span class="w"&gt;     &lt;/span&gt;Running&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;target/debug/waytoodeep&lt;span class="sb"&gt;`&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:05:07.384&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Building&lt;span class="w"&gt; &lt;/span&gt;that&lt;span class="w"&gt; &lt;/span&gt;fetch&lt;span class="w"&gt; &lt;/span&gt;future...
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:05:07.385&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;That&lt;span class="w"&gt; &lt;/span&gt;fetch&lt;span class="w"&gt; &lt;/span&gt;future&lt;span class="w"&gt; &lt;/span&gt;has&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;type..&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;core::future::from_generator::GenFuture&amp;lt;waytoodeep::fetch_thing::{{closure}}&amp;gt;&amp;quot;&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:05:07.385&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Awaiting&lt;span class="w"&gt; &lt;/span&gt;that&lt;span class="w"&gt; &lt;/span&gt;fetch&lt;span class="w"&gt; &lt;/span&gt;future...
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:05:07.385&lt;span class="w"&gt; &lt;/span&gt;DEBUG&lt;span class="w"&gt; &lt;/span&gt;reqwest::connect:&lt;span class="w"&gt; &lt;/span&gt;starting&lt;span class="w"&gt; &lt;/span&gt;new&lt;span class="w"&gt; &lt;/span&gt;connection:&lt;span class="w"&gt; &lt;/span&gt;https://fasterthanli.me/
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:05:07.503&lt;span class="w"&gt; &lt;/span&gt;DEBUG&lt;span class="w"&gt; &lt;/span&gt;reqwest::async_impl::client:&lt;span class="w"&gt; &lt;/span&gt;response&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;200 OK&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;https://fasterthanli.me/articles/whats-in-the-box
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:05:07.503&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/articles/whats-in-the-box&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:05:07.503&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Done&lt;span class="w"&gt; &lt;/span&gt;awaiting&lt;span class="w"&gt; &lt;/span&gt;that&lt;span class="w"&gt; &lt;/span&gt;fetch&lt;span class="w"&gt; &lt;/span&gt;future
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç”šè‡³å¯¹äºæ¯ä¸€ä¸ªåŒ…ï¼ˆcrateï¼‰ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥é€šè¿‡ç›‘å¬ &lt;a href="https://lib.rs/crates/hyper"&gt;hyper&lt;/a&gt; å’Œ &lt;a href="https://lib.rs/crates/h2"&gt;h2&lt;/a&gt; æ¥è§‚å¯Ÿï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Finished&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;unoptimized&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;debuginfo&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.04&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;Running&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;05&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;59.973&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Building&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;that&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;future&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;05&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;59.973&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;That&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;future&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;has&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="o"&gt;..&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;type_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;core::future::from_generator::GenFuture&amp;lt;waytoodeep::fetch_thing::{{closure}}&amp;gt;&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;05&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;59.973&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Awaiting&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;that&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;future&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;05&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;59.974&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reqwest&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;starting&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;fasterthanli&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;me&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;05&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;59.974&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;hyper&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;dns&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;resolving&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;fasterthanli.me&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;05&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;59.989&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;hyper&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;connecting&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;172.67&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;196.144&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;443&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;hyper&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;connected&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;172.67&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;196.144&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;443&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rustls&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;hs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;No&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cached&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;session&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DNSNameRef&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;fasterthanli.me&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rustls&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;hs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Not&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;resuming&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;any&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;session&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.016&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rustls&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;hs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ciphersuite&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TLS13_CHACHA20_POLY1305_SHA256&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.016&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rustls&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tls13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Not&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;resuming&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.017&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rustls&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tls13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TLS1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;encrypted&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;extensions&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ServerNameAck&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Protocols&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;PayloadU8&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;104&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;])])]&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.017&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rustls&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;hs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ALPN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;protocol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Some&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;b&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;h2&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.018&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;h2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;binding&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;connection&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.018&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;h2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bound&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.018&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;h2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;codec&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;framed_write&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Settings&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;flags&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0x0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;enable_push&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;initial_window_size&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2097152&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;max_frame_size&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16384&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.019&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;peer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;}:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;h2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;codec&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;framed_write&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;WindowUpdate&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stream_id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;StreamId&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size_increment&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;5177345&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.019&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;hyper&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;pool&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pooling&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;idle&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;https&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fasterthanli&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;me&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.020&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;peer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;}:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;h2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;codec&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;framed_write&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Headers&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stream_id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;StreamId&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;flags&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0x5&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;END_HEADERS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;END_STREAM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.029&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;peer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;}:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rustls&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tls13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Ticket&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;saved&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.029&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;peer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;}:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rustls&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tls13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Ticket&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;saved&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.029&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;peer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;}:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;h2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;codec&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;framed_read&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;received&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Settings&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;flags&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0x0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;max_concurrent_streams&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;initial_window_size&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;65536&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;max_frame_size&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16777215&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.030&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;peer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;}:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;h2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;codec&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;framed_write&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Settings&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;flags&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0x1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ACK&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.030&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;peer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;}:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;h2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;codec&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;framed_read&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;received&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;WindowUpdate&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stream_id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;StreamId&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size_increment&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2147418112&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.041&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;peer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;}:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;h2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;codec&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;framed_read&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;received&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Settings&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;flags&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0x1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ACK&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.041&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;peer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;}:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;h2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;proto&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;received&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ACK&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;applying&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Settings&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;flags&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0x0&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;enable_push&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;initial_window_size&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2097152&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;max_frame_size&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16384&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.120&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;peer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;}:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;h2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;codec&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;framed_read&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;received&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Headers&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stream_id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;StreamId&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;flags&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mh"&gt;0x4&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;END_HEADERS&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.120&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;peer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;}:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;h2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;codec&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;framed_read&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;received&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Data&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stream_id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;StreamId&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.121&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reqwest&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;async_impl&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;200 OK&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;fasterthanli&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;me&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;articles&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;whats&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;box&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.121&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Got&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;fasterthanli&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;me&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;articles&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;whats&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;box&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Some&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.121&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Done&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;awaiting&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;that&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;future&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.121&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;peer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;}:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;h2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;codec&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;framed_read&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;received&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Data&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stream_id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;StreamId&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.122&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;peer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;}:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;h2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;codec&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;framed_write&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Reset&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stream_id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;StreamId&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;error_code&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CANCEL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.122&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;peer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;}:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;h2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;codec&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;framed_write&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;frame&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;GoAway&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;error_code&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NO_ERROR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;last_stream_id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;StreamId&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.122&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;peer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;}:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;h2&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;proto&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;NO_ERROR&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;06&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;00.122&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DEBUG&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;peer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;}:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rustls&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;session&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Sending&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;warning&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;alert&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CloseNotify&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;blockquote&gt;
&lt;p&gt;ä¸Šé¢å‡ºç°äº† rustlsï¼Œå¹¶ä¸”ä½¿ç”¨äº† TLS 1.3ï¼Œä½œè€…åšè¿‡&lt;a href="https://www.youtube.com/watch?v=YHIiVsFybLA"&gt;ä¸€æœŸè§†é¢‘&lt;/a&gt;ä»‹ç»è¿‡ TLS 1.3ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™äº›åº”è¯¥è¶³å¤Ÿè¯´æœä½ ï¼Œé™¤éä½ åªç›¸ä¿¡å†…æ ¸æ‰€è¯´çš„ï¼Œæ‰€ä»¥è®©æˆ‘ä»¬çœ‹çœ‹è°ƒç”¨å †æ ˆåªä¸ºäº†æ›´åŠ ç¡®å®šã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨ &lt;code&gt;await&lt;/code&gt; future å¯¹è±¡ä¹‹å‰å¢åŠ ä¸€ç§’é’Ÿçš„ä¼‘çœ ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;::&lt;span class="n"&gt;time&lt;/span&gt;::&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;time&lt;/span&gt;::&lt;span class="n"&gt;Duration&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#[tokio::main]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Building that fetch future...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Sleeping for a bit...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Duration&lt;/span&gt;::&lt;span class="n"&gt;from_secs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Awaiting that fetch future...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;fut&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Done awaiting that fetch future&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;build&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;strace&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;connect&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;./target/debug/waytoodeep
&lt;span class="w"&gt;   &lt;/span&gt;Compiling&lt;span class="w"&gt; &lt;/span&gt;waytoodeep&lt;span class="w"&gt; &lt;/span&gt;v0.1.0&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;/home/amos/ftl/waytoodeep&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;Finished&lt;span class="w"&gt; &lt;/span&gt;dev&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;unoptimized&lt;span class="w"&gt; &lt;/span&gt;+&lt;span class="w"&gt; &lt;/span&gt;debuginfo&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;target&lt;span class="o"&gt;(&lt;/span&gt;s&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;.13s
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:09:36.595&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Building&lt;span class="w"&gt; &lt;/span&gt;that&lt;span class="w"&gt; &lt;/span&gt;fetch&lt;span class="w"&gt; &lt;/span&gt;future...
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:09:36.596&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Sleeping&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;bit...
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:09:37.599&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Awaiting&lt;span class="w"&gt; &lt;/span&gt;that&lt;span class="w"&gt; &lt;/span&gt;fetch&lt;span class="w"&gt; &lt;/span&gt;future...
connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;9&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_INET,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;htons&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;443&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_addr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;inet_addr&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;104.21.92.169&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-1&lt;span class="w"&gt; &lt;/span&gt;EINPROGRESS&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;Operation&lt;span class="w"&gt; &lt;/span&gt;now&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;progress&lt;span class="o"&gt;)&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:09:37.720&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/articles/whats-in-the-box&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:09:37.721&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Done&lt;span class="w"&gt; &lt;/span&gt;awaiting&lt;span class="w"&gt; &lt;/span&gt;that&lt;span class="w"&gt; &lt;/span&gt;fetch&lt;span class="w"&gt; &lt;/span&gt;future
+++&lt;span class="w"&gt; &lt;/span&gt;exited&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å†æ¬¡å¼ºè°ƒï¼Œé™„ä¸Šä¼šè®©æ˜¾è‘—æé«˜ä¸Šé¢ä¿¡æ¯çš„å¯è¯»æ€§ï¼Œå¦‚æœä¸è®©æˆ‘é€‰æ‹©å®ƒä»¬çš„è¯æˆ‘æ˜¯éå¸¸å–œæ¬¢é«˜äº®çš„ã€‚æˆ‘æœ¬åœ°çœ‹èµ·æ¥æ˜¯è¿™æ ·çš„ï¼š
&lt;img alt="" src="https://fasterthanli.me/content/articles/understanding-rust-futures-by-going-way-too-deep/assets/strace-colors.a4163f4bda179c2b.webp"&gt;
ç”±äº &lt;code&gt;tracing-subscriber&lt;/code&gt; é»˜è®¤æ ¼å¼ä¼šè¾“å‡ºæ—¶é—´æˆ³ï¼Œå¯ä»¥çœ‹åˆ°ç¨‹åºä¼‘çœ äº†1åˆ†é’Ÿï¼ˆå¤–åŠ 3æ¯«ç§’ï¼‰ï¼Œè€Œä¸”åªæœ‰æˆ‘ä»¬çœŸæ­£è°ƒç”¨ &lt;code&gt;await&lt;/code&gt; æ—¶æˆ‘ä»¬çš„ç¨‹åºæ‰ä¼šå¼€å§‹è¿æ¥åˆ°æ‰˜ç®¡æ–‡ç« çš„ CDN èŠ‚ç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;å¥½äº†ï¼è®©æˆ‘ä»¬å†æ¬¡å°è¯•æ‹‰å–ä¸¤ç¯‡æ–‡ç« ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="cp"&gt;#[tokio::main]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fut1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fut2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;fut1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;fut2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å†æ¬¡æ£€æŸ¥æ—¥å¿—ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info,reqwest&lt;span class="o"&gt;=&lt;/span&gt;debug&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:31:47.396&lt;span class="w"&gt; &lt;/span&gt;DEBUG&lt;span class="w"&gt; &lt;/span&gt;reqwest::connect:&lt;span class="w"&gt; &lt;/span&gt;starting&lt;span class="w"&gt; &lt;/span&gt;new&lt;span class="w"&gt; &lt;/span&gt;connection:&lt;span class="w"&gt; &lt;/span&gt;https://fasterthanli.me/
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:31:47.536&lt;span class="w"&gt; &lt;/span&gt;DEBUG&lt;span class="w"&gt; &lt;/span&gt;reqwest::async_impl::client:&lt;span class="w"&gt; &lt;/span&gt;response&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;200 OK&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;https://fasterthanli.me/articles/whats-in-the-box
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:31:47.537&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/articles/whats-in-the-box&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:31:47.627&lt;span class="w"&gt; &lt;/span&gt;DEBUG&lt;span class="w"&gt; &lt;/span&gt;reqwest::async_impl::client:&lt;span class="w"&gt; &lt;/span&gt;response&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;200 OK&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;https://fasterthanli.me/series/advent-of-code-2020/part-13
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:31:47.627&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/series/advent-of-code-2020/part-13&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;éå¸¸æœ‰è¶£ã€‚ä»è¿™é‡Œå¯ä»¥çœ‹åˆ°ï¼Œ &lt;code&gt;reqwest&lt;/code&gt; ä¸ºä¸¤ä¸ªè¯·æ±‚å¤ç”¨äº†ç›¸åŒçš„è¿æ¥ã€‚æˆ‘ä¼šè¿™ä¹ˆè¯´æ˜¯å› æˆ‘åªçœ‹åˆ°äº†ä¸€è¡Œ &lt;code&gt;reqwest::connect&lt;/code&gt; æ—¥å¿—ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬å¿«é€Ÿé€šè¿‡ &lt;code&gt;strace&lt;/code&gt; æ£€æŸ¥ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;build&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;strace&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;connect&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;./target/debug/waytoodeep&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/dev/null
connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;9&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_INET,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;htons&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;443&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_addr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;inet_addr&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;172.67.196.144&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-1&lt;span class="w"&gt; &lt;/span&gt;EINPROGRESS&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;Operation&lt;span class="w"&gt; &lt;/span&gt;now&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;progress&lt;span class="o"&gt;)&lt;/span&gt;
+++&lt;span class="w"&gt; &lt;/span&gt;exited&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç°åœ¨å¯ä»¥ç¡®è®¤äº†ï¼Œåªæœ‰ä¸€æ¬¡è¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œç¬¬ä¸€ä¸ªè¯·æ±‚å®Œæˆåæ‰å¼€å§‹äº†ç¬¬äºŒä¸ªè¯·æ±‚ã€‚ç¬¬ä¸€ä¸ªè€—è´¹äº† &lt;code&gt;536-396 = 140&lt;/code&gt; æ¯«ç§’ï¼Œä½†æ˜¯ç¬¬äºŒä¸ªè€—è´¹äº† &lt;code&gt;627-537 = 90&lt;/code&gt; æ¯«ç§’ï¼&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Emmmï¼Œç°åœ¨æˆ‘ä»¬è¿è¡Œæ„å»ºçš„æ˜¯ debug ç‰ˆæœ¬ä¸æ˜¯å—ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™æ˜¯çœŸçš„ã€‚æˆ‘ç¡®ä¿¡æˆ‘ä»¬é¢ä¸´çš„æ˜¯ IO å¯†é›†å‹ï¼Œè€Œä¸æ˜¯ CPU å¯†é›†å‹ã€‚&lt;/p&gt;
&lt;p&gt;debug ç‰ˆæœ¬çš„æ„å»ºç»å¯¹æœ‰ä¸€äº›é¢å¤–çš„å¼€é”€ï¼Œä½†æ˜¯æˆ‘æ€€ç–‘è¿™é‡Œå®ƒä¸ä¼šå¤ªå½±å“å»¶è¿Ÿã€‚æ— è®ºå¦‚ä½•ï¼Œè®©æˆ‘ä»¬æ£€æŸ¥ä¸€ä¸‹ï¼š
ï¼ˆæ³¨æ„ --releaseï¼‰&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info,reqwest&lt;span class="o"&gt;=&lt;/span&gt;debug&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:34:59.211&lt;span class="w"&gt; &lt;/span&gt;DEBUG&lt;span class="w"&gt; &lt;/span&gt;reqwest::connect:&lt;span class="w"&gt; &lt;/span&gt;starting&lt;span class="w"&gt; &lt;/span&gt;new&lt;span class="w"&gt; &lt;/span&gt;connection:&lt;span class="w"&gt; &lt;/span&gt;https://fasterthanli.me/
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:34:59.343&lt;span class="w"&gt; &lt;/span&gt;DEBUG&lt;span class="w"&gt; &lt;/span&gt;reqwest::async_impl::client:&lt;span class="w"&gt; &lt;/span&gt;response&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;200 OK&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;https://fasterthanli.me/articles/whats-in-the-box
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:34:59.343&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/articles/whats-in-the-box&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:34:59.427&lt;span class="w"&gt; &lt;/span&gt;DEBUG&lt;span class="w"&gt; &lt;/span&gt;reqwest::async_impl::client:&lt;span class="w"&gt; &lt;/span&gt;response&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;200 OK&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;https://fasterthanli.me/series/advent-of-code-2020/part-13
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:34:59.427&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/series/advent-of-code-2020/part-13&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬è®¡ç®—ä¸€ä¸‹å»¶è¿Ÿ &lt;code&gt;343-211 = 132ms&lt;/code&gt; ï¼Œ &lt;code&gt;427-343 = 84ms&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;å‡ æ¯«ç§’çš„å·®å¼‚å¯èƒ½çš„è§£é‡Šæ˜¯é‚»å±…æ‰“å¼€äº†ä¸€ä¸ª YouTube è§†é¢‘å¯¼è‡´æ— çº¿ç”µæ³¢çˆ†å‘ï¼Œä»è€Œå¯¼è‡´å†²çªï¼ˆ802.11 æ²¡æœ‰ç©ºä¸­æµé‡æ§åˆ¶ï¼Œå…¨æ°‘è‡ªç”±ï¼ˆfree-for-allï¼‰ï¼‰å’Œé‡ä¼ ã€‚&lt;/p&gt;
&lt;p&gt;æˆ–è€…å¦å¤–ä¸€ç™¾ä¸‡ä¸ªåŸå› ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬ä¸ç»§ç»­åˆ†æçš„åŸå› ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬å›åˆ°æ–‡ç« çš„ä¸»é¢˜ã€‚&lt;/p&gt;
&lt;h3 id="ç­‰å¾…ç¬¬ä¸€ä¸ªå®Œæˆ"&gt;ç­‰å¾…ç¬¬ä¸€ä¸ªå®Œæˆ&lt;/h3&gt;
&lt;p&gt;æ˜¯çš„ï¼ç­‰å¾…ç¬¬ä¸€ä¸ªå®Œæˆã€‚æ‰€ä»¥æˆ‘ä»¬å¦‚ä½•è®©ç¨‹åºåŒæ—¶è¯·æ±‚ä¸¤ä¸ªï¼Ÿ&lt;/p&gt;
&lt;p&gt;å…¶å®æœ‰ä¸€å¤§å †æ–¹å¼ï¼&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸€ä¸ªæ‰§è¡Œå™¨ä¸Šæ‰§è¡Œï¼ˆ &lt;code&gt;spawn&lt;/code&gt; ï¼‰è¿™äº› future å¯¹è±¡ï¼Œç„¶åä¼‘çœ ä¸€ç§’é’Ÿã€‚1 ç§’é’Ÿè¶³å¤Ÿäº†å§ï¼Ÿ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="cp"&gt;#[tokio::main]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fut1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;::&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fut1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fut2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;::&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fut2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;::&lt;span class="n"&gt;time&lt;/span&gt;::&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Duration&lt;/span&gt;::&lt;span class="n"&gt;from_secs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;reqwest&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;quiet&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="k"&gt;release&lt;/span&gt;
&lt;span class="k"&gt;error&lt;/span&gt;&lt;span class="err"&gt;[&lt;/span&gt;&lt;span class="n"&gt;E0597&lt;/span&gt;&lt;span class="err"&gt;]&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`client`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;does&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;not&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;live&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;long&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;enough&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;28&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fut1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="o"&gt;------------^^^^^^^--------&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="n"&gt;borrowed&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;value&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;does&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;not&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;live&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;long&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;enough&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;argument&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;requires&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;that&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`client`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;borrowed&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`&amp;#39;static`&lt;/span&gt;
&lt;span class="p"&gt;...&lt;/span&gt;
&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`client`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dropped&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;here&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;still&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;borrowed&lt;/span&gt;

&lt;span class="k"&gt;error&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;aborting&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;due&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;previous&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;error&lt;/span&gt;

&lt;span class="k"&gt;For&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;more&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;information&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;about&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;error&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;try&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`rustc --explain E0597`&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;span class="k"&gt;error&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;could&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;not&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`waytoodeep`&lt;/span&gt;

&lt;span class="k"&gt;To&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;learn&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;more&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;again&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;with&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;verbose&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é¢ï¼Œé™¤éæˆ‘ä»¬ä¸å¯ä»¥ã€‚ä¸å¯ä»¥æ˜¯å› ä¸ºã€‚ã€‚ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æˆ‘ä»¬å°†ã€Œfuture å¯¹è±¡äº¤ç»™æ‰§è¡Œå™¨æ‰§è¡Œã€å¹¶å°† future å¯¹è±¡è½¬äº¤ç»™æ‰§è¡Œå™¨ï¼Œå¯¹å§ï¼Ÿæˆ‘ä»¬è½¬ç§»äº†å®ƒå’Œå®ƒçš„å†…å®¹çš„æ‰€æœ‰æƒã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå³ä½¿æˆ‘ä»¬ä¸å¯¹å…¶è¿›è¡Œ &lt;code&gt;await&lt;/code&gt; ï¼Œfuture å¯¹è±¡å› ä¸ºæ˜¯ã€Œæ‰§è¡Œå™¨éœ€è¦åšã€çš„ä¸€éƒ¨åˆ†ä¾ç„¶ä¼šè¢«æ‰§è¡Œï¼Œæ‰€ä»¥å³ä½¿æˆ‘ä»¬ä» &lt;code&gt;main&lt;/code&gt; è¿”å› future å¯¹è±¡ä¹Ÿä¼šè¢«è½®è¯¢ï¼ˆpolledï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å¦‚æœæˆ‘ä»¬ä» &lt;code&gt;main&lt;/code&gt; è¿”å›ï¼Œåˆ™æ•´ä¸ªç¨‹åºéƒ½ä¼šé€€å‡ºã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œä¹Ÿå¯ä»¥æ˜¯ä»»ä½•å‡½æ•°ï¼ˆè¿™é‡Œæ˜¯ &lt;code&gt;main&lt;/code&gt; ï¼‰ã€‚é‡è¦çš„æ˜¯å¦‚æœå‡½æ•°è¿”å›äº†ä½†æ˜¯ future å¯¹è±¡å€Ÿç”¨äº†éƒ¨åˆ†æ•°æ®å°†æ— æ³•é€šè¿‡å€Ÿç”¨æ£€æŸ¥å™¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™è®©æˆ‘å¾ˆé«˜å…´ï¼Œå› ä¸ºè¿™æ„å‘³ç€æˆ‘ä»¬ä¸ä¼šæ„å¤–è®¿é—®åˆ°ä¸€äº›è¢«é‡Šæ”¾çš„èµ„æºï¼š&lt;a href="https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=use+after+free"&gt;UAF&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæˆ‘ä»¬çš„ä¾‹å­æ²¡æœ‰å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ã€‚ã€‚ã€‚æˆ‘ä»¬éœ€è¦è§£å†³è¿™ä¸ªé—®é¢˜ã€‚å¦‚æœ &lt;code&gt;fetch_thing&lt;/code&gt; è¿”å›çš„ future å¯¹è±¡æ˜¯ &lt;code&gt;'static&lt;/code&gt; çš„å‘¢ï¼Ÿæˆ–è€…å®ƒä¸å€Ÿç”¨ä»»ä½•ä¸œè¥¿ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ç¨‹åºç°åœ¨çœ‹èµ·æ¥å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;future&lt;/span&gt;::&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;fetch_thing&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt; &lt;span class="nc"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt; &lt;span class="kt"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;impl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;move&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error_for_status&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;content-type&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Got a response!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¥½å§ï¼Œä¹‹å‰æˆ‘ä»¬ç”¨äº† &lt;code&gt;async fn&lt;/code&gt; ï¼Œä½†æ˜¯ä¸ºäº†æ›´åŠ æ·±å…¥çš„ç†è§£ï¼Œæˆ‘ä»¬ä¸å¾—ä¸æ”¾å¼ƒæ¼‚äº®çš„è¯­æ³•ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å¹¸è¿çš„æ˜¯ï¼Œè¿™æ­£æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;fetch_thing&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt; &lt;span class="nc"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt; &lt;span class="kt"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="c1"&gt;//                                                 ğŸ‘‡&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;impl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬å€Ÿç”¨äº† &lt;code&gt;client&lt;/code&gt; å’Œ &lt;code&gt;url&lt;/code&gt; æˆ‘ä»¬å¿…é¡»é¿å…è¿™ä¸ªé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸º &lt;code&gt;url&lt;/code&gt; æœ¬èº«å°±æ˜¯å¸¸é‡ï¼Œæ‰€ä»¥å¾ˆå®¹æ˜“è§£å†³ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_1&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kt"&gt;str&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://fasterthanli.me/articles/whats-in-the-box&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;const&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_2&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kt"&gt;str&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;https://fasterthanli.me/series/advent-of-code-2020/part-13&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®ƒä»¬æœ¬èº«å°±æ˜¯ &lt;code&gt;'static&lt;/code&gt; ã€‚æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦è°ƒæ•´éœ€è¦ &lt;code&gt;'static&lt;/code&gt; å°±è¡Œ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;fetch_thing&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt; &lt;span class="nc"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;//       ğŸ‘‡&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;impl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;éå¸¸å¥½ï¼è§£å†³äº†ä¸€ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œè¿˜å‰©ä¸‹ä¸€ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥è¦æ±‚ &lt;code&gt;client&lt;/code&gt; çš„ç”Ÿå‘½å‘¨æœŸä¸º &lt;code&gt;'static&lt;/code&gt; ã€‚ç”±äºå®ƒæ˜¯ä¸€ä¸ª  &lt;code&gt;Client&lt;/code&gt; çš„å¼•ç”¨ï¼Œæ„å‘³ç€ &lt;code&gt;Cleint&lt;/code&gt; æœ¬èº«ä¹Ÿéœ€è¦æ˜¯ &lt;code&gt;'static&lt;/code&gt; ç”Ÿå‘½å‘¨æœŸã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;//         ğŸ‘‡&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;static&lt;/span&gt; &lt;span class="nc"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;impl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç”±äºå®ƒè¢« &lt;code&gt;main&lt;/code&gt; æ‰€æœ‰ï¼Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥ï¼Œå¯ä»¥ã€‚ã€‚ã€‚å¯ä»¥æ³„æ¼å®ƒï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="cp"&gt;#[tokio::main]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;leaked_client&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Box&lt;/span&gt;::&lt;span class="n"&gt;leak&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;Box&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fut1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;leaked_client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fut2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;leaked_client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;::&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fut1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;::&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fut2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;::&lt;span class="n"&gt;time&lt;/span&gt;::&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Duration&lt;/span&gt;::&lt;span class="n"&gt;from_secs&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®Œç¾ï¼æ²¡æœ‰ç”Ÿå‘½å‘¨æœŸçš„é—®é¢˜äº†ã€‚&lt;/p&gt;
&lt;p&gt;ä»…ä»…å°†æ‰€æœ‰ä¸œè¥¿æ³„æ¼å°±è¡Œã€‚çœ‹åˆ°æ²¡ï¼Ÿä½ ä¸éœ€è¦ Cï¼&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info,reqwest&lt;span class="o"&gt;=&lt;/span&gt;debug&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:54:53.614&lt;span class="w"&gt; &lt;/span&gt;DEBUG&lt;span class="w"&gt; &lt;/span&gt;reqwest::connect:&lt;span class="w"&gt; &lt;/span&gt;starting&lt;span class="w"&gt; &lt;/span&gt;new&lt;span class="w"&gt; &lt;/span&gt;connection:&lt;span class="w"&gt; &lt;/span&gt;https://fasterthanli.me/
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:54:53.614&lt;span class="w"&gt; &lt;/span&gt;DEBUG&lt;span class="w"&gt; &lt;/span&gt;reqwest::connect:&lt;span class="w"&gt; &lt;/span&gt;starting&lt;span class="w"&gt; &lt;/span&gt;new&lt;span class="w"&gt; &lt;/span&gt;connection:&lt;span class="w"&gt; &lt;/span&gt;https://fasterthanli.me/
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:54:53.708&lt;span class="w"&gt; &lt;/span&gt;DEBUG&lt;span class="w"&gt; &lt;/span&gt;reqwest::async_impl::client:&lt;span class="w"&gt; &lt;/span&gt;response&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;200 OK&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;https://fasterthanli.me/articles/whats-in-the-box
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:54:53.708&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/articles/whats-in-the-box&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:54:53.733&lt;span class="w"&gt; &lt;/span&gt;DEBUG&lt;span class="w"&gt; &lt;/span&gt;reqwest::async_impl::client:&lt;span class="w"&gt; &lt;/span&gt;response&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;200 OK&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;https://fasterthanli.me/series/advent-of-code-2020/part-13
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:54:53.733&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/series/advent-of-code-2020/part-13&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;éï½ï½å¸¸æœ‰è¶£ï¼&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„ä¸¤ä¸ªè¯·æ±‚è‚¯å®šæ˜¯å¹¶å‘çš„å‘å‡ºå»äº†ï¼Œæˆ‘ä»¬ä¹‹æ‰€ä»¥çŸ¥é“æ˜¯å› ä¸ºä»æˆ‘çš„ç¬”è®°æœ¬ä¸Šè¯·æ±‚æˆ‘çš„ç½‘ç«™å¤§æ¦‚è€—æ—¶ 80ms åˆ° 140ms ä¹‹é—´ï¼Œä½†æ˜¯åœ¨æ—¥å¿—ä¸­æˆ‘ä»¬çœ‹åˆ°ä¸¤ä¸ªå“åº”ä¹‹é—´åªæœ‰ ~25ms çš„é—´éš”ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è¿˜å¯ä»¥çœ‹åˆ° &lt;code&gt;reqwest&lt;/code&gt; æœ‰è¿æ¥æ± æœºåˆ¶ï¼šåŒæ—¶åˆ›å»ºäº†ä¸¤ä¸ªè¿æ¥ã€‚å¯èƒ½æ˜¯å› ä¸ºæˆ‘ä»¬å¼€å§‹ç¬¬äºŒä¸ªè¿æ¥çš„æ—¶å€™ç¬¬ä¸€ä¸ªè¯·æ±‚çš„è¿æ¥è¿˜æ²¡æœ‰å»ºç«‹å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;ä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬é€šè¿‡ &lt;code&gt;strace&lt;/code&gt; å¯ä»¥çœ‹åˆ°ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;build&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;strace&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;connect&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;./target/release/waytoodeep
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:58:16.425&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/articles/whats-in-the-box&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:58:16.443&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/series/advent-of-code-2020/part-13&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
+++&lt;span class="w"&gt; &lt;/span&gt;exited&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ã€‚ã€‚ã€‚ä¸¤ä¸ª &lt;code&gt;connect&lt;/code&gt; è°ƒç”¨ï¼å¦‚æˆ‘æ‰€æ–™ï¼&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è°¬è®ºï¼šä¸€ä¸ª &lt;code&gt;connect&lt;/code&gt; è°ƒç”¨éƒ½æ²¡çœ‹åˆ°ï¼Ÿå› ä¸º Rust æ„å»º HTTP/2 è¯·æ±‚çš„æ—¶å€™ç”šè‡³éƒ½éœ€è¦å»ºç«‹ TCP è¿æ¥ã€‚çœŸæ˜¯é©å‘½æ€§çš„ï¼&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™å½“ç„¶ä¸æ˜¯çœŸçš„ã€‚å¯èƒ½åœ¨å…¶ä»–çº¿ç¨‹æ‰§è¡Œäº†ï¼Ÿä¹Ÿè®¸ &lt;code&gt;strace&lt;/code&gt; é»˜è®¤ä»…è·Ÿè¸ªäº†ä¸»çº¿ç¨‹ï¼Ÿ&lt;/p&gt;
&lt;p&gt;å•Šï¼Œå¯¹äº†ï¼Œ &lt;code&gt;-f&lt;/code&gt; å¯ä»¥è·Ÿè¸ªæ‰€æœ‰ã€Œå­è¿›ç¨‹ã€ï¼Œå°±åƒå¤§å®¶çŸ¥é“çš„é‚£æ · Linux çº¿ç¨‹ä»…ä»…æ˜¯æŠ«äº†ä»¶é£è¡£çš„è¿›ç¨‹ï¼ˆæˆ–è€…å…¶ä»–æ–¹å¼ï¼‰ã€‚æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;build&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;strace&lt;span class="w"&gt; &lt;/span&gt;-f&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;connect&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;./target/release/waytoodeep
strace:&lt;span class="w"&gt; &lt;/span&gt;Process&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154612&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;attached
strace:&lt;span class="w"&gt; &lt;/span&gt;Process&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154613&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;attached
strace:&lt;span class="w"&gt; &lt;/span&gt;Process&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154614&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;attached
strace:&lt;span class="w"&gt; &lt;/span&gt;Process&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154615&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;attached
strace:&lt;span class="w"&gt; &lt;/span&gt;Process&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154616&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;attached
strace:&lt;span class="w"&gt; &lt;/span&gt;Process&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154617&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;attached
strace:&lt;span class="w"&gt; &lt;/span&gt;Process&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154618&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;attached
strace:&lt;span class="w"&gt; &lt;/span&gt;Process&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154619&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;attached
strace:&lt;span class="w"&gt; &lt;/span&gt;Process&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154620&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;attached
strace:&lt;span class="w"&gt; &lt;/span&gt;Process&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154621&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;attached
strace:&lt;span class="w"&gt; &lt;/span&gt;Process&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154622&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;attached
strace:&lt;span class="w"&gt; &lt;/span&gt;Process&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154623&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;attached
strace:&lt;span class="w"&gt; &lt;/span&gt;Process&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154624&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;attached
strace:&lt;span class="w"&gt; &lt;/span&gt;Process&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154625&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;attached
strace:&lt;span class="w"&gt; &lt;/span&gt;Process&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154626&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;attached
strace:&lt;span class="w"&gt; &lt;/span&gt;Process&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154627&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;attached
strace:&lt;span class="w"&gt; &lt;/span&gt;Process&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154628&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;attached
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154627&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;9&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_UNIX,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sun_path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/var/run/nscd/socket&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;110&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-1&lt;span class="w"&gt; &lt;/span&gt;ENOENT&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;No&lt;span class="w"&gt; &lt;/span&gt;such&lt;span class="w"&gt; &lt;/span&gt;file&lt;span class="w"&gt; &lt;/span&gt;or&lt;span class="w"&gt; &lt;/span&gt;directory&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154628&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_UNIX,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sun_path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/var/run/nscd/socket&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;110&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-1&lt;span class="w"&gt; &lt;/span&gt;ENOENT&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;No&lt;span class="w"&gt; &lt;/span&gt;such&lt;span class="w"&gt; &lt;/span&gt;file&lt;span class="w"&gt; &lt;/span&gt;or&lt;span class="w"&gt; &lt;/span&gt;directory&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154627&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;9&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_UNIX,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sun_path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/var/run/nscd/socket&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;110&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-1&lt;span class="w"&gt; &lt;/span&gt;ENOENT&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;No&lt;span class="w"&gt; &lt;/span&gt;such&lt;span class="w"&gt; &lt;/span&gt;file&lt;span class="w"&gt; &lt;/span&gt;or&lt;span class="w"&gt; &lt;/span&gt;directory&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154628&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;9&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_INET,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;htons&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;53&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_addr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;inet_addr&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;127.0.0.53&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154627&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_INET,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;htons&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;53&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_addr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;inet_addr&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;127.0.0.53&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154627&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;9&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_INET6,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin6_port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;htons&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin6_flowinfo&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;htonl&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;inet_pton&lt;span class="o"&gt;(&lt;/span&gt;AF_INET6,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;2606:4700:3034::6815:5ca9&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;sin6_addr&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin6_scope_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;28&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-1&lt;span class="w"&gt; &lt;/span&gt;ENETUNREACH&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;Network&lt;span class="w"&gt; &lt;/span&gt;is&lt;span class="w"&gt; &lt;/span&gt;unreachable&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154627&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;9&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_UNSPEC,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sa_data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\0\0\0\0\0\0\0\0\0\0\0\0\0\0&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154627&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;9&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_INET6,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin6_port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;htons&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin6_flowinfo&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;htonl&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;inet_pton&lt;span class="o"&gt;(&lt;/span&gt;AF_INET6,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;2606:4700:3031::ac43:c490&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;sin6_addr&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin6_scope_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;28&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-1&lt;span class="w"&gt; &lt;/span&gt;ENETUNREACH&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;Network&lt;span class="w"&gt; &lt;/span&gt;is&lt;span class="w"&gt; &lt;/span&gt;unreachable&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154627&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;9&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_UNSPEC,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sa_data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\0\0\0\0\0\0\0\0\0\0\0\0\0\0&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154627&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;9&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_INET,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;htons&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_addr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;inet_addr&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;104.21.92.169&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154627&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;9&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_UNSPEC,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sa_data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\0\0\0\0\0\0\0\0\0\0\0\0\0\0&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154627&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;9&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_INET,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;htons&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_addr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;inet_addr&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;172.67.196.144&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154628&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_INET6,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin6_port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;htons&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin6_flowinfo&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;htonl&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;inet_pton&lt;span class="o"&gt;(&lt;/span&gt;AF_INET6,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;2606:4700:3034::6815:5ca9&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;sin6_addr&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin6_scope_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;28&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-1&lt;span class="w"&gt; &lt;/span&gt;ENETUNREACH&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;Network&lt;span class="w"&gt; &lt;/span&gt;is&lt;span class="w"&gt; &lt;/span&gt;unreachable&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154628&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_UNSPEC,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sa_data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\0\0\0\0\0\0\0\0\0\0\0\0\0\0&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154628&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_INET6,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin6_port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;htons&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin6_flowinfo&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;htonl&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;inet_pton&lt;span class="o"&gt;(&lt;/span&gt;AF_INET6,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;2606:4700:3031::ac43:c490&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;sin6_addr&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin6_scope_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;28&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-1&lt;span class="w"&gt; &lt;/span&gt;ENETUNREACH&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;Network&lt;span class="w"&gt; &lt;/span&gt;is&lt;span class="w"&gt; &lt;/span&gt;unreachable&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154628&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_UNSPEC,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sa_data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\0\0\0\0\0\0\0\0\0\0\0\0\0\0&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154628&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_INET,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;htons&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_addr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;inet_addr&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;104.21.92.169&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154628&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_UNSPEC,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sa_data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\0\0\0\0\0\0\0\0\0\0\0\0\0\0&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154628&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_INET,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;htons&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_addr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;inet_addr&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;172.67.196.144&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154625&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;9&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_INET,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;htons&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;443&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_addr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;inet_addr&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;104.21.92.169&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-1&lt;span class="w"&gt; &lt;/span&gt;EINPROGRESS&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;Operation&lt;span class="w"&gt; &lt;/span&gt;now&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;progress&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154626&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_INET,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;htons&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;443&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_addr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;inet_addr&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;104.21.92.169&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-1&lt;span class="w"&gt; &lt;/span&gt;EINPROGRESS&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;Operation&lt;span class="w"&gt; &lt;/span&gt;now&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;progress&lt;span class="o"&gt;)&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;:00:53.862&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/articles/whats-in-the-box&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;:00:53.880&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/series/advent-of-code-2020/part-13&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154628&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++&lt;span class="w"&gt; &lt;/span&gt;exited&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154627&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++&lt;span class="w"&gt; &lt;/span&gt;exited&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154618&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++&lt;span class="w"&gt; &lt;/span&gt;exited&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154614&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++&lt;span class="w"&gt; &lt;/span&gt;exited&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154612&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++&lt;span class="w"&gt; &lt;/span&gt;exited&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154619&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++&lt;span class="w"&gt; &lt;/span&gt;exited&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154617&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++&lt;span class="w"&gt; &lt;/span&gt;exited&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154613&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++&lt;span class="w"&gt; &lt;/span&gt;exited&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154615&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++&lt;span class="w"&gt; &lt;/span&gt;exited&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154623&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++&lt;span class="w"&gt; &lt;/span&gt;exited&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154616&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++&lt;span class="w"&gt; &lt;/span&gt;exited&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154624&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++&lt;span class="w"&gt; &lt;/span&gt;exited&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154621&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++&lt;span class="w"&gt; &lt;/span&gt;exited&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154622&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++&lt;span class="w"&gt; &lt;/span&gt;exited&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154626&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++&lt;span class="w"&gt; &lt;/span&gt;exited&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154620&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++&lt;span class="w"&gt; &lt;/span&gt;exited&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;154625&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++&lt;span class="w"&gt; &lt;/span&gt;exited&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++
+++&lt;span class="w"&gt; &lt;/span&gt;exited&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++shell
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å“‡å“¦ï¼Œä¸€å¤§å † &lt;code&gt;connect&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ç¨‹åºé¦–å…ˆå°è¯•è¿æ¥ &lt;a href="https://jameshfisher.com/2018/02/05/dont-use-nscd/"&gt;nscd&lt;/a&gt; å› ä¸ºæ˜¾ç„¶æˆ‘ä»¬ä¾ç„¶ç”Ÿæ´»åœ¨ 90 å¹´ä»£ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;pid&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;154627&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;AF_UNIX&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sun_path&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/var/run/nscd/socket&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;110&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ENOENT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;No&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;such&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;or&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;directory&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ã€‚ã€‚ã€‚å¹¸å¥½æˆ‘çš„ç³»ç»Ÿæ²¡æœ‰å®ƒï¼Œæ‰€ä»¥å®ƒç»§ç»­é€šè¿‡ &lt;code&gt;/etc/resolv.conf&lt;/code&gt; æŸ¥è¯¢ DNSï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;[&lt;span class="nv"&gt;pid&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;154628&lt;/span&gt;]&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;connect&lt;/span&gt;&lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;{&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;AF_INET&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;htons&lt;/span&gt;&lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;53&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_addr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;inet_addr&lt;/span&gt;&lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;127.0.0.53&amp;quot;&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;},&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæœ€ç»ˆè·å¾—ä¸€äº› &lt;a href="https://www.cloudflare.com/ips/"&gt;Cloudflare çš„ IP åœ°å€&lt;/a&gt;ï¼Œå¦‚ &lt;code&gt;172.67.196.144&lt;/code&gt; å’Œ &lt;code&gt;104.21.92.169&lt;/code&gt; ã€‚è¿˜æœ‰ä¸€äº› IPv6 ç›¸å…³çš„ï¼Œç”±äºæˆ‘ç¦ç”¨äº† IPv6 æ‰€ä»¥å¹¶æ²¡æœ‰å·¥ä½œï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;[&lt;span class="nv"&gt;pid&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;154627&lt;/span&gt;]&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;connect&lt;/span&gt;&lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;{&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;AF_INET6&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin6_port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;htons&lt;/span&gt;&lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin6_flowinfo&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;htonl&lt;/span&gt;&lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;inet_pton&lt;/span&gt;&lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;AF_INET6&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;2606:4700:3034::6815:5ca9&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nv"&gt;sin6_addr&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin6_scope_id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;},&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;28&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;ENETUNREACH&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;Network&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;unreachable&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åç»ˆäºç¨‹åºå†³å®šä½¿ç”¨ IPv4 çš„åœ°å€ &lt;code&gt;104.21.92.169&lt;/code&gt; å»æ„å»ºè¯·æ±‚ï¼ŒåŒæ—¶æˆ‘ä»¬èƒ½çœ‹åˆ°è¿™äº›éƒ½æ˜¯éé˜»å¡çš„ï¼ˆnon-blockingï¼‰è¿æ¥ï¼Œå› ä¸º &lt;code&gt;connect&lt;/code&gt; è¿”å› &lt;code&gt;-1&lt;/code&gt; è€Œä¸æ˜¯ &lt;code&gt;0&lt;/code&gt; è¡¨ç¤ºã€Œæ­£åœ¨è¿æ¥ã€æ­£åœ¨è¿æ¥ã€ç¨åå›æ¥æ£€æŸ¥ã€ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;[&lt;span class="nv"&gt;pid&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;154625&lt;/span&gt;]&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;connect&lt;/span&gt;&lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;{&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;AF_INET&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;htons&lt;/span&gt;&lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;443&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_addr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;inet_addr&lt;/span&gt;&lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;104.21.92.169&amp;quot;&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;},&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;EINPROGRESS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;Operation&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;now&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;progress&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;
[&lt;span class="nv"&gt;pid&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;154626&lt;/span&gt;]&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;connect&lt;/span&gt;&lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;{&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;AF_INET&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;htons&lt;/span&gt;&lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;443&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_addr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;inet_addr&lt;/span&gt;&lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;104.21.92.169&amp;quot;&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;},&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;EINPROGRESS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;Operation&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;now&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;progress&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¥½äº†ï¼æ‰€ä»¥å¿½ç•¥ &lt;a href="https://isitdns.com/"&gt;DNS&lt;/a&gt; çš„è¯æˆ‘ä»¬çœ‹åˆ°äº†ä¸¤ä¸ªè¿æ¥ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ—¶æˆ‘ä»¬çœ‹åˆ°äº†ä¸€äº›çº¿ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯ Rust å¼‚æ­¥çš„å·¥ä½œæ–¹å¼ï¼Ÿæˆ‘ä»¬åªæ˜¯ç”¨äº†ä¸€äº›çº¿ç¨‹ï¼Ÿè¿™ä¹Ÿå°±æ˜¯å®ƒèƒ½åœ¨ã€Œåå°è¿è¡Œã€çš„åŸå› ï¼Ÿ&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬å›ç­”è¿™äº›é—®é¢˜å‰ï¼Œè®©æˆ‘ä»¬å…ˆè°ƒæ•´æˆ‘ä»¬çš„ä»£ç çœŸæ­£çš„å»ç­‰å¾… future å®Œæˆï¼Œè€Œä¸æ˜¯éšæ„çš„ä¼‘çœ  1 ç§’é’Ÿã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="cp"&gt;#[tokio::main]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;leaked_client&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Box&lt;/span&gt;::&lt;span class="n"&gt;leak&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;Box&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fut1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;leaked_client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fut2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;leaked_client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;handle1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;::&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fut1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;handle2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;::&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fut2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;handle1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unwrap&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;handle2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unwrap&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç­‰ç­‰ï¼Œæˆ‘ä»¬è¿™ä¸åˆå›åˆ°åŸç‚¹å—ï¼Ÿç­‰å¾…ç¬¬ä¸€ä¸ªè¯·æ±‚å®Œæˆï¼Œç„¶åæ‰å¼€å§‹ç¬¬äºŒä¸ªè¯·æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ä¸æ˜¯ï¼æˆ‘ä»¬è¿è¡Œå‡ æ¬¡å°±å¯ä»¥çœ‹åˆ°ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;:11:07.934&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/articles/whats-in-the-box&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;:11:07.958&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/series/advent-of-code-2020/part-13&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;:11:08.676&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/articles/whats-in-the-box&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;:11:08.680&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/series/advent-of-code-2020/part-13&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;:11:09.325&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/articles/whats-in-the-box&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;:11:09.338&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/series/advent-of-code-2020/part-13&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;:11:10.134&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/series/advent-of-code-2020/part-13&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;:11:10.144&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/articles/whats-in-the-box&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ã€‚ã€‚ã€‚å¤§éƒ¨åˆ†æƒ…å†µä¸‹â€œwhats-in-the-boxâ€èƒœå‡ºäº†ï¼ˆå®ƒç¡®å®å…ˆå¼€å§‹ï¼‰ï¼Œä½†æ˜¯â€œadvent-of-code-2020â€ä¹Ÿé¦–å…ˆå®Œæˆäº†å‡ æ¬¡ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬å¸Œæœ›çœ‹åˆ°çš„ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è°¬è®ºï¼šä¹Ÿå°±æ˜¯è¯´å› ä¸ºæœ‰çº¿ç¨‹è¯·æ±‚è¢«å¹¶è¡Œï¼ˆparallelï¼‰çš„æ‰§è¡Œäº†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸æ˜¯çš„ã€‚ä½†æ˜¯ä¸è¦ç›¸ä¿¡æˆ‘ï¼Œè®©æˆ‘ä»¬ç»§ç»­æ·±å…¥ã€‚&lt;/p&gt;
&lt;h3 id="ä¸æ˜¯å› ä¸ºçº¿ç¨‹"&gt;ä¸æ˜¯å› ä¸ºçº¿ç¨‹&lt;/h3&gt;
&lt;p&gt;è®©æˆ‘ä»¬é€šè¿‡ GDB è¿è¡Œæˆ‘ä»¬çš„å°ç¨‹åºï¼Œå¤§éƒ¨åˆ†åŸå› æ˜¯æˆ‘è¿˜æ²¡æœ‰å¯¹ LLDB å½¢æˆè‚Œè‚‰è®°å¿†ï¼Œæˆ‘ç›¸ä¿¡è¿™æ˜¯æ°´åˆ°æ¸ æˆçš„äº‹ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;build&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;quiet&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;gdb&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;quiet&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;
&lt;span class="n"&gt;Reading&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;symbols&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;...&lt;/span&gt;
&lt;span class="nl"&gt;warning&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Missing&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;auto&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="k"&gt;load&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;script&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;offset&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;section&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;debug_gdb_scripts&lt;/span&gt;
&lt;span class="k"&gt;of&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;file&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;amos&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ftl&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;span class="k"&gt;Use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;`&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;auto&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="k"&gt;load&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;python&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;scripts&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;REGEXP&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;list&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;them&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gdb&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸€åˆ‡å°±ç»ªï¼&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰å…ˆè®¾ç½®ä¸€ä¸‹æ–­ç‚¹ã€‚æˆ‘è¯´äº†æ–­ç‚¹ï¼Ÿåº”è¯¥æ˜¯æ•æ‰ç‚¹ï¼ˆcatchpointï¼‰ã€‚æˆ‘ä¸çŸ¥é“å‚ä¸æ„é€  HTTP/2 è¯·æ±‚çš„æ‰€æœ‰å‡½æ•°åï¼Œä½†æ˜¯æˆ‘çŸ¥é“ &lt;code&gt;connect&lt;/code&gt; å¯¹åº”çš„ç³»ç»Ÿè°ƒç”¨ï¼ˆsyscallï¼‰ï¼Œè¿™ä¹Ÿæ˜¯æˆ‘ä»¬éœ€è¦æ‰“æ–­ç‚¹çš„åœ°æ–¹ï¼Œæˆ–è€…æ•æ‰ï¼ˆcatchï¼‰ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;gdb&lt;/span&gt;&lt;span class="ss"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;catch&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;syscall&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;connect&lt;/span&gt;
&lt;span class="nv"&gt;Catchpoint&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;syscall&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;connect&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;[&lt;span class="mi"&gt;42&lt;/span&gt;]&lt;span class="ss"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç°åœ¨æˆ‘ä»¬å¼€å§‹ï¼&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;Starting&lt;span class="w"&gt; &lt;/span&gt;program:&lt;span class="w"&gt; &lt;/span&gt;/home/amos/ftl/waytoodeep/target/debug/waytoodeep
&lt;span class="o"&gt;[&lt;/span&gt;Thread&lt;span class="w"&gt; &lt;/span&gt;debugging&lt;span class="w"&gt; &lt;/span&gt;using&lt;span class="w"&gt; &lt;/span&gt;libthread_db&lt;span class="w"&gt; &lt;/span&gt;enabled&lt;span class="o"&gt;]&lt;/span&gt;
Using&lt;span class="w"&gt; &lt;/span&gt;host&lt;span class="w"&gt; &lt;/span&gt;libthread_db&lt;span class="w"&gt; &lt;/span&gt;library&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/lib/x86_64-linux-gnu/libthread_db.so.1&amp;quot;&lt;/span&gt;.
&lt;span class="o"&gt;[&lt;/span&gt;New&lt;span class="w"&gt; &lt;/span&gt;Thread&lt;span class="w"&gt; &lt;/span&gt;0x7ffff7c28700&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;LWP&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;158945&lt;/span&gt;&lt;span class="o"&gt;)]&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;New&lt;span class="w"&gt; &lt;/span&gt;Thread&lt;span class="w"&gt; &lt;/span&gt;0x7ffff7a27700&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;LWP&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;158946&lt;/span&gt;&lt;span class="o"&gt;)]&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;New&lt;span class="w"&gt; &lt;/span&gt;Thread&lt;span class="w"&gt; &lt;/span&gt;0x7fffef826700&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;LWP&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;158947&lt;/span&gt;&lt;span class="o"&gt;)]&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;New&lt;span class="w"&gt; &lt;/span&gt;Thread&lt;span class="w"&gt; &lt;/span&gt;0x7ffff7826700&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;LWP&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;158948&lt;/span&gt;&lt;span class="o"&gt;)]&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;New&lt;span class="w"&gt; &lt;/span&gt;Thread&lt;span class="w"&gt; &lt;/span&gt;0x7ffff7625700&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;LWP&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;158949&lt;/span&gt;&lt;span class="o"&gt;)]&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;New&lt;span class="w"&gt; &lt;/span&gt;Thread&lt;span class="w"&gt; &lt;/span&gt;0x7ffff7424700&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;LWP&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;158950&lt;/span&gt;&lt;span class="o"&gt;)]&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;New&lt;span class="w"&gt; &lt;/span&gt;Thread&lt;span class="w"&gt; &lt;/span&gt;0x7ffff7223700&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;LWP&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;158951&lt;/span&gt;&lt;span class="o"&gt;)]&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;New&lt;span class="w"&gt; &lt;/span&gt;Thread&lt;span class="w"&gt; &lt;/span&gt;0x7ffff701f700&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;LWP&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;158952&lt;/span&gt;&lt;span class="o"&gt;)]&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;New&lt;span class="w"&gt; &lt;/span&gt;Thread&lt;span class="w"&gt; &lt;/span&gt;0x7ffff6e1e700&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;LWP&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;158953&lt;/span&gt;&lt;span class="o"&gt;)]&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;New&lt;span class="w"&gt; &lt;/span&gt;Thread&lt;span class="w"&gt; &lt;/span&gt;0x7ffff6c1a700&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;LWP&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;158954&lt;/span&gt;&lt;span class="o"&gt;)]&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;New&lt;span class="w"&gt; &lt;/span&gt;Thread&lt;span class="w"&gt; &lt;/span&gt;0x7ffff6a16700&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;LWP&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;158955&lt;/span&gt;&lt;span class="o"&gt;)]&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;New&lt;span class="w"&gt; &lt;/span&gt;Thread&lt;span class="w"&gt; &lt;/span&gt;0x7ffff680f700&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;LWP&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;158956&lt;/span&gt;&lt;span class="o"&gt;)]&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;New&lt;span class="w"&gt; &lt;/span&gt;Thread&lt;span class="w"&gt; &lt;/span&gt;0x7ffff660e700&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;LWP&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;158957&lt;/span&gt;&lt;span class="o"&gt;)]&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;New&lt;span class="w"&gt; &lt;/span&gt;Thread&lt;span class="w"&gt; &lt;/span&gt;0x7ffff640a700&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;LWP&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;158958&lt;/span&gt;&lt;span class="o"&gt;)]&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;New&lt;span class="w"&gt; &lt;/span&gt;Thread&lt;span class="w"&gt; &lt;/span&gt;0x7ffff6206700&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;LWP&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;158959&lt;/span&gt;&lt;span class="o"&gt;)]&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;New&lt;span class="w"&gt; &lt;/span&gt;Thread&lt;span class="w"&gt; &lt;/span&gt;0x7ffff5f4b700&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;LWP&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;158960&lt;/span&gt;&lt;span class="o"&gt;)]&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;New&lt;span class="w"&gt; &lt;/span&gt;Thread&lt;span class="w"&gt; &lt;/span&gt;0x7ffff5d4a700&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;LWP&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;158961&lt;/span&gt;&lt;span class="o"&gt;)]&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;Switching&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;Thread&lt;span class="w"&gt; &lt;/span&gt;0x7ffff5f4b700&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;LWP&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;158960&lt;/span&gt;&lt;span class="o"&gt;)]&lt;/span&gt;

Thread&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;17&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;tokio-runtime-w&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;hit&lt;span class="w"&gt; &lt;/span&gt;Catchpoint&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;call&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;syscall&lt;span class="w"&gt; &lt;/span&gt;connect&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;0x00007ffff7d5033b&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;__libc_connect&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;fd&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;fd@entry&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;9&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;addr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;...,&lt;span class="w"&gt; &lt;/span&gt;addr@entry&lt;span class="o"&gt;=&lt;/span&gt;...,
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nv"&gt;len&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;len@entry&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;110&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;at&lt;span class="w"&gt; &lt;/span&gt;../sysdeps/unix/sysv/linux/connect.c:26
&lt;span class="m"&gt;26&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;../sysdeps/unix/sysv/linux/connect.c:&lt;span class="w"&gt; &lt;/span&gt;No&lt;span class="w"&gt; &lt;/span&gt;such&lt;span class="w"&gt; &lt;/span&gt;file&lt;span class="w"&gt; &lt;/span&gt;or&lt;span class="w"&gt; &lt;/span&gt;directory.
&lt;span class="o"&gt;(&lt;/span&gt;gdb&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸é”™ä¸é”™ï¼ŒçœŸå¿«ï¼æˆ‘ä»¬åœåœ¨äº†åä¸º &lt;code&gt;tokio-runtime-w&lt;/code&gt; çš„ &lt;code&gt;Thread 17&lt;/code&gt; ä¸­ï¼Œå› ä¸ºæˆ‘çŒœå…¶ä»–æ‰€æœ‰å­—æ¯éƒ½è¢«ä½¿ç”¨äº†ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;w&lt;/code&gt; æ„å‘³è¿™ &lt;code&gt;worker&lt;/code&gt; ï¼Œå¦‚æœä½ ä¸æ˜¯ç¬¬ä¸€å¤©ç”¨ Unix å°±ä¼šçŸ¥é“ä»€ä¹ˆè¿™ä¹ˆç®€å†™ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¥½çš„ï¼Œ &lt;code&gt;Thread 17&lt;/code&gt; ï¼Œé‚£ä¹ˆå…¶ä»–çº¿ç¨‹åœ¨åšä»€ä¹ˆå‘¢ï¼Ÿ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gdb&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;threads&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;Id&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;Target&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Id&lt;/span&gt;&lt;span class="w"&gt;                                            &lt;/span&gt;&lt;span class="n"&gt;Frame&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff7c2c6c0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158941&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;waytoodeep&amp;quot;&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;S&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff7c28700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158945&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;tokio-runtime-w&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;S&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff7a27700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158946&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;tokio-runtime-w&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x00007ffff7d4f5ce&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;epoll_wait&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;epfd&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;events&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mh"&gt;0x555556338b60&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;maxevents&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;timeout&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;epoll_wait&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;c&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7fffef826700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158947&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;tokio-runtime-w&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;S&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff7826700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158948&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;tokio-runtime-w&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;S&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff7625700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158949&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;tokio-runtime-w&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;S&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff7424700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158950&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;tokio-runtime-w&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;S&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff7223700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158951&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;tokio-runtime-w&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;S&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff701f700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158952&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;tokio-runtime-w&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;S&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff6e1e700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158953&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;tokio-runtime-w&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;S&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff6c1a700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158954&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;tokio-runtime-w&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;S&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff6a16700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158955&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;tokio-runtime-w&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;S&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff680f700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158956&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;tokio-runtime-w&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;S&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff660e700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158957&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;tokio-runtime-w&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;S&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff640a700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158958&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;tokio-runtime-w&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;S&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff6206700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158959&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;tokio-runtime-w&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;S&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;
&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff5f4b700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158960&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;tokio-runtime-w&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x00007ffff7d5033b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;__libc_connect&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="nv"&gt;@entry&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;addr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;...,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;addr&lt;/span&gt;&lt;span class="nv"&gt;@entry&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;...,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;len&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nf"&gt;len&lt;/span&gt;&lt;span class="nv"&gt;@entry&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;110&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;c&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff5d4a700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158961&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;tokio-runtime-w&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x00007ffff7d48a46&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;__GI___mmap64&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;offset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;flags&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16418&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;prot&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;len&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;134217728&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;addr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mh"&gt;0x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mmap64&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;c&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;59&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é¢ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥è·å¾—æ›´å¤šçš„æ ˆå¸§ï¼Ÿ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;gdb&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;apply&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;all&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;backtrace&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;

&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff5d4a700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158961&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;#0&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mh"&gt;0x00007ffff7d48a46&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;__GI___mmap64&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;offset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;flags&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16418&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;prot&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;len&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;134217728&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;addr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mh"&gt;0x0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mmap64&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;c&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;59&lt;/span&gt;
&lt;span class="n"&gt;#1&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;__GI___mmap64&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;addr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;addr&lt;/span&gt;&lt;span class="nv"&gt;@entry&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mh"&gt;0x0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;len&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nf"&gt;len&lt;/span&gt;&lt;span class="nv"&gt;@entry&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;134217728&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;prot&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;prot&lt;/span&gt;&lt;span class="nv"&gt;@entry&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;flags&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;flags&lt;/span&gt;&lt;span class="nv"&gt;@entry&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;16418&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="nv"&gt;@entry&lt;/span&gt;&lt;span class="o"&gt;=-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;offset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;offset&lt;/span&gt;&lt;span class="nv"&gt;@entry&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mmap64&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;c&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;47&lt;/span&gt;
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;More&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stack&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;frames&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;follow&lt;/span&gt;&lt;span class="p"&gt;...)&lt;/span&gt;

&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff5f4b700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158960&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;#0&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mh"&gt;0x00007ffff7d5033b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;__libc_connect&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="nv"&gt;@entry&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;addr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;...,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;addr&lt;/span&gt;&lt;span class="nv"&gt;@entry&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;...,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;len&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nf"&gt;len&lt;/span&gt;&lt;span class="nv"&gt;@entry&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;110&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;c&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;
&lt;span class="n"&gt;#1&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mh"&gt;0x00007ffff7d8b713&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;open_socket&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="nv"&gt;@entry&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;GETFDHST&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;key&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;key&lt;/span&gt;&lt;span class="nv"&gt;@entry&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mh"&gt;0x7ffff7de5ccb&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;hosts&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;keylen&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;keylen&lt;/span&gt;&lt;span class="nv"&gt;@entry&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;nscd_helper&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;c&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;185&lt;/span&gt;
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;More&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stack&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;frames&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;follow&lt;/span&gt;&lt;span class="p"&gt;...)&lt;/span&gt;

&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff6206700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158959&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;#0&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;S&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;
&lt;span class="n"&gt;#1&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mh"&gt;0x0000555555b9f1d1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;parking_lot_core&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="nl"&gt;thread_parker&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="nl"&gt;imp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="nl"&gt;ThreadParker&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;futex_wait&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;self&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mh"&gt;0x7ffff6206498&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;...)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;amos&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;registry&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;github&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;ecc6299db9ec823&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;parking_lot_core&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.8.3&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;thread_parker&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;112&lt;/span&gt;
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;More&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stack&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;frames&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;follow&lt;/span&gt;&lt;span class="p"&gt;...)&lt;/span&gt;

&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff640a700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158958&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;#0&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;S&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;
&lt;span class="n"&gt;#1&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mh"&gt;0x0000555555b9f1d1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;parking_lot_core&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="nl"&gt;thread_parker&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="nl"&gt;imp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="nl"&gt;ThreadParker&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;futex_wait&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;self&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mh"&gt;0x7ffff640a498&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;...)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;amos&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;registry&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;github&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;ecc6299db9ec823&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;parking_lot_core&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.8.3&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;thread_parker&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;112&lt;/span&gt;
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;More&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stack&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;frames&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;follow&lt;/span&gt;&lt;span class="p"&gt;...)&lt;/span&gt;

&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff660e700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158957&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;#0&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;S&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;
&lt;span class="n"&gt;#1&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mh"&gt;0x0000555555b9f1d1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;parking_lot_core&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="nl"&gt;thread_parker&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="nl"&gt;imp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="nl"&gt;ThreadParker&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;futex_wait&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;self&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mh"&gt;0x7ffff660e498&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;...)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;amos&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;registry&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;github&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;ecc6299db9ec823&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;parking_lot_core&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.8.3&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;thread_parker&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;112&lt;/span&gt;
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;More&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stack&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;frames&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;follow&lt;/span&gt;&lt;span class="p"&gt;...)&lt;/span&gt;

&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;0x7ffff680f700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;LWP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;158956&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;#0&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;..&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysdeps&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sysv&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;syscall&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;S&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;
&lt;span class="n"&gt;#1&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mh"&gt;0x0000555555b9f1d1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;parking_lot_core&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="nl"&gt;thread_parker&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="nl"&gt;imp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="nl"&gt;ThreadParker&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="n"&gt;futex_wait&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;self&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mh"&gt;0x7ffff680f498&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ts&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;...)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;amos&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;registry&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;github&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="n"&gt;ecc6299db9ec823&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;parking_lot_core&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.8.3&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;thread_parker&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;112&lt;/span&gt;
&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;More&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;stack&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;frames&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;follow&lt;/span&gt;&lt;span class="p"&gt;...)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é¢ã€‚å¤§éƒ¨åˆ†éƒ½æ˜¯æŒ‚èµ·çš„ã€‚ä¹Ÿå°±æ˜¯ç©ºé—²çš„ã€‚æ›´å‡†ç¡®çš„æ˜¯å®ƒä»¬åœ¨ç­‰å¾…å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ htop æŸ¥çœ‹è¿™äº›æ‰€æœ‰çº¿ç¨‹ï¼Œæˆ‘çŸ¥é“æˆ‘ä»¬å·²ç»çœ‹åˆ°äº†ï¼Œä½†æ˜¯æˆ‘ä»…ä»…æ˜¯è§‰å¾— htop å¾ˆæ£’ã€‚æ„Ÿè°¢ &lt;a href="https://twitter.com/hisham%5Fhm"&gt;Hisham&lt;/a&gt;ï¼
&lt;img alt="" src="https://fasterthanli.me/content/articles/understanding-rust-futures-by-going-way-too-deep/assets/htop-colors.571c5effbff8a0b3.webp"&gt;
æ‰€ä»¥ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ä¸€äº›çº¿ç¨‹ï¼ŒåŒæ—¶ä¹Ÿæœ‰ä¸€äº› CPU æ ¸å¿ƒã€‚å¯èƒ½æ˜¯ä¸€ä¸ª CPU æ ¸å¿ƒä¸€ä¸ªçº¿ç¨‹ï¼Ÿ
&lt;img alt="" src="https://fasterthanli.me/content/articles/understanding-rust-futures-by-going-way-too-deep/assets/worker-threads.64dbe39e33ccfc4f.webp"&gt;
æ˜¯çš„ã€‚ç„¶åè¿˜æœ‰ä¸€äº›é˜»å¡çš„çº¿ç¨‹ï¼Œæ­£å¦‚æˆ‘ä»¬ä»ä¸Šé¢ &lt;code&gt;strace&lt;/code&gt; è¾“å‡ºçœ‹åˆ°çš„é‚£æ ·ï¼Œ å®ƒä¼šè¿›è¡Œä¸€äº›é˜»å¡çš„ &lt;code&gt;connect&lt;/code&gt; è°ƒç”¨å»æŸ¥è¯¢ DNSï¼ˆå®é™…æ˜¯ glibc åœ¨æ‰§è¡Œï¼‰ï¼Œ
æ‰€ä»¥å®ƒé€šè¿‡è¿è¡Œåœ¨å·¥ä½œçº¿ç¨‹ä¹‹å¤–é¿å…é˜»å¡å…¶ä»–ä»»åŠ¡ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ‰€ä»¥å¤šä¸ªçº¿ç¨‹ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä¸€æ¬¡å¯ä»¥è¿è¡Œå¤šä¸ªè¯·æ±‚çš„åŸå› ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å®é™…ä¸Šæ–‡æ¡£ä¸Šè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªå•çº¿ç¨‹çš„æ‰§è¡Œå™¨ï¼Œæˆ‘ä¹Ÿä¸èƒ½ç¡®å®šï¼Œæ‰€ä»¥è®©æˆ‘ä»¬è¯•ä¸€ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;//                           ğŸ‘‡&lt;/span&gt;
&lt;span class="cp"&gt;#[tokio::main(flavor = &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;current_thread&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;)]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;// (same as before)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;:50:15.977&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/articles/whats-in-the-box&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;:50:15.994&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/series/advent-of-code-2020/part-13&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸¤ä¸ªå“åº”é—´éš” &lt;code&gt;17ms&lt;/code&gt; ï¼Œè¿™ä¸ªæ—¶é—´ä¸å¤Ÿæ„é€ ä¸€ä¸ªå®Œæ•´çš„è¯·æ±‚ï¼Œæ‰€ä»¥è¯·æ±‚å¹¶è¡Œï¼ˆparallelï¼‰çš„æ‰§è¡Œäº†ã€‚å¦‚æœä½ ä¾ç„¶åšæŒå®ƒå†…éƒ¨ä½¿ç”¨äº†çº¿ç¨‹ï¼Œè®©æˆ‘ä»¬è¿›ä¸€æ­¥ç¡®è®¤æˆ‘ä»¬åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼š
&lt;img alt="" src="https://fasterthanli.me/content/articles/understanding-rust-futures-by-going-way-too-deep/assets/current-thread.cd7b619ed644899b.webp"&gt;
ç¡®å®æœ‰å¤šä¸ªçº¿ç¨‹ï¼Œä½†æ˜¯è¿™äº›éƒ½æ˜¯é˜»å¡çº¿ç¨‹ã€‚ä»…ä»…æ˜¯ DNS æŸ¥è¯¢ã€‚å¯ä»¥é€šè¿‡ htop çœ‹åˆ°å·²ç»æ²¡æœ‰æ— æ•°ï¼ˆ15ï¼‰çš„å·¥ä½œçº¿ç¨‹äº†ï¼š
&lt;img alt="" src="https://fasterthanli.me/content/articles/understanding-rust-futures-by-going-way-too-deep/assets/htop-current-thread.fe28174abc5d15fa.webp"&gt;
ï¼ˆé¡ºä¾¿è¯´ä¸€ä¸‹ 15 ä¸ªå·¥ä½œçº¿ç¨‹çš„åŸå› ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘é¢„ç•™äº†ä¸€ä¸ª CPU æ ¸å¿ƒæ²¡æœ‰åˆ†é…ç»™è™šæ‹Ÿæœºï¼Œè¿™æ ·å³ä½¿è™šæ‹Ÿæœºå…¨é€Ÿè¿è¡Œä¹Ÿä¸ä¼šå¯¼è‡´å®¿ä¸»æœºåœæ­¢å“åº”ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬å°† DNS æŸ¥è¯¢æ’é™¤åœ¨å¤–ï¼Œæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°å®é™…ä¸Šä»…ä»…ä½¿ç”¨äº†ä¸€ä¸ªçº¿ç¨‹ï¼Œæˆ‘ä»¬å°†ç»§ç»­ä¸‹å»ï¼Œä»¥é˜²ä½ ä¾ç„¶å­˜ç–‘ï¼&lt;/p&gt;
&lt;h3 id="æ’æ›²-è®©æˆ‘ä»¬é¿å…æ³„æ¼å†…å­˜"&gt;æ’æ›²ï¼šè®©æˆ‘ä»¬é¿å…æ³„æ¼å†…å­˜&lt;/h3&gt;
&lt;p&gt;ä½†æ˜¯åœ¨é‚£ä¹‹å‰ï¼šæ­£åœ¨æ³„æ¼ reqwest çš„ &lt;code&gt;Client&lt;/code&gt; è®©æˆ‘å¾ˆä¸çˆ½ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†é¿å…ï¼Œæˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªåŸå­å¼•ç”¨è®¡æ•°ï¼ˆatomically-reference-countedï¼‰ï¼Œè¿™æ ·å®ƒå°±å¯ä»¥éšç€ä»»åŠ¡è¿è¡Œè€Œå­˜æ´»ã€‚&lt;/p&gt;
&lt;p&gt;ä¿®æ”¹èµ·æ¥éå¸¸ç®€å•ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;//             ğŸ‘‡ Atomically Reference Counted = Arc&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;sync&lt;/span&gt;::&lt;span class="n"&gt;Arc&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#[tokio::main(flavor = &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;current_thread&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;)]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;//           ğŸ‘‡ there we go&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Arc&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;());&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;//                              ğŸ‘‡&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fut1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clone&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// (cloning it only increases the reference count)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fut2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clone&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;handle1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;::&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fut1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;handle2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;::&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fut2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;handle1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unwrap&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;handle2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unwrap&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="cp"&gt;#[allow(clippy::manual_async_fn)]&lt;/span&gt;
&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;//       ğŸ‘‡ now taking this, we have shared ownership of it&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;: &lt;span class="nc"&gt;Arc&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;impl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;move&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;// luckily this  ğŸ‘‡ only requires `&amp;amp;self`&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error_for_status&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;content-type&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Got a response!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¥½äº†ï¼Œç°åœ¨æˆ‘æ„Ÿè§‰å¥½å¤šäº†ã€‚æˆ‘ä»¬çš„ç¨‹åºä¸å†æ³„æ¼ä¸€äº›å­—èŠ‚å³ä½¿å®ƒæ°¸è¿œä¸ä¼šè¿è¡Œè¶…è¿‡å‡ ç§’é’Ÿã€‚ä¸€åˆ‡éƒ½è¿˜å¥½ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ &lt;code&gt;reqwest&lt;/code&gt; çš„ &lt;code&gt;Client&lt;/code&gt; å®šä¹‰:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="cp"&gt;#[derive(Clone)]&lt;/span&gt;
&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;Client&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;inner&lt;/span&gt;: &lt;span class="nc"&gt;Arc&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;ClientRef&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®ƒå·²ç»æ˜¯å¼•ç”¨è®¡æ•°çš„äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥æ¥å—ä¸€ä¸ª &lt;code&gt;Client&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="cp"&gt;#[tokio::main(flavor = &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;current_thread&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;)]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;//             ğŸ‘‡&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;//                              ğŸ‘‡&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fut1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clone&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// no need to clone a second time&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fut2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;handle1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;::&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fut1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;handle2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;::&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fut2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;handle1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unwrap&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;handle2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unwrap&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="cp"&gt;#[allow(clippy::manual_async_fn)]&lt;/span&gt;
&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;//        ğŸ‘‡&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;: &lt;span class="nc"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;static&lt;/span&gt; &lt;span class="kt"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;impl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;static&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;move&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error_for_status&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;content-type&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Got a response!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¥½äº†ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äº†ï¼Œä»…ä¾›å‚è€ƒï¼Œæ›´ç®€å•çš„ &lt;code&gt;async fn&lt;/code&gt; ä¹Ÿå¯ä»¥å·¥ä½œäº†ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;: &lt;span class="nc"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kt"&gt;str&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error_for_status&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;content-type&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Got a response!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬ç”šè‡³ä¸éœ€è¦è¦æ±‚ &lt;code&gt;url&lt;/code&gt; çš„å€Ÿç”¨ç”Ÿå‘½å‘¨æœŸæ˜¯ &lt;code&gt;'static&lt;/code&gt; ã€‚å¦‚æœ &lt;code&gt;url&lt;/code&gt; æ˜¯ &lt;code&gt;'static&lt;/code&gt; çš„åˆ™è¿”å›çš„ Future ä¹Ÿæ˜¯ï¼Œåä¹‹äº¦ç„¶ã€‚&lt;/p&gt;
&lt;p&gt;ä½œä¸ºä¾‹å­ï¼Œä¸‹é¢ä»£ç æ— æ³•é€šè¿‡ç¼–è¯‘ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="cp"&gt;#[tokio::main(flavor = &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;current_thread&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;)]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// this is a `String`, owned by main&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;url1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;String&lt;/span&gt;::&lt;span class="n"&gt;from&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;URL_1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// we&amp;#39;re borrowing from main           ğŸ‘‡&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fut1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clone&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;url1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fut2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;handle1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;::&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fut1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;handle2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;::&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fut2&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;handle1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unwrap&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;handle2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unwrap&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;check&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Checking&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;v0&lt;/span&gt;&lt;span class="mf"&gt;.1.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;amos&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ftl&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;error&lt;/span&gt;&lt;span class="err"&gt;[&lt;/span&gt;&lt;span class="n"&gt;E0597&lt;/span&gt;&lt;span class="err"&gt;]&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`url1`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;does&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;not&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;live&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;long&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;enough&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;--&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;44&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="mi"&gt;18&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fut1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;clone&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;url1&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="o"&gt;----------------------------^^^^^-&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;                           &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;                           &lt;/span&gt;&lt;span class="n"&gt;borrowed&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;value&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;does&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;not&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;live&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;long&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;enough&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;argument&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;requires&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;that&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`url1`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;borrowed&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`&amp;#39;static`&lt;/span&gt;
&lt;span class="p"&gt;...&lt;/span&gt;
&lt;span class="mi"&gt;28&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`url1`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dropped&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;here&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;still&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;borrowed&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;blockquote&gt;
&lt;p&gt;ä½ é¢å¯¹çš„è€ƒéªŒå°±æ˜¯ï¼šä¿®æ”¹äº†ä¸€äº›ä»£ç ï¼Œç„¶åçªç„¶é—´æ•´ä¸ª &lt;code&gt;Future&lt;/code&gt; ä¸å†å®ç° &lt;code&gt;Send&lt;/code&gt; ï¼Œä½†æ˜¯ä½ éœ€è¦å®ƒå®ç° &lt;code&gt;Send&lt;/code&gt; ã€‚å‚è€ƒ&lt;a href="https://fasterthanli.me/articles/getting-in-and-out-of-trouble-with-rust-futures"&gt;Getting in and out of trouble with Rust futures&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬è¿›ä¸€æ­¥æ·±å…¥ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜æƒ³æä¸€ä¸‹ï¼Œé™¤äº†é€šè¿‡ &lt;code&gt;tokio::spawn&lt;/code&gt; å¯ä»¥åŒæ—¶è¿è¡Œä¸¤ä¸ª future å¹¶ä¸”ç«‹å³ç­‰å¾…ä¸¤ä¸ª future å®Œæˆï¼Œè¿˜æ˜¯ä½¿ç”¨ &lt;code&gt;FuturesUnordered&lt;/code&gt; å®ç°ç›¸åŒç›®çš„ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;futures&lt;/span&gt;&lt;span class="mf"&gt;@0.3.16&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Updating&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//github.com/rust-lang/crates.io-index&amp;#39; index&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;Adding&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;futures&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;v0&lt;/span&gt;&lt;span class="mf"&gt;.3.16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dependencies&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;futures&lt;/span&gt;::&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;stream&lt;/span&gt;::&lt;span class="n"&gt;FuturesUnordered&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;StreamExt&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;


&lt;span class="cp"&gt;#[tokio::main(flavor = &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;current_thread&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;)]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;group&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="fm"&gt;vec!&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clone&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_1&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;URL_2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;into_iter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;collect&lt;/span&gt;::&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;FuturesUnordered&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Some&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;group&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;// propagate errors&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é€šè¿‡è¿™ä¸ªè§£å†³åŠå•ƒå•Šï¼Œæˆ‘ä»¬å¯ä»¥ await ä»»æ„æ•°é‡çš„ future å¯¹è±¡ï¼ŒåŒæ—¶ä¹Ÿæ˜¯å¹¶å‘çš„è¢«è½®è¯¢ï¼ˆpolledï¼‰ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;:12:37.208&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/articles/whats-in-the-box&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;:12:37.227&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;url&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://fasterthanli.me/series/advent-of-code-2020/part-13&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;content_type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Some&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text/html; charset=utf-8&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä»…ä»…ã€‚ã€‚ã€‚19 æ¯«ç§’çš„é—´éš” -- å¯ä»¥ç¡®å®šæ˜¯å¹¶å‘çš„ã€‚&lt;/p&gt;
&lt;h3 id="å½»åº•æ‘†è„±-dns"&gt;å½»åº•æ‘†è„± DNS&lt;/h3&gt;
&lt;p&gt;ç°åœ¨è®©æˆ‘ä»¬æš‚æ—¶å¿˜æ‰ &lt;code&gt;reqwest&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;HTTP &lt;a href="https://fasterthanli.me/articles/aiming-for-correctness-with-types"&gt;å¹¶ä¸éš¾&lt;/a&gt; ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±æ„å»ºã€‚åªè¦ TCP å°±è¡Œï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;net&lt;/span&gt;::&lt;span class="n"&gt;SocketAddr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;::&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;io&lt;/span&gt;::&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;AsyncReadExt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AsyncWriteExt&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;::&lt;span class="n"&gt;TcpStream&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kt"&gt;str&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// look mom, no DNS!&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;addr&lt;/span&gt;: &lt;span class="nc"&gt;SocketAddr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;into&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TcpStream&lt;/span&gt;::&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;addr&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// we&amp;#39;re writing straight to the socket, there&amp;#39;s no buffering&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// so no need to flush&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write_all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;b&amp;quot;GET / HTTP/1.1&lt;/span&gt;&lt;span class="se"&gt;\r\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write_all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;b&amp;quot;Host: 1.1.1.1&lt;/span&gt;&lt;span class="se"&gt;\r\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write_all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;b&amp;quot;User-Agent: cool-bear&lt;/span&gt;&lt;span class="se"&gt;\r\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write_all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;b&amp;quot;Connection: close&lt;/span&gt;&lt;span class="se"&gt;\r\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write_all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;b&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\r\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;String&lt;/span&gt;::&lt;span class="n"&gt;with_capacity&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_to_string&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lines&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;unwrap_or_default&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Got response!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// dropping the socket will close the connection&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¯ä»¥æ­£å¸¸è¿è¡Œï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;:24:05.158&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;301&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Moved&lt;span class="w"&gt; &lt;/span&gt;Permanently&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;second
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;:24:05.159&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;301&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Moved&lt;span class="w"&gt; &lt;/span&gt;Permanently&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;first
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ï¼ˆçœ‹ï¼Œç¬¬äºŒä¸ªèµ¢å¾—äº†èƒœåˆ©ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ—¶å†ä¹Ÿæ²¡æœ‰ DNS æŸ¥è¯¢äº†ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ &lt;code&gt;http://1.1.1.1&lt;/code&gt; å°†æˆ‘ä»¬é‡å®šå‘åˆ° HTTPS çš„é¡µé¢ï¼ŒæŠ€æœ¯ä¸Šå®ç° TLS å¹¶ä¸å›°éš¾ï¼Œä½†æ˜¯æˆ‘ä»¬çš„ç¯‡å¹…å·²ç»å¾ˆé•¿äº†ï¼Œæ‰€ä»¥ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rustls&lt;/span&gt;&lt;span class="mf"&gt;@0.22.0&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Updating&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//github.com/rust-lang/crates.io-index&amp;#39; index&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;Adding&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rustls&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;v0&lt;/span&gt;&lt;span class="mf"&gt;.22.0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dependencies&lt;/span&gt;
&lt;span class="n"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;webpki&lt;/span&gt;&lt;span class="mf"&gt;@0.21.4&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Updating&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//github.com/rust-lang/crates.io-index&amp;#39; index&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;Adding&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;webpki&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;v0&lt;/span&gt;&lt;span class="mf"&gt;.21.4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dependencies&lt;/span&gt;
&lt;span class="n"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;add&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;webpki&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;roots&lt;/span&gt;&lt;span class="mf"&gt;@0.21.1&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Updating&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;https&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="c1"&gt;//github.com/rust-lang/crates.io-index&amp;#39; index&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="n"&gt;Adding&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;webpki&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;roots&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;v0&lt;/span&gt;&lt;span class="mf"&gt;.21.1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dependencies&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åã€‚ã€‚ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;rm&lt;span class="w"&gt; &lt;/span&gt;reqwest
&lt;span class="w"&gt;    &lt;/span&gt;Removing&lt;span class="w"&gt; &lt;/span&gt;reqwest&lt;span class="w"&gt; &lt;/span&gt;from&lt;span class="w"&gt; &lt;/span&gt;dependencies
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;sync&lt;/span&gt;::&lt;span class="n"&gt;Arc&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;webpki&lt;/span&gt;::&lt;span class="n"&gt;DNSNameRef&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tokio_rustls&lt;/span&gt;::&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;rustls&lt;/span&gt;::&lt;span class="n"&gt;ClientConfig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TlsConnector&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kt"&gt;str&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// look out it&amp;#39;s port 443 now&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;addr&lt;/span&gt;: &lt;span class="nc"&gt;SocketAddr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;443&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;into&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TcpStream&lt;/span&gt;::&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;addr&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// establish a TLS session...&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;connector&lt;/span&gt;: &lt;span class="nc"&gt;TlsConnector&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ClientConfig&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;root_store&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_server_trust_anchors&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;webpki_roots&lt;/span&gt;::&lt;span class="n"&gt;TLS_SERVER_ROOTS&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Arc&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;into&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// we have to use the proper DNS name now      ğŸ‘‡&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dnsname&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DNSNameRef&lt;/span&gt;::&lt;span class="n"&gt;try_from_ascii_str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;one.one.one.one&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;connector&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dnsname&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// we&amp;#39;re writing straight to the socket, there&amp;#39;s no buffering&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// so no need to flush&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write_all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;b&amp;quot;GET / HTTP/1.1&lt;/span&gt;&lt;span class="se"&gt;\r\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;//                        ğŸ‘‡&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write_all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;b&amp;quot;Host: one.one.one.one&lt;/span&gt;&lt;span class="se"&gt;\r\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write_all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;b&amp;quot;User-Agent: cool-bear&lt;/span&gt;&lt;span class="se"&gt;\r\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write_all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;b&amp;quot;Connection: close&lt;/span&gt;&lt;span class="se"&gt;\r\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write_all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;b&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\r\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;String&lt;/span&gt;::&lt;span class="n"&gt;with_capacity&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_to_string&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lines&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;unwrap_or_default&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Got response!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// dropping the socket will close the connection&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;:31:32.627&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;second
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;:31:32.658&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;first
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¥½äº†ï¼Œç°åœ¨è¿”å›çŠ¶æ€ç  200ï¼&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„ç›®æ ‡æ˜¯äº†è§£ Rust çš„ futureï¼Œæˆ‘ä»¬å·²ç»è·å¾—äº†ä¸é”™çš„è¿›å±•ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯è®©æˆ‘ä»¬è€ƒè™‘ä»¥ä¸‹åœºæ™¯ï¼šæˆ‘ä»¬æƒ³å¹¶å‘çš„æ‰§è¡Œä¸¤ä¸ªè¯·æ±‚ï¼Œä¸€æ—¦å…¶ä¸­ä¸€ä¸ªå¤±è´¥ï¼Œå¦å¤–ä¸€ä¸ªä¹Ÿåº”è¯¥ç«‹å³è¯·æ±‚å¤±è´¥ï¼Œæˆ–è€…ä¸¤ä¸ªä¸€èµ·æˆåŠŸã€‚&lt;/p&gt;
&lt;h3 id="tokio-çš„-try-join-å®"&gt;tokio çš„ try_join å®&lt;/h3&gt;
&lt;p&gt;å®é™…ä¸Šï¼Œåˆä¸€ä¸ªå®å¯ä»¥åšè¿™ä¸ªï¼&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="cp"&gt;#[tokio::main(flavor = &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;current_thread&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;)]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;::&lt;span class="n"&gt;try_join&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;first&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;second&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),)&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;All done!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;:44:52.150&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;first
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;:44:52.165&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;second
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;:44:52.165&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;All&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;res&lt;/span&gt;&lt;span class="o"&gt;=(()&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;())&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å†æ¬¡å¿«é€Ÿæ£€æŸ¥ä»¥ä¸‹ï¼šå“åº”é—´éš”åœ¨ 15ms -- ä¹Ÿå°±æ˜¯ç¡®å®šæ˜¯å¹¶å‘çš„å‘é€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;try_join!&lt;/code&gt; å¸®æˆ‘ä»¬è¿›è¡Œäº† &lt;code&gt;await&lt;/code&gt; ï¼ŒåŒæ—¶å¸®æˆ‘ä»¬å¤„ç†äº†ç»“æœã€‚å¦‚æœä¸€åˆ‡æ­£å¸¸ï¼Œæˆ‘ä»¬å¾—åˆ°æ‰€æœ‰ future å¯¹è±¡çš„ç»“æœï¼šå†…å®¹ä¸º &lt;code&gt;Ok&lt;/code&gt; çš„ç©ºå…ƒç»„ï¼ˆæœ‰åºçš„ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å–åˆ°æˆ‘ä»¬ future è¿”å›çš„å¯¹è±¡ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;//                                          ğŸ‘‡&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kt"&gt;str&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="kt"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// (omitted)&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;//  ğŸ‘‡&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸ºäº†æ–¹ä¾¿æˆ‘ä»¬è‡ªå·±ï¼Œå®ƒä»¬æŒ‰ç…§é¡ºåºè¿”å›ï¼Œæ— è®ºå“ªä¸ªå…ˆè¢«æ‰§è¡Œï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;:47:56.967&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;second
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;:47:56.967&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;first
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;:47:56.967&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;All&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;res&lt;/span&gt;&lt;span class="o"&gt;=(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;first&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;second&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;:47:57.933&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;first
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;:47:57.935&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;second
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;:47:57.935&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;All&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;res&lt;/span&gt;&lt;span class="o"&gt;=(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;first&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;second&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;:47:58.942&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;second
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;:47:58.946&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;first
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;:47:58.946&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;All&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;res&lt;/span&gt;&lt;span class="o"&gt;=(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;first&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;second&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¥½äº†ï¼Œç°åœ¨æˆ‘ä»¬æ²¡æœ‰ DNS æŸ¥è¯¢ï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¶ˆé™¤â€œåŒæ—¶â€è¯·æ±‚æ˜¯ç”±äºå¤šçº¿ç¨‹å®ç°çš„ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºï¼Œå¦‚æœæˆ‘ä»¬åœ¨ &lt;code&gt;strace&lt;/code&gt; ä¸‹è¿è¡Œç¨‹åºï¼Œå¹¶é€šè¿‡ &lt;code&gt;-f&lt;/code&gt; è¯·æ±‚è·Ÿè¸ªå­çº¿ç¨‹ï¼ˆ BTW &lt;code&gt;f&lt;/code&gt; æ„æ€æ˜¯è·Ÿè¸ªï¼ˆ &lt;code&gt;follow&lt;/code&gt; ï¼‰å­çº¿ç¨‹ï¼‰ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;build&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;strace&lt;span class="w"&gt; &lt;/span&gt;-f&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;connect&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;./target/release/waytoodeep
connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;9&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_INET,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;htons&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;443&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_addr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;inet_addr&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;1.1.1.1&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-1&lt;span class="w"&gt; &lt;/span&gt;EINPROGRESS&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;Operation&lt;span class="w"&gt; &lt;/span&gt;now&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;progress&lt;span class="o"&gt;)&lt;/span&gt;
connect&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;sa_family&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;AF_INET,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;htons&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;443&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;sin_addr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;inet_addr&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;1.1.1.1&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)}&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-1&lt;span class="w"&gt; &lt;/span&gt;EINPROGRESS&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;Operation&lt;span class="w"&gt; &lt;/span&gt;now&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;progress&lt;span class="o"&gt;)&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;:51:54.004&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;first
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;:51:54.013&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;second
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;:51:54.015&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;All&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;res&lt;/span&gt;&lt;span class="o"&gt;=(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;first&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;second&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
+++&lt;span class="w"&gt; &lt;/span&gt;exited&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+++
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ã€‚ã€‚ã€‚ç°åœ¨æˆ‘ä»¬çœ‹åˆ°äº†é¢„æœŸçš„ä¸¤æ¬¡ &lt;code&gt;connect&lt;/code&gt; è°ƒç”¨ï¼Œä½†æ˜¯æ²¡æœ‰ä»»ä½•å­çº¿ç¨‹ã€‚è€Œä¸”åœ¨è¿™ä¸ªè¿è¡Œä¸­ï¼Œå“åº”ä¹‹é—´çš„é—´éš”æ—¶é—´æ˜¯ 9 æ¯«ç§’ï¼å°‘äºæˆ‘ç›´æ¥ ping 1.1.1.1:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;ping&lt;span class="w"&gt; &lt;/span&gt;-c&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.1.1.1
PING&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.1.1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.1.1.1&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;56&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;84&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;bytes&lt;span class="w"&gt; &lt;/span&gt;of&lt;span class="w"&gt; &lt;/span&gt;data.
&lt;span class="m"&gt;64&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;bytes&lt;span class="w"&gt; &lt;/span&gt;from&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.1.1.1:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;icmp_seq&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;ttl&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;57&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;time&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;.7&lt;span class="w"&gt; &lt;/span&gt;ms

---&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.1.1.1&lt;span class="w"&gt; &lt;/span&gt;ping&lt;span class="w"&gt; &lt;/span&gt;statistics&lt;span class="w"&gt; &lt;/span&gt;---
&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;packets&lt;span class="w"&gt; &lt;/span&gt;transmitted,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;received,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;%&lt;span class="w"&gt; &lt;/span&gt;packet&lt;span class="w"&gt; &lt;/span&gt;loss,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;time&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;0ms
rtt&lt;span class="w"&gt; &lt;/span&gt;min/avg/max/mdev&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;.748/13.748/13.748/0.000&lt;span class="w"&gt; &lt;/span&gt;ms
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ˜¯å› ä¸ºæ‰§è¡Œå™¨é€šè¿‡ Event Loop æ„å»ºéé˜»å¡çš„ç³»ç»Ÿè°ƒç”¨ï¼Œç„¶åè®¢é˜… Event Loop ç®¡ç†çš„èµ„æºç›¸å…³çš„äº‹ä»¶ï¼Œ
ç„¶åå°±å¯ä»¥çŸ¥é“ä¸€ä¸ª socket ä»€ä¹ˆæ—¶é—´å¯ä»¥è¿›è¡Œè¯»å†™ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œfuture å¯¹è±¡åªæ˜¯ä¸€äº›çŠ¶æ€ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥è¿›è¡Œ awaitï¼Œé‚£ä¹ˆåœ¨å“ªè®¢é˜…çš„äº‹ä»¶å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬å°è¯•åˆ›å»ºä¸€ä¸ªæˆ‘ä»¬è‡ªå·±çš„ &lt;code&gt;try_join&lt;/code&gt; -- ä¸€ä¸ªå‡½æ•°ï¼Œå¹¶ä¸”åªæ¥å—ä¸¤ä¸ª futureã€‚ç„¶åæˆ‘ä»¬å°±èƒ½çœ‹åˆ°å‘ç”Ÿäº†ä»€ä¹ˆã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å·²ç»å®ç°äº†è‡ªå·±çš„ futureï¼Œå®ç°ä¸€ä¸ª &lt;code&gt;try_join&lt;/code&gt; å‡½æ•°ä¼šæœ‰å¤šéº»çƒ¦ï¼Ÿ&lt;/p&gt;
&lt;h3 id="äº‹å®è¯æ˜å¾ˆéº»çƒ¦"&gt;äº‹å®è¯æ˜å¾ˆéº»çƒ¦&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆä»ç®€å•çš„å¼€å§‹ï¼æˆ‘ä»¬æƒ³å®ç°ä¸€ä¸ªå‡½æ•°æ¥å—ä¸¤ä¸ª future å¯¹è±¡ç„¶åè¿”å›ä¸€ä¸ª future å¯¹è±¡ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;// in `src/main.rs`&lt;/span&gt;
&lt;span class="k"&gt;mod&lt;/span&gt; &lt;span class="nn"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;// in `src/tj.rs`&lt;/span&gt;

&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;future&lt;/span&gt;::&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;try_join&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;: &lt;span class="nc"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;: &lt;span class="nc"&gt;B&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;impl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;where&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="fm"&gt;todo!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;implement me!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é¢ã€‚å‡½æ•°ä¸åº”è¯¥åªè¿”å›ä¸€ä¸ªç©ºå…ƒç»„ï¼Œå®ƒéœ€è¦è¿”å›ä¸€ä¸ªåŒ…å«æˆåŠŸç»“æœçš„å…ƒç»„ã€‚æˆ–è€…é‡åˆ°çš„ç¬¬ä¸€ä¸ªé”™è¯¯ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€äº›æ›´å¤šçš„èŒƒå‹å‚æ•°ï¼šä¸€ä¸ªé”™è¯¯ç±»å‹ï¼ˆæˆ‘ä»¬å‡è®¾ä¸¤ä¸ª future å¯¹è±¡è¿”å›åŒæ ·çš„é”™è¯¯ç±»å‹ï¼‰ï¼Œå¦ä¸€ä¸ªæ˜¯ future å¯¹è±¡è¿”å›çš„ &lt;code&gt;Ok&lt;/code&gt; çš„ç±»å‹ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;try_join&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;: &lt;span class="nc"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;: &lt;span class="nc"&gt;B&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;impl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;where&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="fm"&gt;todo!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;implement me!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¥½äº†ï¼è¿™éå¸¸ç»•å£ï¼Œä½†æ˜¯æˆ‘ç›¸ä¿¡æˆ‘ä»¬å·²ç»å®ç°äº†éœ€æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬ä½¿ç”¨äº† &lt;code&gt;impl Trait&lt;/code&gt; è¯­æ³•ï¼Œè®©æˆ‘ä»¬ä¸ç”¨æš´éœ²æˆ‘ä»¬è‡ªå·±çš„ &lt;code&gt;try join future&lt;/code&gt; ã€‚è¿™ä¸é‡è¦ï¼Œä½†æ˜¯å¯ä»¥è®©æˆ‘ä»¬ç”¨æ›´å°‘çš„ &lt;code&gt;pub&lt;/code&gt; å…³é”®å­—ï¼ŒåŒæ—¶æˆ‘ä»¬çš„æ‰‹æŒ‡å·²ç»ç ç´¯äº†ã€‚éå¸¸ç´¯ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œè®©æˆ‘ä»¬æ¥åˆ›å»ºè¿™ä¸ªç±»å‹ï¼&lt;/p&gt;
&lt;p&gt;ç±»å‹éœ€è¦æŒç»­ &lt;code&gt;A&lt;/code&gt; å’Œ &lt;code&gt;B&lt;/code&gt; ï¼Œå¹¶æ³¨æ„ &lt;code&gt;AR&lt;/code&gt; ã€ &lt;code&gt;BR&lt;/code&gt; å’Œ &lt;code&gt;E&lt;/code&gt; ç±»å‹ã€‚æ‰€ä»¥ï¼Œå¸Œæœ›æ‚¨å¯¹è¿™äº›èŒƒå‹å‚æ•°æ²™æ‹‰æœ‰ä¸ªå¥½èƒƒå£ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;TryJoin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;where&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;: &lt;span class="nc"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;: &lt;span class="nc"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åå¯ä»¥åœ¨æˆ‘ä»¬çš„ &lt;code&gt;try_join&lt;/code&gt; å‡½æ•°ä¸­è¿”å›å®ƒï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;try_join&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;: &lt;span class="nc"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;: &lt;span class="nc"&gt;B&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;impl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;where&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// so simple!&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;TryJoin&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘è®¤ä¸ºè¿™å¾ˆå¥½çš„è¯´æ˜ä¸€ä¸ªäº‹å®ï¼šåˆ›å»º future å¯¹è±¡ä»…ä»…æ˜¯æ„å»ºçŠ¶æ€ã€‚ä¸éœ€è¦ä»»ä½•é¢å¤–çš„å·¥ä½œã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œè¿™ä¸ªä¸ä¼šé€šè¿‡ç¼–è¯‘ï¼Œå› ä¸º &lt;code&gt;TryJoin&lt;/code&gt; è¿˜æ²¡æœ‰å®ç° &lt;code&gt;Future&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ä¸è¦æ‹…å¿ƒï¼ &lt;code&gt;rust-analyzer&lt;/code&gt; å¯ä»¥å¸®åŠ©æˆ‘ä»¬ç”Ÿæˆç¼ºå¤±çš„éƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;future&lt;/span&gt;::&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;pin&lt;/span&gt;::&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;::&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="k"&gt;impl&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TryJoin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;where&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;type&lt;/span&gt; &lt;span class="nc"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;: &lt;span class="nc"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;_&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;Poll&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="fm"&gt;todo!&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœæˆ‘ä»¬çœŸæ­£çš„å®ç°äº†ï¼Œæˆ‘ä»¬å°†æŒ‰ç…§ä¸‹é¢æ–¹å¼ä½¿ç”¨ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="cp"&gt;#[tokio::main(flavor = &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;current_thread&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;)]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;::&lt;span class="n"&gt;try_join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;first&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;second&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;All done!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å½“ç„¶ï¼Œç°åœ¨åªæ˜¯ä¼šå´©æºƒï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release

The&lt;span class="w"&gt; &lt;/span&gt;application&lt;span class="w"&gt; &lt;/span&gt;panicked&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;crashed&lt;span class="o"&gt;)&lt;/span&gt;.
Message:&lt;span class="w"&gt;  &lt;/span&gt;not&lt;span class="w"&gt; &lt;/span&gt;yet&lt;span class="w"&gt; &lt;/span&gt;implemented
Location:&lt;span class="w"&gt; &lt;/span&gt;src/tj.rs:32

Backtrace&lt;span class="w"&gt; &lt;/span&gt;omitted.
Run&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_BACKTRACE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;environment&lt;span class="w"&gt; &lt;/span&gt;variable&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;display&lt;span class="w"&gt; &lt;/span&gt;it.
Run&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_BACKTRACE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;full&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;include&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;source&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;snippets.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ‰€ä»¥ï¼Œæˆ‘çŒœæˆ‘ä»¬éœ€è¦å®ç°å®ƒï¼&lt;/p&gt;
&lt;p&gt;å¥½å§ï¼Œè®©æˆ‘ä»¬å…ˆå°è¯•è‡³å°‘è½®è¯¢ï¼ˆpollingï¼‰ä¸€ä¸ª future å¯¹è±¡ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;: &lt;span class="nc"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;_&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;Poll&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="fm"&gt;todo!&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;quiet&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="k"&gt;release&lt;/span&gt;
&lt;span class="k"&gt;error&lt;/span&gt;&lt;span class="err"&gt;[&lt;/span&gt;&lt;span class="n"&gt;E0599&lt;/span&gt;&lt;span class="err"&gt;]&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;no&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;named&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`poll`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;found&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;parameter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`A`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;current&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;scope&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;--&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;24&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="n"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;                        &lt;/span&gt;&lt;span class="o"&gt;^^^^&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;not&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;found&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`A`&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;:::&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;amos&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rustup&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;toolchains&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;stable&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;x86_64&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="no"&gt;unknown&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;linux&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;gnu&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;lib&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;rustlib&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;rust&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;library&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;core&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;future&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;future&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;fn&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;self&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Self&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;_&amp;gt;) -&amp;gt; Poll&amp;lt;Self::Output&amp;gt;;&lt;/span&gt;
&lt;span class="s1"&gt;    |        ---- the method is available for `Pin&amp;lt;&amp;amp;mut A&amp;gt;` here&lt;/span&gt;
&lt;span class="s1"&gt;    |&lt;/span&gt;
&lt;span class="s1"&gt;help: consider wrapping the receiver expression with the appropriate type&lt;/span&gt;
&lt;span class="s1"&gt;    |&lt;/span&gt;
&lt;span class="s1"&gt;32  |         let a = Pin::new(&amp;amp;mut self.a).poll(cx);&lt;/span&gt;
&lt;span class="s1"&gt;    |                 ^^^^^^^^^^^^^       ^&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é¢ï¼ä¸€ä¸ªå¥½çš„å¼€å§‹ï¼Œå¥½çš„å¼€å§‹ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘å·²ç»åœ¨è¿™é‡Œ&lt;a href="https://fasterthanli.me/articles/pin-and-suffering"&gt;è¯¦ç»†çš„è§£é‡Šäº†&lt;/a&gt; Pinï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å°±ç®€å•çš„ä»‹ç»ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;p&gt;æ–¹æ³•é€šå¸¸é€šè¿‡å¦‚ä¸‹æ–¹å¼å®šä¹‰æ¥æ”¶è€…ï¼ˆreceiverï¼‰ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;MyType&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;do_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="fm"&gt;println!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;my value is {}&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¹Ÿå°±æ˜¯ä¸‹é¢çš„ç®€å†™ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;MyType&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;do_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;Self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="fm"&gt;println!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;my value is {}&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å› ä¸ºæˆ‘ä»¬åœ¨ &lt;code&gt;impl MyType&lt;/code&gt; ä»£ç å—ä¸­ &lt;code&gt;Self&lt;/code&gt; å°±æ˜¯ &lt;code&gt;MyType&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;å¾ˆæ¸…æ™°å§ï¼Ÿå¥½äº†ï¼Œè¿˜å¯ä»¥å®šä¹‰å…¶ä»–å¾ˆå¤šç±»å‹ä½œä¸ºæ¥æ”¶è€…ï¼Œ &lt;code&gt;Pin&amp;lt;&amp;amp;mut Self&amp;gt;&lt;/code&gt; å°±æ˜¯å…¶ä¸­ä¹‹ä¸€ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;MyType&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;do_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;: &lt;span class="nc"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;// good luck!1&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é‚£ä¹ˆ &lt;code&gt;MyType&lt;/code&gt; å¿…é¡»æ˜¯å›ºå®šçš„ï¼ˆpinnedï¼‰æ˜¯ä»€ä¹ˆæ„æ€å‘¢ï¼Ÿæ¯”å¦‚ï¼Œå®ƒä¿è¯ä¸è¿›è¡Œè½¬ç§»ï¼ˆmoveï¼‰ã€‚é™¤éå®ƒå®ç°äº† &lt;code&gt;Unpin&lt;/code&gt; ï¼Œ
ç„¶åå®ƒå°±å¯ä»¥æ˜¯éå›ºå®šçš„ï¼ˆunpinnedï¼‰ï¼Œå¯ç§»åŠ¨ï¼Œç„¶åè¢«å†ä¸€æ¬¡å›ºå®šã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºå‰©ä¸‹çš„æ–‡ç« ï¼Œæˆ‘ä»¬ä¸ä¼šå‡è®¾æˆ‘ä»¬çš„ future &lt;code&gt;A&lt;/code&gt; å’Œ &lt;code&gt;B&lt;/code&gt; éƒ½æ˜¯ &lt;code&gt;Unpin&lt;/code&gt; ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è‡ªå·±ä¸ä¼šç§»åŠ¨ï¼ˆmoveï¼‰å®ƒä»¬ï¼ˆåªé”€æ¯ï¼ˆdropï¼‰å®ƒä»¬ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä½ å¯ä»¥è¯´æˆ‘ä»¬ä¸éœ€è¦ &lt;code&gt;A&lt;/code&gt; å’Œ &lt;code&gt;B&lt;/code&gt; æ˜¯ &lt;code&gt;Unpin&lt;/code&gt; çš„ï¼Œå› ä¸ºæˆ‘ä»¬æ²¡æœ‰æ·»åŠ æŒ‡å®šçš„ where clause æ¥æ ‡è®°éœ€è¦å®ƒä»¬æ˜¯ &lt;code&gt;Unpin&lt;/code&gt; ã€‚
å› ä¸ºå¦‚æœæˆ‘ä»¬éœ€è¦ï¼Œæˆ‘ä»¬å°±è¦åƒä¸‹é¢è¿™æ ·æ·»åŠ é¢å¤–çš„ &lt;code&gt;trait bound&lt;/code&gt; ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;TryJoin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;where&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;//                                    ğŸ‘‡&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Unpin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Unpin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;{}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸èƒ½å‡è®¾ &lt;code&gt;A&lt;/code&gt; æˆ– &lt;code&gt;B&lt;/code&gt; æ˜¯ &lt;code&gt;Unpin&lt;/code&gt; çš„ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼æˆ‘ä»¬ç°åœ¨çœŸçš„åªæ˜¯é¢ä¸´å›ºå®šï¼ˆpinï¼‰ä¿æŠ¤çš„é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç°åœ¨åªæŒæœ‰ä¸€ä¸ª &lt;code&gt;Pin&amp;lt;&amp;amp;mut TryJoin&amp;lt;A, B, ...&amp;gt;&amp;gt;&lt;/code&gt; ä½†æ˜¯æˆ‘å¸Œæœ›æŒç»­ä¸€ä¸ª &lt;code&gt;Pin&amp;lt;&amp;amp;mut A&amp;gt;&lt;/code&gt; ï¼ˆå› ä¸ºè¿™å°±æ˜¯æˆ‘ä»¬å› ä¸ºéœ€è¦è½®è¯¢ &lt;code&gt;A&lt;/code&gt; ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å¦å¤–ä¸€ä¸ªè§£å†³æ–¹æ³•ï¼Œæˆ‘å€¾å‘äºé€šè¿‡ä¸€äº›ç±»ä¼¼ &lt;a href="https://lib.rs/crates/pin-project"&gt;pin-project&lt;/a&gt; åŒ…ï¼Œæˆ–è€…ç±»ä¼¼ &lt;a href="https://lib.rs/crates/pin-project-lite"&gt;pin-project-lite&lt;/a&gt;ï¼Œä½†æ˜¯åœ¨æˆ‘ä»¬å‰è¿›çš„æ–¹å‘ç›´æ¥ä½¿ç”¨ &lt;code&gt;pin-project&lt;/code&gt; çœŸçš„å¾ˆå°´å°¬ï¼Œ
æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œä½¿ç”¨ &lt;code&gt;unsafe&lt;/code&gt; ä½œä¸ºæ›¿ä»£ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;: &lt;span class="nc"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;_&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;Poll&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;unsafe&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map_unchecked_mut&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="fm"&gt;todo!&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¯ä»¥é€šè¿‡ç¼–è¯‘ã€‚ä½†æ˜¯æˆ‘ä»¬åœ¨ä½¿ç”¨ &lt;code&gt;unsafe&lt;/code&gt; ï¼Œä¹Ÿå°±æ„å‘³ç€ç¼–è¯‘å™¨æ­£å¼åœæ­¢ ~~ç…§é¡¾~~ æ£€æŸ¥æˆ‘ä»¬çš„ä»£ç ã€‚
æˆ‘ä»¬è‡ªå·±å¿…é¡»å¼ºåˆ¶æ‰§è¡Œä¸€äº›ä¸å˜é‡ï¼ˆinvariantsï¼‰ï¼Œå¹¶ä¸”éå¸¸éå¸¸å°å¿ƒï¼ŒåŒæ—¶è®©å…¶ä»–äººå®¡æŸ¥ï¼ˆreviewï¼‰æˆ‘ä»¬çš„å·¥ä½œï¼Œ
ä½†æ˜¯ä¾ç„¶å¯èƒ½ä¼šå‡ºé”™ï¼Œå› ä¸ºä»–ä»¬ä¹Ÿä¼šä¼‘æ¯ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨ï¼Œéå¸¸æ£’çš„æ˜¯æˆ‘ä»¬å¯ä»¥è½®è¯¢ &lt;code&gt;a&lt;/code&gt; ã€‚å®ƒå¦‚æœå®Œæˆä¼šè¿”å› &lt;code&gt;Poll::Ready(Result&amp;lt;AR, E&amp;gt;)&lt;/code&gt; ï¼Œ
å¦åˆ™å°±æ˜¯ç­‰ä¼šä¼šå®Œæˆåˆ™è¿”å› &lt;code&gt;Poll::Pending&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;: &lt;span class="nc"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;_&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;Poll&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;unsafe&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map_unchecked_mut&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Pending&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;A is pending...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Pending&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;A is ready!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="fm"&gt;todo!&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬é€šè¿‡æ‰“å°æ—¥å¿—â€œA is pendingâ€çŸ¥é“å‡†å¤‡å®Œæˆã€‚è¿™å¯èƒ½éœ€è¦å‡ ä¸ªå›åˆï¼šæ¯•ç«Ÿï¼Œæˆ‘ä»¬æ­£åœ¨åšä¸€äº›é‡è¦çš„äº‹æƒ…ã€‚
æˆ‘ä»¬å»ºç«‹ä¸€ä¸ª TCP è¿æ¥ï¼Œæ¥ç€åœ¨ä¸Šé¢è¿›è¡Œ TLS ä¼šè¯ï¼Œæ¥ç€æ˜¯ä¸€äº›åˆ†å¼€çš„å†™ï¼Œæœ€åè¯»åˆ° EOFï¼ˆend of fileï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬è¿è¡Œå®ƒçš„è¯ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;aytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.495&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.495&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.495&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.495&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.495&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.495&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.495&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.513&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.513&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.513&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.513&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.513&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.514&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.522&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.522&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.522&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.522&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.522&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.523&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.523&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.530&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.530&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pending&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.530&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Got&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;HTTP&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mf"&gt;1.1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;OK&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;
&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;14.530&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;waytoodeep&lt;/span&gt;&lt;span class="p"&gt;::&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ready&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;
&lt;span class="n"&gt;The&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;application&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;panicked&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;crashed&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="n"&gt;Message&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="ow"&gt;not&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;yet&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;implemented&lt;/span&gt;
&lt;span class="n"&gt;Location&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;46&lt;/span&gt;

&lt;span class="n"&gt;Backtrace&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;omitted&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="n"&gt;Run&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;with&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RUST_BACKTRACE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;environment&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;variable&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;display&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;it&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="n"&gt;Run&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;with&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RUST_BACKTRACE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;full&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;snippets&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å®ƒç¡®å®èŠ±è´¹äº†å‡ ä¸ªå›åˆã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„å¦‚æœ &lt;code&gt;A&lt;/code&gt; è¿”å›é”™è¯¯æˆ‘ä»¬çš„ä»£ç ä¹Ÿä¼šè¿”å› &lt;code&gt;Poll:Ready&lt;/code&gt; ï¼Œå› ä¸ºæˆ‘ä»¬æƒ³æ”¶é›† A å’Œ B çš„ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å¯¹ B åšç›¸åŒçš„äº‹æƒ…ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;: &lt;span class="nc"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;_&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;Poll&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;unsafe&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map_unchecked_mut&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Pending&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;A is pending...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Pending&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;A is ready!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;unsafe&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;map_unchecked_mut&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Pending&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;B is pending...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Pending&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;B is ready!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="fm"&gt;todo!&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åã€‚ã€‚whoopsï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cargo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;quiet&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="k"&gt;release&lt;/span&gt;
&lt;span class="k"&gt;error&lt;/span&gt;&lt;span class="err"&gt;[&lt;/span&gt;&lt;span class="n"&gt;E0382&lt;/span&gt;&lt;span class="err"&gt;]&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;of&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;moved&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;value&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`self`&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;--&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;46&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;26&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;fn&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;self&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Self&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;_&amp;gt;) -&amp;gt; Poll&amp;lt;Self::Output&amp;gt; {&lt;/span&gt;
&lt;span class="s1"&gt;    |             ---- move occurs because `self` has type `Pin&amp;lt;&amp;amp;mut TryJoin&amp;lt;A, B, AR, BR, E&amp;gt;&amp;gt;`, which does not implement the `Copy` trait&lt;/span&gt;
&lt;span class="s1"&gt;34  |         let a = unsafe { self.map_unchecked_mut(|this| &amp;amp;mut this.a) };&lt;/span&gt;
&lt;span class="s1"&gt;    |                               ------------------------------------- `self` moved due to this method call&lt;/span&gt;
&lt;span class="s1"&gt;...&lt;/span&gt;
&lt;span class="s1"&gt;46  |         let b = unsafe { self.map_unchecked_mut(|this| &amp;amp;mut this.a) };&lt;/span&gt;
&lt;span class="s1"&gt;    |                          ^^^^ value used here after move&lt;/span&gt;
&lt;span class="s1"&gt;    |&lt;/span&gt;
&lt;span class="s1"&gt;note: this function takes ownership of the receiver `self`, which moves `self`&lt;/span&gt;
&lt;span class="s1"&gt;   --&amp;gt; /home/amos/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/rustlib/src/rust/library/core/src/pin.rs:776:43&lt;/span&gt;
&lt;span class="s1"&gt;    |&lt;/span&gt;
&lt;span class="s1"&gt;776 |     pub unsafe fn map_unchecked_mut&amp;lt;U, F&amp;gt;(self, func: F) -&amp;gt; Pin&amp;lt;&amp;amp;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;U&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;                                           &lt;/span&gt;&lt;span class="o"&gt;^^^^&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ˜¯çš„ã€‚ &lt;code&gt;map_unchecked_mut&lt;/code&gt; å æœ‰äº† &lt;code&gt;self&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ç”¨æ‹…å¿ƒï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code&gt;.as_mut()&lt;/code&gt; ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;//       ğŸ‘‡&lt;/span&gt;
&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;: &lt;span class="nc"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;_&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;Poll&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;//                      ğŸ‘‡&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;unsafe&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_mut&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;map_unchecked_mut&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Pending&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;A is pending...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Pending&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;A is ready!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;//                      ğŸ‘‡&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;unsafe&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_mut&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;map_unchecked_mut&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Pending&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;B is pending...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Pending&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;B is ready!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="fm"&gt;todo!&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä½†æ˜¯ä¾ç„¶æ— æ³•é€šè¿‡ç¼–è¯‘ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
&lt;span class="o"&gt;(&lt;/span&gt;cut&lt;span class="o"&gt;)&lt;/span&gt;
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;22&lt;/span&gt;:57:07.913&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep::tj:&lt;span class="w"&gt; &lt;/span&gt;A&lt;span class="w"&gt; &lt;/span&gt;is&lt;span class="w"&gt; &lt;/span&gt;pending...
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;22&lt;/span&gt;:57:07.913&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep::tj:&lt;span class="w"&gt; &lt;/span&gt;A&lt;span class="w"&gt; &lt;/span&gt;is&lt;span class="w"&gt; &lt;/span&gt;pending...
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;22&lt;/span&gt;:57:07.913&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;first
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;22&lt;/span&gt;:57:07.913&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep::tj:&lt;span class="w"&gt; &lt;/span&gt;A&lt;span class="w"&gt; &lt;/span&gt;is&lt;span class="w"&gt; &lt;/span&gt;ready!
The&lt;span class="w"&gt; &lt;/span&gt;application&lt;span class="w"&gt; &lt;/span&gt;panicked&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;crashed&lt;span class="o"&gt;)&lt;/span&gt;.
Message:&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;async&lt;span class="w"&gt; &lt;/span&gt;fn&lt;span class="sb"&gt;`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;resumed&lt;span class="w"&gt; &lt;/span&gt;after&lt;span class="w"&gt; &lt;/span&gt;completion
Location:&lt;span class="w"&gt; &lt;/span&gt;src/main.rs:24

Backtrace&lt;span class="w"&gt; &lt;/span&gt;omitted.
Run&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_BACKTRACE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;environment&lt;span class="w"&gt; &lt;/span&gt;variable&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;display&lt;span class="w"&gt; &lt;/span&gt;it.
Run&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_BACKTRACE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;full&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;include&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;source&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;snippets.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°ï¼Œä¸€æ—¦ &lt;code&gt;Future&lt;/code&gt; è¿”å› &lt;code&gt;Poll::Ready&lt;/code&gt; æˆ‘ä»¬å°±ä¸èƒ½å†æ¬¡è½®è¯¢å®ƒäº†ã€‚æˆ‘ä»¬ä¸ºä»€ä¹ˆä¼šè¿™æ ·ï¼Ÿå› ä¸º &lt;code&gt;Future&lt;/code&gt; å·²ç»è¿”å›äº†ç»“æœã€‚å¦‚æœç»“æœæ˜¯é &lt;code&gt;Copy&lt;/code&gt; çš„ï¼Œå®ƒå¯èƒ½åªèƒ½è¿”å›ä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦ 1ï¼‰è·Ÿè¸ª &lt;code&gt;A&lt;/code&gt; æ˜¯å¦å®Œæˆï¼Œç„¶å 2ï¼‰åœ¨æŸä¸ªåœ°æ–¹å­˜å‚¨å®ƒçš„è¿”å›ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åªéœ€è¦åœ¨æˆ‘ä»¬çš„ç»“æ„ä½“ä¸­æ·»åŠ ä¸€äº›å­—æ®µï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;TryJoin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;where&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;: &lt;span class="nc"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;: &lt;span class="nc"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// ğŸ‘‡&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;a_res&lt;/span&gt;: &lt;span class="nb"&gt;Option&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;b_res&lt;/span&gt;: &lt;span class="nb"&gt;Option&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸è¦å¿˜è®°åˆå§‹åŒ–å®ƒä»¬ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;try_join&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;: &lt;span class="nc"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;: &lt;span class="nc"&gt;B&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;impl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;where&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;TryJoin&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;// ğŸ‘‡&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;a_res&lt;/span&gt;: &lt;span class="nb"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;b_res&lt;/span&gt;: &lt;span class="nb"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç°åœ¨è®¡åˆ’æ˜¯ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¦‚æœ &lt;code&gt;a_res&lt;/code&gt; æ˜¯ &lt;code&gt;Some&lt;/code&gt; ï¼Œç„¶åæˆ‘ä»¬å°±ä¸éœ€è¦è½®è¯¢ &lt;code&gt;a&lt;/code&gt; ,å› ä¸ºå®ƒå·²ç»å®Œæˆäº†&lt;/li&gt;
&lt;li&gt;åŒæ ·çš„é€»è¾‘å¤„ç† &lt;code&gt;b_res&lt;/code&gt; å’Œ &lt;code&gt;b&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è®©æˆ‘ä»¬å®ç°å®ƒã€‚åŒæ—¶ï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»åœ¨ä½¿ç”¨äº† &lt;code&gt;unsafe&lt;/code&gt; ï¼Œæ‰€ä»¥æˆ‘ä»¬å·²ç»è´Ÿè´£ç»´æŠ¤ä¸å˜é‡ï¼ˆinvariantsï¼‰ï¼Œ
æ‰€ä»¥æˆ‘å†³å®šåŒæ—¶å›ºå®š &lt;code&gt;a&lt;/code&gt; å’Œ &lt;code&gt;b&lt;/code&gt; ï¼Œå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;: &lt;span class="nc"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;_&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;Poll&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;unsafe&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_unchecked_mut&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;unsafe&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;::&lt;span class="n"&gt;new_unchecked&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;::&lt;span class="n"&gt;new_unchecked&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a_res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;is_none&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Pending&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Pending&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a_res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Some&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b_res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;is_none&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Pending&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Pending&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b_res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Some&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="fm"&gt;todo!&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¥½äº†ï¼Œè¿™ä¸ªåº”è¯¥èƒ½è®© &lt;code&gt;a&lt;/code&gt; å’Œ &lt;code&gt;b&lt;/code&gt; æœ‰æœºä¼šåœ¨æˆ‘ä»¬å´©æºƒä¹‹å‰å®Œæˆï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:11:03.851&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;first
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:11:04.380&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;second
The&lt;span class="w"&gt; &lt;/span&gt;application&lt;span class="w"&gt; &lt;/span&gt;panicked&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;crashed&lt;span class="o"&gt;)&lt;/span&gt;.
Message:&lt;span class="w"&gt;  &lt;/span&gt;not&lt;span class="w"&gt; &lt;/span&gt;yet&lt;span class="w"&gt; &lt;/span&gt;implemented
Location:&lt;span class="w"&gt; &lt;/span&gt;src/tj.rs:69

Backtrace&lt;span class="w"&gt; &lt;/span&gt;omitted.
Run&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_BACKTRACE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;environment&lt;span class="w"&gt; &lt;/span&gt;variable&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;display&lt;span class="w"&gt; &lt;/span&gt;it.
Run&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_BACKTRACE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;full&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;include&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;source&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;snippets.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¾ˆå¥½ï¼ç°åœ¨æˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯è§£å‡ºä¸¤ä¸ªç»“æœå¹¶è¿”å›å®ƒä»¬ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;// instead of the `todo!()`:&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;Some&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Some&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a_res&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b_res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a_res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;take&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;unwrap&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b_res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;take&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;unwrap&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Pending&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¯ä»¥å·¥ä½œï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:13:32.497&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;first
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:13:32.829&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;second
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:13:32.829&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;All&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;res&lt;/span&gt;&lt;span class="o"&gt;=(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;first&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;second&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ã€‚ã€‚ã€‚ä½†æ˜¯è¿™ä¸æ˜¯ &lt;code&gt;try_join&lt;/code&gt; çš„å®ç°ã€‚æˆ‘ä»¬æ­£åœ¨åšçš„å’Œè¿™ä¸ªå®Œå…¨ä¸€æ ·ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;// (pseudo-code, buncha things are missing)&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;try_join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;: &lt;span class="nc"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;: &lt;span class="nc"&gt;B&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ˜¯é¡ºåºçš„æ‰§è¡Œçš„ã€‚è¯·è®°ä½ï¼Œä»…ä»…æ˜¯å› ä¸º tokio çš„æ‰§è¡Œå™¨å¯èƒ½ç”¨äº†ä¸€å †çº¿ç¨‹å¹¶æ„å‘³ç€åŒæ—¶è¿è¡Œæ˜¯è‡ªåŠ¨çš„ã€‚
å‰é¢æˆ‘ä»¬ä¸å¾—ä¸ä½¿ç”¨ &lt;code&gt;tokio::spwan&lt;/code&gt; æˆ– &lt;code&gt;UnorderedFutures&lt;/code&gt; æˆ– &lt;code&gt;try_join!&lt;/code&gt; è®©å…¶åŒæ—¶è¿è¡Œã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥è®©æˆ‘ä»¬é‡æ–°çœ‹ä¸€ä¸‹ã€‚ã€‚ã€‚å½“æˆ‘ä»¬è½®è¯¢ &lt;code&gt;a&lt;/code&gt; çš„æ˜¯åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a_res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;is_none&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Pending&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Pending&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a_res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Some&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é¢ï¼Œå½“è½®è¯¢ &lt;code&gt;a&lt;/code&gt; çš„æ—¶å€™è¿”å› &lt;code&gt;Poll::Pending&lt;/code&gt; æ—¶æˆ‘ä»¬ä¹Ÿä¼šè¿”å› &lt;code&gt;Poll::Pending&lt;/code&gt;  ã€‚æ‰€ä»¥è¿™å°±æ˜¯é—®é¢˜ã€‚
å¦‚æœ &lt;code&gt;a&lt;/code&gt; æ­£åœ¨ç­‰å¾…ï¼ˆpendingï¼‰æˆ‘ä»¬ä¸åº”è¯¥è¿”å›ã€‚å› ä¸ºå¦‚æœè¿™æ—¶å€™ &lt;code&gt;b&lt;/code&gt; å·²ç»å‡†å¤‡å¥½æˆ–è€…æœ‰é”™è¯¯å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æˆ–è€…å¦‚æœï¼Œæˆ‘ä»¬åƒè¿™æ ·è°ƒç”¨ &lt;code&gt;try_join&lt;/code&gt; å‘¢ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Joining...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;::&lt;span class="n"&gt;try_join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;move&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Duration&lt;/span&gt;::&lt;span class="n"&gt;from_millis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2000&lt;/span&gt;&lt;span class="p"&gt;)).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;move&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Duration&lt;/span&gt;::&lt;span class="n"&gt;from_millis&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;::&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;color_eyre&lt;/span&gt;::&lt;span class="n"&gt;eyre&lt;/span&gt;::&lt;span class="n"&gt;eyre&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;uh oh&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ã€‚ã€‚ã€‚ç„¶å &lt;code&gt;a&lt;/code&gt; èŠ±è´¹äº† 2 ç§’é’Ÿæ‰å‡†å¤‡å¥½ï¼ŒåŒæ—¶ &lt;code&gt;b&lt;/code&gt; ä¼šåœ¨ 10æ¯«ç§’ä¹‹åè¿”å›ä¸€ä¸ªé”™è¯¯ï¼Œå¦‚æœæˆ‘ä»¬è½®è¯¢å®ƒï¼&lt;/p&gt;
&lt;p&gt;å—ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:19:26.972&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Joining...
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:19:28.990&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;All&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;res&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Err&lt;span class="o"&gt;(&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;uh&lt;span class="w"&gt; &lt;/span&gt;oh

Location:
&lt;span class="w"&gt;   &lt;/span&gt;src/main.rs:28
&lt;span class="o"&gt;(&lt;/span&gt;cut&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ï¼ˆæ³¨æ„æ—¶é—´æˆ³ï¼‰&lt;/p&gt;
&lt;p&gt;é‡ç‚¹æ˜¯ &lt;code&gt;try_join&lt;/code&gt; ä¼šæå‰å¤±è´¥ï¼šä¸€æ—¦ Future è¿”å› &lt;code&gt;Result::Err~&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥æˆ‘ä»¬å¿…é¡»åŒæ—¶è½®è¯¢ &lt;code&gt;a&lt;/code&gt; å’Œ &lt;code&gt;b&lt;/code&gt; ã€‚å¥½å§ã€‚ã€‚ã€‚ä¸æ˜¯ä¸¥æ ¼æ„ä¹‰çš„åŒæ—¶ã€‚æˆ‘ä»¬å¿…é¡»æ¯æ¬¡æˆ‘ä»¬çš„ &lt;code&gt;TryJoin&lt;/code&gt; future å¯¹è±¡è¢«è½®è¯¢æ—¶å¹¶å‘ï¼ˆconcurrentlyï¼‰çš„è½®è¯¢å®ƒä»¬ï¼Œ
ç›´åˆ°å®ƒä»¬è¿”å›ç»“æœã€‚&lt;/p&gt;
&lt;p&gt;æœ‰ä¸€ä¸ªç®€å•è§£å†³åŠæ³• -- åœ¨ä»»ä¸€ future å¯¹è±¡è¿”å› &lt;code&gt;Poll::Pending&lt;/code&gt; æ—¶ä¸è¿”å› &lt;code&gt;Poll::Pending&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ—¶ï¼Œæˆ‘åŒå€¦äº†è¾“å…¥ &lt;code&gt;Poll::Ready&lt;/code&gt; å¹¶ä¸” &lt;code&gt;Poll&amp;lt;T&amp;gt;&lt;/code&gt; å®ç°äº† &lt;code&gt;From&amp;lt;T&amp;gt;&lt;/code&gt; ,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code&gt;.into()&lt;/code&gt; äº†ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;: &lt;span class="nc"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;_&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;Poll&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;unsafe&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_unchecked_mut&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;unsafe&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;::&lt;span class="n"&gt;new_unchecked&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;::&lt;span class="n"&gt;new_unchecked&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a_res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;is_none&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a_res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Some&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;into&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b_res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;is_none&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b_res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Some&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;into&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;Some&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Some&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a_res&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b_res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a_res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;take&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;unwrap&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b_res&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;take&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;unwrap&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)).&lt;/span&gt;&lt;span class="n"&gt;into&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Pending&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è®©æˆ‘ä»¬å†æ¬¡è¿è¡Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:22:40.238&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Joining...
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:22:40.253&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;All&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;res&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;Err&lt;span class="o"&gt;(&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;uh&lt;span class="w"&gt; &lt;/span&gt;oh

Location:
&lt;span class="w"&gt;   &lt;/span&gt;src/main.rs:28

&lt;span class="o"&gt;(&lt;/span&gt;cut&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ã€‚ã€‚ã€‚å¯ä»¥äº†ï¼æˆ‘æ˜¯è¯´å®ƒæŒ‰ç…§é¢„æœŸçš„å¤±è´¥äº†ã€‚é¢„æœŸçš„å¤±è´¥å°±æ˜¯æˆåŠŸã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬å°†è¿™ä¸ªæ–¹æ³•åº”ç”¨åˆ°è°ƒç”¨ &lt;code&gt;try_join&lt;/code&gt; :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="cp"&gt;#[tokio::main(flavor = &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;current_thread&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;)]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Joining...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;::&lt;span class="n"&gt;try_join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;first&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;second&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;All done!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç«äº‰åˆå›æ¥äº†ï¼šæœ‰æ—¶ &lt;code&gt;first&lt;/code&gt; å…ˆå®Œæˆï¼Œæœ‰æ—¶åˆ™ä¸æ˜¯ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:25:25.925&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Joining...
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:25:26.224&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;first
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:25:26.236&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;second
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:25:26.236&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;All&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;res&lt;/span&gt;&lt;span class="o"&gt;=(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;first&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;second&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:25:26.937&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Joining...
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:25:27.237&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;first
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:25:27.242&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;second
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:25:27.242&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;All&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;res&lt;/span&gt;&lt;span class="o"&gt;=(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;first&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;second&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:25:27.865&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Joining...
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:25:28.164&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;second
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:25:28.818&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;first
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:25:28.818&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;All&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;res&lt;/span&gt;&lt;span class="o"&gt;=(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;first&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;second&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:25:30.153&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Joining...
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:25:31.477&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;second
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:25:31.496&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;first
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:25:31.496&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;All&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;res&lt;/span&gt;&lt;span class="o"&gt;=(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;first&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;second&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ã€‚ã€‚ã€‚åŒæ—¶ç»“æœçš„é¡ºåºæ˜¯æ­£ç¡®çš„ã€‚&lt;/p&gt;
&lt;p&gt;éå¸¸å¥½ï¼Œæˆ‘ä»¬å®ç°äº†å®ƒï¼&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯ï¼&lt;/p&gt;
&lt;h3 id="æˆ‘ä»¬å¯ä»¥åšçš„æ›´å¥½"&gt;æˆ‘ä»¬å¯ä»¥åšçš„æ›´å¥½&lt;/h3&gt;
&lt;p&gt;å¹¸è¿çš„æ˜¯ï¼Œåå°±æ˜¯å¥½ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹é¢è¿™ä¸ªç±»å‹å›°æ‰°ç€æˆ‘ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;TryJoin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;where&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;: &lt;span class="nc"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;: &lt;span class="nc"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;a_res&lt;/span&gt;: &lt;span class="nb"&gt;Option&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;b_res&lt;/span&gt;: &lt;span class="nb"&gt;Option&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘å…¶å®åªæœ‰åœ¨ &lt;code&gt;a&lt;/code&gt; å®Œæˆåæ‰éœ€è¦ &lt;code&gt;a_res&lt;/code&gt; ã€‚ä¸€æ—¦ &lt;code&gt;a&lt;/code&gt; å®Œæˆç„¶åå°†ç»“æœå­˜å‚¨åˆ° &lt;code&gt;a_res&lt;/code&gt; ï¼Œæˆ‘ä»¬å°±ä¸å†éœ€è¦ &lt;code&gt;a&lt;/code&gt; äº†ã€‚&lt;/p&gt;
&lt;p&gt;å®é™…ä¸Šï¼Œç”šè‡³æˆ‘ä»¬ä¸åº”è¯¥å†ç¢° &lt;code&gt;a&lt;/code&gt;  ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å¬èµ·æ¥æ›´åƒæˆ‘ä»¬è¦ä¹ˆæŒæœ‰ &lt;code&gt;A&lt;/code&gt; è¦ä¹ˆæŒæœ‰ &lt;code&gt;AR&lt;/code&gt; ï¼Œä½†æ˜¯æ°¸è¿œä¸ä¼šåŒæ—¶æŒæœ‰ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;SUM TYPES&lt;/code&gt; : Rust çš„æšä¸¾å°±æ˜¯ä¸€ä¸ªæ±‡æ€»ç±»å‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ‰€ä»¥ï¼æ±‡æ€»ç±»å‹ã€‚Rust æšä¸¾ã€‚è¿™å°±æ˜¯æˆ‘ä»¬æƒ³è¦çš„ã€‚è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå«åš &lt;code&gt;State&lt;/code&gt; çš„ç±»å‹ï¼Œç„¶åå®ƒæœ‰ä¸¤ä¸ªå˜ä½“ï¼š
ä¸€ä¸ªç”¨äºå®ƒè¿˜æ˜¯ future å¯¹è±¡ï¼Œä¸€ä¸ªç”¨äºå®ƒæ˜¯ä¸€ä¸ªç»“æœã€‚éå¸¸ç®€å•ï¼&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;enum&lt;/span&gt; &lt;span class="nc"&gt;State&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;where&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™å°†ä¼šéå¸¸æ£’ï¼&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬èµ‹ç»™æˆ‘ä»¬çš„ &lt;code&gt;TryJoin&lt;/code&gt; ç»“æ„ä½“ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;TryJoin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;where&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;: &lt;span class="nc"&gt;State&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;: &lt;span class="nc"&gt;State&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ï¼ˆæ˜¯ä¸æ˜¯éå¸¸æ¼‚äº®ï¼‰&lt;/p&gt;
&lt;p&gt;ç„¶ååˆå§‹åŒ–å®ƒä»¬ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;try_join&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;: &lt;span class="nc"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;: &lt;span class="nc"&gt;B&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;impl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;where&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;TryJoin&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;: &lt;span class="nc"&gt;State&lt;/span&gt;::&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;: &lt;span class="nc"&gt;State&lt;/span&gt;::&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;éå¸¸é…·ã€‚ç„¶åæˆ‘ä»¬åªéœ€è¦ç¨å¾®è°ƒæ•´ä¸€ä¸‹æˆ‘ä»¬çš„ &lt;code&gt;poll&lt;/code&gt; æ–¹æ³•ï¼Œæˆ‘ä»¬éœ€è¦å°† &lt;code&gt;Pin&amp;lt;&amp;amp;mut Self&amp;gt;&lt;/code&gt; è½¬æ¢ä¸º &lt;code&gt;&amp;amp;mut Self&lt;/code&gt; ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;: &lt;span class="nc"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;_&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;Poll&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;unsafe&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_unchecked_mut&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ˜¯å¯ä»¥çš„ï¼Œå› ä¸ºæˆ‘ä»¬æ‰¿è¯ºç»´æŠ¤ä¸å˜é‡ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬ä¸ä¼šè½¬ç§»ï¼ˆmoveï¼‰ &lt;code&gt;State::Future&lt;/code&gt; å†…éƒ¨ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åå¦‚æœ &lt;code&gt;a&lt;/code&gt; æ˜¯ &lt;code&gt;State::Future&lt;/code&gt; æˆ‘ä»¬å°±è½®è¯¢å®ƒï¼Œç„¶åæˆ‘ä»¬å†ä¼ æ’­é”™è¯¯æˆ–è€…ä¿å­˜å®ƒçš„ç»“æœï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;::&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;unsafe&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;::&lt;span class="n"&gt;new_unchecked&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;::&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Err&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;into&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶ååŒæ ·çš„ä¿®æ”¹ &lt;code&gt;b&lt;/code&gt; ã€‚ã€‚ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;// you can figure that one out, I believe in you&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæˆ‘ä»¬å°±å®Œæˆäº†å¦‚æœå®ƒä»¬éƒ½æ˜¯ &lt;code&gt;State::Ok&lt;/code&gt; ï¼å¦åˆ™æˆ‘ä»¬å°±è¿”å› &lt;code&gt;Poll::Pending&lt;/code&gt; :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;::&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;::&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)).&lt;/span&gt;&lt;span class="n"&gt;into&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Pending&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;éå¸¸å¥½ã€‚&lt;/p&gt;
&lt;p&gt;é™¤äº†å®ƒæ— æ³•é€šè¿‡ç¼–è¯‘ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
error&lt;span class="o"&gt;[&lt;/span&gt;E0507&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;cannot&lt;span class="w"&gt; &lt;/span&gt;move&lt;span class="w"&gt; &lt;/span&gt;out&lt;span class="w"&gt; &lt;/span&gt;of&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;this.a&lt;span class="sb"&gt;`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;which&lt;span class="w"&gt; &lt;/span&gt;is&lt;span class="w"&gt; &lt;/span&gt;behind&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;mutable&lt;span class="w"&gt; &lt;/span&gt;reference
&lt;span class="w"&gt;  &lt;/span&gt;--&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;src/tj.rs:65:16
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;
&lt;span class="m"&gt;65&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt;         &lt;/span&gt;match&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;this.a,&lt;span class="w"&gt; &lt;/span&gt;this.b&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt;                &lt;/span&gt;^^^^^^&lt;span class="w"&gt; &lt;/span&gt;move&lt;span class="w"&gt; &lt;/span&gt;occurs&lt;span class="w"&gt; &lt;/span&gt;because&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;this.a&lt;span class="sb"&gt;`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;has&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;State&amp;lt;A,&lt;span class="w"&gt; &lt;/span&gt;AR,&lt;span class="w"&gt; &lt;/span&gt;E&amp;gt;&lt;span class="sb"&gt;`&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;which&lt;span class="w"&gt; &lt;/span&gt;does&lt;span class="w"&gt; &lt;/span&gt;not&lt;span class="w"&gt; &lt;/span&gt;implement&lt;span class="w"&gt; &lt;/span&gt;the&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;Copy&lt;span class="sb"&gt;`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;trait

error&lt;span class="o"&gt;[&lt;/span&gt;E0507&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;cannot&lt;span class="w"&gt; &lt;/span&gt;move&lt;span class="w"&gt; &lt;/span&gt;out&lt;span class="w"&gt; &lt;/span&gt;of&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;this.b&lt;span class="sb"&gt;`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;which&lt;span class="w"&gt; &lt;/span&gt;is&lt;span class="w"&gt; &lt;/span&gt;behind&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;mutable&lt;span class="w"&gt; &lt;/span&gt;reference
&lt;span class="w"&gt;  &lt;/span&gt;--&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;src/tj.rs:65:24
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;
&lt;span class="m"&gt;65&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt;         &lt;/span&gt;match&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;this.a,&lt;span class="w"&gt; &lt;/span&gt;this.b&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt;                        &lt;/span&gt;^^^^^^&lt;span class="w"&gt; &lt;/span&gt;move&lt;span class="w"&gt; &lt;/span&gt;occurs&lt;span class="w"&gt; &lt;/span&gt;because&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;this.b&lt;span class="sb"&gt;`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;has&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;State&amp;lt;B,&lt;span class="w"&gt; &lt;/span&gt;BR,&lt;span class="w"&gt; &lt;/span&gt;E&amp;gt;&lt;span class="sb"&gt;`&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;which&lt;span class="w"&gt; &lt;/span&gt;does&lt;span class="w"&gt; &lt;/span&gt;not&lt;span class="w"&gt; &lt;/span&gt;implement&lt;span class="w"&gt; &lt;/span&gt;the&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;Copy&lt;span class="sb"&gt;`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;trait

error:&lt;span class="w"&gt; &lt;/span&gt;aborting&lt;span class="w"&gt; &lt;/span&gt;due&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;previous&lt;span class="w"&gt; &lt;/span&gt;errors

For&lt;span class="w"&gt; &lt;/span&gt;more&lt;span class="w"&gt; &lt;/span&gt;information&lt;span class="w"&gt; &lt;/span&gt;about&lt;span class="w"&gt; &lt;/span&gt;this&lt;span class="w"&gt; &lt;/span&gt;error,&lt;span class="w"&gt; &lt;/span&gt;try&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;rustc&lt;span class="w"&gt; &lt;/span&gt;--explain&lt;span class="w"&gt; &lt;/span&gt;E0507&lt;span class="sb"&gt;`&lt;/span&gt;.
error:&lt;span class="w"&gt; &lt;/span&gt;could&lt;span class="w"&gt; &lt;/span&gt;not&lt;span class="w"&gt; &lt;/span&gt;compile&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;waytoodeep&lt;span class="sb"&gt;`&lt;/span&gt;

To&lt;span class="w"&gt; &lt;/span&gt;learn&lt;span class="w"&gt; &lt;/span&gt;more,&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;the&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;command&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;again&lt;span class="w"&gt; &lt;/span&gt;with&lt;span class="w"&gt; &lt;/span&gt;--verbose.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å› ä¸ºã€‚ã€‚ã€‚æˆ‘ä»¬åªæœ‰ &lt;code&gt;&amp;amp;mut Self&lt;/code&gt; è€Œä¸æ˜¯ &lt;code&gt;Self&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æ²¡æœ‰è‡ªå·±çš„æ‰€æœ‰æƒï¼Œä»…ä»…æ˜¯å€Ÿç”¨æˆ‘ä»¬è‡ªå·±ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ï¼Œæˆ‘ä»¬ä¸èƒ½å°†å°†æˆ‘ä»¬çš„æˆå‘˜è½¬ç§»ï¼ˆmoveï¼‰å‡ºå»ï¼Œå› ä¸ºæˆ‘ä»¬ä¸èƒ½é˜»æ­¢å…¶ä»–äººå†æ¬¡è½®è¯¢ &lt;code&gt;TryJoin&lt;/code&gt; ã€‚
æ‰€ä»¥è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦å´©æºƒï¼ˆpanicï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬åƒ &lt;code&gt;Option&amp;lt;T&amp;gt;&lt;/code&gt; é‚£æ ·æœ‰ä¸€ä¸ª &lt;code&gt;.take()&lt;/code&gt; æ–¹æ³•äº‹æƒ…å°±ä¼šå¤§å¤§ç®€åŒ–ã€‚
å®ƒè¿”å› Option æ‹¥æœ‰çš„ä»»ä½•å†…å®¹ï¼Œæˆ–è€… &lt;code&gt;None&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰ &lt;code&gt;None&lt;/code&gt; ã€‚æˆ‘ä»¬åªæœ‰ &lt;code&gt;State::Future&lt;/code&gt; å’Œ &lt;code&gt;State::OK&lt;/code&gt; ï¼Œæ²¡æœ‰â€œä¸­ç«‹â€ï¼ˆneutralï¼‰çŠ¶æ€ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;enum&lt;/span&gt; &lt;span class="nc"&gt;State&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;where&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Gone&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç°åœ¨ï¼Œæˆ‘ä»¬å¯ä»¥å°† &lt;code&gt;this.a&lt;/code&gt; å’Œ &lt;code&gt;this.b&lt;/code&gt; æ›¿æ¢ä¸º &lt;code&gt;State::Gone&lt;/code&gt; ã€‚ã€‚ã€‚æˆ–è€…å®ƒçš„è¿”å›ç»“æœï¼ˆæˆ‘ä»¬æ‹¥æœ‰æ‰€æœ‰æƒï¼‰ã€‚
ç„¶åæˆ‘ä»¬å°±å¯ä»¥å°†å®ƒä»¬è½¬ç§»ï¼ˆmoveï¼‰å‡ºå»ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯åŒæ—¶ã€‚ã€‚ã€‚æˆ‘ä»¬éœ€è¦å†æ¬¡å¯¹å…¶è¿›è¡Œæ¨¡å¼åŒ¹é…ï¼ˆpattern matchï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å°±åƒï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;::&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;::&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;mem&lt;/span&gt;::&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;::&lt;span class="n"&gt;Gone&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;::&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="fm"&gt;unreachable!&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;mem&lt;/span&gt;::&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;::&lt;span class="n"&gt;Gone&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;::&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="fm"&gt;unreachable!&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)).&lt;/span&gt;&lt;span class="n"&gt;into&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Pending&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®è¯è¯´ã€‚ã€‚ã€‚æˆ‘çœ‹è¿‡æ›´ç³Ÿçš„ä»£ç ã€‚å®ƒåªæ˜¯æ²¡é‚£ä¹ˆ&lt;a href="https://en.wikipedia.org/wiki/Don%27t%5Frepeat%5Fyourself"&gt;DRY&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;éå¸¸å¥½çš„å®ç°ï¼&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:52:24.097&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Joining...
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:52:25.050&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;second
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:52:25.061&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;first
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:52:25.061&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;All&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;res&lt;/span&gt;&lt;span class="o"&gt;=(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;first&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;second&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;çœ‹ï¼Œåªæœ‰ 11ms çš„é—´éš”ã€‚&lt;/p&gt;
&lt;h3 id="æ›´è¿›ä¸€æ­¥"&gt;æ›´è¿›ä¸€æ­¥ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;è¿™æ®µä»£ç å†æ¬¡å›°æ‰°äº†æˆ‘ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;TryJoin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;where&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;: &lt;span class="nc"&gt;State&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;: &lt;span class="nc"&gt;State&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å› ä¸ºç°åœ¨ &lt;code&gt;a&lt;/code&gt; å’Œ &lt;code&gt;b&lt;/code&gt; æ˜¯ä¸‰æ€çš„ï¼ˆtri-stateï¼‰ï¼š &lt;code&gt;Future&lt;/code&gt; ã€ &lt;code&gt;Ok&lt;/code&gt; æˆ–è€… &lt;code&gt;Gone&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœ &lt;code&gt;a&lt;/code&gt; å’Œ &lt;code&gt;b&lt;/code&gt; éƒ½æ˜¯ &lt;code&gt;Gone&lt;/code&gt; å‘¢ï¼Ÿè¿™ä¸ªçŠ¶æ€ä¸åˆç†ï¼&lt;/p&gt;
&lt;p&gt;å¦‚æœå‘ç”Ÿäº†è¿™ä¸ªçŠ¶æ€ï¼Œæˆ‘ä»¬ç°åœ¨å°†ä¼šæ°¸è¿œè¿”å› &lt;code&gt;Poll::Pending&lt;/code&gt; -- è¿™ä¸å¤ªå¥½ -- ä¸€ä¸ªæ­»é”ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çœŸæ­£æƒ³è¦çš„æ˜¯ã€‚ã€‚ã€‚ä¸¤ä¸ªæšä¸¾ã€‚å®é™…ä¸Šæˆ‘ä»¬æƒ³è¦æ•´ä¸ª &lt;code&gt;TryJoin&lt;/code&gt; ç±»å‹æ˜¯ä¸€ä¸ª &lt;code&gt;enum&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;enum&lt;/span&gt; &lt;span class="nc"&gt;TryJoin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;where&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Polling&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;: &lt;span class="nc"&gt;State&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;: &lt;span class="nc"&gt;State&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Done&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åƒè¿™æ ·åˆå§‹åŒ–ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;try_join&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;: &lt;span class="nc"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;: &lt;span class="nc"&gt;B&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;impl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;where&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;TryJoin&lt;/span&gt;::&lt;span class="n"&gt;Polling&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;: &lt;span class="nc"&gt;State&lt;/span&gt;::&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;: &lt;span class="nc"&gt;State&lt;/span&gt;::&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åï¼Œsurpriceï¼ &lt;code&gt;Poll&amp;lt;T&amp;gt;&lt;/code&gt; å®ç°äº† &lt;a href="https://doc.rust-lang.org/stable/std/ops/trait.Try.html"&gt;Try&lt;/a&gt; traitã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ &lt;code&gt;?&lt;/code&gt; ã€‚
æ‰€ä»¥æœ€ç»ˆæˆ‘ä»¬çš„ä»£ç å®é™…ä¸Šéå¸¸çŸ­å°ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;impl&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TryJoin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;where&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;type&lt;/span&gt; &lt;span class="nc"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;: &lt;span class="nc"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;_&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;Poll&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;unsafe&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_unchecked_mut&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Polling&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Done&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="fm"&gt;panic!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;TryJoin future polled after completion&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;::&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fut&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;unsafe&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;::&lt;span class="n"&gt;new_unchecked&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fut&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}.&lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;::&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;::&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fut&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;unsafe&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;::&lt;span class="n"&gt;new_unchecked&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fut&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}.&lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;::&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;::&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;::&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;mem&lt;/span&gt;::&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Done&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Polling&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;                    &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;: &lt;span class="nc"&gt;State&lt;/span&gt;::&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;                    &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;: &lt;span class="nc"&gt;State&lt;/span&gt;::&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)).&lt;/span&gt;&lt;span class="n"&gt;into&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="fm"&gt;unreachable!&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Pending&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç°åœ¨ï¼Œæˆ‘çŸ¥é“ä½ åœ¨æƒ³ä»€ä¹ˆã€‚ &lt;code&gt;Pin&amp;lt;&amp;amp;mut T&amp;gt;&lt;/code&gt; ä¸æ˜¯æ°æ°ç”¨æ¥é¿å…åƒ &lt;code&gt;std::mem::swap&lt;/code&gt; å’Œ &lt;code&gt;std::mem::replace&lt;/code&gt; å—ï¼Ÿ
è¿™äº›æ‰€æœ‰çš„è½¬ç§»ï¼ˆmoveï¼‰éƒ½æ˜¯å›´ç»•ç€å†…å­˜ï¼è¿™æ˜¯è¢«ç¦æ­¢çš„ï¼æ˜¯çš„ï¼Œæˆ‘ä»¬æ‰¿è¯ºäº†ä¸å»è½¬ç§»ï¼ˆmoveï¼‰å®ƒã€‚
ä½†æ˜¯åœ¨è¿™ä¸ªæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åªæ˜¯åœ¨å®Œæˆè½®è¯¢ä¸¤ä¸ª future å¯¹è±¡åè½¬ç§»äº† &lt;code&gt;self&lt;/code&gt; / &lt;code&gt;this&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬å°±å†ä¹Ÿæ²¡æœ‰ä½¿ç”¨è¿‡ä¸¤ä¸ª future å¯¹è±¡ï¼Œæ— è®ºå›ºå®šè¿˜æ˜¯éå›ºå®šã€‚åŒæ—¶æˆ‘ä»¬ä»æ¥ä¹Ÿæ²¡ä¿è¯è¿‡ç»“æœè‡ªèº«æ˜¯å¦å°†è¦è¢«å›ºå®šï¼ˆpinnedï¼‰ï¼&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åªéœ€è¦å†³å®šæŸäº›ä¸œè¥¿æ˜¯â€œæ°¸è¿œå›ºå®šâ€è¿˜æ˜¯â€œæ°¸ä¸å›ºå®šâ€ï¼Œç„¶åæˆ‘ä»¬å¯èƒ½ä¼šç¼–å†™ç»“æœæ­£ç¡®çš„ä»£ç ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬çš„åœºæ™¯ä¸‹ï¼Œåªæœ‰ &lt;code&gt;TryJoin::Polling(State::Future(_))&lt;/code&gt; å°±æ˜¯â€œæ°¸è¿œå›ºå®šâ€ çš„ï¼Œå…¶ä»–éƒ½ä¸æ˜¯ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œæˆ‘ä»¬å¿«é€Ÿçš„ä» &lt;code&gt;Pin&amp;lt;&amp;amp;mut Self&amp;gt;&lt;/code&gt; åˆ‡æ¢åˆ° &lt;code&gt;&amp;amp;mut Self&lt;/code&gt; ï¼Œç„¶ååˆå›åˆ° &lt;code&gt;Pin&amp;lt;&amp;amp;mut A&amp;gt;&lt;/code&gt; ï¼Œ
ä½†åªè¦æˆ‘ä»¬ä¸è¦åœ¨ä¸­é—´ç§»åŠ¨å°±æ²¡æœ‰é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬åœ¨æŒæœ‰ future å¯¹è±¡çš„æƒ…å†µä¸‹ä½¿ç”¨ &lt;code&gt;std::mem:replace&lt;/code&gt; æˆ– &lt;code&gt;std::mem::swap&lt;/code&gt; å°±ä¼šä¸å¦™ã€‚
æ‰€ä»¥ï¼Œæˆ‘ä»¬è¿˜å¥½ï¼Œæˆ‘æƒ³ï¼Œæˆ‘ä¸å¤ªç¡®å®šã€‚å¦‚æœä¸æ˜¯ï¼Œæœ‰äººåº”è¯¥ä¼šç•™è¨€ã€‚&lt;/p&gt;
&lt;h3 id="å°±è¿™æ ·"&gt;å°±è¿™æ ·&lt;/h3&gt;
&lt;p&gt;è®©æˆ‘ä»¬å›é¡¾æˆ‘ä»¬çš„å·¥ä½œï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;// in `src/tj.rs`&lt;/span&gt;

&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;future&lt;/span&gt;::&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;pin&lt;/span&gt;::&lt;span class="n"&gt;Pin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;::&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="k"&gt;pub&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;try_join&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;: &lt;span class="nc"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;: &lt;span class="nc"&gt;B&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;impl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;where&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;TryJoin&lt;/span&gt;::&lt;span class="n"&gt;Polling&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;: &lt;span class="nc"&gt;State&lt;/span&gt;::&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;: &lt;span class="nc"&gt;State&lt;/span&gt;::&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;enum&lt;/span&gt; &lt;span class="nc"&gt;State&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;where&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;F&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;T&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;enum&lt;/span&gt; &lt;span class="nc"&gt;TryJoin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;where&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Polling&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;: &lt;span class="nc"&gt;State&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;: &lt;span class="nc"&gt;State&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Done&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;impl&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TryJoin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="k"&gt;where&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;: &lt;span class="nc"&gt;Future&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;type&lt;/span&gt; &lt;span class="nc"&gt;Output&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;AR&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;BR&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;E&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;: &lt;span class="nc"&gt;Pin&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Context&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="nb"&gt;_&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;Poll&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Output&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;unsafe&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_unchecked_mut&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Polling&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Done&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="fm"&gt;panic!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;TryJoin future polled after completion&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;::&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fut&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;unsafe&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;::&lt;span class="n"&gt;new_unchecked&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fut&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}.&lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;::&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;::&lt;span class="n"&gt;Future&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fut&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Ready&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;unsafe&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Pin&lt;/span&gt;::&lt;span class="n"&gt;new_unchecked&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fut&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}.&lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cx&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;::&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;::&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;State&lt;/span&gt;::&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;mem&lt;/span&gt;::&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;this&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Done&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="bp"&gt;Self&lt;/span&gt;::&lt;span class="n"&gt;Polling&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;                    &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;: &lt;span class="nc"&gt;State&lt;/span&gt;::&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;                    &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;: &lt;span class="nc"&gt;State&lt;/span&gt;::&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)).&lt;/span&gt;&lt;span class="n"&gt;into&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="fm"&gt;unreachable!&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;_&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Poll&lt;/span&gt;::&lt;span class="n"&gt;Pending&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿˜æœ‰æˆ‘ä»¬å°å°çš„ HTTPS å®¢æˆ·ç«¯ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;// in `src/main.rs`&lt;/span&gt;

&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;color_eyre&lt;/span&gt;::&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;::&lt;span class="n"&gt;SocketAddr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sync&lt;/span&gt;::&lt;span class="n"&gt;Arc&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tokio&lt;/span&gt;::&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;io&lt;/span&gt;::&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;AsyncReadExt&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;AsyncWriteExt&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;::&lt;span class="n"&gt;TcpStream&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tokio_rustls&lt;/span&gt;::&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="n"&gt;rustls&lt;/span&gt;::&lt;span class="n"&gt;ClientConfig&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TlsConnector&lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tracing&lt;/span&gt;::&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tracing_subscriber&lt;/span&gt;::&lt;span class="n"&gt;EnvFilter&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;webpki&lt;/span&gt;::&lt;span class="n"&gt;DNSNameRef&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="k"&gt;mod&lt;/span&gt; &lt;span class="nn"&gt;tj&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="cp"&gt;#[tokio::main(flavor = &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;current_thread&amp;quot;&lt;/span&gt;&lt;span class="cp"&gt;)]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Joining...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tj&lt;/span&gt;::&lt;span class="n"&gt;try_join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;first&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;second&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;All done!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="cp"&gt;#[allow(dead_code)]&lt;/span&gt;
&lt;span class="k"&gt;async&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;fetch_thing&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kt"&gt;str&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;amp;&lt;/span&gt;&lt;span class="kt"&gt;str&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// look out it&amp;#39;s port 443 now&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;addr&lt;/span&gt;: &lt;span class="nc"&gt;SocketAddr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;443&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;into&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TcpStream&lt;/span&gt;::&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;addr&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// establish a TLS session...&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;connector&lt;/span&gt;: &lt;span class="nc"&gt;TlsConnector&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ClientConfig&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;root_store&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_server_trust_anchors&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;webpki_roots&lt;/span&gt;::&lt;span class="n"&gt;TLS_SERVER_ROOTS&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;Arc&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;into&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dnsname&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DNSNameRef&lt;/span&gt;::&lt;span class="n"&gt;try_from_ascii_str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;one.one.one.one&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;connector&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dnsname&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// we&amp;#39;re writing straight to the socket, there&amp;#39;s no buffering&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// so no need to flush&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write_all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;b&amp;quot;GET / HTTP/1.1&lt;/span&gt;&lt;span class="se"&gt;\r\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write_all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;b&amp;quot;Host: one.one.one.one&lt;/span&gt;&lt;span class="se"&gt;\r\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write_all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;b&amp;quot;User-Agent: cool-bear&lt;/span&gt;&lt;span class="se"&gt;\r\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write_all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;b&amp;quot;Connection: close&lt;/span&gt;&lt;span class="se"&gt;\r\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write_all&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;b&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\r\n&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;String&lt;/span&gt;::&lt;span class="n"&gt;with_capacity&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read_to_string&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="k"&gt;await&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lines&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;unwrap_or_default&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Got response!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// dropping the socket will close the connection&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;setup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nb"&gt;Result&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Report&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;env&lt;/span&gt;::&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;RUST_LIB_BACKTRACE&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;is_err&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;env&lt;/span&gt;::&lt;span class="n"&gt;set_var&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;RUST_LIB_BACKTRACE&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;color_eyre&lt;/span&gt;::&lt;span class="n"&gt;install&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;env&lt;/span&gt;::&lt;span class="n"&gt;var&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;RUST_LOG&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="n"&gt;is_err&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;std&lt;/span&gt;::&lt;span class="n"&gt;env&lt;/span&gt;::&lt;span class="n"&gt;set_var&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;RUST_LOG&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;info&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;tracing_subscriber&lt;/span&gt;::&lt;span class="n"&gt;fmt&lt;/span&gt;::&lt;span class="n"&gt;fmt&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;with_env_filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;EnvFilter&lt;/span&gt;::&lt;span class="n"&gt;from_default_env&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;init&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;Ok&lt;/span&gt;&lt;span class="p"&gt;(())&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;And it works.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;RUST_LOG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;cargo&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;--quiet&lt;span class="w"&gt; &lt;/span&gt;--release
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;26&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;00&lt;/span&gt;:08:13.399&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Joining...
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;26&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;00&lt;/span&gt;:08:13.707&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;first
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;26&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;00&lt;/span&gt;:08:13.709&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;Got&lt;span class="w"&gt; &lt;/span&gt;response!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;status&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;HTTP/1.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;second
Jul&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;26&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;00&lt;/span&gt;:08:13.710&lt;span class="w"&gt;  &lt;/span&gt;INFO&lt;span class="w"&gt; &lt;/span&gt;waytoodeep:&lt;span class="w"&gt; &lt;/span&gt;All&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;!&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;res&lt;/span&gt;&lt;span class="o"&gt;=(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;first&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;second&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;2ms é—´éš”ï¼è¿™æ˜¯ä¸€ä¸ªæ–°çš„è®°å½•ã€‚&lt;/p&gt;</content><category term="Rust"></category><category term="Rust"></category><category term="future"></category><category term="tokio"></category></entry><entry><title>ä»é›¶å¼€å§‹ç”¨ Emacs ç®¡ç†ç¬”è®°</title><link href="https://www.linuxzen.com/dump-brain-with-emacs.html" rel="alternate"></link><published>2021-07-28T00:00:00+08:00</published><updated>2021-07-28T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2021-07-28:/dump-brain-with-emacs.html</id><summary type="html">&lt;h1 id="_1"&gt;ç”¨è¿‡çš„ç¬”è®°ç®¡ç†è½¯ä»¶&lt;/h1&gt;
&lt;p&gt;æˆ‘æ¢ç´¢è¿‡å¾ˆå¤šç¬”è®°ç®¡ç†è½¯ä»¶ï¼Œä»æœ€å¼€å§‹ç”¨ Vim çš„æ—¶å€™ä½¿ç”¨ Vimwikiï¼Œåé¢è½¬å‘è‡ªæ‰˜ç®¡çš„ leanoteã€‚åé¢ç¼–è¾‘å™¨åˆ‡æ¢åˆ° â€¦&lt;/p&gt;</summary><content type="html">&lt;h1 id="_1"&gt;ç”¨è¿‡çš„ç¬”è®°ç®¡ç†è½¯ä»¶&lt;/h1&gt;
&lt;p&gt;æˆ‘æ¢ç´¢è¿‡å¾ˆå¤šç¬”è®°ç®¡ç†è½¯ä»¶ï¼Œä»æœ€å¼€å§‹ç”¨ Vim çš„æ—¶å€™ä½¿ç”¨ Vimwikiï¼Œåé¢è½¬å‘è‡ªæ‰˜ç®¡çš„ leanoteã€‚åé¢ç¼–è¾‘å™¨åˆ‡æ¢åˆ° Emacs å°è¯•è¿‡ org-wikiï¼Œ
æœ€ç»ˆç°åœ¨å¼€å§‹ä½¿ç”¨ org-roamã€‚org-roam åŸºäº Emacs + Orgmode çš„ &lt;a href="https://roamresearch.com/"&gt;Roam Research&lt;/a&gt; å¼€æºç‰ˆæœ¬ã€‚&lt;/p&gt;
&lt;h1 id="_2"&gt;å…·ä½“é…ç½®è¿‡ç¨‹&lt;/h1&gt;
&lt;p&gt;å‚è§ &lt;a href="https://coldnight.github.io/dump-brain-with-emacs/posts/dump-brain-with-emacs/"&gt;ä»é›¶å¼€å§‹ç”¨ Emacs ç®¡ç†ç¬”è®°&lt;/a&gt;ã€‚&lt;/p&gt;</content><category term="Other"></category><category term="Notes"></category></entry><entry><title>ã€è¯‘ã€‘Python å¹•å #1: CPython è™šæ‹Ÿæœºå¦‚ä½•å·¥ä½œ</title><link href="https://www.linuxzen.com/python-behind-the-scenes_1_how_cpython_vm_works.html" rel="alternate"></link><published>2020-09-08T00:00:00+08:00</published><updated>2020-09-08T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2020-09-08:/python-behind-the-scenes_1_how_cpython_vm_works.html</id><summary type="html">&lt;p&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href="https://tenthousandmeters.com/blog/python-behind-the-scenes-1-how-the-cpython-vm-works/"&gt;Python behind the scenes #1: how the CPython VM works&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id="ä»‹ç»-introduction"&gt;ä»‹ç»ï¼ˆIntroductionï¼‰&lt;/h3&gt;
&lt;p&gt;ä½ æ˜¯å¦æ›¾ç»å¥½å¥‡è¿‡å½“ä½ è¿è¡Œ Python ä»£ç æ—¶ &lt;code&gt;python&lt;/code&gt; åšäº†äº›ä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;python&lt;span class="w"&gt; &lt;/span&gt;script.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™ç¯‡æ–‡ç« å°†å¼€å¯ä¸€ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href="https://tenthousandmeters.com/blog/python-behind-the-scenes-1-how-the-cpython-vm-works/"&gt;Python behind the scenes #1: how the CPython VM works&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id="ä»‹ç»-introduction"&gt;ä»‹ç»ï¼ˆIntroductionï¼‰&lt;/h3&gt;
&lt;p&gt;ä½ æ˜¯å¦æ›¾ç»å¥½å¥‡è¿‡å½“ä½ è¿è¡Œ Python ä»£ç æ—¶ &lt;code&gt;python&lt;/code&gt; åšäº†äº›ä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;python&lt;span class="w"&gt; &lt;/span&gt;script.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™ç¯‡æ–‡ç« å°†å¼€å¯ä¸€ä¸ªç³»åˆ—æ¥å°è¯•è§£ç­”è¿™ä¸ªé—®é¢˜ã€‚æˆ‘ä»¬å°†æ·±å…¥ Python æœ€æµè¡Œçš„å®ç° CPython çš„å†…éƒ¨ã€‚
é€šè¿‡æ·±å…¥ CPython çš„å†…éƒ¨æˆ‘ä»¬å°†æ›´æ·±ä¸€å±‚çš„å»ç†è§£è¿™é—¨ç¼–ç¨‹è¯­è¨€æœ¬èº«ã€‚è¿™ä¹Ÿæ˜¯æˆ‘ä»¬è¿™ä¸ªç³»åˆ—çš„æœ€ä¸»è¦çš„ç›®æ ‡ã€‚
å¦‚æœä½ ç†Ÿæ‚‰ Python å¹¶ä¸”å¯ä»¥é˜…è¯» C ä»£ç ï¼Œä½†æ˜¯å¯¹ CPython æºç æœ¬èº«æ²¡æœ‰å¤ªå¤šçš„ç»éªŒï¼Œ
é‚£ä¹ˆä½ å¯èƒ½éå¸¸é€‚åˆæœ¬ç³»åˆ—ï¼Œå¹¶ä¸”å¯¹æœ¬ç³»åˆ—æ„Ÿå…´è¶£ã€‚&lt;/p&gt;
&lt;h3 id="ä»€ä¹ˆæ˜¯-cpython-å¹¶ä¸”ä¸ºä»€ä¹ˆæœ‰äººæƒ³å­¦ä¹ å®ƒ-what-cpython-is-and-why-anyone-would-want-to-study-it"&gt;ä»€ä¹ˆæ˜¯ CPython å¹¶ä¸”ä¸ºä»€ä¹ˆæœ‰äººæƒ³å­¦ä¹ å®ƒï¼ˆWhat CPython is and why anyone would want to study itï¼‰&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬é¦–å…ˆæ¥è¯´æ˜ä¸€äº›ä¼—æ‰€å‘¨çŸ¥çš„äº‹æƒ…ã€‚CPython æ˜¯ç”¨ C ç¼–å†™çš„ Python è§£æå™¨ã€‚ä»–æ˜¯ Python è¯­è¨€çš„ä¼—å¤šå®ç°
çš„ä¸€ç§ï¼Œå…¶ä»–è¿˜æœ‰è¯¸å¦‚ PyPyã€Jythonã€IronPython ç­‰ã€‚CPython çš„ç‹¬ç‰¹ä¹‹å¤„åœ¨äºå®ƒæ˜¯ Python çš„èµ·æºã€ç»´æŠ¤æ—¶é—´æœ€é•¿ä¹Ÿæ˜¯æœ€å—æ¬¢è¿çš„ã€‚&lt;/p&gt;
&lt;p&gt;CPython å®ç°äº† Pythonï¼Œä½†æ˜¯ Python æ˜¯ä»€ä¹ˆï¼Ÿæœ€ç®€å•çš„ä¸€ä¸ªç­”æ¡ˆå¯èƒ½æ˜¯ï¼šPython æ˜¯ä¸€é—¨ç¼–ç¨‹è¯­è¨€ã€‚
å½“æ­£ç¡®é—®ç›¸åŒçš„é—®é¢˜ï¼Œé‚£ä¹ˆç­”æ¡ˆå°†ä¼šæ›´åŠ æ˜ç¡®ï¼šä»€ä¹ˆå®šä¹‰äº† Pythonï¼ŸPython ä¸åƒ C è¯­è¨€æœ‰æ­£å¼çš„è§„èŒƒï¼Œ
ä½†æ˜¯ä¸ä¹‹ç›¸è¿‘çš„æ˜¯ &lt;a href="https://docs.python.org/zh-cn/3.9/reference/index.html"&gt;Python è¯­è¨€å‚è€ƒï¼ˆPython Language Referenceï¼‰&lt;/a&gt;ï¼Œå®ƒä»¥å¦‚ä¸‹å†…å®¹å¼€å§‹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æˆ‘å¸Œæœ›å°½å¯èƒ½åœ°ä¿è¯å†…å®¹ç²¾ç¡®æ— è¯¯ï¼Œä½†è¿˜æ˜¯é€‰æ‹©ä½¿ç”¨è‡ªç„¶è¯å¥è¿›è¡Œæè¿°ï¼Œæ­£å¼çš„è§„æ ¼å®šä¹‰ä»…ç”¨äºå¥æ³•å’Œè¯æ³•è§£æã€‚è¿™æ ·åº”è¯¥èƒ½ä½¿æ–‡æ¡£å¯¹äºæ™®é€šäººæ¥è¯´æ›´æ˜“ç†è§£ï¼Œä½†ä¹Ÿå¯èƒ½å¯¼è‡´ä¸€äº›æ­§ä¹‰ã€‚å› æ­¤ï¼Œå¦‚æœä½ æ˜¯æ¥è‡ªç«æ˜Ÿå¹¶ä¸”æƒ³å‡­å€Ÿè¿™ä»½æ–‡æ¡£æŠŠ Python é‡æ–°å®ç°ä¸€éï¼Œä¹Ÿè®¸æœ‰æ—¶éœ€è¦è‡ªè¡ŒçŒœæµ‹ï¼Œå®é™…ä¸Šæœ€ç»ˆå¤§æ¦‚ä¼šå¾—åˆ°ä¸€ä¸ªååˆ†ä¸åŒçš„è¯­è¨€ã€‚è€Œåœ¨å¦ä¸€æ–¹é¢ï¼Œå¦‚æœä½ æ­£åœ¨ä½¿ç”¨ Python å¹¶ä¸”æƒ³äº†è§£æœ‰å…³è¯¥è¯­è¨€ç‰¹å®šé¢†åŸŸçš„ç²¾ç¡®è§„åˆ™ï¼Œä½ åº”è¯¥èƒ½å¤Ÿåœ¨è¿™é‡Œæ‰¾åˆ°å®ƒä»¬ã€‚å¦‚æœä½ å¸Œæœ›æŸ¥çœ‹å¯¹è¯¥è¯­è¨€æ›´æ­£å¼çš„å®šä¹‰ï¼Œä¹Ÿè®¸ä½ å¯ä»¥èŠ±äº›æ—¶é—´è‡ªå·±å†™ä¸Šä¸€ä»½ --- æˆ–è€…å‘æ˜ä¸€å°å…‹éš†æœºå™¨ :-)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;æ‰€ä»¥ Python ä¸ä»…ä»…é€šè¿‡è¯­è¨€å‚è€ƒå®šä¹‰ï¼Œè¯´ Python æ˜¯é€šè¿‡è¯­è¨€å‚è€ƒå®šä¹‰çš„å®ç°æˆ–è€…è¯´æ˜¯ CPython éƒ½æ˜¯é”™è¯¯çš„ï¼Œ
å› ä¸ºå…¶ä¸­çš„ä¸€äº›å®ç°ç»†èŠ‚å¹¶ä¸æ˜¯è¯­è¨€çš„ä¸€éƒ¨åˆ†ã€‚ä¸€ä¸ªåŸºäºå¼•ç”¨è®¡æ•°çš„åƒåœ¾å›æ”¶å™¨å°±æ˜¯ä¾‹å­ã€‚ç”±äºæ²¡æœ‰ä¸€ä¸ªæ¥è¯´æ³•æ˜¯æ­£ç¡®çš„ï¼Œ
æˆ‘ä»¬å¯ä»¥è¯´ Python çš„ä¸€éƒ¨åˆ†æ˜¯ç”± Python è¯­è¨€å‚è€ƒï¼ˆPython Language Referenceï¼‰å®šä¹‰ï¼Œ
ä¸€éƒ¨åˆ†æ˜¯å®ƒçš„ä¸»è¦å®ç° CPython å®šä¹‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·çš„ç»“è®ºä¼¼ä¹å¾ˆå¤æ€ªï¼Œä½†æ˜¯æˆ‘è®¤ä¸ºè¿™å¯¹æˆ‘ä»¬å¼„æ¸…æˆ‘ä»¬è¦å­¦ä¹ çš„ä¸»é¢˜è‡³å…³é‡è¦ã€‚æˆ‘ä»¬å¯èƒ½ä¾ç„¶å›°æƒ‘æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦å­¦ä¹ å®ƒã€‚
é™¤äº†å¥½å¥‡å¿ƒï¼Œæˆ‘è®¤ä¸ºè¿˜æœ‰å¦‚ä¸‹ç†ç”±ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ‹¥æœ‰å®Œæ•´çš„è§†è§’å¯ä»¥æ›´æ·±å…¥çš„ç†è§£è¿™é—¨è¯­è¨€ã€‚å¦‚æœäº†è§£ä¸€äº› Python çš„ç»†èŠ‚é‚£ä¹ˆå°±æ›´å®¹æ˜“æŒæ¡ä¸€äº› Python ç‰¹æ€§ã€‚&lt;/li&gt;
&lt;li&gt;åœ¨å®è·µä¸­å®ç°ç»†èŠ‚å¾ˆé‡è¦ã€‚å½“æƒ³è¦äº†è§£è¯­è¨€é€‚ç”¨æ€§åŠå…¶å±€é™æ€§ã€è¯„ä¼°æ€§èƒ½æˆ–æ£€æµ‹æ•ˆç‡ä½ä¸‹æ—¶ï¼Œäº†è§£å¯¹è±¡å¦‚ä½•å­˜å‚¨ï¼Œ
    åƒåœ¾å›æ”¶å™¨å¦‚ä½•å·¥ä½œï¼Œä»¥åŠå¦‚ä½•åè°ƒå¤šä¸ªçº¿ç¨‹å°†æ˜¯éå¸¸é‡è¦çš„ã€‚&lt;/li&gt;
&lt;li&gt;CPython æä¾›äº† Python/C API æ¥å…è®¸æˆ‘ä»¬ç”¨ C æ‰©å±• Python æˆ–è€…åœ¨ C ä¸­åµŒå…¥ Pythonã€‚
    ç¨‹åºå‘˜éœ€è¦å¾ˆå¥½çš„ç†è§£ CPython å¦‚ä½•å·¥ä½œæ‰èƒ½é«˜æ•ˆçš„ä½¿ç”¨è¿™äº› APIã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="äº†è§£-cpython-å¦‚æœå·¥ä½œéœ€è¦åšäº›ä»€ä¹ˆ-what-it-takes-to-understand-how-cpython-works"&gt;äº†è§£ CPython å¦‚æœå·¥ä½œéœ€è¦åšäº›ä»€ä¹ˆï¼ˆWhat it takes to understand how CPython worksï¼‰&lt;/h3&gt;
&lt;p&gt;CPython è¢«è®¾è®¡æˆæ˜“äºç»´æŠ¤ã€‚ä¸€ä¸ªæ–°äººå®Œå…¨å¯ä»¥é˜…è¯»æºä»£ç å¹¶ç†è§£ä»£ç åšäº†äº›ä»€ä¹ˆã€‚ä½†æ˜¯ï¼Œè¿™å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´ã€‚
é€šè¿‡è¿™ä¸ªç³»åˆ—æˆ‘å¸Œæœ›èƒ½å¸®åŠ©ä½ ç¼©çŸ­è¿™ä¸ªæ—¶é—´ã€‚&lt;/p&gt;
&lt;h3 id="è¿™ä¸ªç³»åˆ—å¦‚ä½•æ¨è¿›-how-this-series-is-laid-out"&gt;è¿™ä¸ªç³»åˆ—å¦‚ä½•æ¨è¿›ï¼ˆHow this series is laid outï¼‰&lt;/h3&gt;
&lt;p&gt;æˆ‘é€‰æ‹©é‡‡å–è‡ªä¸Šè€Œä¸‹çš„æ–¹æ³•ã€‚åœ¨è¿™ä¸ªéƒ¨åˆ†æˆ‘ä»¬å°†æ¢ç´¢ CPython è™šæ‹Ÿæœºçš„æ ¸å¿ƒæ¦‚å¿µã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†çœ‹åˆ°
CPython å¦‚ä½•ç¼–è¯‘ä¸€ä¸ªç¨‹åºåˆ° VM å¯ä»¥æ‰§è¡Œçš„å†…å®¹ã€‚å†ç„¶åï¼Œæˆ‘ä»¬å°†ç†Ÿæ‚‰æºä»£ç ï¼Œå¹¶é€šè¿‡æ‰§è¡Œä¸€ä¸ªç¨‹åº
æ¥å­¦ä¹ è§£é‡Šå™¨çš„ä¸»è¦éƒ¨åˆ†ã€‚æœ€åï¼Œæˆ‘ä»¬å¯ä»¥æŒ‘é€‰è¯­è¨€ä¸åŒçš„æ–¹é¢æ¥ä¸€ä¸ªæ¥ä¸€ä¸ªçš„å»çœ‹çœ‹å®ƒä»¬æ˜¯å¦‚ä½•å®ç°çš„ã€‚
è¿™æ˜¯æˆ‘çš„ä¸€ä¸ªå¤§æ¦‚çš„æƒ³æ³•ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªä¸¥æ ¼çš„è®¡åˆ’ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;*Note&lt;/em&gt;&lt;/strong&gt;*: æœ¬æ–‡å‚è€ƒ CPython 3.9ã€‚ä¸€äº›å®ç°ç»†èŠ‚å°†å¿…ç„¶ä¼šéšç€ CPython çš„æ¼”è¿›è€Œæ”¹å˜ã€‚
æˆ‘å°†ä¼šå°è¯•å…³æ³¨ä¸€äº›é‡è¦çš„æ”¹å˜å¹¶æ·»åŠ æ›´æ–°å¤‡æ³¨ã€‚&lt;/p&gt;
&lt;h3 id="é¸Ÿç°-the-big-picture"&gt;é¸Ÿç°ï¼ˆThe big pictureï¼‰&lt;/h3&gt;
&lt;p&gt;æ‰§è¡Œä¸€ä¸ª Python ç¨‹åºå¤§æ¦‚ç»è¿‡ä¸‰ä¸ªé˜¶æ®µï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åˆå§‹åŒ–ï¼ˆInitializationï¼‰&lt;/li&gt;
&lt;li&gt;ç¼–è¯‘ï¼ˆCompilationï¼‰&lt;/li&gt;
&lt;li&gt;è§£é‡Šï¼ˆInterpretationï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åœ¨åˆå§‹åŒ–é˜¶æ®µï¼ŒCPython åˆå§‹åŒ–è¿è¡Œ Python æ‰€éœ€è¦çš„æ•°æ®ç»“æ„ã€‚åŒæ—¶ä¹Ÿå‡†å¤‡ä¸€äº›è¯¸å¦‚
å†…å»ºç±»å‹ã€é…ç½®å’ŒåŠ è½½å†…å»ºæ¨¡å—ï¼Œåˆå§‹åŒ–å¯¼å…¥ç³»ç»Ÿï¼ˆimport systemï¼‰å’Œä¸€äº›å…¶ä»–çš„äº‹æƒ…ã€‚
è¿™æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„é˜¶æ®µï¼Œä½†æ˜¯ç”±äºå…¶åŠŸèƒ½æ€§è´¨è¿™ä¸ªé˜¶æ®µä¹Ÿæ˜¯å¸¸è¢« CPython çš„æ¢ç´¢è€…å¿½ç•¥çš„ä¸€ä¸ªé˜¶æ®µã€‚&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥æ˜¯ç¼–è¯‘é˜¶æ®µã€‚CPython åœ¨æŸç§æ„ä¹‰ä¸Šæ˜¯ä¸€ä¸ªè§£é‡Šå™¨è€Œä¸æ˜¯ç¼–è¯‘å™¨ï¼Œå› ä¸ºå®ƒä¸è¾“å‡ºæœºå™¨ç ã€‚
ä½†æ˜¯è§£é‡Šå™¨é€šå¸¸ä¼šåœ¨æ‰§è¡Œä¹‹å‰æŠŠæºä»£ç ç¿»è¯‘æˆä¸€ç§ä¸­é—´è¯­è¨€ï¼ˆintermediate representationï¼‰ã€‚
CPython ä¹Ÿæ˜¯å¦‚æ­¤ã€‚è¿™ä¸ªç¿»è¯‘é˜¶æ®µå’Œä¸€ä¸ªå…¸å‹çš„ç¼–è¯‘å™¨åšåŒæ ·çš„äº‹æƒ…ï¼šè§£ææºä»£ç ç„¶åæ„å»º ASTï¼ˆAbstract Syntax Treeï¼‰ã€
é€šè¿‡ AST ç”Ÿæˆå­—èŠ‚ç ã€ç”šè‡³æ‰§è¡Œä¸€äº›å­—èŠ‚ç ä¼˜åŒ–çš„æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;åœ¨è¿›å…¥ä¸‹ä¸€é˜¶æ®µä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦ç†è§£ä»€ä¹ˆæ˜¯å­—èŠ‚ç ï¼ˆbytecodeï¼‰ã€‚å­—èŠ‚ç æ˜¯ä¸€ç³»åˆ—çš„æŒ‡ä»¤ã€‚
æ¯ä¸€ä¸ªæŒ‡ä»¤ç”±ä¸¤ä¸ªå­—èŠ‚ç»„æˆï¼šä¸€ä¸ªä¸º opcodeï¼Œä¸€ä¸ªä¸ºå‚æ•°ï¼ˆargumentï¼‰ã€‚çœ‹å¦‚ä¸‹ä¾‹å­ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;g&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;CPython å°†å‡½æ•°å®šä¹‰ &lt;code&gt;g&lt;/code&gt; ç¿»è¯‘æˆä¸€ä¸ªå­—èŠ‚åºåˆ—ï¼š[124, 0, 100, 1, 23, 0, 83, 0]ã€‚
å¦‚æœæˆ‘ä»¬è¿è¡Œæ ‡å‡†åº“ &lt;code&gt;dis&lt;/code&gt;&amp;nbsp;&lt;sup id="fnref:fn:1"&gt;&lt;a class="footnote-ref" href="#fn:fn:1"&gt;1&lt;/a&gt;&lt;/sup&gt;å»åæ±‡ç¼–å®ƒï¼Œæˆ‘ä»¬å°†ä¼šå¾—åˆ°å¦‚ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="mi"&gt;2&lt;/span&gt;           &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="n"&gt;LOAD_FAST&lt;/span&gt;            &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="n"&gt;LOAD_CONST&lt;/span&gt;           &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="mi"&gt;4&lt;/span&gt; &lt;span class="n"&gt;BINARY_ADD&lt;/span&gt;
            &lt;span class="mi"&gt;6&lt;/span&gt; &lt;span class="n"&gt;RETURN_VALUE&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å­—èŠ‚ &lt;code&gt;124&lt;/code&gt; è¡¨ç¤º opcode &lt;code&gt;LOAD_FAST&lt;/code&gt; å¹¶ä¸”æœ‰ä¸€ä¸ªå‚æ•° &lt;code&gt;0&lt;/code&gt; ã€‚å­—èŠ‚ &lt;code&gt;100&lt;/code&gt; è¡¨ç¤º opcode &lt;code&gt;LOAD_CONST&lt;/code&gt; å¹¶ä¸”æœ‰ä¸€ä¸ªå‚æ•° &lt;code&gt;1&lt;/code&gt; ã€‚
&lt;code&gt;BINARY_ADD&lt;/code&gt; å’Œ &lt;code&gt;RETURN_VALUE&lt;/code&gt; æŒ‡ä»¤ä¸éœ€è¦å‚æ•°æ‰€ä»¥æ€»æ˜¯è¢«ç¼–ç æˆ &lt;code&gt;(23, 0)&lt;/code&gt; å’Œ &lt;code&gt;(83, 0)&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;CPython çš„æ ¸å¿ƒå°±æ˜¯ä¸€ä¸ªè¿è¡Œå­—èŠ‚ç çš„è™šæ‹Ÿæœºã€‚é€šè¿‡æŸ¥çœ‹ä¸Šé¢ä¾‹å­ä½ å¯èƒ½å·²ç»çŒœåˆ°å®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„æ‹‰ã€‚
CPython è™šæ‹Ÿæœºä¸€ä¸ªåŸºäºæ ˆçš„ã€‚ä¹Ÿå°±æ„å‘³è¿™å®ƒæ‰§è¡ŒæŒ‡ä»¤å¹¶é€šè¿‡æ ˆå­˜å‚¨å’Œè·å–æ•°æ®ã€‚
&lt;code&gt;LOAD_FAST&lt;/code&gt; æŒ‡ä»¤å°†å±€éƒ¨å˜é‡å‹å…¥æ ˆï¼Œ
&lt;code&gt;LOAD_CONST&lt;/code&gt; å‹å…¥ä¸€ä¸ªå¸¸é‡ï¼Œ
&lt;code&gt;BINARY_ADD&lt;/code&gt; ä»æ ˆä¸­å¼¹å‡ºä¸¤ä¸ªå¯¹è±¡ï¼Œç„¶åè¿›è¡Œç›¸åŠ å¹¶å°†ç»“æœæ”¾å›æ ˆã€‚
æœ€å¥½ &lt;code&gt;RETURN_VALUE&lt;/code&gt; ä»æ ˆå¼¹å‡ºä»»æ„å€¼ç„¶åå°†ç»“æœè¿”å›ç»™è°ƒç”¨è€…ã€‚&lt;/p&gt;
&lt;p&gt;å½“æœ‰æŒ‡ä»¤éœ€è¦è¿è¡Œæ—¶å­—èŠ‚ç è¿è¡Œåœ¨ä¸€ä¸ªå·¨å¤§çš„æ‰§è¡Œå¾ªç¯ä¸­ï¼Œ &lt;code&gt;yield&lt;/code&gt; ä¸€ä¸ªå€¼æˆ–è€…å‘ç”Ÿé”™è¯¯å°†å¯¼è‡´å®ƒåœæ­¢ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·ä¸€ä¸ªç®€çŸ­æ¦‚è¿°å¼•å‘äº†å¾ˆå¤šé—®é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å‚æ•°å¯¹ opcode &lt;code&gt;LOAD_FAST&lt;/code&gt; å’Œ &lt;code&gt;LOAD_CONST&lt;/code&gt; çš„æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿä»–ä»¬æ˜¯ç´¢å¼•å—ï¼Ÿä»–ä»¬å¦‚ä½•ç´¢å¼•ï¼Ÿ&lt;/li&gt;
&lt;li&gt;VM ä¼šåœ¨æ ˆä¸Šæ”¾ç½®å€¼æˆ–è€…å¯¹è±¡çš„å¼•ç”¨å—ï¼Ÿ&lt;/li&gt;
&lt;li&gt;CPython å¦‚ä½•çŸ¥é“ &lt;code&gt;x&lt;/code&gt; æ˜¯ä¸€ä¸ªå±€éƒ¨å˜é‡ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœå‚æ•°å¤ªå¤§æ— æ³•æ”¾åˆ°ä¸€ä¸ªå­—èŠ‚å†…æ€ä¹ˆåŠï¼Ÿ&lt;/li&gt;
&lt;li&gt;è¿æ¥ä¸¤ä¸ªå­—ç¬¦ä¸²å’Œä¸¤ä¸ªæ•°å­—ç›¸åŠ æ˜¯åŒä¸€ä¸ªæŒ‡ä»¤å—ï¼Ÿå¦‚æœæ˜¯ï¼ŒVM å¦‚ä½•å¤„ç†è¿™äº›æ“ä½œä¹‹é—´çš„å·®å¼‚ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¦å›ç­”è¿™äº›å’Œå…¶ä»–ä¸€äº›æœ‰è¶£çš„é—®é¢˜æˆ‘ä»¬éœ€è¦å…ˆçœ‹ä¸€ä¸‹ CPython VM çš„ä¸€äº›æ ¸å¿ƒæ¦‚å¿µã€‚&lt;/p&gt;
&lt;h3 id="ä»£ç å¯¹è±¡-å‡½æ•°å¯¹è±¡-å¸§-code-objects-function-objects-frames"&gt;ä»£ç å¯¹è±¡ã€å‡½æ•°å¯¹è±¡ã€å¸§ï¼ˆCode objects, function objects, framesï¼‰&lt;/h3&gt;
&lt;h4 id="ä»£ç å¯¹è±¡"&gt;ä»£ç å¯¹è±¡&lt;/h4&gt;
&lt;p&gt;æˆ‘ä»¬å·²ç»çœ‹è¿‡ä¸€ä¸ªç®€å•çš„å‡½æ•°çš„å­—èŠ‚ç æ˜¯ä»€ä¹ˆæ ·å­çš„ã€‚ä½†æ˜¯ä¸€ä¸ªå…¸å‹çš„ Python ç¨‹åºè¦å¤æ‚çš„å¤šã€‚
VM å¦‚ä½•æ‰§è¡Œä¸€ä¸ªåŒ…å«ç¨‹åºå®šä¹‰å’Œå‡½æ•°è°ƒç”¨çš„æ¨¡å—ï¼ˆmoduleï¼‰ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è€ƒè™‘å¦‚ä¸‹ç¨‹åºï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;

&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®ƒçš„å­—èŠ‚ç ä»€ä¹ˆæ ·å­ï¼Ÿè®©æˆ‘ä»¬åˆ†æè¿™ä¸ªç¨‹åºåšäº†ä»€ä¹ˆæ¥è§£ç­”è¿™ä¸ªé—®é¢˜ã€‚å®ƒå®šä¹‰äº†ä¸€ä¸ªå‡½æ•° &lt;code&gt;f&lt;/code&gt; ï¼Œ
é€šè¿‡ä¸€ä¸ªå‚æ•° &lt;code&gt;1&lt;/code&gt; è°ƒç”¨å‡½æ•° &lt;code&gt;f&lt;/code&gt; ç„¶åæ‰“å°ç»“æœã€‚æ— è®ºå‡½æ•° &lt;code&gt;f&lt;/code&gt; åšäº†ä»€ä¹ˆéƒ½ä¸ä¼šåŒ…å«åœ¨æ¨¡å—å­—èŠ‚ç ä¸­ã€‚
æˆ‘ä»¬å¯ä»¥é€šè¿‡è¿è¡Œä¸€ä¸ªåæ±‡ç¼–æ¥è¯æ˜æˆ‘ä»¬è‡ªå·±ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="mf"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kr"&gt;LOAD&lt;/span&gt;&lt;span class="n"&gt;_CONST&lt;/span&gt;&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="mf"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;object&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;at&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0&lt;/span&gt;&lt;span class="n"&gt;x10bffd1e0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;example.py&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kr"&gt;LOAD&lt;/span&gt;&lt;span class="n"&gt;_CONST&lt;/span&gt;&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="mf"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MAKE_FUNCTION&lt;/span&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="mf"&gt;0&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="mf"&gt;6&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;STORE_NAME&lt;/span&gt;&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="mf"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="mf"&gt;4&lt;/span&gt;&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="mf"&gt;8&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kr"&gt;LOAD&lt;/span&gt;&lt;span class="n"&gt;_NAME&lt;/span&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kr"&gt;print&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="mf"&gt;10&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kr"&gt;LOAD&lt;/span&gt;&lt;span class="n"&gt;_NAME&lt;/span&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="mf"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="mf"&gt;12&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kr"&gt;LOAD&lt;/span&gt;&lt;span class="n"&gt;_CONST&lt;/span&gt;&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="mf"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="mf"&gt;14&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CALL_FUNCTION&lt;/span&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="mf"&gt;1&lt;/span&gt;
&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="mf"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;CALL_FUNCTION&lt;/span&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="mf"&gt;1&lt;/span&gt;
&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="mf"&gt;18&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;POP_TOP&lt;/span&gt;
&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="mf"&gt;20&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kr"&gt;LOAD&lt;/span&gt;&lt;span class="n"&gt;_CONST&lt;/span&gt;&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="mf"&gt;3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="mf"&gt;22&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kr"&gt;RETURN&lt;/span&gt;&lt;span class="n"&gt;_VALUE&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç¬¬ä¸€è¡Œé€šè¿‡ä»ä¸€äº›å«åšä»£ç å¯¹è±¡ï¼ˆcode objectï¼‰çš„ä¸œè¥¿åˆ›å»ºä¸€ä¸ªå‡½æ•°å¹¶ç»‘å®šåå­—ä¸º &lt;code&gt;f&lt;/code&gt; æ¥å®šä¹‰å‡½æ•° &lt;code&gt;f&lt;/code&gt; ã€‚
æˆ‘ä»¬æ²¡æœ‰çœ‹åˆ°å‡½æ•° &lt;code&gt;f&lt;/code&gt; ç”¨æ¥è¿”å›ä¸€ä¸ªè‡ªå¢çš„å‚æ•°çš„å­—èŠ‚ç ã€‚&lt;/p&gt;
&lt;p&gt;è¢«ä½œä¸ºå•ä¸€æ‰§è¡Œå•å…ƒçš„ä»£ç ç‰‡æ®µå¦‚ä¸€ä¸ªæ¨¡å—æˆ–è€…ä¸€ä¸ªå‡½æ•°ä½“è¢«ç§°ä¸ºä»£ç å—ã€‚
CPython å­˜å‚¨å…³äºä»£ç å—çš„ä¿¡æ¯çš„ç»“æ„ä½“å°±æ˜¯ä»£ç å¯¹è±¡ï¼ˆcode objectï¼‰ã€‚
å®ƒåŒ…å«å­—èŠ‚ç å’Œä¸€äº›å…¶ä»–çš„æ¯”å¦‚ä»£ç å—ä½¿ç”¨çš„å˜é‡ååˆ—è¡¨ã€‚è¿è¡Œä¸€ä¸ªæ¨¡å—æˆ–è€…è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ„å‘³ç€å¼€å§‹
æ‰§è¡Œç›¸åº”çš„ä»£ç å¯¹è±¡ã€‚&lt;/p&gt;
&lt;h4 id="å‡½æ•°å¯¹è±¡-function-object"&gt;å‡½æ•°å¯¹è±¡ï¼ˆfunction objectï¼‰&lt;/h4&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œå‡½æ•°ä¸ä»…ä»…æ˜¯ä»£ç å¯¹è±¡ã€‚å®ƒå¿…é¡»åŒ…å«ä¸€äº›é¢å¤–çš„ä¿¡æ¯æ¯”å¦‚åå­—ã€æ–‡æ¡£å­—ç¬¦ä¸²ï¼ˆdocstringï¼‰ã€
é»˜è®¤å‚æ•°å’Œå®šä¹‰åœ¨é—­åŒ…ä½œç”¨åŸŸä¸­çš„å˜é‡çš„å€¼ã€‚è¿™äº›ä¿¡æ¯è¿åŒä»£ç å¯¹è±¡å­˜å‚¨åœ¨ä¸€ä¸ªå‡½æ•°å¯¹è±¡é‡Œã€‚
&lt;code&gt;MAKE_FUNCTION&lt;/code&gt; æŒ‡ä»¤ç”¨äºåˆ›å»ºå‡½æ•°å¯¹è±¡ã€‚CPython ä¸­å®šä¹‰å‡½æ•°å¯¹è±¡çš„æºç å‰ç½®äº†å¦‚ä¸‹æ³¨é‡Šï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Function objects and code objects should not be confused with each other:&lt;/p&gt;
&lt;p&gt;Function objects are created by the execution of the 'def' statement. They reference a code object in their &lt;span class="underline"&gt;&lt;span class="underline"&gt;code&lt;/span&gt;&lt;/span&gt; attribute, which is a purely syntactic object, i.e. nothing more than a compiled version of some source code lines. There is one code object per source code "fragment", but each code object can be referenced by zero or many function objects depending only on how many times the 'def' statement in the source was executed so far.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--quoteend--&gt;

&lt;blockquote&gt;
&lt;p&gt;å‡½æ•°å¯¹è±¡å’Œä»£ç å¯¹è±¡ä¸åº”äº’ç›¸æ··æ·†ï¼š&lt;/p&gt;
&lt;p&gt;å‡½æ•°å¯¹è±¡é€šè¿‡æ‰§è¡Œ 'def' è¯­å¥åˆ›å»ºã€‚å®ƒä»¬é€šè¿‡ä»–ä»¬çš„ &lt;span class="underline"&gt;&lt;span class="underline"&gt;code&lt;/span&gt;&lt;/span&gt; å±æ€§å¼•ç”¨ä¸€ä¸ªä»£ç å¯¹è±¡ï¼Œè¿™ä¸ªä»£ç å¯¹è±¡
æ˜¯ä¸€äº›æºä»£ç ç¼–è¯‘åçº¯è¯­æ³•å¯¹è±¡ã€‚æ¯ä¸€ä¸ªä»£ç â€œç‰‡æ®µï¼ˆfragmentï¼‰â€éƒ½å¯¹åº”ä¸€ä¸ªä»£ç å¯¹è±¡ï¼Œ
ä½†æ˜¯æ¯ä¸€ä¸ªä»£ç å¯¹è±¡éƒ½å¯ä»¥è¢«é›¶ä¸ªæˆ–å¤šä¸ªå‡½æ•°å¯¹è±¡å¼•ç”¨ï¼Œå–å†³äºæºç ä¸­çš„ 'def' è¯­å¥ç›®å‰ä¸ºæ­¢è¢«æ‰§è¡Œäº†å¤šå°‘æ¬¡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¤šä¸ªå‡½æ•°å¯¹è±¡å¦‚ä½•é¥®ç”¨ä¸€ä¸ªä»£ç å¯¹è±¡ï¼Ÿè¿™é‡Œæœ‰ä¸ªä¾‹å­ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;make_add_x&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;add_x&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;add_x&lt;/span&gt;

&lt;span class="n"&gt;add_4&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;make_add_x&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;add_5&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;make_add_x&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;make_add_x&lt;/code&gt; å‡½æ•°çš„å­—èŠ‚ç åŒ…å«äº†ä¸€ä¸ª &lt;code&gt;MAKE_FUNCTION&lt;/code&gt; æŒ‡ä»¤ã€‚å‡½æ•° &lt;code&gt;add_4&lt;/code&gt; å’Œ &lt;code&gt;add_5&lt;/code&gt; æ˜¯é€šè¿‡åŒä¸€ä¸ª
ä»£ç å¯¹è±¡ä½œä¸ºå‚æ•°è°ƒç”¨è¿™ä¸ªæŒ‡ä»¤äº§ç”Ÿçš„ç»“æœï¼Œä½†æ˜¯å…¶å‚æ•° &lt;code&gt;x&lt;/code&gt; çš„å€¼ä¸ç›¸åŒã€‚
æ¯ä¸€ä¸ªå‡½æ•°æ‹¥æœ‰è‡ªå·±çš„å˜é‡å•å…ƒçš„æœºåˆ¶å…è®¸æˆ‘ä»¬åˆ›å»ºå¦‚ &lt;code&gt;add_4&lt;/code&gt; å’Œ &lt;code&gt;add_5&lt;/code&gt; çš„é—­åŒ…å‡½æ•°ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç»§ç»­ä¸‹ä¸€ä¸ªä¸»é¢˜ä¹‹å‰æ¨èä½ çœ‹ä¸€ä¸‹å®šä¹‰å‡½æ•°å¯¹è±¡çš„ä»£ç ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;struct&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nc"&gt;PyCodeObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject_HEAD&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;co_argcount&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="cm"&gt;/* #arguments, except *args */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;co_posonlyargcount&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="cm"&gt;/* #positional only arguments */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;co_kwonlyargcount&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="cm"&gt;/* #keyword only arguments */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;co_nlocals&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="cm"&gt;/* #local variables */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;co_stacksize&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="cm"&gt;/* #entries needed for evaluation stack */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;co_flags&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="cm"&gt;/* CO_..., see below */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;co_firstlineno&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="cm"&gt;/* first source line number */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;co_code&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="cm"&gt;/* instruction opcodes */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;co_consts&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="cm"&gt;/* list (constants used) */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;co_names&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="cm"&gt;/* list of strings (names used) */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;co_varnames&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="cm"&gt;/* tuple of strings (local variable names) */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;co_freevars&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="cm"&gt;/* tuple of strings (free variable names) */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;co_cellvars&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="cm"&gt;/* tuple of strings (cell variable names) */&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;Py_ssize_t&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;co_cell2arg&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="cm"&gt;/* Maps cell vars which are arguments. */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;co_filename&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="cm"&gt;/* unicode (where it was loaded from) */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;co_name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="cm"&gt;/* unicode (name, for reference) */&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="cm"&gt;/* ... more members ... */&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;typedef&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;struct&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject_HEAD&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;func_code&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="cm"&gt;/* A code object, the __code__ attribute */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;func_globals&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="cm"&gt;/* A dictionary (other mappings won&amp;#39;t do) */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;func_defaults&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="cm"&gt;/* NULL or a tuple */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;func_kwdefaults&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="cm"&gt;/* NULL or a dict */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;func_closure&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="cm"&gt;/* NULL or a tuple of cell objects */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;func_doc&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="cm"&gt;/* The __doc__ attribute, can be anything */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;func_name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="cm"&gt;/* The __name__ attribute, a string object */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;func_dict&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="cm"&gt;/* The __dict__ attribute, a dict or NULL */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;func_weakreflist&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="cm"&gt;/* List of weak references */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;func_module&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="cm"&gt;/* The __module__ attribute, can be anything */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;func_annotations&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="cm"&gt;/* Annotations, a dict or NULL */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;func_qualname&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="cm"&gt;/* The qualified name */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;vectorcallfunc&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;vectorcall&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PyFunctionObject&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4 id="å¸§å¯¹è±¡-frame-object"&gt;å¸§å¯¹è±¡ï¼ˆframe objectï¼‰&lt;/h4&gt;
&lt;p&gt;å½“æ‰§è¡Œä¸€ä¸ªä»£ç å¯¹è±¡æ—¶ï¼ŒVM éœ€è¦ä¸€ç›´è·Ÿè¸ªå˜é‡çš„å€¼å¹¶ä¸æ–­çš„æ›´æ–°å€¼æ ˆï¼ˆvalue stackï¼‰ã€‚
åŒæ—¶è¿˜éœ€è¦è®°ä½åœ¨ä»€ä¹ˆåœ°æ–¹åœæ­¢è¿è¡Œå½“å‰ä»£ç å¯¹è±¡ç„¶åå»è¿è¡Œå…¶ä»–çš„ä»£ç å¯¹è±¡ï¼Œå¹¶ä¸”åœ¨å“ªé‡Œè¿”å›ã€‚
CPython åœ¨ä¸€ä¸ªå¸§å¯¹è±¡é‡Œå­˜å‚¨è¿™äº›ä¿¡æ¯ï¼Œæˆ–è€…ç®€å•çš„è¯´æˆå¸§ã€‚ä¸€ä¸ªå¸§æä¾›äº†ä¸€ä¸ªå“ªä¸ªä»£ç å¯¹è±¡å¯ä»¥è¢«æ‰§è¡Œçš„çŠ¶æ€ã€‚
ç”±äºæˆ‘ä»¬å·²ç»å¼€å§‹ä¹ æƒ¯æºä»£ç ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘è´´å‡ºå¸§å¯¹è±¡çš„å®šä¹‰ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;struct&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nc"&gt;_frame&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject_VAR_HEAD&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;struct&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nc"&gt;_frame&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;f_back&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="cm"&gt;/* previous frame, or NULL */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyCodeObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;f_code&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="cm"&gt;/* code segment */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;f_builtins&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="cm"&gt;/* builtin symbol table (PyDictObject) */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;f_globals&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="cm"&gt;/* global symbol table (PyDictObject) */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;f_locals&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="cm"&gt;/* local symbol table (any mapping) */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;f_valuestack&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="cm"&gt;/* points after the last local */&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;f_stacktop&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="cm"&gt;/* Next free slot in f_valuestack.  ... */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;f_trace&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="cm"&gt;/* Trace function */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kt"&gt;char&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f_trace_lines&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="cm"&gt;/* Emit per-line trace events? */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kt"&gt;char&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f_trace_opcodes&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="cm"&gt;/* Emit per-opcode trace events? */&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="cm"&gt;/* Borrowed reference to a generator, or NULL */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;f_gen&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f_lasti&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="cm"&gt;/* Last instruction if called */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="cm"&gt;/* ... */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f_lineno&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="cm"&gt;/* Current line number */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f_iblock&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="cm"&gt;/* index in f_blockstack */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kt"&gt;char&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f_executing&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="cm"&gt;/* whether the frame is still executing */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyTryBlock&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f_blockstack&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;CO_MAXBLOCKS&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="cm"&gt;/* for try and loop blocks */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;PyObject&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;f_localsplus&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="cm"&gt;/* locals+stack, dynamically sized */&lt;/span&gt;
&lt;span class="p"&gt;};&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç¬¬ä¸€ä¸ªå¸§è¢«åˆ›å»ºç”¨æ¥æ‰§è¡Œæ¨¡å—çš„ä»£ç å¯¹è±¡ã€‚ä»»ä½•æ—¶å€™éœ€è¦æ‰§è¡Œå¦å¤–ä¸€ä¸ªä»£ç å¯¹è±¡ CPython éƒ½ä¼šåˆ›å»ºåˆ›å»ºæ–°çš„
å¸§å»æ‰§è¡Œè¯¥ä»£ç å¯¹è±¡ã€‚æ¯ä¸€ä¸ªå¸§éƒ½æœ‰ä¸€ä¸ªå¼•ç”¨æŒ‡å‘å‰ä¸€ä¸ªå¸§ã€‚ä»è€Œï¼Œå¸§å½¢æˆäº†ä¸€ä¸ªæ ˆè¢«ç§°ä¸ºè°ƒç”¨æ ˆï¼Œå½“å‰å¸§ä½äº
é¡¶éƒ¨ã€‚å½“ä¸€ä¸ªå‡½æ•°è¢«è°ƒç”¨ï¼Œä¸€ä¸ªæ–°çš„å¸§è¢«å‹åˆ°æ ˆä¸Šã€‚å½“ä»å½“å‰æ‰§è¡Œå¸§è¿”å›æ—¶ï¼ŒCPython é€šè¿‡è®°å½•çš„æœ€åå¤„ç†çš„æŒ‡ä»¤
æ¥ç»§ç»­æ‰§è¡Œå‰ä¸€ä¸ªå¸§ã€‚æŸç§æ„ä¹‰ä¸Š CPython é™¤äº†æ‰§è¡Œå¸§å…¶ä»–ä»€ä¹ˆä¹Ÿæ²¡åšã€‚ä½†æ˜¯æ¥ä¸‹æ¥æˆ‘ä»¬é©¬ä¸Šçœ‹åˆ°è¿™ä¸ªæ€»ç»“
å–„æ„çš„éšè—äº†æŸäº›ç»†èŠ‚ã€‚&lt;/p&gt;
&lt;h3 id="çº¿ç¨‹-è§£é‡Šå™¨-è¿è¡Œæ—¶-threads-interpreters-runtime"&gt;çº¿ç¨‹ã€è§£é‡Šå™¨ã€è¿è¡Œæ—¶ï¼ˆThreads, interpreters, runtimeï¼‰&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬å·²ç»è®¨è®ºè¿‡ä¸‰ä¸ªé‡è¦çš„ä¸»é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä»£ç å¯¹è±¡&lt;/li&gt;
&lt;li&gt;å‡½æ•°å¯¹è±¡ï¼Œå’Œ&lt;/li&gt;
&lt;li&gt;å¸§å¯¹è±¡&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;CPython è¿˜æœ‰ä¸‰ä¸ªé‡è¦çš„ä¸»é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;çº¿ç¨‹çŠ¶æ€ï¼ˆthread stageï¼‰&lt;/li&gt;
&lt;li&gt;è§£é‡Šå™¨çŠ¶æ€ï¼ˆinterpreter stateï¼‰ï¼Œå’Œ&lt;/li&gt;
&lt;li&gt;è¿è¡Œæ—¶çŠ¶æ€ï¼ˆruntime stateï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id="çº¿ç¨‹çŠ¶æ€"&gt;çº¿ç¨‹çŠ¶æ€&lt;/h4&gt;
&lt;p&gt;çº¿ç¨‹çŠ¶æ€æ˜¯ä¸€ä¸ªåŒ…å«çº¿ç¨‹ç‰¹å®šæ•°æ®æ ˆæ•°æ®ç»“æ„ï¼Œå…¶ä¸­åŒ…å«è°ƒç”¨æ ˆã€å¼‚å¸¸çŠ¶æ€å’Œè°ƒè¯•è®¾ç½®ã€‚
ä¸åº”å°†å…¶å’Œç³»ç»Ÿçº¿ç¨‹ï¼ˆOS threadï¼‰æ··æ·†ï¼Œå°½ç®¡å®ƒä»¬è”ç³»ç´§å¯†ã€‚è€ƒè™‘å½“æ—¶ä½¿ç”¨æ ‡å‡†åº“ &lt;code&gt;threading&lt;/code&gt;
åœ¨ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹è¿è¡Œä¸€ä¸ªå‡½æ•°å‘ç”Ÿäº†ä»€ä¹ˆï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;threading&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Thread&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;f&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;Perform an I/O-bound task&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;pass&lt;/span&gt;

&lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;t.start&lt;/code&gt; å®é™…ä¸Šåˆ›å»ºé€šè¿‡ç³»ç»Ÿè°ƒç”¨ï¼ˆç±» Unix ç³»ç»Ÿä¸­é€šè¿‡ &lt;code&gt;pthread_create&lt;/code&gt; ï¼ŒWindows é€šè¿‡
 &lt;code&gt;_beginthreadex&lt;/code&gt; ï¼‰äº†ä¸€ä¸ªæ–°çš„ç³»ç»Ÿçº¿ç¨‹ã€‚æ–°å»ºçš„çº¿ç¨‹è°ƒç”¨åœ¨ &lt;code&gt;_thread&lt;/code&gt; æ¨¡å—ä¸­çš„å‡½æ•°è´Ÿè´£è°ƒ
ç”¨ç›¸åº”çš„ç›®æ ‡å‡½æ•°ã€‚è¿™ä¸ªå‡½æ•°ä¸ä»…ä»…æ¥æ”¶ç›®æ ‡å‡½æ•°å’Œç›®æ ‡å‡½æ•°çš„å‚æ•°ï¼ŒåŒæ—¶ä¸€ä¸ªæ–°çš„çº¿ç¨‹çŠ¶æ€
è¢«ç”¨åœ¨äº†æ–°å»ºçš„ç³»ç»Ÿçº¿ç¨‹ä¸Šã€‚ç³»ç»Ÿçº¿ç¨‹é€šè¿‡å®ƒè‡ªå·±çš„çº¿ç¨‹çŠ¶æ€è¿›å…¥æ‰§è¡Œå¾ªç¯ï¼Œå¹¶ä¸€ç›´æŒæœ‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæˆ‘ä»¬å¯èƒ½è®°å¾—é˜»æ­¢å¤šçº¿ç¨‹åŒæ—¶é™·å…¥æ‰§è¡Œå¾ªç¯çš„è‘—åçš„ GILï¼ˆGlobal Interpreter Lockï¼‰ã€‚
ä¸»è¦åŸå› æ˜¯ä¸ºäº†åœ¨ä¸å¼•å…¥æ›´å¤šç»†ç²’åº¦çš„é”çš„æƒ…å†µä¸‹ä¿æŠ¤ CPython çŠ¶æ€å…å—æŸåã€‚
&lt;a href="https://docs.python.org/zh-cn/3.9/c-api/init.html#thread-state-and-the-global-interpreter-lock"&gt;Python C/API å‚è€ƒ&lt;/a&gt;æ¸…æ™°çš„è§£é‡Šäº† GILï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;The Python interpreter is not fully thread-safe. In order to support multi-threaded Python programs, thereâ€™s a global lock, called the global interpreter lock or GIL, that must be held by the current thread before it can safely access Python objects. Without the lock, even the simplest operations could cause problems in a multi-threaded program: for example, when two threads simultaneously increment the reference count of the same object, the reference count could end up being incremented only once instead of twice.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--quoteend--&gt;

&lt;blockquote&gt;
&lt;p&gt;Python è§£é‡Šå™¨ä¸æ˜¯å®Œå…¨çš„çº¿ç¨‹å®‰å…¨ã€‚ä¸ºäº†æ”¯æŒ Python å¤šçº¿ç¨‹ç¨‹åºï¼Œå¼•å…¥ä¸€ä¸ªç§°ä¸ºå…¨å±€è§£é‡Šå™¨é”æˆ–è€… GIL çš„å…¨å±€é”ï¼Œ
å½“å‰çº¿ç¨‹å¿…é¡»æŒæœ‰è¯¥é”æ‰èƒ½å®‰å…¨çš„è®¿é—® Python å¯¹è±¡ã€‚å¦‚æœæ²¡æœ‰æŒæœ‰è¯¥é”ï¼Œå°±è¿æœ€ç®€å•çš„æ“ä½œéƒ½ä¼šåœ¨å¤šçº¿ç¨‹ç¨‹åºä¸­å¼•å‘
é—®é¢˜ï¼šæ¯”å¦‚ï¼Œå½“ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶å¢åŠ åŒä¸€ä¸ªå¯¹è±¡çš„å¼•ç”¨è®¡æ•°ï¼Œå¼•ç”¨è®¡æ•°æœ€ç»ˆå¯èƒ½åªè¢«å¢åŠ äº†ä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¦ç®¡ç†å¤šçº¿ç¨‹ï¼Œå°±éœ€è¦ä¸€ä¸ªæ¯”çº¿ç¨‹çŠ¶æ€æ›´é«˜å±‚çº§çš„æ•°æ®ç»“æ„ã€‚&lt;/p&gt;
&lt;h4 id="è§£é‡Šå™¨çŠ¶æ€å’Œè¿è¡Œæ—¶çŠ¶æ€-interpreter-and-runtime-states"&gt;è§£é‡Šå™¨çŠ¶æ€å’Œè¿è¡Œæ—¶çŠ¶æ€ï¼ˆinterpreter and runtime statesï¼‰&lt;/h4&gt;
&lt;p&gt;å®é™…ä¸Šï¼Œè¿™æ˜¯ä¸¤ä¸ªçŠ¶æ€ï¼šè§£é‡Šå™¨çŠ¶æ€å’Œè¿è¡Œæ—¶çŠ¶æ€ã€‚ä¸¤è€…çš„éœ€æ±‚åŒºåˆ†çœ‹èµ·æ¥ä¼¼ä¹ä¸æ˜æ˜¾ã€‚ä½†æ˜¯ï¼Œä»»ä½•ç¨‹åº
çš„æ‰§è¡Œéƒ½éœ€è¦å„ä¸ªçŠ¶æ€çš„æœ€å°‘ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶ä¸”æœ‰åˆç†çš„åŸå› ã€‚&lt;/p&gt;
&lt;p&gt;è§£é‡Šå™¨çŠ¶æ€æ˜¯ä¸€ç»„çº¿ç¨‹ä»¥åŠè¯¥ç»„ç›¸å…³çš„æ•°æ®ã€‚çº¿ç¨‹å…±äº«è¯¸å¦‚åŠ è½½çš„æ¨¡å—ï¼ˆsys.modulesï¼‰ã€å†…å»ºå¯¹è±¡ï¼ˆbuiltins.__dict__ï¼‰
å’Œå¯¼å…¥ç³»ç»Ÿï¼ˆimportlibï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¿è¡Œæ—¶çŠ¶æ€æ˜¯ä¸€ä¸ªå…¨å±€å˜é‡ã€‚ä¿å­˜ç€è¿›ç¨‹ç›¸å…³çš„æ•°æ®ã€‚åŒ…å« CPython çŠ¶æ€ï¼ˆæ˜¯å¦åˆå§‹åŒ–ï¼‰å’Œ GILã€‚&lt;/p&gt;
&lt;p&gt;é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸€ä¸ªè¿›ç¨‹çš„æ‰€æœ‰çº¿ç¨‹éƒ½å±äºåŒä¸€ä¸ªè§£é‡Šå™¨ã€‚ä½†æ˜¯ï¼Œæœ‰ä¸€äº›ç½•è§çš„æƒ…å†µæ¯”å¦‚æœ‰äººæƒ³åˆ›å»ºä¸€ä¸ªå­è§£é‡Šå™¨æ¥éš”ç¦»ä¸€ç»„çº¿ç¨‹ã€‚
æ¯”å¦‚ &lt;a href="https://modwsgi.readthedocs.io/en/develop/user-guides/processes-and-threading.html#python-sub-interpreters"&gt;mod_wsgi&lt;/a&gt; ä½¿ç”¨ä¸åŒçš„è§£é‡Šå™¨æ¥è¿è¡Œ WSGI ç¨‹åºã€‚æœ€æ˜æ˜¾çš„éš”ç¦»æ•ˆæœæ˜¯å„ç»„çº¿ç¨‹æ‹¥æœ‰å®ƒä»¬è‡ªå·±ç‰ˆæœ¬çš„æ¨¡å—ï¼ŒåŒ…æ‹¬ &lt;code&gt;__main__&lt;/code&gt; ï¼Œ
ä¹Ÿå°±æ˜¯éš”ç¦»å…¨å±€å‘½åç©ºé—´ï¼ˆglobal namespaceï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;CPython æ²¡æœ‰æä¾›åƒ &lt;code&gt;threading&lt;/code&gt; æ¨¡å—é‚£æ ·ç®€å•çš„æ–¹å¼åˆ›å»ºæ–°çš„è§£é‡Šå™¨ã€‚è¿™ä¸ªç‰¹æ€§ä»…ä»…é€šè¿‡ Python/C API æä¾›æ”¯æŒï¼Œ
ä½†æ˜¯&lt;a href="https://www.python.org/dev/peps/pep-0554/"&gt;æœªæ¥æœ‰å¯èƒ½æ”¹å–„&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h3 id="æ¶æ„æ‘˜è¦-architecture-summary"&gt;æ¶æ„æ‘˜è¦ï¼ˆArchitecture summaryï¼‰&lt;/h3&gt;
&lt;p&gt;è®©æˆ‘ä»¬æ¥å¿«é€Ÿæ€»ç»“ CPython çš„æ¶æ„æ¥çœ‹çœ‹è¿™ä¸€åˆ‡æ˜¯å¦‚ä½•ç»„ç»‡åœ¨ä¸€å—çš„ã€‚è§£é‡Šå™¨å¯ä»¥è¢«çœ‹ä½œåˆ†å±‚ç»“æ„ï¼ˆlayer structureï¼‰ã€‚
è¿™äº›å±‚çº§åŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;è¿è¡Œæ—¶ï¼ˆRuntimeï¼‰ï¼šè¿›ç¨‹çš„å…¨å±€ CPython çŠ¶æ€ï¼›åŒ…å« GIL å’Œå†…å­˜åˆ†é…æœºåˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;è§£é‡Šå™¨ï¼ˆInterpreterï¼‰ï¼šä¸€ç»„çº¿ç¨‹å’Œå®ƒä»¬å…±äº«çš„æ•°æ®ï¼Œå¦‚å¯¼å…¥çš„æ¨¡å—ã€‚&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹ï¼ˆThreadï¼‰ï¼šç‰¹å®šäºå•ä¸ªç³»ç»Ÿçº¿ç¨‹çš„æ•°æ®ï¼›åŒ…å«è°ƒç”¨æ ˆã€‚&lt;/li&gt;
&lt;li&gt;å¸§ï¼ˆFrameï¼‰ï¼šè°ƒç”¨æ ˆçš„å…ƒç´ ï¼›æä¾›æ‰§è¡Œä¸€ä¸ªä»£ç å¯¹è±¡çš„çŠ¶æ€ã€‚&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œå¾ªç¯ï¼ˆEvalution loopï¼‰ï¼šæ‰§è¡Œä¸€ä¸ªä»£ç å¯¹è±¡ï¼ˆæè¿°ä»£ç å—åšäº†ä»€ä¹ˆï¼ŒåŒ…å«å­—èŠ‚ç ã€å˜é‡åå­—ï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æˆ‘ä»¬å·²ç»çœ‹åˆ°ä¸åŒçš„å±‚çº§é€šè¿‡ç›¸åº”çš„æ•°æ®ç»“æ„æ¥è¡¨ç¤ºã€‚åœ¨æŸäº›æƒ…å†µä¸‹å®ƒä»¬å¾ˆéš¾ç­‰æ•ˆã€‚æ¯”å¦‚ï¼Œå†…å­˜åˆ†é…æœºåˆ¶
é€šè¿‡ä½¿ç”¨å…¨å±€å˜é‡æ¥å®ç°ã€‚è¿™ä¸æ˜¯è¿è¡Œæ—¶çŠ¶æ€çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯ç»å¯¹æ˜¯ CPython è¿è¡Œæ—¶å±‚çº§çš„ä¸€éƒ¨åˆ†ã€‚&lt;/p&gt;
&lt;h3 id="æ€»ç»“-conclusion"&gt;æ€»ç»“ï¼ˆConclusionï¼‰&lt;/h3&gt;
&lt;p&gt;åœ¨è¿™ä¸€éƒ¨åˆ†æˆ‘ä»¬å·²ç»å¤§ä½“æè¿°äº† &lt;code&gt;python&lt;/code&gt; åœ¨æ‰§è¡Œä¸€ä¸ª Python ç¨‹åºæ—¶åšäº†ä»€ä¹ˆã€‚æˆ‘ä»¬å·²ç»çœ‹åˆ°å®ƒå·¥ä½œåœ¨ä¸‰ä¸ªçŠ¶æ€ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åˆå§‹åŒ– Python è¿è¡Œæ—¶&lt;/li&gt;
&lt;li&gt;ç¼–è¯‘æºä»£ç åˆ°ä¸€ä¸ªæ¨¡å—ä»£ç å¯¹è±¡ï¼›ç„¶å&lt;/li&gt;
&lt;li&gt;æ‰§è¡Œä»£ç å¯¹è±¡çš„å­—èŠ‚ç ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è§£é‡Šå™¨ä¸­è´Ÿè´£æ‰§è¡Œå­—èŠ‚ç çš„éƒ¨åˆ†ç§°ä¸ºè™šæ‹Ÿæœºï¼ˆVMï¼Œvirtual machineï¼‰ã€‚CPython VM åŒ…å«ä¸€äº›ç‰¹åˆ«é‡è¦çš„æ¦‚å¿µï¼š
ä»£ç å¯¹è±¡ï¼ˆcode objectï¼‰ã€å¸§å¯¹è±¡ï¼ˆframe objectï¼‰ã€çº¿ç¨‹çŠ¶æ€ï¼ˆthread stateï¼‰ã€è§£é‡Šå™¨çŠ¶æ€ï¼ˆinterpreter stateï¼‰å’Œ
è¿è¡Œæ—¶ï¼ˆruntimeï¼‰ã€‚è¿™äº›æ•°æ®ç»“æ„æ„æˆäº† CPython æ¶æ„çš„æ ¸å¿ƒã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è¿˜æœ‰å¾ˆå¤šå†…å®¹æ²¡æœ‰æ¶‰åŠåˆ°ã€‚æˆ‘ä»¬é¿å…é™·å…¥åˆ°æºä»£ç ä¸­ã€‚åˆå§‹åŒ–å’Œç¼–è¯‘é˜¶æ®µå®Œå…¨è¶…å‡ºäº†æˆ‘ä»¬çš„èŒƒå›´ã€‚
ç›¸åï¼Œæˆ‘ä»¬ä»è™šæ‹Ÿæœºçš„æ¦‚è¿°å¼€å§‹ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘è®¤ä¸ºï¼Œæˆ‘ä»¬å¯ä»¥æ›´å¥½çš„çœ‹åˆ°æ¯ä¸ªé˜¶æ®µæ‰€è´Ÿè´£çš„å†…å®¹ã€‚
ç°åœ¨æˆ‘ä»¬çŸ¥é“ CPython å°†æºä»£ç ç¼–è¯‘æˆäº†ä»€ä¹ˆ -- ä»£ç å¯¹è±¡ï¼ˆcode objectï¼‰ã€‚
æ¥ä¸‹æ¥æˆ‘ä»¬å°†çœ‹åˆ°å®ƒæ˜¯å¦‚ä½•åšåˆ°çš„ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æœ‰ä»»ä½•é—®é¢˜ã€è¯„è®ºæˆ–è€…å»ºè®®ï¼Œéšæ—¶é€šè¿‡ victor@tenthousandmeters.com è”ç³»åŸä½œè€…ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;&lt;em&gt;*Update 4 September 2020&lt;/em&gt;&lt;/strong&gt;*: I've made &lt;a href="https://tenthousandmeters.com/materials/python-behind-the-scenes-a-list-of-resources/"&gt;a list of resources&lt;/a&gt; that I've used to learn about CPython internals&lt;/p&gt;
&lt;div class="footnote"&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id="fn:fn:1"&gt;
&lt;p&gt;è¯‘æ³¨ï¼š &lt;code&gt;python -c "import dis;dis.dis('''def g(x): return x + 3''')"&lt;/code&gt;&amp;#160;&lt;a class="footnote-backref" href="#fnref:fn:1" title="Jump back to footnote 1 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content><category term="Python"></category><category term="Python"></category><category term="CPython"></category><category term="VM"></category><category term="æœºåˆ¶"></category></entry><entry><title>ã€è¯‘ã€‘Rust æ„å‘³ç€æ— éœ€æ‰‹åŠ¨å…³é—­ Socket è¿æ¥</title><link href="https://www.linuxzen.com/rust-means-never-having-to-close-a-socket.html" rel="alternate"></link><published>2020-08-27T00:00:00+08:00</published><updated>2020-08-27T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2020-08-27:/rust-means-never-having-to-close-a-socket.html</id><summary type="html">&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šè¿™æ˜¯æˆ‘å­¦ä¹  Rust ç”Ÿå‘½å‘¨æœŸå¯¹æˆ‘æœ€æœ‰å¸®åŠ©çš„æ–‡ç« ä¹‹ä¸€ï¼Œæ•…ç¿»è¯‘äº†ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href="https://blog.skylight.io/rust-means-never-having-to-close-a-socket/"&gt;Rust Means Never Having to Close a Socket&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Rust æœ€é…·çš„ç‰¹æ€§ä¹‹ä¸€ â€¦&lt;/p&gt;</summary><content type="html">&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šè¿™æ˜¯æˆ‘å­¦ä¹  Rust ç”Ÿå‘½å‘¨æœŸå¯¹æˆ‘æœ€æœ‰å¸®åŠ©çš„æ–‡ç« ä¹‹ä¸€ï¼Œæ•…ç¿»è¯‘äº†ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href="https://blog.skylight.io/rust-means-never-having-to-close-a-socket/"&gt;Rust Means Never Having to Close a Socket&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Rust æœ€é…·çš„ç‰¹æ€§ä¹‹ä¸€å°±æ˜¯å®ƒå¯ä»¥è‡ªåŠ¨åœ°å¸®åŠ©ä½ ç®¡ç†èµ„æºï¼ŒåŒæ—¶åœ¨ä»èƒ½ä¿æŒå®‰å…¨ï¼ˆæ²¡æœ‰æ®µé”™è¯¯ï¼‰å’Œé«˜æ€§èƒ½ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯å› ä¸º Rust æ˜¯ä¸€é—¨ä¸ä¼—ä¸åŒåœ°ç¼–ç¨‹è¯­è¨€ï¼Œè¦ç†è§£æˆ‘è¯´çš„å¯èƒ½æœ‰ç‚¹å›°éš¾ï¼Œè®©æˆ‘æ¥æ›´è¿‘ä¸€æ­¥è¯´æ˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Rust å°±åƒå¸¦åƒåœ¾å›æ”¶çš„ç¼–ç¨‹è¯­è¨€ï¼Œä½ æ— éœ€æ‰‹åŠ¨é‡Šæ”¾å†…å­˜&lt;/li&gt;
&lt;li&gt;Rust ä¸åŒäºå…¶ä»–å¸¦åƒåœ¾å›æ”¶çš„ç¼–ç¨‹è¯­è¨€ï¼Œä½ æ— éœ€&lt;sup id="fnref:fn:1"&gt;&lt;a class="footnote-ref" href="#fn:fn:1"&gt;1&lt;/a&gt;&lt;/sup&gt;æ‰‹åŠ¨å…³é—­æˆ–è€…é‡Šæ”¾åƒæ–‡ä»¶ã€å¥—æ¥å­—å’Œé”è¿™æ ·çš„èµ„æº&lt;/li&gt;
&lt;li&gt;Rust è¾¾åˆ°ä»¥ä¸Šè¿™äº›ç‰¹æ€§ä¸é™„å¸¦ä»»ä½•è¿è¡Œæ—¶å¼€é”€ï¼ˆåƒåœ¾å›æ”¶æˆ–è€…å¼•ç”¨è®¡æ•°ï¼‰ï¼Œå¹¶ä¸”ä¸ç‰ºç‰²å®‰å…¨æ€§ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœä½ æ›¾ç»é€ æˆè¿‡ä¸€ä¸ªå¥—æ¥å­—æˆ–è€…æ–‡ä»¶æ³„æ¼ï¼Œæˆ–è€…ä½¿ç”¨è¿‡ä¸€äº›æŠ½è±¡æ–¹æ³•é€ æˆäº†è¿™äº›èµ„æºçš„æ³„æ¼ï¼Œé‚£ä¹ˆä½ å°±ä¼šçŸ¥é“è¿™æœ‰å¤šé‡è¦ã€‚&lt;/p&gt;
&lt;p&gt;ä½ å¯èƒ½å·²ç»æœŸæœ›é€šè¿‡â€œä½¿ç”¨åé‡Šæ”¾â€æ¥é¿å…å†…å­˜é—®é¢˜ï¼Œè€Œä¸æ­¤åŒæ—¶ä½ å¹¶æ²¡æœ‰è€ƒè™‘åˆ°æ²¡æœ‰æ˜ç¡®åœ°å…³é—­å¥—æ¥å­—å¯èƒ½å‡ºç°ç±»ä¼¼çš„é”™è¯¯ã€‚æˆ‘åœ¨è¿™é‡Œå‘Šè¯‰ä½ ï¼Œè¿˜æœ‰æ›´å¥½åœ°åŠæ³•ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ ä½¿ç”¨çš„æ˜¯å¸¦åƒåœ¾å›æ”¶çš„ç¼–ç¨‹è¯­è¨€ï¼Œåˆ™åº”å¯†åˆ‡å…³æ³¨æœ¬æ–‡æåˆ°çš„èµ„æºç®¡ç†æ–¹é¢çš„å†…å®¹ã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯åƒ C/C++ è¿™æ ·åº•å±‚ç¼–ç¨‹è¯­è¨€ï¼Œä½ å¯èƒ½ä¼šå¯¹å®‰å…¨æ–¹é¢æ›´åŠ æ„Ÿå…´è¶£ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Rust çš„è®¸å¤šç‰¹æ€§éƒ½æ˜¯ä»å…¶ä»–è¯­è¨€å€Ÿé‰´è€Œæ¥ã€‚Rust ä¹‹æ‰€ä»¥å˜å¾—æœ‰è¶£æ˜¯å› ä¸ºå®ƒæŠŠæ‰€æœ‰çš„è¿™äº›ç‰¹æ€§æ”¾åœ¨äº†ä¸€èµ·ï¼Œå¹¶ä¸”åœ¨ç¼–ç¨‹è¯­è¨€å±‚é¢å®ç°äº†æ›´ä¸¥æ ¼åœ°ä¿è¯ã€‚
å®é™…ä¸Šï¼Œè¿™ç§ç¼–ç¨‹è¯­è¨€å±‚é¢çš„ä¿è¯è®©è¿™äº›ç‰¹æ€§æ›´åŠ å®ç”¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="æ‰€æœ‰æƒç³»ç»Ÿ-the-ownership-system"&gt;æ‰€æœ‰æƒç³»ç»Ÿï¼ˆThe Ownership Systemï¼‰&lt;/h2&gt;
&lt;p&gt;è®©è¿™ç§ä¿è¯å·¥ä½œçš„æ–¹å¼æ˜¯é€šè¿‡ Rust çš„ã€Œæ‰€æœ‰æƒï¼ˆownershipï¼‰ã€ç³»ç»Ÿã€‚ä¸ç®¡ä»»ä½•æ—¶å€™ä½ åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œéƒ½è¢«åˆ›å»ºå®ƒçš„ã€Œä½œç”¨åŸŸï¼ˆscopeï¼‰ã€æ‰€æ‹¥æœ‰ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥è¿›ä¸€æ­¥è¯´æ˜ï¼šæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œå‡½æ•°æ‹·è´è¾“å…¥æ–‡ä»¶åˆ°ä¸´æ—¶æ–‡ä»¶å»å¤„ç†å®ƒï¼Œç„¶åæ‹·è´è¾“å…¥æ–‡ä»¶åˆ°è¾“å‡ºæ–‡ä»¶ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;process&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;from&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;Path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;Path&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;IoResult&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// creates a new tempdir with the specified suffix&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tempdir&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kr"&gt;try&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;TempDir&lt;/span&gt;::&lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;skylight&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// open the input file&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;from_file&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kr"&gt;try&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;File&lt;/span&gt;::&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;from&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// create a temporary file inside the tempdir&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tempfile&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kr"&gt;try&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;File&lt;/span&gt;::&lt;span class="n"&gt;create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;tempdir&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;tmp1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)));&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// copy the input file into the tempfile&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kr"&gt;try&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;io&lt;/span&gt;::&lt;span class="n"&gt;util&lt;/span&gt;::&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;from_file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tempfile&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// use an external program to process the tmpfile in place&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// after processing, copy the tempfile into the output file&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kr"&gt;try&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;File&lt;/span&gt;::&lt;span class="n"&gt;create&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;io&lt;/span&gt;::&lt;span class="n"&gt;util&lt;/span&gt;::&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tempfile&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå‡½æ•° &lt;code&gt;process&lt;/code&gt; çš„ä½œç”¨åŸŸå†ç¬¬ä¸€è¡Œåˆ›å»ºäº† &lt;code&gt;TempDir&lt;/code&gt; æ˜¯å…¶åˆå§‹æ‹¥æœ‰è€…ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ &lt;code&gt;process&lt;/code&gt; å‡½æ•°ä»æœªæ”¾å¼ƒæ‰€æœ‰æƒï¼Œæ‰€ä»¥å½“å‡½æ•°å®Œæˆè°ƒç”¨ï¼Œ
å®ƒå°±ä¼šè‡ªåŠ¨è¢«ä¸¢å¼ƒï¼ˆdroppedï¼‰ï¼Œä¹Ÿå°±æ˜¯ä¼šåˆ é™¤ &lt;code&gt;Tempfile&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å°±æ˜¯ä¸€ä¸ªå…³äºè‡ªåŠ¨èµ„æºç®¡ç†çš„ä¾‹å­ã€‚ &lt;code&gt;TempDir&lt;/code&gt; å¯¹è±¡ä¸ä»…ä»…æ˜¯ä¸€ç‰‡å†…å­˜ï¼Œå®ƒè¿˜ä»£è¡¨è¢«ç®¡ç†çš„èµ„æºã€‚ä¸€æ—¦ç¨‹åºä¸åœ¨ä½¿ç”¨è¯¥èµ„æºï¼Œé‚£ä¹ˆå®ƒçš„æ¸…ç†é€»è¾‘å°†ä¼šè¢«è°ƒç”¨ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦å¤–ï¼šåœ¨è¿™ C++ ä¸­è¢«ç§°ä¸º ã€ŒRAIIã€ï¼ˆResource Acquistion Is Initializationï¼‰ï¼šèµ„æºè·å–å³åˆå§‹åŒ–ï¼Œå®ƒæ˜¯ç¼–ç¨‹ä¸­æœ€å®¹æ˜“æ··æ·†ä½†æ˜¯æœ‰ç”¨çš„å‘½åã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¯¹æˆ‘æ¥è¯´å¾ˆæœ‰è¶£åœ°æ˜¯ï¼Œèƒ½æœ€å¤§æ•ˆç‡åœ°å‡è½»ç¨‹åºå‘˜æ‰‹åŠ¨ç®¡ç†å†…å­˜çš„æŠ€æœ¯å¾€å¾€ä¹Ÿæœ€éš¾æˆåŠŸå’Œæœ‰æ•ˆåœ°å‡è½»ç¨‹åºå‘˜æ‰‹åŠ¨åœ°ç®¡ç†èµ„æºã€‚
åœ¨é«˜çº§è¯­è¨€ä¸­ï¼Œæˆ‘ä»¬ä»ä¸éœ€è¦é‡Šæ”¾å†…å­˜ï¼Œä½†æ˜¯æˆ‘ä»¬é€šå¸¸éœ€è¦å…³é—­å¥—æ¥å­—ã€æ–‡ä»¶å’Œé‡Šæ”¾é”ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨å®é™…ä¸­ï¼Œåœ¨å¸¦æœ‰åƒåœ¾å›æ”¶æœºåˆ¶çš„ç¼–ç¨‹è¯­è¨€ä¸­æ³„æ¼è¿™äº›èµ„æºçš„æƒ…å†µä»¤äººéœ‡æƒŠï¼Œæ‰€ä»¥æˆ‘çœŸçš„å¾ˆäº«å—è¿™æ ·ä¸€ä¸ªäº‹å®ï¼Œ
åœ¨ Rust ä¸­å¿˜è®°å…³é—­å¥—æ¥å­—ä¸æ˜¯ä¸€ä¸ªå¤§é—®é¢˜ï¼Œå°±åƒåœ¨ Rust å¿˜è®°é‡Šæ”¾å†…å­˜ä¸€æ ·ã€‚å¹¶ä¸”åœ¨ Rust ä¸­ï¼Œ
ä½ å¯ä»¥å…å—é˜²å¾¡æ¶‰åŠèµ„æºçš„â€œé‡Šæ”¾åä½¿ç”¨â€é”™è¯¯ï¼Œå°±åƒä½ å…å—é˜²å¾¡æ¶‰åŠå†…å­˜çš„â€œé‡Šæ”¾åä½¿ç”¨â€é”™è¯¯ä¸€æ ·ã€‚&lt;/p&gt;
&lt;p&gt;è¿™å¬èµ·æ¥å¾ˆç¥å¥‡ï¼Œæ‰€ä»¥ä½ å¯èƒ½ä¼šæœ‰ä¸€äº›é—®é¢˜å…³äºå®ƒå®é™…ä¸Šæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œè¿™ä¸ªç³»ç»ŸåŸºäºäº‹å®ä¸Šä¸€ä¸ªå¯¹è±¡åœ¨åŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªæ‰€æœ‰è€…ã€‚æˆ‘è¯¥å¦‚ä½•ç¡®ä¿æˆ‘æ²¡æœ‰é”™è¯¯åœ°åœ¨å¤šä¸ªåœ°æ–¹å¼•ç”¨ &lt;code&gt;TempDir&lt;/code&gt; ï¼Ÿ
ç­”æ¡ˆæ˜¯æ‰€æœ‰æƒç³»ç»Ÿä¸æ˜¯å»ºè®®æ€§çš„ã€‚åœ¨ Rust ä¸­ï¼Œå¯¹è±¡è¢«åˆ›å»ºå…¶çš„ä½œç”¨åŸŸæ‰€æ‹¥æœ‰ã€‚å®ƒå¯ä»¥å°†æ‰€æœ‰æƒè½¬ç§»åˆ°å…¶ä»–ä½œç”¨åŸŸï¼Œæˆ–è€…åœ¨å®Œæˆæ‰§è¡Œåä¿ç•™æ‰€æœ‰æƒã€‚
å½“ä¸€ä¸ªä½œç”¨åŸŸå®Œæˆæ—¶ï¼ŒRust å°†é”€æ¯å®ƒæ‰€æ‹¥æœ‰åœ°æ‰€æœ‰å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;å› ä¸ºä¸€ä¸ªå¯¹è±¡åŒæ—¶åªèƒ½å½’ä¸€ä¸ªä½œç”¨åŸŸæ‰€æœ‰ï¼Œä½ å¯ä»¥é€šè¿‡æŸ¥çœ‹å°±çŸ¥é“æ‰§è¡Œç»“æŸæ—¶æœ‰å“ªäº›å¯¹è±¡å°†è¢«é”€æ¯ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;Person&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;: &lt;span class="nb"&gt;String&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;last&lt;/span&gt;: &lt;span class="nb"&gt;String&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;hello&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;yehuda&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;: &lt;span class="s"&gt;&amp;quot;Yehuda&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_string&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;last&lt;/span&gt;: &lt;span class="s"&gt;&amp;quot;Katz&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_string&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// `yehuda` is transferred to `name_size`, so it cannot be&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// used anymore in this function, and it will not be destroyed&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// when this function returns. It is up to `name_size`,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// or possibly a future owner, to destroy it.&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;name_size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;yehuda&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;tom&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;: &lt;span class="s"&gt;&amp;quot;Tom&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_string&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;last&lt;/span&gt;: &lt;span class="s"&gt;&amp;quot;Dale&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_string&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// `tom` wasn&amp;#39;t transferred, so it will be&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// destroyed when this function returns.&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;name_size&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;: &lt;span class="nc"&gt;Person&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="nc"&gt;uint&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;last&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;len&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;last&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;len&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// this function owns Person, so the Person is destroyed when `name_size` returns&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä»…ä»…é€šè¿‡é€ä¸€æŸ¥çœ‹è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œä½ å¯ä»¥çœ‹åˆ° &lt;code&gt;yehuda&lt;/code&gt; è¢«è½¬ç§»åˆ°äº† &lt;code&gt;name_size&lt;/code&gt; å‡½æ•°ï¼Œä½†æ˜¯ &lt;code&gt;tom&lt;/code&gt; åˆ™æ²¡æœ‰ã€‚
é€šè¿‡æŸ¥çœ‹ &lt;code&gt;name_size&lt;/code&gt; å‡½æ•°ï¼Œä½ å¯ä»¥çœ‹åˆ°å®ƒä¸€ç›´æ‹¥æœ‰å®ƒçš„ &lt;code&gt;person&lt;/code&gt; å‚æ•°ç›´åˆ°å®ƒè¿”å›ã€‚ä»…ä»…é€šè¿‡æŸ¥çœ‹è¿™ä¸¤ä¸ªå‡½æ•°ï¼Œ
ä½ å°±å¯ä»¥ç›´æ¥ç¡®å®šå“ªä¸ªå¯¹è±¡ï¼ˆå¦‚æœæœ‰ï¼‰å°†ä¼šåœ¨å®ƒä»¬æ‰§è¡Œå®Œæ¯•è¢«é”€æ¯ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å¦‚ä½•è§£é‡Šä¸´æ—¶æ–‡ä»¶çš„ä¾‹å­ï¼Ÿå¦‚æœä½ æŸ¥çœ‹ &lt;code&gt;process&lt;/code&gt; å‡½æ•°çš„ç¬¬ä¸‰è¡Œä»£ç ï¼Œä½ å¯ä»¥çœ‹åˆ° &lt;code&gt;TempDir&lt;/code&gt; ä¸Šçš„æ–¹æ³• &lt;code&gt;tempdir.path()&lt;/code&gt; è¢«è°ƒç”¨ã€‚
éš¾é“è¿™ä¸æ˜¯æ„å‘³ç€æˆ‘åˆ›å»ºäº†ç¬¬äºŒä¸ªå¼•ç”¨ï¼Œå¹¶ä¸”ç†è®ºä¸Šæœ‰ä¸¤ä¸ªæ‰€æœ‰è€…ï¼Ÿæˆ–è€…æ„å‘³ç€æˆ‘ä»¬å°†æ‰€æœ‰æƒè½¬ç§»åˆ°äº† &lt;code&gt;path&lt;/code&gt; æ–¹æ³•ï¼Œä¹Ÿå°±æ˜¯å½“è¯¥æ–¹æ³•è¿”å›æ—¶ä¼šç«‹å³é”€æ¯è¿™ä¸ªç›®å½•ï¼Ÿ
æ˜¾ç„¶è¿™ä¸¤ä¸ªç­”æ¡ˆéƒ½è¡Œä¸é€šã€‚&lt;/p&gt;
&lt;h2 id="å€Ÿç”¨å’Œå€Ÿå‡º-borrowing-and-lending"&gt;å€Ÿç”¨å’Œå€Ÿå‡ºï¼ˆBorrowing and Lendingï¼‰&lt;/h2&gt;
&lt;p&gt;è¦ç†è§£è¿™é‡Œå‘ç”Ÿäº†ä»€ä¹ˆï¼Œæˆ‘ä»¬éœ€è¦çœ‹ä¸€ä¸‹ &lt;code&gt;path&lt;/code&gt; æ–¹æ³•çš„æ–¹æ³•ç­¾åã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;Path&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼å¿µå‡ºè¿™ä¸ªæ–¹æ³•ç­¾åï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;path æ–¹æ³•ã€Œå€Ÿç”¨ï¼ˆborrowsï¼‰ã€self å¹¶è¿”å›ã€Œå€Ÿç”¨çš„ï¼ˆborrowedï¼‰ã€Pathã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä¸€ä¸ªå‡½æ•°å€Ÿç”¨ä¸€ä¸ªå¯¹è±¡å¹¶ä¸ä¼šå–çš„å¯¹è±¡çš„æ‰€æœ‰æƒï¼Œå¹¶ä¸”åœ¨è¿”å›æ—¶ä¸ä¼šé”€æ¯è¯¥å¯¹è±¡ã€‚å®ƒåªèƒ½åœ¨å‡½æ•°è°ƒç”¨æœŸé—´ä½¿ç”¨å€Ÿç”¨çš„å¯¹è±¡ï¼Œå®ƒä¸èƒ½ï¼Œæ¯”å¦‚ï¼Œåˆ›å»ºçº¿ç¨‹å¹¶åœ¨çº¿ç¨‹ä¸­ä½¿ç”¨å€Ÿç”¨çš„å¯¹è±¡ã€‚
æ¢å¥è¯è¯´ï¼Œå€Ÿç”¨çš„å¯¹è±¡å¿…é¡»ä¸èƒ½åœ¨è¶…å‡ºå€Ÿå‡ºå®ƒçš„å‡½æ•°çš„ä½œç”¨åŸŸå¤–å­˜æ´»ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ„å‘³ç€ Rust ç¼–è¯‘å™¨ä¼šæ£€æŸ¥æ‰€æœ‰å‡½æ•°è°ƒç”¨å¹¶ä¸”åœ¨ç¼–è¯‘æœŸå¾—çŸ¥ä»£ç æ˜¯å¦å°è¯•è·å–æ‰€æœ‰æƒã€‚ä¸€æ—¦ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰æƒè¢«è½¬ç§»ï¼Œé‚£ä¹ˆåŸæ‰€æœ‰è€…ä¼šè¢«æ‹’ç»è®¿é—®è¯¥å¯¹è±¡ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;Person&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;: &lt;span class="nb"&gt;String&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;last&lt;/span&gt;: &lt;span class="nb"&gt;String&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;age&lt;/span&gt;: &lt;span class="nc"&gt;uint&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;hello&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;: &lt;span class="s"&gt;&amp;quot;Yehuda&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_string&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;last&lt;/span&gt;: &lt;span class="s"&gt;&amp;quot;Katz&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_string&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;age&lt;/span&gt;: &lt;span class="mi"&gt;32&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;thirties&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;is_thirties&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="fm"&gt;println!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;{}, thirties: {}&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;thirties&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;// This function tries to take ownership of `Person`; it does not&lt;/span&gt;
&lt;span class="c1"&gt;// ask to borrow it by taking &amp;amp;Person&lt;/span&gt;
&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;is_thirties&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;: &lt;span class="nc"&gt;Person&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;age&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;age&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;40&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœæˆ‘å°è¯•ç¼–è¯‘è¿™æ®µä»£ç ï¼Œæˆ‘ä¼šå¾—åˆ°ä¸‹é¢çš„ç¼–è¯‘é”™è¯¯ï¼ˆç•¥æœ‰åˆ èŠ‚ï¼‰ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;move&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;34&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;40&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;error&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;of&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;moved&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;value&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`person`&lt;/span&gt;
&lt;span class="n"&gt;move&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;println&lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;{}, thirties: {}&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;thirties&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;                                            &lt;/span&gt;&lt;span class="o"&gt;^~&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="o"&gt;~~~~&lt;/span&gt;

&lt;span class="n"&gt;move&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;38&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;note&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`person`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;moved&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;here&lt;/span&gt;
&lt;span class="n"&gt;move&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rs&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;thirties&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;is_thirties&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;                                          &lt;/span&gt;&lt;span class="o"&gt;^~&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="o"&gt;~~~~&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é”™è¯¯çš„æ„æ€æ˜¯ &lt;code&gt;hello&lt;/code&gt; å‡½æ•°çš„ä½œç”¨åŸŸæ˜¯ &lt;code&gt;Person&lt;/code&gt; çš„åˆå§‹æ‰€æœ‰è€…ï¼Œä½†æ˜¯å½“è°ƒç”¨ &lt;code&gt;is_thirties&lt;/code&gt; æ—¶ï¼Œå®ƒæŠŠæ‰€æœ‰æƒè½¬ç§»åˆ°äº† &lt;code&gt;is_thirties&lt;/code&gt; å‡½æ•°çš„ä½œç”¨åŸŸã€‚
ä½œä¸ºæ–°çš„æ‰€æœ‰è€…ï¼Œå½“ &lt;code&gt;is_thirties&lt;/code&gt; è¿”å›ï¼Œå®ƒå°±ä¼šé‡Šæ”¾ &lt;code&gt;Person&lt;/code&gt; å æ®çš„å†…å­˜ã€‚&lt;/p&gt;
&lt;p&gt;ä½œä¸ºæ›¿ä»£ä½ ä¼šæƒ³ä½¿ç”¨ã€Œå€Ÿç”¨å’Œå€Ÿå‡ºã€å†™è¿™ä¸ªç¨‹åºï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;hello&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;: &lt;span class="s"&gt;&amp;quot;Yehuda&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_string&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;last&lt;/span&gt;: &lt;span class="s"&gt;&amp;quot;Katz&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_string&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;age&lt;/span&gt;: &lt;span class="mi"&gt;32&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// lend the person -- don&amp;#39;t transfer ownership&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;thirties&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;is_thirties&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// now this scope still owns the person&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="fm"&gt;println!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;{}, thirties: {}&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;thirties&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;is_thirties&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;Person&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;age&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;age&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;40&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;&lt;em&gt;*ä»æ ¹æœ¬ä¸Šè®²ï¼Œè¿™æ„å‘³ç€ç»è¿‡éªŒè¯åœ°æ‰€æœ‰æƒæ˜¯ä½ å‡½æ•°æ¥å£çš„ä¸€éƒ¨åˆ†ã€‚&lt;/em&gt;&lt;/strong&gt;* Rust å¼€å‘è€…æœ‰æ—¶å°†å…¶ç§°ä¸ºâ€œå€Ÿç”¨æ£€æŸ¥å™¨ï¼ˆborrow checkerï¼‰â€ï¼Œä½†æ˜¯å´æ°å½“å¥½å¤„ã€‚&lt;/p&gt;
&lt;p&gt;å®é™…ä¸Šï¼Œè¿™äº›å¤§éƒ¨åˆ†æ—¶é—´å¯ä»¥æ­£å¸¸å·¥ä½œçš„åŸå› æ˜¯ï¼Œå‡½æ•°è·å¾—å®ƒä»¬å€¼çš„æ–¹å¼æ˜¯é€šè¿‡â€œå€Ÿç”¨ï¼ˆborrowingï¼‰â€ã€‚å®ƒä»¬è·å¾—å€¼ã€é€šè¿‡è¿™äº›å€¼å¤„ç†ä¸€äº›é€»è¾‘ç„¶åè¿”å›ã€‚
é•¿æ—¶é—´ä¿æŒè¯¥å€¼ï¼ˆæ¯”å¦‚é€šè¿‡ä½¿ç”¨çº¿ç¨‹ï¼‰æ—¢ä¸å¸¸è§ï¼Œåˆæ˜¯æ—¶å€™è¯¥è€ƒè™‘ä¸€ä¸‹æ­£åœ¨å‘ç”Ÿçš„ä»€ä¹ˆã€‚&lt;/p&gt;
&lt;p&gt;å½“æˆ‘ä»¬å¼€å§‹ç¼–å†™ä¸€ä¸ªæ–°çš„å‡½æ•°æ—¶åº”è¯¥å€Ÿç”¨æ‰€éœ€å‚æ•°ï¼Œè€Œä¸æ˜¯å°è¯•è·å–å…¶æ‰€æœ‰æƒã€‚ç»è¿‡ä¸€æ®µæ—¶é—´çš„ Rust ç¼–ç¨‹ä¹‹åè¿™å°†ä¸ä¼šå¢åŠ è®¤çŸ¥æˆæœ¬ï¼Œåªæ˜¯é»˜è®¤è¿™æ ·åšã€‚
å¦‚æœç¼–è¯‘å™¨æŠ±æ€¨ï¼ˆéšç€ä½ æŒæ¡è¿™äº›è§„åˆ™å°†å®ƒä»¬å˜æˆä¹ æƒ¯ï¼ˆsecond natureï¼‰è¿™æ ·çš„æƒ…å†µå°†è¶Šæ¥è¶Šå°‘ï¼‰ï¼Œè¿™æ„å‘³ç€ä½ æ­£åœ¨åšå«æœ‰æ½œåœ¨å±é™©åœ°äº‹æƒ…ï¼Œé‚£å°±éœ€è¦ä½ æ€è€ƒä¸€ä¸‹äº†ã€‚&lt;/p&gt;
&lt;h2 id="ä»ä¸€ä¸ªå€Ÿç”¨å¯¹è±¡ä¸­è¿”å›ä¸€ä¸ªå€Ÿç”¨å­—æ®µ-returning-a-borrowed-field-from-a-borrowed-object"&gt;ä»ä¸€ä¸ªå€Ÿç”¨å¯¹è±¡ä¸­è¿”å›ä¸€ä¸ªå€Ÿç”¨å­—æ®µï¼ˆReturning a Borrowed Field from a Borrowed Objectï¼‰&lt;/h2&gt;
&lt;p&gt;åœ¨å‰é¢æˆ‘ä»¬æ£€æŸ¥äº†å¦‚ä¸‹æ–¹æ³•ç­¾åï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;path&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;Path&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™ä¸ªç­¾åå¯èƒ½è®©ä½ å›°æƒ‘ã€‚æˆ‘ä¹‹å‰è¯´è¿‡å½“ä¸€ä¸ªå‡½æ•°å€Ÿç”¨äº†ä¸€ä¸ªå¯¹è±¡ï¼Œå®ƒå¿…é¡»åªèƒ½åœ¨å‡½æ•°è°ƒç”¨æœŸé—´ä½¿ç”¨è¿™ä¸ªå€¼ï¼Œå¹¶ä¸”åœ¨æ­¤ä¹‹åå°±ä¸èƒ½ä½¿ç”¨ã€‚
éš¾é“è¿”å›å¯¹è±¡çš„å…¶ä¸­ä¸€éƒ¨åˆ†æ²¡æœ‰è¿åè¿™ä¸ªè§„åˆ™ï¼Ÿ&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªä¹‹æ‰€ä»¥æ²¡é—®é¢˜æ˜¯å› ä¸º &lt;code&gt;path&lt;/code&gt; çš„è°ƒç”¨è€…æ˜æ˜¾æœ‰æƒä½¿ç”¨ &lt;code&gt;Tempfile&lt;/code&gt; å¹¶é€šè¿‡å‚æ•°å°†ä¹‹å€Ÿç»™ &lt;code&gt;path&lt;/code&gt; ã€‚
åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼ŒRust ç¼–è¯‘å™¨å°†ä¼šä¿è¯è¿”å›çš„ &lt;code&gt;Path&lt;/code&gt; æ²¡æœ‰åœ¨è¶…å‡ºæ‹¥æœ‰ &lt;code&gt;Tempfile&lt;/code&gt; çš„ä½œç”¨åŸŸä¹‹å¤–å­˜æ´»ã€‚&lt;/p&gt;
&lt;p&gt;å®é™…ä¸Šï¼Œè¿™æ„å‘³ç€ä½ å¯ä»¥è¿”å›ä»ä¸Šæ¸¸å€Ÿæ¥çš„å†…å®¹ï¼Œç„¶å Rust å°†å¤„ç†å¥½è·Ÿè¸ªè¯¥å†…å®¹çš„åŸå®¹å™¨ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥ä¸¾ä¾‹è¯´æ˜ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;hello&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kt"&gt;str&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Person&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;: &lt;span class="s"&gt;&amp;quot;Yehuda&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_string&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;last&lt;/span&gt;: &lt;span class="s"&gt;&amp;quot;Katz&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_string&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;age&lt;/span&gt;: &lt;span class="mi"&gt;32&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;first_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;first_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;Person&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="kt"&gt;str&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// as_slice borrows a slice &amp;quot;view&amp;quot; out of a string&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;person&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_slice&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœä½ ä»”ç»†è§‚å¯Ÿï¼Œä½ å¯ä»¥ç«‹å³çœ‹åˆ°é—®é¢˜æ‰€åœ¨ã€‚å‡½æ•° &lt;code&gt;hello&lt;/code&gt; è¯•å›¾è¿”å›ä¸€ä¸ªå€Ÿç”¨çš„ &lt;code&gt;&amp;amp;str&lt;/code&gt; ï¼Œä½†æ˜¯æ‹¥æœ‰åŒ…å«è¢«è¿”å›çš„å­—èŠ‚çš„åŸ &lt;code&gt;Person&lt;/code&gt; çš„æ‰€æœ‰æƒåœ¨ &lt;code&gt;hello&lt;/code&gt; ä¸­ã€‚
ä¸€æ—¦ &lt;code&gt;hello&lt;/code&gt; è¿”å›ï¼Œé‚£ä¹ˆ &lt;code&gt;Person&lt;/code&gt; å°†ä¸å¤å­˜åœ¨ï¼Œå¯¼è‡´å€Ÿç”¨çš„å†…å®¹ï¼ˆå­—ç¬¦ä¸²åˆ‡ç‰‡ï¼‰æŒ‡å‘äº†æ— æ•ˆåœ°åœ°å€ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœè¯•å›¾ç¼–è¯‘è¿™æ®µä»£ç ï¼Œä½ å°†å¾—åˆ°å¦‚ä¸‹æŠ¥é”™ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;move&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;error&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;missing&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lifetime&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;specifier&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;E0106&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;move&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nl"&gt;rs&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fn&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;hello&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nf"&gt;str&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;                        &lt;/span&gt;&lt;span class="o"&gt;^~&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="o"&gt;~~&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™ä¸ªæœ‰ç‚¹æ··ä¹±åœ°é”™è¯¯ä¿¡æ¯è¡¨ç¤ºæˆ‘ä»¬æ­£å°è¯•è¿”å›å€Ÿç”¨çš„å­—èŠ‚ï¼Œä½†æ˜¯å‡½æ•°çš„è°ƒç”¨è€…æ²¡æœ‰å€Ÿç»™æˆ‘ä»¬å€Ÿç”¨å­—èŠ‚çš„æ¥æº &lt;code&gt;Person&lt;/code&gt; ã€‚
Rust æ­£åœ¨å‘æˆ‘ä»¬å¾è¯¢å¦‚æœè¿”å›å€¼ä¸å±äºè°ƒç”¨è€…ä½œç”¨åŸŸé‚£ä¹ˆåº”è¯¥å½’å±äºé‚£ä¸ªã€Œç”Ÿå‘½å‘¨æœŸï¼ˆlifetimeï¼‰ã€ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;é€šå¸¸æƒ…å†µä¸‹ï¼ŒRust ä¼šå°†è¿”å›å€¼çš„ä½œç”¨åŸŸç»‘å®šåˆ°å€Ÿç”¨å‚æ•°çš„ä½œç”¨åŸŸã€‚è¿™åœ¨é‡Œï¼Œæˆ‘ä»¬æ²¡æœ‰å€Ÿç”¨çš„å‚æ•°ï¼Œæ‰€ä»¥ Rust è¦æ±‚æˆ‘ä»¬è¿›è¡Œæ˜¾å¼åœ°å®šä¹‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å®é™…æƒ…å†µä¸‹ï¼Œè¿™è¡¨ç¤ºä¸€ä¸ªå‡½æ•°å¯ä»¥è½»æ¾åœ°é€šè¿‡å€Ÿç”¨çš„æ–¹å¼è¿”å›å€Ÿç”¨å‚æ•°ä¸­çš„å†…å®¹ã€‚å¦åˆ™ï¼Œä½ éœ€è¦ç»™è¯¥è¿”å›å€¼æ‰¾åˆ°ä¸€ä¸ªè°ƒç”¨è€…å¯ä»¥è®¿é—®çš„å­˜å‚¨ä½ç½®ï¼Œ
æˆ–è€…å…‹éš†ï¼ˆcloneï¼‰è¯¥å€¼è®©è°ƒç”¨è€…æ‹¥æœ‰ä¸€ä»½è‡ªå·±çš„æ‹·è´ã€‚&lt;/p&gt;
&lt;h2 id="æ˜“ç”¨æ€§-ergonomics"&gt;æ˜“ç”¨æ€§ï¼ˆErgonomicsï¼‰&lt;/h2&gt;
&lt;p&gt;å’‹ä¸€çœ‹ï¼Œæ‰€æœ‰æƒè¿™äº›æœºåˆ¶è®©äººæ„Ÿè§‰å¾ˆå¤æ‚ï¼Œå¹¶ä¸”çœ‹èµ·æ¥å¯èƒ½ä¼šå¯¹ä½¿ç”¨ Rust çš„æ˜“ç”¨æ€§äº§ç”Ÿé‡å¤§å½±å“ã€‚å¯ä»¥è‚¯å®šçš„æ˜¯ï¼Œä¸€å¼€å§‹ç¡®å®ä¼šæœ‰è¿™ç§æ„Ÿè§‰ã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯æœ‰å‡ ä¸ªå› ç´ ä¼šè®© Rust çš„æ‰€æœ‰æƒå˜å¾—æ¯”è¿œçœ‹ä¸Šå»æ›´åŠ æ˜“ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œå¤§é‡çš„å®é™…ä»£ç é€‚ç”¨äºå€Ÿç”¨/å€Ÿå‡ºæ¨¡å¼ã€‚éšç€æˆ‘å†™äº†è¶Šæ¥è¶Šå¤šçš„ Rust ä»£ç ï¼Œæˆ‘é€æ¸æ„è¯†åˆ°ç”¨ Ruby ç¼–å†™çš„ç¨‹åºéµå¾ªç±»ä¼¼çš„æ¨¡å¼ï¼š
å‡½æ•°åˆ›å»ºä¸€äº›å¯¹è±¡å¹¶å°†å®ƒä»¬ä¼ é€’ç»™å­å‡½æ•°æ‰§è¡ŒæŸäº›ä»»åŠ¡ï¼Œç„¶åå­å‡½æ•°è¿”å›æ–°å€¼ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œè¿™æ˜¯é€’å½’çš„ï¼Œå› æ­¤ä»…å½“å·®å¼‚ï¼ˆåœ¨äºå‡½æ•°è°ƒç”¨æœŸé—´ä½¿ç”¨å‚æ•°ï¼Œä»¥åŠå»¶é•¿å‚æ•°çš„ä½¿ç”¨å‘¨æœŸï¼‰åœ¨ Rust ä¸­è¢«æ˜¾å¼åŒºåˆ†æ—¶ï¼Œå®ƒæ‰èƒ½å˜å¾—æ˜¾è€Œæ˜“è§ã€‚
åªæœ‰é€šè¿‡å‡½æ•°ç­¾åè¿›è¡ŒåŒºåˆ†å’Œå…¨é¢è¦†ç›–ï¼Œå¹¶æ£€æŸ¥é”™è¯¯ï¼Œæˆ‘ä»¬æ‰èƒ½è·å¾— Rust æä¾›çš„ä¿è¯ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç›¸åï¼ŒC++ åªå¯¹éƒ¨åˆ†æƒ…å†µè¿›è¡Œäº†æ˜æ˜¾åœ°åŒºåˆ†ï¼Œå¹¶ä¸”æ²¡æœ‰é”™è¯¯æ£€æŸ¥ã€‚å¸¦æœ‰åƒåœ¾å›æ”¶æœºåˆ¶çš„è¯­è¨€é€šå¸¸ä¼šéšè—â€œè½¬ç§»ï¼ˆtransferredï¼‰â€å’Œâ€œå€Ÿå‡ºï¼ˆlentï¼‰â€å‚æ•°ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¦‚æˆ‘ä¸Šé¢æ‰€è¯´ï¼Œè¿™æ„å‘³ç€ Rust ç¨‹åºå‘˜å¿«é€Ÿå­¦ä¹ å°†å€Ÿç”¨ä½œä¸ºé»˜è®¤è¡Œä¸ºå»ç¼–å†™å‡½æ•°æ¥å‡è½»è®¸å¤šç³»ç»Ÿè®¤çŸ¥è´Ÿæ‹…ã€‚&lt;/p&gt;
&lt;p&gt;å…¶æ¬¡ï¼Œéšç€ä½¿ç”¨ä¸€æ®µæ—¶é—´ Rust ä¹‹åï¼Œå¤§éƒ¨åˆ†äººæ„è¯†åˆ°å€Ÿç”¨æ£€æŸ¥å™¨é”™è¯¯å’Œè­¦å‘Šä»–ä»¬çš„éƒ½æ˜¯çœŸå®åœ°ã€ä¸¥é‡åœ°å’Œæ¯”è¾ƒéš¾ä»¥å‘è§‰çš„é”™è¯¯ã€‚
ä¸€æ®µæ—¶é—´ä»¥åï¼Œå€Ÿç”¨æ£€æŸ¥å™¨è‡ªç„¶åœ°å°†æ‚¨æ¨å…¥ç¼–ç¨‹æ¨¡å¼å¹¶ä¸”å‡å°‘å‡ºç°æ­¤ç±»éš¾ä»¥å‘è§‰åœ°é”™è¯¯çš„å½±å“ã€‚&lt;/p&gt;
&lt;p&gt;å†æ¬¡ï¼Œæˆ‘ä¸ªäººå‘ç°ï¼Œå¯¹æ‰€æœ‰æƒçš„æ¸…æ™°äº†è§£å¯ä»¥å¤§å¤§æé«˜æˆ‘å¯¹ç¨‹åºè¿›è¡Œæ¨ç†åœ°èƒ½åŠ›ï¼ŒåŒæ—¶é¿å…æ„å¤–å¼•å…¥åé¢ä¼šèŠ±è´¹å¤§é‡åœ°æ—¶é—´è·Ÿè¸ªæ’æŸ¥çš„å†…å­˜æ³„æ¼é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;æœ€åï¼Œè‡ªåŠ¨èµ„æºç®¡ç†å…·æœ‰çœŸæ­£åœ°æ˜“ç”¨æ€§ä¼˜åŠ¿ï¼Œæ—¢å¯ä»¥é˜²æ­¢èµ„æºæ³„æ¼ï¼ˆå½“æˆ‘æ‡’æƒ°æ—¶ï¼‰ï¼Œåˆå¯ä»¥é˜²æ­¢é¢å¤–åœ°æ ·æ¿ä»£ç å’Œç¼©è¿›ï¼ˆå½“æˆ‘è°¨æ…æ—¶ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;é™¤ C++ ä¹‹å¤–ï¼Œå¾ˆå°‘ç¨‹åºå‘˜ç»å†è¿‡è‡ªåŠ¨èµ„æºç®¡ç†ä¸ºæ ‡å‡†çš„ç¼–ç¨‹ç¯å¢ƒï¼Œæ‰“å¼€å¤§è„‘çš„â€œblubâ€éƒ¨åˆ†å¹¶è®¤ä¸ºå®ƒæ²¡æœ‰é‚£ä¹ˆå¤§çš„ä½œç”¨æ˜¯éå¸¸éå¸¸å®¹æ˜“çš„ã€‚
Rust æ”¹å˜äº†è¿™ä¸ªé¢†åŸŸä¸­çš„ä¼ ç»Ÿæƒè¡¡ï¼Œæˆ‘å»ºè®®æ‚¨å°†è„‘ä¸­å‘Šè¯‰è‡ªå·±ã€Œæˆ‘ä¸éœ€è¦å®ƒåœ¨ã€Šæˆ‘é€‰æ‹©çš„ç¼–ç¨‹è¯­è¨€ã€‹ï¼Œå®ƒæœ‰å¤šé‡è¦ï¼Ÿ ï¼Ÿã€çš„å°å£°éŸ³æš‚æ—¶å…ˆæ”¾å›å»ã€‚&lt;/p&gt;
&lt;h2 id="å¼•ç”¨è®¡æ•°-å’Œåƒåœ¾å›æ”¶"&gt;å¼•ç”¨è®¡æ•°ï¼ˆå’Œåƒåœ¾å›æ”¶ï¼‰&lt;/h2&gt;
&lt;p&gt;ä½ å¯èƒ½å·²ç»æ³¨æ„åˆ° Rust å·²ç»æœ‰å¼•ç”¨è®¡æ•°æŒ‡é’ˆï¼ˆå¹¶ä¸”è®¡åˆ’æœªæ¥å®ç° GCï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å®ƒæ˜¯å¦‚ä½•åœ¨æ‰€æœ‰æƒç³»ç»Ÿä¸­å·¥ä½œçš„å‘¢ï¼Ÿ&lt;/p&gt;
&lt;p&gt;ä»¥æˆ‘çš„ç»éªŒï¼Œä¸€æ—¦ä¹ æƒ¯äº†æ‰€æœ‰æƒèŒƒå¼ï¼Œä½ ä¼šå¾ˆå°‘æƒ³è¦ä½¿ç”¨ &lt;code&gt;Rc&lt;/code&gt; æŒ‡é’ˆã€‚ä¾‹å¦‚ï¼Œæ•´ä¸ª Cargo ä»£ç åº“ä¸­æ²¡æœ‰ä½¿ç”¨å¼•ç”¨è®¡æ•°æŒ‡é’ˆçš„å®ä¾‹ï¼Œ
åªä½¿ç”¨äº†ä¸€æ¬¡åŸå­è®¡æ•°æŒ‡é’ˆï¼ˆç”¨äºåœ¨å¹¶è¡Œæ„å»ºçš„ä»£ç çš„çº¿ç¨‹ä¹‹é—´å…±äº«é”ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘è®¤ä¸ºè¿™æ˜¯ç”±äºæ‰€æœ‰æƒéå¸¸æ˜ç¡®ï¼Œå¹¶ä¸”åˆ‡å®åœ°æ”¹å–„äº†æœ¬åœ°æ¨ç†ã€‚å¦‚æœä½ æ£€æŸ¥ä»»æ„ä½¿ç”¨æ­£å¸¸ Rust å¼•ç”¨çš„å‡½æ•°ï¼Œ
åˆ™å¯ä»¥è½»æ˜“åœ°çŸ¥é“ä¸€æ—¦å‡½æ•°è¿”å›å“ªäº›å†…å­˜ï¼ˆå’Œèµ„æºï¼‰ä»å°†å­˜æ´»ï¼Œè€Œå“ªäº›ä¸ä¼šã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ ä½¿ç”¨é—­åŒ…ï¼Œ
åˆ™å¯ä»¥ç«‹å³åˆ¤æ–­å®ƒæ˜¯å¦å­˜æ´»äºå½“å‰å‡½æ•°ä½œç”¨åŸŸå¤–ï¼Œå¦‚æœå®ƒç¡®å®å­˜æ´»äºå½“å‰å‡½æ•°ä½œç”¨åŸŸå¤–ï¼Œä½ è¿˜å¯ä»¥çŸ¥é“é—­åŒ…æ‹¥æœ‰å“ªäº›å¯¹è±¡ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä¹Ÿè®¤ä¸ºæ‰€æœ‰æƒå’Œå€Ÿå‡ºæ¦‚å¿µå¯ä»¥å¾ˆå¥½åœ°æ˜ å°„åˆ°å®é™…åœ°ç¼–ç¨‹æ¨¡å¼ã€‚æœ‰ä¸€äº›äº‹æƒ…ä½ ä¸å¯ä»¥åšï¼Œä½†æ˜¯å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œç•¥å¾®è°ƒæ•´ä»£ç ç»“æ„å°±å¯ä»¥é€šè¿‡ç¼–è¯‘ã€‚
ä½œä¸ºäº¤æ¢ï¼Œå†…å­˜å’Œèµ„æºæ³„æ¼éƒ½å¾ˆå°‘å‘ç”Ÿï¼Œå¹¶ä¸”ä»£ç æ¸…æ™°åº¦å¾—åˆ°äº†æé«˜ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä¸æ˜¯è¿™ç§æƒ…å†µï¼Œæˆ‘æ€€ç–‘å³ä½¿æ˜¯ç»éªŒä¸°å¯Œåœ° Rust å¼€å‘äººå‘˜ä¹Ÿä¼šæ›´é¢‘ç¹åœ°ä½¿ç”¨ &lt;code&gt;Rc&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;ç»¼ä¸Šæ‰€è¿°ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œå¼•ç”¨è®¡æ•°ç”šè‡³åƒåœ¾å›æ”¶ä¹Ÿå¯ä»¥æ­£å¸¸çš„åœ¨æ‰€æœ‰æƒç³»ç»Ÿä¸‹å·¥ä½œã€‚ Rust çš„ â€œæ™ºèƒ½æŒ‡é’ˆâ€ ç³»ç»Ÿå…è®¸ &lt;code&gt;Rc&lt;/code&gt; æŒ‡é’ˆåœ¨ç›¸åŒåœ°æ‰€æœ‰æƒå’Œå€Ÿç”¨ç³»ç»Ÿå†…é€æ˜åœ°è¿è¡Œï¼Œ
å¹¶ä¸”å½“å¼•ç”¨è®¡æ•°å‡å°åˆ° 0 æ—¶è¿è¡Œææ„å‡½æ•°ï¼ˆä¼´éšæ˜æ˜¾åœ°æœ¬åœ°æ¨ç†å’Œè¿è¡Œæ—¶æ€§èƒ½ä¸Šçš„æˆæœ¬ï¼‰ã€‚&lt;/p&gt;
&lt;h2 id="å…¶ä»–è¯­è¨€çš„æœºåˆ¶-facilities-in-other-languages"&gt;å…¶ä»–è¯­è¨€çš„æœºåˆ¶ï¼ˆFacilities in Other Languagesï¼‰&lt;/h2&gt;
&lt;p&gt;å¸¦æœ‰åƒåœ¾å›æ”¶æœºåˆ¶çš„è¯­è¨€é€šå¸¸ä¼šæä¾›ä¸€äº›æœºå™¨è¾…åŠ©ç¨‹åºå‘˜æ‰‹åŠ¨ç®¡ç†èµ„æºã€‚åœ¨å¤§éƒ¨åˆ†ç°ä»£ç¼–ç¨‹è¯­è¨€ä¸­ï¼Œä½ ä¸ç”¨æ˜¾å¼çš„è°ƒç”¨ &lt;code&gt;close&lt;/code&gt; ï¼Œ
ä½†æ˜¯ä½ éœ€è¦è°ƒæ•´è¯­è¨€ç»“æ„å°†èµ„æºä¸è¯æ³•ä½œç”¨åŸŸè”ç³»åœ¨ä¸€èµ·ï¼Œç„¶ååœ¨å®Œæˆåè¿›è¡Œé‡Šæ”¾ã€‚&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬è§‚å¯Ÿä¸€äº›ä¾‹å­ï¼Œç„¶åæˆ‘ä¼šè®¨è®ºè¿™äº›æ–¹æ³•çš„ç¼ºç‚¹ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Ruby ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå—æ ‡è¯†ä½ å°†åœ¨æŒ‡å®šçš„ä½œç”¨åŸŸé‡Œä½¿ç”¨èµ„æºã€‚ä¸€æ—¦å—è¿”å›ï¼Œèµ„æºå°†ä¼šè¢«æ¸…ç†ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="no"&gt;File&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/etc/passwd&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;do&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# use the file&lt;/span&gt;
&lt;span class="k"&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åœ¨ Python ä¸­ï¼Œä¸€ä¸ªç‰¹æ®Šçš„è¯­è¨€å…³é”®å­— &lt;code&gt;with&lt;/code&gt; ç”¨æ¥åˆ›å»ºä¸€ä¸ªåè®®è¿›è¡Œèµ„æºè·å–ï¼Œç„¶ååœ¨ä»£ç å—ç»“æŸåé‡Šæ”¾èµ„æºï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/etc/passwd&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
  &lt;span class="c1"&gt;# use the file&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Ruby å’Œ Python éƒ½ä½¿ç”¨äº†é€šè¿‡è°ƒæ•´è¯­è¨€ç»“æ„å’Œåˆ›å»ºæ–°åè®®çš„æ–¹æ³•æŠ½è±¡äº†ç‰¹å®šäºèµ„æºå…³é—­çš„æœºåˆ¶ã€‚ç”¨æˆ·æ°¸è¿œä¸çŸ¥é“å…³é—­ä»€ä¹ˆæ ·å­ï¼Œ
ä½†æ˜¯ä»–ä»¬å¿…é¡»ä½¿ç”¨ç‰¹æ®Šçš„æŠ½è±¡æ¥ç¡®ä¿èµ„æºå…³é—­è¢«è°ƒç”¨ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Go ä¸­ï¼Œ &lt;code&gt;defer&lt;/code&gt; å…³é”®å­—å…è®¸ç¨‹åºå‘˜åœ¨åŸå§‹åˆ›å»ºé€»è¾‘ä¹‹åæä¾›æ¸…ç†é€»è¾‘æ¥ç®¡ç†èµ„æºï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nx"&gt;file&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;error&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;:=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;os&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/etc/passwd&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;err&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;!=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;nil&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;defer&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;file&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c1"&gt;// use the file&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™ç§æ–¹å¼æ¯” &lt;code&gt;try/catch/finally&lt;/code&gt; æœ‰å¥½ä¸€äº›ï¼Œå› ä¸ºå®ƒä¿æŒæ¸…ç†é€»è¾‘ç´§è·Ÿèµ„æºè·å–é€»è¾‘ï¼Œä½†æ˜¯æ²¡æœ‰æŠ½è±¡å…³é—­é€»è¾‘ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€æœ‰è¿™äº›æ–¹æ³•éƒ½æœ‰ä¸€ç³»åˆ—çš„é—®é¢˜ã€‚å†æ¬¡ï¼Œæˆ‘å»ºè®®ä½ è¿œç¦»å¤§è„‘ä¸­çš„å¾ˆå¯èƒ½ä¼šå‘Šè¯‰æ‚¨è¿™äº›é—®é¢˜â€œåœ¨å®è·µä¸­ä¸ä¼šå˜å¾—å¾ˆé‡è¦â€çš„â€œblubâ€ä¸­å¿ƒã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å‘å·²ç»ä½¿ç”¨ä¸­çš„ç»“æ„åé¢æ·»åŠ èµ„æºé‡Šæ”¾é€»è¾‘æ˜¯ä¸å¯èƒ½çš„ï¼Œå› ä¸ºä»–ä»¬çš„ä½¿ç”¨è€…ï¼ˆclientsï¼‰å°†ä¼šä½¿ç”¨æ­£å¸¸çš„å¯¹è±¡åˆ›å»º APIã€‚
    è¿™ä¼šå¯¼è‡´åœ¨æ›´é«˜å±‚å¯¹è±¡ä¸­æŠ½è±¡èµ„æºæ›´åŠ å›°éš¾ï¼Œå› ä¸ºèµ„æºç®¡ç†éœ€è¦æš´æ¼åˆ°å…¬å…± APIã€‚&lt;/li&gt;
&lt;li&gt;åŸºäºå—çš„æ–¹æ³•ï¼ˆRuby å’Œ Pythonï¼Œä¸åŒ…å« Goï¼‰å¼•å…¥å‘å³æ¼‚ç§»ã€‚æ¯æ¬¡ä½ æƒ³è¦ä½¿ç”¨ä¸€ä¸ªèµ„æºï¼Œä½ éƒ½è¢«å¼ºåˆ¶åˆ›å»ºä¸€ä¸ªæ–°çš„ä½œç”¨åŸŸèŒƒå›´ã€‚
    è¿™åœ¨ Rubyï¼ˆæœ‰å¾ˆå¥½çš„å—ï¼‰å’Œ Pythonï¼ˆä½¿ç”¨è¯­è¨€å±‚é¢çš„ç»“æ„ï¼‰ä¸­ç›¸å½“çƒ¦äººï¼Œåœ¨ JavaScript ä¸­è¿˜æœ‰ä¸€ä¸ªä¸¥é‡åœ°é—®é¢˜ï¼Œå³å¼•å…¥æ–°çš„ä½œç”¨åŸŸä¼šé˜»æ­¢ä½ è¿”å›æˆ–è€…æ‘†è„±å½“å‰å¾ªç¯ã€‚&lt;/li&gt;
&lt;li&gt;è¿™äº›æ–¹æ³•ï¼ˆåŒ…å« Go çš„ &lt;code&gt;defer&lt;/code&gt; ï¼‰éœ€è¦ä½ åœ¨ç»™å®šçš„è¯æ³•ä½œç”¨åŸŸå†…ä½¿ç”¨èµ„æºã€‚å½“ä½ æƒ³è¦å°†èµ„æºä¼ é€’ç»™å¤šä¸ªå‡½æ•°æ—¶å°†ä¼šå¼•å‘å°´å°¬ï¼ˆæˆ–ä¸å¯èƒ½çš„ï¼‰ç¼–ç¨‹é£æ ¼ã€‚
    å®é™…ä¸Šï¼Œå®ƒè¿«ä½¿è¯­è¨€ä½¿ç”¨ä¸€ä¸ªä¸åœ°é“çš„åŸºäºä½œç”¨åŸŸçš„æ‰€æœ‰æƒç³»ç»Ÿæ¨¡å‹è¿›è¡Œå¯¹è±¡ç®¡ç†ã€‚&lt;ul&gt;
&lt;li&gt;ä¸€æ—¦ä½ å¼€å§‹ä½¿ç”¨èµ„æºè°ƒç”¨å…¶ä»–å‡½æ•°ï¼Œåˆ™å¯èƒ½æ„å¤–åœ°åˆ›å»ºâ€œé‡Šæ”¾åä½¿ç”¨â€ çš„ bugï¼Œå¦‚å‡½æ•°ç»‘å®šåœ¨èµ„æºä¸Šï¼ˆå¦‚é—­åŒ…ä¸­ï¼‰ï¼Œå¹¶åœ¨è°ƒç”¨è€…å…³é—­èµ„æºåå°è¯•ä½¿ç”¨å®ƒã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Rust ä¸­çš„è‡ªåŠ¨èµ„æºç®¡ç†å¯ç¼“è§£æ‰€æœ‰è¿™äº›é—®é¢˜ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;èµ„æºç®¡ç†å¯¹è±¡å¯ä»¥å®šä¹‰ä¸€ä¸ªææ„å™¨ï¼ˆdestructorï¼‰æŠ½è±¡é‡Šæ”¾é€»è¾‘ã€‚é€šè¿‡æ­£å¸¸åˆ›å»ºä¸€ä¸ªå¯¹è±¡å°±å¯ä»¥è®©ææ„å™¨åœ¨æ­£ç¡®çš„æ—¶é—´è°ƒç”¨ã€‚
    å¯¹è±¡å¯ä»¥åœ¨è¢«ä½¿ç”¨ä¹‹åæ·»åŠ ææ„å‡½æ•°è€Œæ— éœ€ä¿®æ”¹å®¢æˆ·ç«¯ä»£ç ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ³¨æ„ Rust ä¸­çš„ææ„å™¨ä¸åŒäºå¸¦ GC çš„è¯­è¨€ä¸­çš„ææ„å™¨ã€‚å®ƒä»¬æ€»æ˜¯åœ¨å¯¹è±¡ä¸åœ¨è¢«ä½¿ç”¨åæ‰§è¡Œï¼Œå¹¶ä¸”ä¸€å®šä¼šè¢«æ‰§è¡Œï¼Œé™¤äº†è¿è¡Œææ„å™¨æœ¬èº«ä¸é™„å¸¦ä»»ä½•è¿è¡Œæ—¶å¼€é”€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç”±äºèµ„æºç®¡ç†å’Œè‡ªåŠ¨å†…å­˜ç®¡ç†é€šè¿‡ç›¸åŒçš„æ–¹å¼å·¥ä½œï¼Œè¿™å°†æ¶ˆé™¤æ¼äººçš„ç¼©è¿›å¹¶ä¸”ä¸éœ€è¦åŒ…å›´é¢å¤–çš„ä»£ç ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;åœ¨ Rust ä¸­ï¼Œä½ å¯ä»¥åƒä¼ é€’å…¶ä»–ç±»å‹çš„å¯¹è±¡ä¸€æ ·ä¼ é€’èµ„æºã€‚å¦‚æœä½ å°†æ‰€æœ‰æƒè½¬ç§»åˆ°å…¶ä»–ä½œç”¨åŸŸï¼Œèµ„æºå°†ä¼šåœ¨æ–°ä½œç”¨åŸŸå®Œæˆæ—¶è¢«å…³é—­ã€‚
    é™¤æ­¤ä¹‹å¤–ï¼Œå€Ÿç”¨ç³»ç»Ÿå°†è¿˜ä¼šåƒä¿è¯å†…å­˜ä¸€æ ·ä¿è¯èµ„æºä¸å­˜åœ¨â€œé‡Šæ”¾åä½¿ç”¨â€ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç®€è€Œè¨€ä¹‹ï¼Œä½¿ç”¨åŒä¸€ç³»ç»Ÿè¿›è¡Œå†…å­˜å’Œèµ„æºç®¡ç†ç¡®å®æœ‰å¥½å¤„ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä¸ä¼šè¯´ Rust æ‰€æœ‰æƒç³»ç»Ÿåƒåƒåœ¾å›æ”¶ä¸€æ ·ä¸ç”¨è€—è´¹ä»»ä½•å¿ƒåŠ›ã€‚ ä½†æ˜¯ï¼ŒRust å·²ç»åšäº†å¾ˆå¤šéå¸¸èªæ˜çš„äº‹æƒ…æ¥å¼¥è¡¥ï¼Œæ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„åœ¨æŸäº›æƒ…å†µä¸‹çš„æ˜“ç”¨æ€§ç”šè‡³è¶…è¿‡äº†å¸¦åƒåœ¾å›æ”¶æœºåˆ¶çš„è¯­è¨€ã€‚&lt;/p&gt;
&lt;p&gt;ä½œä¸ºäº¤æ¢ï¼Œä½ å°†è·å¾—ä¸€ç§éå¸¸å¿«é€Ÿçš„è¯­è¨€ï¼Œå¹¶ä¸”å¯ä»¥ç»å¯¹å®‰å…¨åœ°ç›´æ¥æ§åˆ¶å†…å­˜ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œå®ƒå¼€å¯äº†ä¸€ä¸ªé«˜çº§è¯­è¨€ç”¨æˆ·éƒ½å¯ä»¥ç¼–å†™ä½çº§ä»£ç çš„æ—¶ä»£ï¼Œè¿™ç¡®å®è®©æˆ‘æ„Ÿåˆ°å…´å¥‹ã€‚åŒæ—¶åœ¨ç¤¾åŒºä¹Ÿå¯ä»¥æ‰¾åˆ°å¾ˆå¤šäººäº’ç›¸å­¦ä¹ ã€‚&lt;/p&gt;
&lt;div class="footnote"&gt;
&lt;hr&gt;
&lt;ol&gt;
&lt;li id="fn:fn:1"&gt;
&lt;p&gt;å½“æˆ‘è¯´â€œæ— éœ€â€ï¼Œæˆ‘çš„æ„æ€æ˜¯ç»å¤§éƒ¨åˆ†éƒ½ä¸éœ€è¦ã€‚åœ¨å¸¦æœ‰åƒåœ¾å›æ”¶çš„è¯­è¨€ä¸­ï¼Œæœ‰æ—¶ä½ æœ€ç»ˆè¿˜æ˜¯ä¼šç›´æ¥ç®¡ç†å†…å­˜ï¼Œ åŒæ ·çš„åœ¨ Rust ä¸­ä½ æœ€ç»ˆè¿˜æ˜¯ä¼šç›´æ¥ç®¡ç†èµ„æºã€‚é‡è¦çš„æ˜¯åœ¨ä¸¤ç§æƒ…å†µä¸‹ï¼Œä¸»è¦çš„ç¼–ç¨‹æ¨¡å‹æ˜¯ç¼–ç¨‹è¯­è¨€æ›¿ä½ ç®¡ç†èµ„æºã€‚&amp;#160;&lt;a class="footnote-backref" href="#fnref:fn:1" title="Jump back to footnote 1 in the text"&gt;&amp;#8617;&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;</content><category term="Rust"></category><category term="Rust"></category><category term="å€Ÿç”¨"></category><category term="æ‰€æœ‰æƒ"></category></entry><entry><title>ã€è¯‘ã€‘Rust å€Ÿç”¨å’Œç”Ÿå‘½å‘¨æœŸ</title><link href="https://www.linuxzen.com/rust-borrow-and-lifetimes.html" rel="alternate"></link><published>2020-08-26T00:00:00+08:00</published><updated>2020-08-26T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2020-08-26:/rust-borrow-and-lifetimes.html</id><summary type="html">&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šè¿™æ˜¯æˆ‘å­¦ä¹  Rust ç”Ÿå‘½å‘¨æœŸå¯¹æˆ‘æœ€æœ‰å¸®åŠ©çš„æ–‡ç« ä¹‹ä¸€ï¼Œæ•…ç¿»è¯‘äº†ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href="http://arthurtw.github.io/2014/11/30/rust-borrow-lifetimes.html"&gt;Rust Borrow and Lifetimes&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;Rust æ˜¯ä¸€é—¨å¤„äºå¾€ 1.0 æ´»è·ƒå¼€ â€¦&lt;/p&gt;</summary><content type="html">&lt;blockquote&gt;
&lt;p&gt;è¯‘è€…æ³¨ï¼šè¿™æ˜¯æˆ‘å­¦ä¹  Rust ç”Ÿå‘½å‘¨æœŸå¯¹æˆ‘æœ€æœ‰å¸®åŠ©çš„æ–‡ç« ä¹‹ä¸€ï¼Œæ•…ç¿»è¯‘äº†ä¸€ä¸‹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŸæ–‡é“¾æ¥ï¼š&lt;a href="http://arthurtw.github.io/2014/11/30/rust-borrow-lifetimes.html"&gt;Rust Borrow and Lifetimes&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;Rust æ˜¯ä¸€é—¨å¤„äºå¾€ 1.0 æ´»è·ƒå¼€å‘çš„æ–°è¯­è¨€ï¼ˆè¯‘æ³¨ï¼š1.0 æ—©å·²å‘å¸ƒï¼Œç›®å‰æœ€æ–°ç¨³å®šç‰ˆæœ¬ &lt;a href="https://github.com/rust-lang/rust/releases/tag/1.42.0"&gt;1.42&lt;/a&gt;ï¼‰ã€‚
æˆ‘å¿…é¡»å†å†™ä¸€ç¯‡å…³äºæˆ‘ä¸ºä»€ä¹ˆè§‰å¾— Rust å¾ˆæ£’çš„æ–°åšå®¢ï¼Œä½†æ˜¯ä»Šå¤©æˆ‘å°†å…³æ³¨åœ¨å®ƒçš„å€Ÿç”¨ï¼ˆborrowï¼‰
å’Œç”Ÿå‘½å‘¨æœŸï¼ˆlifetimesï¼‰ç³»ç»Ÿï¼Œè¿™ä¹Ÿæ˜¯å¸¸å¸¸è®©åŒ…æ‹¬æˆ‘åœ¨å†…çš„ Rust æ–°æ‰‹é™·å…¥å›°å¢ƒçš„åœ°æ–¹ã€‚è¿™ç¯‡æ–‡ç« å‡è®¾
ä½ åŸºæœ¬äº†è§£ Rustï¼Œå¦‚æœè¿˜æ²¡æ¨èä½ å…ˆé˜…è¯»&lt;a href="http://doc.rust-lang.org/guide.html"&gt;æŒ‡å—&lt;/a&gt;å’Œ&lt;a href="http://doc.rust-lang.org/guide-pointers.html"&gt;æŒ‡é’ˆæŒ‡å—&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;h2 id="èµ„æºæ‰€æœ‰æƒå’Œå€Ÿç”¨"&gt;èµ„æºæ‰€æœ‰æƒå’Œå€Ÿç”¨&lt;/h2&gt;
&lt;p&gt;Rust é€šè¿‡ä¸€ä¸ªéš¾ç¼ çš„ï¼ˆsophisticatedï¼‰å€Ÿç”¨ç³»ç»Ÿåœ¨ä¸ç”¨ GC çš„æƒ…å†µä¸‹è¾¾åˆ°å†…å­˜å®‰å…¨ã€‚å¯¹äºä»»ä½•èµ„æº
ï¼ˆæ ˆå†…å­˜ã€å †å†…å­˜ã€æ–‡ä»¶å¥æŸ„ç­‰ï¼‰ï¼Œä»–ä»¬éƒ½å¯¹åº”ä¸€ä¸ªå”¯ä¸€çš„æ‰€æœ‰è€…ï¼ˆownerï¼‰åœ¨éœ€è¦çš„æƒ…å†µä¸‹å¤„ç†èµ„æºå›æ”¶ã€‚
ä½ å¯ä»¥é€šè¿‡ &lt;code&gt;&amp;amp;&lt;/code&gt; æˆ–è€… &lt;code&gt;&amp;amp;mut&lt;/code&gt; åˆ›å»ºä¸€ä¸ªæ–°çš„ç»‘å®šæŒ‡å‘è¯¥èµ„æºï¼Œè¿™è¢«ç§°ä¹‹ä¸ºå€Ÿç”¨æˆ–å¯å˜å€Ÿç”¨ã€‚ç¼–è¯‘å™¨ç¡®ä¿
æ‰€æœ‰çš„æ‰€æœ‰è€…ï¼ˆownersï¼‰å’Œå€Ÿç”¨è€…ï¼ˆborrowersï¼‰è¡Œä¸ºæ­£ç¡®ã€‚&lt;/p&gt;
&lt;h2 id="æ‹·è´å’Œè½¬ç§»-copy-and-move"&gt;æ‹·è´å’Œè½¬ç§»ï¼ˆCopy and moveï¼‰&lt;/h2&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬å¼€å§‹è¿›å…¥å€Ÿç”¨ç³»ç»Ÿä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ Rust å¦‚ä½•å¤„ç†æ‹·è´å’Œè½¬ç§»ã€‚è¿™ä¸ª &lt;a href="https://stackoverflow.com/questions/24253344/is-it-possible-to-make-a-type-only-movable-and-not-copyable/24253573#24253573"&gt;StackOverflow ç­”æ¡ˆ&lt;/a&gt;éå¸¸å€¼å¾—ä¸€è¯»ã€‚
åŸºæœ¬ä¸Šï¼Œåœ¨èµ‹å€¼å’Œå‡½æ•°è°ƒç”¨ä¸Šï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¦‚æœå€¼æ˜¯å¯æ‹·è´çš„ï¼ˆcopyableï¼‰ï¼ˆä»…æ¶‰åŠåŸå§‹ï¼ˆprimitiveï¼‰ç±»å‹ï¼Œä¸æ¶‰åŠå¦‚å†…å­˜æˆ–æ–‡ä»¶å¥æŸ„çš„èµ„æºï¼‰ï¼Œç¼–è¯‘å™¨é»˜è®¤è¿›è¡Œæ‹·è´ã€‚&lt;/li&gt;
&lt;li&gt;å…¶ä»–æƒ…å†µï¼Œç¼–è¯‘å™¨è½¬ç§»ï¼ˆmovesï¼‰æ‰€æœ‰æƒï¼ˆownershipï¼‰å¹¶ä½¿åŸæ¥çš„ç»‘å®šæ— æ•ˆã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç®€è€Œè¨€ä¹‹ï¼ŒPODï¼ˆPlan Old Dataï¼‰ =&amp;gt; æ‹·è´ï¼ŒNon-PODï¼ˆçº¿æ€§ç±»å‹ï¼ˆlinear typesï¼‰ï¼‰=&amp;gt; è½¬ç§»ã€‚&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯ä¸€äº›é¢å¤–çš„æ³¨é‡Šä¾›ä½ å‚è€ƒï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Rust æ‹·è´åƒ Cã€‚æ¯ä¸€ä¸ªæŒ‰å€¼ï¼ˆby-valueï¼‰ä½¿ç”¨ä¸€ä¸ªå€¼éƒ½æ˜¯å­—èŠ‚æ‹·è´ï¼ˆé€šè¿‡ &lt;code&gt;memcpy&lt;/code&gt; æµ…æ‹·è´ï¼‰ï¼Œè€Œä¸æ˜¯è¯­ä¹‰ä¸Šçš„æ‹·è´æˆ–å…‹éš†ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœæƒ³è¦è®©ä¸€ä¸ª POD ç»“æ„ä½“å˜æˆä¸å¯æ‹·è´çš„ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ª &lt;a href="http://doc.rust-lang.org/std/kinds/marker/struct.NoCopy.html"&gt;NoCopy&lt;/a&gt; æ ‡è®°ï¼Œæˆ–è€…å®ç° &lt;a href="http://doc.rust-lang.org/std/ops/trait.Drop.html"&gt;Drop&lt;/a&gt; ç‰¹æ€§ï¼ˆtraitï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è½¬ç§»ä¹‹åï¼Œæ‰€æœ‰æƒå°±è½¬ç§»åˆ°äº†ä¸‹ä¸€ä¸ªæ‰€æœ‰è€…é‚£ã€‚&lt;/p&gt;
&lt;h2 id="èµ„æºå›æ”¶"&gt;èµ„æºå›æ”¶&lt;/h2&gt;
&lt;p&gt;Rust ä¼šåœ¨ä»»ä½•èµ„æºçš„æ‰€æœ‰æƒæ¶ˆå¤±åç«‹åˆ»é‡Šæ”¾è¯¥èµ„æºï¼Œå°±è¿™äº›ï¼Œå½“ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ‰€æœ‰è€…è¶…å‡ºä½œç”¨åŸŸï¼Œæˆ–&lt;/li&gt;
&lt;li&gt;æ­£åœ¨æŒæœ‰çš„æ‰€æœ‰è€…æ”¹å˜ç»‘å®šï¼ˆåŸå§‹ç»‘å®šå˜æˆ voidï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="æ‰€æœ‰è€…å’Œå€Ÿç”¨è€…çš„æƒé™-privileges-å’Œé™åˆ¶"&gt;æ‰€æœ‰è€…å’Œå€Ÿç”¨è€…çš„æƒé™ï¼ˆprivilegesï¼‰å’Œé™åˆ¶&lt;/h2&gt;
&lt;p&gt;è¿™ä¸€èŠ‚åŸºäº &lt;a href="http://doc.rust-lang.org/guide.html"&gt;Rust Guide&lt;/a&gt; åœ¨æƒé™ï¼ˆprivilegesï¼‰ä¸€éƒ¨åˆ†æåˆ°æ‹·è´å’Œè½¬ç§»ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€æœ‰è€…æœ‰ä¸€äº›æƒé™ã€‚å®ƒå¯ä»¥ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ§åˆ¶èµ„æºå›æ”¶ã€‚&lt;/li&gt;
&lt;li&gt;å€Ÿå‡ºèµ„æºï¼Œä¸å¯å˜çš„ï¼ˆå¯å¤šæ¬¡å€Ÿç”¨ï¼‰æˆ–å¯å˜çš„ï¼ˆåªèƒ½ç‹¬å ï¼‰ï¼Œå’Œ&lt;/li&gt;
&lt;li&gt;äº¤å‡ºæ‰€æœ‰æƒï¼ˆé€šè¿‡è½¬ç§»ï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åŒæ—¶æ‰€æœ‰è€…ä¹Ÿå­˜åœ¨ä¸€äº›é™åˆ¶ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ä¸å¯å˜å€Ÿç”¨æœŸé—´ï¼Œæ‰€æœ‰è€…ä¸èƒ½&lt;/p&gt;
&lt;p&gt;a. æ”¹å˜èµ„æºï¼Œæˆ–è€…&lt;/p&gt;
&lt;p&gt;b. ä»¥å¯å˜çš„æ–¹å¼å€Ÿå‡ºèµ„æºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¯å˜å€Ÿç”¨æœŸé—´æ‰€æœ‰è€…ä¸èƒ½&lt;/p&gt;
&lt;p&gt;a. è®¿é—®è¯¥èµ„æºï¼Œæˆ–è€…&lt;/p&gt;
&lt;p&gt;b. å†æ¬¡å€Ÿå‡ºè¯¥èµ„æºã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å€Ÿç”¨è€…åŒæ—¶ä¹Ÿæœ‰ä¸€äº›æƒé™ã€‚é™¤äº†è®¿é—®æˆ–è€…æ›´æ”¹å€Ÿç”¨çš„èµ„æºå¤–ï¼Œå€Ÿç”¨è€…ä¹Ÿå¯ä»¥è¿›ä¸€æ­¥å€Ÿå‡ºï¼ˆshare the borrowï¼‰ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸å¯å˜å€Ÿç”¨è€…å¯ä»¥å€Ÿå‡ºï¼ˆæ‹·è´ï¼‰ä¸å¯å˜å€Ÿç”¨ï¼ˆè¯‘æ³¨ï¼šå†æ¬¡ä»¥ä¸å¯å˜å€Ÿç”¨å€Ÿå‡ºï¼‰&lt;/li&gt;
&lt;li&gt;å¯å˜å€Ÿç”¨è€…å¯ä»¥äº¤å‡ºï¼ˆè½¬ç§»ï¼‰å¯å˜å€Ÿç”¨ã€‚ï¼ˆå¯å˜å¼•ç”¨é»˜è®¤ä½¿ç”¨è½¬ç§»ã€‚ï¼‰&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="ä»£ç ç¤ºä¾‹"&gt;ä»£ç ç¤ºä¾‹&lt;/h2&gt;
&lt;p&gt;å…³äºå€Ÿç”¨æˆ‘ä»¬å·²ç»èŠçš„å¤Ÿå¤šäº†ï¼Œè®©æˆ‘ä»¬ä¸€èµ·æ¥çœ‹ä¸€äº›ä»£ç å§ï¼ˆä½ å¯ä»¥é€šè¿‡ &lt;a href="https://play.rust-lang.org"&gt;https://play.rust-lang.org&lt;/a&gt; è¿è¡Œè¿™äº› Rust ä»£ç ã€‚ï¼‰
åœ¨ä¸‹é¢æ‰€æœ‰çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä¸å¯æ‹·è´çš„ &lt;code&gt;struct Foo&lt;/code&gt; ï¼Œå› ä¸ºå®ƒåŒ…å«äº†ä¸€ä¸ªè£…ç®±ï¼ˆboxedï¼‰ï¼ˆå †åˆ†é…ï¼‰å€¼ã€‚
ä½¿ç”¨ä¸å¯æ‹·è´èµ„æºå¯ä»¥é™åˆ¶ç›¸å…³æ“ä½œï¼Œè®©æˆ‘ä»¬æ›´å¥½çš„å­¦ä¹ ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºæ¯ä¸€ä¸ªä»£ç ç¤ºä¾‹ï¼Œæˆ‘ä»¬è¿˜æä¾›äº†ä¸€ä¸ªâ€œä½œç”¨åŸŸå›¾è¡¨â€ï¼ˆscope chartï¼‰æ¥å±•ç¤ºæ‰€æœ‰è€…å’Œå€Ÿç”¨è€…çš„ä½œç”¨åŸŸã€‚
å›¾è¡¨ç¬¬ä¸€è¡Œçš„å¤§æ‹¬å·å’Œä»£ç ä¸­çš„å¤§æ‹¬å·ä¸€ä¸€å¯¹åº”ã€‚&lt;/p&gt;
&lt;h3 id="æ‰€æœ‰è€…åœ¨å¯å˜å€Ÿç”¨æœŸé—´ä¸èƒ½è®¿é—®èµ„æº"&gt;æ‰€æœ‰è€…åœ¨å¯å˜å€Ÿç”¨æœŸé—´ä¸èƒ½è®¿é—®èµ„æº&lt;/h3&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬å°†ä»£ç ä¸­çš„ &lt;code&gt;println!&lt;/code&gt; è§£é™¤æ³¨é‡Šï¼Œä»£ç å°†ä¸èƒ½ç¼–è¯‘ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;Foo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;: &lt;span class="nb"&gt;Box&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;int&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Foo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;: &lt;span class="nc"&gt;box&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// mutable borrow&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// error: cannot borrow `a.f` as immutable because `a` is also borrowed as mutable&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// println!(&amp;quot;{}&amp;quot;, a.f);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;           { a x * }
   owner a   |_____|
borrower x     |___| x = &amp;amp;mut a
access a.f       |   error
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™è¿åäº†æ‰€æœ‰è€…é™åˆ¶ #2(a)ã€‚å¦‚æœæˆ‘ä»¬å°† &lt;code&gt;let x = &amp;amp;mut a;&lt;/code&gt; åœ¨ä¸€ä¸ªåµŒå¥—çš„ä»£ç å—é‡Œï¼šå€Ÿç”¨
åœ¨ &lt;code&gt;println!&lt;/code&gt; ä¹‹å‰ç»“æŸï¼Œè¿™æ®µä»£ç å°†èƒ½æ­£å¸¸å·¥ä½œï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Foo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;: &lt;span class="nc"&gt;box&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;// mutable borrow&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;// mutable borrow ends here&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="fm"&gt;println!&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;{}&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;           { a { x } * }
   owner a   |_________|
borrower x       |_|     x = &amp;amp;mut a
access a.f           |   OK
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="å€Ÿç”¨è€…å¯ä»¥è½¬ç§»å¯å˜å€Ÿç”¨åˆ°ä¸€ä¸ªæ–°çš„å€Ÿç”¨è€…"&gt;å€Ÿç”¨è€…å¯ä»¥è½¬ç§»å¯å˜å€Ÿç”¨åˆ°ä¸€ä¸ªæ–°çš„å€Ÿç”¨è€…&lt;/h3&gt;
&lt;p&gt;è¿™æ®µä»£ç å±•ç¤ºå€Ÿç”¨è€…çš„æƒé™ #2: å¯å˜å€Ÿç”¨ &lt;code&gt;x&lt;/code&gt; å¯ä»¥å°†æ‰€æœ‰æƒè½¬ç§»å¯å˜å€Ÿç”¨åˆ°ä¸€ä¸ªæ–°çš„å€Ÿç”¨è€… &lt;code&gt;y&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Foo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;: &lt;span class="nc"&gt;box&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// mutable borrow&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// move the mutable borrow to new borrower y&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// error: use of moved value: `x.f`&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// println!(&amp;quot;{}&amp;quot;, x.f);&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;           { a x y * }
   owner a   |_______|
borrower x     |_|     x = &amp;amp;mut a
borrower y       |___| y = x
access x.f         |   error
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è½¬ç§»ä¹‹åï¼ŒåŸå§‹çš„å€Ÿç”¨è€… &lt;code&gt;x&lt;/code&gt; ä¸å†èƒ½è®¿é—®å€Ÿç”¨çš„èµ„æºã€‚&lt;/p&gt;
&lt;h2 id="å€Ÿç”¨ä½œç”¨åŸŸ-borrow-scope"&gt;å€Ÿç”¨ä½œç”¨åŸŸï¼ˆBorrow scopeï¼‰&lt;/h2&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬å¼€å§‹ä¼ é€’å¼•ç”¨ï¼ˆ &lt;code&gt;&amp;amp;&lt;/code&gt; å’Œ =&amp;amp;mut=ï¼‰äº‹æƒ…å°±å¼€å§‹å˜å¾—æœ‰è¶£ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ Rust æ–°æ‰‹ä»¬å¼€å§‹å›°æƒ‘çš„åœ°æ–¹ã€‚&lt;/p&gt;
&lt;h3 id="ç”Ÿå‘½å‘¨æœŸ-lifetime"&gt;ç”Ÿå‘½å‘¨æœŸï¼ˆLifetimeï¼‰&lt;/h3&gt;
&lt;p&gt;åœ¨æ•´ä¸ªå€Ÿç”¨è¿‡ç¨‹ä¸­ï¼ŒçŸ¥é“å€Ÿç”¨è€…çš„å€Ÿç”¨ä»€ä¹ˆæ—¶å€™å¼€å§‹å’Œç»“æŸéå¸¸é‡è¦ã€‚åœ¨&lt;a href="http://doc.rust-lang.org/guide-lifetimes.html"&gt;ç”Ÿå‘½å‘¨æœŸæŒ‡å—&lt;/a&gt;ä¸­æ˜¯è¿™æ ·å®šä¹‰ç”Ÿå‘½å‘¨æœŸçš„ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A lifetime is a static approximation of the span of execution during which the pointer is valid: it always corresponds to some expression or block within the program.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;!--quoteend--&gt;

&lt;blockquote&gt;
&lt;p&gt;ç”Ÿå‘½å‘¨æœŸæ˜¯æŒ‡é’ˆæœ‰æ•ˆèŒƒå›´çš„é™æ€è¿‘ä¼¼å€¼ï¼šå®ƒå§‹ç»ˆå¯¹åº”ç¨‹åºä¸­çš„æŸäº›è¡¨è¾¾å¼æˆ–ä»£ç å—ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç„¶è€Œï¼Œæˆ‘æ›´å–œæ¬¢ä½¿ç”¨ &lt;strong&gt;å€Ÿç”¨ä½œç”¨åŸŸï¼ˆborrow scopeï¼‰&lt;/strong&gt; è¿™ä¸ªæœ¯è¯­å»æè¿°å€Ÿç”¨ç”Ÿæ•ˆçš„ä½œç”¨åŸŸã€‚è¯·æ³¨æ„å®ƒä¸åŒäºä¸Šé¢ç”Ÿå‘½å‘¨æœŸçš„å®šä¹‰ã€‚
ï¼ˆæˆ‘ç¬¬ä¸€æ¬¡è§åˆ°è¿™ä¸ªæœ¯è¯­æ˜¯åœ¨ä¸€ä¸ª Rust &lt;a href="https://github.com/rust-lang/rfcs/pull/431"&gt;RFC è®¨è®º&lt;/a&gt; ä¸­ï¼Œå°½ç®¡æˆ‘çš„å®šä¹‰å¯èƒ½ä¼šæœ‰æ‰€ä¸åŒã€‚ï¼‰æˆ‘ä¼šåœ¨ç¨åç»™å‡ºæˆ‘ä¸ºä»€ä¹ˆé¿å…ä½¿ç”¨ç”Ÿå‘½å‘¨æœŸçš„åŸå› ã€‚
ç°åœ¨æˆ‘ä»¬å…ˆæŠŠç”Ÿå‘½å‘¨æœŸæ”¾åœ¨ä¸€è¾¹ã€‚&lt;/p&gt;
&lt;h3 id="and-borrow"&gt;&amp;amp; = borrow&lt;/h3&gt;
&lt;p&gt;ä¸€äº›å…³äºå€Ÿç”¨çš„äº‹æƒ…ï¼š&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œåªéœ€è¦è®°ä½ &lt;code&gt;&amp;amp;&lt;/code&gt; = å€Ÿç”¨ï¼Œ &lt;code&gt;&amp;amp;mut&lt;/code&gt; = å¯å˜å€Ÿç”¨ã€‚ä»»ä½•åœ°æ–¹ä½ çœ‹åˆ°ä¸€ä¸ª &lt;code&gt;&amp;amp;&lt;/code&gt; ï¼Œé‚£å°±æ˜¯ä¸€ä¸ªå€Ÿç”¨ã€‚&lt;/p&gt;
&lt;p&gt;å…¶æ¬¡ï¼Œå½“ä¸€ä¸ª &lt;code&gt;&amp;amp;&lt;/code&gt; å‡ºç°åœ¨ä»»ä½•ç»“æ„ä½“ä¸­ï¼ˆåœ¨å®ƒçš„å­—æ®µä¸­ï¼‰æˆ–è€…å‡½æ•°/é—­åŒ…ï¼ˆè¿”å›å€¼æˆ–è€…æ•è·çš„å¼•ç”¨ï¼‰ï¼Œç»“æ„ä½“/å‡½æ•°/é—­åŒ…å°±æ˜¯ä¸€ä¸ªå€Ÿç”¨è€…ï¼Œ
å¹¶ä¸”åº”ç”¨æ‰€æœ‰çš„å€Ÿç”¨è§„åˆ™ã€‚&lt;/p&gt;
&lt;p&gt;å†æ¬¡ï¼Œå¯¹äºæ¯ä¸€ä¸ªå€Ÿç”¨ï¼Œéƒ½å­˜åœ¨ä¸€ä¸ªæ‰€æœ‰è€…å’Œä¸€ä¸ªæˆ–å¤šä¸ªå€Ÿç”¨è€…ã€‚&lt;/p&gt;
&lt;h3 id="æ‰©å±•å€Ÿç”¨ä½œç”¨åŸŸ"&gt;æ‰©å±•å€Ÿç”¨ä½œç”¨åŸŸ&lt;/h3&gt;
&lt;p&gt;ä¸€äº›å…³äºå€Ÿç”¨ä½œç”¨åŸŸçš„äº‹æƒ…ï¼š&lt;/p&gt;
&lt;p&gt;é¦–å…ˆï¼Œä¸€ä¸ªå€Ÿç”¨ä½œç”¨åŸŸï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ˜¯ä¸€ä¸ªå€Ÿç”¨ç”Ÿæ•ˆçš„èŒƒå›´ï¼Œå¹¶ä¸”&lt;/li&gt;
&lt;li&gt;ä¸ä¸€å®šæ˜¯å€Ÿç”¨è€…çš„è¯æ³•ä½œç”¨åŸŸï¼Œå› ä¸ºå€Ÿç”¨è€…å¯ä»¥æ‰©å±•å€Ÿç”¨ä½œç”¨åŸŸï¼ˆå‚è§ä¸‹é¢ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…¶æ¬¡ï¼Œå€Ÿç”¨è€…åœ¨èµ‹å€¼æˆ–è€…å‡½æ•°è°ƒç”¨ä¸­å¯ä»¥é€šè¿‡æ‹·è´ï¼ˆä¸å¯å˜å€Ÿç”¨ï¼‰æˆ–è€…è½¬ç§»ï¼ˆå¯å˜å€Ÿç”¨ï¼‰æ‰©å±•å€Ÿç”¨ä½œç”¨åŸŸã€‚
æ¥æ”¶è€…ï¼ˆreceiverï¼‰ï¼ˆå¯ä»¥æ˜¯æ–°çš„ç»‘å®šã€ç»“æ„ä½“ã€å‡½æ•°æˆ–è€…é—­åŒ…ï¼‰å˜æˆæ–°çš„å€Ÿç”¨è€…ã€‚&lt;/p&gt;
&lt;p&gt;å†æ¬¡ï¼Œå€Ÿç”¨ä½œç”¨åŸŸæ˜¯æ‰€æœ‰å€Ÿç”¨è€…ä½œç”¨åŸŸçš„å¹¶é›†ï¼Œå¹¶ä¸”è¢«å€Ÿç”¨çš„èµ„æºå¿…é¡»åœ¨æ•´ä¸ªå€Ÿç”¨ä½œç”¨åŸŸé‡Œæœ‰æ•ˆã€‚&lt;/p&gt;
&lt;h3 id="å€Ÿç”¨å…¬å¼"&gt;å€Ÿç”¨å…¬å¼&lt;/h3&gt;
&lt;p&gt;æ ¹æ®æœ€åä¸€ç‚¹ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€ä¸ªå€Ÿç”¨å…¬å¼ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;èµ„æºä½œç”¨åŸŸ &amp;gt;= å€Ÿç”¨ä½œç”¨åŸŸ = æ‰€æœ‰å€Ÿç”¨è€…ä½œç”¨åŸŸçš„å¹¶é›†ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id="ä»£ç ç¤ºä¾‹"&gt;ä»£ç ç¤ºä¾‹&lt;/h3&gt;
&lt;p&gt;è®©æˆ‘ä»¬çœ‹ä¸€äº›æ‰©å±•ä½œç”¨åŸŸçš„ä»£ç ç¤ºä¾‹ã€‚ç»“æ„ä½“ &lt;code&gt;struct Foo&lt;/code&gt; å’Œå‰é¢çš„ä¸€æ ·ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Foo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;: &lt;span class="nc"&gt;box&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;Foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;// borrow&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;// share the borrow with new borrower y, hence extend the borrow scope&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// error: cannot assign to `a.f` because it is borrowed&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;// a.f = box 1;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;             { a { x y } * }
  resource a   |___________|
  borrower x       |___|     x = &amp;amp;a
  borrower y         |_____| y = x
borrow scope       |=======|
  mutate a.f             |   error
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å³ä½¿å€Ÿç”¨å‘ç”Ÿåœ¨ &lt;code&gt;if&lt;/code&gt; ä»£ç å—ä¹‹å†…å¹¶ä¸”å€Ÿç”¨è€… &lt;code&gt;x&lt;/code&gt; åœ¨ &lt;code&gt;if&lt;/code&gt; ä»£ç å—ä¹‹åè¶…å‡ºä½œç”¨åŸŸï¼Œå®ƒå·²ç»é€šè¿‡èµ‹å€¼ &lt;code&gt;y=x;&lt;/code&gt; æ‰©å±•äº†å€Ÿç”¨ä½œç”¨åŸŸï¼Œ
æ‰€ä»¥å­˜åœ¨ä¸¤ä¸ªå€Ÿç”¨è€…ï¼š &lt;code&gt;x&lt;/code&gt; å’Œ &lt;code&gt;y&lt;/code&gt; ã€‚æ ¹æ®å€Ÿç”¨å…¬å¼ï¼šå€Ÿç”¨ä½œç”¨åŸŸæ˜¯å€Ÿç”¨è€… &lt;code&gt;x&lt;/code&gt; å’Œå€Ÿç”¨è€… &lt;code&gt;y&lt;/code&gt; ä½œç”¨åŸŸçš„å¹¶é›†ï¼š
èŒƒå›´å¼€å§‹ç¬¬ä¸€æ¬¡å€Ÿç”¨äº &lt;code&gt;let x = &amp;amp;a;&lt;/code&gt; ç›´åˆ° &lt;code&gt;main&lt;/code&gt; ä»£ç å—çš„ç»“å°¾ã€‚ï¼ˆæ³¨æ„ç»‘å®š &lt;code&gt;y&lt;/code&gt; åœ¨ &lt;code&gt;y=x;&lt;/code&gt; ä¹‹å‰ä¸æ˜¯å€Ÿç”¨è€…ã€‚ï¼‰&lt;/p&gt;
&lt;p&gt;ä½ å¯èƒ½æ³¨æ„åˆ°äº†ç”±äºæ¡ä»¶æ°¸è¿œæ˜¯ false &lt;code&gt;if&lt;/code&gt; ä»£ç å—æ°¸è¿œä¸ä¼šæ‰§è¡Œï¼Œä½†æ˜¯ç¼–è¯‘å™¨å§‹ç»ˆæ‹’ç»èµ„æºæ‰€æœ‰è€… &lt;code&gt;a&lt;/code&gt; å»è®¿é—®
å®ƒçš„èµ„æºã€‚è¿™æ˜¯å› ä¸ºæ‰€æœ‰çš„å€Ÿç”¨æ£€æŸ¥å‘ç”Ÿåœ¨ç¼–è¯‘æœŸï¼Œè¿™æ ·ç¨‹åºè¿è¡Œæ—¶å°±ä¸éœ€è¦åšä»»ä½•äº‹æƒ…ã€‚&lt;/p&gt;
&lt;h2 id="å€Ÿç”¨å¤šä¸ªèµ„æº"&gt;å€Ÿç”¨å¤šä¸ªèµ„æº&lt;/h2&gt;
&lt;p&gt;ç›®å‰ä¸ºæ­¢æˆ‘ä»¬åªå…³æ³¨å€Ÿç”¨å•ä¸ªèµ„æºã€‚å€Ÿç”¨è€…å¯ä»¥å€Ÿç”¨å¤šä¸ªèµ„æºå—ï¼Ÿå½“ç„¶ï¼æ¯”å¦‚ä¸€ä¸ªå‡½æ•°å¯ä»¥æ¥å—ä¸¤ä¸ªå¼•ç”¨ç„¶å
åŸºäºä¸€äº›æƒ…å†µè¿”å›å…¶ä¸­ä¸€ä¸ªï¼Œe.g. å…¶ä¸­å­—æ®µå€¼æ¯”è¾ƒå¤§çš„é‚£ä¸€ä¸ªã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;Foo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;Foo&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;Foo&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;max&lt;/code&gt; å‡½æ•°è¿”å›ä¸€ä¸ª &lt;code&gt;&amp;amp;&lt;/code&gt; æŒ‡é’ˆï¼Œå› æ­¤å®ƒæ˜¯ä¸€ä¸ªå€Ÿç”¨è€…ã€‚è¿”å›çš„ç»“æœå¯ä»¥æ˜¯è¾“å…¥å‚æ•°çš„ä»»æ„ä¸€ä¸ªï¼Œæ‰€ä»¥å®ƒå€Ÿç”¨äº†
ä¸¤é¥é¢èµ„æºã€‚&lt;/p&gt;
&lt;h3 id="å‘½åå€Ÿç”¨ä½œç”¨åŸŸ-named-borrow-scope"&gt;å‘½åå€Ÿç”¨ä½œç”¨åŸŸï¼ˆNamed borrow scopeï¼‰&lt;/h3&gt;
&lt;p&gt;å½“å­˜åœ¨å¤šä¸ª &lt;code&gt;&amp;amp;&lt;/code&gt; æŒ‡é’ˆä½œä¸ºè¾“å…¥ï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ &lt;strong&gt;å‘½åç”Ÿå‘½å‘¨æœŸï¼ˆnamed lifetimesï¼‰&lt;/strong&gt; æŒ‡å®šå®ƒä»¬ä¹‹é—´çš„å…³ç³»ï¼Œ
å‚è§ &lt;a href="http://doc.rust-lang.org/guide-lifetimes.html#named-lifetimes"&gt;Lifetimes Guide&lt;/a&gt;ã€‚ä½†ç°åœ¨ï¼Œè®©æˆ‘ä»¬å«å®ƒä»¬ &lt;strong&gt;å‘½åå€Ÿç”¨ä½œç”¨åŸŸï¼ˆnamed borrow scopesï¼‰&lt;/strong&gt; ã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šé¢çš„ä»£ç æ²¡æœ‰ä½¿ç”¨ &lt;strong&gt;å‘½åç”Ÿå‘½å‘¨æœŸ&lt;/strong&gt; æŒ‡å®šå®ƒä»¬ä¹‹é—´çš„å…³ç³»æ˜¯ä¸ä¼šé€šè¿‡ç¼–è¯‘å™¨çš„ï¼Œi.e. å“ªäº›å€Ÿç”¨è€… &lt;strong&gt;åˆ†ç»„ï¼ˆgroupedï¼‰&lt;/strong&gt;
åˆ°å“ªä¸ªå€Ÿç”¨ä½œç”¨åŸŸã€‚ä¸‹é¢çš„å®ç°æ˜¯åˆæ³•çš„ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;max&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt; &lt;span class="nc"&gt;Foo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt; &lt;span class="nc"&gt;Foo&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt; &lt;span class="nc"&gt;Foo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kr"&gt;All&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;resources&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kr"&gt;and&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;borrowers&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;are&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;grouped&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kr"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;borrow&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;scope&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;#39;a.)&lt;/span&gt;
&lt;span class="s"&gt;                  max( {   } )&lt;/span&gt;
&lt;span class="s"&gt;    resource *x &amp;lt;--------------&amp;gt;&lt;/span&gt;
&lt;span class="s"&gt;    resource *y &amp;lt;--------------&amp;gt;&lt;/span&gt;
&lt;span class="s"&gt;borrow scope &amp;#39;&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;==============&amp;gt;&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;borrower&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;___&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="n"&gt;borrower&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;___&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="kr"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;___&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;pass&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;caller&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åœ¨è¿™ä¸ªå‡½æ•°ä¸­ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå€Ÿç”¨ä½œç”¨åŸŸ &lt;code&gt;'a&lt;/code&gt; å’Œä¸‰ä¸ªå€Ÿç”¨è€…ï¼šä¸¤ä¸ªè¾“å…¥å‚æ•°å’Œå‡½æ•°è¿”å›ç»“æœã€‚
å‰é¢æåˆ°çš„å€Ÿç”¨å…¬å¼ä¾ç„¶ç”Ÿæ•ˆï¼Œä½†æ˜¯ç°åœ¨æ¯ä¸ªè¢«å€Ÿç”¨çš„èµ„æºå¿…é¡»æ»¡è¶³å…¬å¼ã€‚å‚è§ä¸‹é¢çš„ä¾‹å­ï¼š&lt;/p&gt;
&lt;h3 id="ä»£ç ç¤ºä¾‹"&gt;ä»£ç ç¤ºä¾‹&lt;/h3&gt;
&lt;p&gt;åœ¨æ¥ä¸‹æ¥çš„ä»£ç ä¸­ï¼Œæˆ‘ä»¬æ¥ä½¿ç”¨ä¸Šé¢çš„ &lt;code&gt;max&lt;/code&gt; å‡½æ•°åœ¨ &lt;code&gt;a&lt;/code&gt; å’Œ &lt;code&gt;b&lt;/code&gt; ä¹‹é—´é€‰æ‹©ä¸€ä¸ªæ›´å¤§ &lt;code&gt;Foo&lt;/code&gt; ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Foo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;: &lt;span class="nc"&gt;box&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;Foo&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Foo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;: &lt;span class="nc"&gt;box&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;max&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;// error: `b` does not live long enough&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;// y = x;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;              { a { b x (  ) y } }
   resource a   |________________| pass
   resource b       |__________|   fail
 borrow scope         |==========|
temp borrower            |_|       &amp;amp;a
temp borrower            |_|       &amp;amp;b
   borrower x         |________|   x = max(&amp;amp;a, &amp;amp;b)
   borrower y                |___| y = x
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç›´åˆ° &lt;code&gt;let x = max(&amp;amp;a, &amp;amp;b)&lt;/code&gt; éƒ½ä¸€äº›æ­£å¸¸ï¼Œå› ä¸º &lt;code&gt;&amp;amp;a&lt;/code&gt; å’Œ &lt;code&gt;&amp;amp;b&lt;/code&gt; éƒ½æ˜¯å°½åœ¨è¡¨è¾¾å¼ä¸­æœ‰æ•ˆçš„ä¸´æ—¶å¼•ç”¨ï¼Œ
å¹¶ä¸”ç¬¬ä¸‰ä¸ªå€Ÿç”¨ &lt;code&gt;x&lt;/code&gt; å€Ÿç”¨äº†ä¸¤ä¸ªèµ„æºï¼ˆä¸ç®¡æœ€ç»ˆæ˜¯ &lt;code&gt;a&lt;/code&gt; æˆ– &lt;code&gt;b&lt;/code&gt; ï¼Œå¯¹äºå€Ÿç”¨æ£€æŸ¥å™¨è€Œè¨€å®ƒéƒ½å€Ÿç”¨äº†ï¼‰ç›´åˆ° &lt;code&gt;if&lt;/code&gt;
å—ç»“æŸï¼Œæ‰€ä»¥å€Ÿç”¨ä½œç”¨åŸŸæ˜¯ä» &lt;code&gt;let x = max(&amp;amp;a, &amp;amp;b);&lt;/code&gt; åˆ° &lt;code&gt;if&lt;/code&gt; å—ç»“å°¾ã€‚ä¸¤ä¸ªèµ„æº &lt;code&gt;a&lt;/code&gt; å’Œ &lt;code&gt;b&lt;/code&gt; åœ¨æ•´ä¸ªå€Ÿç”¨ä½œç”¨åŸŸ
éƒ½æœ‰æ•ˆ,å› æ­¤æ»¡è¶³å€Ÿç”¨å…¬å¼ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨å¦‚æœæˆ‘ä»¬è§£é™¤æœ€åä¸€ä¸ªèµ‹å€¼ &lt;code&gt;y = x;&lt;/code&gt; çš„æ³¨é‡Šï¼Œ &lt;code&gt;y&lt;/code&gt; å˜æˆç¬¬å››ä¸ªå€Ÿç”¨è€…ï¼Œç„¶åå€Ÿç”¨ä½œç”¨åŸŸè¢«æ‰©å±•åˆ° &lt;code&gt;main&lt;/code&gt;
å—çš„ç»“å°¾ï¼Œå¯¼è‡´èµ„æº &lt;code&gt;b&lt;/code&gt; ä¸èƒ½æ»¡è¶³å…¬å¼ã€‚&lt;/p&gt;
&lt;h2 id="ç»“æ„ä½“ä½œä¸ºå€Ÿç”¨è€…"&gt;ç»“æ„ä½“ä½œä¸ºå€Ÿç”¨è€…&lt;/h2&gt;
&lt;p&gt;é™¤äº†å‡½æ•°å’Œé—­åŒ…ä¹‹å¤–ï¼Œä¸€ä¸ªç»“æ„ä½“ä¹Ÿå¯ä»¥é€šè¿‡å…¶å­—æ®µå­˜å‚¨å¤šä¸ªå¼•ç”¨æ¥å€Ÿç”¨å¤šä¸ªèµ„æºã€‚æˆ‘ä»¬é€šè¿‡ä¸‹é¢çš„ä¸€äº›ä¾‹å­
æ¥çœ‹çœ‹å€Ÿç”¨å…¬å¼å¦‚ä½•ç”Ÿæ•ˆçš„ã€‚æˆ‘ä»¬æ¥ä½¿ç”¨ &lt;code&gt;Link&lt;/code&gt; ç»“æ„ä½“æ¥ä¿å­˜ä¸€ä¸ªå¼•ç”¨ï¼ˆä¸å¯å˜å€Ÿç”¨ï¼‰ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;struct&lt;/span&gt; &lt;span class="nc"&gt;Link&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;link&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt; &lt;span class="nc"&gt;Foo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="ç»“æ„ä½“å€Ÿç”¨å¤šä¸ªèµ„æº"&gt;ç»“æ„ä½“å€Ÿç”¨å¤šä¸ªèµ„æº&lt;/h3&gt;
&lt;p&gt;å³ä½¿åªæœ‰ä¸€ä¸ªå­—æ®µï¼Œç»“æ„ä½“ &lt;code&gt;Link&lt;/code&gt; ä¹Ÿå¯ä»¥å€Ÿç”¨å¤šä¸ªèµ„æºï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Foo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;: &lt;span class="nc"&gt;box&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Link&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;link&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Foo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;: &lt;span class="nc"&gt;box&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;// error: `b` does not live long enough&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;// x.link = &amp;amp;b;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;             { a x { b * } }
  resource a   |___________| pass
  resource b         |___|   fail
borrow scope     |=========|
  borrower x     |_________| x.link = &amp;amp;a
  borrower x           |___| x.link = &amp;amp;b
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åœ¨ä¸Šé¢ä¾‹å­ä¸­ï¼Œå€Ÿç”¨è€… &lt;code&gt;x&lt;/code&gt; ä»æ‰€æœ‰è€… &lt;code&gt;a&lt;/code&gt; å€Ÿç”¨èµ„æºï¼Œå€Ÿç”¨ä½œç”¨åŸŸåˆ° &lt;code&gt;main&lt;/code&gt; å—çš„ç»“å°¾ã€‚So far so goodã€‚
å¦‚æœæˆ‘ä»¬è§£é™¤æœ€åä¸€ä¸ªèµ‹å€¼ &lt;code&gt;x.link = &amp;amp;b;&lt;/code&gt; çš„æ³¨é‡Šï¼Œ &lt;code&gt;x&lt;/code&gt; ä¹Ÿå°è¯•ä»æ‰€æœ‰è€… &lt;code&gt;b&lt;/code&gt; å€Ÿç”¨èµ„æºï¼Œè¿™ä¼šè®©èµ„æº &lt;code&gt;b&lt;/code&gt;
ä¸èƒ½æ»¡è¶³å€Ÿç”¨å…¬å¼ã€‚&lt;/p&gt;
&lt;h3 id="æ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°æ‰©å±•å€Ÿç”¨ä½œç”¨åŸŸ"&gt;æ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°æ‰©å±•å€Ÿç”¨ä½œç”¨åŸŸ&lt;/h3&gt;
&lt;p&gt;ä¸€ä¸ªæ²¡æœ‰è¿”å›å€¼çš„å‡½æ•°åŒæ ·ä¹Ÿå¯ä»¥é€šè¿‡è¾“å‡ºå‚æ•°èƒ½æ‰©å±•å€Ÿç”¨ä½œç”¨åŸŸã€‚ä¾‹å¦‚ï¼Œè¿™ä¸ªå‡½æ•° &lt;code&gt;store_foo&lt;/code&gt; æ¥å—ä¸€ä¸ª
&lt;code&gt;Link&lt;/code&gt; çš„å¯å˜å¼•ç”¨ï¼Œç„¶åå­˜å‚¨ä¸€ä¸ªå¼•ç”¨ï¼ˆä¸å¯å˜å€Ÿç”¨ï¼‰åˆ° &lt;code&gt;Foo&lt;/code&gt; é‡Œï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;store_foo&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Link&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt; &lt;span class="nc"&gt;Foo&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;link&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åœ¨æ¥ä¸‹æ¥çš„ä»£ç ä¸­ï¼Œè¢« &lt;code&gt;a&lt;/code&gt; æ‰€æœ‰çš„èµ„æºæ˜¯è¢«å€Ÿç”¨èµ„æºï¼› &lt;code&gt;Link&lt;/code&gt; ç»“æ„ä½“è¢«å€Ÿç”¨è€… &lt;code&gt;x&lt;/code&gt; å¯å˜çš„å¼•ç”¨ç€ï¼ˆi.e. &lt;code&gt;*x&lt;/code&gt; æ˜¯å€Ÿç”¨è€…ï¼‰ï¼›
å€Ÿç”¨ä½œç”¨åŸŸç›´åˆ° &lt;code&gt;main&lt;/code&gt; å—çš„ç»“å°¾ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Foo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;: &lt;span class="nc"&gt;box&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&lt;/span&gt;&lt;span class="k"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Link&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;link&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kc"&gt;false&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kd"&gt;let&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Foo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;: &lt;span class="nc"&gt;box&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;};&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;// store_foo(x, &amp;amp;b);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;             { a x { b * } }
  resource a   |___________| pass
  resource b         |___|   fail
borrow scope     |=========|
 borrower *x     |_________| x.link = &amp;amp;a
 borrower *x           |___| x.link = &amp;amp;b
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœæˆ‘ä»¬è§£é™¤æœ€åä¸€ä¸ªå‡½æ•°è°ƒç”¨ &lt;code&gt;store_foo(x, &amp;amp;b);&lt;/code&gt; ,è¿™ä¸ªå‡½æ•°å°†ä¼šå°è¯•å°† &lt;code&gt;&amp;amp;b&lt;/code&gt; å­˜å‚¨åˆ° &lt;code&gt;x.link&lt;/code&gt; ï¼Œ
å°†èµ„æº &lt;code&gt;b&lt;/code&gt; ä½œä¸ºå¦å¤–ä¸€ä¸ªè¢«å€Ÿç”¨çš„èµ„æºï¼Œç”±äº &lt;code&gt;b&lt;/code&gt; çš„ä½œç”¨åŸŸæ²¡æœ‰è¦†ç›–æ•´ä¸ªå€Ÿç”¨ä½œç”¨åŸŸï¼Œå¯¼è‡´ä¸æ»¡è¶³å€Ÿç”¨å…¬å¼ã€‚&lt;/p&gt;
&lt;h3 id="å¤šä¸ªå€Ÿç”¨ä½œç”¨åŸŸ"&gt;å¤šä¸ªå€Ÿç”¨ä½œç”¨åŸŸ&lt;/h3&gt;
&lt;p&gt;ä¸€ä¸ªå‡½æ•°ä¸­å¯ä»¥å­˜åœ¨å¤šä¸ªå€Ÿç”¨ä½œç”¨åŸŸã€‚ä¾‹å¦‚ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;superstore_foo&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;b&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Link&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt; &lt;span class="nc"&gt;Foo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;                          &lt;/span&gt;&lt;span class="n"&gt;x2&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="nc"&gt;mut&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Link&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;b&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y2&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;b&lt;/span&gt; &lt;span class="nc"&gt;Foo&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;link&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;x2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;link&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y2&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™ä¸ªçš„å‡½æ•°ï¼ˆå¯èƒ½ä¸æ˜¯ç‰¹åˆ«æœ‰ç”¨ï¼‰ä¸­ï¼Œæ¶‰åŠä¸¤ä¸ªä¸åŒçš„å€Ÿç”¨ä½œç”¨åŸŸã€‚æ¯ä¸ªå€Ÿç”¨ä½œç”¨åŸŸéƒ½æœ‰å®ƒä»¬è‡ªå·±çš„ä½œç”¨åŸŸå…¬å¼è¦æ»¡è¶³ã€‚&lt;/p&gt;
&lt;h2 id="ä¸ºä»€ä¹ˆç”Ÿå‘½å‘¨æœŸä¼šé€ æˆå›°æƒ‘"&gt;ä¸ºä»€ä¹ˆç”Ÿå‘½å‘¨æœŸä¼šé€ æˆå›°æƒ‘&lt;/h2&gt;
&lt;p&gt;æœ€åï¼Œæˆ‘æƒ³è§£é‡Šä¸€ä¸‹ä¸ºä»€ä¹ˆæˆ‘è®¤ä¸º Rust å€Ÿç”¨ç³»ç»Ÿä½¿ç”¨ &lt;strong&gt;ç”Ÿå‘½å‘¨æœŸ&lt;/strong&gt; æœ¯è¯­ä¼šé€ æˆå›°æƒ‘ï¼ˆåŒæ—¶é¿å…åœ¨è¿™ç‰‡åšæ–‡ä¸­ä½¿ç”¨å®ƒï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å½“æˆ‘ä»¬è®¨è®ºå€Ÿç”¨æ—¶ä¼šæ¶‰åŠåˆ°ä¸åŒç±»å‹çš„â€œç”Ÿå‘½å‘¨æœŸâ€ï¼š&lt;/p&gt;
&lt;p&gt;A. èµ„æºæ‰€æœ‰è€…çš„ç”Ÿå‘½å‘¨æœŸï¼ˆæˆ–è€… è¢«æ‰€æœ‰/è¢«å€Ÿç”¨ èµ„æº
B. è¢«å€Ÿç”¨çš„ç”Ÿå‘½å‘¨æœŸï¼Œi.e. ä»å¼€å§‹å€Ÿç”¨åˆ°æœ€åè¿”è¿˜
C. æ¯ä¸€ä¸ªç‹¬ç«‹çš„å€Ÿç”¨è€…æˆ–è¢«å€Ÿç”¨çš„æŒ‡é’ˆçš„ç”Ÿå‘½å‘¨æœŸ&lt;/p&gt;
&lt;p&gt;å½“æœ‰äººè¯´â€œç”Ÿå‘½å‘¨æœŸâ€ï¼Œå®ƒå¯ä»¥æŒ‡ä¸Šé¢çš„ä»»ä½•ä¸€ä¸ªã€‚å¦‚æœæ¶‰åŠå¤šä¸ªèµ„æºå’Œå€Ÿç”¨è€…å°±ä¼šå˜çš„æ›´åŠ å›°æƒ‘ã€‚
æ¯”å¦‚ï¼Œåœ¨å‡½æ•°æˆ–è€…ç»“æ„ä½“ç”Ÿå‘½ä¸­ä¸€ä¸ªâ€œå‘½åçš„ç”Ÿå‘½å‘¨æœŸâ€æŒ‡å“ªä¸ªï¼Ÿæ˜¯ Aã€B æˆ–è€… Cï¼Ÿ&lt;/p&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬çš„å‰ä¸€ä¸ª &lt;code&gt;max&lt;/code&gt; å‡½æ•°ä¸­ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;fn&lt;/span&gt; &lt;span class="nf"&gt;max&lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt; &lt;span class="nc"&gt;Foo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;: &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt; &lt;span class="nc"&gt;Foo&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&amp;gt; &lt;span class="kp"&gt;&amp;amp;&lt;/span&gt;&lt;span class="o"&gt;&amp;#39;&lt;/span&gt;&lt;span class="na"&gt;a&lt;/span&gt; &lt;span class="nc"&gt;Foo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç”Ÿå‘½å‘¨æœŸ &lt;code&gt;'a&lt;/code&gt; çš„æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿå®ƒä¸åº”è¯¥æ˜¯ Aï¼Œå› ä¸ºæ¶‰åŠä¸¤ä¸ªèµ„æºå¹¶ä¸”ä»–ä»¬æœ‰ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸã€‚ä¹Ÿä¸å¯èƒ½æ˜¯ Cï¼Œ
å› ä¸ºæœ‰ä¸‰ä¸ªå€Ÿç”¨è€…ï¼š &lt;code&gt;x&lt;/code&gt; ã€ &lt;code&gt;y&lt;/code&gt; å’Œå‡½æ•°çš„è¿”å›å€¼ï¼Œå¹¶ä¸”ä»–ä»¬ä¹Ÿéƒ½æœ‰ä¸åŒçš„ç”Ÿå‘½å‘¨æœŸã€‚å®ƒæ˜¯ B å—ï¼Ÿå¯èƒ½ã€‚
ä½†æ˜¯æ•´ä¸ªå€Ÿç”¨ä½œç”¨åŸŸå¹¶ä¸æ˜¯ä¸€ä¸ªå…·ä½“çš„å¯¹è±¡ï¼Œå®ƒæ€ä¹ˆèƒ½æœ‰ä¸€ä¸ªâ€œç”Ÿå‘½å‘¨æœŸâ€å‘¢ï¼Ÿç§°å®ƒä¸ºç”Ÿå‘½å‘¨æœŸå°±ä¼šé€ æˆå›°æƒ‘ã€‚&lt;/p&gt;
&lt;p&gt;å¦ä¸€ç§è¯´æ³•æ˜¯å®ƒæ„å‘³ç€å¯¹è¢«å€Ÿç”¨èµ„æºçš„æœ€å°ç”Ÿå‘½å‘¨æœŸè¦æ±‚ã€‚ä¸€å®šç¨‹åº¦ä¸Šæ˜¯æœ‰é“ç†çš„ï¼Œ
ä½†æ˜¯æˆ‘ä»¬æ€ä¹ˆç§°å‘¼æœ€å°ç”Ÿå‘½å‘¨æœŸè¦æ±‚â€œç”Ÿå‘½å‘¨æœŸâ€ï¼Ÿ&lt;/p&gt;
&lt;p&gt;æ‰€æœ‰æƒ/å€Ÿç”¨æ¦‚å¿µè‡ªèº«å·²ç»å¤Ÿå¤æ‚äº†ã€‚æˆ‘ä¼šè¯´ï¼šå¯¹æœ¯è¯­â€œç”Ÿå‘½å‘¨æœŸâ€çš„å›°æƒ‘å¯¹å­¦ä¹ è¿™ä¸ªæ¦‚å¿µé€ æˆäº†æ›´å¤šçš„è«åå…¶å¦™ã€‚&lt;/p&gt;
&lt;p&gt;P.S. ä½¿ç”¨ä¸Šé¢å®šä¹‰çš„ Aã€B å’Œ Cï¼Œå€Ÿç”¨å…¬å¼å˜æˆï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;A &amp;gt;= B = C_1,UC_2U...UC_n&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="å­¦ä¹ -rust-æ˜¯å€¼å¾—çš„"&gt;å­¦ä¹  Rust æ˜¯å€¼å¾—çš„ï¼&lt;/h2&gt;
&lt;p&gt;å°½ç®¡å€Ÿç”¨å’Œæ‰€æœ‰æƒå¯èƒ½è®©ä½ èŠ±ä¸€äº›æ—¶é—´æ¥æŒæ¡ï¼ˆto grokï¼‰ï¼Œä½†æ˜¯æ˜¯ä¸€ä¸ªéå¸¸æœ‰è¶£çš„å­¦ä¹ ã€‚Rust å°è¯•ä¸ç”¨ GC
æ¥å®ç°å†…å­˜å®‰å…¨ï¼Œå¹¶ä¸”ç›®å‰æ¥çœ‹åšçš„éå¸¸å¥½ã€‚ä¸€äº›äººè¯´ä»–ä»¬é€šè¿‡å­¦ä¹  Haskell æ”¹å˜äº†ä»–ä»¬ç¼–ç¨‹çš„æ–¹å¼ã€‚
æˆ‘è®¤ä¸ºRust åŒæ ·ä¹Ÿå€¼å¾—ä½ å­¦ä¹ ã€‚&lt;/p&gt;
&lt;p&gt;å¸Œæœ›è¿™ç¯‡åšæ–‡èƒ½æä¾›ä¸€äº›å¸®åŠ©ã€‚&lt;/p&gt;</content><category term="Rust"></category><category term="Rust"></category><category term="å€Ÿç”¨"></category><category term="ç”Ÿå‘½å‘¨æœŸ"></category></entry><entry><title>ã€è¯‘æ–‡ã€‘ç†è§£å¸ƒéš†è¿‡æ»¤å™¨</title><link href="https://www.linuxzen.com/understanding-bloom-filter.html" rel="alternate"></link><published>2019-05-10T00:00:00+08:00</published><updated>2019-05-10T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2019-05-10:/understanding-bloom-filter.html</id><summary type="html">&lt;p&gt;åŸæ–‡ï¼š&lt;a href="https://osoco.es/thoughts/2019/05/understanding-bloom-filters-with-pharo-smalltalk/"&gt;Understanding Bloom filters with Pharo Smalltalk&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡é€šè¿‡ HTML è½¬å½•äº† &lt;a href="https://github.com/osoco/PharoPDS"&gt;PharoPDS&lt;/a&gt; åº“åŠå…¶æ‰©å±•é™„å¸¦çš„äº¤äº’å¼æ•™ç¨‹ï¼Œä»¥æ¢ç´¢å’Œç†è§£å¸ƒéš†è¿‡æ»¤å™¨ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œå¦‚æœæ‚¨æƒ³åœ¨çœŸå® â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;åŸæ–‡ï¼š&lt;a href="https://osoco.es/thoughts/2019/05/understanding-bloom-filters-with-pharo-smalltalk/"&gt;Understanding Bloom filters with Pharo Smalltalk&lt;/a&gt;ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡é€šè¿‡ HTML è½¬å½•äº† &lt;a href="https://github.com/osoco/PharoPDS"&gt;PharoPDS&lt;/a&gt; åº“åŠå…¶æ‰©å±•é™„å¸¦çš„äº¤äº’å¼æ•™ç¨‹ï¼Œä»¥æ¢ç´¢å’Œç†è§£å¸ƒéš†è¿‡æ»¤å™¨ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œå¦‚æœæ‚¨æƒ³åœ¨çœŸå®çš„ç¯å¢ƒä¸­ä¿®æ”¹è¿™äº›æ•°æ®ç»“æ„ï¼Œè¯·å°è¯•åœ¨ &lt;a href="https://pharo.org/"&gt;Pharo&lt;/a&gt; é•œåƒä¸­&lt;a href="https://github.com/osoco/PharoPDS#install-pharopds"&gt;å®‰è£…è¿™ä¸ªåº“&lt;/a&gt;ï¼Œå¹¶æŒ‰ç…§äº¤äº’å¼æ•™ç¨‹å¹¶ä½¿ç”¨æä¾›çš„è‡ªå®šä¹‰å·¥å…·è¿›è¡Œæ“ä½œã€‚&lt;/p&gt;
&lt;h2 id="_1"&gt;ç†è§£å¸ƒéš†è¿‡æ»¤å™¨&lt;/h2&gt;
&lt;p&gt;å¸ƒéš†è¿‡æ»¤å™¨æ˜¯ä¸€ä¸ªéå¸¸èŠ‚çœç©ºé—´çš„æ•°æ®ç»“æ„ï¼Œç”± Burton Howard Bloom äº 1970 å¹´æ‰€æå‡ºï¼ˆ&lt;a href="http://crystal.uta.edu/~mcguigan/cse6350/papers/Bloom.pdf"&gt;Space/Time Trade-offs in Hash Coding with Allowable Errors&lt;/a&gt;ï¼‰ï¼Œå¸ƒéš†è¿‡æ»¤å™¨ç”¨äºæµ‹è¯•ä¸€ä¸ªå…ƒç´ æ˜¯å¦æ˜¯é›†åˆçš„æˆå‘˜ä¹‹ä¸€ã€‚&lt;/p&gt;
&lt;p&gt;å¸¸è§„çš„å“ˆå¸Œæœç´¢é€šè¿‡å°†ä¸€ç³»åˆ—å€¼å­˜å‚¨åœ¨å“ˆå¸Œè¡¨ä¸Šï¼Œä¸ç®¡æ˜¯åŸºäºé“¾è¡¨è¿˜æ˜¯å¼€æ”¾å¯»å€ï¼ˆ&lt;a href="https://en.wikipedia.org/wiki/Open_addressing"&gt;open addressing&lt;/a&gt;)ï¼Œéšç€è¶Šæ¥è¶Šå¤šçš„å…ƒç´ æ·»åŠ åˆ°å“ˆå¸Œè¡¨ä¸­ï¼Œå®šä½å…ƒç´ çš„æœŸæœ›æ—¶é—´éƒ½ä¼šä»åˆå§‹çš„å¸¸é‡çš„ O(1) é€€åŒ–æˆ–å¢åŠ åˆ°çº¿æ€§çš„ O(N)ã€‚&lt;/p&gt;
&lt;p&gt;å¸ƒéš†è¿‡æ»¤å™¨æä¾›äº†ä¸€ä¸ªæ›¿ä»£çš„æ•°æ®ç»“æ„ï¼Œå¯ä»¥å®ç°åœ¨æ·»åŠ å…ƒç´ æˆ–æ£€æŸ¥å…ƒç´ æ˜¯å¦æ˜¯æˆå‘˜ä¸Šï¼Œä¸ç®¡åœ¨ç©ºé—´å’Œæ—¶é—´ä¸Šéƒ½å¯ä»¥ä¿è¯å¸¸é‡çº§çš„æ€§èƒ½ï¼Œå¹¶ä¸”å’Œå·²ç»æ·»åŠ åˆ°è¿‡æ»¤å™¨ä¸­çš„å…ƒç´ æ•°é‡æ˜¯æ— å…³çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è¾¾åˆ°å¦‚æ­¤é«˜æ•ˆçš„è¡¨ç°æ‰€éœ€è¦ä»˜å‡ºçš„ä»£ä»·æ˜¯ï¼šå¸ƒéš†è¿‡æ»¤å™¨æ˜¯ä¸€ä¸ªæ¦‚ç‡æ€§çš„æ•°æ®ç»“æ„ã€‚Bloom ä»–åœ¨å¼€åˆ›æ€§çš„è®ºæ–‡ä¸­è§£é‡Šå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ–°çš„æ–¹æ³•æ‰“ç®—æ¯”ä¼ ç»Ÿç›¸å…³çš„æ–¹æ³•å‡å°‘ä¸€å®šé‡å“ˆå¸Œç æ‰€éœ€è¦çš„ç©ºé—´ã€‚é€šè¿‡åˆ©ç”¨æŸäº›åº”ç”¨å¯ä»¥å®¹å¿å°‘é‡çš„è¯¯å·®æ¥å‡å°‘ç©ºé—´çš„ä½¿ç”¨ï¼Œç‰¹åˆ«æ˜¯é‚£äº›æ‹¥æœ‰å¤§é‡çš„æ•°æ®å‚ä¸æ— æ³•é€šè¿‡ä¼ ç»Ÿçš„æ–¹æ³•ä¿ç•™æ ¸å¿ƒå“ˆå¸ŒåŒºåŸŸçš„åº”ç”¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="_2"&gt;èƒŒæ™¯&lt;/h2&gt;
&lt;p&gt;Donald Knuth åœ¨ä»–è‘—åçš„ &lt;a href="https://www-cs-faculty.stanford.edu/~knuth/taocp.html"&gt;The Art of Computer Programming&lt;/a&gt; ä¸­å†™ä¸‹äº†å¦‚ä¸‹å¯¹å¸ƒéš†è¿‡æ»¤å™¨çš„æè¿°ï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æƒ³è±¡ä¸€ä¸ªæ‹¥æœ‰éå¸¸å¤§é‡çš„æ•°æ®ä¸”å¦‚æœæœç´¢æ²¡æœ‰æˆåŠŸåˆ™æ— éœ€å®Œæˆä»»ä½•è®¡ç®—çš„æœç´¢åº”ç”¨ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯èƒ½æƒ³æ£€æŸ¥ä¸€äº›äººçš„ä¿¡ç”¨è¯„çº§æˆ–è€…æŠ¤ç…§ç¼–å·ï¼Œå¦‚æœæ–‡æ¡£ä¸­æ²¡æœ‰è¯¥äººçš„ä»»ä½•è®°å½•æˆ‘ä»¬å°±æ— éœ€åšä»»ä½•è°ƒæŸ¥ã€‚ç±»ä¼¼åœ°ï¼Œåœ¨è®¡ç®—æœºæ’ç‰ˆåº”ç”¨ç¨‹åºä¸­ï¼Œæˆ‘ä»¬å¯èƒ½æœ‰ä¸€ä¸ªç®€å•ç®—æ³•å¯ä»¥æ­£ç¡®åœ°è¿æ¥å¤§å¤šæ•°å•è¯ï¼Œä½†è¯¥ç®—æ³•ä¼šå¯¹å¤§çº¦ 5W ä¸ªå¼‚å¸¸å•è¯æ— æ•ˆ; å¦‚æœæˆ‘ä»¬åœ¨å¼‚å¸¸æ–‡ä»¶ä¸­æ‰¾ä¸åˆ°è¯¥å•è¯ï¼Œå°±å¯ä»¥æ”¾å¿ƒçš„ä½¿ç”¨è¯¥ç®€å•ç®—æ³•ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åŒæ—¶ Andrei Broder å’Œ Michael Mitzenmacher åœ¨è‘—åçš„å¸ƒéš†è¿‡æ»¤å™¨åŸç†ï¼ˆThe Bloom Filter Principle(&lt;a href="https://www.eecs.harvard.edu/~michaelm/postscripts/im2005b.pdf"&gt;Internet Mathematics Vol. 1, No. 4: 485-509Network Applications ofBloom Filters: A Survey&lt;/a&gt;)ï¼‰ä¸­æå‡ºï¼š&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;åœ¨ä¸€ä¸ªç©ºé—´å®è´µçš„æƒ…å†µä¸‹è¦ä½¿ç”¨åˆ—è¡¨æˆ–é›†åˆå¹¶ä¸”å¯ä»¥æ¥å—è¯¯æŠ¥ï¼Œåˆ™å¯ä»¥è€ƒè™‘ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="_3"&gt;çœŸå®ä¸–ç•Œçš„ä¾‹å­&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Medium ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨é¿å…æ¨èç»™ç”¨æˆ·å·²ç»è¯»è¿‡çš„æ–‡ç« ã€‚&lt;/li&gt;
&lt;li&gt;Google Chrome ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨è¯†åˆ«æ¶æ„ URLã€‚&lt;/li&gt;
&lt;li&gt;Google BigTableï¼ŒApache HBbase å’Œ Apache Cassandra ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨å‡å°‘å¯¹ä¸å­˜åœ¨çš„è¡Œå’Œåˆ—çš„æŸ¥æ‰¾ã€‚&lt;/li&gt;
&lt;li&gt;Squid Web ä»£ç†ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨å¤„ç†ç¼“å­˜æ‘˜è¦ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="_4"&gt;åŸºæœ¬ç†è§£&lt;/h2&gt;
&lt;p&gt;å¸ƒéš†è¿‡æ»¤å™¨å¯ä»¥é€šè¿‡èˆå¼ƒå…ƒç´ çš„ç‰¹å¾æ¥é«˜æ•ˆçš„å­˜å‚¨å¤§è§„æ¨¡é›†åˆï¼Œæ¯”å¦‚å®ƒä»…å°†é€šè¿‡ç®—æ³•å¯¹æ¯ä¸€ä¸ªå…ƒç´ åº”ç”¨å“ˆå¸Œå‡½æ•°å¾—åˆ°çš„æ•°å­—å­˜å‚¨åˆ°ä¸€ç³»åˆ—ä½ä¸Šè¿›è¡Œå…³è”ã€‚&lt;/p&gt;
&lt;p&gt;äº‹å®ä¸Šï¼Œå¸ƒéš†è¿‡æ»¤å™¨é€šè¿‡ä¸€ä¸ªé•¿åº¦ï¼ˆmï¼‰å’Œä¸åŒå“ˆå¸Œå‡½æ•°çš„æ•°é‡ï¼ˆkï¼‰çš„æ¯”ç‰¹æ•°ç»„ï¼ˆbit arraryï¼‰æ¥è¡¨ç¤ºã€‚&lt;/p&gt;
&lt;p&gt;è¯¥æ•°æ®ç»“æ„ä»…æ”¯æŒä¸¤ç§æ“ä½œï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ·»åŠ ä¸€ä¸ªå…ƒç´ åˆ°é›†åˆä¸­æ¥ï¼Œ&lt;/li&gt;
&lt;li&gt;æµ‹è¯•ä¸€ä¸ªå…ƒç´ æ˜¯å¦é›†åˆçš„æˆå‘˜ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¸ƒéš†è¿‡æ»¤å™¨çš„æ•°æ®ç»“æ„æ˜¯ä¸€ä¸ªåˆå§‹æ¯”ç‰¹ä½éƒ½ä¸º 0 çš„æ¯”ç‰¹æ•°ç»„ï¼Œä»£è¡¨å¸ƒéš†è¿‡æ»¤å™¨ä¸ºç©ºã€‚&lt;/p&gt;
&lt;p&gt;ä¸¾ä¸ªä¾‹å­ï¼Œè€ƒè™‘å¦‚ä¸‹ç¤ºä¾‹ä¸­åˆ›å»ºçš„å¸ƒéš†è¿‡æ»¤å™¨è¡¨ç¤ºä¸€ä¸ªåŒ…å« 10 ä¸ªå…ƒç´ çš„é›†åˆå¹¶ä¸”è¯¯æŠ¥ç‡ï¼ˆFPP, False Positive Probabilityï¼‰ä¸º  &lt;code&gt;0.1&lt;/code&gt; ï¼ˆ10%ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªç©ºçš„å¸ƒéš†è¿‡æ»¤å™¨å°†é€šè¿‡ä¸€ä¸ªé•¿åº¦ä¸º &lt;code&gt;m=48&lt;/code&gt; (storageSize) å’Œ 4 ä¸ªå“ˆå¸Œå‡½æ•°çš„æ¯”ç‰¹æ•°ç»„ç”¨ä»¥æ”¯æŒç”Ÿäº§èŒƒå›´åœ¨ &lt;code&gt;{1, 2, ..., m}&lt;/code&gt; çš„å€¼ã€‚è¡¨ç¤ºå¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nf"&gt;emptyBloomFilter&lt;/span&gt;
  &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;gtExample&lt;/span&gt;&lt;span class="nf"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nv"&gt; bloom &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="nc"&gt;PDSBloomFilter&lt;/span&gt; &lt;span class="nf"&gt;new:&lt;/span&gt; &lt;span class="m"&gt;10&lt;/span&gt; &lt;span class="nf"&gt;fpp:&lt;/span&gt; &lt;span class="m"&gt;0.1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
  &lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="nf"&gt;assert:&lt;/span&gt; &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="nf"&gt;size&lt;/span&gt; &lt;span class="nf"&gt;eqauls:&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
  &lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="nf"&gt;assert:&lt;/span&gt; &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="nf"&gt;hashes&lt;/span&gt; &lt;span class="nf"&gt;equals:&lt;/span&gt; &lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
  &lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="nf"&gt;assert:&lt;/span&gt; &lt;span class="nv"&gt;bllom&lt;/span&gt; &lt;span class="nf"&gt;storageSize&lt;/span&gt; &lt;span class="nf"&gt;equals:&lt;/span&gt; &lt;span class="m"&gt;48&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
  &lt;span class="o"&gt;^&lt;/span&gt; &lt;span class="nv"&gt;bloom&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img alt="" src="/static/upload/trans-understanding-bloom-filter/empty-bloom-filter.png"&gt;&lt;/p&gt;
&lt;p&gt;è¦æ’å…¥ä¸€ä¸ªå…ƒç´  &lt;code&gt;x&lt;/code&gt; åˆ°å¸ƒéš†è¿‡æ»¤å™¨ä¸­ï¼Œéœ€è¦å¯¹å…ƒç´  &lt;code&gt;x&lt;/code&gt; åº”ç”¨åˆ°æ¯ä¸€ä¸ªå“ˆå¸Œå‡½æ•° $h_i$ ä¸Šå¹¶è®¡ç®—å®ƒçš„å€¼ä¸º $j=h_i(x)$ ï¼Œç„¶åå°†å¸ƒéš†è¿‡æ»¤å™¨ä¸­ &lt;code&gt;j&lt;/code&gt; å¯¹åº”çš„ä½è®¾ç½®ä¸º 1 ã€‚&lt;/p&gt;
&lt;p&gt;ä½œä¸ºä¸€ä¸ªä¾‹å­ï¼Œæˆ‘ä»¬å°†åœ¨ä¸Šé¢çš„è¿‡æ»¤å™¨ä¸­æ’å…¥ä¸€äº›åŸå¸‚çš„åå­—ã€‚è®©æˆ‘ä»¬é€šè¿‡ &lt;code&gt;'Madrid'&lt;/code&gt; å¼€å§‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nf"&gt;withMadridBloomFilter&lt;/span&gt;
  &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;gtExample&lt;/span&gt;&lt;span class="nf"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nv"&gt; bloom &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="nf"&gt;emptyBloomfilter&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
  &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="nf"&gt;add:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;Madrid&amp;#39;&lt;/span&gt; &lt;span class="nf"&gt;asByteArray&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
  &lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="nf"&gt;assert:&lt;/span&gt; &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="nf"&gt;size&lt;/span&gt; &lt;span class="nf"&gt;equals:&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
  &lt;span class="o"&gt;^&lt;/span&gt; &lt;span class="nv"&gt;bloom&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img alt="" src="/static/upload/trans-understanding-bloom-filter/withMadrid-bloom-filter.png"&gt;&lt;/p&gt;
&lt;p&gt;å¸ƒéš†è¿‡æ»¤å™¨è®¡ç®—å‡ºäº† 4 ä¸ªå“ˆå¸Œå€¼ç”¨ä»¥åœ¨é›†åˆä¸­æ‰¾åˆ°å…³è” &lt;code&gt;'Madrid'&lt;/code&gt; çš„æ¯”ç‰¹ä½ã€‚å¦‚ä¸Šå›¾æ‰€å±•ç¤ºï¼Œå¸ƒéš†è¿‡æ»¤å™¨è®¾ç½®äº† 9, 18, 39 å’Œ 48 ã€‚&lt;/p&gt;
&lt;p&gt;ä¸åŒçš„å…ƒç´ å¯èƒ½å…±äº«ä¸€ä¸ªæ¯”ç‰¹ä½ï¼Œæ¯”å¦‚ç°åœ¨æˆ‘ä»¬æ·»åŠ å¦ä¸€ä¸ªåŸå¸‚ &lt;code&gt;'Barcelona'&lt;/code&gt; åˆ°ä¸Šé¢ç›¸åŒçš„å¸ƒéš†è¿‡æ»¤å™¨ä¸­ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="/static/upload/trans-understanding-bloom-filter/withMadridAndBarcelona-bloom-filter.png"&gt;&lt;/p&gt;
&lt;p&gt;å¦‚ä½ æ‰€è§ï¼Œåœ¨æ·»åŠ  &lt;code&gt;'Barcelona'&lt;/code&gt; åˆ°ä¸Šé¢å¸ƒéš†è¿‡æ»¤å™¨ä¹‹ååªæœ‰ 30, 36 å’Œ 42 æ‰€å¯¹åº”çš„æ¯”ç‰¹ä½è¢«è®¾ç½®ï¼Œä¹Ÿå°±æ„å‘³ç€å…ƒç´  &lt;code&gt;'Madrid'&lt;/code&gt; å’Œ &lt;code&gt;'Barcelona'&lt;/code&gt; å…±äº«äº†ä¸€ä¸ªæ¯”ç‰¹ä½ã€‚&lt;/p&gt;
&lt;p&gt;è¦æƒ³æµ‹è¯•ç»™å®šçš„å…ƒç´  &lt;code&gt;x&lt;/code&gt; æ˜¯å¦åœ¨å¸ƒéš†è¿‡æ»¤å™¨ä¹‹ä¸­ï¼Œåªéœ€è¦æ£€æŸ¥æ‰€æœ‰çš„å“ˆå¸Œå‡½æ•° &lt;code&gt;k&lt;/code&gt; è®¡ç®—å‡ºçš„å¯¹åº”çš„æ¯”ç‰¹ä½ã€‚å¦‚æœæ‰€æœ‰ä½éƒ½è¢«è®¾ç½®æ¥ï¼Œåˆ™è¡¨ç¤ºå…ƒç´  &lt;code&gt;x&lt;/code&gt; å¯èƒ½åœ¨å¸ƒéš†è¿‡æ»¤å™¨ä¸­ï¼Œå¦åˆ™å…ƒç´  &lt;code&gt;x&lt;/code&gt; ä¸€å®šä¸åœ¨å…¶ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;å…ƒç´ å­˜åœ¨ä¸ç¡®å®šæ€§æ˜¯ç”±äºä¸€äº›æ¯”ç‰¹ä½å¯èƒ½æ˜¯è¢«ä¹‹å‰æ·»åŠ çš„å…¶ä»–ä¸åŒçš„å…ƒç´ æ‰€è®¾ç½®ã€‚&lt;/p&gt;
&lt;p&gt;è€ƒè™‘å‰é¢çš„ä¾‹å­ï¼Œåœ¨å·²ç»æ·»åŠ äº†å…ƒç´  &lt;code&gt;'Madrid'&lt;/code&gt; å’Œ &lt;code&gt;'Barcelona'&lt;/code&gt; çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ¥æµ‹è¯•å…ƒç´  &lt;code&gt;'Barcelona'&lt;/code&gt; æ˜¯å¦æ˜¯è¯¥è¿‡æ»¤å™¨çš„æˆå‘˜ï¼Œå¸ƒéš†è¿‡æ»¤å™¨è®¡ç®—å‡ºè¯¥å…ƒç´ çš„ 4 ä¸ªå“ˆå¸Œå€¼å¹¶ä¸”æ£€æŸ¥å¯¹åº”çš„æ¯”ç‰¹ä½æ˜¯å¦è¢«è®¾ç½®ï¼Œç»“æœæ˜¾ç¤ºå­—ç¬¦ä¸² &lt;code&gt;'Barcelona'&lt;/code&gt; å¯èƒ½å­˜åœ¨äºè¿‡æ»¤å™¨ä¹‹ä¸­ï¼Œç„¶å &lt;code&gt;contains: 'Barcelona'&lt;/code&gt; è¿”å› &lt;code&gt;true&lt;/code&gt; ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nf"&gt;withMadridAndBarcelonaCheckBarcelonaBloomFilter&lt;/span&gt;
  &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;gtExample&lt;/span&gt;&lt;span class="nf"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nv"&gt; bloom &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="nf"&gt;withMadridBloomFilter&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
  &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="nf"&gt;add:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;Barcelona&amp;#39;&lt;/span&gt; &lt;span class="nf"&gt;asByteArray&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
  &lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="nf"&gt;assert:&lt;/span&gt; &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="nf"&gt;size&lt;/span&gt; &lt;span class="nf"&gt;equals:&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
  &lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="nf"&gt;assert:&lt;/span&gt; (&lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="nf"&gt;contains:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;Barcelona&amp;#39;&lt;/span&gt; &lt;span class="nf"&gt;asByteArray&lt;/span&gt;)&lt;span class="p"&gt;.&lt;/span&gt;
  &lt;span class="o"&gt;^&lt;/span&gt; &lt;span class="nv"&gt;bloom&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç°åœ¨å¦‚æœæˆ‘ä»¬æ£€æŸ¥å…ƒç´  &lt;code&gt;'Berlin'&lt;/code&gt; ï¼Œå¸ƒéš†è¿‡æ»¤å™¨ä¸ºäº†æ‰¾åˆ°å¯¹åº”çš„æ¯”ç‰¹ä½ä¼šé€šè¿‡å¦‚ä¸‹æ–¹å¼è®¡ç®—å®ƒçš„å“ˆå¸Œå€¼ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nf"&gt;withBerlinBloomFilter&lt;/span&gt;
  &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;gtExample&lt;/span&gt;&lt;span class="nf"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nv"&gt; bloom &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
    &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="nf"&gt;emptyBloomFilter&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
    &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="nf"&gt;add:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;Berlin&amp;#39;&lt;/span&gt; &lt;span class="nf"&gt;asByteArray&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
    &lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="nf"&gt;assert:&lt;/span&gt; &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="nf"&gt;size&lt;/span&gt; &lt;span class="nf"&gt;equals:&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
    &lt;span class="o"&gt;^&lt;/span&gt; &lt;span class="nv"&gt;bloom&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img alt="" src="/static/upload/trans-understanding-bloom-filter/withBerlin-bloom-filter.png"&gt;&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çœ‹åˆ°æ¯”ç‰¹ä½ 27 å’Œ 33 æ²¡æœ‰è¢«è®¾ç½®ï¼Œæ‰€ä»¥å…ƒç´  &lt;code&gt;'Berlin'&lt;/code&gt; ä¸€å®šä¸å­˜åœ¨äºå¸ƒéš†è¿‡æ»¤å™¨ä¸­ï¼Œæ‰€ä»¥ &lt;code&gt;contains:&lt;/code&gt; æ–¹æ³•è¿”å› &lt;code&gt;false&lt;/code&gt; ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nf"&gt;withMadridAndBarcelonaCheckBerlinBloomFilter&lt;/span&gt;
  &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;gtExample&lt;/span&gt;&lt;span class="nf"&gt;&amp;gt;&lt;/span&gt;
  &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nv"&gt; bloom &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
  &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="nf"&gt;withMadridBloomFilter&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
  &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="nf"&gt;add:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;Barcelona&amp;#39;&lt;/span&gt; &lt;span class="nf"&gt;asByteArray&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
  &lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="nf"&gt;assert:&lt;/span&gt; &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="nf"&gt;size&lt;/span&gt; &lt;span class="nf"&gt;equals:&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
  &lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="nf"&gt;assert:&lt;/span&gt; (&lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="nf"&gt;contains:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;Berlin&amp;#39;&lt;/span&gt; &lt;span class="nf"&gt;asByteArray&lt;/span&gt;) &lt;span class="nf"&gt;not&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
  &lt;span class="o"&gt;^&lt;/span&gt; &lt;span class="nv"&gt;bloom&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¸ƒéš†è¿‡æ»¤å™¨çš„ç»“æœä¹Ÿå¯èƒ½æ˜¯é”™è¯¯çš„ã€‚ä¾‹å¦‚ï¼Œè€ƒè™‘å…ƒç´  &lt;code&gt;'Roma'&lt;/code&gt; çš„ 4 ä¸ªå“ˆå¸Œå€¼ 36 ç”±äºç¢°æ’å·²ç»åœ¨æˆ‘ä»¬çš„ç¤ºä¾‹è¿‡æ»¤å™¨ä¸­è®¾ç½®ï¼Œæ‰€ä»¥ &lt;code&gt;contains:&lt;/code&gt; æ–¹æ³•è®¤ä¸ºè¯¥å…ƒç´ å¯èƒ½å·²ç»å­˜åœ¨äºè¿‡æ»¤å™¨ä¸­ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nf"&gt;withMadridAndBarcelonaCheckRomaBloomFilter&lt;/span&gt;
  &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;gtExample&lt;/span&gt;&lt;span class="nf"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nv"&gt; bloom &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
    &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="nf"&gt;withMadridBloomFilter&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
    &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="nf"&gt;add:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;Barcelona&amp;#39;&lt;/span&gt; &lt;span class="nf"&gt;asByteArray&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
    &lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="nf"&gt;assert:&lt;/span&gt; &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="nf"&gt;size&lt;/span&gt; &lt;span class="nf"&gt;equals:&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
    &lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="nf"&gt;assert:&lt;/span&gt; (&lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="nf"&gt;contains:&lt;/span&gt; &lt;span class="s"&gt;&amp;#39;Roma&amp;#39;&lt;/span&gt; &lt;span class="nf"&gt;asByteArray&lt;/span&gt;)&lt;span class="p"&gt;.&lt;/span&gt;
    &lt;span class="o"&gt;^&lt;/span&gt; &lt;span class="nv"&gt;bloom&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å°±åƒæˆ‘ä»¬æ‰€äº†è§£åˆ°çš„ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰æ·»åŠ è¿‡è¯¥å…ƒç´ åˆ°å¸ƒéš†è¿‡æ»¤å™¨ä¸­ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªè¯¯æŠ¥çš„ä¾‹å­ã€‚åœ¨è¿™ä¸ªç‰¹åˆ«çš„æ¡ˆä¾‹ä¸­ï¼Œæ¯”ç‰¹ä½ &lt;code&gt;36&lt;/code&gt; å·²ç»è¢«å‰é¢çš„å…ƒç´  &lt;code&gt;'Barcelona'&lt;/code&gt; æ‰€è®¾ç½®ã€‚&lt;/p&gt;
&lt;h2 id="_5"&gt;ç‰¹æ€§&lt;/h2&gt;
&lt;h3 id="_6"&gt;è¯¯æŠ¥&lt;/h3&gt;
&lt;p&gt;å¦‚æˆ‘ä»¬å‰é¢æ‰€å±•ç¤ºï¼Œå¸ƒéš†è¿‡æ»¤å™¨ä¼šå¯¹ä¸€äº›ä¸æ˜¯é›†åˆä¸­çš„æˆå‘˜çš„å…ƒç´ è¿”å› &lt;code&gt;true&lt;/code&gt; ã€‚è¿™ç§æƒ…å†µè¢«æˆä¸ºè¯¯æŠ¥ï¼ˆfalse positiveï¼‰ï¼Œäº§ç”Ÿäºå“ˆå¸Œç¢°æ’å¯¼è‡´çš„å·§åˆè€Œå°†ä¸åŒçš„å…ƒç´ å­˜å‚¨åœ¨ç›¸åŒçš„æ¯”ç‰¹ä½ä¸Šã€‚åœ¨æµ‹è¯•æ“ä½œä¸­æ— æ³•å¾—çŸ¥æˆ‘ä»¬å¯¹æ¯”çš„ç‰¹å®šçš„ä½æ˜¯å¦è¢«ç›¸åŒçš„å“ˆå¸Œå‡½æ•°æ‰€è®¾ç½®ã€‚&lt;/p&gt;
&lt;p&gt;å¹¸è¿çš„æ˜¯ï¼Œå¸ƒéš†è¿‡æ»¤å™¨æœ‰ä¸€ä¸ªå¯é¢„æµ‹çš„è¯¯æŠ¥ç‡ï¼ˆFPPï¼‰ï¼š&lt;/p&gt;
&lt;p&gt;$$P_fp\approx\left(1-e^{-\frac{kn}{m}}\right)^k$$&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;n&lt;/code&gt; æ˜¯å·²ç»æ·»åŠ å…ƒç´ çš„æ•°é‡ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;k&lt;/code&gt; å“ˆå¸Œçš„æ¬¡æ•°ï¼›&lt;/li&gt;
&lt;li&gt;&lt;code&gt;m&lt;/code&gt; å¸ƒéš†è¿‡æ»¤å™¨çš„é•¿åº¦ï¼ˆå¦‚æ¯”ç‰¹æ•°ç»„çš„å¤§å°ï¼‰ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æç«¯æƒ…å†µä¸‹ï¼Œå½“å¸ƒéš†è¿‡æ»¤å™¨æ²¡æœ‰ç©ºé—²ç©ºé—´æ—¶ï¼ˆæ»¡ï¼‰ï¼Œæ¯ä¸€æ¬¡æŸ¥è¯¢éƒ½ä¼šè¿”å› &lt;code&gt;true&lt;/code&gt; ã€‚è¿™ä¹Ÿå°±æ„å‘³ç€ &lt;code&gt;m&lt;/code&gt; çš„é€‰æ‹©å–å†³äºæœŸæœ›é¢„è®¡æ·»åŠ å…ƒç´ çš„æ•°é‡ &lt;code&gt;n&lt;/code&gt; ï¼Œå¹¶ä¸” &lt;code&gt;m&lt;/code&gt; éœ€è¦è¿œè¿œå¤§äº &lt;code&gt;n&lt;/code&gt; ã€‚&lt;/p&gt;
&lt;p&gt;å®é™…æƒ…å†µä¸­ï¼Œå¸ƒéš†è¿‡æ»¤å™¨çš„é•¿åº¦ &lt;code&gt;m&lt;/code&gt; å¯ä»¥æ ¹æ®ç»™å®šçš„è¯¯æŠ¥ç‡ï¼ˆFFPï¼‰çš„å’ŒæœŸæœ›æ·»åŠ çš„å…ƒç´ ä¸ªæ•° &lt;code&gt;n&lt;/code&gt; çš„é€šè¿‡å¦‚ä¸‹å…¬å¼è®¡ç®—ï¼š&lt;/p&gt;
&lt;p&gt;$$m=-\frac{n\ln{P_{fp}}}{(\ln2)^2}$$&lt;/p&gt;
&lt;p&gt;å¯¹äº $\frac{m}{n}$ æ¯”ç‡è¡¨ç¤ºæ¯ä¸€ä¸ªå…ƒç´ éœ€è¦åˆ†é…çš„æ¯”ç‰¹ä½çš„æ•°é‡ï¼Œä¹Ÿå°±æ˜¯å“ˆå¸Œå‡½æ•° &lt;code&gt;k&lt;/code&gt; çš„æ•°é‡å¯ä»¥è°ƒæ•´è¯¯æŠ¥ç‡ã€‚é€šè¿‡å¦‚ä¸‹å…¬å¼æ¥é€‰æ‹©æœ€ä½³çš„ &lt;code&gt;k&lt;/code&gt; å¯ä»¥å‡å°‘è¯¯æŠ¥ç‡ï¼ˆFPPï¼‰ï¼š&lt;/p&gt;
&lt;p&gt;$$k=\frac{m}{n}\ln2$$&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å®ç°çš„ &lt;code&gt;PDSBloomFilter&lt;/code&gt; å»ºç«‹åœ¨æŒ‡å®šé¢„è®¡æ·»åŠ å…ƒç´ çš„æ•°é‡ï¼ˆ &lt;code&gt;n&lt;/code&gt; ï¼‰å’Œè¯¯æŠ¥ç‡ï¼ˆ &lt;code&gt;FPP&lt;/code&gt; ï¼‰ä¹‹ä¸Šï¼Œç„¶åä½¿ç”¨ä¸Šé¢çš„å…¬å¼å»è®¡ç®—æœ€ä¼˜çš„å“ˆå¸Œæ¬¡æ•°å’Œæ¯”ç‰¹æ•°ç»„çš„é•¿åº¦ã€‚&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ï¼Œè¦å¤„ç† 10 äº¿ä¸ªå…ƒç´ å¹¶ä¸”ä¿æŒ 2% å·¦å³çš„è¯¯æŠ¥ç‡æˆ‘ä»¬éœ€è¦å¦‚ä¸‹å¸ƒéš†è¿‡æ»¤å™¨ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nf"&gt;oneBillionBloomFilter&lt;/span&gt;
    &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;gtExample&lt;/span&gt;&lt;span class="nf"&gt;&amp;gt;&lt;/span&gt;
      &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nv"&gt; bloom &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
      &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="nc"&gt;PDSBloomFilter&lt;/span&gt; &lt;span class="nf"&gt;new:&lt;/span&gt; &lt;span class="m"&gt;1000000000&lt;/span&gt; &lt;span class="nf"&gt;fpp:&lt;/span&gt; &lt;span class="m"&gt;0.02&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
      &lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="nf"&gt;assert:&lt;/span&gt; &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="nf"&gt;size&lt;/span&gt; &lt;span class="nf"&gt;equals:&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
      &lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="nf"&gt;assert:&lt;/span&gt; &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="nf"&gt;hashes&lt;/span&gt; &lt;span class="nf"&gt;equals:&lt;/span&gt; &lt;span class="m"&gt;6&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
      &lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="nf"&gt;assert:&lt;/span&gt; &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="nf"&gt;storageSize&lt;/span&gt; &lt;span class="nf"&gt;equals:&lt;/span&gt; &lt;span class="m"&gt;8142363337&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
      &lt;span class="o"&gt;^&lt;/span&gt; &lt;span class="nv"&gt;bloom&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚ä½ æ‰€è§ï¼Œæœ€ä¼˜çš„å“ˆå¸Œæ¬¡æ•°æ˜¯ 6 å¹¶ä¸”è¿‡æ»¤å™¨çš„é•¿åº¦æ˜¯ $8.14 x 10^9$ ä¸ªæ¯”ç‰¹ä½ï¼Œå¤§çº¦å ç”¨ 1 GB å†…å­˜ã€‚&lt;/p&gt;
&lt;h3 id="_7"&gt;éè¯¯æŠ¥&lt;/h3&gt;
&lt;p&gt;å¦‚æœå¸ƒéš†è¿‡æ»¤å™¨è¿”å›ç‰¹å®šçš„å…ƒç´ ä¸æ˜¯æˆå‘˜ä¹‹ä¸€ï¼Œé‚£ä¹ˆè¯¥å…ƒç´ å°±ç»å¯¹ä¸åœ¨é›†åˆä¹‹ä¸­ã€‚&lt;/p&gt;
&lt;h3 id="_8"&gt;æ— æ³•åˆ é™¤&lt;/h3&gt;
&lt;p&gt;è¦æƒ³ä»è¿‡æ»¤å™¨ä¸­åˆ é™¤ä¸€ä¸ªå…ƒç´ éœ€è¦åœ¨æ¯”ç‰¹æ•°ç»„ä¸­å–æ¶ˆè®¾ç½®ç›¸åº”æ•°é‡ï¼ˆ &lt;code&gt;k&lt;/code&gt; ï¼‰çš„æ¯”ç‰¹ä½ã€‚ä¸å¹¸çš„æ˜¯ï¼Œç”±äºå“ˆå¸Œç¢°æ’å¯¼è‡´å¤šä¸ªå…ƒç´ ä¼šå…±äº«æ¯”ç‰¹ä½å¯¼è‡´äº†ä¸€ä¸ªæ¯”ç‰¹ä½å¯èƒ½å…³è”äº†å¤šä¸ªå…ƒç´ ã€‚&lt;/p&gt;
&lt;h2 id="_9"&gt;åˆ†æ&lt;/h2&gt;
&lt;p&gt;å‰é¢è®¡ç®—è¯¯æŠ¥ç‡ï¼ˆFPPï¼‰çš„å…¬å¼ä¸ºäº†å®¹æ˜“è®¡ç®—ä»è€Œå‡è®¾äº†å“ˆå¸Œå‡½æ•° &lt;code&gt;k&lt;/code&gt; çš„éšæœºæ˜¯å‡åŒ€åˆ†å¸ƒçš„ã€‚&lt;/p&gt;
&lt;p&gt;æ¢å¥è¯è¯´ï¼Œä¸€æ—¦å°†æœŸæœ›çš„ &lt;code&gt;n&lt;/code&gt; ä¸ªå…ƒç´ æ·»åŠ åˆ°æ•°æ®ç»“æ„ä¸­ï¼Œ &lt;code&gt;fpp&lt;/code&gt; åœ¨ &lt;code&gt;PDSBloomFilter&lt;/code&gt; åˆå§‹åŒ–æ—¶æŒ‡å®šçš„å€¼åº”è¯¥è§£é‡Šä¸ºæœŸæœ›çš„ &lt;code&gt;fpp&lt;/code&gt; çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œå¯¹äºä¸€ä¸ªåˆšåˆšåˆ›å»ºä¾ç„¶ä¿æŒä¸ºç©ºçš„å¸ƒéš†è¿‡æ»¤å™¨çš„ &lt;code&gt;fpp&lt;/code&gt; å€¼ä¸º 0ï¼Œå¦‚ä¸‹å›¾æ‰€è§ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="/static/upload/trans-understanding-bloom-filter/empty-filter-fpp-curve.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;fpp&lt;/code&gt; çš„å€¼ä¼šéšç€ä¸æ–­çš„å‘è¿‡æ»¤å™¨ä¸­æ·»åŠ å…ƒç´ è€Œå¢é•¿ï¼Œå¹¶éšç€å¸ƒéš†è¿‡æ»¤å™¨ä¸­çš„å…ƒç´ æ•°é‡è¾¾åˆ°æœŸæœ›å€¼è€Œæœ€ç»ˆè¾¾åˆ°ç›®æ ‡ &lt;code&gt;fpp&lt;/code&gt; ï¼Œæˆ‘ä»¬é€šè¿‡å¦‚ä¸‹å¡«å……å¸ƒéš†è¿‡æ»¤å™¨ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nf"&gt;fullBloomFilter&lt;/span&gt;
    &lt;span class="err"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nv"&gt;gtExample&lt;/span&gt;&lt;span class="nf"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="nv"&gt; bloom &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
    &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="o"&gt;:=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt; &lt;span class="nf"&gt;emptyBloomFilter&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
    &lt;span class="m"&gt;1&lt;/span&gt; &lt;span class="nf"&gt;to:&lt;/span&gt; &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="nf"&gt;targetElements&lt;/span&gt;
        &lt;span class="nf"&gt;do:&lt;/span&gt; [ &lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="nv"&gt;each&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="nv"&gt;bloom&lt;/span&gt; &lt;span class="nf"&gt;add:&lt;/span&gt; &lt;span class="nv"&gt;each&lt;/span&gt; &lt;span class="nf"&gt;asString&lt;/span&gt; &lt;span class="nf"&gt;asByteArray&lt;/span&gt; ]&lt;span class="p"&gt;.&lt;/span&gt;
    &lt;span class="o"&gt;^&lt;/span&gt; &lt;span class="nv"&gt;bloom&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img alt="" src="/static/upload/trans-understanding-bloom-filter/full-filter-fpp-curve.png"&gt;&lt;/p&gt;
&lt;p&gt;ä¸è¿‡ï¼Œä½ åº”è¯¥çŸ¥é“ä¸Šé¢çš„ FPP æ›²çº¿æ˜¯ä¸€ä¸ªç†è®ºå€¼å¹¶ä¸”å®é™…è§‚æµ‹åˆ°çš„ FPP å°†ä¼šå–å†³äºç‰¹å®šçš„æ•°æ®é›†å’Œæ‰€ä½¿ç”¨çš„å“ˆå¸Œå‡½æ•°ã€‚ä¸ºäº†å®éªŒæ£€æŸ¥æˆ‘ä»¬çš„å®ç°çš„ä¼˜ç‚¹ï¼Œæˆ‘ä»¬è¿›è¡Œäº†å¦‚ä¸‹åˆ†æï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;éšæœºç”Ÿæˆä¸€ä¸ªåŒ…å«é‚®ä»¶åœ°å€çš„åˆ—è¡¨å¹¶æ’å…¥åˆ°å¸ƒéš†è¿‡æ»¤å™¨ã€‚&lt;/li&gt;
&lt;li&gt;éšæœºç”Ÿæˆä¸€ä¸ªåŒ…å«é‚®ä»¶åœ°å€çš„åˆ—è¡¨ä¸æ’å…¥åˆ°è¯¥è¿‡æ»¤å™¨ä¸­ã€‚&lt;/li&gt;
&lt;li&gt;ç»Ÿè®¡åœ¨è¯¥è¿‡æ»¤å™¨ä¸­æœç´¢ç¼ºå¤±åœ°å€çš„è¯¯æŠ¥æƒ…å†µã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æˆ‘ä»¬è¿è¡Œçš„å®éªŒå€¼åœ¨è¯¥è¿‡æ»¤å™¨æœŸæœ›å…ƒç´ ä¸ªæ•°çš„ 10 åˆ° 1.5 å€ï¼ˆæ­¥é•¿ 10ï¼‰ã€‚å¯¹äºæ¯ç§å®éªŒçš„å…ƒç´ æ•°é‡è¿è¡Œ 10 æ¬¡ã€‚è¯¥åˆ†æé€šè¿‡ä¸€ä¸ªå›¾åƒå±•ç¤ºäº†è¯¥è¿‡æ»¤å™¨çš„å¦‚ä¸‹æŒ‡æ ‡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç†è®ºçš„ FPP æ›²çº¿ï¼ˆè“è‰²ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;æ¯æ¬¡å®éªŒæµ‹é‡åˆ°çš„å¹³å‡ FPP å€¼ï¼ˆç°è‰²åå­—ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å®é™…çš„ FPP æ›²çº¿ï¼ˆçº¢è‰²ï¼‰&lt;/li&gt;
&lt;li&gt;å’Œæ ‡å‡†å·®ï¼ˆçº¢è‰²é˜´å½±ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œå¦‚ä¸‹ä»£ç è¿è¡Œä¸Šé¢çš„å®éªŒåˆ†æå¹¶ä¸”é€šè¿‡ä¸€ä¸ªå›¾å±•ç¤ºä¸€ä¸ªåŒ…å« 100 ä¸ªå…ƒç´ å’Œ 3% çš„ FPP çš„å¸ƒéš†è¿‡æ»¤å™¨ç»“æœï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nc"&gt;PDSBloomFilterAnalysis&lt;/span&gt; &lt;span class="nf"&gt;openFor:&lt;/span&gt; (&lt;span class="nc"&gt;PDSBloomFilter&lt;/span&gt; &lt;span class="nf"&gt;new:&lt;/span&gt; &lt;span class="m"&gt;100&lt;/span&gt; &lt;span class="nf"&gt;fpp:&lt;/span&gt; &lt;span class="m"&gt;0.03&lt;/span&gt;)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img alt="" src="/static/upload/trans-understanding-bloom-filter/analysis-fpp.png"&gt;&lt;/p&gt;
&lt;h2 id="_10"&gt;å‹æµ‹&lt;/h2&gt;
&lt;p&gt;ä¸€ä¸ªå¸ƒéš†è¿‡æ»¤å™¨æ¯æ¬¡æ“ä½œåªéœ€è¦å›ºå®šæ¬¡æ•°çš„æ¢æµ‹ï¼ˆ &lt;code&gt;k&lt;/code&gt; ï¼‰ï¼Œæ‰€ä»¥åœ¨æ¯æ¬¡æ’å…¥å’ŒæŸ¥æ‰¾çš„å¤„ç†åªéœ€è¦ &lt;code&gt;O(k)&lt;/code&gt; çš„æ—¶é—´å¤æ‚åº¦ï¼Œä¹Ÿå°±æ˜¯å¸¸é‡çº§çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼Œå¦‚ä¸‹ä»£ç å°†åŸºäºåœ¨å‰é¢è¢«å¡«å……äº† 10 ä¸ªå…ƒç´ çš„å¸ƒéš†è¿‡æ»¤å™¨ä¸Šæ‰§è¡ŒæŸ¥æ‰¾æ“ä½œæ¥è¿è¡Œä¸€ä¸ªå¾®å‹å‹æµ‹å¹¶ä¸”å±•ç¤ºæ¯ç§’é’Ÿè¿è¡ŒæŸ¥æ‰¾æ“ä½œçš„æ¬¡æ•°ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="/static/upload/trans-understanding-bloom-filter/bloom-benchmark-little.png"&gt;&lt;/p&gt;
&lt;p&gt;ç”±äºæ—¶é—´å¤æ‚åº¦æ˜¯å¸¸é‡çº§çš„ï¼Œé‚£ä¹ˆä¸€ä¸ªå‰é¢æ·»åŠ äº† 100W ä¸ªå…ƒç´ çš„å¸ƒéš†è¿‡æ»¤å™¨çš„æŸ¥æ‰¾ç»“æœåº”è¯¥å’Œä¸Šé¢ç±»ä¼¼ï¼š
&lt;img alt="" src="/static/upload/trans-understanding-bloom-filter/bloom-benchmark-million.png"&gt;&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªåŸºäº &lt;code&gt;Collection&lt;/code&gt; æ•°æ®ç»“æ„çš„ç®€å•å®ç°å°†æ˜¯çº¿æ€§çš„ &lt;code&gt;O(n)&lt;/code&gt; çš„æ—¶é—´å¤æ‚åº¦ï¼Œä¸€ä¸ªæœ‰åºé›†åˆçš„æœ€ä¼˜æƒ…å†µå°†ä¼šæ˜¯ &lt;code&gt;O(log n)&lt;/code&gt; çš„æ—¶é—´å¤æ‚åº¦ã€‚ä½ å¯ä»¥é€šè¿‡è§‚å¯Ÿä¸‹é¢å‹æµ‹ä½¿ç”¨ä¸€ä¸ªé•¿åº¦ä¸º &lt;code&gt;n&lt;/code&gt; çš„ &lt;code&gt;OrderedCollection&lt;/code&gt; é›†åˆçš„é™çº§è¡Œä¸ºæ¥æ£€éªŒï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="/static/upload/trans-understanding-bloom-filter/collection-benchmark-little.png"&gt;&lt;/p&gt;
&lt;p&gt;VS&lt;/p&gt;
&lt;p&gt;&lt;img alt="" src="/static/upload/trans-understanding-bloom-filter/collection-benchmark-million.png"&gt;&lt;/p&gt;
&lt;h2 id="_11"&gt;è¯•ç©&lt;/h2&gt;
&lt;p&gt;PharoPDS æä¾›äº†ä¸€ä¸ªç®€å•çš„å·¥å…·è®©ä½ å¯ä»¥æ¢ç´¢å’Œå°è¯•å¸ƒéš†è¿‡æ»¤å™¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;code&gt;PDSBloomFilterPlayground&lt;/code&gt; å…è®¸ä½ åˆ›å»ºä¸€ä¸ªå¸ƒéš†è¿‡æ»¤å™¨å°è¯•ä¸€äº›æ“ä½œå¹¶ä¸”è¿›è¡Œå¯è§†åŒ–ã€‚ç”šè‡³ä½ å¯ä»¥åŸºäº UI è¿è¡Œå‹æµ‹å’Œè°ƒä¼˜ã€‚&lt;/p&gt;
&lt;p&gt;å¯ä»¥é€šè¿‡å¦‚ä¸‹ä»£ç è¿è¡Œï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nc"&gt;PDSBloomFilterPlayground&lt;/span&gt; &lt;span class="nf"&gt;open&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img alt="" src="/static/upload/trans-understanding-bloom-filter/bloom-filter-playground.png"&gt;&lt;/p&gt;
&lt;h2 id="_12"&gt;å¼•ç”¨&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;On Probabilistic Data Structures:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Burton H. Bloom. &lt;a href="http://crystal.uta.edu/~mcguigan/cse6350/papers/Bloom.pdf"&gt;Space/Time Trace-offs in Hash Coding with Allowable Errors&lt;/a&gt; (1970).&lt;/li&gt;
&lt;li&gt;Donald E. Knuth. &lt;a href="https://www-cs-faculty.stanford.edu/~knuth/taocp.html"&gt;The Art of Computer Programming&lt;/a&gt; Volume 3: Sorting and Searching.&lt;/li&gt;
&lt;li&gt;&lt;a href="http://llimllib.github.io/bloomfilter-tutorial/"&gt;Bloom Filters by Example&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Andrii Gakhov, &lt;a href="https://www.gakhov.com/books/pdsa.html"&gt;Probabilistic Data Structures and Algorithms for Big Data Applications&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;On Moldable Development:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Andrei Chisâ€™s PhD, â€œMoldable Toolsâ€ (2016). Available at &lt;a href="http://scg.unibe.ch/archive/phd/chis-phd.pdf"&gt;http://scg.unibe.ch/archive/phd/chis-phd.pdf&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Andrei Chis, â€œPlaying with Face Detection in Pharoâ€ (2018). Available at &lt;a href="https://medium.com/@Chis_Andrei/playing-with-face-detection-in-pharo-e6dd297e0ca3"&gt;https://medium.com/@Chis_Andrei/playing-with-face-detection-in-pharo-e6dd297e0ca3&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Tudor Girba, â€œMoldable Developmentâ€ (2018). Available at &lt;a href="https://www.youtube.com/watch?v=IcwHaF5aRTM"&gt;https://www.youtube.com/watch?v=IcwHaF5aRTM&lt;/a&gt;.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;</content><category term="Tech"></category><category term="Bloom"></category><category term="Filter"></category><category term="å¸ƒéš†è¿‡æ»¤å™¨"></category><category term="Bloom Filter"></category></entry><entry><title>ã€è¯‘æ–‡ã€‘ä»€ä¹ˆæ˜¯å¹‚ç­‰</title><link href="https://www.linuxzen.com/what-is-idempotence.html" rel="alternate"></link><published>2019-05-05T00:00:00+08:00</published><updated>2019-05-05T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2019-05-05:/what-is-idempotence.html</id><summary type="html">&lt;p&gt;åŸæ–‡ï¼š&lt;a href="https://lispcast.com/what-is-idempotence/"&gt;WHAT IS IDEMPOTENCE&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ï¼ˆåŸæ–‡æ˜¯ä¸€ä¸ªè§†é¢‘çš„æ–‡å­—è®°å½•ç‰ˆï¼Œæœ‰å…´è¶£çš„å¯ä»¥çœ‹åŸæ–‡å’ŒåŸæ–‡ä¸­çš„è§†é¢‘ï¼Œæœ¬æ–‡åªç¿»è¯‘æ–‡å­—å¹¶ç»“åˆè‡ªå·±çš„ä¸€äº›ç† â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;åŸæ–‡ï¼š&lt;a href="https://lispcast.com/what-is-idempotence/"&gt;WHAT IS IDEMPOTENCE&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ï¼ˆåŸæ–‡æ˜¯ä¸€ä¸ªè§†é¢‘çš„æ–‡å­—è®°å½•ç‰ˆï¼Œæœ‰å…´è¶£çš„å¯ä»¥çœ‹åŸæ–‡å’ŒåŸæ–‡ä¸­çš„è§†é¢‘ï¼Œæœ¬æ–‡åªç¿»è¯‘æ–‡å­—å¹¶ç»“åˆè‡ªå·±çš„ä¸€äº›ç†è§£åšä¸€äº›æ•´ç†ã€‚ï¼‰&lt;/p&gt;
&lt;h3 id="_1"&gt;å¼•å­&lt;/h3&gt;
&lt;p&gt;å¹‚ç­‰æ„å‘³ç€å¯ä»¥é‡å¤ï¼Œä¹Ÿå°±æ˜¯è¯´ä½ å¯ä»¥å®‰å…¨çš„é‡è¯•ä¸€ä¸ªæ“ä½œä¸ä¼šäº§ç”Ÿä»»ä½•é—®é¢˜ã€‚ç»å…¸çš„ä¾‹å­æ˜¯ç”µæ¢¯æŒ‰é’®ï¼šä½ æŒ‰ä¸¤æ¬¡å¹¶ä¸ä¼šå«æ¥ä¸¤è¾†ç”µæ¢¯ã€‚åŒæ—¶æˆ‘ä»¬æ¥æ¢ç´¢ä¸ºä»€ä¹ˆåœ¨ä¸€ä¸ª Email æœåŠ¡ä¸­éœ€è¦è¿™ä¸ªç‰¹æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ä»€ä¹ˆæ˜¯å¹‚ç­‰ï¼Ÿä¸ºä»€ä¹ˆå¹‚ç­‰å¯¹äºåˆ†å¸ƒå¼ç¼–ç¨‹éå¸¸æœ‰ç”¨ï¼Ÿé€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œä½ å°†çŸ¥é“å¦‚ä½•åœ¨ä½ è‡ªå·±çš„ç³»ç»Ÿä¸­å®ç°å¹‚ç­‰ã€‚&lt;/p&gt;
&lt;p&gt;å¹‚ç­‰ä¹‹æ‰€ä»¥é‡è¦æ˜¯å› ä¸ºå®ƒæŠ“ä½äº†å®‰å…¨é‡è¯•çš„æœ¬è´¨ã€‚æ²¡æœ‰å®‰å…¨é‡è¯•ä¹Ÿå°±æ²¡æœ‰åŠæ³•å®ç°ä¸€ä¸ªå®‰å…¨çš„åˆ†å¸ƒå¼åè®®ã€‚&lt;/p&gt;
&lt;h3 id="_2"&gt;ä»€ä¹ˆæ˜¯å¹‚ç­‰ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;å¹‚ç­‰çš„æœ¬è´¨å°±æ˜¯ä½ å¯ä»¥è¯·æ±‚ä¸¤æ¬¡ï¼ˆæˆ–å¤šæ¬¡ï¼‰ï¼Œä½†æ˜¯å’Œè¯·æ±‚ä¸€æ¬¡çš„æ‰€äº§ç”Ÿçš„å‰¯ä½œç”¨ä¸€è‡´ã€‚ç»å…¸çš„ä¾‹å­æ˜¯ç”µæ¢¯æŒ‰é’®ã€‚å‡è®¾ä½ æ¥åˆ°ä¸€ç»„ç”µæ¢¯é¢å‰æŒ‰ä¸‹æŒ‰é’®ï¼ŒæŒ‰é’®äº®èµ·å¹¶å‘¼å«ç”µæ¢¯ã€‚ç„¶åå¦ä¸€ä¸ªäººåŒæ ·æ¥åˆ°è¿™ç»„ç”µæ¢¯é¢å‰ï¼ŒæŒ‰é’®å·²ç»ç‚¹äº®ä½†ä»–ä¾ç„¶æŒ‰ä¸‹ç›¸åŒçš„æŒ‰é’®ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬éƒ½çŸ¥é“è¿™æ ·åšä¸ä¼šäº§ç”Ÿä»»ä½•æ•ˆæœï¼ˆå‰¯ä½œç”¨ï¼‰ï¼Œä½†æ˜¯ç”±äºæŸäº›åŸå› æˆ‘ä»¬ä¾ç„¶æƒ³è¿™ä¹ˆåšï¼Œä»…ä»…ä¸ºäº†ä»¥é˜²ä¸‡ä¸€ã€‚ä¹Ÿè®¸ä»–æ˜¯å¯¹çš„ï¼Œä¹Ÿè®¸ä¸€å¼€å§‹ä¿¡å·å¹¶æ²¡æœ‰ä¼ é€’ç»™ç”µæ¢¯ã€‚ç”±äºè¿™æ ·åšæ²¡æœ‰ä»»ä½•åå¤„ï¼Œæ‰€ä»¥ä¸ºä»€ä¹ˆä¸å‘¢ï¼Ÿè¿™å°±æ˜¯æˆ‘ä»¬æƒ³åœ¨æˆ‘ä»¬çš„åˆ†å¸ƒå¼ç³»ç»Ÿä¸­è´¯å½»çš„ç†å¿µã€‚&lt;/p&gt;
&lt;p&gt;æŠ€æœ¯ä¸Šè®²ï¼Œè¿™æ˜¯ä¸€ä¸ªå±äºä»£æ•°çš„æ¦‚å¿µã€‚å½“æˆ‘ä»¬è®¨è®ºæŒ‰ä¸‹æŒ‰é’®æ—¶ï¼Œæˆ‘ä»¬å¯¹ç°å®çš„ä¸–ç•Œäº§ç”Ÿäº†ä¸€ä¸ªæœ‰æ•ˆçš„å‰¯ä½œç”¨ã€‚è€Œåœ¨ä»£æ•°ä¸­ï¼Œå¹‚ç­‰æ˜¯çº¯å‡½æ•°å’Œæ•°å­¦å‡½æ•°çš„å±æ€§ã€‚å¹‚ç­‰æ„å‘³ç€ä½ å°†å­—ç¬¦ä¸²ä¸­çš„å­—æ¯è½¬æ¢æˆå¤§å†™ä¸¤æ¬¡å¯¹å…¶ç»“æœæ²¡æœ‰ä»»ä½•å½±å“ï¼Œå› ä¸ºç¬¬ä¸€æ¬¡æ“ä½œå°±å¯ä»¥äº†ã€‚æŠ€æœ¯ä¸Šæ¥è¯´ï¼Œå¦‚æœå°†å‡½æ•° $F$ åº”ç”¨åˆ°ä¸€ä¸ªå€¼ä¸Šï¼Œå¦‚ $F(x)$ ï¼Œä¸å°† $F(x)$ åº”ç”¨åˆ° $F$ æ˜¯ç›¸åŒçš„ï¼ˆ $F(x)=F(F(x))$ ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åº”ç”¨äº†ä¸¤æ¬¡å‡½æ•° $F$ å’Œåº”ç”¨ä¸€æ¬¡æ‰€äº§ç”Ÿçš„å‰¯ä½œç”¨æ˜¯ä¸€è‡´çš„ï¼Œä¹Ÿå°±æ˜¯è¯´é‡å¤æ— å…³ã€‚æˆ‘æŒ‰ä¸‹æŒ‰é’®ï¼Œç¬¬äºŒæ¬¡æŒ‰ä¸‹ä¸ä¼šäº§ç”Ÿä»»ä½•å‰¯ä½œç”¨å’Œé—®é¢˜ã€‚å¦‚æœæˆ‘åº”ç”¨ä¸¤æ¬¡å‡½æ•°ï¼Œç¬¬äºŒæ¬¡ä¸ä¼šäº§ç”Ÿä»»ä½•å‰¯ä½œç”¨ã€‚ç¬¬ä¸€æ¬¡æœ‰å‰¯ä½œç”¨ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥ç¬¬äºŒæ¬¡ã€ç¬¬ä¸‰æ¬¡ã€ç¬¬å››æ¬¡ç­‰ç­‰éƒ½ä¸ä¼šäº§ç”Ÿå‰¯ä½œç”¨ã€‚&lt;/p&gt;
&lt;h3 id="_3"&gt;ä¸ºä»€ä¹ˆå¹‚ç­‰å¾ˆé‡è¦ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;åœ¨ä¸€ä¸ªåˆ†å¸ƒå¼ç³»ç»Ÿï¼Œç‰¹åˆ«æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œæˆ‘ä»¬ä¼šé¢ä¸´æ¶ˆæ¯é€šè¿‡ä¸€ä¸ªä¸å¯é çš„ç½‘ç»œä¼ è¾“ã€‚åŸºæœ¬ä¸Šï¼Œå¦‚æœä½ å‘é€äº†ä¸€ä¸ªæ¶ˆæ¯ï¼Œæ¶ˆæ¯å¯èƒ½æ²¡æœ‰é€è¾¾å¹¶ä¸”ä½ æ— æ³•æ„ŸçŸ¥ã€‚ä¹Ÿå°±æ˜¯è¯´ä½ æ— æ³•ç¡®å®šæ¶ˆæ¯æ˜¯å¦åˆ°è¾¾ã€‚&lt;/p&gt;
&lt;p&gt;æœ‰æ—¶ï¼Œä½ å¾—åˆ°è¿æ¥ä¸­æ–­çš„æ¶ˆæ¯ï¼Œä½ ä¼šçŸ¥é“æ¶ˆæ¯æ²¡æœ‰åˆ°è¾¾ã€‚ä½†æœ‰æ—¶è¶…æ—¶å¯¼è‡´ä½ æ— æ³•è·å¾—åé¦ˆã€‚æ˜¯æ¶ˆæ¯å·²ç»åˆ°è¾¾ä½†æ˜¯ç”±äº ACK è¶…æ—¶æ²¡æœ‰æ”¶åˆ°åé¦ˆï¼Œè¿˜æ˜¯æ¶ˆæ¯å‹æ ¹å°±æ²¡æœ‰åˆ°è¾¾ï¼Ÿå…¶ä»–ç³»ç»Ÿå´©æºƒï¼Ÿç³»ç»Ÿå´©æºƒå‘ç”Ÿåœ¨æ¶ˆæ¯å‘é€ä¹‹å‰è¿˜æ˜¯ä¹‹åï¼Ÿç”±äºç³»ç»Ÿå·²ç»å´©æºƒï¼Œä½ æ— æ³•å¾—çŸ¥ã€‚&lt;/p&gt;
&lt;p&gt;Email å®é™…ä¸Šåä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œå› ä¸ºåŒä¸€å°é‚®ä»¶ä½ ä¸æƒ³å‘é€ä¸¤æ¬¡ã€‚è®©æˆ‘ä»¬å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªé‚®ä»¶æœåŠ¡å¹¶ä¸”é€šè¿‡å®ƒå‘é€ä¸€ä¸ªæ¶ˆæ¯ï¼šâ€œè¯·å°†è¿™å°é‚®ä»¶å‘é€ç»™æˆ‘çš„å®¢æˆ·â€ã€‚ä½ æ²¡æœ‰å¾—åˆ°ä»»ä½•åé¦ˆï¼Œä½ å°†ä¼šæ€ä¹ˆåšï¼Ÿå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿä½ ä¼šå°è¯•é‡æ–°å‘é€å—ï¼Ÿå¦‚æœé‚®ä»¶å·²ç»å‘é€äº†å‘¢ï¼Ÿå†å‘ä¸€æ¬¡ç›¸åŒçš„é‚®ä»¶ï¼Ÿå¦‚æœä¸é‡æ–°å‘é€å®¢æˆ·å°†æ— æ³•æ”¶åˆ°æ”¶ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ˜¯ä¸€ä¸ªçœŸå®å­˜åœ¨çš„å•†ä¸šé—®é¢˜ã€‚å¹‚ç­‰å°†å¯ä»¥è§£å†³æ­¤é—®é¢˜ï¼šå¦‚æœæˆ‘é‡æ–°å‘é€é‚®ä»¶ï¼Œä½†ä¸ä¼šç ´åä»»ä½•äº‹æƒ…ï¼ˆä¸ä¼šäº§ç”Ÿç¬¬äºŒæ¬¡å‰¯ä½œç”¨ï¼‰ã€‚å°±åƒå‰é¢è¯´çš„ç”µæ¢¯æŒ‰é’®ä¸€æ ·ï¼Œæˆ‘å¯ä»¥ä¸€ç›´é‡å¤å‘é€è¿™å°é‚®ä»¶ã€‚æˆ‘å¯ä»¥é‡å¤å‘é€ä¸€ç™¾æ¬¡ï¼Œä½†è¿™å°é‚®ä»¶åªä¼šè¢«æŠ•é€’ä¸€æ¬¡ã€‚&lt;/p&gt;
&lt;p&gt;å¹‚ç­‰å®ç°äº†è¯·æ±‚æ¬¡æ•°å’Œå®é™…äº§ç”Ÿå‰¯ä½œç”¨çš„æ¬¡æ•°çš„è§£å¶ã€‚æˆ‘å¯ä»¥è¯·æ±‚ä¸€ç™¾æ¬¡ï¼Œä½†æ˜¯åªäº§ç”Ÿä¸€æ¬¡å‰¯ä½œç”¨ã€‚è¿™æ˜¯æœ‰äº›æ—¶å€™ä½ çœŸæ­£æƒ³å®ç°çš„ï¼šé€šè¿‡é™åˆ¶çš„æ¶ˆæ¯èƒ½å¤Ÿè¿›è¡Œå®‰å…¨çš„é‡è¯•ã€‚&lt;/p&gt;
&lt;p&gt;â€œæˆ‘ä¸çŸ¥é“è¿™æ˜¯å¦è¡Œå¾—é€šï¼Œä½†æ˜¯æˆ‘å°†ä¼šå†è¯•ä¸€æ¬¡ã€‚â€è¿™å°†æ˜¯ä½ ç³»ç»Ÿä¸­éå¸¸å¥½çš„å±æ€§ã€‚&lt;/p&gt;
&lt;h3 id="_4"&gt;å¦‚ä½•å®ç°å¹‚ç­‰ï¼Ÿ&lt;/h3&gt;
&lt;p&gt;å‡è®¾åŸºäºé‚®ä»¶æœåŠ¡ï¼Œæœ€ç®€å•çš„æ–¹æ³•æ˜¯éœ€è¦é€šè¿‡ä¸€äº›æ–¹æ³•å»è¯†åˆ«ä¸€å°é‚®ä»¶çš„å”¯ä¸€æ€§ï¼ˆIDï¼‰ã€‚æ¯”å¦‚ï¼šâ€œè¿™æ˜¯è¿™å°é‚®ä»¶çš„ IDï¼Œå¦‚æœä½ ä½¿ç”¨åŒä¸€ä¸ª ID å‘é€åŒä¸€å°é‚®ä»¶å¤šæ¬¡ï¼Œä»…æŠ•é€’ä¸€æ¬¡ã€‚â€&lt;/p&gt;
&lt;p&gt;é‚®ä»¶æœåŠ¡ä¸ºäº†å®ç°å®Œå¤‡çš„å¹‚ç­‰æ€§å°†ä¼šè®°ä½æ‰€æœ‰å‘é€è¿‡çš„é‚®ä»¶ IDã€‚ä½†æ˜¯é€šå¸¸è¿™æ˜¯ä¸åˆ‡å®é™…çš„ã€‚å› ä¸ºå½“æ•°é‡è¾¾åˆ°ä¸Šç™¾ä¸‡æ—¶ä½ æ— æ³•è®°ä½æ¯ä¸€ä¸ª IDã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºå¯èƒ½ä¼šè¿½æº¯åˆ°è®¸å¤šå¹´ä»¥å‰ï¼Œå¹¶ä¸”ä¸€ä¸ªè¯·æ±‚ä¸å¯èƒ½éœ€è¦ä»¥å¹´è®°æ‰èƒ½åˆ°è¾¾ã€‚æ‰€ä»¥å®é™…ä¸Šï¼Œä½ å¯èƒ½éœ€è¦ä¸€ä¸ªçª—å£ï¼Œå¦‚ï¼šâ€œæˆ‘ä»¬åªä¿ç•™ 3 å¤©çš„ IDâ€ã€‚ä¹Ÿå°±æ˜¯è¯´ä½ å¯ä»¥é€šè¿‡ç›¸åŒçš„ ID é‡å¤çš„å‘é€ä¸‰å¤©ä»¥å†…çš„é‚®ä»¶ï¼Œå¹¶ä¸”ä¸ä¼šäº§ç”Ÿç¬¬äºŒæ¬¡æŠ•é€’ã€‚åœ¨å®é™…åœºæ™¯ä¸­ï¼Œä½ éœ€è¦å¹³è¡¡å†…å­˜çš„éœ€æ±‚å’Œä½ ç³»ç»Ÿæ‰€å®ç°çš„å®‰å…¨é‡è¯•æœºåˆ¶æ¥æ¢ç´¢å®é™…çš„é™åˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;æ³¨æ„ï¼Œå”¯ä¸€æ€§çš„è¯†åˆ«ï¼ˆIDï¼‰éå¸¸é‡è¦ã€‚å¦‚æœæ²¡æœ‰å”¯ä¸€æ€§è¯†åˆ«ï¼ˆIDï¼‰çš„æ¦‚å¿µï¼Œé‚£ä¹ˆæ€ä¹ˆå®ç°åŒä¸€ä¸ªæ¶ˆæ¯å†æ¬¡å‘é€ï¼Ÿå¦‚æœæƒ³ç»™ä¸€ä¸ªäººå‘é€ä¸¤å°é‚®ä»¶ï¼Œæˆ‘éœ€è¦èƒ½å‘é€ä¸¤å°é‚®ä»¶ç»™ä»–ã€‚æˆ‘éœ€è¦ä¸€ç§æ–¹æ³•æ ‡å¿—ä¸¤å°é‚®ä»¶ä¸ç›¸åŒã€‚å¦‚æœæˆ‘æƒ³é‡è¯•ï¼Œæˆ‘éœ€è¦ä¸€ç§æ–¹æ³•æ ‡å¿—è¿™å°é‚®ä»¶å’Œé‚£å°é‚®ä»¶æ˜¯åŒä¸€ä¸ªã€‚&lt;/p&gt;
&lt;p&gt;ä½ çš„è¯·æ±‚éœ€è¦ä¸€äº› IDã€‚å‚ç…§ç”µæ¢¯æŒ‰é’®ï¼Œå¯èƒ½ ID å°±åœ¨ç”µæ¢¯æœåŠ¡çš„ç”µå­ç³»ç»Ÿå†…éƒ¨ï¼Œå®ƒçŸ¥é“æˆ‘æŒ‰çš„å“ªä¸ªæŒ‰é’®ï¼šæ˜¯ä¸‰æ¥¼å‘ä¸Šè¿˜æ˜¯å››æ¥¼å‘ä¸‹ã€‚æŒ‰é’®çš„ ID å¯ä»¥é¦–å…ˆè®©æŒ‰é’®äº®èµ·ï¼Œå¹¶ä¸”ä¿æŒåˆ°ä¸å†éœ€è¦åå†å…³é—­ã€‚&lt;/p&gt;
&lt;p&gt;ID å¯èƒ½ç”¨åœ¨å¤šä¸ªåœ°æ–¹ã€‚ç”¨åœ¨ä¸€ä¸ªè¯·æ±‚ä¸Šï¼šâ€œæˆ‘ä»¬éœ€è¦ç”µæ¢¯å‘ä¸Šåˆ°ä¸‰å±‚å› ä¸ºæˆ‘ä»¬çŸ¥é“é‚£ä¸ªæŒ‰é’®å’Œå®ƒçš„æ„ä¹‰â€ã€‚ä¹Ÿå¯ä»¥æ˜¯ï¼šâ€œæˆ‘å·²ç»å‘é€è¿‡äº†åˆ°ä¸‰å±‚ç”µæ¢¯çš„ä¿¡å·ï¼Œæˆ‘ä¸éœ€è¦å†æ¬¡å‘é€ã€‚â€ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€æ—¦ç¡®å®šäº† IDï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå·²ç»æ˜¯å¹‚ç­‰çš„æ•°æ®ç»“æ„çš„æ“ä½œï¼Œæ¯”å¦‚é›†åˆï¼ˆsetï¼‰ã€‚å¦‚æœä½ ç”¨ä¸€ä¸ªæ•°å­—é›†åˆå­˜å‚¨æ¯ä¸ªé‚®ä»¶çš„å”¯ä¸€æ•°å­— IDã€‚å½“é‚®ä»¶æœåŠ¡å‘é€å®Œé‚®ä»¶ï¼Œé€šè¿‡å°†æ•°å­— ID æ·»åŠ åˆ°é›†åˆç”¨ä»¥è®°å½•ã€‚å¦‚æœä½ æ·»åŠ åˆ°è¯¥é›†åˆä¸¤æ¬¡ï¼Œä½ å®é™…ä¸Šå·²ç»è·å¾—åˆ°å¹‚ç­‰æ€§ã€‚&lt;/p&gt;
&lt;p&gt;åŒç”µæ¢¯ä¸€æ ·ï¼Œå¦‚æœä½ æœ‰ä¸€ä¸ªæŒ‰é’®åŒ…å«æ¥å­—ç¬¦ä¸² IDï¼Œæ¯”å¦‚ &lt;code&gt;third-floor-up&lt;/code&gt; ã€ &lt;code&gt;third-floor-down&lt;/code&gt; ã€ &lt;code&gt;fourth-floor-up&lt;/code&gt; ã€ &lt;code&gt;fourth-floor-down&lt;/code&gt; , é€šè¿‡å°†è¿™äº› ID å­˜æ”¾åˆ°é›†åˆå†…è¡¨ç¤ºå¯¹åº”çš„æŒ‰é’®è¢«è¯·æ±‚è€Œæ¿€æ´»ã€‚è¿™ä¹Ÿå°±æ„å‘³ç€ä½ å¯ä»¥æŒ‰ä¸‹å¤šæ¬¡ï¼Œç¬¬äºŒæ¬¡å°†ä¸ä¼šäº§ç”Ÿä»»ä½•æ•ˆæœï¼ˆå‰¯ä½œç”¨ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç„¶ï¼Œç°åœ¨æ²¡æœ‰è€ƒè™‘æŒ‰ä¸‹æŒ‰é’®å°†ç”µæ¢¯é€åˆ°æŸä¸€å±‚çš„å®é™…çš„å®ç°ã€‚ä½†æ˜¯å’Œé‚®ä»¶ç›¸åŒï¼Œç°åœ¨çš„ç¡®è€ƒè™‘äº†å‘é€è¿˜æ˜¯ä¸å‘é€é‚®ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;è¦æƒ³å¾—çŸ¥ä½ æ˜¯å¦æƒ³è¦å‘é€å®ƒå…¶å®å¾ˆç®€å•ã€‚åœ¨æ·»åŠ æŸä¸€é¡¹ ID åˆ°é›†åˆä¸­ä¹‹å‰ï¼Œè¯¢é—®é›†åˆï¼šâ€œä½ æ˜¯å¦åŒ…å«è¿™ä¸ª ID ï¼Ÿâ€ã€‚å¦‚æœå·²ç»åŒ…å«åˆ™ç»“æŸæ“ä½œï¼Œå¦‚æœä¸åŒ…å«åˆ™å‘é€é‚®ä»¶å¹¶å°† ID æ·»åŠ åˆ°é›†åˆå†…ã€‚é™¤äº†é›†åˆè¿˜æœ‰ä¸€äº›å…¶ä»–çš„æ•°æ®ç»“æ„æ˜¯å¹‚ç­‰çš„ï¼Œæ¯”å¦‚å“ˆå¸Œè¡¨ã€‚&lt;/p&gt;
&lt;p&gt;å‰é¢æåˆ°çš„å°†å­—ç¬¦ä¸²ä¸­çš„å­—æ¯è½¬æ¢ä¸ºå¤§å†™ï¼Œè¿™æ˜¯ä¸€ç§å¹‚ç­‰çš„æ“ä½œã€‚&lt;/p&gt;
&lt;h3 id="_5"&gt;æ€»ç»“&lt;/h3&gt;
&lt;p&gt;è®©æˆ‘ä»¬æ¥æ¦‚æ‹¬ä¸€ä¸‹ã€‚å¹‚ç­‰æ„å‘³ç€é‡å¤æ— å…³ã€‚ä»–æ˜¯ä¸€ç§ä»£æ•°ä¸­å‡½æ•°å’Œæ“ä½œçš„å±æ€§ï¼Œä½†æ˜¯æˆ‘ä»¬å°†ä¹‹æ‰©å±•åˆ°ç°å®ä¸–ç•Œä¸­çš„ä¸€äº›è¡Œä¸ºã€‚åœ¨åˆ†å¸ƒå¼æ“ä½œç³»ç»Ÿä¸­æˆ‘ä»¬ä¹‹æ‰€ä»¥éœ€è¦å®ƒå› ä¸ºæˆ‘ä»¬éœ€è¦åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å®‰å…¨çš„é‡è¯•ã€‚å¹‚ç­‰è®©æˆ‘ä»¬ä»è¯·æ±‚æ¬¡æ•°å’Œè¯·æ±‚å®Œæˆè§£å¶å‡ºæ¥ã€‚ä½ å¯ä»¥å¾ˆå®¹æ˜“é€šè¿‡ä¸€äº›æ•°æ®ç»“æ„å’Œå¯¹åº”çš„æ“ä½œæ¥å®ç°ã€‚ä¸ºäº†å®ç°å¹‚ç­‰éœ€è¦æ¯ä¸€ä¸ªæ¶ˆæ¯éƒ½æœ‰ä¸€ä¸ª IDã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;å¿½ç•¥ä»¥ä¸‹å’Œä¸»é¢˜æ— å…³çš„ç¿»è¯‘ï¼š&lt;/p&gt;
&lt;p&gt;Do yourselves a favor and look for some services that need to happen exactly once. Could be something like sending an email. Could be writing a message to a log. Could be some user setting in your user-panel, and wrap them in something like a data structure that makes them idempotent.&lt;/p&gt;
&lt;p&gt;Do me a favor please and share this with friends. If you found it valuable, they might find it valuable, too. Also, if you found it valuable, you probably want to subscribe. That way youâ€™ll get all of the other new episodes as they come out. You wonâ€™t miss that value that you have already discovered.&lt;/p&gt;
&lt;p&gt;I like to be in deep discussions with smart people. Please email me. Iâ€™m eric@lispcast.com or get in a discussion on Twitter. I try to use Twitter as a discussion medium. Iâ€™m @ericnormand with a D there.&lt;/p&gt;
&lt;p&gt;Also, you can find me on LinkedIn. Iâ€™m trying to get better at LinkedIn. Itâ€™s a little hard for me. If thatâ€™s where you like to connect, letâ€™s connect and start having a conversation.&lt;/p&gt;
&lt;p&gt;All right. See you later.&lt;/p&gt;</content><category term="Tech"></category><category term="Idempotence"></category><category term="å¹‚ç­‰"></category></entry><entry><title>Python 3.8 æ–°å¢ multiprocessing.SharedMemory æ”¯æŒå…±äº«å†…å­˜</title><link href="https://www.linuxzen.com/python-38-shared-memory.html" rel="alternate"></link><published>2019-02-28T00:00:00+08:00</published><updated>2019-02-28T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2019-02-28:/python-38-shared-memory.html</id><summary type="html">&lt;p&gt;Python åœ¨ 2019-02-25 é‡Šå‡ºäº† 3.8 æ—©æœŸé¢„è§ˆç‰ˆ &lt;a href="https://www.python.org/downloads/release/python-380a2/"&gt;3.8.0a2&lt;/a&gt;ï¼Œå…¶ä¸­æ–°å¢äº† &lt;a href="https://docs.python.org/3.8/library/multiprocessing.shared_memory.html"&gt;multiprocessing.SharedMemory&lt;/a&gt; ç”¨ä»¥æ”¯æŒå…±äº«å†…å­˜ï¼Œå¤§å¤§æé«˜å¤šè¿›ç¨‹ä¹‹é—´é€šä¿¡æ•ˆç‡ã€‚ç®€å•çœ‹äº†ä¸€ä¸‹ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;Python åœ¨ 2019-02-25 é‡Šå‡ºäº† 3.8 æ—©æœŸé¢„è§ˆç‰ˆ &lt;a href="https://www.python.org/downloads/release/python-380a2/"&gt;3.8.0a2&lt;/a&gt;ï¼Œå…¶ä¸­æ–°å¢äº† &lt;a href="https://docs.python.org/3.8/library/multiprocessing.shared_memory.html"&gt;multiprocessing.SharedMemory&lt;/a&gt; ç”¨ä»¥æ”¯æŒå…±äº«å†…å­˜ï¼Œå¤§å¤§æé«˜å¤šè¿›ç¨‹ä¹‹é—´é€šä¿¡æ•ˆç‡ã€‚ç®€å•çœ‹äº†ä¸€ä¸‹å®ç°ä»£ç ä¸»è¦æ¶‰åŠå¦‚ä¸‹ Python æ¨¡å—&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å†…ç½®ç±»å‹ &lt;a href="https://docs.python.org/3.8/library/stdtypes.html?highlight=memoryview#memoryview"&gt;memoryview&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://docs.python.org/3.8/library/mmap.html"&gt;mmap&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åœ¨ POSIX å¹³å°ä¸‹å…±äº«å†…å­˜åˆ›å»ºè¿‡ç¨‹å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åŸºäº &lt;code&gt;tmpfs&lt;/code&gt; æ‰“å¼€æˆ–åˆ›å»ºå…·åï¼ˆæ–‡ä»¶åï¼‰çš„å…±äº«å†…å­˜ï¼Œå¾—åˆ°æ–‡ä»¶æè¿°ç¬¦&lt;/li&gt;
&lt;li&gt;é€šè¿‡ &lt;code&gt;mmap&lt;/code&gt; å°†æ–‡ä»¶æè¿°ç¬¦æ˜ å°„è¿›ç¨‹çš„å†…å­˜åœ°å€ç©ºé—´&lt;/li&gt;
&lt;li&gt;é€šè¿‡ &lt;code&gt;memoryview&lt;/code&gt; ç›´æ¥è®¿é—®ç»è¿‡ &lt;code&gt;mmap&lt;/code&gt; æ˜ å°„åçš„çš„å†…å­˜åœ°å€ç©ºé—´&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="_1"&gt;é”çš„é—®é¢˜&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;memoryview&lt;/code&gt; é€šè¿‡å¦‚ä¸‹æ–¹å¼ä½¿ç”¨ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;bytearray&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;b&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;aaa&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;memoryview&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;98&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="c1"&gt;# outputs: bytearray(b&amp;#39;baa&amp;#39;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å½“ä¸Šé¢ä»£ç æ‰§è¡Œ &lt;code&gt;m[0] = 98&lt;/code&gt; æ—¶å®é™…ä¸Šè°ƒç”¨çš„æ˜¯ C ä»£ç  &lt;a href="https://sourcegraph.com/github.com/python/cpython@23f4589b4b7c4a51950a87175ce7fb31b89c8532/-/blob/Objects/memoryobject.c#L2455:1"&gt;memory_ass_sub&lt;/a&gt;ï¼Œç„¶åè°ƒç”¨ &lt;a href="https://sourcegraph.com/github.com/python/cpython@23f4589b4b7c4a51950a87175ce7fb31b89c8532/-/blob/Objects/memoryobject.c#L1743:9"&gt;PACK_SINGLE&lt;/a&gt; é€šè¿‡ &lt;code&gt;memcpy&lt;/code&gt; è¦†ç›–æŒ‡é’ˆåŸæœ‰çš„å€¼ã€‚&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥ç›´æ¥æ“ä½œ &lt;code&gt;multiprocessing.SharedMemory&lt;/code&gt; ä¼šäº§ç”Ÿæ•°æ®ç«äº‰ï¼Œä¸åº”è¯¥ç›´æ¥ä½¿ç”¨ï¼Œåº”è¯¥ä½¿ç”¨ &lt;a href="https://docs.python.org/3.8/library/multiprocessing.html#multiprocessing.Value"&gt;multiprocessing.Value&lt;/a&gt; å’Œ &lt;a href="https://docs.python.org/3.8/library/multiprocessing.html#multiprocessing.Array"&gt;multiprocessing.Array&lt;/a&gt; è¿™ç§æ›´é«˜å±‚çš„æŠ½è±¡ï¼Œé”åœ¨è¿™ä¸€å±‚çº§å®ç°ã€‚&lt;/p&gt;
&lt;h2 id="_2"&gt;å‚è§&lt;/h2&gt;
&lt;p&gt;æ›´å¤šå…³äºå…±äº«å†…å­˜å‚è§ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://hustcat.github.io/shared-memory-tmpfs/"&gt;æµ…è°ˆ Linux å…±äº«å†…å­˜&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://man7.org/training/download/posix_shm_slides.pdf"&gt;POSIX Shared Memory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.ibm.com/developerworks/cn/linux/l-ipc/part5/index1.html"&gt;å…±äº«å†…å­˜ï¼ˆä¸Šï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.ibm.com/developerworks/cn/linux/l-ipc/part5/index2.html"&gt;å…±äº«å†…å­˜ï¼ˆä¸‹ï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;</content><category term="Python"></category><category term="Python"></category><category term="3.8"></category><category term="multiprocessing"></category><category term="å…±äº«"></category><category term="å†…å­˜"></category><category term="shared"></category><category term="memory"></category></entry><entry><title>è¯‘æ–‡ï¼šGo å†…å­˜åˆ†é…å™¨å¯è§†åŒ–æŒ‡å—</title><link href="https://www.linuxzen.com/go-memory-allocator-visual-guide.html" rel="alternate"></link><published>2019-02-23T00:00:00+08:00</published><updated>2019-02-23T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2019-02-23:/go-memory-allocator-visual-guide.html</id><summary type="html">&lt;p&gt;å½“æˆ‘ç¬¬ä¸€æ¬¡å¼€å§‹å°è¯•ç†è§£ Go è¯­è¨€çš„å†…å­˜åˆ†é…å™¨æ—¶ï¼Œæ•´ä¸ªè¿‡ç¨‹è®©æˆ‘æŠ“ç‹‚ã€‚ä¸€åˆ‡çœ‹èµ·æ¥éƒ½åƒä¸€ä¸ªç¥ç§˜çš„é»‘ç›’å­ã€‚å› ä¸ºå‡ ä¹æ‰€æœ‰ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;å½“æˆ‘ç¬¬ä¸€æ¬¡å¼€å§‹å°è¯•ç†è§£ Go è¯­è¨€çš„å†…å­˜åˆ†é…å™¨æ—¶ï¼Œæ•´ä¸ªè¿‡ç¨‹è®©æˆ‘æŠ“ç‹‚ã€‚ä¸€åˆ‡çœ‹èµ·æ¥éƒ½åƒä¸€ä¸ªç¥ç§˜çš„é»‘ç›’å­ã€‚å› ä¸ºå‡ ä¹æ‰€æœ‰æŠ€æœ¯é­”æ³•ï¼ˆtechnical wizardryï¼‰éƒ½éšè—åœ¨æŠ½è±¡ä¹‹ä¸‹ï¼Œæ‰€ä»¥ä½ éœ€è¦ä¸€å±‚ä¸€å±‚çš„å‰¥ç¦»æ‰èƒ½å»ç†è§£å®ƒã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å°†é€šè¿‡è¿™ç¯‡æ–‡ç« æ¥ä¸€å±‚å±‚çš„å‰¥ç¦»è¿™äº›ç»†èŠ‚ã€‚å¦‚æœä½ æƒ³å­¦ä¹ æ‰€æœ‰å…³äº Go å†…å­˜åˆ†é…å™¨çš„çŸ¥è¯†ï¼Œé‚£ä¹ˆè¿™ç¯‡æ–‡ç« æ­£é€‚åˆä½ ã€‚&lt;/p&gt;
&lt;h2 id="_1"&gt;ç‰©ç†å†…å­˜å’Œè™šæ‹Ÿå†…å­˜&lt;/h2&gt;
&lt;p&gt;æ¯ä¸€ä¸ªå†…å­˜åˆ†é…å™¨éƒ½éœ€è¦è¿è¡Œåœ¨ç”±åº•å±‚æ“ä½œç³»ç»Ÿç®¡ç†çš„è™šæ‹Ÿå†…å­˜ç©ºé—´ï¼ˆVirtual Memory Spaceï¼‰ä¹‹ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹å›¾æ˜¯ä¸€ä¸ªç‰©ç†å†…å­˜å•å…ƒï¼ˆPhysical Memory Cellï¼‰çš„ç®€è¦è¯´æ˜ï¼ˆéç²¾å‡†ï¼‰&lt;/p&gt;
&lt;p&gt;&lt;img alt="A simple illustration of a Physical Memory Cell" src="static/upload/go-memory-allocator-visual-guide/5c6f9646b9048569f7000001.png"&gt;&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªå†…å­˜å•å…ƒçš„æ¦‚è¿°ç»è¿‡å¤§å¤§ç®€åŒ–ä¹‹åæè¿°å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åœ°å€çº¿ï¼ˆAddress lineï¼‰ï¼ˆæ™¶ä½“ç®¡åšçš„å¼€å…³ï¼‰ç”¨äºè®¿é—®ç”µå®¹å™¨ï¼ˆæ•°æ®åˆ°æ•°æ®çº¿ï¼ˆData Linesï¼‰ï¼‰ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœåœ°å€çº¿æœ‰ç”µæµæµåŠ¨ï¼ˆæ˜¾å¼ä¸ºçº¢è‰²ï¼‰ï¼Œæ•°æ®çº¿å¯ä»¥å†™å…¥åˆ°ç”µå®¹å™¨ï¼Œæ‰€ä»¥ç”µå®¹å™¨å¸¦ç”µï¼Œé€»è¾‘å€¼è¡¨ç¤º â€œ1â€ã€‚&lt;/li&gt;
&lt;li&gt;å¦‚æœåœ°å€çº¿æ²¡æœ‰ç”µæµæµåŠ¨ï¼ˆæ˜¾å¼ä¸ºç»¿è‰²ï¼‰ï¼Œæ•°æ®çº¿ä¸å¯ä»¥å†™å…¥åˆ°ç”µå®¹å™¨ï¼Œæ‰€ä»¥ç”µå®¹å™¨ä¸å¸¦ç”µï¼Œé€»è¾‘å€¼è¡¨ç¤º â€œ0â€&lt;/li&gt;
&lt;li&gt;å½“ CPU éœ€è¦ä» RAM ä¸­â€œè¯»å–â€å€¼ï¼Œåˆ™é¡ºç€â€œåœ°å€çº¿ï¼ˆADDRESS LINEï¼‰â€ï¼ˆå…³é—­å¼€å…³ï¼‰å‘é€ä¸€ä¸ªç”µæµã€‚å¦‚æœç”µå®¹å™¨å¸¦ç”µï¼Œåˆ™ç”µæµæµå‘â€œæ•°æ®çº¿ï¼ˆDATA LINEï¼‰â€ï¼ˆå€¼ä¸º 1ï¼‰ï¼›å¦åˆ™æ²¡æœ‰ç”µæµæµå‘æ•°æ®çº¿ï¼Œæ‰€ä»¥ç”µå®¹å™¨ä¿æŒä¸å¸¦ç”µï¼ˆå€¼ä¸º 0ï¼‰ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸‹å›¾ç®€å•çš„æè¿° CPU å’Œç‰©ç†å†…å­˜å•å…ƒå¦‚ä½•äº¤äº’&lt;/p&gt;
&lt;p&gt;&lt;img alt="Simple Illustration of how a Physical Memory Cell interacts with CPU" src="static/upload/go-memory-allocator-visual-guide/5c6fa15bb9048569f7000002.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ•°æ®æ€»çº¿ï¼ˆData Busï¼‰&lt;/strong&gt;ï¼šç”¨äºåœ¨ CPU å’Œå†…å­˜ä¸­é—´ä¼ è¾“æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰ä¸€ç‚¹å…³äº&lt;strong&gt;åœ°å€çº¿ï¼ˆAddress lineï¼‰&lt;/strong&gt;å’Œ&lt;strong&gt;æŒ‰å­—èŠ‚å¯»å€ï¼ˆAddressable bytesï¼‰&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹å›¾æ˜¯ CPU å’Œç‰©ç†å†…å­˜ä¹‹é—´åœ°å€çº¿çš„è¯´æ˜&lt;/p&gt;
&lt;p&gt;&lt;img alt="Illustrative Representation of an Address Line between CPU and Physical Memory." src="static/upload/go-memory-allocator-visual-guide/5c6fa25eb9048569f7000003.png"&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;a href="https://zh.wikipedia.org/zh/%E5%8A%A8%E6%80%81%E9%9A%8F%E6%9C%BA%E5%AD%98%E5%8F%96%E5%AD%98%E5%82%A8%E5%99%A8"&gt;DRAM&lt;/a&gt; ä¸­çš„æ¯ä¸€ä¸ªå­—èŠ‚éƒ½åˆ†é…äº†ä¸€ä¸ªå”¯ä¸€çš„æ•°å­—æ ‡è¯†ç¬¦ï¼ˆåœ°å€ï¼‰ã€‚â€œ&lt;strong&gt;ç‰©ç†å­—èŠ‚ != åœ°å€çº¿çš„æ•°é‡ï¼ˆPhysical bytes present != Number of address lineï¼‰&lt;/strong&gt;â€ï¼ˆe.g. 16 ä½ Intel 8088ã€&lt;a href="https://zh.wikipedia.org/wiki/%E7%89%A9%E7%90%86%E5%9C%B0%E5%9D%80%E6%89%A9%E5%B1%95"&gt;PAE&lt;/a&gt;ï¼‰&lt;/li&gt;
&lt;li&gt;æ¯ä¸€ä¸ªâ€œåœ°å€çº¿â€å¯ä»¥å‘é€ 1-bit çš„å€¼ï¼Œç”¨äºè¡¨ç¤ºç»™å®šå­—èŠ‚åœ°å€ä¸­çš„â€œä¸€ä¸ªä½ï¼ˆSINGLE BITï¼‰â€&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬çš„ä¸Šé¢ç»™å‡ºçš„å›¾ä¸­ï¼Œæˆ‘ä»¬æœ‰ 32 ä¸ªåœ°å€çº¿ã€‚æ‰€ä»¥æ¯ä¸ª &lt;strong&gt;å­—èŠ‚ï¼ˆBYTEï¼‰&lt;/strong&gt; éƒ½æœ‰â€œ32 ä½â€ä½œä¸ºåœ°å€ã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;[ 00000000000000000000000000000000 ]&lt;/code&gt;â€Šâ€”â€Šä½å†…å­˜åœ°å€&lt;/li&gt;
&lt;li&gt;&lt;code&gt;[ 11111111111111111111111111111111 ]&lt;/code&gt;â€Šâ€”â€Šé«˜å†…å­˜åœ°å€&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç”±äºæˆ‘ä»¬æ¯å­—èŠ‚éƒ½æœ‰ä¸€ä¸ª 32 ä½çš„åœ°å€ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„åœ°å€ç©ºé—´åŒ…å« 2 çš„ 32 æ¬¡æ–¹ä¸ªå¯å¯»å€å­—èŠ‚ï¼ˆbytesï¼‰ï¼ˆ4GBï¼‰ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç»¼ä¸Šæ‰€è¿°ï¼Œå¯å¯»å€çš„å­—èŠ‚æ•°é‡å–å†³äºåœ°å€æ€»çº¿çš„æ•°é‡ï¼Œæ‰€ä»¥å¯¹äº 64 ä¸ªåœ°å€çº¿æœ€å¤§å¯å¯»å€ 2 çš„ 64 æ¬¡æ–¹ä¸ªå­—èŠ‚æ•°ï¼ˆ16 &lt;a href="https://zh.wikipedia.org/wiki/%E8%89%BE%E5%AD%97%E8%8A%82"&gt;EB&lt;/a&gt;ï¼‰ï¼Œä½†æ˜¯ç”±äºå¤§éƒ¨åˆ†æ¶æ„å®é™…ä¸Šä»…ä½¿ç”¨ 48-bit åœ°å€çº¿ï¼ˆAMDï¼‰å’Œ 42-bit åœ°å€çº¿ï¼ˆIntelï¼‰ä½œä¸º 64-bit æŒ‡é’ˆï¼Œæ‰€ä»¥ç†è®ºä¸Šå…è®¸ 256TB ç‰©ç†å†…å­˜ï¼ˆLinux åœ¨ x86-64 ä¸‹é€šè¿‡ &lt;a href="https://www.kernel.org/doc/Documentation/x86/x86_64/mm.txt"&gt;with 4 level page tables&lt;/a&gt; å…è®¸æ¯ä¸ªå¤„ç†å™¨ 128TB åœ°å€ç©ºé—´ï¼ŒWindows 192TBï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ç”±äºç‰©ç†å†…å­˜çš„å¤§å°æ˜¯å—é™åˆ¶çš„ï¼Œæ‰€ä»¥è¿›ç¨‹è¿è¡Œåœ¨è‡ªèº«çš„å†…å­˜æ²™ç›’å†… -- â€œè™šæ‹Ÿå†…å­˜åœ°å€ï¼ˆvirtual address spaceï¼‰â€ï¼Œç§°ä½œ &lt;strong&gt;è™šæ‹Ÿå†…å­˜ï¼ˆVirtual Memoryï¼‰&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å­—èŠ‚çš„åœ°å€åœ¨è¿™ä¸ªè™šæ‹Ÿåœ°å€ç©ºé—´å†…ä¸å†å’Œå¤„ç†å™¨æ”¾åœ¨åœ°å€æ€»çº¿ä¸Šçš„åœ°å€ç›¸åŒ&lt;/strong&gt;ã€‚å› æ­¤å¿…é¡»å»ºç«‹è½¬æ¢æ•°æ®ç»“æ„å’Œç³»ç»Ÿå°†è™šæ‹Ÿåœ°å€ç©ºé—´ä¸­çš„å­—èŠ‚æ˜ å°„åˆ°ç‰©ç†å­—èŠ‚ã€‚&lt;/p&gt;
&lt;p&gt;è™šæ‹Ÿåœ°å€è¡¨ç¤ºå‚è§ä¸‹å›¾ï¼ˆ&lt;code&gt;/proc/$PID/maps&lt;/code&gt;ï¼‰ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img alt="Virtual Address Space Representation" src="static/upload/go-memory-allocator-visual-guide/5c6fbf14b9048569f7000004.png"&gt;&lt;/p&gt;
&lt;p&gt;ç»¼ä¸Šæ‰€è¿°å½“ CPU æ‰§è¡Œä¸€ä¸ªæŒ‡ä»¤éœ€è¦å¼•ç”¨å†…å­˜åœ°å€æ—¶ã€‚é¦–å…ˆå°†åœ¨ VMAï¼ˆVirtual Memory Areasï¼‰ä¸­çš„é€»è¾‘åœ°å€è½¬æ¢ä¸ºçº¿æ€§åœ°å€ã€‚è¿™ä¸ªè½¬æ¢é€šè¿‡ &lt;a href="https://zh.wikipedia.org/wiki/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E5%8D%95%E5%85%83"&gt;MMU&lt;/a&gt; å®Œæˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="This is not a physical diagram, only a depiction. address translation process not included for simplicity" src="static/upload/go-memory-allocator-visual-guide/5c6fc2c1b9048569f7000005.png"&gt;&lt;/p&gt;
&lt;p&gt;ç”±äºé€»è¾‘åœ°å€å¤ªå¤§å‡ ä¹å¾ˆéš¾ç‹¬ç«‹çš„ç®¡ç†ï¼Œæ‰€ä»¥å¼•å…¥æœ¯è¯­ &lt;strong&gt;é¡µï¼ˆpagesï¼‰&lt;/strong&gt; è¿›è¡Œç®¡ç†ã€‚å½“å¿…è¦çš„åˆ†é¡µæ“ä½œè¢«æ¿€æ´»åï¼Œ&lt;strong&gt;è™šæ‹Ÿåœ°å€ç©ºé—´è¢«åˆ†æˆæ›´å°çš„ç§°ä½œé¡µçš„åŒºåŸŸ&lt;/strong&gt;ï¼ˆå¤§éƒ¨åˆ†æ“ä½œç³»ç»Ÿä¸‹æ˜¯ 4KBï¼Œå¯ä»¥ä¿®æ”¹ï¼‰ã€‚é¡µæ˜¯è™šæ‹Ÿå†…å­˜ä¸­æ•°æ®å†…å­˜ç®¡ç†çš„æœ€å°å•å…ƒã€‚è™šæ‹Ÿå†…å­˜ä¸å­˜å‚¨ä»»ä½•å†…å®¹ï¼Œåªæ˜¯ç®€å•çš„å°†ç¨‹åºåœ°å€ç©ºé—´æ˜ å°„åˆ°åº•å±‚ç‰©ç†å†…å­˜ä¹‹ä¸Šã€‚&lt;/p&gt;
&lt;p&gt;ç‹¬ç«‹çš„è¿›ç¨‹åªèƒ½ä½¿ç”¨ VMA  ä½œä¸ºä»–ä»¬çš„åœ°å€ã€‚&lt;strong&gt;æ‰€ä»¥å½“æˆ‘ä»¬çš„ç¨‹åºéœ€è¦æ›´å¤š â€œå †å†…å­˜ï¼ˆheap memoryï¼‰æ—¶å‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹å›¾æ˜¯ç®€å•çš„æ±‡ç¼–ä»£ç ç”¨äºåˆ†é…æ›´å¤šçš„å †å†…å­˜&lt;/p&gt;
&lt;p&gt;&lt;img alt="A simple assembly code asking for more heap memory." src="static/upload/go-memory-allocator-visual-guide/5c6fc4f9b9048569f7000006.png"&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹å›¾æè¿°å †å†…å­˜çš„å¢é•¿&lt;/p&gt;
&lt;p&gt;&lt;img alt="heap memory increment" src="static/upload/go-memory-allocator-visual-guide/5c6fc53bb9048569f7000007.png"&gt;&lt;/p&gt;
&lt;p&gt;åº”ç”¨ç¨‹åºé€šè¿‡ç³»ç»Ÿè°ƒç”¨ &lt;a href="http://man7.org/linux/man-pages/man2/brk.2.html"&gt;brk&lt;/a&gt;ï¼ˆ&lt;code&gt;sbrk&lt;/code&gt;/&lt;code&gt;mmap&lt;/code&gt; ç­‰ï¼‰è·å¾—å†…å­˜ã€‚å†…æ ¸ä»…æ›´æ–°å † VMA å¹¶è°ƒç”¨å®ƒã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å½“å‰æ—¶é—´ç‚¹å®é™…ä¸Šä¸åˆ†é…é¡µå¸§ä¸”æ–°é¡µåœ¨ç‰©ç†å†…å­˜ä¸­å¹¶ä¸å­˜åœ¨ã€‚è¿™ä¹Ÿæ˜¯ VSZ å’Œ RSS å¤§å°çš„ä¸åŒç‚¹ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="_2"&gt;å†…å­˜åˆ†é…å™¨&lt;/h2&gt;
&lt;p&gt;é€šè¿‡å¯¹â€œè™šæ‹Ÿåœ°å€ç©ºé—´â€åŸºæœ¬äº†è§£å’Œå®ƒå¯¹åœ¨å †åˆ†é…çš„æ„ä¹‰ï¼Œå†…å­˜åˆ†é…å™¨ç°åœ¨å˜å¾—æ›´åŠ å®¹æ˜“è§£é‡Šã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœå †ä¸Šæœ‰è¶³å¤Ÿçš„ç©ºé—´çš„æ»¡è¶³æˆ‘ä»¬ä»£ç çš„å†…å­˜ç”³è¯·ï¼Œå†…å­˜åˆ†é…å™¨å¯ä»¥å®Œæˆå†…å­˜ç”³è¯·æ— éœ€å†…æ ¸å‚ä¸ï¼Œå¦åˆ™å°†é€šè¿‡æ“ä½œç³»ç»Ÿè°ƒç”¨ï¼ˆ&lt;code&gt;brk&lt;/code&gt;ï¼‰è¿›è¡Œæ‰©å±•å †ï¼Œé€šå¸¸æ˜¯ç”³è¯·ä¸€å¤§å—å†…å­˜ã€‚ï¼ˆå¯¹äº &lt;code&gt;malloc&lt;/code&gt; å¤§é»˜è®¤æŒ‡çš„æ˜¯å¤§äº &lt;code&gt;MMAP_THRESHOLD&lt;/code&gt; ä¸ªå­—èŠ‚ - 128KBï¼‰ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ä½†æ˜¯ï¼Œå†…å­˜åˆ†é…å™¨é™¤äº†æ›´æ–° &lt;code&gt;brk address&lt;/code&gt; è¿˜æœ‰å…¶ä»–èŒè´£ã€‚å…¶ä¸­ä¸»è¦çš„ä¸€é¡¹å°±æ˜¯å¦‚ä½•&lt;strong&gt;å‡å°‘&lt;/strong&gt; &lt;code&gt;å†…éƒ¨ï¼ˆinternalï¼‰&lt;/code&gt;å’Œ&lt;code&gt;å¤–éƒ¨ï¼ˆexternalï¼‰&lt;/code&gt;ç¢ç‰‡å’Œå¦‚ä½•å¿«é€Ÿåˆ†é…å½“å‰å—ã€‚è€ƒè™‘æˆ‘ä»¬çš„ç¨‹åºä»¥ä¸²è¡Œçš„æ–¹å¼ï¼ˆp1 åˆ° p4ï¼‰é€šè¿‡ &lt;code&gt;malloc(size)&lt;/code&gt; å‡½æ•°ç”³è¯·ä¸€å—è¿ç»­çš„å†…å­˜ç„¶åé€šè¿‡ &lt;code&gt;free(pointer)&lt;/code&gt; å‡½æ•°è¿›è¡Œé‡Šæ”¾ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="An external fragmentation demonstration" src="static/upload/go-memory-allocator-visual-guide/5c6fcc0db9048569f7000008.png"&gt;&lt;/p&gt;
&lt;p&gt;åœ¨ p4 é˜¶æ®µç”±äºå†…å­˜ç¢ç‰‡åŒ–å³ä½¿æˆ‘ä»¬æœ‰è¶³å¤Ÿçš„å†…å­˜å—ä¾ç„¶æ— æ³•æ»¡è¶³ç”³è¯·çš„ 6 ä¸ªè¿ç»­çš„å†…å­˜å—ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ‰€ä»¥æˆ‘ä»¬è¯¥å¦‚ä½•å‡å°‘å†…å­˜ç¢ç‰‡åŒ–å‘¢&lt;/strong&gt; ï¼Ÿç­”æ¡ˆå–å†³æ˜¯ä½¿ç”¨å“ªç§å†…å­˜åˆ†é…ç®—æ³•ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨å“ªä¸ªåº•å±‚åº“ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å°†ç®€å•çœ‹ä¸€ä¸‹ä¸€ä¸ªå’Œ Go å†…å­˜åˆ†é…å™¨å»ºæ¨¡ç›¸è¿‘çš„å†…å­˜åˆ†é…å™¨ï¼š &lt;code&gt;TCMalloc&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h2 id="tcmalloc"&gt;TCMalloc&lt;/h2&gt;
&lt;p&gt;&lt;a href="http://goog-perftools.sourceforge.net/doc/tcmalloc.html"&gt;TCMalloc&lt;/a&gt; çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†å†…å­˜åˆ†ä¸ºå¤šä¸ªçº§åˆ«ç¼©å°é”çš„ç²’åº¦ã€‚åœ¨ TCMalloc å†…å­˜ç®¡ç†å†…éƒ¨åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼š&lt;strong&gt;çº¿ç¨‹å†…å­˜ï¼ˆthread memory)&lt;/strong&gt;å’Œ&lt;strong&gt;é¡µå †ï¼ˆpage heapï¼‰&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;h3 id="_3"&gt;çº¿ç¨‹å†…å­˜&lt;/h3&gt;
&lt;p&gt;æ¯ä¸€ä¸ªå†…å­˜é¡µéƒ½è¢«åˆ†ä¸ºå¤šä¸ªå›ºå®šåˆ†é…å¤§å°è§„æ ¼çš„ç©ºé—²åˆ—è¡¨ï¼ˆ&lt;code&gt;free list&lt;/code&gt;ï¼‰ ç”¨äºå‡å°‘ç¢ç‰‡åŒ–ã€‚è¿™æ ·æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½å¯ä»¥è·å¾—ä¸€ä¸ªç”¨äºæ— é”åˆ†é…å°å¯¹è±¡çš„ç¼“å­˜ï¼Œè¿™æ ·å¯ä»¥è®©å¹¶è¡Œç¨‹åºåˆ†é…å°å¯¹è±¡ï¼ˆ&amp;lt;=32KBï¼‰éå¸¸é«˜æ•ˆã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="Thread Cache (Each Thread gets this Thread Local Thread Cache)" src="static/upload/go-memory-allocator-visual-guide/5c6fd07bb9048569f7000009.png"&gt;&lt;/p&gt;
&lt;h3 id="_4"&gt;é¡µå †&lt;/h3&gt;
&lt;p&gt;TCMalloc ç®¡ç†çš„å †ç”±ä¸€ç»„é¡µç»„æˆï¼Œ&lt;strong&gt;ä¸€ç»„è¿ç»­çš„é¡µé¢è¢«è¡¨ç¤ºä¸º span&lt;/strong&gt;ã€‚å½“åˆ†é…çš„å¯¹è±¡å¤§äº 32KBï¼Œå°†ä½¿ç”¨é¡µå †ï¼ˆPage Heapï¼‰è¿›è¡Œå†…å­˜åˆ†é…ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="Page Heap (for span management)" src="static/upload/go-memory-allocator-visual-guide/5c6fd167b9048569f700000a.png"&gt;&lt;/p&gt;
&lt;p&gt;å½“æ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´åˆ†é…å°å¯¹è±¡åˆ™ä¼šåˆ°é¡µå †è·å–å†…å­˜ã€‚å¦‚æœé¡µå †é¡µæ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜ï¼Œåˆ™é¡µå †ä¼šå‘æ“ä½œç³»ç»Ÿç”³è¯·æ›´å¤šçš„å†…å­˜ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Note: å³ä½¿ Go çš„å†…å­˜åˆ†é…å™¨æœ€åˆæ˜¯åŸºäº TCMallocï¼Œä½†æ˜¯ç°åœ¨å·²ç»æœ‰å¾ˆå¤§çš„ä¸åŒã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="go"&gt;Go å†…å­˜åˆ†é…å™¨&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬çŸ¥é“ Go è¿è¡Œæ—¶ï¼ˆGo Runtimeï¼‰è°ƒåº¦å™¨åœ¨è°ƒåº¦æ—¶ä¼šå°† &lt;strong&gt;Goroutines(G)&lt;/strong&gt; ç»‘å®šåˆ° &lt;strong&gt;é€»è¾‘å¤„ç†å™¨ï¼ˆPï¼‰(Logical Processorsï¼‰&lt;/strong&gt; è¿è¡Œã€‚ç±»ä¼¼çš„ï¼ŒGo å®ç°çš„ TCMalloc å°†å†…å­˜é¡µï¼ˆMemory Pagesï¼‰åˆ†ä¸º 67 ç§ä¸åŒå¤§å°è§„æ ¼çš„å—ã€‚ &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;å¦‚æœä½ ä¸ç†Ÿæ‚‰ Go çš„è°ƒåº¦å™¨å¯ä»¥å…ˆå‚è§ã€Š&lt;a href="https://povilasv.me/go-scheduler/"&gt;
Go scheduler: Ms, Ps &amp;amp; Gs
&lt;/a&gt;ã€‹,ç„¶åç»§ç»­é˜…è¯»ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img alt="Size Classes in Go" src="static/upload/go-memory-allocator-visual-guide/5c6fd34eb9048569f700000b.png"&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœé¡µçš„è§„æ ¼å¤§å°ä¸º 1KB é‚£ä¹ˆ Go ç®¡ç†ç²’åº¦ä¸º &lt;strong&gt;8192B&lt;/strong&gt; å†…å­˜å°†è¢«åˆ‡åˆ†ä¸º 8 ä¸ªåƒä¸‹å›¾è¿™æ ·çš„å—ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="8 KB page divided into a size class of 1KB (In Go pages are maintained at the granularity of 8KB)" src="static/upload/go-memory-allocator-visual-guide/5c6fd4f7b9048569f700000c.png"&gt;&lt;/p&gt;
&lt;p&gt;Go ä¸­è¿™äº›é¡µé€šè¿‡ &lt;strong&gt;mspan&lt;/strong&gt; ç»“æ„ä½“è¿›è¡Œç®¡ç†ã€‚&lt;/p&gt;
&lt;h3 id="mspan"&gt;mspan&lt;/h3&gt;
&lt;p&gt;ç®€å•çš„è¯´ï¼Œ&lt;code&gt;mspan&lt;/code&gt; æ˜¯ä¸€ä¸ªåŒ…å«é¡µèµ·å§‹åœ°å€ã€é¡µçš„ span è§„æ ¼å’Œé¡µçš„æ•°é‡çš„åŒç«¯é“¾è¡¨ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="Illustrative Representation of a mspan in Go memory allocator" src="static/upload/go-memory-allocator-visual-guide/5c6fd878b9048569f700000d.png"&gt;&lt;/p&gt;
&lt;h3 id="mcache"&gt;mcache&lt;/h3&gt;
&lt;p&gt;Go åƒ TCMalloc ä¸€æ ·ä¸ºæ¯ä¸€ä¸ª &lt;strong&gt;é€»è¾‘å¤„ç†å™¨ï¼ˆPï¼‰ï¼ˆLogical Processorsï¼‰&lt;/strong&gt; æä¾›ä¸€ä¸ªæœ¬åœ°çº¿ç¨‹ç¼“å­˜ï¼ˆLocal Thread Cacheï¼‰ç§°ä½œ &lt;strong&gt;mcache&lt;/strong&gt;ï¼Œæ‰€ä»¥å¦‚æœ Goroutine éœ€è¦å†…å­˜å¯ä»¥ç›´æ¥ä» &lt;strong&gt;mcache&lt;/strong&gt; ä¸­è·å–ï¼Œç”±äºåœ¨åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ª Goroutine è¿è¡Œåœ¨ &lt;strong&gt;é€»è¾‘å¤„ç†å™¨ï¼ˆPï¼‰ï¼ˆLogical Processorsï¼‰&lt;/strong&gt; ä¸Šï¼Œæ‰€ä»¥ä¸­é—´ä¸éœ€è¦ä»»ä½•é”çš„å‚ä¸ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;mcache&lt;/strong&gt; åŒ…å«æ‰€æœ‰å¤§å°è§„æ ¼çš„ &lt;strong&gt;mspan&lt;/strong&gt; ä½œä¸ºç¼“å­˜ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="Illustrative Representation of a Relationship between P, mcache, and mspan in Go." src="static/upload/go-memory-allocator-visual-guide/5c6fda2eb9048569f700000e.png"&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç”±äºæ¯ä¸ª P éƒ½æ‹¥æœ‰å„è‡ªçš„ mcacheï¼Œæ‰€ä»¥ä» mcache åˆ†é…å†…å­˜æ— éœ€æŒæœ‰é”ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¯¹äºæ¯ä¸€ç§å¤§å°è§„æ ¼éƒ½æœ‰ä¸¤ä¸ªç±»å‹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;scan&lt;/strong&gt; -- åŒ…å«æŒ‡é’ˆçš„å¯¹è±¡ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;noscan&lt;/strong&gt; -- ä¸åŒ…å«æŒ‡é’ˆçš„å¯¹è±¡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é‡‡ç”¨è¿™ç§æ–¹æ³•çš„å¥½å¤„ä¹‹ä¸€å°±æ˜¯è¿›è¡Œåƒåœ¾å›æ”¶æ—¶ &lt;strong&gt;noscan&lt;/strong&gt; å¯¹è±¡æ— éœ€è¿›ä¸€æ­¥æ‰«ææ˜¯å¦å¼•ç”¨å…¶ä»–æ´»è·ƒçš„å¯¹è±¡ã€‚&lt;/p&gt;
&lt;h4 id="mcache_1"&gt;mcache çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;code&gt;&amp;lt;=32K&lt;/code&gt; å­—èŠ‚çš„å¯¹è±¡ç›´æ¥ä½¿ç”¨ç›¸åº”å¤§å°è§„æ ¼çš„ &lt;strong&gt;mspan&lt;/strong&gt; é€šè¿‡ &lt;code&gt;mcache&lt;/code&gt; åˆ†é…&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id="mcache_2"&gt;å½“ mcache æ²¡æœ‰å¯ç”¨ç©ºé—´æ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ&lt;/h4&gt;
&lt;p&gt;ä» &lt;strong&gt;mcentral&lt;/strong&gt; çš„ mspans åˆ—è¡¨è·å–ä¸€ä¸ªæ–°çš„æ‰€éœ€å¤§å°è§„æ ¼çš„ &lt;code&gt;mspan&lt;/code&gt;ã€‚&lt;/p&gt;
&lt;h3 id="mcentral"&gt;mcentral&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;mcentral&lt;/code&gt; å¯¹è±¡æ”¶é›†æ‰€æœ‰ç»™å®šè§„æ ¼å¤§å°çš„ spanã€‚æ¯ä¸€ä¸ª &lt;code&gt;mcentral&lt;/code&gt; éƒ½åŒ…å«ä¸¤ä¸ª mspan çš„åˆ—è¡¨ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;empty&lt;/strong&gt; mspanList -- æ²¡æœ‰ç©ºé—²å¯¹è±¡æˆ– span å·²ç»è¢« mcache ç¼“å­˜çš„ span åˆ—è¡¨&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;nonempty&lt;/strong&gt; mspanList -- æœ‰ç©ºé—²å¯¹è±¡çš„ span åˆ—è¡¨&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img alt="Illustrative Representation of a mcentral" src="static/upload/go-memory-allocator-visual-guide/5c6fdd13b9048569f700000f.png"&gt;&lt;/p&gt;
&lt;p&gt;æ¯ä¸€ä¸ª mcentral ç»“æ„ä½“éƒ½ç»´æŠ¤åœ¨ &lt;strong&gt;mheap&lt;/strong&gt; ç»“æ„ä½“å†…ã€‚&lt;/p&gt;
&lt;h3 id="mheap"&gt;mheap&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Go ä½¿ç”¨ mheap å¯¹è±¡ç®¡ç†å †ï¼Œåªæœ‰ä¸€ä¸ªå…¨å±€å˜é‡ã€‚æŒæœ‰è™šæ‹Ÿåœ°å€ç©ºé—´ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;img alt="Illustrative Representation of a mheap." src="static/upload/go-memory-allocator-visual-guide/5c6fdd76b9048569f7000010.png"&gt;&lt;/p&gt;
&lt;p&gt;å°±ä¸Šæˆ‘ä»¬ä»ä¸Šå›¾çœ‹åˆ°çš„ï¼š&lt;strong&gt;mheap å­˜å‚¨äº† mcentral çš„æ•°ç»„&lt;/strong&gt;ã€‚&lt;strong&gt;è¿™ä¸ªæ•°ç»„åŒ…å«äº†å„ä¸ªçš„ span çš„ mcentral&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nx"&gt;central&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;numSpanClasses&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="kd"&gt;struct&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nx"&gt;mcentral&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;mcentral&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nx"&gt;pad&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;sys&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;CacheLineSize&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;unsafe&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;Sizeof&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;mcentral&lt;/span&gt;&lt;span class="p"&gt;{})&lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="nx"&gt;sys&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;CacheLineSize&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="kt"&gt;byte&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;blockquote&gt;
&lt;p&gt;ç”±äºæˆ‘ä»¬æœ‰å„ä¸ªè§„æ ¼çš„ span çš„ mcentralï¼Œå½“ä¸€ä¸ª &lt;strong&gt;mcache&lt;/strong&gt; ä» mcentral ç”³è¯· &lt;strong&gt;mspan&lt;/strong&gt; æ—¶ï¼Œåªéœ€è¦åœ¨ç‹¬ç«‹çš„ &lt;strong&gt;mcentral&lt;/strong&gt; çº§åˆ«ä¸­ä½¿ç”¨é”ï¼Œæ‰€ä»¥å…¶å®ƒä»»ä½• &lt;strong&gt;mcache&lt;/strong&gt; åœ¨åŒä¸€æ—¶é—´ç”³è¯·ä¸åŒå¤§å°è§„æ ¼çš„ &lt;strong&gt;mspan&lt;/strong&gt; å°†äº’ä¸å—å½±å“å¯ä»¥æ­£å¸¸ç”³è¯·ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;å¯¹é½å¡«å……ï¼ˆPaddingï¼‰ç”¨äºç¡®ä¿ mcentrals ä»¥ &lt;em&gt;CacheLineSize&lt;/em&gt; ä¸ªå­—èŠ‚æ•°åˆ†éš”ï¼Œæ‰€ä»¥æ¯ä¸€ä¸ª &lt;em&gt;MCentral.lock&lt;/em&gt; éƒ½å¯ä»¥è·å–è‡ªå·±çš„ç¼“å­˜è¡Œï¼ˆcache lineï¼‰ï¼Œä»¥é¿å…&lt;a href="https://en.wikipedia.org/wiki/False_sharing"&gt;ä¼ªå…±äº«ï¼ˆfalse sharingï¼‰&lt;/a&gt;é—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;å½“ &lt;strong&gt;mcentral&lt;/strong&gt; åˆ—è¡¨ç©ºçš„æ—¶å€™ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ&lt;strong&gt;mcentral&lt;/strong&gt; ä» &lt;strong&gt;mheap&lt;/strong&gt; è·å–ä¸€ç³»åˆ—é¡µç”¨äºéœ€è¦çš„å¤§å°è§„æ ¼çš„ spanã€‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;free[_MaxMHeapList]mSpanList&lt;/strong&gt;ï¼šä¸€ä¸ª &lt;code&gt;spanList&lt;/code&gt; æ•°ç»„ã€‚æ¯ä¸€ä¸ª &lt;code&gt;spanList&lt;/code&gt; ä¸­çš„ &lt;strong&gt;mspan&lt;/strong&gt; åŒ…å« 1 ~ 127ï¼ˆ_MaxMHeapList - 1ï¼‰ä¸ªé¡µã€‚ä¾‹å¦‚ï¼Œ&lt;code&gt;free[3]&lt;/code&gt; æ˜¯ä¸€ä¸ªåŒ…å« 3 ä¸ªé¡µçš„ &lt;strong&gt;mspan&lt;/strong&gt; é“¾è¡¨ã€‚&lt;code&gt;free&lt;/code&gt; è¡¨ç¤º &lt;code&gt;free list&lt;/code&gt;ï¼Œè¡¨ç¤ºæœªåˆ†é…ã€‚å¯¹åº” &lt;code&gt;busy list&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;freelarge mSpanList&lt;/strong&gt;ï¼šä¸€ä¸ª &lt;strong&gt;mspan&lt;/strong&gt; çš„åˆ—è¡¨ã€‚æ¯ä¸€ä¸ªå…ƒç´ (mspan)çš„é¡µæ•°å¤§äº 127ã€‚é€šè¿‡ &lt;code&gt;mtreap&lt;/code&gt; ç»“æ„ä½“ç®¡ç†ã€‚å¯¹åº” &lt;code&gt;busylarge&lt;/code&gt;ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;å¤§äº 32K çš„å¯¹è±¡è¢«å®šä¹‰ä¸ºå¤§å¯¹è±¡ï¼Œç›´æ¥é€šè¿‡ mheap åˆ†é…ã€‚è¿™äº›å¤§å¯¹è±¡çš„ç”³è¯·æ˜¯ä»¥ä¸€ä¸ªå…¨å±€é”ä¸ºä»£ä»·çš„ï¼Œå› æ­¤ä»»ä½•ç»™å®šçš„æ—¶é—´ç‚¹åªèƒ½åŒæ—¶ä¾›ä¸€ä¸ª P ç”³è¯·ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="_5"&gt;å¯¹è±¡åˆ†é…æµç¨‹&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;å¤§äº 32K çš„å¤§å¯¹è±¡ç›´æ¥ä» &lt;strong&gt;mheap&lt;/strong&gt; åˆ†é…ã€‚&lt;/li&gt;
&lt;li&gt;å°äº 16B çš„ä½¿ç”¨ &lt;strong&gt;mcache&lt;/strong&gt; çš„å¾®å‹åˆ†é…å™¨åˆ†é…&lt;/li&gt;
&lt;li&gt;å¯¹è±¡å¤§å°åœ¨ 16B ~ 32K ä¹‹é—´çš„çš„ï¼Œé¦–å…ˆé€šè¿‡è®¡ç®—ä½¿ç”¨çš„å¤§å°è§„æ ¼ï¼Œç„¶åä½¿ç”¨ &lt;strong&gt;mcache&lt;/strong&gt; ä¸­å¯¹åº”å¤§å°è§„æ ¼çš„å—åˆ†é…&lt;/li&gt;
&lt;li&gt;å¦‚æœå¯¹åº”çš„å¤§å°è§„æ ¼åœ¨ &lt;strong&gt;mcache&lt;/strong&gt; ä¸­æ²¡æœ‰å¯ç”¨çš„å—ï¼Œåˆ™å‘ &lt;strong&gt;mcentral&lt;/strong&gt; ç”³è¯·&lt;/li&gt;
&lt;li&gt;å¦‚æœ &lt;strong&gt;mcentral&lt;/strong&gt; ä¸­æ²¡æœ‰å¯ç”¨çš„å—ï¼Œåˆ™å‘ &lt;strong&gt;mheap&lt;/strong&gt; ç”³è¯·ï¼Œå¹¶&lt;strong&gt;æ ¹æ® BestFit ç®—æ³•æ‰¾åˆ°æœ€åˆé€‚çš„ mspan&lt;/strong&gt;ã€‚å¦‚æœç”³è¯·åˆ°çš„ &lt;strong&gt;mspan&lt;/strong&gt; è¶…å‡ºç”³è¯·å¤§å°ï¼Œå°†ä¼šæ ¹æ®éœ€æ±‚è¿›è¡Œåˆ‡åˆ†ï¼Œä»¥è¿”å›ç”¨æˆ·æ‰€éœ€çš„é¡µæ•°ã€‚å‰©ä½™çš„é¡µæ„æˆä¸€ä¸ªæ–°çš„ &lt;strong&gt;mspan&lt;/strong&gt; æ”¾å› &lt;strong&gt;mheap&lt;/strong&gt; çš„ç©ºé—²åˆ—è¡¨ã€‚&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;å¦‚æœ &lt;strong&gt;mheap&lt;/strong&gt; ä¸­æ²¡æœ‰å¯ç”¨ spanï¼Œåˆ™å‘æ“ä½œç³»ç»Ÿç”³è¯·ä¸€ç³»åˆ—æ–°çš„é¡µï¼ˆæœ€å° 1MBï¼‰ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä½†æ˜¯ Go ä¼šåœ¨æ“ä½œç³»ç»Ÿåˆ†é…è¶…å¤§çš„é¡µï¼ˆç§°ä½œ arenaï¼‰ã€‚åˆ†é…ä¸€å¤§æ‰¹é¡µä¼šå‡å°‘å’Œæ“ä½œç³»ç»Ÿé€šä¿¡çš„æˆæœ¬ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;æ‰€æœ‰åœ¨å †ä¸Šçš„å†…å­˜ç”³è¯·éƒ½æ¥è‡ª arena&lt;/strong&gt;ã€‚è®©æˆ‘ä»¬çœ‹çœ‹ arena æ˜¯ä»€ä¹ˆã€‚&lt;/p&gt;
&lt;h2 id="go_1"&gt;Go è™šæ‹Ÿå†…å­˜&lt;/h2&gt;
&lt;p&gt;è®©æˆ‘ä»¬çœ‹ä¸€ä¸ªç®€å•çš„ Go ç¨‹åºçš„å†…å­˜æƒ…å†µ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kd"&gt;func&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img alt="process stats for a program" src="static/upload/go-memory-allocator-visual-guide/5c6fefc5b9048569f7000011.png"&gt;&lt;/p&gt;
&lt;p&gt;ä»ä¸Šé¢å¯ä»¥å³ä½¿æ˜¯ä¸€ä¸ªç®€å•çš„ç¨‹åºè™šæ‹Ÿç©ºé—´å ç”¨é¡µå¤§æ¦‚ &lt;code&gt;~100MB&lt;/code&gt; å·¦å³ï¼Œä½†æ˜¯ RSS ä»…ä»…å ç”¨ &lt;code&gt;696KB&lt;/code&gt;ã€‚è®©æˆ‘ä»¬å…ˆææ¸…æ¥šè¿™ä¹‹é—´çš„å·®å¼‚ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="map and smap stats." src="static/upload/go-memory-allocator-visual-guide/5c6ff023b9048569f7000012.png"&gt;&lt;/p&gt;
&lt;p&gt;è¿™é‡Œæœ‰ä¸€å—å†…å­˜åŒºåŸŸå¤§å°åœ¨ ~ &lt;code&gt;2MB&lt;/code&gt;ã€&lt;code&gt;64MB&lt;/code&gt; å’Œ &lt;code&gt;32MB&lt;/code&gt;ã€‚è¿™äº›æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/p&gt;
&lt;h3 id="arena"&gt;Arena&lt;/h3&gt;
&lt;p&gt;äº‹å®è¯æ˜ Go çš„è™šæ‹Ÿå†…å­˜å¸ƒå±€ä¸­åŒ…å«ä¸€ç³»åˆ— &lt;strong&gt;arenas&lt;/strong&gt;ã€‚åˆå§‹çš„å †æ˜ å°„æ˜¯ä¸€ä¸ª &lt;strong&gt;arena&lt;/strong&gt;ï¼Œå¦‚ &lt;code&gt;64MB&lt;/code&gt;ï¼ˆåŸºäº go 1.11.5ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="current incremental arena size on a different system." src="static/upload/go-memory-allocator-visual-guide/5c6ff112b9048569f7000013.png"&gt;&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å½“å‰å†…å­˜æ ¹æ®æˆ‘ä»¬çš„ç¨‹åºéœ€è¦ä»¥å°å¢é‡æ˜ å°„ï¼Œå¹¶ä¸”åˆå§‹äºä¸€ä¸ª arenaï¼ˆ~64MBï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;è¯·é¦–å…ˆè®°ä½è¿™äº›æ•°å­—ã€‚ä¸»é¢˜å¼€å§‹æ”¹å˜ã€‚æ—©æœŸ Go éœ€è¦é¢„å…ˆä¿ç•™ä¸€ä¸ªè¿ç»­çš„è™šæ‹Ÿåœ°å€ï¼Œåœ¨ä¸€ä¸ª 64-bit çš„ç³»ç»Ÿ arena çš„å¤§å°æ˜¯ 512GBã€‚ï¼ˆå¦‚æœåˆ†é…çš„è¶³å¤Ÿå¤§ä¸” &lt;strong&gt;è¢« mmap æ‹’ç»&lt;/strong&gt; ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿï¼‰&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;è¿™äº› arenas å°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„å †&lt;/strong&gt;ã€‚åœ¨ Go ä¸­æ¯ä¸€ä¸ª arena éƒ½ä»¥ &lt;code&gt;8192B&lt;/code&gt; çš„ç²’åº¦çš„é¡µè¿›è¡Œç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹å›¾è¡¨ç¤ºä¸€ä¸ª 64MB çš„ arena&lt;/p&gt;
&lt;p&gt;&lt;img alt="Single arena ( 64 MB )." src="static/upload/go-memory-allocator-visual-guide/5c701deab9048569f7000014.png"&gt;&lt;/p&gt;
&lt;p&gt;Go åŒæ—¶å­˜åœ¨å…¶ä»–ä¸¤ä¸ªå—ï¼š&lt;strong&gt;span&lt;/strong&gt; å’Œ &lt;strong&gt;bitmap&lt;/strong&gt;ã€‚&lt;strong&gt;ä¸¤è€…éƒ½åœ¨å †å¤–åˆ†é…å¹¶ä¸”åŒ…å«æ¯ä¸ª arena çš„å…ƒæ•°æ®&lt;/strong&gt;ã€‚å¤§å¤šç”¨äºåƒåœ¾å›æ”¶æœŸé—´ï¼ˆæ‰€ä»¥æˆ‘ä»¬å°±è®¨è®ºåˆ°è¿™ï¼‰ã€‚&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;åœ¨æˆ‘ä»¬åˆšåˆšè®¨è®ºçš„ Go çš„å†…å­˜åˆ†é…ç­–ç•¥ç§ç±»é‡Œï¼Œåªæ¶‰åŠåˆ°å†…å­˜åˆ†é…å¥‡å¦™ä¸”å¤šæ ·æ€§çš„å†°å±±ä¸€è§’ã€‚&lt;/p&gt;
&lt;p&gt;ç„¶è€Œï¼ŒGo å†…å­˜ç®¡ç†çš„ä¸€èˆ¬æ€æƒ³æ˜¯ä½¿ç”¨ä¸åŒçš„å†…å­˜ç»“æ„ä¸ºä¸åŒå¤§å°çš„å¯¹è±¡ä½¿ç”¨ä¸åŒçš„å†…å­˜ç¼“å­˜çº§åˆ«æ¥åˆ†é…å†…å­˜ã€‚å°†ä¸€ä¸ªä»æ“ä½œç³»ç»Ÿæ¥æ”¶çš„è¿ç»­åœ°å€çš„å—åˆ‡åˆ†åˆ°å¤šçº§ç¼“å­˜æ¥å‡å°‘é”çš„ä½¿ç”¨ï¼ŒåŒæ—¶æ ¹æ®æŒ‡å®šçš„å¤§å°åˆ†é…å†…å­˜å‡å°‘å†…å­˜ç¢ç‰‡ä»¥æé«˜å†…å­˜åˆ†é…çš„æ•ˆç‡å’Œåœ¨å†…å­˜é‡Šæ”¾ä¹‹ååŠ å¿« GC è¿è¡Œçš„é€Ÿåº¦ã€‚&lt;/p&gt;
&lt;p&gt;ç°åœ¨æˆ‘ä»¬å°†é€šè¿‡ä¸‹å›¾ç»“æŸ Go å†…å­˜åˆ†é…å¯è§†åŒ–æŒ‡å—ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img alt="Visual Overview of Runtime Memory Allocator." src="static/upload/go-memory-allocator-visual-guide/5c70206cb9048569f7000015.png"&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;ç¿»è¯‘å‚è€ƒï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://share.onlinesjtu.com/mod/tab/view.php?id=253"&gt;æ€»çº¿å†…éƒ¨ç»“æ„&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://zh.wikipedia.org/zh/%E5%8A%A8%E6%80%81%E9%9A%8F%E6%9C%BA%E5%AD%98%E5%8F%96%E5%AD%98%E5%82%A8%E5%99%A8"&gt;DRAM&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://zh.wikipedia.org/wiki/%E7%89%A9%E7%90%86%E5%9C%B0%E5%9D%80%E6%89%A9%E5%B1%95"&gt;PAE&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.wikiwand.com/en/Byte_addressing"&gt;Byte addressing&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.csie.ntu.edu.tw/~wcchen/asm98/asm/proj/b85506061/chap2/overview.html"&gt;å†…å­˜ç®¡ç†&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;ul&gt;
&lt;li&gt;åŸæ–‡é“¾æ¥ &lt;a href="https://blog.learngoprogramming.com/a-visual-guide-to-golang-memory-allocator-from-ground-up-e132258453ed"&gt;A visual guide to Go Memory Allocator from scratch (Golang)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;GitHub åœ°å€ï¼š&lt;a href="https://github.com/coldnight/go-memory-allocator-visual-guide"&gt;go-memory-allocator-visual-guide&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="Go"></category><category term="Go"></category><category term="memory"></category><category term="allocator"></category></entry><entry><title>ã€Šæ•æ·é©å‘½ã€‹è¯»ä¹¦ç¬”è®°</title><link href="https://www.linuxzen.com/scrum-read-notes.html" rel="alternate"></link><published>2019-02-15T00:00:00+08:00</published><updated>2019-02-15T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2019-02-15:/scrum-read-notes.html</id><summary type="html">&lt;div class="section" id="section-2"&gt;
&lt;h2&gt;åŸºæœ¬è¿‡ç¨‹&lt;/h2&gt;
&lt;div class="section" id="section-3"&gt;
&lt;h3&gt;å‡†å¤‡&lt;/h3&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;æŒ‘é€‰ä¸€ä½ &lt;strong&gt;äº§å“è´Ÿè´£äººï¼ˆProduct Ownerï¼‰&lt;/strong&gt; ï¼šè´Ÿè´£æ²Ÿé€šå®¢æˆ·å¹¶æ ¹æ®å®¢æˆ·åé¦ˆè§„åˆ’å¾…åŠäº‹é¡¹&lt;/li&gt;
&lt;li&gt;æŒ‘é€‰ &lt;strong&gt;å›¢é˜Ÿ&lt;/strong&gt; ï¼šå°è€Œç²¾ï¼Œ3 ~ 9 äºº&lt;/li&gt;
&lt;li&gt;æŒ‘é€‰ &lt;strong&gt;Scrum ä¸» â€¦&lt;/strong&gt;&lt;/li&gt;&lt;/ol&gt;&lt;/div&gt;&lt;/div&gt;</summary><content type="html">&lt;div class="section" id="section-2"&gt;
&lt;h2&gt;åŸºæœ¬è¿‡ç¨‹&lt;/h2&gt;
&lt;div class="section" id="section-3"&gt;
&lt;h3&gt;å‡†å¤‡&lt;/h3&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;æŒ‘é€‰ä¸€ä½ &lt;strong&gt;äº§å“è´Ÿè´£äººï¼ˆProduct Ownerï¼‰&lt;/strong&gt; ï¼šè´Ÿè´£æ²Ÿé€šå®¢æˆ·å¹¶æ ¹æ®å®¢æˆ·åé¦ˆè§„åˆ’å¾…åŠäº‹é¡¹&lt;/li&gt;
&lt;li&gt;æŒ‘é€‰ &lt;strong&gt;å›¢é˜Ÿ&lt;/strong&gt; ï¼šå°è€Œç²¾ï¼Œ3 ~ 9 äºº&lt;/li&gt;
&lt;li&gt;æŒ‘é€‰ &lt;strong&gt;Scrum ä¸»ç®¡ï¼ˆScrum Masterï¼‰&lt;/strong&gt; ï¼šåŸ¹è®­ Scrum ç¡®ä¿ Scrum æ­£ç¡®è¿ç”¨ï¼Œæ¶ˆé™¤å›¢é˜Ÿéšœç¢&lt;/li&gt;
&lt;li&gt;ç¡®å®š &lt;strong&gt;å†²åˆºï¼ˆSprintï¼‰&lt;/strong&gt; å‘¨æœŸï¼Œä¸è¦è¶…è¿‡ä¸€ä¸ªæœˆï¼Œæœ€å¥½ 1 ~ 2 å‘¨&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="section-4"&gt;
&lt;h3&gt;æ‰§è¡Œ&lt;/h3&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;äº§å“è´Ÿè´£äººæ‹Ÿå®š &lt;strong&gt;å¾…åŠäº‹é¡¹&lt;/strong&gt; ï¼Œå¹¶ç¡®å®šä¼˜å…ˆçº§&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;è®©å®é™…å¼€å‘çš„å›¢é˜Ÿè¯„ä¼°å’Œæ”¹è¿›å¾…åŠäº‹é¡¹&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;é€šè¿‡ &lt;strong&gt;å†²åˆºè§„åˆ’ä¼š&lt;/strong&gt; è§„åˆ’æ¥ä¸‹æ¥ä¸€ä¸ªå†²åˆºè¦å®Œæˆçš„å¾…åŠäº‹é¡¹ï¼Œå¹¶å°†å€ŸåŠ© &lt;strong&gt;çœ‹æ¿&lt;/strong&gt; å·¥å…·å°†å·¥ä½œé€æ˜åŒ–&lt;/p&gt;
&lt;p&gt;çœ‹æ¿å¯åˆ†ä¸ºå¦‚ä¸‹å‡ ä¸ªé¡¹ï¼š&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;To do    -- å½“å‰å†²åˆºéœ€è¦å®Œæˆçš„ä»»åŠ¡&lt;/li&gt;
&lt;li&gt;In progress -- å½“å‰å†²åˆºæ­£åœ¨è¿›è¡Œçš„ä»»åŠ¡&lt;/li&gt;
&lt;li&gt;Done  -- å½“å‰å†²åˆºå·²ç»å®Œæˆçš„ä»»åŠ¡&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;å†²åˆºå¼€å§‹åéœ€è¦è¿›è¡Œ &lt;strong&gt;æ¯æ—¥ç«™ä¼š&lt;/strong&gt; ï¼Œæ—¶é—´ä¸åº”é«˜è¿‡ 15 åˆ†é’Ÿï¼ŒScrum ä¸»ç®¡å‘å›¢é˜Ÿæˆå‘˜æå‡ºä¸‹åˆ—é—®é¢˜&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;è·ç¦»ä¸Šæ¬¡ç«™ä¼šä¹‹ååˆ°ç°åœ¨ä½ åšäº†ä»€ä¹ˆå»å¸®åŠ©å›¢é˜Ÿå®Œæˆå†²åˆº&lt;/li&gt;
&lt;li&gt;è·ç¦»ç°åœ¨åˆ°ä¸‹æ¬¡ç«™ä¼šä¹‹å‰ä½ æ‰“ç®—åšä»€ä¹ˆå»å¸®åŠ©å›¢é˜Ÿå®Œæˆå†²åˆº&lt;/li&gt;
&lt;li&gt;ä»€ä¹ˆå› ç´ é˜»ç¢äº†å›¢é˜Ÿå®Œæˆå†²åˆº&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç«™ä¼šåº”åœ¨æ¯å¤©çš„å›ºå®šæ—¶é—´ç‚¹ï¼Œå›¢é˜Ÿæ‰€æœ‰æˆå‘˜å¿…é¡»å‡†ç‚¹å‚åŠ ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;æ¯æ¬¡å†²åˆºç»“æŸä¹‹å‰å±•ç¤º &lt;strong&gt;å†²åˆºæˆæœ&lt;/strong&gt; ï¼Œé¢å‘å±•ç¤ºçš„å¯¹è±¡ä¸»è¦åŒ…æ‹¬ï¼šåˆ©ç›Šç›¸å…³è€…ã€ç®¡ç†äººå‘˜ä¸å®¢æˆ·&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="section-5"&gt;
&lt;h3&gt;å›é¡¾&lt;/h3&gt;
&lt;p&gt;æ¯æ¬¡å†²åˆºç»“æŸä¹‹åä¸‹ä¸€ä¸ªå†²åˆºå¼€å§‹ä¹‹å‰è¦ä¸¾è¡Œ &lt;strong&gt;å†²åˆºå›é¡¾ä¼šè®®&lt;/strong&gt; ï¼Œä¼šè®®ä¸»è¦è®¨è®ºä»¥ä¸‹å†…å®¹ï¼š&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;å±•ç¤ºä¹‹å‰å†²åˆºä¸­åˆ›é€ çš„æˆæœ&lt;/li&gt;
&lt;li&gt;æ€»ç»“å†²åˆºä¸­å“ªäº›åšçš„å¥½ï¼Œå“ªäº›éœ€è¦åšçš„æ›´å¥½ï¼Œæ‰¾å‡ºçœŸæ­£çš„éšœç¢å¹¶æ‹¿å‡ºå‹‡æ°”å°†éšœç¢æ‘†åœ¨å°é¢ä¸Š&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ç¡®å®šä¸€ä¸ªæœ€å€¼å¾—æ”¹å–„çš„åœ°æ–¹ï¼Œå°†å…¶è®¾å®šä¸ºä¸‹ä¸€ä¸ªå†²åˆºçš„é¦–è¦ä»»åŠ¡ï¼ˆå…³é”®ï¼‰&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;è®¡ç®—å¿«ä¹æŒ‡æ ‡ï¼ˆè§ä¸‹æ–‡é‡åŒ–å¿«ä¹ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="section-6"&gt;
&lt;h3&gt;ä¸‹ä¸€ä¸ªå†²åˆº&lt;/h3&gt;
&lt;p&gt;ä¸Šä¸€ä¸ªå†²åˆºç»“æŸåï¼Œç«‹å³å¼€å§‹æ–°çš„å†²åˆºã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="section-7"&gt;
&lt;h3&gt;è¾…åŠ©å·¥å…·&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://zh.wikipedia.org/wiki/%E7%9C%8B%E6%9D%BF_(%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91)"&gt;çœ‹æ¿&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://zh.wikipedia.org/wiki/%E7%87%83%E5%B0%BD%E5%9B%BE"&gt;ç‡ƒå°½å›¾&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="section-8"&gt;
&lt;h2&gt;ä¼ è¾¾çš„ç†å¿µ&lt;/h2&gt;
&lt;div class="section" id="section-9"&gt;
&lt;h3&gt;èŠ‚å¥&lt;/h3&gt;
&lt;p&gt;Scrum æµç¨‹çš„æ ¸å¿ƒæ˜¯èŠ‚å¥ï¼Œæ¯å¤©å‡†ç‚¹çš„ç«™ä¼šï¼Œå›ºå®šå‘¨æœŸçš„å†²åˆºï¼Œå†²åˆºä¹‹åçš„å›é¡¾éƒ½å°†æˆ‘ä»¬å¸¦å…¥ä¸€ç§èŠ‚å¥ä¸­ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="section-10"&gt;
&lt;h3&gt;å®ˆç ´ç¦»&lt;/h3&gt;
&lt;p&gt;è¦å…ˆå­¦ä¹ è§„åˆ™å’Œå½¢å¼ï¼ŒæŒæ¡ä¹‹åå†è¿›è¡Œåˆ›æ–°ï¼Œæœ€ç»ˆæ‘†è„±è§„åˆ™å’Œå½¢å¼ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="section-11"&gt;
&lt;h3&gt;å¼ºè°ƒå›¢é˜Ÿè€Œéä¸ªäºº&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;æ‹’ç»äº§ç”Ÿè‹±é›„å¼äººç‰©ï¼Œå¦‚æœä¸€ä¸ªå›¢é˜Ÿçš„é¢†å¯¼è€…åœ¨ä¼‘å‡æ—¶è¿˜è¦ç¡®ä¿åŠå…¬å®¤ä¸€åˆ‡æ­£å¸¸ï¼Œé‚£ä¹ˆå°±è¯´æ˜ä»–æ²¡æœ‰ç®¡ç†å¥½è‡ªå·±çš„å›¢é˜Ÿ&lt;/li&gt;
&lt;li&gt;èƒ½å¤Ÿè‡ªä¸»å†³ç­–ï¼Œæœ€å¤§åŒ–åœ°æå‡äººçš„è‡ªç”±ã€èƒ½åŠ›å’Œåˆ›é€ åŠ›ã€‚&lt;/li&gt;
&lt;li&gt;ä¸ä¸ºå¤±è´¥æŒ‡è´£ä»–äººï¼Œå®¢è§‚çš„æ‰¾å‡ºé—®é¢˜æ•´ä¸ªå›¢é˜Ÿä¸€èµ·å®Œå–„&lt;/li&gt;
&lt;li&gt;å¼ºè°ƒå›¢é˜Ÿç»©æ•ˆè€Œéä¸ªäººç»©æ•ˆ&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="section-12"&gt;
&lt;h3&gt;æ‹’ç»æµªè´¹&lt;/h3&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;é‰´äºäººç±»å•çº¿ç¨‹ç”Ÿç‰©ï¼Œä¸è¦åŒæ—¶æ‰§è¡Œå¤šé¡¹ä»»åŠ¡ï¼Œä¼šæµªè´¹ç²¾åŠ›å¯¼è‡´æœ€ç»ˆæ‰€æœ‰äº‹æƒ…éƒ½åšä¸å¥½ -- åŒæ—¶æ‰§è¡Œå¤šé¡¹ä»»åŠ¡ä¼šè®©ä½ å˜çš„æ„šè ¢&lt;/li&gt;
&lt;li&gt;å¦‚æœäº‹æƒ…åšåˆ°ä¸€åŠå°±æ”¾å¼ƒäº†ç­‰åŒä¸ä»€ä¹ˆä¹Ÿæ²¡åš -- åŠé€”è€ŒåºŸç­‰äºæ²¡åš&lt;/li&gt;
&lt;li&gt;åº”è¯¥ä¸€è¾¹åšä¸€è¾¹æµ‹è¯•ï¼Œå¹¶åŠæ—¶æ”¹æ­£æµ‹è¯•å‡ºæ¥çš„é”™è¯¯ï¼Œè€Œä¸æ˜¯ç­‰æ•´ä¸ªäº§å“æˆå‹åå†äº¤ä»˜æµ‹è¯•å¯¼è‡´è¿”å·¥é€ æˆæµªè´¹ -- ä¸€æ¬¡æ€§æŠŠäº‹æƒ…åšå¥½&lt;/li&gt;
&lt;li&gt;å»¶é•¿å·¥æ—¶ä¸ä¼šæé«˜æ•ˆç‡ï¼Œåè€Œä¼šé™·å…¥æ¶æ€§å¾ªç¯ï¼Œé€ æˆæµªè´¹&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="section-13"&gt;
&lt;h3&gt;è¯„ä¼°ä½¿ç”¨ç‚¹æ•°æ›¿æ¢æ—¶é—´&lt;/h3&gt;
&lt;p&gt;ä¼ ç»Ÿçš„é¡¹ç›®æ’æœŸä¼šè¯„ä¼°æŸä¸ªä»»åŠ¡çš„æˆªæ­¢æ—¶é—´æˆ–è€…æ‰€éœ€æ—¶é•¿ï¼Œä½†æ˜¯åœ¨æ•æ·ä¸­åº”è¯¥è¯„ä¼°ä»»åŠ¡çš„ç‚¹æ•°ï¼Œå¹¶æœ‰ä»¥ä¸‹å‡ ä¸ªè¦ç‚¹ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class="first"&gt;ç‚¹æ•°ä¸ä½¿ç”¨å¸¸è§„çš„é¡ºåºçš„æ•°å­—ï¼Œè€Œæ˜¯ä½¿ç”¨ &lt;a class="reference external" href="https://zh.wikipedia.org/wiki/%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E6%95%B0%E5%88%97"&gt;æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼ˆé»„é‡‘åˆ†å‰²æ•°åˆ—ï¼‰&lt;/a&gt; ï¼Œå¥½å¤„å°±æ˜¯å¯ä»¥æ˜ç¡®çš„åˆ†è¾¨ä¸åŒç‚¹æ•°ä¹‹é—´çš„å·®å¼‚ï¼Œè€ƒè™‘å¦‚ä¸‹ä¸¤åˆ—æ•°åˆ—çš„å·®å¼‚&lt;/p&gt;
&lt;table border="1" class="docutils"&gt;
&lt;colgroup&gt;
&lt;col width="45%" /&gt;
&lt;col width="55%" /&gt;
&lt;/colgroup&gt;
&lt;tbody valign="top"&gt;
&lt;tr&gt;&lt;td&gt;æ­£å¸¸é¡ºåº&lt;/td&gt;
&lt;td&gt;æ–æ³¢é‚£å¥‘&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;1&lt;/td&gt;
&lt;td&gt;2&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;2&lt;/td&gt;
&lt;td&gt;3&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;3&lt;/td&gt;
&lt;td&gt;5&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;4&lt;/td&gt;
&lt;td&gt;8&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;&lt;td&gt;5&lt;/td&gt;
&lt;td&gt;13&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;æ–æ³¢é‚£å¥‘æ•°åˆ—èƒ½æ›´å¥½åˆ†è¾¨ä¸åŒçº§åˆ«çš„ç‚¹æ•°ä¹‹é—´çš„å·®å¼‚ï¼Œå¦‚ 13 å’Œ 8 ä¹‹é—´çš„å·®å¼‚ï¼Œå°±æ¯” 5 å’Œ 4 ä¹‹é—´çš„å·®å¼‚è¦å¥½åˆ†è¾¨çš„å¤šã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;é‡‡ç”¨ç±»ä¼¼ &lt;a class="reference external" href="https://zh.wikipedia.org/wiki/%E5%BE%B7%E5%B0%94%E8%8F%B2%E6%B3%95"&gt;å¾·å°”è²æ³•&lt;/a&gt; çš„æ–¹å¼è¯„ä¼°ä»»åŠ¡ç‚¹æ•°ï¼Œé¿å…ç›¸äº’å½±å“&lt;/p&gt;
&lt;p&gt;æ–¹æ³•æ˜¯ç±»ä¼¼æ‰“æ‰‘å…‹ç‰Œçš„æ–¹å¼è¿›è¡Œè¯„ä¼°&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;å‚ä¸è¯„ä¼°æ¯ä¸ªäººéƒ½æ‹¥æœ‰ 2 3 5 8 13 è¿™ 5 å¼ ç‰Œ&lt;/li&gt;
&lt;li&gt;å¯¹æ¯ä¸€ä¸ªéœ€è¦è¯„ä¼°çš„ä»»åŠ¡æ‰€æœ‰äººéƒ½ç»™å‡ºè‡ªå·±çš„ç‚¹æ•°ä½†ä¸å…¬å¼€&lt;/li&gt;
&lt;li&gt;æ‰€æœ‰äººéƒ½è¯„ä¼°å®Œæˆåç»™å‡ºç‚¹æ•°&lt;/li&gt;
&lt;li&gt;å¾—å‡ºç»“æœï¼Œæœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µ&lt;ol class="arabic"&gt;
&lt;li&gt;æ‰€æœ‰äººç‚¹æ•°ç›¸è¿‘ï¼Œå–å¹³å‡å€¼&lt;/li&gt;
&lt;li&gt;å·®è·è¾ƒå¤§çš„æƒ…å†µä¸‹ï¼Œæ‰¾å‡ºå·®è·æœ€å¤§çš„ä¸¤äººåˆ†åˆ«é˜è¿°åŸå› ï¼Œç„¶åé‡æ–°å‡ºç‰Œï¼Œç›´åˆ°ç‚¹æ•°ç›¸è¿‘ï¼Œå–å¹³å‡å€¼&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å› ä¸ºäººç±»æœ¬èº«å°±æœ‰ä»ä¼—çš„ç¼ºç‚¹ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“å— &lt;a class="reference external" href="https://zh.wikipedia.org/wiki/%E6%99%95%E8%BD%AE%E6%95%88%E5%BA%94"&gt;å…‰ç¯æ•ˆåº”&lt;/a&gt; çš„å½±å“å¯¼è‡´åˆ¤æ–­åå·®ï¼Œé‡‡ç”¨è¿™ç§æ–¹æ³•è¯„ä¼°èƒ½å¾ˆå¥½çš„è§„é¿è¿™äº›ç¼ºç‚¹ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»¥æ­¤è¯„ä¼°å°±å¯ä»¥ç»Ÿè®¡å‡ºæ¯ä¸ªå†²åˆºå®Œæˆçš„ä»»åŠ¡ç‚¹æ•°ï¼Œå®è·µ Scrum åå›¢é˜Ÿå®Œæˆçš„ç‚¹æ•°ä¼šåœ¨åˆæœŸæˆå€å¢åŠ ã€‚&lt;/p&gt;
&lt;div class="section" id="section-14"&gt;
&lt;h4&gt;å…è´¹æ›´æ¢éœ€æ±‚&lt;/h4&gt;
&lt;p&gt;éœ€æ±‚å¯ä»¥å…è´¹æ›´æ¢ï¼Œè¿™é‡Œå…è´¹æŒ‡å¯¹å®¢æˆ·å…è´¹ï¼Œåœ¨è‡ªæœ‰äº§å“ä¸­å¯ä»¥æ¢æˆè‡ªç”±æ›´æ¢ï¼Œä½†è‡ªç”±æ›´æ¢å¹¶ä¸ä»£è¡¨æ²¡æœ‰ä»£ä»·ï¼Œè¦ä»å·²ç»å®‰æ’è¿›å»çš„å¾…åŠäº‹é¡¹ä¸­æ›¿æ¢ç›¸åŒç‚¹æ•°çš„äº‹é¡¹ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="section-15"&gt;
&lt;h3&gt;å¿«ä¹æ˜¯ç¬¬ä¸€ç”Ÿäº§åŠ›&lt;/h3&gt;
&lt;p&gt;è¿™é‡Œçš„å¿«ä¹æ˜¯æŒ‡å¯ä»¥è®©å›¢é˜Ÿæé«˜æ•ˆç‡çš„å¿«ä¹ï¼Œè€Œéäº«ä¹çš„å¿«ä¹ï¼Œæ¯”å¦‚&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;æé«˜å›¢é˜Ÿè¿ä½œçš„é€æ˜åº¦ï¼Œä¸åº”è¯¥æœ‰ç§˜å¯†å°é›†å›¢ã€ç§˜å¯†æ—¥ç¨‹å’Œå…¶ä»–ä»€ä¹ˆç§˜è€Œä¸å®£çš„äº‹æƒ…&lt;/li&gt;
&lt;li&gt;ç»™äºˆå›¢é˜Ÿä¸­çš„æ¯ä¸ªäººè‡ªä¸»æƒï¼Œè®©æ¯ä¸ªäººéƒ½å—åˆ°å°Šé‡&lt;/li&gt;
&lt;li&gt;æ‰¿è®¤åªæœ‰ç³Ÿç³•çš„åˆ¶åº¦æ²¡æœ‰ç³Ÿç³•çš„å›¢é˜Ÿ&lt;/li&gt;
&lt;li&gt;å›¢é˜Ÿæˆå‘˜ä¹‹é—´ç›¸äº’ä¿¡ä»»ï¼Œè¸¢å‡ºè®©å…¶ä»–äººä¸å¿«ä¹çš„æˆå‘˜ç­‰ç­‰&lt;/li&gt;
&lt;li&gt;æ‰å¹³åŒ–&lt;/li&gt;
&lt;li&gt;å¢å¼ºå›¢é˜Ÿæˆå‘˜ä¹‹é—´çš„è”ç³»ï¼ˆç¾ç»Šçš„åŠ›é‡ï¼‰&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™é‡Œè¦é¿å…ç»è¿‡ä¸€æ®µæ—¶é—´çš„è¿›æ­¥ä¹‹åå®‰äºç°çŠ¶ï¼Œè¦æœ‰â€œèªæ˜çš„å‚»ç“œâ€å‹‡äºåˆºç ´â€œå¿«ä¹çš„æ³¡æ²«â€ã€‚&lt;/p&gt;
&lt;div class="section" id="section-16"&gt;
&lt;h4&gt;é‡åŒ–å¿«ä¹&lt;/h4&gt;
&lt;p&gt;åœ¨æ¯æ¬¡å†²åˆºç»“æŸååº”ç»Ÿè®¡æˆå‘˜çš„å¿«ä¹æŒ‡æ ‡ï¼Œå‚ä¸å†²åˆºçš„æ¯ä½æˆå‘˜éƒ½éœ€è¦å›ç­”ä»¥ä¸‹ 4 ä¸ªé—®é¢˜&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;ä½ å¯¹è‡ªå·±åœ¨å…¬å¸çš„è§’è‰²æ„Ÿè§‰å¦‚ä½•ï¼Ÿè¯·ä»¥ 1 ~ 5 åˆ†åŠ ä»¥è¯„ä»·&lt;/li&gt;
&lt;li&gt;ä½ å¯¹å…¬å¸æ•´ä½“æƒ…å†µæ„Ÿè§‰å¦‚ä½•ï¼Ÿè¯·ä»¥ 1 ~ 5 åˆ†åŠ ä»¥è¯„ä»·&lt;/li&gt;
&lt;li&gt;ä¸ºä»€ä¹ˆä¼šæœ‰è¿™ç§æ„Ÿå—ï¼Ÿ&lt;/li&gt;
&lt;li&gt;åœ¨ä¸‹ä¸€ä¸ªå†²åˆºé˜¶æ®µä¸­ï¼Œä»€ä¹ˆäº‹æƒ…ä¼šè®©ä½ æ„Ÿåˆ°æ›´å¿«ä¹ï¼Ÿ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é€šè¿‡è®¡ç®—è¯„ä»·åˆ†å¯ä»¥å¾—å‡ºæ•´ä¸ªå›¢é˜Ÿå¹³å‡å¿«ä¹æŒ‡æ ‡ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="mvp"&gt;
&lt;h4&gt;MVP æœ€ç®€åŒ–å¯è¡Œäº§å“&lt;/h4&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;ä¸€ä¸ªäº§å“ 80% çš„ä»·å€¼æ¥è‡ª 20% çš„åŠŸèƒ½&lt;/li&gt;
&lt;li&gt;äº§å“è´Ÿè´£äººåˆ—å‡ºå¾…åŠäº‹é¡¹å¹¶æ‰¾å‡ºå…¶ä¸­å¯¹ç”¨æˆ·æœ€æœ‰ä»·å€¼çš„&lt;/li&gt;
&lt;li&gt;åŠæ—¶çŠ¯é”™ï¼šæœ‰äº›é”™è¯¯æ—©çŠ¯å¯ä»¥å°½é‡å‡å°‘ç»™åˆ«äººé€ æˆçš„ä¼¤å®³ï¼Œè€Œä¸”ä»¥åä¹Ÿå¯ä»¥æƒ³åŠæ³•é¿å…&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="section-17"&gt;
&lt;h2&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;æœ¬ä¹¦å¼•ç”¨å¤§é‡çš„å®è·µ Scrum çš„å›¢é˜Ÿçš„ç»å†å’Œç ”ç©¶ç»“æœï¼Œæ¥é˜è¿°æ•æ·çš„åŠ›é‡ã€‚åŒæ—¶ä¹Ÿé€šè¿‡å¤§é‡çš„ä¾‹å­è¡¨æ˜ Scrum ä¸ä»…ä»…å¯ä»¥ç”¨åœ¨è½¯ä»¶å¼€å‘ï¼ŒåŒæ—¶ä¹Ÿé€‚ç”¨äºæ•™è‚²ã€æ”¿åºœã€é‡‘èç­‰å…¶ä»–è¡Œä¸šã€‚
æ€»ä¹‹è¯´æœåŠ›ï¼ˆæ´—è„‘æ•ˆæœï¼‰éå¸¸å¼ºã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="mvp-1"&gt;
&lt;h2&gt;å¿«é€Ÿå…¥é—¨æ•æ·å’Œç†è§£ MVP&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://cloud.tencent.com/developer/article/1004881"&gt;ä½ å¤§æ¦‚èµ°äº†å‡æ•æ·ï¼šè®¤çœŸè¯´è¯´æ•æ·çš„å®ç°å’Œé—®é¢˜ï¼ˆæ‰‹ç»˜ç‰ˆï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.woshipm.com/ucd/774702.html"&gt;MVPä¸ç²¾ç›Šåˆ›ä¸š&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</content><category term="Other"></category><category term="Scrum"></category><category term="Agile"></category><category term="æ•æ·"></category><category term="é˜…è¯»"></category></entry><entry><title>é€šè¿‡ acme.sh è·å– Let's Encrypt å…è´¹è¯ä¹¦</title><link href="https://www.linuxzen.com/use-acme-sh-to-issue-letsencrypt-cert.html" rel="alternate"></link><published>2019-02-12T00:00:00+08:00</published><updated>2019-02-12T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2019-02-12:/use-acme-sh-to-issue-letsencrypt-cert.html</id><summary type="html">&lt;div class="section" id="nginx-webroot"&gt;
&lt;h2&gt;é…ç½® Nginx æ­£ç¡®å¤„ç† Webroot éªŒè¯&lt;/h2&gt;
&lt;p&gt;åœ¨è¯ä¹¦ç­¾å‘è¿‡ç¨‹ä¸­ Let's Encrypt ä¼šéªŒè¯ä½ æ‹¥æœ‰å½“å‰åŸŸåï¼Œæœ€åŸºæœ¬çš„æ–¹å¼åœ¨ä½ çš„ç½‘ç«™æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ â€¦&lt;/p&gt;&lt;/div&gt;</summary><content type="html">&lt;div class="section" id="nginx-webroot"&gt;
&lt;h2&gt;é…ç½® Nginx æ­£ç¡®å¤„ç† Webroot éªŒè¯&lt;/h2&gt;
&lt;p&gt;åœ¨è¯ä¹¦ç­¾å‘è¿‡ç¨‹ä¸­ Let's Encrypt ä¼šéªŒè¯ä½ æ‹¥æœ‰å½“å‰åŸŸåï¼Œæœ€åŸºæœ¬çš„æ–¹å¼åœ¨ä½ çš„ç½‘ç«™æ ¹ç›®å½•åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œå¹¶é€šè¿‡åŸŸååœ¨å¤–éƒ¨è¿›è¡Œè¯·æ±‚ï¼Œå¦‚èƒ½è¯·æ±‚åˆ°åˆ™è®¤ä¸ºä½ æ‹¥æœ‰è¯¥ç½‘ç«™çš„æ§åˆ¶æƒã€‚å‡è®¾ä½ æœ‰ä¸€ä¸ªåŸŸå &lt;tt class="docutils literal"&gt;example.com&lt;/tt&gt;ï¼Œ éªŒè¯æ­¥éª¤å¤§ä½“å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;é€šè¿‡å·¥å…·åœ¨ç½‘ç«™æ ¹ç›®å½•ä¸‹åˆ›å»º &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;.well-known/acme-challenge/some-random-letters&lt;/span&gt;&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;å·¥å…·å°†åˆ›å»ºçš„è·¯å¾„å‘ŠçŸ¥ Let's Encrypt&lt;/li&gt;
&lt;li&gt;Let's Encrypt é€šè¿‡åŸŸåè¯·æ±‚è¯¥æ–‡ä»¶ï¼Œå¦‚ &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;http://example.com/.well-known/acme-challenge/some-random-letters&lt;/span&gt;&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;è‹¥èƒ½è¯·æ±‚åˆ°åˆ™ç¡®è®¤æ‹¥æœ‰è¯¥ç½‘ç«™çš„æ§åˆ¶æƒé¢å‘è¯ä¹¦ï¼Œå¦åˆ™æ‹’ç»é¢å‘&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ä¸ºäº†ç®€åŒ–å¤šä¸ªåŸŸåé¢å‘è¯ä¹¦éœ€æŒ‡å®šä¸åŒçš„ Webrootï¼Œæˆ‘ä»¬å¯ä»¥å°†æ‰€æœ‰åŸŸåçš„éªŒè¯ç»Ÿä¸€æ”¾åœ¨ä¸€ä¸ªç›®å½•ä¸‹ï¼Œå¹¶æ–°å¢ä¸€ä¸ªé…ç½®ç‰‡æ®µä¾›éœ€è¦å¯ç”¨ HTTPS çš„ç½‘ç«™å¼•ç”¨ï¼Œæ–°å¢ &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;/etc/nginx/snippets/letsencrypt-acme-challenge.conf&lt;/span&gt;&lt;/tt&gt; ï¼Œå¹¶å¡«å……å¦‚ä¸‹å†…å®¹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;#############################################################################&lt;/span&gt;
&lt;span class="c1"&gt;# Configuration file for Let&amp;#39;s Encrypt ACME Challenge location&lt;/span&gt;
&lt;span class="c1"&gt;#############################################################################&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# This config enables to access /.well-known/acme-challenge/xxxxxxxxxxx&lt;/span&gt;
&lt;span class="c1"&gt;# on all our sites (HTTP), including all subdomains.&lt;/span&gt;
&lt;span class="c1"&gt;# This is required by ACME Challenge (webroot authentication).&lt;/span&gt;
&lt;span class="c1"&gt;# You can check that this location is working by placing ping.txt here:&lt;/span&gt;
&lt;span class="c1"&gt;# /var/www/letsencrypt/.well-known/acme-challenge/ping.txt&lt;/span&gt;
&lt;span class="c1"&gt;# And pointing your browser to:&lt;/span&gt;
&lt;span class="c1"&gt;# http://xxx.domain.tld/.well-known/acme-challenge/ping.txt&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# Sources:&lt;/span&gt;
&lt;span class="c1"&gt;# https://community.letsencrypt.org/t/howto-easy-cert-generation-and-renewal-with-nginx/3491&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#############################################################################&lt;/span&gt;

&lt;span class="c1"&gt;# Rule for legitimate ACME Challenge requests (like /.well-known/acme-challenge/xxxxxxxxx)&lt;/span&gt;
&lt;span class="c1"&gt;# We use ^~ here, so that we don&amp;#39;t check other regexes (for speed-up). We actually MUST cancel&lt;/span&gt;
&lt;span class="c1"&gt;# other regex checks, because in our other config files have regex rule that denies access to files with dotted names.&lt;/span&gt;
&lt;span class="k"&gt;location&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;^~&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;/.well-known/acme-challenge/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# Set correct content type. According to this:&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# https://community.letsencrypt.org/t/using-the-webroot-domain-verification-method/1445/29&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# Current specification requires &amp;quot;text/plain&amp;quot; or no content header at all.&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# It seems that &amp;quot;text/plain&amp;quot; is a safe option.&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kn"&gt;default_type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text/plain&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# This directory must be the same as in /etc/letsencrypt/cli.ini&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# as &amp;quot;webroot-path&amp;quot; parameter. Also don&amp;#39;t forget to set &amp;quot;authenticator&amp;quot; parameter&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# there to &amp;quot;webroot&amp;quot;.&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# Do NOT use alias, use root! Target directory is located here:&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# /var/www/common/letsencrypt/.well-known/acme-challenge/&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kn"&gt;root&lt;/span&gt;&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="s"&gt;/var/www/letsencrypt&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="c1"&gt;# Hide /acme-challenge subdirectory and return 404 on all requests.&lt;/span&gt;
&lt;span class="c1"&gt;# It is somewhat more secure than letting Nginx return 403.&lt;/span&gt;
&lt;span class="c1"&gt;# Ending slash is important!&lt;/span&gt;
&lt;span class="k"&gt;location&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;/.well-known/acme-challenge/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kn"&gt;return&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;404&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;åœ¨éœ€è¦å¯ç”¨éªŒè¯çš„ç½‘ç«™çš„ Nginx é…ç½®ä¸­å¢åŠ å¦‚ä¸‹å†…å®¹å³å¯&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;server&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="kn"&gt;...&lt;/span&gt;

&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="s"&gt;include&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;/etc/nginx/snippets/letsencrypt-acme-challenge.conf&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;åˆ›å»ºç›¸åº”ç›®å½•é‡å¯ Nginx&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;sudo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;mkdir&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;-p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;/var/www/letsencrypt/&lt;/span&gt;
&lt;span class="s"&gt;sudo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;chown&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;$&lt;span class="s"&gt;(whoami).&lt;/span&gt;$&lt;span class="s"&gt;(whoami)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;/var/www/letsencrypt/&lt;/span&gt;
&lt;span class="s"&gt;sudo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;/etc/init.d/nginx&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;configtest&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;sudo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;/etc/init.d/nginx&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;reload&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="section-1"&gt;
&lt;h2&gt;è·å–è¯ä¹¦&lt;/h2&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;å®‰è£… &lt;a class="reference external" href="https://github.com/Neilpang/acme.sh"&gt;acme.sh&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;curl&lt;span class="w"&gt; &lt;/span&gt;https://get.acme.sh&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;sh
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;è·å–è¯ä¹¦&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;acme.sh&lt;span class="w"&gt; &lt;/span&gt;--issue&lt;span class="w"&gt; &lt;/span&gt;-d&lt;span class="w"&gt; &lt;/span&gt;example.com&lt;span class="w"&gt; &lt;/span&gt;-d&lt;span class="w"&gt; &lt;/span&gt;www.example.com&lt;span class="w"&gt; &lt;/span&gt;-w&lt;span class="w"&gt; &lt;/span&gt;/var/www/letsencrypt
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="section-2"&gt;
&lt;h2&gt;å®‰è£…è¯ä¹¦&lt;/h2&gt;
&lt;p&gt;è·å–çš„è¯ä¹¦å› ä¸ºåœ¨ç”¨æˆ·å®¶ç›®å½•ä¸‹ï¼Œæ‰€ä»¥ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œéœ€è¦é€šè¿‡å¦‚ä¸‹å‘½ä»¤å®‰è£…åˆ°ç³»ç»Ÿä¸­&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;sudo&lt;span class="w"&gt; &lt;/span&gt;mkdir&lt;span class="w"&gt; &lt;/span&gt;-p&lt;span class="w"&gt; &lt;/span&gt;/etc/nginx/certs/example.com
sudo&lt;span class="w"&gt; &lt;/span&gt;chown&lt;span class="w"&gt; &lt;/span&gt;root.&lt;span class="k"&gt;$(&lt;/span&gt;whoami&lt;span class="k"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/etc/nginx/certs/example.com
sudo&lt;span class="w"&gt; &lt;/span&gt;chmod&lt;span class="w"&gt; &lt;/span&gt;g+w&lt;span class="w"&gt; &lt;/span&gt;/etc/nginx/certs/example.com
acme.sh&lt;span class="w"&gt; &lt;/span&gt;--install-cert&lt;span class="w"&gt; &lt;/span&gt;-d&lt;span class="w"&gt; &lt;/span&gt;example.com&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;--cert-file&lt;span class="w"&gt; &lt;/span&gt;/etc/nginx/certs/example.com/cert.pem&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;--key-file&lt;span class="w"&gt; &lt;/span&gt;/etc/nginx/certs/example.com/key.pem&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;--fullchain-file&lt;span class="w"&gt; &lt;/span&gt;/etc/nginx/certs/example.com/fullchain.pem&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;--reloadcmd&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;service nginx reload&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å®‰è£…åå¯ä»¥é…ç½® Nginx å¯ç”¨ HTTPS&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;server&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;listen&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;80&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;server_name&lt;span class="w"&gt;     &lt;/span&gt;www.example.com&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;server_name&lt;span class="w"&gt;     &lt;/span&gt;example.com&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;return&lt;/span&gt;&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="m"&gt;301&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;https://&lt;span class="nv"&gt;$server_name$request_uri&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

server&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;listen&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;443&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;ssl&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;server_name&lt;span class="w"&gt;     &lt;/span&gt;www.example.com&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;server_name&lt;span class="w"&gt;     &lt;/span&gt;example.com&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;ssl_certificate&lt;span class="w"&gt; &lt;/span&gt;/etc/nginx/certs/example.com/fullchain.pem&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;ssl_certificate_key&lt;span class="w"&gt; &lt;/span&gt;/etc/nginx/certs/example.com/key.pem&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;ssl_protocols&lt;span class="w"&gt; &lt;/span&gt;TLSv1&lt;span class="w"&gt; &lt;/span&gt;TLSv1.1&lt;span class="w"&gt; &lt;/span&gt;TLSv1.2&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;ssl_prefer_server_ciphers&lt;span class="w"&gt; &lt;/span&gt;on&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;ssl_dhparam&lt;span class="w"&gt; &lt;/span&gt;/etc/ssl/certs/dhparam.pem&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;ssl_ciphers&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-DSS-AES128-GCM-SHA256:kEDH+AESGCM:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA384:ECDHE-RSA-AES256-SHA:ECDHE-ECDSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-DSS-AES128-SHA256:DHE-RSA-AES256-SHA256:DHE-DSS-AES256-SHA:DHE-RSA-AES256-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:AES:CAMELLIA:DES-CBC3-SHA:!aNULL:!eNULL:!EXPORT:!DES:!RC4:!MD5:!PSK:!aECDH:!EDH-DSS-DES-CBC3-SHA:!EDH-RSA-DES-CBC3-SHA:!KRB5-DES-CBC3-SHA&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;ssl_session_timeout&lt;span class="w"&gt; &lt;/span&gt;1d&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;ssl_session_cache&lt;span class="w"&gt; &lt;/span&gt;shared:SSL:50m&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;ssl_stapling&lt;span class="w"&gt; &lt;/span&gt;on&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;ssl_stapling_verify&lt;span class="w"&gt; &lt;/span&gt;on&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;add_header&lt;span class="w"&gt; &lt;/span&gt;Strict-Transport-Security&lt;span class="w"&gt; &lt;/span&gt;max-age&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;15768000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;access_log&lt;span class="w"&gt;      &lt;/span&gt;/var/log/nginx/www.example.com.log&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;location&lt;span class="w"&gt; &lt;/span&gt;/&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;root&lt;span class="w"&gt;    &lt;/span&gt;/var/www/html&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;index&lt;span class="w"&gt;   &lt;/span&gt;index.html&lt;span class="w"&gt; &lt;/span&gt;index.htm&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;include&lt;span class="w"&gt; &lt;/span&gt;/etc/nginx/snippets/letsencrypt-acme-challenge.conf&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="section-3"&gt;
&lt;h2&gt;å‚è€ƒ&lt;/h2&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://community.letsencrypt.org/t/how-to-nginx-configuration-to-enable-acme-challenge-support-on-all-http-virtual-hosts/5622"&gt;https://community.letsencrypt.org/t/how-to-nginx-configuration-to-enable-acme-challenge-support-on-all-http-virtual-hosts/5622&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</content><category term="Linux"></category><category term="SSL"></category><category term="HTTPS"></category></entry><entry><title>Docker Snippets</title><link href="https://www.linuxzen.com/docker-snippets.html" rel="alternate"></link><published>2019-02-11T17:30:00+08:00</published><updated>2019-02-11T17:30:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2019-02-11:/docker-snippets.html</id><summary type="html">&lt;p class="first last"&gt;åˆ†äº«å…³äº Docker çš„ä¸€äº›å‘&lt;/p&gt;
</summary><content type="html">&lt;div class="section" id="docker-iptables"&gt;
&lt;h2&gt;Docker å’Œ iptables&lt;/h2&gt;
&lt;p&gt;å¦‚æœä½ ç”¨ Docker å¯åŠ¨äº†ä¸€ä¸ªæœåŠ¡æš´éœ²äº†ä¸€ä¸ªç«¯å£ï¼ŒåŒæ—¶ä½ åˆæƒ³é€šè¿‡ iptables é™åˆ¶è¯¥ç«¯å£çš„è®¿é—®ï¼Œè¿™æ—¶å€™ä½ æŒ‰ç…§ç»éªŒå¾€ &lt;tt class="docutils literal"&gt;INPUT&lt;/tt&gt; é“¾æ’å…¥ä¸€æ¡è§„åˆ™å‘ç°å¹¶æ²¡æœ‰åµç”¨ï¼Œä½ åº”è¯¥çœ‹çœ‹ Docker çš„å®˜æ–¹æ–‡æ¡£ &lt;a class="reference external" href="https://docs.docker.com/network/iptables/#add-iptables-policies-before-dockers-rules"&gt;Docker and iptables&lt;/a&gt; ã€‚è¿™æ˜¯å› ä¸º Docker ä½¿ç”¨ iptables æä¾›ç½‘ç»œéš”ç¦»ï¼Œåªæœ‰åœ¨ &lt;tt class="docutils literal"&gt;DOCKER&lt;/tt&gt; å’Œ &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;DOCKER-USER&lt;/span&gt;&lt;/tt&gt; é“¾ä¸Šçš„è§„åˆ™æ‰å¯¹å®¹å™¨æš´éœ²çš„ç«¯å£ç”Ÿæ•ˆï¼Œå®˜æ–¹æ¨èç”¨æˆ·åœ¨ &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;DOCKER-USER&lt;/span&gt;&lt;/tt&gt; é“¾ä¸Šæ–°å¢è‡ªå®šä¹‰è§„åˆ™ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="docker"&gt;
&lt;h2&gt;ä½¿ç”¨ Docker å¤šé˜¶æ®µæ„å»º&lt;/h2&gt;
&lt;p&gt;è‡ª Docker 17.05 Docker å¼€å§‹æ”¯æŒå¤šé˜¶æ®µæ„å»ºï¼Œä½¿ç”¨ Docker å¤šé˜¶æ®µæ„å»ºæœ‰ä¸¤ä¸ªå¥½å¤„ï¼š&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;ä¼˜åŒ–é•œåƒå¤§å°&lt;/li&gt;
&lt;li&gt;åœ¨é•œåƒä¸­æ’é™¤æºä»£ç &lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ¯”å¦‚ä¸€ä¸ªå…¸å‹çš„ Go åº”ç”¨å¦‚æœæƒ³è¦åœ¨é•œåƒæ„å»ºè¿‡ç¨‹ä¸­ç¼–è¯‘ï¼Œä½†æ˜¯åˆä¸æƒ³é•œåƒä¸­åŒ…å«æºä»£ç å¯ä»¥æŒ‰ç…§å¦‚ä¸‹æ–¹å¼ç¼–å†™ &lt;tt class="docutils literal"&gt;Dockerfile&lt;/tt&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;golang:1.10&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;as&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;intermediate&lt;/span&gt;

&lt;span class="k"&gt;ENV&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;PROJECT_PATH&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$GOPATH&lt;/span&gt;/src/github.com/coldnight/foobar
&lt;span class="k"&gt;ADD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;.&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$PROJECT_PATH&lt;/span&gt;/
&lt;span class="k"&gt;WORKDIR&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;$PROJECT_PATH&lt;/span&gt;
&lt;span class="k"&gt;RUN&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;go&lt;span class="w"&gt; &lt;/span&gt;install

&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;alpine:latest&lt;/span&gt;

&lt;span class="k"&gt;COPY&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;--from&lt;span class="o"&gt;=&lt;/span&gt;intermediate&lt;span class="w"&gt; &lt;/span&gt;/go/bin/foobar&lt;span class="w"&gt; &lt;/span&gt;/go/bin/foobar
&lt;span class="k"&gt;CMD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/go/bin/foobar&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å…·ä½“ä½¿ç”¨æ–¹å¼å‚è§å®˜æ–¹æ–‡æ¡£ &lt;a class="reference external" href="https://docs.docker.com/develop/develop-images/multistage-build/"&gt;Use multi-stage builds&lt;/a&gt; ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="cmd-vs-entrypoint"&gt;
&lt;h2&gt;CMD vs ENTRYPOINT&lt;/h2&gt;
&lt;p&gt;æˆ‘åœ¨ä¸€å¼€å§‹ä½¿ç”¨ Docker æ—¶æ— æ³•ç¡®å®šè¯¥ä½¿ç”¨ CMD å’Œ ENTRYPOINT ä¸­çš„å“ªä¸€ä¸ªï¼Œå…¶å®å¾ˆç®€å• CMD å¯ä»¥åœ¨ &lt;tt class="docutils literal"&gt;docker run&lt;/tt&gt; æ—¶è¢«è¦†ç›–ï¼Œè€Œ ENTRYPOINT ä¸å¯ä»¥ï¼Œæ¯”å¦‚å¦‚ä¸‹ &lt;tt class="docutils literal"&gt;Dockerfile&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;FROM&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;alpine:latest&lt;/span&gt;

&lt;span class="k"&gt;CMD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;/bi&lt;/span&gt;&lt;span class="kc"&gt;n&lt;/span&gt;&lt;span class="err"&gt;/sh&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å‡è®¾é€šè¿‡å¦‚ä¸‹å‘½ä»¤æ„å»ºé•œåƒ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$&lt;span class="w"&gt; &lt;/span&gt;docker&lt;span class="w"&gt; &lt;/span&gt;build&lt;span class="w"&gt; &lt;/span&gt;.&lt;span class="w"&gt; &lt;/span&gt;-t&lt;span class="w"&gt; &lt;/span&gt;demo
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å¦‚æœé€šè¿‡å¦‚ä¸‹å‘½ä»¤è¿è¡Œå®¹å™¨åˆ™é»˜è®¤å¯åŠ¨ &lt;tt class="docutils literal"&gt;/bin/sh&lt;/tt&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$&lt;span class="w"&gt; &lt;/span&gt;docker&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;-it&lt;span class="w"&gt; &lt;/span&gt;demo
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä½†å¦‚æœæƒ³è¦†ç›–åˆ™å¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹å¼è¿è¡Œå®¹å™¨:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$&lt;span class="w"&gt; &lt;/span&gt;docker&lt;span class="w"&gt; &lt;/span&gt;run&lt;span class="w"&gt; &lt;/span&gt;-it&lt;span class="w"&gt; &lt;/span&gt;demo&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;hello, world&amp;#39;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å¦‚æœå°† Dockerfile ä¸­ CMD æ›¿æ¢ä¸º ENTRYPOINT åˆ™æ— æ³•é€šè¿‡ä¸Šè¿°æ–¹å¼è¦†ç›–é»˜è®¤çš„å¯åŠ¨å‘½ä»¤ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="docker-web"&gt;
&lt;h2&gt;Docker Web ç®¡ç†ç³»ç»Ÿ&lt;/h2&gt;
&lt;p&gt;è§‰å¾—æ‰‹åŠ¨æ•²å‘½ä»¤ç®¡ç†æœ¬åœ° Docker éº»çƒ¦ï¼Ÿå¯ä»¥è¯•è¯•æœ¬åœ°å®‰è£…ä¸€ä¸ª &lt;a class="reference external" href="https://github.com/portainer/portainer"&gt;portainer&lt;/a&gt; ï¼Œé€šè¿‡ Web ç•Œé¢ç®¡ç†æœ¬åœ° Dockerã€‚&lt;/p&gt;
&lt;/div&gt;
</content><category term="Linux"></category><category term="docker"></category><category term="snippets"></category></entry><entry><title>Go 1.5 å†…å­˜æ¸…é™¤æ±‡ç¼–æºç æ³¨é‡Š</title><link href="https://www.linuxzen.com/golang-105-memclr-assembly-comment.html" rel="alternate"></link><published>2019-02-11T00:00:00+08:00</published><updated>2019-02-11T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2019-02-11:/golang-105-memclr-assembly-comment.html</id><summary type="html">&lt;p class="first last"&gt;Go ä¸ºäº†å®ç°å†…å­˜å¤ç”¨ä¼šå°†å·²ç»å›æ”¶åˆ° cache çš„å†…å­˜æ¸…é™¤ï¼Œæ¸…é™¤é€»è¾‘ä½¿ç”¨æ±‡ç¼–å®ç°ï¼Œæœ¬æ–‡æ˜¯åŸºäºè‡ªå·±çš„ç†è§£è¿›è¡Œçš„æ³¨é‡Šã€‚&lt;/p&gt;
</summary><content type="html">&lt;p&gt;æœ€è¿‘åœ¨é˜…è¯» Go1.5 çš„æºç ï¼Œå‘ç°æºç ä¸­å¤šå¤„è°ƒç”¨äº†äº† &lt;tt class="docutils literal"&gt;memclr&lt;/tt&gt; ï¼Œè¿›ä¸€æ­¥æ·±å…¥äº†è§£å‘ç°åŸæ¥ Go ä¸ºäº†å®ç°å†…å­˜å¤ç”¨ä¼šå°†å·²ç»å›æ”¶åˆ° &lt;tt class="docutils literal"&gt;cache&lt;/tt&gt; çš„å†…å­˜æ¸…é™¤ï¼Œæ¸…é™¤é€»è¾‘ä½¿ç”¨æ±‡ç¼–å®ç°ï¼Œæœ¬æ–‡æ˜¯åŸºäºè‡ªå·±çš„ç†è§£è¿›è¡Œçš„æ³¨é‡Šã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;æ³¨æ„&lt;/strong&gt;:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;æœ€æ–°ç‰ˆçš„ Go ä¸­ï¼ˆ1.11ï¼‰è¯¥å‡½æ•°å·²ç»æ”¹åä¸º &lt;tt class="docutils literal"&gt;memclrNoHeapPointers&lt;/tt&gt;&lt;/li&gt;
&lt;li&gt;æˆ‘è‡ªå·±æ·»åŠ çš„æ³¨é‡Šä»¥ &lt;tt class="docutils literal"&gt;//#&lt;/tt&gt; å¼€å§‹&lt;/li&gt;
&lt;li&gt;Go é’ˆå¯¹ä¸åŒçš„å¹³å°å®ç°äº†ä¸åŒçš„å†…å­˜æ¸…é™¤ï¼Œè¿™é‡Œä»…å¯¹ &lt;tt class="docutils literal"&gt;amd64&lt;/tt&gt; å¹³å°ä¸‹çš„å®ç°è¿›è¡Œæ³¨é‡Šï¼š&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æºæ–‡ä»¶: &lt;a class="reference external" href="https://github.com/golang/go/blob/release-branch.go1.5/src/runtime/memclr_amd64.s"&gt;https://github.com/golang/go/blob/release-branch.go1.5/src/runtime/memclr_amd64.s&lt;/a&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;// Copyright 2014 The Go Authors. All rights reserved.
// Use of this source code is governed by a BSD-style
// license that can be found in the LICENSE file.

// +build !plan9

#include &amp;quot;textflag.h&amp;quot;

// NOTE: Windows externalthreadhandler expects memclr to preserve DX.

// void runtimeÂ·memclr(void* ptr, uintptr n)

//# - TEXT åœ¨ Plan9 ä¸­ç”¨äºå£°æ˜å‡½æ•°
//# - runtimeÂ·memclr ä¸ºå‡½æ•°åï¼Œä¸­é—´çš„Â·ä¸æ˜¯æ™®é€šçš„ç‚¹åœ¨ Mac ä¸‹é€šè¿‡ Option+Shift+9 æ‰“å‡ºï¼ŒÂ· å‰æ˜¯åŒ…ååé¢æ˜¯å‡½æ•°å
//# - SBï¼ˆä¼ªå¯„å­˜å™¨ï¼‰å…¨å±€é™æ€åŸºæŒ‡é’ˆï¼Œç”¨æ¥å£°æ˜å‡½æ•°æˆ–å…¨å±€å˜é‡ï¼ˆæ­¤å¤„ç”¨æ¥å£°æ˜å‡½æ•°ï¼‰
//# - NOSPLIT å®šä¹‰åœ¨ https://github.com/golang/go/blob/master/src/runtime/textflag.h
//# - $0-16ï¼š
//#   + $0 æ ˆå¸§å¤§å°ä¸º0ï¼ˆå±€éƒ¨å˜é‡+å¯èƒ½éœ€è¦çš„é¢å¤–è°ƒç”¨å‡½æ•°çš„å‚æ•°ç©ºé—´æ€»å¤§å°ï¼Œä¸åŒ…æ‹¬è°ƒç”¨å…¶ä»–å‡½æ•°æ—¶çš„ ret address çš„å¤§å°ï¼‰
//#   + 16 å‚æ•°åŸºè¿”å›å€¼çš„å¤§å°ï¼ˆ16 è¡¨ç¤ºä¸¤ä¸ªåŒå››å­—çš„å‚æ•°ï¼‰
TEXT runtimeÂ·memclr(SB), NOSPLIT, $0-16
     //# FPï¼ˆä¼ªå¯„å­˜å™¨ï¼‰ï¼šé€šè¿‡ `symbol+offset(FP)` çš„æ–¹å¼å¼•ç”¨è¾“å…¥å‚æ•°
     //# symbol æ²¡æœ‰ä»»ä½•ç”¨ï¼Œåªæ˜¯å¢åŠ å¯è¯»æ€§ï¼Œä½†ä¸èƒ½çœç•¥
     //# FP æŒ‡å‘æ•´ä¸ªæ ˆå¸§çš„åº•éƒ¨çš„ BP å¯„å­˜å™¨
     MOVQ    ptr+0(FP), DI   //# ç¬¬ä¸€ä¸ªå‚æ•°ç§»åŠ¨åˆ° DI å¯„å­˜å™¨ï¼ˆDI ç›®æ ‡ç´¢å¼•å¯„å­˜å™¨ï¼‰
     MOVQ    n+8(FP), BX     //# ç¬¬äºŒä¸ªå‚æ•°ç§»åŠ¨åˆ° BX å¯„å­˜å™¨ï¼ˆBX ä¸ºåŸºå€å¯„å­˜å™¨ï¼Œç”¨äºå†…å­˜å¯»å€ï¼‰
     XORQ    AX, AX          //# æ¸…é›¶ AX å¯„å­˜å™¨ï¼ˆAX ä¸ºç´¯åŠ å¯„å­˜å™¨ï¼‰

// MOVOU seems always faster than REP STOSQ.
tail:
     TESTQ   BX, BX          // set ZF to 1 if n is 0
     JEQ     _0              // jump to _0 if ZF == 1(returns)
     CMPQ    BX, $2
     JBE     _1or2           // jump to _1or2 if n &amp;lt;= 2
     CMPQ    BX, $4
     JBE     _3or4           // jump to _3or4 if n &amp;gt; 2 and n &amp;lt;= 4
     CMPQ    BX, $8
     // ...
     JBE     _5through8
     CMPQ    BX, $16
     JBE     _9through16

     //# å¤§äº 16 å¼€å§‹ä½¿ç”¨ 128 ä½å¯„å­˜å™¨ X0ï¼Œ
     //# PXOR å°† X0 å¯„å­˜å™¨ç½®ä¸º 0
     PXOR    X0, X0
     CMPQ    BX, $32
     JBE     _17through32
     CMPQ    BX, $64
     JBE     _33through64
     CMPQ    BX, $128
     JBE     _65through128
     CMPQ    BX, $256
     JBE     _129through256
     // TODO: use branch table and BSR to make this just a single dispatch
     // TODO: for really big clears, use MOVNTDQ.

//# å¤§äº 256 åˆ™é€šè¿‡å¾ªç¯
loop:
     //# MOVOU ç›¸å½“äº AT&amp;amp;T/Intel çš„ MOVDQU -- ç§»åŠ¨éå¯¹é½çš„åŒå››å­—
     //# X0 ç›¸å½“ä¸ AT&amp;amp;T/Intel çš„ SSE æ–°å¢çš„ %xmm0(128ä½å…ƒæš‚å­˜å™¨)
     //# å‚è§ https://zh.wikipedia.org/wiki/SSE
     MOVOU   X0, 0(DI)
     MOVOU   X0, 16(DI)
     MOVOU   X0, 32(DI)
     MOVOU   X0, 48(DI)
     MOVOU   X0, 64(DI)
     MOVOU   X0, 80(DI)
     MOVOU   X0, 96(DI)
     MOVOU   X0, 112(DI)
     MOVOU   X0, 128(DI)
     MOVOU   X0, 144(DI)
     MOVOU   X0, 160(DI)
     MOVOU   X0, 176(DI)
     MOVOU   X0, 192(DI)
     MOVOU   X0, 208(DI)
     MOVOU   X0, 224(DI)
     MOVOU   X0, 240(DI)
     SUBQ    $256, BX  //# é€’å‡ BX
     ADDQ    $256, DI  //# é€’å¢ DI
     CMPQ    BX, $256
     JAE     loop      //# å¦‚æœ BX ä¾ç„¶å¤§äº 256 åˆ™ç»§ç»­å¾ªç¯
     JMP     tail      //# å¦åˆ™è¿›å…¥ tail

_1or2:
     MOVB    AX, (DI)
     MOVB    AX, -1(DI)(BX*1)
     RET
_0:
     RET
_3or4:
     MOVW    AX, (DI)
     MOVW    AX, -2(DI)(BX*1)
     RET
_5through8:
     MOVL    AX, (DI)
     MOVL    AX, -4(DI)(BX*1)
     RET
_9through16:
     MOVQ    AX, (DI)
     MOVQ    AX, -8(DI)(BX*1)
     RET
_17through32:
     MOVOU   X0, (DI)
     MOVOU   X0, -16(DI)(BX*1)
     RET
_33through64:
     MOVOU   X0, (DI)
     MOVOU   X0, 16(DI)
     MOVOU   X0, -32(DI)(BX*1)
     MOVOU   X0, -16(DI)(BX*1)
     RET
_65through128:
     MOVOU   X0, (DI)
     MOVOU   X0, 16(DI)
     MOVOU   X0, 32(DI)
     MOVOU   X0, 48(DI)
     MOVOU   X0, -64(DI)(BX*1)
     MOVOU   X0, -48(DI)(BX*1)
     MOVOU   X0, -32(DI)(BX*1)
     MOVOU   X0, -16(DI)(BX*1)
     RET
_129through256:
     MOVOU   X0, (DI)
     MOVOU   X0, 16(DI)
     MOVOU   X0, 32(DI)
     MOVOU   X0, 48(DI)
     MOVOU   X0, 64(DI)
     MOVOU   X0, 80(DI)
     MOVOU   X0, 96(DI)
     MOVOU   X0, 112(DI)
     MOVOU   X0, -128(DI)(BX*1)
     MOVOU   X0, -112(DI)(BX*1)
     MOVOU   X0, -96(DI)(BX*1)
     MOVOU   X0, -80(DI)(BX*1)
     MOVOU   X0, -64(DI)(BX*1)
     MOVOU   X0, -48(DI)(BX*1)
     MOVOU   X0, -32(DI)(BX*1)
     MOVOU   X0, -16(DI)(BX*1)
     RET
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;åœ¨æ­¤æœŸé—´å‚é˜…äº†å¤§é‡çš„èµ„æ–™ï¼Œæœ€å¤§çš„å‘å°±æ˜¯ Go ä½¿ç”¨çš„æ±‡ç¼–æ˜¯ Plan9è€Œéå¸¸è§çš„ x86 æ±‡ç¼–ï¼Œå‚è€ƒèµ„æ–™å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://quasilyte.github.io/blog/post/go-asm-complementary-reference/"&gt;https://quasilyte.github.io/blog/post/go-asm-complementary-reference/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://gocn.vip/article/733"&gt;https://gocn.vip/article/733&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://github.com/golang/arch/blob/master/x86/x86.csv"&gt;https://github.com/golang/arch/blob/master/x86/x86.csv&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://golang.org/doc/asm"&gt;https://golang.org/doc/asm&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</content><category term="Go"></category><category term="golang"></category><category term="go"></category><category term="æºç "></category><category term="plan9 æ±‡ç¼–"></category><category term="å†…å­˜æ¸…é™¤"></category><category term="memclr"></category></entry><entry><title>ä¿®æ”¹æœ¬åœ° Git å†å²</title><link href="https://www.linuxzen.com/xiu-gai-ben-di-git-li-shi.html" rel="alternate"></link><published>2018-11-21T16:33:00+08:00</published><updated>2018-11-21T16:33:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2018-11-21:/xiu-gai-ben-di-git-li-shi.html</id><summary type="html">&lt;blockquote&gt;
&lt;p&gt;å¾ˆæ—©ä¹‹å‰ä¸€ç¯‡å‘è¡¨åœ¨å†…éƒ¨çš„æ–‡ç« ï¼ŒæŠ½æ—¶é—´æ•´ç†äº†ä¸€ä¸‹å‘å¸ƒå‡ºæ¥ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;ä»¥ä¸‹æ“ä½œä¼šä¿®æ”¹æäº¤å†å², å¯èƒ½ä¼šé€ æˆä¸€äº›ä¸å¯æ¢å¤çš„é—® â€¦&lt;/strong&gt;&lt;/p&gt;</summary><content type="html">&lt;blockquote&gt;
&lt;p&gt;å¾ˆæ—©ä¹‹å‰ä¸€ç¯‡å‘è¡¨åœ¨å†…éƒ¨çš„æ–‡ç« ï¼ŒæŠ½æ—¶é—´æ•´ç†äº†ä¸€ä¸‹å‘å¸ƒå‡ºæ¥ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;strong&gt;ä»¥ä¸‹æ“ä½œä¼šä¿®æ”¹æäº¤å†å², å¯èƒ½ä¼šé€ æˆä¸€äº›ä¸å¯æ¢å¤çš„é—®é¢˜, &lt;em&gt;ä¸æ˜¯&lt;/em&gt; ä¸‹é¢æƒ…å†µä¸è¦è¿™ä¹ˆæ“ä½œ&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;åŸºäº GitHub Fork -&amp;gt; Pull Request æµç¨‹ä»…é’ˆå¯¹ Fork åçš„ä»“åº“è¿›è¡Œæ“ä½œ&lt;/li&gt;
&lt;li&gt;éç¬¬ä¸€ç§æƒ…å†µçš„å‰ææ˜¯å½“å‰ä¿®æ”¹çš„æäº¤è¿˜æœªæäº¤åˆ°è¿œç«¯&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;æ“ä½œä¸‹é¢å‘½ä»¤å‰æœ€å¥½å…ˆå¤‡ä»½&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id="_1"&gt;ä¿®æ”¹ä¸Šä¸€æ¡æäº¤çš„ä¿¡æ¯&lt;/h2&gt;
&lt;p&gt;æœ‰æ—¶å€™æˆ‘ä»¬åœ¨ç”¨ Git æäº¤åå‘ç°æäº¤ä¿¡æ¯(commit message)ä¸æ˜¯æˆ‘ä»¬é¢„æœŸçš„å†…å®¹(é”™åˆ«å­—æˆ–æè¿°é”™è¯¯ç­‰), è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯èƒ½æƒ³ä¿®æ”¹ä¸€ä¸‹ä¸Šä¸€æ¡æäº¤çš„ä¿¡æ¯, æœ‰ä¸¤ç§æ–¹å¼å¯ä»¥è¿›è¡Œ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;commit&lt;span class="w"&gt; &lt;/span&gt;--amend
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ¡å‘½ä»¤ä¼šç›´æ¥æ‰“å¼€ä½ çš„ç»ˆç«¯ç¼–è¾‘å™¨è®©ä½ å¯ä»¥ä¿®æ”¹æäº¤ä¿¡æ¯, ä¹Ÿå¯ä»¥ç»„åˆ &lt;code&gt;reset&lt;/code&gt; å‘½ä»¤é‡æ–°æäº¤:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;reset&lt;span class="w"&gt; &lt;/span&gt;HEAD^&lt;span class="w"&gt; &lt;/span&gt;--soft
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;commit&lt;span class="w"&gt; &lt;/span&gt;-m&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;new message&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ¡å‘½ä»¤ä¼šæ’¤é”€ä¸Šä¸€æ¡æäº¤, å¹¶å°†ä¸Šä¸€æ¡æäº¤çš„å†…å®¹æ”¾åœ¨å·¥ä½œåŒºå†…(git add ä¹‹åçš„åŒºåŸŸ), ç„¶åå°±å¯ä»¥é€šè¿‡ &lt;code&gt;git commit&lt;/code&gt; é‡æ–°æäº¤.&lt;/p&gt;
&lt;h2 id="_2"&gt;åˆå¹¶å¤šä¸ªæäº¤&lt;/h2&gt;
&lt;p&gt;æœ‰æ—¶æˆ‘ä»¬ä¸ºä»€ä¹ˆäº†æ–¹ä¾¿è®°å½•, ä¼šé¢‘ç¹çš„åˆ›å»ºä¸€äº› &lt;strong&gt;ä¸´æ—¶&lt;/strong&gt; æäº¤, æˆ‘ä»¬åœ¨å°†æäº¤æ¨é€åˆ°è¿œç«¯ä¹‹å‰å¯ä»¥é€šè¿‡ &lt;code&gt;git rebase&lt;/code&gt; æ¥å¯¹ç°æœ‰çš„å¤šæ¡æäº¤è¿›è¡Œåˆå¹¶å’Œç¼–è¾‘:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;rebase&lt;span class="w"&gt; &lt;/span&gt;-i&lt;span class="w"&gt; &lt;/span&gt;origin/master&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# master æ¢æˆä½ è¦æ¨é€åˆ°è¿œç«¯å¾—åˆ†æ”¯&lt;/span&gt;
&lt;span class="w"&gt;                                &lt;/span&gt;&lt;span class="c1"&gt;# åŸºäº Fork -&amp;gt; PR çš„æµç¨‹å¯ä»¥å°† origin/master æ›¿æ¢ä¸ºä¸Šæ¸¸æ‰€åœ¨çš„è¿œç«¯åˆ†æ”¯&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ¡å‘½ä»¤ä¼šæ‰“å¼€ä½ çš„ç»ˆç«¯ç¼–è¾‘å™¨, å¹¶æ˜¾ç¤ºç±»ä¼¼å¦‚ä¸‹çš„å†…å®¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nt"&gt;pick&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;48c9e10&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;tmp&lt;/span&gt;
&lt;span class="nt"&gt;pick&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;23354c6&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;tmp&lt;/span&gt;

&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;Rebase&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;3b92b89&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nc"&gt;23354c6&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;onto&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;3b92b89&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;commands&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;Commands&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;p&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;pick&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;commit&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;r&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;reword&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;commit&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;but&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;edit&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;commit&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;message&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;e&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;edit&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;commit&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;but&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;stop&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;amending&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;s&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;squash&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;commit&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;but&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;meld&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;into&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;previous&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;commit&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;f&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;fixup&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;like&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;squash&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;but&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;discard&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;this&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;commit&lt;/span&gt;&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="nt"&gt;s&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;log&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;message&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;x&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;exec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;run&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;command&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nt"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;rest&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;of&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;line&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;shell&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;d&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;drop&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;remove&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;commit&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;These&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;lines&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;can&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;be&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;re-ordered&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;they&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;are&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;executed&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;top&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;bottom&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;If&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;you&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;remove&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;line&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;here&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;THAT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;COMMIT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;WILL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;BE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;LOST&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;However&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;you&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;remove&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;everything&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;rebase&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;will&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;be&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;aborted&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;Note&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;that&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;empty&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;commits&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;are&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;commented&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;out&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å†…å®¹é‡Œé¢å·²ç»è¯´çš„å¾ˆæ˜æ˜¾äº†, æˆ‘ä»¬ç¿»è¯‘ä¸€ä¸‹å…³é”®ä¿¡æ¯:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;#&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;p&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;pick&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;ä½¿ç”¨æ­¤æäº¤
#&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;r&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;reword&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;ä½¿ç”¨æ­¤æäº¤,&lt;span class="w"&gt; &lt;/span&gt;ä½†ç¼–è¾‘å½“å‰æäº¤çš„æäº¤ä¿¡æ¯
#&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;e&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;edit&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;ä½¿ç”¨æ­¤æäº¤,&lt;span class="w"&gt; &lt;/span&gt;ä½†åœæ­¢ä¿®æ”¹
#&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;s&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;squash&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;ä½¿ç”¨æ­¤æäº¤,&lt;span class="w"&gt; &lt;/span&gt;ä½†å°†å½“å‰æäº¤åˆå¹¶åˆ°ä¸Šä¸€æ¡æäº¤
#&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;f&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;fixup&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;å’Œ&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;squash&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;ä¸€æ ·,&lt;span class="w"&gt; &lt;/span&gt;ä½†æ˜¯å¿½ç•¥æäº¤ä¿¡æ¯
#&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;x&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;exec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;ä½¿ç”¨&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;shell&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;è¿è¡Œå½“å‰è¡Œçš„å‘½ä»¤
#&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;d&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;drop&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;ç§»é™¤å½“å‰æäº¤
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é‚£ä¹ˆæˆ‘æƒ³åˆå¹¶è¿™ä¸¤æ¡æäº¤å¹¶æ›´æ”¹ä¸€ä¸‹ &lt;code&gt;commit message&lt;/code&gt; å†…å®¹å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;r 48c9e10 ä¸€ä¸ªæœ‰æ„ä¹‰çš„æäº¤ä¿¡æ¯
s 23354c6 tmp  # ç”¨ f ä¹Ÿè¡Œ
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="_3"&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;å¤§å®¶å¯ä»¥åˆ›å»ºä¸€ä¸ªç»ƒä¹ ä»“åº“ä¹Ÿä½“éªŒä¸€ä¸‹ä¸Šé¢å‘½ä»¤çš„ä¸åŒç‚¹, å¦å¤–å»ºè®®å¤šçœ‹çœ‹ &lt;a href="https://git-scm.com/book/en/v2"&gt;Pro Git Book&lt;/a&gt;ã€‚&lt;/p&gt;</content><category term="Git"></category><category term="Git"></category></entry><entry><title>é€šè¿‡ pyenv åœ¨ç”Ÿäº§ç¯å¢ƒå®‰è£… Python 3</title><link href="https://www.linuxzen.com/tong-guo-pyenv-zai-sheng-chan-huan-jing-an-zhuang-python-3.html" rel="alternate"></link><published>2018-11-21T15:00:00+08:00</published><updated>2018-11-21T15:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2018-11-21:/tong-guo-pyenv-zai-sheng-chan-huan-jing-an-zhuang-python-3.html</id><summary type="html">&lt;p&gt;&lt;a href="https://github.com/pyenv/pyenv"&gt;pyenv&lt;/a&gt; æ˜¯ä¸€ä¸ªç®€å•çš„ Python ç‰ˆæœ¬ç®¡ç†, å¯ä»¥å®‰è£…å¯¹åº”ç‰ˆæœ¬çš„ Python ä¸ä¾èµ–ç³»ç»Ÿçš„åŒ…ç®¡ç†, æˆ‘ç”¨å®ƒæ¥åœ¨ç”Ÿäº§å’Œæµ‹è¯•ç¯å¢ƒå®‰è£…  Python 3.6.&lt;/p&gt;
&lt;p&gt;å®ƒçš„ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a href="https://github.com/pyenv/pyenv"&gt;pyenv&lt;/a&gt; æ˜¯ä¸€ä¸ªç®€å•çš„ Python ç‰ˆæœ¬ç®¡ç†, å¯ä»¥å®‰è£…å¯¹åº”ç‰ˆæœ¬çš„ Python ä¸ä¾èµ–ç³»ç»Ÿçš„åŒ…ç®¡ç†, æˆ‘ç”¨å®ƒæ¥åœ¨ç”Ÿäº§å’Œæµ‹è¯•ç¯å¢ƒå®‰è£…  Python 3.6.&lt;/p&gt;
&lt;p&gt;å®ƒçš„åŸºæœ¬åŸç†æ˜¯å®‰è£…å¯¹åº”ç‰ˆæœ¬çš„ Python åœ¨å®ƒè‡ªå·±çš„ç›®å½•ä¸‹, ç„¶åå°†å¯¹åº”çš„ &lt;code&gt;bin&lt;/code&gt; ç›®å½•é€šè¿‡æ’å…¥ &lt;code&gt;PATH&lt;/code&gt; å˜é‡é‡Œå®ç°.&lt;/p&gt;
&lt;p&gt;å®‰è£…å¯ä»¥å‚è€ƒ&lt;a href="https://github.com/pyenv/pyenv#basic-github-checkout"&gt;å®˜æ–¹æ–‡æ¡£&lt;/a&gt;, ä½†æ˜¯ç”¨å®ƒéƒ¨ç½² å®‰è£…åœ¨ HOME ç›®å½•ä¸‹ä¼šå¼•èµ·ä¸€äº›æƒé™é—®é¢˜, æ‰€ä»¥æˆ‘å°†å®‰è£…ç›®å½•æ”¾åœ¨äº† &lt;code&gt;/srv/pyenv&lt;/code&gt; ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;clone&lt;span class="w"&gt; &lt;/span&gt;https://github.com/pyenv/pyenv.git&lt;span class="w"&gt; &lt;/span&gt;/srv/pyenv
$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;export PYENV_ROOT=&amp;quot;/srv/pyenv&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;~/.bash_profile
$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;export PATH=&amp;quot;$PYENV_ROOT/bin:$PATH&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;~/.bash_profile
$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;source&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;~/.bash_profile
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šé¢æ˜¯é’ˆå¯¹ Bash shell çš„å®‰è£…, zsh éœ€å°† &lt;code&gt;~/.bash_profile&lt;/code&gt; æ›¿æ¢ä¸º &lt;code&gt;~/.zshrc&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åå°±å¯ä»¥ä½¿ç”¨ &lt;code&gt;pyenv&lt;/code&gt; æ¥å®‰è£… Python äº†, æˆ‘ä»¬æ¥å®‰è£… Python 3.6.2ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;apt-get&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;build-essential&lt;span class="w"&gt; &lt;/span&gt;libssl-dev&lt;span class="w"&gt; &lt;/span&gt;zlib1g-dev&lt;span class="w"&gt; &lt;/span&gt;libbz2-dev&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
libreadline-dev&lt;span class="w"&gt; &lt;/span&gt;libsqlite3-dev&lt;span class="w"&gt; &lt;/span&gt;wget&lt;span class="w"&gt; &lt;/span&gt;curl&lt;span class="w"&gt; &lt;/span&gt;llvm&lt;span class="w"&gt; &lt;/span&gt;libncurses5-dev&lt;span class="w"&gt; &lt;/span&gt;libncursesw5-dev&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
xz-utils&lt;span class="w"&gt; &lt;/span&gt;tk-dev
$&lt;span class="w"&gt; &lt;/span&gt;pyenv&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;.6.2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…å®Œæˆåå¯ä»¥åœ¨ Supervisor ç­‰é…ç½®æ–‡ä»¶ä¸­é€šè¿‡ &lt;code&gt;/srv/pyenv/versions/3.6.2/bin/python&lt;/code&gt; æ¥ä½¿ç”¨ Python 3.6.2&lt;/p&gt;
&lt;h2 id="_1"&gt;åŠ é€Ÿ&lt;/h2&gt;
&lt;p&gt;é€šå¸¸æƒ…å†µä¸‹ pyenv ä¸‹è½½ Python åŒ…ä¼šæ¯”è¾ƒæ…¢ï¼Œæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨ä¸‹è½½ç›¸å…³åŒ…ä¸Šä¼ åˆ°æ¯”è¾ƒå¿«çš„æ–‡ä»¶æœåŠ¡ï¼Œç„¶åè¿›è¡Œæ›¿æ¢ã€‚
å‡è®¾æˆ‘ä»¬ä¸Šä¼ åå¾—åˆ°çš„ URL ä¸ºï¼š https://file.example.com/sources/python/Python-3.6.2.tar.xz ï¼Œ
å¯é€šè¿‡å¦‚ä¸‹å‘½ä»¤è¿›è¡Œæ›¿æ¢ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;PYENV_PY_VERSION&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;.6.2
$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;SPEEDUP_URL&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;https://file.example.com/sources/python/Python-&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;PYENV_PY_VERSION&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;.tar.xz
$&lt;span class="w"&gt; &lt;/span&gt;sed&lt;span class="w"&gt; &lt;/span&gt;-i&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;s;https://www.python.org/ftp/python/&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;PYENV_PY_VERSION&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;/Python-&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;PYENV_PY_VERSION&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;.tar.xz;&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;SPEEDUP_URL&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;&lt;span class="s2"&gt;;&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/srv/pyenv/plugins/python-build/share/python-build/&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;PYENV_PY_VERSION&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;pyenv&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;PYENV_PY_VERSION&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Python"></category><category term="Python"></category><category term="2to3"></category></entry><entry><title>è§£å†³ macOS ä¸‹å®‰è£… pycurl åå¯¼å…¥é”™è¯¯</title><link href="https://www.linuxzen.com/jie-jue-macos-xia-an-zhuang-pycurl-hou-dao-ru-cuo-wu.html" rel="alternate"></link><published>2018-11-20T15:00:00+08:00</published><updated>2018-11-20T15:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2018-11-20:/jie-jue-macos-xia-an-zhuang-pycurl-hou-dao-ru-cuo-wu.html</id><summary type="html">&lt;p&gt;åœ¨ macOS ä¸‹å®‰è£… PycURL å &lt;code&gt;import curl&lt;/code&gt; ä¼šæç¤º:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;ImportError&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pycurl&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;libcurl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;link&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;version&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;7.43&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;older&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;than&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;version&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;7.49&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ˜¯å› ä¸ºç³»ç»Ÿä¸­çš„ curl ç‰ˆæœ¬è¿‡è€å¯¼è‡´, å¯ä»¥é€šè¿‡ä½¿ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;åœ¨ macOS ä¸‹å®‰è£… PycURL å &lt;code&gt;import curl&lt;/code&gt; ä¼šæç¤º:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;ImportError&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pycurl&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;libcurl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;link&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;version&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;7.43&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;older&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;than&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;version&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;7.49&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ˜¯å› ä¸ºç³»ç»Ÿä¸­çš„ curl ç‰ˆæœ¬è¿‡è€å¯¼è‡´, å¯ä»¥é€šè¿‡ä½¿ç”¨  &lt;code&gt;Homebrew&lt;/code&gt; å®‰è£…æœ€æ–°ç‰ˆæ¥è§£å†³:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;brew&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;curl
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…å®Œæˆåä¼šæç¤ºä¸€äº›ä¿¡æ¯, æŒ‰ç…§æç¤ºçš„ä¿¡æ¯å°† &lt;code&gt;curl&lt;/code&gt; åŠ å…¥åˆ° PATH è·¯å¾„, å‚è€ƒ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;export PATH=&amp;quot;/usr/local/opt/curl/bin:$PATH&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;~/.zshrc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœä½¿ç”¨çš„é zsh åˆ™å°†ä¸Šé¢æ›¿æ¢ä¸º:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;export PATH=&amp;quot;/usr/local/opt/curl/bin:$PATH&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;~/.bashrc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®Œæˆåé‡æ–°åˆå§‹åŒ– shell:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;source&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;~/.zshrc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åç¦ç”¨ &lt;code&gt;pip&lt;/code&gt; ç¼“å­˜é‡æ–°å®‰è£… &lt;code&gt;pycurl&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;pip&lt;span class="w"&gt; &lt;/span&gt;uninstall&lt;span class="w"&gt; &lt;/span&gt;pycurl
$&lt;span class="w"&gt; &lt;/span&gt;pip&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;-U&lt;span class="w"&gt; &lt;/span&gt;pycurl&lt;span class="w"&gt; &lt;/span&gt;--no-cache-dir
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœä½¿ç”¨ &lt;code&gt;tox&lt;/code&gt; å¯ä»¥ä½¿ç”¨  &lt;code&gt;-r&lt;/code&gt; å‚æ•°é‡å»º &lt;code&gt;virtualenv&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;tox&lt;span class="w"&gt; &lt;/span&gt;-r&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;py36
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è‹¥ä¾ç„¶å­˜åœ¨é—®é¢˜å¯ä»¥æ‰‹åŠ¨åˆ é™¤ &lt;code&gt;pip&lt;/code&gt; ç¼“å­˜ç›®å½•é‡è¯•:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;rm&lt;span class="w"&gt; &lt;/span&gt;-rf&lt;span class="w"&gt; &lt;/span&gt;~/Library/Caches/pip/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚é‡åˆ°ä¸‹é¢é—®é¢˜ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nv"&gt;__main__&lt;/span&gt;.&lt;span class="nv"&gt;ConfigurationError&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;Curl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;configured&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;SSL&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;but&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;we&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;have&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;not&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;been&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;able&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;determine&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;which&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;SSL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;backend&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;it&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;using&lt;/span&gt;.&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;Please&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;see&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;PycURL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;documentation&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;how&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;specify&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;SSL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;backend&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;manually&lt;/span&gt;.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¯ä»¥é€šè¿‡å¦‚ä¸‹å‘½ä»¤é‡æ–°å®‰è£… &lt;code&gt;curl&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;brew&lt;span class="w"&gt; &lt;/span&gt;reinstall&lt;span class="w"&gt; &lt;/span&gt;curl&lt;span class="w"&gt; &lt;/span&gt;--with-openssl
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åé‡æ–°å®‰è£… &lt;code&gt;pycurl&lt;/code&gt;ï¼Œå¦‚æœè¿˜ä¸è¡Œå¯ä»¥å°è¯•é‡å¯ Shellã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœé€šè¿‡ &lt;code&gt;tox&lt;/code&gt; ä¾ç„¶ä¸è¡Œå¯ä»¥è®¾ç½®å¦‚ä¸‹ç¯å¢ƒå˜é‡ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;export&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;LDFLAGS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;-L/usr/local/opt/openssl/lib
&lt;span class="nb"&gt;export&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;CPPFLAGS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;-I/usr/local/opt/openssl/include
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Python"></category><category term="pycurl"></category><category term="macOS"></category><category term="OSX"></category></entry><entry><title>ä»å•ä¸€è½¯ä»¶åˆ°å¤„å¤„å®è·µ GTD</title><link href="https://www.linuxzen.com/practice-gtd-everywhere.html" rel="alternate"></link><published>2018-08-05T00:00:00+08:00</published><updated>2018-08-05T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2018-08-05:/practice-gtd-everywhere.html</id><summary type="html">&lt;blockquote&gt;
&lt;p&gt;è¿™ç¯‡æ–‡ç« é¦–å‘äºæˆ‘ä»¬å›¢é˜Ÿå†…éƒ¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åˆšå¼€å§‹æ¥è§¦ &lt;a href="https://zh.wikipedia.org/wiki/%E5%B0%BD%E7%AE%A1%E5%8E%BB%E5%81%9A"&gt;GTD&lt;/a&gt; æ—¶æˆ‘æ˜¯æ‰¾äº†ä¸€ä¸ªè½¯ä»¶æ¥å®è·µ GTDï¼Œ
ä½†æ˜¯æ•ˆæœä¸æ˜¯ç‰¹åˆ«å¥½ï¼Œä¸»è¦ä¸‰ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ”¶é›†éº»çƒ¦&lt;/li&gt;
&lt;li&gt;éœ€ â€¦&lt;/li&gt;&lt;/ol&gt;</summary><content type="html">&lt;blockquote&gt;
&lt;p&gt;è¿™ç¯‡æ–‡ç« é¦–å‘äºæˆ‘ä»¬å›¢é˜Ÿå†…éƒ¨ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;åˆšå¼€å§‹æ¥è§¦ &lt;a href="https://zh.wikipedia.org/wiki/%E5%B0%BD%E7%AE%A1%E5%8E%BB%E5%81%9A"&gt;GTD&lt;/a&gt; æ—¶æˆ‘æ˜¯æ‰¾äº†ä¸€ä¸ªè½¯ä»¶æ¥å®è·µ GTDï¼Œ
ä½†æ˜¯æ•ˆæœä¸æ˜¯ç‰¹åˆ«å¥½ï¼Œä¸»è¦ä¸‰ç‚¹ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;æ”¶é›†éº»çƒ¦&lt;/li&gt;
&lt;li&gt;éœ€è¦å•ç‹¬çš„è½¯ä»¶ï¼Œæˆ‘ä¸€èˆ¬ä¼šä¸ºäº†èŠ‚çœèµ„æºå°½é‡å°‘å¼€è½¯ä»¶çš„çš„äººï¼Œæ‰€ä»¥æˆ‘å¯¹æ‰“å¼€å¾ˆå¤šçš„è½¯ä»¶ä¼šå¾ˆä¸çˆ½&lt;/li&gt;
&lt;li&gt;æœ€ä¸»è¦æ˜¯æ‡’&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;æ‰€ä»¥åæ¥æˆ‘å°±å¼€å§‹æ…¢æ…¢æ”¾å¼ƒæ”¶é›†ï¼Œå†ä¹Ÿä¸æ‰“å¼€é‚£ä¸ªè½¯ä»¶ã€‚å†æ¥ç€æˆ‘å‘ç°å…¶å®æˆ‘ä»¬æ‰€ç”¨åˆ°çš„å¾ˆå¤šè½¯ä»¶éƒ½å¸®æˆ‘ä»¬å·²ç»å®ç°äº†ç±»ä¼¼çš„æœºåˆ¶ã€‚ä¸‹é¢ä¸¾å‡ ä¸ªæˆ‘ç”¨æ¥å®è·µ GTD çš„åœ°æ–¹ã€‚&lt;/p&gt;
&lt;h2 id="_1"&gt;é‚®ç®±&lt;/h2&gt;
&lt;p&gt;å¤§éƒ¨åˆ†æƒ…å†µä¸‹å¦‚æœåˆ«äººè®©æˆ‘åšä¸€ä»¶äº‹æˆ‘ä¼šè®© Ta ç»™æˆ‘å‘ä¸€å°é‚®ä»¶ï¼Œå¦‚æœæˆ‘æ²¡æœ‰å®Œæˆé‚®ä»¶ä¸­çš„å·¥ä½œé‚£è¿™å°é‚®ä»¶å°±ä¼šä¸€ç›´åœ¨æ”¶ä»¶ç®±é‡Œèººç€ï¼Œ
ç›´åˆ°æˆ‘å®Œæˆäº†å¯¹åº”çš„å·¥ä½œæˆ‘å°±ä¼šé€‰æ‹©å°†ä¹‹å½’æ¡£æˆ–ç§»åŠ¨åˆ°ç‰¹å®šçš„æ–‡ä»¶å¤¹ï¼Œæ‰€ä»¥æˆ‘ç›®å‰æœ‰ä¸Šä¸‡å°é‚®ä»¶ä½†æ˜¯æ”¶ä»¶ç®±é‡Œåªæœ‰å°‘æ•°æ²¡æœ‰å®Œæˆçš„é‚®ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;æ¯å¤©æˆ‘æ‰“å¼€é‚®ä»¶çœ‹åˆ°æ”¶ä»¶ç®±æˆ‘å°±çŸ¥é“å“ªäº›è¿˜æ²¡æœ‰åšã€‚&lt;/p&gt;
&lt;h2 id="_2"&gt;ç¦…é“&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬å†…éƒ¨ä½¿ç”¨ç¦…é“åšé¡¹ç›®ç®¡ç†å’Œ Bug è·Ÿè¸ªï¼Œæµ‹è¯•å’Œäº§å“ä¼šæŒ‡æ´¾ç»™æˆ‘ä»¬ä¸€äº› Bug æˆ–éœ€æ±‚ï¼Œæˆ‘ä»¬æ²¡æœ‰å®Œæˆå°±ä¼šä¸€ç›´åœ¨æˆ‘ä»¬åä¸‹ã€‚
ä½†æ˜¯æœ‰ä¸€ç‚¹æ˜¯éœ€è¦æ³¨æ„çš„å°±æ˜¯æˆ‘ä»¬ä¸€æ—¦å®Œæˆï¼ˆæˆ–è€…è¯´æ¥ä¸‹æ¥éœ€è¦ä»–äººå¤„ç†ï¼‰é‚£ä¹ˆå°±éœ€è¦åŠæ—¶å˜æ›´çŠ¶æ€ï¼Œ
è¿™æ ·å°±å¯ä»¥æ¨åŠ¨åˆ«äººæ¥ç»§ç»­ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸è¦æŠŠä¸å±äºè‡ªå·±çš„éƒ¨åˆ†æ”¾åœ¨è‡ªå·±åä¸‹ã€‚&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id="gitlab"&gt;GitLab&lt;/h2&gt;
&lt;p&gt;GitLab å³ä¸Šè§’æœ‰ä¸€ä¸ª TODO çš„é€šçŸ¥ï¼Œä¸€èˆ¬æˆ‘æ²¡æœ‰å®Œæˆçš„æˆ‘æ˜¯ä¸ä¼šç‚¹å‡»å®Œæˆï¼ˆDoneï¼‰çš„ã€‚æ¯”å¦‚ä»Šå¤©æœ‰ä¸€ä¸ªå‘é€å‘¨æŠ¥çš„ Issue æé†’ï¼Œæˆ‘ä¼šç›´åˆ°æˆ‘å‘å®Œå‘¨åˆ°æ‰ä¼šç‚¹å‡» Done è®©è¿™ä¸ªæé†’æ¶ˆå¤±ã€‚&lt;/p&gt;
&lt;h2 id="_3"&gt;ä¸“é—¨çš„è½¯ä»¶&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬çš„å·¥ä½œå¾€å¾€ä¸ä¼šæ˜¯åªæ¥æºäºä»¥ä¸Šè¿™äº›æ¸ é“ï¼Œè¿™æ—¶å€™ä½ å°±éœ€è¦ä¸“é—¨çš„è½¯ä»¶æ¥è®°å½•ã€‚æ¯”å¦‚æˆ‘ä½¿ç”¨çš„ Emacs è‡ªå¸¦çš„ Org-mode æ¥å®ç° GTDã€‚&lt;/p&gt;
&lt;h2 id="_4"&gt;æµè§ˆå™¨&lt;/h2&gt;
&lt;p&gt;æˆ‘ä¹Ÿä¼šç”¨æµè§ˆå™¨çš„æ ‡ç­¾æ¥è®°å½•æœªå®Œæˆçš„ä»»åŠ¡ï¼Œæ¯”å¦‚æœ‰äº›ä¸´æ—¶ä»»åŠ¡æˆ‘æ²¡æœ‰å®Œæˆæˆ‘ä¼šä¿ç•™è¯¥æµè§ˆå™¨æ ‡ç­¾ã€‚
å‰ææ˜¯æˆ‘æœ‰ä¸ªä¹ æƒ¯ï¼Œå°±æ˜¯ä¼šåŠæ—¶å…³é—­ä¸å†éœ€è¦çš„æµè§ˆå™¨æ ‡ç­¾ã€‚æ‰€ä»¥æˆ‘çš„æµè§ˆå™¨æ ‡ç­¾ä¸€ç›´ä¼šå¤„äºéå¸¸å°‘çš„çŠ¶æ€ã€‚&lt;/p&gt;
&lt;h2 id="_5"&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;ä¸€æ—¦é‡‡ç”¨çš„ GTD é‚£ä¹ˆæœ€é‡è¦çš„æ˜¯è¦æ—¶é•¿æŸ¥çœ‹è¿™äº›åœ°æ–¹æ˜¯å¦æœ‰æœªå®Œæˆçš„å·¥ä½œï¼Œå¹¶ä¸”åŠæ—¶å®Œæˆã€‚æ¯”å¦‚æˆ‘å°±ä¼šç»å¸¸æ‰“å¼€é‚®ä»¶ã€ç¦…é“ã€GitLab å’Œæˆ‘çš„ Emacs GTD æ¥æŸ¥çœ‹æœªå®Œæˆçš„ä»»åŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ—¶å¦‚æœå®Œæˆä¸äº†æˆ–éœ€è¦ä»–äººç»§ç»­ä¹Ÿè¦åŠæ—¶æ¨åŠ¨å…¶ä»–äººå‘˜ï¼Œè¿™æ ·æ‰èƒ½è¿›è¡Œé«˜æ•ˆçš„å·¥ä½œå’ŒååŒã€‚&lt;/p&gt;</content><category term="Other"></category><category term="GTD"></category><category term="é«˜æ•ˆ"></category></entry><entry><title>åˆ›ä¸šå…¬å¸æŠ€æœ¯è¿›åŒ–ä¹‹è·¯</title><link href="https://www.linuxzen.com/development-eveloping-in-startup.html" rel="alternate"></link><published>2018-08-04T00:00:00+08:00</published><updated>2018-08-04T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2018-08-04:/development-eveloping-in-startup.html</id><summary type="html">&lt;p class="first last"&gt;æœ¬æ–‡åˆ†äº«åˆ›ä¸šå…¬å¸åœ¨æŠ€æœ¯å±‚é¢çš„è¿›åŒ–ä¹‹è·¯ã€‚åŒ…æ‹¬æŠ€æœ¯é€‰å‹ã€æŠ€æœ¯è¿ç§»å’Œ CI/CDã€‚&lt;/p&gt;
</summary><content type="html">&lt;p&gt;TL;DR&lt;/p&gt;
&lt;p&gt;4 å¹´å‰æˆ‘æœ‰å¹¸åŠ å…¥åˆ°ç°åœ¨è¿™å®¶å…¬å¸ï¼Œæˆä¸ºäº†å…¬å¸æ—©æœŸå‘˜å·¥ä¹‹ä¸€ï¼Œåæ¥åœ¨å¼€å‘ä¸Šæ…¢æ…¢çš„å¾—åˆ°äº†ä¸€äº›ä¸»åŠ¨æƒï¼Œç„¶åæˆ‘å°±å¼€å§‹å‡­å€Ÿç€è‡ªå·±çš„æ‘¸ç´¢æ…¢æ…¢çš„å®Œå–„äº†ä¸€äº›æŠ€æœ¯å±‚é¢ç›¸å…³çš„ä¸œè¥¿ã€‚
è¿™ç¯‡æ–‡ç« ä¸»è¦åˆ†äº«ä¸€ä¸‹è¿™å…¶ä¸­çš„è¿‡ç¨‹ï¼Œå‰é¢çš„ä¸€äº›æ–‡ç« ä¹Ÿæœ‰æ¶‰åŠä½†ä¸å…¨é¢ï¼Œè¿™é‡Œè¿›è¡Œä¸€ä¸ªæ€»ç»“ã€‚å…¶å®è¿™ç¯‡æ–‡ç« ä¹Ÿå¯ä»¥å«ä½œã€Šæˆ‘åœ¨åˆ›ä¸šå…¬å¸è¿™ 4 å¹´ã€‹ã€‚&lt;/p&gt;
&lt;div class="section" id="section-2"&gt;
&lt;h2&gt;é¢å‘æ‹›è˜çš„æŠ€æœ¯é€‰å‹&lt;/h2&gt;
&lt;p&gt;å¼€å§‹å…¬å¸çš„ä¸šåŠ¡ä¸»è¦æ˜¯è½¦è½½ç‰©è”ç½‘ç¡¬ä»¶ï¼Œæ¶‰åŠå¤§é‡ TCP è¿æ¥å»ºç«‹å’Œæ•°æ®ä¼ è¾“ï¼Œæ‰€ä»¥æ­¤æ—¶çš„æŠ€æœ¯é€‰å‹ä¸»è¦æ˜¯ Tornadoï¼Œä¸»è¦ç”¨äºä»¥ä¸‹ä¸¤ä¸ªæ–¹é¢ï¼š&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;TCP Server å¤„ç†ç¡¬ä»¶ TCP è¿æ¥&lt;/li&gt;
&lt;li&gt;Web æ¡†æ¶ï¼Œå®ç°å®¢æˆ·ç«¯ API&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸­é—´ä¹Ÿå°è¯•ä½¿ç”¨ Flask å®ç°ç®¡ç†åå°ï¼Œä½†å½“æ—¶çš„æˆ‘å¯¹ Tornado æœ‰éå¸¸æ‰§ç€çš„çˆ±ï¼Œæ‰€ä»¥åœ¨åé¢çš„é¡¹ç›®ä¸­æŠ€æœ¯é€‰å‹ä¾ç„¶é‡‡ç”¨ Tornado ä½œä¸ºä¸»è¦æ¡†æ¶ã€‚
æ‰€ä»¥å½“æ—¶çš„æŠ€æœ¯é€‰å‹æ˜¯ï¼š&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Tornado ä½œä¸º TCP Server å’Œå®¢æˆ·ç«¯ API Web æ¡†æ¶&lt;/li&gt;
&lt;li&gt;é‡‡ç”¨ Flask ä½œä¸ºåå°ç®¡ç†çš„æ¡†æ¶&lt;/li&gt;
&lt;li&gt;å‰ç«¯é‡‡ç”¨ Bootstrap 3 + jQuery&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;åé¢å…¬å¸è½¬å‹åšäº’è”ç½‘è½¦é™© SaaS å¹³å°ä¹Ÿä¸€ç›´æ²¿ç”¨è¿™äº›é€‰å‹ï¼Œç›´åˆ°åæ¥ä¸šåŠ¡å¼€å§‹å¢é•¿éœ€è¦æ‹›äººçš„æ—¶å€™æ‰å‘ç°å¸‚é¢ä¸Šç†Ÿæ‚‰ Tornado çš„äººå‘˜æ¯”è¾ƒéš¾æ‹›ï¼Œ
è¿™æ—¶å€™åˆé¢ä¸´å…¬å¸ä¸šåŠ¡æ‹†åˆ†ï¼ŒåŒæ—¶å½“ä¸‹å‰åç«¯åˆ†ç¦»ä¹Ÿæ¯”è¾ƒç«ï¼Œåç«¯æ¨¡æ¿æ¸²æŸ“çš„æƒ…å†µä¸‹éœ€è¦åç«¯äº†è§£ä¸€äº›åŸºæœ¬çš„å‰ç«¯çŸ¥è¯†ï¼Œè€Œä¸”è¿™ç§æƒ…å†µä¸‹åŒå‰ç«¯å·¥ç¨‹å¸ˆå¹¶ä¸å¤ªå¥½ååŒï¼Œ
æ‰€ä»¥è¿™æ—¶å€™æ–°çš„äº§å“çº¿å¼€å§‹é‡‡ç”¨å¦‚ä¸‹æŠ€æœ¯é€‰å‹&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Django ä½œä¸º Web æ¡†æ¶&lt;/li&gt;
&lt;li&gt;å‰ç«¯ä½¿ç”¨ React&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é€‰æ‹© React å®Œå…¨æ˜¯æ˜¯å‡ºäºå¯¹ React ç¤¾åŒºå’Œ JSX çš„å–œçˆ±ï¼Œä½†æ˜¯åšå®Œä¸€ä¸ªé¡¹ç›®ä¹‹åå‘ç°äº†ä¸€ä¸ªç›¸åŒçš„é—®é¢˜ï¼Œå°±æ˜¯æ‹›äººéå¸¸å›°éš¾ï¼Œç‰¹åˆ«å¯¹äºå°å…¬å¸æ¥è¯´å°±æ›´éš¾äº†ã€‚
æ‰€ä»¥åç»­å°±æŠŠä¸€äº›æ–°é¡¹ç›®æ”¹ä¸ºé‡‡ç”¨ Vueï¼Œæ‹›äººä¹Ÿä» React è°ƒæ•´ä¸º Vueã€‚æ‰€ä»¥å°±ç›®å‰æ¥è®²æœ€ç»ˆé‡‡ç”¨çš„æŠ€æœ¯é€‰å‹å°±æ˜¯ï¼š&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;åç«¯ä½¿ç”¨ Django ä½œä¸º Web æ¡†æ¶&lt;/li&gt;
&lt;li&gt;å‰ç«¯ä½¿ç”¨ Vue ä½œä¸ºå¼€å‘æ¡†æ¶&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä»è¿™äº›å°±èƒ½çœ‹å‡ºæ¥å°å…¬å¸åœ¨æŠ€æœ¯é€‰å‹æ—¶å°±ä¸èƒ½å®Œå…¨é å–œå¥½ï¼Œéœ€è¦ç»“åˆå¸‚é¢ä¸Šçš„äººæ‰å æ¯”æ¥é€‰æ‹©åˆé€‚çš„æŠ€æœ¯ã€‚&lt;/p&gt;
&lt;p&gt;é‡‡ç”¨å‰åç«¯åˆ†ç¦»æ¶æ„ä¹‹åå¥½å¤„æ˜¯ä¾¿æ˜¯å¯¹åç«¯çš„å‰ç«¯ç›¸å…³çŸ¥è¯†ä¸å†æ˜¯ç¡¬æ€§è¦æ±‚ï¼Œå‰åç«¯å¼€å‘å¯ä»¥å¹¶è¡Œè¿›è¡Œï¼ŒåŒæ—¶å‰ç«¯ä»£ç çš„è´¨é‡ä¹Ÿæ¯”è¾ƒå¥½æŠŠæ§ã€‚
æˆ‘ä»¬å°±å‡ºç°å¾ˆå¤šåç«¯å·¥ç¨‹å¸ˆè¿ Bootstrap éƒ½ç”¨ä¸å¥½çš„æƒ…å†µã€‚&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯åç«¯æ¡†æ¶ä½¿ç”¨ Django å¥½å¤„å°±æ˜¯å¯¹äºäººäº‹æ¥è¯´å¯ä»¥æ›´å¥½çš„ç­›é€‰ç®€å†ï¼Œå› ä¸ºäººäº‹çœ‹æ¥ç®€å†ä¸Šå‡ºç° Tornado å…³é”®å­—çš„å®åœ¨æ˜¯å¤ªå°‘äº†ï¼Œ
æ‰€ä»¥æˆ‘ä»¬å½“å‰å¹´åº¦çš„ 3ã€4 æœˆä»½æ‹›è˜æ—ºå­£ç®—æ˜¯åŸºæœ¬å®Œæˆæ‹›è˜ä»»åŠ¡çš„ã€‚åŒæ—¶ä¹Ÿå¯¹ Django æœ‰ä¸€ä¸ªå…¨æ–°çš„è®¤è¯†ï¼Œçº æ­£äº†æˆ‘å¾ˆå¤šåè§ä¹Ÿå­¦åˆ°äº†å¾ˆå¤šä¸œè¥¿ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="git"&gt;
&lt;h2&gt;åŸºäº Git çš„å†…éƒ¨åŒ…ç®¡ç†&lt;/h2&gt;
&lt;p&gt;ç”±äºåæœŸçš„ä¸šåŠ¡è½¬å‹çš„æ—¶å€™é¡¹ç›®æ‹†åˆ†æ¯”è¾ƒç»†ï¼Œæ‰€ä»¥ä»è¿™æ—¶å€™èµ·å°±å¼€å§‹æœ‰æ„è¯†çš„æå–ä¸€äº›å…¬å…±é€»è¾‘æ”¾åœ¨å•ç‹¬çš„åŒ…é‡Œï¼Œ
æ—©æœŸè¿™ä¸ªåŒ…æ˜¯é€šè¿‡æ‹·è´çš„æ–¹å¼æ”¾åœ¨ä¸åŒçš„é¡¹ç›®é‡Œï¼Œè¿™æ ·æ›´æ–°å°±æ¯”è¾ƒéº»çƒ¦ï¼Œåç»­äº†è§£åˆ° &lt;tt class="docutils literal"&gt;pip&lt;/tt&gt; æ˜¯å¯ä»¥é€šè¿‡ &lt;cite&gt;git&lt;/cite&gt; æ¥å®‰è£…åŒ…çš„ï¼Œ
æ‰€ä»¥åæ¥å°±å°†è¿™ä¸ªåŒ…æ”¾åœ¨å•ç‹¬çš„ä»“åº“ï¼Œæ¯ä¸ªé¡¹ç›®é€šè¿‡åœ¨ &lt;tt class="docutils literal"&gt;requirements.txt&lt;/tt&gt; å¢åŠ ç±»ä¼¼ä¸‹é¢çš„å†…å®¹æ¥å¼•ç”¨ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;git+ssh://git@github.com/Owner/foobar@v2.14
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™æ ·æœ‰å¥½å¤„ä¹Ÿæœ‰ä¸€äº›åå¤„ï¼Œå¥½å¤„å°±æ˜¯æ›´æ–°è¿­ä»£æ–¹ä¾¿ï¼Œåå¤„å°±æ˜¯å¢åŠ éƒ¨ç½²æˆæœ¬ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="section-3"&gt;
&lt;h2&gt;éƒ¨ç½²&lt;/h2&gt;
&lt;div class="section" id="fabric"&gt;
&lt;h3&gt;Fabric&lt;/h3&gt;
&lt;p&gt;æ—©æœŸé¡¹ç›®åªæœ‰ä¸€ä¸ªæ‰€ä»¥éƒ¨ç½²åŸºæœ¬æ˜¯æ‰‹åŠ¨ï¼ŒåæœŸé¡¹ç›®å¼€å§‹å˜å¾—å¤šèµ·æ¥ï¼Œæ‰‹åŠ¨éƒ¨ç½²å°±å˜å¾—éº»çƒ¦èµ·æ¥ï¼Œè¿™æ—¶å€™å¼€å§‹ä½¿ç”¨ Fabric å†™ä¸€äº›éƒ¨ç½²è„šæœ¬ã€‚
åæ¥å°±å†™äº†ä¸€å¥—é€šç”¨çš„è§„åˆ™ï¼Œç„¶åæš´æ¼å‡ºä¸€äº›é…ç½®æ¥å£ï¼Œé…ç½®è¯¸å¦‚ä»“åº“ URLï¼ŒSupervisor å¯åŠ¨é¡¹ç­‰ç­‰ï¼Œç„¶åå°†ä¹‹æ”¾åœ¨é€šç”¨åº“é‡Œï¼Œ
åŒæ—¶ç¼–å†™ä¸€å¥— &lt;tt class="docutils literal"&gt;Makefile&lt;/tt&gt; çš„è§„åˆ™æ”¾åœ¨é€šç”¨åº“é‡Œï¼Œæˆ‘ä»¬çš„é€šç”¨åº“å–åæ˜¯ &lt;tt class="docutils literal"&gt;allspark&lt;/tt&gt;ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æ ·ç›´æ¥åœ¨é¡¹ç›®ä¸­æ”¾ä¸€ä¸ª &lt;tt class="docutils literal"&gt;Makefile&lt;/tt&gt; æ·»åŠ ç±»ä¼¼ä¸‹é¢çš„å†…å®¹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="nv"&gt;ALLSPARK_PTH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;shell&lt;span class="w"&gt; &lt;/span&gt;python&lt;span class="w"&gt; &lt;/span&gt;-c&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;import os; import allspark;print(os.path.dirname(allspark.__file__))&amp;#39;&lt;/span&gt;&lt;span class="k"&gt;)&lt;/span&gt;
&lt;span class="cp"&gt;include $(ALLSPARK_PTH)/mkrules.mk&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™æ ·å°±å¯ä»¥é€šè¿‡ &lt;tt class="docutils literal"&gt;make&lt;/tt&gt; è¿›è¡Œä¸€é”®éƒ¨ç½²ï¼Œè¿™å¥—æœºåˆ¶ç”¨äº†å¾ˆé•¿æ—¶é—´ï¼Œç›®å‰è¿˜æœ‰éƒ¨åˆ†ç»´æŠ¤è¾ƒå°‘çš„é¡¹ç›®è¿˜å†ä½¿ç”¨ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="ansible"&gt;
&lt;h3&gt;Ansible&lt;/h3&gt;
&lt;p&gt;åæ¥å¼€å§‹ç«‹é¡¹ Django çš„é¡¹ç›®ï¼Œç”±äº &lt;tt class="docutils literal"&gt;fabric&lt;/tt&gt; ç›¸å…³çš„å°è£…éƒ½åœ¨ Tornado çš„é€šç”¨åº“é‡Œï¼Œå†ç»§ç»­ä½¿ç”¨å°±æ¯”è¾ƒéº»çƒ¦ï¼Œè¿™æ—¶å€™æˆ‘å°±å¼€å§‹å¯»æ±‚æ–°çš„è§£å†³æ–¹æ¡ˆï¼Œ
æ‰€ä»¥æˆ‘åˆå¼€å§‹ç ”ç©¶ Ansibleï¼Œç»è¿‡ç®€å•çš„äº†è§£å’Œå°è¯•æˆ‘å‘ç°åªè¦å®šä¹‰å‡ ä¸ªç®€å• role å°±å¯ä»¥æ»¡è¶³éœ€æ±‚ï¼Œæ‰€ä»¥æˆ‘æ–°å»ºäº†ä¸€ä¸ªä»“åº“å­˜æ”¾è¿™äº›è§’è‰²ï¼Œ
Ansible æä¾›äº† &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;ansible-galaxy&lt;/span&gt;&lt;/tt&gt; æ¥å®‰è£…ä¾èµ–ï¼Œæ‰€ä»¥å†æ¯ä¸ªé¡¹ç›®ä¸‹éƒ½æœ‰å¦‚ä¸‹ Ansible é…ç½®æ–‡ä»¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class="first"&gt;ansible.cfg -- æŒ‡å®š hosts ä½ç½®&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;deploy/ansible/hosts -- é…ç½®ä¸»æœº&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;deploy/ansible/requirements.yml -- æŒ‡å®šä¾èµ–&lt;/p&gt;
&lt;p&gt;å†…å®¹å¦‚ä¸‹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;- src: git@gitlab.example.com:username/ansible-roles
  scm: git
  name: ansible-roles
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;deploy/ansible/dev-playbook.yml  -- æµ‹è¯•ç¯å¢ƒéƒ¨ç½²è§„åˆ™ï¼ŒæŒ‡å®šå˜é‡å’Œè§’è‰²å®ç°éƒ¨ç½²&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;deploy/ansible/prod-playbook.yml -- ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²ï¼ŒæŒ‡å®šå˜é‡å’Œè§’è‰²å®ç°éƒ¨ç½²&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç°åœ¨éƒ¨ç½²ç›¸å…³çš„å°±éƒ½å¼€å§‹ä½¿ç”¨ Ansibleï¼Œéƒ¨ç½²å‘½ä»¤å¦‚ä¸‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="c1"&gt;# éœ€è¦åœ¨æ§åˆ¶æœºä¸Šå®‰è£…ä¾èµ–&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;ansible-galaxy&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;-r&lt;span class="w"&gt; &lt;/span&gt;deploy/ansible/requirements.yml
$&lt;span class="w"&gt; &lt;/span&gt;ansible-playbook&lt;span class="w"&gt; &lt;/span&gt;deploy/ansible/dev-playbook.yml
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™é‡Œ ansible-galaxy æœ‰ä¸ªå‘ï¼Œå°±æ˜¯ä¸æ”¯æŒæ›´æ–°ï¼Œè¦æƒ³æ›´æ–°å·²å®‰è£…çš„ ansible è§’è‰²éœ€è¦æ‰‹åŠ¨åˆ é™¤å¹¶é‡æ–°å®‰è£…ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;$&lt;span class="w"&gt; &lt;/span&gt;rm&lt;span class="w"&gt; &lt;/span&gt;~/.ansible/roles/ansible-roles
$&lt;span class="w"&gt; &lt;/span&gt;ansible-galaxy&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;-r&lt;span class="w"&gt; &lt;/span&gt;deploy/ansible/requirements.yml
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="deploy-key-ssh-agent-forwarding"&gt;
&lt;h3&gt;Deploy Key åˆ° SSH agent forwarding&lt;/h3&gt;
&lt;p&gt;åœ¨éƒ¨ç½²çš„è¿‡ç¨‹ä¸­éœ€è¦åœ¨æœåŠ¡å™¨ä¸Šæ‹‰å–ä»£ç ï¼Œå°±æ¶‰åŠåˆ°ä»“åº“æƒé™çš„é—®é¢˜æˆ‘ä»¬ä¸€å¼€å§‹çš„è§£å†³åŠæ³•æ˜¯éƒ¨ç½²ä¹‹å‰é€šè¿‡ &lt;tt class="docutils literal"&gt;Fabric&lt;/tt&gt; ä¸Šä¼ ä¸€ä¸ª Deploy Key
åˆ°ç›®æ ‡æœåŠ¡å™¨ï¼Œåœ¨éƒ¨ç½²å®Œæˆä¹‹åå†å°†å¯¹åº”çš„ Deploy Key åˆ é™¤ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ª Deploy Key åªå¯¹åº”ä¸€ä¸ªä»“åº“çš„åªè¯»æƒé™ï¼Œè¿™ç§æ¨¡å¼åœ¨å‰æœŸæ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯åˆ°äº†åæœŸæˆ‘ä»¬æŠŠé€šç”¨åº“æ‹†åˆ†åˆ°ç‹¬ç«‹çš„ä»“åº“é€šè¿‡ &lt;tt class="docutils literal"&gt;pip&lt;/tt&gt; è¿›è¡Œå®‰è£…æ—¶å°±é‡åˆ°äº†é—®é¢˜ï¼Œ
è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¼€å§‹æŠ›å¼ƒ Deploy Key æ”¹ä¸ºä½¿ç”¨ SSH agent forwardingï¼Œå…·ä½“è¯·å‚è§ &lt;a class="reference external" href="https://developer.github.com/v3/guides/using-ssh-agent-forwarding/"&gt;Using SSH agent forwarding&lt;/a&gt; ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="orm"&gt;
&lt;h2&gt;ORM ä½¿ç”¨&lt;/h2&gt;
&lt;div class="section" id="sql"&gt;
&lt;h3&gt;æ‰‹å†™ SQL&lt;/h3&gt;
&lt;p&gt;æ—©æœŸæˆ‘ä»¬ä½¿ç”¨æ‰‹å†™ SQL çš„æ–¹å¼ä¸æ•°æ®åº“äº¤äº’ï¼Œæ…¢æ…¢çš„æˆ‘ä»¬å‘ç°è¿™ç§æ–¹å¼å­˜åœ¨ä¸€äº›é—®é¢˜ï¼š&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;å¤§å— SQL è¯­å¥åœ¨ä»£ç ä¸­å¼‚å¸¸ä¸‘é™‹&lt;/li&gt;
&lt;li&gt;éå¸¸å®¹æ˜“ç¼–å†™é”™è¯¯çš„ SQL è¯­å¥&lt;/li&gt;
&lt;li&gt;ä»£ç  Review è¿‡ç¨‹ä¸­è¦é¢å¤–æ³¨æ„ SQL æ³¨å…¥ç›¸å…³é—®é¢˜&lt;/li&gt;
&lt;li&gt;ä¸ºäº†é˜²æ­¢æ³¨å…¥ï¼Œæ ¹æ®æ¡ä»¶æ‹¼æ¥ SQL è¯­å¥æ¯”è¾ƒå›°éš¾åŒæ—¶æ‹¼æ¥ä»£ç çœ‹èµ·æ¥ä¸‘é™‹å¹¶ä¸”éš¾ä»¥ç†è§£&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="sqlalchemy-core"&gt;
&lt;h3&gt;SQLAlchemy Core&lt;/h3&gt;
&lt;p&gt;åæ¥å‘ç° SQLAlchemy å¯¹å¤–æä¾›çš„æ¥å£æ˜¯åˆ†ä¸ºä¸¤å±‚çš„ï¼š&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Core -- è¯­å¥ç”Ÿæˆå¼•æ“&lt;/li&gt;
&lt;li&gt;ORM -- åŸºäºè¯­å¥ç”Ÿæˆå¼•æ“çš„ ORM&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å‘ç°åªä½¿ç”¨ Core å’Œæ‰‹å†™ SQL å¹¶æ— å¤ªå¤§åŒºåˆ«ï¼Œä½†æ˜¯è§£å†³äº†ä¸Šé¢çš„æ‰€æœ‰é—®é¢˜ï¼Œè¯·çœ‹ä¸‹é¢ç¤ºä¾‹ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sqlalchemy&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="nn"&gt;sa&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;.&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;db_engine&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;.&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Table&lt;/span&gt;


&lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="n"&gt;db_engine&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;execute&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
        &lt;span class="n"&gt;Table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;where&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
             &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
             &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
             &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sex&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;male&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
             &lt;span class="o"&gt;&amp;amp;&lt;/span&gt;
             &lt;span class="n"&gt;Table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;is_valid&lt;/span&gt;
        &lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;order_by&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sa&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;desc&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Table&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;åŒæ—¶ä¹Ÿå¯ä»¥æ”¯æŒå¤æ‚çš„ SQL è¯­å¥ï¼Œå…·ä½“è¯·å‚è§ &lt;a class="reference external" href="https://docs.sqlalchemy.org/en/latest/core/tutorial.html"&gt;æ–‡æ¡£&lt;/a&gt; ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-orm"&gt;
&lt;h3&gt;Django ORM&lt;/h3&gt;
&lt;p&gt;å†åæ¥çš„æ–°é¡¹ç›®éƒ½é‡‡ç”¨äº† Django å¹¶ä½¿ç”¨ Django è‡ªå¸¦çš„ ORMã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="section-4"&gt;
&lt;h2&gt;æœ¬åœ°å¼€å‘&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬åº”ç”¨çš„æœåŠ¡ä¾èµ–è¾ƒå°‘ï¼Œç›®å‰åªä¾èµ– MySQL å’Œ Redisã€‚ä¸€å¼€å§‹å¤§å®¶éƒ½é€šè¿‡ç»Ÿä¸€è¿æ¥å†…ç½‘çš„åŒä¸€æœåŠ¡è¿›è¡Œæœ¬åœ°å¼€å‘ï¼Œ
è¿™ç§å¼€å‘æ¨¡å¼ä¼šå¸¦æ¥ä¸€ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;å‡è®¾å…¶ä¸­ä¸€åå¼€å‘äººå‘˜åˆ é™¤äº†ä¸€ä¸ªå­—æ®µï¼Œå¹¶è°ƒæ•´äº†å¯¹åº”çš„ä»£ç ä½†æ˜¯æ²¡æœ‰æäº¤&lt;/li&gt;
&lt;li&gt;ç”±äºæˆ‘ä»¬åŸºæœ¬ä¸Šæ˜¯ TDD çš„å¼€å‘æ¨¡å¼ï¼Œæ­¤æ—¶å°±ä¼šå¯¼è‡´å…¶ä»–äººçš„å•å…ƒæµ‹è¯•æ— æ³•æ­£å¸¸è¿è¡Œ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åŸºäºè¿™ç§æ¨¡å¼æˆ‘ä»¬æœ¬åœ°å¼€å‘å¼•å…¥ Dockerï¼Œä½¿ç”¨ Docker åœ¨æœ¬åœ°å¯åŠ¨ MySQL å’Œ Redis æœåŠ¡ï¼Œåœ¨æˆ‘ä»¬çš„é€šç”¨åº“é‡Œæä¾›ä»¥ä¸‹ä¸¤ä¸ªæ–‡ä»¶ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p class="first"&gt;docker-compose.yml&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;version: &amp;#39;3&amp;#39;
services:
    mysql:
        image: mysql:5.6
        restart: always
        ports:
            - &amp;quot;3306:3306&amp;quot;
        volumes:
            - ~/.botpy/etc/mysql/conf.d:/etc/mysql/conf.d
            - ~/.botpy/data/mysql:/var/lib/mysql
        environment:
            MYSQL_ROOT_PASSWORD: root-password-you-should-replace

    redis:
        image: redis
        restart: always
        ports:
            - &amp;quot;6379:6379&amp;quot;
&lt;/pre&gt;&lt;/div&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;init-db.py -- åŒ…è£… mysqldump å’Œ mysql å‘½ä»¤å®ç°åŒæ­¥å†…ç½‘æ•°æ®åº“çš„è„šæœ¬&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ•°æ®åº“è¿ç§»æœ€ç»ˆæµç¨‹å°±å˜ä¸ºï¼š&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;åœ¨æœ¬åœ°ç¼–å†™å¹¶è°ƒè¯•ï¼Œå¹¶å…ˆåº”ç”¨åˆ°æœ¬åœ°&lt;/li&gt;
&lt;li&gt;æäº¤ MR åœ¨å†…ç½‘çš„æµ‹è¯•æ•°æ®åº“è¿›è¡ŒéªŒè¯&lt;/li&gt;
&lt;li&gt;éªŒè¯é€šè¿‡ååˆå¹¶ MR è§¦å‘éƒ¨ç½²&lt;ol class="arabic"&gt;
&lt;li&gt;è¿ç§»åº”ç”¨åˆ°å†…ç½‘çš„å¼€å‘æ•°æ®åº“&lt;/li&gt;
&lt;li&gt;éƒ¨ç½²åˆ°æµ‹è¯•æ•°æ®åº“&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="section-5"&gt;
&lt;h2&gt;æ•°æ®åº“è¿ç§»&lt;/h2&gt;
&lt;div class="section" id="sqlalchemy-migrate"&gt;
&lt;h3&gt;SQLAlchemy Migrate&lt;/h3&gt;
&lt;p&gt;æ—©æœŸæˆ‘ä»¬æ˜¯é€šè¿‡æ‰‹åŠ¨æ”¶é›†å˜æ›´çš„ SQL è¯­å¥åˆ°æŒ‡å®šæ–‡ä»¶ä¸‹ï¼Œç„¶ååœ¨ä¸Šçº¿ä¹‹å‰æ‰‹åŠ¨åœ¨æ•°æ®åº“è¿›è¡Œæ‰§è¡Œã€‚åæ¥è¿™å—å°±å¯¼è‡´äº†å¾ˆå¤šä¸Šçº¿é—®é¢˜ï¼Œ
ä¸»è¦æ˜¯å¿˜è®°æ”¶é›†å’Œå¿˜è®°æ‰§è¡Œï¼Œåé¢åœ¨æ‰¾è¿™æ–¹é¢çš„è§£å†³æ–¹æ¡ˆæ—¶å‘ç°äº† &lt;a class="reference external" href="http://sqlalchemy-migrate.readthedocs.io/en/latest/"&gt;SQLAlchemy Migrate&lt;/a&gt; ï¼Œç»è¿‡ç®€å•çš„æ”¹é€ ä¹‹åç”¨èµ·æ¥è¿˜ç®—èˆ’å¿ƒã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨ç”¨çš„è¿‡ç¨‹ä¸­é‡åˆ°çš„ä¸»è¦é—®é¢˜ä¸­æ–‡ç¼–ç é—®é¢˜ï¼Œç»è¿‡æ’æŸ¥æ˜¯ç”±äº sqlparse åº“å¯¼è‡´çš„ï¼Œç”±äºæ²¡æœ‰æš´æ¼ç›¸å…³æ¥å£åŠ ä¸Š &lt;a class="reference external" href="http://sqlalchemy-migrate.readthedocs.io/en/latest/"&gt;SQLAlchemy Migrate&lt;/a&gt;
æ˜¯ç”± OpenStack ç»´æŠ¤ï¼Œæƒ³è¦è´¡çŒ®ä»£ç éå¸¸å›°éš¾ï¼Œæ‰€ä»¥å°±é€šè¿‡åœ¨ &lt;tt class="docutils literal"&gt;manage.py&lt;/tt&gt; å¢åŠ å¦‚ä¸‹ä»£ç æ¥è§£å†³ï¼š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;functools&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sqlparse&lt;/span&gt;


&lt;span class="c1"&gt;# HACK!!: æ›¿æ¢åŸå‡½æ•°ä¿®å¤ sqlalchemy-migrate çš„ç¼–ç  bug&lt;/span&gt;
&lt;span class="n"&gt;sqlparse&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;functools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;partial&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sqlparse&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;encoding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;utf8&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="alembic"&gt;
&lt;h3&gt;Alembic&lt;/h3&gt;
&lt;p&gt;è™½ç„¶ &lt;a class="reference external" href="http://sqlalchemy-migrate.readthedocs.io/en/latest/"&gt;SQLAlchemy Migrate&lt;/a&gt; å·²ç»æ»¡è¶³éœ€æ±‚ï¼Œä½†æ˜¯åœ¨ç”¨çš„è¿‡ç¨‹ä¸­å‘ç°ä¼šæœ‰ä¸¤ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;ç¤¾åŒºæ›´æ–°ä¸ç§¯æï¼Œ&lt;/li&gt;
&lt;li&gt;ç”±äº &lt;a class="reference external" href="http://sqlalchemy-migrate.readthedocs.io/en/latest/"&gt;SQLAlchemy Migrate&lt;/a&gt; ä»…è®°å½•æœ€åä¸€ä¸ªç‰ˆæœ¬å·ï¼Œä¸ä¾¿äºå¤šäººå¼€å‘ï¼Œè€ƒè™‘å¦‚ä¸‹åœºæ™¯ï¼š&lt;ol class="arabic"&gt;
&lt;li&gt;A å¢åŠ äº†ç‰ˆæœ¬ 001-foo&lt;/li&gt;
&lt;li&gt;B æ²¡æœ‰æ‹‰å–ä»£ç ä¹Ÿè¿›è¡Œè¿ç§»å°±ä¼šä¹Ÿå¢åŠ ä¸€ä¸ª 001-bar&lt;/li&gt;
&lt;li&gt;A çš„ä»£ç åˆå¹¶å¹¶éƒ¨ç½²ï¼Œ001-foo ä¼šè¢«æ‰§è¡Œï¼ˆæ•°æ®åº“æ ‡è®° 001 å·²æ‰§è¡Œï¼‰&lt;/li&gt;
&lt;li&gt;B çš„ä»£ç åˆå¹¶å¹¶éƒ¨ç½²ï¼Œç”±äº 001 è¢«æ ‡è®°ä¸ºå·²æ‰§è¡Œ 001-bar ä¸ä¼šè¿›è¡Œæ‰§è¡Œ&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™æ—¶å€™å‘ç° SQLAlchemy çš„ä½œè€…æ¨å‡ºäº† &lt;a class="reference external" href="http://alembic.zzzcomputing.com/en/latest/"&gt;Alembic&lt;/a&gt;ï¼Œç»è¿‡ç®€å•çš„å°è¯•å‘ç°è¯¥å·¥å…·æ›´åŠ å¼ºå¤§æ”¯æŒç±»ä¼¼ Git çš„ç‰ˆæœ¬æ§åˆ¶ï¼Œ
å¼€å‘ä¹Ÿæ¯”è¾ƒæ´»è·ƒï¼Œè§£å†³äº†ä¸Šé¢ä¸¤ä¸ªé—®é¢˜ã€‚æ‰€ä»¥åœ¨åç»­å°±ä½¿ç”¨ &lt;a class="reference external" href="http://alembic.zzzcomputing.com/en/latest/"&gt;Alembic&lt;/a&gt; æ›¿æ¢äº† &lt;a class="reference external" href="http://sqlalchemy-migrate.readthedocs.io/en/latest/"&gt;SQLAlchemy Migrate&lt;/a&gt; ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="django-migrate"&gt;
&lt;h3&gt;Django Migrate&lt;/h3&gt;
&lt;p&gt;åç»­ Django çš„æ–°é¡¹ç›®å°±å¼€å§‹é‡‡ç”¨ Django è‡ªå¸¦çš„æ•°æ®åº“è¿ç§»æ–¹æ¡ˆï¼Œè¿™é‡Œå°±ä¸å†ç»†è¿°ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="section-6"&gt;
&lt;h2&gt;å•å…ƒæµ‹è¯•&lt;/h2&gt;
&lt;div class="section" id="section-7"&gt;
&lt;h3&gt;æµ‹è¯•æ•°æ®åº“&lt;/h3&gt;
&lt;p&gt;æˆ‘è§‰çš„æˆ‘ä»¬ä¹‹æ‰€ä»¥èƒ½æˆåŠŸçš„æ¨è¡Œäº†å•å…ƒæµ‹è¯•ï¼Œå¹¶å°†ä¹‹ä½œä¸ºæ—¥å¸¸å¼€å‘ä¸­è¡¡é‡ä»£ç çš„æ ‡å‡†ä¹‹ä¸€ï¼Œæœ€å¤§çš„åŠŸåŠ³å°±æ˜¯è§£å†³äº†æµ‹è¯•æ•°æ®åº“ç›¸å…³é—®é¢˜ï¼Œ
å°±åƒæˆ‘ä¹‹å‰çš„æ–‡ç« æåˆ°çš„:&lt;/p&gt;
&lt;blockquote&gt;
å¾ˆé•¿ä¸€æ®µæ—¶é—´ä»¥æ¥å†™å•å…ƒæµ‹è¯•éƒ½ç±»ä¼¼å†™æ‰§è¡Œè„šæœ¬ï¼Œè¿è¡Œä¸€ä¸‹ç„¶åçœ‹ä¸€ä¸‹ç»“æœã€‚&lt;/blockquote&gt;
&lt;p&gt;å¾ˆå¤§çš„åŸå› å°±æ˜¯æ²¡æœ‰è§£å†³æµ‹è¯•æ•°æ®åº“ç›¸å…³çš„é—®é¢˜ï¼Œæ¯”å¦‚æˆ‘å†™äº†ä¸€ä¸ªæµ‹è¯•ç„¶ååœ¨æˆ‘æœ¬åœ°æ•°æ®åº“å¡«å……äº†æ•°æ®ï¼Œæµ‹è¯•é€šè¿‡äº†ã€‚ç„¶ååé¢æ•°æ®å†å˜åŠ¨æµ‹è¯•å°±å¤±è´¥äº†ã€‚
ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜æˆ‘è‡ªå·±é¦–å…ˆå®ç°äº†ä¸€ä¸ªåŸºäº unittest çš„æµ‹è¯•æ”¶é›†å’Œè¿è¡Œå™¨ï¼Œç„¶ååœ¨æµ‹è¯•è¿è¡Œå¼€å§‹ä¹‹å‰æ’å…¥ä¸€æ®µä»£ç åšå¦‚ä¸‹äº‹æƒ…ï¼š&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;è¿æ¥é…ç½®æ–‡ä»¶ä¸­çš„æ•°æ®åº“å¹¶è¯»å–è¡¨ç»“æ„ä¿¡æ¯&lt;/li&gt;
&lt;li&gt;æ ¹æ®ä¸€å®šè§„åˆ™ç”Ÿæˆåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®åº“&lt;/li&gt;
&lt;li&gt;å°†è¯»å–çš„è¡¨ç»“æ„ä¿¡æ¯åº”ç”¨åˆ°æ–°æ•°æ®åº“&lt;/li&gt;
&lt;li&gt;åŠ è½½æµ‹è¯•åŒ…ä¸‹çš„ä¸€äº› SQL æ–‡ä»¶å¹¶åœ¨æ–°çš„æ•°æ®åº“ä¸­æ‰§è¡Œ&lt;/li&gt;
&lt;li&gt;Patch é…ç½®æ–‡ä»¶ï¼Œå°†æ•°æ®åº“åè°ƒæ•´åˆ°æ–°çš„æ•°æ®åº“&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;åé¢æˆ‘ä»¬åˆ‡æ¢åˆ° pytest ä½œä¸º test runner åå°†è¿™ä¸€å—é€»è¾‘å°è£…æˆäº†ä¸€ä¸ª pytest çš„æ’ä»¶ã€‚åŠ ä¸Šåé¢ä¸Šçš„ mock æˆ‘ä»¬çš„å•å…ƒæµ‹è¯•æ‰çœŸæ­£çš„å®Œå–„ã€‚
è¿™ä¹Ÿé€ å°±äº†æˆ‘ä»¬å¤§éƒ¨åˆ†é¡¹ç›®éƒ½è¾¾åˆ°äº† 80% ~ 95% çš„å•å…ƒæµ‹è¯•è¦†ç›–ç‡ï¼ŒåŒæ—¶ä¹Ÿä¸ºæˆ‘ä»¬ä¹‹åè¿ç§» Python 3 æ‰“ä¸‹äº†å¾ˆå¥½çš„åŸºç¡€ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="pytest-test-runner"&gt;
&lt;h3&gt;pytest ä½œä¸º test runner&lt;/h3&gt;
&lt;p&gt;å‰é¢ä¹Ÿæåˆ°äº†ï¼Œä¸€å¼€å§‹æˆ‘ä»¬ç”¨çš„æ˜¯åŸºäº unittest è‡ªå·±å®ç°çš„æµ‹è¯•å‘ç°ã€æ”¶é›†å’Œè¿è¡Œçš„å·¥å…·ï¼Œè¿™ä¸€å—ä¹Ÿæ˜¯æˆ‘å—ä¹‹å‰ä¸€å®¶å…¬å¸çš„å½±å“ï¼Œ
åæ¥å‘ç° pytest é™¤äº†æ˜¯ä¸€ä¸ªå¼ºå¤§çš„æµ‹è¯•æ¡†æ¶ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥å•ç‹¬ç”¨æ¥ä½œä¸º test runner ä½¿ç”¨ï¼Œæˆ‘ä¸å¤ªå–œæ¬¢ pytest è¿™ç§å‡½æ•°å¼æ–¹å¼
ç¼–å†™æµ‹è¯•ï¼Œå¾ˆå¤š fixture markup æ„Ÿè§‰å¤ªè¿‡éšå¼ï¼Œæ‰€ä»¥æˆ‘åªæ‹¿ pytest ä½œä¸º test runnerï¼Œå•å…ƒæµ‹è¯•è¿˜æ˜¯ä½¿ç”¨ unittest é‚£ä¸€å¥—ã€‚&lt;/p&gt;
&lt;p&gt;pytest ä½œä¸º test runner å¯¹æ¯” unittest çš„å¥½å¤„æ˜¯ï¼š&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;ç¤¾åŒºæ´»è·ƒ&lt;/li&gt;
&lt;li&gt;ç”Ÿæ€å¥½ï¼Œæ’ä»¶å¤š&lt;/li&gt;
&lt;li&gt;ç»“åˆæ’ä»¶ç³»ç»Ÿéå¸¸å®¹æ˜“æ‰©å±•å’Œè‡ªå®šä¹‰&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="mock"&gt;
&lt;h3&gt;mock&lt;/h3&gt;
&lt;p&gt;å‚è§ä¹‹å‰çš„ &lt;a class="reference external" href="/python-mock-shi-yong-xin-de.html"&gt;åšæ–‡&lt;/a&gt; ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="tox"&gt;
&lt;h3&gt;tox&lt;/h3&gt;
&lt;p&gt;å¼€å§‹æ¯æ¬¡è¿è¡Œæµ‹è¯•æ„å»ºæµ‹è¯•ç›¸å…³çš„ Python ç¯å¢ƒä¼šæ¯”è¾ƒéº»çƒ¦ï¼Œåé¢æ¥è§¦äº† &lt;a class="reference external" href="http://tox.readthedocs.io/en/latest/"&gt;tox&lt;/a&gt; å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ„å»ºæµ‹è¯•ç¯å¢ƒï¼Œ
åŒæ—¶æ”¯æŒå¤šä¸ª Python ç‰ˆæœ¬ç¯å¢ƒæ„å»ºã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="ci-cd"&gt;
&lt;h2&gt;CI/CD&lt;/h2&gt;
&lt;div class="section" id="bors-homu"&gt;
&lt;h3&gt;ç»“è¯† bors å’Œ homu&lt;/h3&gt;
&lt;p&gt;æœ‰ä¸€æ®µæ—¶é—´æˆ‘ç‰¹åˆ«å…³æ³¨ Rust ç¤¾åŒºï¼Œçœ‹åˆ°ä»–ä»¬æœ‰ä¸€ä¸ªæœºå™¨äººä¸“é—¨è·‘å•å…ƒæµ‹è¯•å’Œåˆå¹¶ PRï¼Œæˆ‘å°±å¼€å§‹æ€è€ƒèƒ½ä¸èƒ½ç”¨åˆ°æˆ‘ä»¬çš„é¡¹ç›®ä¸­ï¼Œ
ç»è¿‡ç®€å•çš„è§‚å¯Ÿæˆ‘é¦–å…ˆæ¥è§¦åˆ°äº† &lt;a class="reference external" href="https://github.com/graydon/bors"&gt;bors&lt;/a&gt; ï¼Œåˆæ¬¡ä½¿ç”¨åæ„Ÿè§‰çœŸå¿ƒé…·ç‚«ï¼Œä½†æ˜¯ç”±äºå®ƒæ˜¯é‡‡ç”¨è½®è¯¢ä¼šæœ‰å¦‚ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;æ—¶æ•ˆæ€§ä¸å¥½&lt;/li&gt;
&lt;li&gt;å®¹æ˜“è¾¾åˆ° GitHub æ¥å£è¯·æ±‚æ¬¡æ•°ä¸Šé™&lt;/li&gt;
&lt;li&gt;è¿˜æœ‰å…¶ä»–ä¸€äº›åŠŸèƒ½ä¸Šçš„ä¸å…¨&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™æ—¶å€™æˆ‘å°±å‘ç° Rust ç¤¾åŒºæ—©ä¸€ä¸ä½¿ç”¨ &lt;a class="reference external" href="https://github.com/graydon/bors"&gt;bors&lt;/a&gt; è€Œæ˜¯æ”¹ä¸ºä½¿ç”¨ &lt;a class="reference external" href="https://github.com/barosl/homu"&gt;homu&lt;/a&gt; äº†ï¼Œå…·ä½“çš„ä¿¡æ¯å¯ä»¥å‚è§ä¹‹å‰çš„ä¸€ç¯‡
&lt;a class="reference external" href="/python-github-si-you-xiang-mu-tong-guo-buildbot-jin-xing-review.html"&gt;æ–‡ç« &lt;/a&gt; ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="github"&gt;
&lt;h3&gt;GitHub&lt;/h3&gt;
&lt;p&gt;å‚è§ &lt;a class="reference external" href="/python-github-si-you-xiang-mu-tong-guo-buildbot-jin-xing-review.html"&gt;Python github ç§æœ‰é¡¹ç›®é€šè¿‡ buildbot è¿›è¡Œ Review&lt;/a&gt; ã€‚
åé¢ä¹Ÿå°è¯•è¿ç§»åˆ° buildbot 0.9ï¼Œå…·ä½“æ–¹æ¡ˆå‚è§ &lt;a class="reference external" href="https://github.com/servo/homu/pull/119"&gt;Add buildbot 0.9 support steps in README.md #119&lt;/a&gt; ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="gitlab"&gt;
&lt;h3&gt;GitLab&lt;/h3&gt;
&lt;div class="section" id="pipelines"&gt;
&lt;h4&gt;Pipelines&lt;/h4&gt;
&lt;p&gt;è¿ç§»åˆ° GitLab ä¹‹åå°±å¼ƒç”¨äº† buildbot æ”¹ç”¨ GitLab è‡ªèº«çš„é‚£ä¸€å¥— CI/CDã€‚å…·ä½“å‚è§ &lt;a class="reference external" href="https://about.gitlab.com/features/gitlab-ci-cd/"&gt;GitLab CI/CD&lt;/a&gt; ã€‚&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ CI æ„å»ºç”¨çš„è‡ªå·±æ„å»ºçš„ Docker é•œåƒï¼Œé‡Œé¢é›†æˆäº†ä¸€äº›åŸºç¡€ä¾èµ–åŒ…å’Œéƒ¨ç½²éœ€è¦çš„ç›¸å…³ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="homu-gitlab"&gt;
&lt;h4&gt;homu-gitlab&lt;/h4&gt;
&lt;p&gt;ç”±äºä¸šåŠ¡æ‰©å¼  GitHub ä¸Šçš„ç§æœ‰ä»“åº“æˆæœ¬å¼€å§‹æå‡ï¼Œæ‰€ä»¥å°±å¼€å§‹è€ƒè™‘è¿ç§»è‡ªå»ºçš„ GitLabï¼Œè¿™æ—¶é¢ä¸´ä¸€ä¸ªé—®é¢˜å°±æ˜¯æ€ä¹ˆä¿æŒç°æœ‰çš„å·¥ä½œæµä¸å˜ï¼Œ
é¦–å…ˆå°±æ˜¯è¦æ‰¾åˆ°ä¸€ä¸ª &lt;a class="reference external" href="https://github.com/barosl/homu"&gt;homu&lt;/a&gt; çš„ GitLab ç‰ˆå®ç°ï¼Œç»è¿‡è‡ªå·±çš„æœå¯»åå¹¶æ²¡æœ‰å‘ç°åˆé€‚çš„ï¼Œæ‰€ä»¥æˆ‘å°±å°è¯• Fork äº†ä¸€ä»½å°è¯•è‡ªå·±è¿ç§»åˆ° GitLabï¼Œ
æœ€ç»ˆæˆåŠŸçš„è¿ç§»å¹¶åº”ç”¨åˆ° GitLab ä¸­æ¥ï¼Œå‚è§ &lt;a class="reference external" href="https://github.com/coldnight/homu-gitlab"&gt;coldnight/homu-gitlab&lt;/a&gt; ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€äº›ä¸å®Œç¾çš„åœ°æ–¹&lt;/p&gt;
&lt;ol class="arabic"&gt;
&lt;li&gt;&lt;p class="first"&gt;éœ€è¦ä¾èµ– SSH ç§ç¥&lt;/p&gt;
&lt;p&gt;ç”±äº GitLab çš„æ¥å£å¹¶æ²¡æœ‰ GitHub é‚£ä¹ˆå®Œå–„ï¼Œæ²¡æœ‰ç›¸å…³åˆå¹¶ MR çš„æ¥å£ï¼Œæ‰€ä»¥å°†ä¹‹å‰ä¸»è¦ä¾èµ– GitHub æ¥å£çš„éƒ¨åˆ†éƒ½ç»Ÿä¸€æ”¹æˆäº†é€šè¿‡ git å‘½ä»¤æ“ä½œã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p class="first"&gt;åŒæ­¥åŠŸèƒ½æœªå®ç°ï¼Œæ¯æ¬¡åŒæ­¥éœ€è¦é€šè¿‡é‡å¯å®ç°&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="section-8"&gt;
&lt;h3&gt;æŒç»­è¿›åŒ–&lt;/h3&gt;
&lt;p&gt;åœ¨ä¸Šé¢å®Œæˆä¹‹åæœ€è¿‘è¿˜åšäº†ä¸€äº›è°ƒæ•´å’Œä¼˜åŒ–ï¼š&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;å¯ç”¨ GitLab CI/CD ç¼“å­˜æ¥åŠ é€Ÿå’Œä¼˜åŒ– CI æ„å»º&lt;/li&gt;
&lt;li&gt;å†…ç½‘æ­å»º Docker Registry ç»Ÿä¸€æ‰˜ç®¡å’Œæ„å»º CI Docker é•œåƒï¼ˆè¿™éƒ¨åˆ†ä¹Ÿæ˜¯è‡ªåŠ¨åŒ–çš„ï¼‰&lt;/li&gt;
&lt;li&gt;é€šè¿‡ä¸€ä¸ªä»“åº“æ‰˜ç®¡ homu çš„é…ç½®æ–‡ä»¶ï¼Œæ¯æ¬¡è°ƒæ•´æäº¤åè‡ªåŠ¨é‡å¯ homu æœåŠ¡&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;div class="section" id="pre-commit"&gt;
&lt;h3&gt;pre-commit&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬ä¸€å¼€å§‹ä»£ç æ£€æµ‹ä¸»è¦åˆ©ç”¨ Git çš„ pre-commit è‡ªå·±ç¼–å†™ shell è„šæœ¬æ¥ç»„åˆï¼Œåæ¥å‘ç° &lt;a class="reference external" href="https://github.com/pre-commit/pre-commit"&gt;pre-commit&lt;/a&gt; åå¼€å§‹ç»Ÿä¸€æ›¿æ¢ä¸º &lt;a class="reference external" href="https://github.com/pre-commit/pre-commit"&gt;pre-commit&lt;/a&gt; ã€‚
&lt;a class="reference external" href="https://github.com/pre-commit/pre-commit"&gt;pre-commit&lt;/a&gt; çš„ä½œè€…ä¹Ÿæ¨å‡ºäº†å…¶ä»–å¾ˆå¤šä»£ç æ£€æµ‹ç›¸å…³çš„å·¥å…·ï¼Œæˆ‘ä¹Ÿåº”ç”¨åˆ°äº†æˆ‘ä»¬è‡ªå·±çš„é¡¹ç›®ä¸Šã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="python"&gt;
&lt;h2&gt;Python&lt;/h2&gt;
&lt;p&gt;å‚è§ &lt;a class="reference external" href="/qian-yi-dao-python-3.html"&gt;è¿ç§»åˆ° Python 3&lt;/a&gt; ã€‚&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="section-9"&gt;
&lt;h2&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;ç®€å•æ€»ç»“ä¸€ä¸‹ç›®å‰æ•´ä¸ªæŠ€æœ¯æ ˆï¼š&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Python 3&lt;ul&gt;
&lt;li&gt;Django/Tornado&lt;/li&gt;
&lt;li&gt;SQLAlchemy&lt;/li&gt;
&lt;li&gt;pytest&lt;/li&gt;
&lt;li&gt;tox&lt;/li&gt;
&lt;li&gt;Alembic&lt;/li&gt;
&lt;li&gt;Celery&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Ansible&lt;/li&gt;
&lt;li&gt;GitLab&lt;ul&gt;
&lt;li&gt;CI/CD&lt;/li&gt;
&lt;li&gt;homu-gitlab&lt;/li&gt;
&lt;li&gt;pre-commit&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Docker&lt;ul&gt;
&lt;li&gt;docker-compose&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Vue&lt;/li&gt;
&lt;li&gt;Sentry&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
</content><category term="Python"></category><category term="Python"></category><category term="æŠ€æœ¯é€‰å‹"></category><category term="CI/CD"></category><category term="GitLab"></category></entry><entry><title>è¿ç§»åˆ° Python 3</title><link href="https://www.linuxzen.com/qian-yi-dao-python-3.html" rel="alternate"></link><published>2017-07-13T00:00:00+08:00</published><updated>2017-07-13T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2017-07-13:/qian-yi-dao-python-3.html</id><summary type="html">&lt;p&gt;å‰æ®µæ—¶é—´(2017-06-07)æˆ‘å¼€å§‹å†³å®šå°†å…¬å¸ç°æœ‰çš„é¡¹ç›®é€æ¸çš„è¿ç§»åˆ° Python 3. ä¸»è¦åŸå› æœ‰ä¸€ä¸‹å‡ ç‚¹:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Python 3.6 æ–°å¢äº†ä¸€äº›æ–°çš„ç‰¹æ€§æˆ‘å¾ˆå–œ â€¦&lt;/p&gt;&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;p&gt;å‰æ®µæ—¶é—´(2017-06-07)æˆ‘å¼€å§‹å†³å®šå°†å…¬å¸ç°æœ‰çš„é¡¹ç›®é€æ¸çš„è¿ç§»åˆ° Python 3. ä¸»è¦åŸå› æœ‰ä¸€ä¸‹å‡ ç‚¹:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Python 3.6 æ–°å¢äº†ä¸€äº›æ–°çš„ç‰¹æ€§æˆ‘å¾ˆå–œæ¬¢&lt;/p&gt;
&lt;p&gt;åŒ…æ‹¬:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://www.python.org/dev/peps/pep-0484/"&gt;PEP484 ç±»å‹æ³¨è§£&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.python.org/dev/peps/pep-0492/"&gt;PEP492 åŸç”Ÿçš„åç¨‹å¼‚æ­¥: async and await&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.python.org/dev/peps/pep-0498/"&gt;PEP498 æ ¼å¼åŒ–å­—ç¬¦ä¸²&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Python 3 çš„ç”Ÿæ€å·²ç»å®Œå–„, æˆ‘ä»¬æ‰€ä½¿ç”¨çš„ä¸€äº›ç¬¬ä¸‰æ–¹åº“éƒ½å·²æ”¯æŒ Python 3(æˆ–æœ‰å…¶ä»–æˆç†Ÿçš„æ›¿ä»£)&lt;/li&gt;
&lt;li&gt;Python 2 åˆ° 2020 å¹´å°±ä¸åœ¨ç»´æŠ¤&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;strong&gt;ä¿ƒæˆæˆ‘å†³å®šè¿ç§»åˆ° Python 3 çš„ä¸»è¦åŸå› æ˜¯å…¬å¸æœ€å¤§çš„é¡¹ç›®çš„å•å…ƒæµ‹è¯•è¦†ç›–ç‡ç»è¿‡ä¸€æ®µæ—¶é—´çš„è¿­ä»£ç»ˆäºè¾¾åˆ°äº† 80% ä»¥ä¸Š.&lt;/strong&gt;&lt;/p&gt;
&lt;h2 id="_1"&gt;è¿ç§»æ–¹æ¡ˆ&lt;/h2&gt;
&lt;p&gt;ç”±äºé¡¹ç›®å·¨å¤§ä»»åŠ¡è‰°å·¨æ— æ³•çŸ­æ—¶é—´å†…å°±å°†é¡¹ç›®è¿ç§»åˆ° Python 3, è€Œä¸”å½“å‰è¿˜æœ‰äº§å“ä¸Šçš„åŠŸèƒ½éœ€è¦è¿­ä»£.
æ‰€ä»¥è¿ç§»æ–¹æ¡ˆæ˜¯åŒæ—¶å…¼å®¹ Python 2 å’Œ 3, å¹¶åœ¨è¿ç§»å®Œæˆä¹‹åç§»é™¤å¯¹ Python 2 çš„æ”¯æŒ.&lt;/p&gt;
&lt;h2 id="ci"&gt;æ­å»º CI&lt;/h2&gt;
&lt;p&gt;ç”±äºä¹‹å‰æœ¬èº«å°±æœ‰æŒç»­é›†æˆæœåŠ¡(å‚è§&lt;a href="https://www.linuxzen.com/python-github-si-you-xiang-mu-tong-guo-buildbot-jin-xing-review.html"&gt;ä¸Šä¸€ç¯‡&lt;/a&gt;), æ‰€ä»¥ç›®å‰éœ€è¦åšçš„å°±æ˜¯åœ¨ç°æœ‰çš„åŸºç¡€å¢åŠ ä¸€å¥—é’ˆå¯¹ Python 3 çš„æŒç»­é›†æˆæœåŠ¡.
å¹¶ä¸”åœ¨æ²¡æœ‰å®Œå…¨å…¼å®¹ Python 3 ä¹‹å‰é’ˆå¯¹ Python 3 çš„æŒç»­é›†æˆä¸å½±å“æœ€ç»ˆæ„å»ºç»“æœ, ä»…ä½œä¸ºå‚è€ƒ.
è¿™é‡Œæ ¹æ®ä¸åŒçš„ CI éœ€è¦è¿›è¡Œä¸åŒçš„æ“ä½œä¸åœ¨æœ¬æ–‡è®¨è®ºèŒƒå›´ä¹‹å†…å°±ä¸åœ¨æ·±å…¥.&lt;/p&gt;
&lt;h2 id="_2"&gt;å…¼å®¹åº“çš„é€‰æ‹©&lt;/h2&gt;
&lt;p&gt;é’ˆå¯¹ä¸€äº› Python 2 å’Œ 3 çš„å·®å¼‚æˆ‘ä¸æ‰“ç®—è‡ªå·±å°è£…, æ‰€ä»¥æ‰¾äº†ä¸€äº›æˆç†Ÿçš„ç¬¬ä¸‰æ–¹åº“, æˆ‘å¯¹æ¯”äº†ç›®å‰æ¯”è¾ƒæµè¡Œçš„ä¸¤ä¸ªå…¼å®¹åº“:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://python-future.org/"&gt;future&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://pythonhosted.org/six/"&gt;six&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;future çœ‹èµ·æ¥ä½¿ç”¨æ¯”è¾ƒå¤šçš„é»‘é­”æ³•, å¥½å¤šå…¼å®¹éƒ½æ˜¯ä¾µå…¥å¼çš„ä¿®æ”¹. æ‰€ä»¥æˆ‘é€‰æ‹©äº†æ›´åŠ æ¸…æ™°çš„ six.&lt;/p&gt;
&lt;h2 id="_3"&gt;å…¼å®¹æ€§é—®é¢˜åŠè§£å†³&lt;/h2&gt;
&lt;p&gt;å¯ä»¥ä» &lt;code&gt;__future__&lt;/code&gt; å¯¼å…¥å¦‚ä¸‹ç‰¹æ€§æ¥è§£å†³ä¸€äº›å¸¸è§çš„ä¸å…¼å®¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt; 
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;   &lt;span class="c1"&gt;# è§£å†³é™¤æ³•è¡Œä¸ºä¸ä¸€è‡´&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;unicode_literals&lt;/span&gt;   &lt;span class="c1"&gt;# å­—ç¬¦ä¸²å­—é¢é‡é»˜è®¤ä¸º Unicode&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_4"&gt;æ ‡å‡†åº“å’Œå†…å»ºå‡½æ•°ä¸å…¼å®¹&lt;/h3&gt;
&lt;p&gt;Python 3 ä¸­æ›´æ”¹äº†ä¸€äº›æ ‡å‡†åº“çš„åå­—å’Œä¸€äº›å‡½æ•°å½’å±çš„æ¨¡å—, åŒæ—¶ä¹Ÿç§»é™¤äº†ä¸€äº›å…³é”®å­—å¦‚ &lt;code&gt;round&lt;/code&gt;.
æ­¤ç§ç±»å‹çš„é—®é¢˜å¯ä»¥é€šè¿‡ &lt;code&gt;six.moves&lt;/code&gt; æ¥è¿›è¡Œè§£å†³:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;six.moves.urllib_parse&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;urlparse&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;fix.moves.builtins&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nb"&gt;round&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_5"&gt;å­—ç¬¦ä¸²&lt;/h3&gt;
&lt;p&gt;ä»¥æˆ‘çš„æ„Ÿå—è§£å†³ Python 2 å’Œ 3 ä¹‹é—´çš„å…¼å®¹æ€§å­—ç¬¦ä¸²æ˜¯éš¾åº¦æœ€å¤§çš„é—®é¢˜ä¹‹ä¸€, å› ä¸º Python 3 é‡æ–°å®ç°äº†å­—ç¬¦ä¸²ç›¸å…³, 
å¹¶å¢åŠ äº†ä¸€äº›é™åˆ¶, ä¸»è¦ä½“ç°åœ¨:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç§»é™¤äº† unicode å…³é”®å­—&lt;/li&gt;
&lt;li&gt;åŸæœ‰çš„ str(bytes) å˜æˆäº† unicode&lt;/li&gt;
&lt;li&gt;bytes ä¸åœ¨æ”¯æŒ format/decode ç­‰æ–¹æ³•&lt;/li&gt;
&lt;li&gt;ä¸æ”¯æŒ Unicode å’Œå­—èŠ‚åºç›´æ¥æ‹¼æ¥å’Œå¯¹æ¯”(&lt;code&gt;in&lt;/code&gt; æ“ä½œ), ä¸€äº›æ ‡å‡†åº“ä¹Ÿæ˜ç¡®æŒ‡å®šäº†æ¥æ”¶çš„æ˜¯å­—èŠ‚åºè¿˜æ˜¯ Unicode.&lt;/li&gt;
&lt;li&gt;é€šè¿‡å­—ç¬¦ä¸²æ ¼å¼åŒ–æ‹¼æ¥ Unicode å’Œå­—èŠ‚åºä¼šäº§ç”Ÿä¸ç¬¦åˆé¢„æœŸçš„ç»“æœ&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;è¿™é‡Œé¢ç¬¬ &lt;code&gt;1&lt;/code&gt; æ¡å’Œç¬¬ &lt;code&gt;2&lt;/code&gt; æ¡æ˜¯æ¯”è¾ƒå®¹æ˜“, å¯ä»¥é€šè¿‡æ‰¹é‡çš„æŸ¥æ‰¾å’Œæ›¿æ¢æ¥è§£å†³. 3-4 æ˜¯æ¯”è¾ƒéš¾è§£å†³, ä½†æ˜¯å•å…ƒæµ‹è¯•åŸºæœ¬å¯ä»¥è¦†ç›–åˆ°.&lt;/p&gt;
&lt;p&gt;5 ä¼šäº§ç”Ÿä¸€äº›éå¸¸éš¾ä»¥å‘ç°çš„ Bug, å› ä¸ºå‡ºç°åƒä¸‹é¢è¿™æ ·çš„ç»“æœ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;b&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;test&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="s2"&gt;&amp;quot;b&amp;#39;test&amp;#39;&amp;quot;&lt;/span&gt;       &lt;span class="c1"&gt;# Python 2: &amp;quot;test&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœä¸€äº›å•å…ƒæµ‹è¯•æ²¡è¦†ç›–åˆ°çš„æˆ–è€…æœ¬èº«é€»è¾‘å°±æ˜¯è¢« mock æ‰å°±æ›´éš¾æ’æŸ¥.
æ¯”å¦‚æˆ‘ä»¬å†…éƒ¨æœåŠ¡é€šä¿¡å¤§é‡çš„ä½¿ç”¨äº†ç­¾åæœºåˆ¶, åœ¨è¿›è¡Œå•å…ƒæµ‹è¯•æ—¶åˆå¯¹è¿™éƒ¨åˆ†é€»è¾‘è¿›è¡Œäº† mock, 
æ‰€ä»¥åœ¨æˆ‘ä»¬åœ¨æµ‹è¯•ç¯å¢ƒç”¨ Python 3 å¯åŠ¨é¡¹ç›®åä¸»è¦å°±æ˜¯è§£å†³æ­¤ç±»é—®é¢˜.&lt;/p&gt;
&lt;h3 id="_6"&gt;è¿­ä»£å™¨&lt;/h3&gt;
&lt;p&gt;Python 3 ä¸­é™¤äº†å­—ç¬¦ä¸²è¿™ä¸€æ”¹åŠ¨éš¾ä»¥å…¼å®¹, è¿˜æœ‰ä¸€ä¸ªå°±æ˜¯ä¹‹å‰è¿”å›åˆ—è¡¨çš„ä¸€äº›å‡½æ•°æˆ–æ–¹æ³•æ”¹ä¸ºè¿”å›è¿­ä»£å™¨, å¦‚&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;dict.keys/dict.values/dict.items&lt;/li&gt;
&lt;li&gt;map/filter/zip&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœæ²¡æœ‰å¯¹ä¸€äº›è¿­ä»£å™¨è¿›è¡Œå±•å¼€è€Œæ˜¯å½“åšåˆ—è¡¨ä½¿ç”¨å°±ä¼šäº§ç”Ÿå¼‚å¸¸, æˆ–è€…å¯¹è¿­ä»£å™¨å±•å¼€æ²¡æœ‰åŠæ—¶è¿›è¡Œæ”¶é›†å°±ä¼šäº§ç”Ÿä¸€äº›éš¾ä»¥æ’æŸ¥çš„ Bug,
è€ƒè™‘å¦‚ä¸‹ä»£ç :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;foo&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;a&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;  &lt;span class="s2"&gt;&amp;quot;b&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;2&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;}}&lt;/span&gt;
    &lt;span class="n"&gt;digits&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;values&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;item&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;digits&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;item&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;n&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;digits&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šé¢ä»£ç åœ¨ Python 2 ä¸­å¯ä»¥è¾¾åˆ°é¢„æœŸçš„è¡Œä¸º, è¿”å› &lt;code&gt;[{"n": 1}, {"n": 2}]&lt;/code&gt;, ä½†åœ¨ Python 3 ä¼šè¿”å›ä¸€ä¸ªæ¶ˆè€—å®Œçš„è¿­ä»£å™¨, è½¬æ¢ä¹‹åç»“æœä¸º &lt;code&gt;[]&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;ä¸‹é¢ä»£ç åœ¨ Python2 æ˜¯å¯ä»¥æ­£å¸¸å·¥ä½œçš„, ä½†æ˜¯ Python 3 ä¸‹ä¸è¡Œ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;digits&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;a&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;b&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;2&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;digits&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;digits&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;digits&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸»è¦æ˜¯ Python 2 è¯¥æ–¹æ³•è¿”å›ä¸€ä¸ªåˆ—è¡¨æ˜¯å¯¹å­—å…¸ key çš„ä¸€æ¬¡æ‹·è´, æ‰€ä»¥åœ¨æ›´æ”¹å­—å…¸åŸæœ‰å€¼å°±ä¸ä¼šæœ‰é—®é¢˜,
ä½†æ˜¯ Python 3 ä¸­è¯¥æ–¹æ³•è¿”å›äº†ä¸€ä¸ªè¿­ä»£å™¨, æ˜¯å¯¹å­—å…¸ key çš„å¼•ç”¨. å¦‚æœè¿™æ—¶å€™æ›´æ–°å­—å…¸å°±ä¼šè§¦å‘å¼‚å¸¸.&lt;/p&gt;
&lt;h2 id="_7"&gt;å·¥å…·&lt;/h2&gt;
&lt;h3 id="pylint"&gt;pylint&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;pylint&lt;/code&gt; æœ‰ä¸€ä¸ªé€‰é¡¹ &lt;code&gt;--py3k&lt;/code&gt; é€‰é¡¹å¯ä»¥æ‰“å¼€æ£€æµ‹ä¸€äº›ä¸å…¼å®¹ Python 3 çš„åœ°æ–¹, æ¯”å¦‚ &lt;code&gt;map/filter/zip&lt;/code&gt; æ²¡æœ‰å±•å¼€ç­‰.&lt;/p&gt;
&lt;h3 id="pre-commit"&gt;pre-commit&lt;/h3&gt;
&lt;p&gt;å‡†ç¡®çš„è¯´åº”è¯¥æ˜¯ &lt;code&gt;pre-commit&lt;/code&gt; ä¸‹æœ‰ä¸€äº›å·¥å…·å¯ä»¥å¸®åŠ©æˆ‘ä»¬è‡ªåŠ¨ä¿®å¤ä¸€äº› Python 3 çš„å…¼å®¹æ€§é—®é¢˜,
å¹¶ä¸”å¯ä»¥æ–¹ä¾¿çš„æ”¾åœ¨æŒç»­é›†æˆæœåŠ¡ä¸Šè¿è¡Œç›‘æµ‹, è¿™é‡Œåˆ—å‡ºä¸€äº›æˆ‘ä»¬ç”¨äºå¸®åŠ© Python 3 è¿ç§»çš„å·¥å…·:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/asottile/reorder_python_imports"&gt;reorder_python_imports&lt;/a&gt; ä¸»è¦å¯ä»¥é€šè¿‡ &lt;code&gt;--add-import&lt;/code&gt; ä¸ºæ¯æ¬¡ä¿®æ”¹çš„æ–‡ä»¶å¢åŠ ä» &lt;code&gt;__future__&lt;/code&gt; æ¨¡å—å¼•å…¥ä¸€äº›ç‰¹æ€§.&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/asottile/pyupgrade"&gt;pyupgrade&lt;/a&gt; åœ¨æäº¤æ—¶è‡ªåŠ¨ä¿®æ­£ä¸€äº›ä¸å…¼å®¹çš„åœ°æ–¹&lt;/li&gt;
&lt;li&gt;æˆ‘å¯¹ pylint ç®€å•çš„åŒ…è£…&lt;a href="https://github.com/coldnight/pre-commit-pylint"&gt;pre-commit-pylint&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ€åè´´ä¸Šæˆ‘ä»¬é¡¹ç›®æ‰€ä½¿ç”¨çš„ &lt;code&gt;.pre-commit-config&lt;/code&gt; æ–‡ä»¶&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="nt"&gt;repo&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;git@github.com:pre-commit/pre-commit-hooks.git&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nt"&gt;sha&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;v0.8.0&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nt"&gt;hooks&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="nt"&gt;id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;flake8&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="nt"&gt;id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;check-docstring-first&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="nt"&gt;id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;debug-statements&lt;/span&gt;
&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="nt"&gt;repo&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;https://github.com/asottile/reorder_python_imports&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nt"&gt;sha&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;v0.3.5&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nt"&gt;hooks&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="nt"&gt;id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;reorder-python-imports&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;language_version&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;python2.7&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;args&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;--separate-relative&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;--separate-from-import&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;--add-import&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;from __future__ import absolute_import&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;--add-import&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;from __future__ import division&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;--add-import&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;from __future__ import print_function&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;--add-import&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;from __future__ import unicode_literals&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;--remove-import&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;from __future__ import with_statement&lt;/span&gt;
&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="nt"&gt;repo&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;https://github.com/asottile/pyupgrade&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nt"&gt;sha&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;v1.1.1&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nt"&gt;hooks&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="nt"&gt;id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;pyupgrade&lt;/span&gt;
&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="nt"&gt;repo&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;git@github.com:coldnight/pre-commit-pylint.git&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nt"&gt;sha&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;630e2662aabf3236fc62460b163d613c4bd1cfbc&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nt"&gt;hooks&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="nt"&gt;id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;pylint-py3k&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="nt"&gt;id&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;pylint-score-limit&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;args&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;--limit=8.5&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;--rcfile=./.pylintrc&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;additional_dependencies&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;enum34; python_version&amp;lt;=&amp;#39;3.4&amp;#39;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;mock&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p p-Indicator"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="l l-Scalar l-Scalar-Plain"&gt;coverage&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="_8"&gt;åè®°&lt;/h2&gt;
&lt;p&gt;ç›®å‰æˆ‘ä»¬å·²ç»å®Œæˆäº†å…¬å¸æœ€å¤§çš„ä¸€ä¸ªé¡¹ç›®çš„ Python 3 å…¼å®¹, å¹¶äºä»Šå¤©åœ¨æµ‹è¯•ç¯å¢ƒä½¿ç”¨ Python 3 è¿è¡Œ.&lt;/p&gt;
&lt;h2 id="_9"&gt;å‚è€ƒ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://docs.python.org/3/howto/pyporting.html"&gt;å®˜æ–¹æŒ‡å—&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.zlovezl.cn/articles/instagram-pycon-2017/"&gt;Instagram åœ¨ PyCon 2017 çš„æ¼”è®²æ‘˜è¦&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="Python"></category><category term="2to3"></category></entry><entry><title>Python github ç§æœ‰é¡¹ç›®é€šè¿‡ buildbot è¿›è¡Œ Review</title><link href="https://www.linuxzen.com/python-github-si-you-xiang-mu-tong-guo-buildbot-jin-xing-review.html" rel="alternate"></link><published>2016-05-22T00:00:00+08:00</published><updated>2016-05-22T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2016-05-22:/python-github-si-you-xiang-mu-tong-guo-buildbot-jin-xing-review.html</id><summary type="html">&lt;h2 id="_1"&gt;èƒŒæ™¯&lt;/h2&gt;
&lt;p&gt;éšç€å…¬å¸å¼€å‘å›¢é˜Ÿçš„å£®å¤§, å›¢é˜Ÿä¸­æ¯ä¸ªäººçš„æ°´å¹³å‚å·®ä¸é½, ä¸ºäº†ä¿è¯é¡¹ç›®è´¨é‡æˆ‘ä»¬æ‰“ç®—å¯¹
æäº¤çš„ä»£ç è¿›è¡Œ review, ä½†æ˜¯è‹¦ â€¦&lt;/p&gt;</summary><content type="html">&lt;h2 id="_1"&gt;èƒŒæ™¯&lt;/h2&gt;
&lt;p&gt;éšç€å…¬å¸å¼€å‘å›¢é˜Ÿçš„å£®å¤§, å›¢é˜Ÿä¸­æ¯ä¸ªäººçš„æ°´å¹³å‚å·®ä¸é½, ä¸ºäº†ä¿è¯é¡¹ç›®è´¨é‡æˆ‘ä»¬æ‰“ç®—å¯¹
æäº¤çš„ä»£ç è¿›è¡Œ review, ä½†æ˜¯è‹¦äºä¸€ç›´æ²¡æœ‰å¥½çš„ review æœºåˆ¶. å‰æ®µæ—¶é—´æˆ‘åœ¨é€› 
&lt;a href="https://github.com/rust-lang/rust"&gt;Rust&lt;/a&gt; ç¤¾åŒºæ˜¯å‘ç°äº†ä»–ä»¬æœ‰ä¸€ä¸ª review æœºå™¨äºº &lt;a href="https://github.com/barosl/homu"&gt;Homu&lt;/a&gt; éå¸¸ä¸é”™, 
ç ”ç©¶ä¸€ä¸‹åæˆ‘å°†å…¶åº”ç”¨åˆ°æˆ‘ä»¬å½“å‰ Python é¡¹ç›®ä¸­æ¥é…åˆ review, æˆ‘æ„Ÿè§‰éå¸¸æ£’, 
ä»Šå¤©æŠ½ç©ºå°±åˆ†äº«ç»™å¤§å®¶.&lt;/p&gt;
&lt;h2 id="_2"&gt;æŠ€æœ¯æ ˆ&lt;/h2&gt;
&lt;p&gt;æœ¬æ–‡æ¶‰åŠçš„é¡¹ç›®å’ŒæŠ€æœ¯æœ‰:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/barosl/homu"&gt;Homu&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/buildbot/buildbot"&gt;buildbot&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/sebdah/git-pylint-commit-hook"&gt;git-pylint-commit-hook&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.docker.com"&gt;Docker&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="0-github-key"&gt;0. éš”ç¦» Github éƒ¨ç½² Key&lt;/h2&gt;
&lt;p&gt;Github å¯ä»¥æ·»åŠ éƒ¨ç½² Key æ¥å®ç°éƒ¨ç½², ä½†æ˜¯æ¯ä¸ªé¡¹ç›®å¿…é¡»æ˜¯ä¸åŒçš„éƒ¨ç½² key. è¿™å°±ç»™
å¤šä¸ªç§æœ‰é¡¹ç›®çš„å¯æŒç»­é›†æˆå¸¦æ¥ä¸€å®šçš„å›°éš¾, å› ä¸º buildbot æ˜¯é€šè¿‡è½®è¯¢æ¥è·å– git åˆ†æ”¯
å˜æ›´çš„, å¹¶ä¸” buildbot ä¸æ”¯æŒæŒ‡å®šç§é’¥. &lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å‰æœŸæƒ³åˆ°çš„æ˜¯é€šè¿‡ &lt;a href="https://www.docker.com"&gt;Docker&lt;/a&gt; æ¥åˆ†åˆ«è·‘æ¯ä¸ªé¡¹ç›®çš„ buildbot, è¿™æ ·éƒ¨ç½² key å°±
å¯ä»¥å¾ˆå®¹æ˜“è¿›è¡Œéš”ç¦». åé¢æˆ‘ä»¬æ‰¾åˆ°ä¸€ç§æ›´å¥½çš„æ–¹å¼æ¥æŒ‡å®šéƒ¨ç½² Key: é€šè¿‡ &lt;code&gt;ssh_config&lt;/code&gt;
æ¥æŒ‡å®šåˆ«å.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;cat&lt;span class="w"&gt; &lt;/span&gt;~/.ssh/config
Host&lt;span class="w"&gt; &lt;/span&gt;github-project-a-alias
&lt;span class="w"&gt;    &lt;/span&gt;Hostname&lt;span class="w"&gt; &lt;/span&gt;github.com
&lt;span class="w"&gt;    &lt;/span&gt;IdentityFile&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;~/.ssh/project_a_deploy_key&amp;quot;&lt;/span&gt;

Host&lt;span class="w"&gt; &lt;/span&gt;github-project-b-alias
&lt;span class="w"&gt;    &lt;/span&gt;Hostname&lt;span class="w"&gt; &lt;/span&gt;github.com
&lt;span class="w"&gt;    &lt;/span&gt;IdentityFile&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;~/.ssh/project_b_deploy_key&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ ·å°±å¯ä»¥å°†åŸæœ‰çš„é¡¹ç›®åœ°å€åšå¦‚ä¸‹è½¬æ¢&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="gd"&gt;- git@github.com:Owner/a&lt;/span&gt;
&lt;span class="gi"&gt;+ git@github-project-a-alias:Owner/a&lt;/span&gt;

&lt;span class="gd"&gt;- git@github.com:Owner/b&lt;/span&gt;
&lt;span class="gi"&gt;+ git@github-project-b-alias:Owner/b&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="1-homu"&gt;1. æ­å»º homu&lt;/h2&gt;
&lt;p&gt;&lt;a href="https://github.com/barosl/homu"&gt;Homu&lt;/a&gt; æ˜¯ä¸€ä¸ªæ„å»ºåœ¨ Github å’Œ buildbot(æˆ– Travis) ä¹‹ä¸Šçš„å·¥å…·, å®ƒé€šè¿‡ç›‘å¬
PR é‡Œçš„è¯„è®ºæ¥è§¦å‘ buildbot æ„å»º, å¹¶ç›‘å¬æ„å»ºç»“æœ, å¦‚æœæ„å»ºæˆåŠŸåˆ™è‡ªåŠ¨åˆå¹¶ PR&lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/barosl/homu"&gt;Homu&lt;/a&gt; çš„æ­å»ºå¯ä»¥å‚è§å…¶é¡¹ç›®åœ°å€æœ‰ç®€å•çš„ä»‹ç», éå¸¸ç®€å•è¿™é‡Œå°±ä¸åœ¨èµ˜è¿°.&lt;/p&gt;
&lt;p&gt;Homu æ˜¯é’ˆå¯¹ Rust å¼€å‘, å¹¶æ²¡æœ‰è€ƒè™‘ç§æœ‰é¡¹ç›®, æ‰€ä»¥å…¶ä¿¡æ¯éƒ½æ˜¯å…¬å¼€çš„, ä¸ºäº†å‡å°‘
æš´æ¼ä¿¡æ¯å¸¦æ¥çš„å®‰å…¨æ€§é—®é¢˜, æˆ‘ä»¬å°† Homu æ­å»ºåœ¨å†…ç½‘å¹¶é€šè¿‡ ssh ç«¯å£è½¬å‘å°† Homu çš„
ç«¯å£å‘é€åˆ°ä¸€å°å…¬ç½‘æœåŠ¡å™¨:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ssh&lt;span class="w"&gt; &lt;/span&gt;-o&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;TCPKeepAlive&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;yes&lt;span class="w"&gt; &lt;/span&gt;-CfNgR&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;127&lt;/span&gt;.0.0.1:54856:127.0.0.1:54856&lt;span class="w"&gt; &lt;/span&gt;user@remote.ip.address
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åé€šè¿‡ä»¥ä¸‹ nginx é…ç½®æ–‡ä»¶æ¥ä»…æš´æ¼ä¾› Github webhook è°ƒç”¨çš„åœ°å€:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nt"&gt;upstream&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;homu&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;server&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;127.0.0.1:54856&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;


&lt;span class="nt"&gt;server&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;listen&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;public.ip.&lt;/span&gt;&lt;span class="n"&gt;address&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;54856&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;location&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;/github&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="err"&gt;proxy_set_header&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;Host&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;$http_host&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="err"&gt;proxy_redirect&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;off&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="err"&gt;proxy_set_header&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;X-Real-IP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;$remote_addr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="err"&gt;proxy_set_header&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;X-Scheme&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;$scheme&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="err"&gt;proxy_pass&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;homu&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nt"&gt;location&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;~*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(?:^|/)&lt;/span&gt;&lt;span class="err"&gt;\&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="err"&gt;deny&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;all&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ ·å°±å¯ä»¥éšè— Homu æš´éœ²çš„ä¿¡æ¯, å…¶ä»–å®Œæ•´åŠŸèƒ½å¯ä»¥é€šè¿‡å†…ç½‘è®¿é—®.&lt;/p&gt;
&lt;h2 id="2-buildbot"&gt;2. æ­å»º buildbot&lt;/h2&gt;
&lt;p&gt;buildbot å…¶å®˜æ–¹æ–‡æ¡£ä¹Ÿæ¯”è¾ƒè¯¦ç»†, å¯ä»¥å‚è€ƒå…¶å®˜æ–¹æ–‡æ¡£è¿›è¡Œæ­å»º, éœ€è¦æ³¨æ„çš„æ˜¯ç›®å‰ 
&lt;a href="https://github.com/barosl/homu"&gt;homu&lt;/a&gt; é€‚é…çš„ buildbot æ˜¯ 0.8, ç›®å‰ buildbot-0.9 æ­£åœ¨å‘å¸ƒ beta, å’Œ 0.8
æœ‰å¾ˆå¤šåœ°æ–¹éƒ½ä¸å…¼å®¹.&lt;/p&gt;
&lt;p&gt;è¿™é‡Œç€é‡è¯´ä¸€ä¸‹ç»“åˆ pylint åšä»£ç æ£€æŸ¥.&lt;/p&gt;
&lt;h3 id="_3"&gt;ä»£ç æ£€æŸ¥&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬å¸Œæœ›é€šè¿‡ buildbot ä½¿ç”¨ pylint æ¥åšä»£ç æ£€æŸ¥, ä½†æ˜¯è€ƒè™‘åˆ°å†å²é—ç•™é—®é¢˜æˆ‘ä»¬ä»…
å¸Œæœ›å¯¹å½“å‰æäº¤çš„å˜æ›´åšæ£€æŸ¥. ç»¼åˆä¸€ä¸‹å‡ ä¸ªæ–¹é¢ &lt;a href="https://github.com/sebdah/git-pylint-commit-hook"&gt;git-pylint-commit-hook&lt;/a&gt; å¯
ä»¥å®Œç¾çš„æ»¡è¶³éœ€æ±‚:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/sebdah/git-pylint-commit-hook"&gt;git-pylint-commit-hook&lt;/a&gt; é…ç½®æˆ pre-commit å¯ä»¥å¯¹&lt;code&gt;å°†è¦è¢«æäº¤(git add è¿‡)çš„æ–‡ä»¶&lt;/code&gt;è¿›è¡Œæ£€æŸ¥&lt;/li&gt;
&lt;li&gt;é€šè¿‡ &lt;code&gt;git reset HEAD^ --soft&lt;/code&gt; å¯ä»¥å°†ä¸Šä¸€æ¬¡æäº¤çš„æ–‡ä»¶å˜æˆ&lt;code&gt;å°†è¦è¢«æäº¤çš„æ–‡ä»¶&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://github.com/barosl/homu"&gt;Homu&lt;/a&gt; åœ¨æ¥å—(r+)æŸä¸€ PR æ—¶ä¼šå°†å˜æ›´é€šè¿‡ &lt;code&gt;--no-ff&lt;/code&gt;(no fast-forward) çš„æ–¹å¼åˆå¹¶åˆ° &lt;code&gt;auto&lt;/code&gt; åˆ†æ”¯&lt;/li&gt;
&lt;li&gt;é€šè¿‡ no fast-forward åˆå¹¶ç›¸å½“äºå°†æ‰€æ¶‰åŠçš„æäº¤æ‰“äº†ä¸€ä¸ªèŠ‚ç‚¹, åœ¨é€šè¿‡ &lt;code&gt;git reset HEAD^ --soft&lt;/code&gt; è¿›è¡Œé‡ç½®æ—¶ä¼šå°†æ‰€æ¶‰åŠçš„æäº¤çš„æ–‡ä»¶éƒ½å˜æˆ&lt;code&gt;å°†è¦è¢«æäº¤çš„æ–‡ä»¶&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;checkout&lt;span class="w"&gt; &lt;/span&gt;-b&lt;span class="w"&gt; &lt;/span&gt;feature-test
$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# edit file a&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;add&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;commit&lt;span class="w"&gt; &lt;/span&gt;-m&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Change file a&amp;#39;&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# edit file b&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;add&lt;span class="w"&gt; &lt;/span&gt;b&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;commit&lt;span class="w"&gt; &lt;/span&gt;-m&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Change file b&amp;#39;&lt;/span&gt;
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;checkout&lt;span class="w"&gt; &lt;/span&gt;master
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;merge&lt;span class="w"&gt; &lt;/span&gt;--no-ff&lt;span class="w"&gt; &lt;/span&gt;feature-test
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;reset&lt;span class="w"&gt; &lt;/span&gt;HEAD^&lt;span class="w"&gt; &lt;/span&gt;--soft
$&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;status
On&lt;span class="w"&gt; &lt;/span&gt;branch&lt;span class="w"&gt; &lt;/span&gt;master
Changes&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;be&lt;span class="w"&gt; &lt;/span&gt;committed:
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;use&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;git reset HEAD &amp;lt;file&amp;gt;...&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;unstage&lt;span class="o"&gt;)&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;modified:&lt;span class="w"&gt;   &lt;/span&gt;a
&lt;span class="w"&gt;        &lt;/span&gt;modified:&lt;span class="w"&gt;   &lt;/span&gt;b
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;buildbot é…ç½®æ–‡ä»¶ç‰‡æ®µå¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;lint_factory&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;util&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BuildFactory&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;lint_factory&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;addStep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;steps&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Git&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;repourl&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;repo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;full&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;branch&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;auto&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;progress&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;lint_factory&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;addStep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;steps&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ShellCommand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;pip&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;install&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;-U&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;-r&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;requirements.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;span class="n"&gt;lint_factory&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;addStep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;steps&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ShellCommand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;git&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;reset&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;HEAD^&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;--soft&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;span class="n"&gt;lint_factory&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;addStep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;steps&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ShellCommand&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;git-pylint-commit-hook&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;--limit=8&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;--pylintrc=./.pylintrc&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;

&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;builders&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="n"&gt;util&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;BuilderConfig&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;auto-lint&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
      &lt;span class="n"&gt;slavenames&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;example-slave&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
      &lt;span class="n"&gt;factory&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;lint_factory&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¯æ ¹æ®è‡ªèº«éœ€æ±‚åšå˜æ›´, æ¯”å¦‚ &lt;code&gt;--limit=8&lt;/code&gt; æ¥é™åˆ¶æœ€ä½åˆ†æ•°, ä½äºè¿™ä¸ªåˆ†æ•°å°†å¯¼è‡´æ„å»º
å¤±è´¥.&lt;/p&gt;
&lt;p&gt;buildbot å¯è‡ªå®šä¹‰æ€§å¾ˆå¼º, homu æ˜¯å¯ä»¥æ”¯æŒå¤šä¸ª builder çš„. æ‰€ä»¥é™¤äº†ä»£ç æ£€æŸ¥æˆ‘ä»¬
è¿˜æœ‰æµ‹è¯•. Homu åœ¨æ£€æµ‹è¿™ä¸¤ä¸ª Builder éƒ½æ„å»ºæˆåŠŸåæ‰ä¼šåˆå¹¶å½“å‰ PR.&lt;/p&gt;
&lt;h2 id="3"&gt;3. å·¥ä½œæµ&lt;/h2&gt;
&lt;p&gt;å®ç°äº†å¦‚ä¸ŠåŠŸèƒ½ä¹‹åæˆ‘ä»¬å¯¹å·¥ä½œæµè¿›è¡Œäº†è°ƒæ•´:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;é€šè¿‡ä¸»é¢˜åˆ†æ”¯å¼€å‘å¹¶å¾€é•¿æœŸåˆ†æ”¯æäº¤ PR&lt;/li&gt;
&lt;li&gt;reviewer åœ¨ &lt;code&gt;LGTM&lt;/code&gt; åæäº¤è¯„è®º &lt;code&gt;r+&lt;/code&gt; å¹¶ @ Homu è´¦å·(@homu r+)&lt;/li&gt;
&lt;li&gt;ä¹‹å Homu ä¼šåˆå¹¶ PR å˜æ›´åˆ° &lt;code&gt;auto&lt;/code&gt; åˆ†æ”¯&lt;/li&gt;
&lt;li&gt;buildbot ç›‘å¬åˆ° &lt;code&gt;auto&lt;/code&gt; åˆ†æ”¯çš„å˜æ›´åå°±ä¼šè¿è¡Œç›¸åº”æ„å»ºå¹¶åœ¨å®Œæˆååé€šçŸ¥ Homu&lt;/li&gt;
&lt;li&gt;Homu åœ¨æ”¶åˆ°æˆåŠŸçš„é€šçŸ¥ååˆå¹¶ PR åˆ°é•¿æœŸåˆ†æ”¯&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="4"&gt;4. å·²çŸ¥é—®é¢˜&lt;/h2&gt;
&lt;p&gt;Homu åœ¨å°† &lt;code&gt;auto&lt;/code&gt; åˆ†æ”¯åˆå¹¶åˆ°é•¿æœŸåˆ†æ”¯æ—¶ä¼šé‡‡ç”¨ &lt;code&gt;fast-forward&lt;/code&gt; çš„æ–¹å¼è¿›è¡Œåˆå¹¶, 
æ‰€ä»¥ä¸ä¼šäº§ç”Ÿæ–°çš„ commit, buildbot 0.8 å¯¹åŒä¸€æäº¤(sha ç›¸åŒ) ä»…è§¦å‘ä¸€æ¬¡ build.
æ‰€ä»¥ä¼šå¯¼è‡´å…¶ä»–ä¸€äº›æ¯”å¦‚è‡ªåŠ¨éƒ¨ç½²çš„ builder æ— æ³•è§¦å‘.&lt;/p&gt;</content><category term="Python"></category><category term="Python"></category><category term="github"></category><category term="ç§æœ‰"></category><category term="å¯æŒç»­é›†æˆ"></category><category term="homu"></category><category term="buildbot"></category><category term="review"></category></entry><entry><title>Python mock ä½¿ç”¨å¿ƒå¾—</title><link href="https://www.linuxzen.com/python-mock-shi-yong-xin-de.html" rel="alternate"></link><published>2016-04-03T11:42:00+08:00</published><updated>2016-04-03T11:42:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2016-04-03:/python-mock-shi-yong-xin-de.html</id><summary type="html">&lt;p&gt;å¥½ä¹…æ²¡æœ‰æ›´æ–°åšå®¢, è¶ç€æ¸…æ˜èŠ‚å°é•¿å‡å’Œæˆ‘å„¿å­æ­£åœ¨ç¡è§‰æ›´æ–°ä¸€ç¯‡åˆ·åˆ·å­˜åœ¨æ„Ÿ.
è¿‘æ¥å˜åŒ–å¾ˆå¤š, å„¿å­ä¹Ÿæœ‰äº†, å·¥ä½œä¸Šä¹Ÿæœ‰å¾ˆ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;å¥½ä¹…æ²¡æœ‰æ›´æ–°åšå®¢, è¶ç€æ¸…æ˜èŠ‚å°é•¿å‡å’Œæˆ‘å„¿å­æ­£åœ¨ç¡è§‰æ›´æ–°ä¸€ç¯‡åˆ·åˆ·å­˜åœ¨æ„Ÿ.
è¿‘æ¥å˜åŒ–å¾ˆå¤š, å„¿å­ä¹Ÿæœ‰äº†, å·¥ä½œä¸Šä¹Ÿæœ‰å¾ˆå¤šæ”¶è·. è¿™ç¯‡åšå®¢å°±åˆ†äº«ä¸€ä¸‹å…³äº &lt;code&gt;mock&lt;/code&gt; çš„ä½¿ç”¨çš„å¿ƒå¾—ä½“ä¼š.&lt;/p&gt;
&lt;p&gt;å¾ˆé•¿ä¸€æ®µæ—¶é—´ä»¥æ¥å†™å•å…ƒæµ‹è¯•éƒ½ç±»ä¼¼å†™æ‰§è¡Œè„šæœ¬, è¿è¡Œä¸€ä¸‹ç„¶åçœ‹ä¸€ä¸‹ç»“æœ. 
è¿™é‡Œé¢æœ‰ä¸€éƒ¨åˆ†åŸå› æ˜¯å› ä¸ºæ— æ³•è§„é¿å¤–éƒ¨çš„ä¾èµ–ç»„ä»¶, æ¯”å¦‚:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ•°æ®åº“æ“ä½œ&lt;/li&gt;
&lt;li&gt;å¤–éƒ¨æ¥å£è°ƒç”¨&lt;/li&gt;
&lt;li&gt;å¤–éƒ¨å…¶ä»–ä¸å¯æ§å› ç´ &lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;è¿™æ ·å†™æµ‹è¯•åªå…³å¿ƒå½“å‰æµ‹è¯•çš„ç»“æœ, è€Œä¸å»ç®¡å…¶ä»–æµ‹è¯•æ˜¯å¦ &lt;code&gt;passed&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;åé¢éšç€å›¢é˜Ÿå¼€å§‹è¿›æ–°äºº, ç”±äºå›¢é˜Ÿé‡Œæ¯ä¸ªäººçš„æ ‡å‡†å’Œæ°´å¹³ä¸åŒ, 
å¼€å§‹ä¸å¾—ä¸é‡è§†æ•´ä½“é¡¹ç›®çš„è´¨é‡, å‘ç°æ²¡æœ‰å¥½çš„æµ‹è¯•å°±æ²¡æœ‰ç»Ÿä¸€çš„æ ‡å‡†æ¥è¡¡é‡æäº¤ä»£ç çš„è´¨é‡,
å½“ç„¶è¯´åˆ°ä»£ç è´¨é‡è¿˜æœ‰å¦å¤–ä¸€ä¸ªå’Œæµ‹è¯•æ”¾åœ¨ä¸€èµ·çš„æ ‡å‡†å°±æ˜¯ä»£ç é£æ ¼, è¿™ä¸æ˜¯æœ¬æ–‡çš„ä¸»é¢˜æ‰€é‡Œè¿™é‡Œå°±æš‚ä¸”ä¸æ.&lt;/p&gt;
&lt;p&gt;ä¸ºäº†èƒ½å†™å¥½æµ‹è¯•å°±ä¸å¾—ä¸é¢å¯¹ç°å®é¡¹ç›®çš„å¤æ‚æ€§, è¯¸å¦‚å¤–éƒ¨æ¥å£æ•°æ®åº“æ“ä½œç­‰. 
è¿™æ—¶å¼€å§‹å°†ç›®å…‰è½¬å‘ &lt;code&gt;mock&lt;/code&gt;, å› ä¸ºä¹‹å‰æœ‰å¬è¿‡ç±»ä¼¼æ¦‚å¿µ, ä½†æ˜¯è¿˜æ˜¯æœ‰è¯¯è§£, 
ä»¥ä¸ºæŠŠè¦æµ‹çš„ä¸œè¥¿éƒ½æ¨¡æ‹Ÿæ‰äº†è¿˜æµ‹è¯•ä»€ä¹ˆå‘¢? ä½†æ˜¯çœŸæ­£çš„äº†è§£ &lt;code&gt;mock&lt;/code&gt; ä¹‹åæ‰å®Œæ•´çš„ç†è§£äº†å•å…ƒæµ‹è¯•.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;å•å…ƒæµ‹è¯•åº”è¯¥åªé’ˆå¯¹å½“å‰å•å…ƒè¿›è¡Œæµ‹è¯•, æ‰€æœ‰çš„å¤–éƒ¨ä¾èµ–åº”è¯¥æ˜¯ç¨³å®šçš„, åœ¨åˆ«å¤„è¿›è¡Œæµ‹è¯•è¿‡çš„.&lt;/strong&gt;
ä½¿ç”¨ &lt;code&gt;mock&lt;/code&gt; å°±å¯ä»¥å¯¹å¤–éƒ¨ä¾èµ–ç»„ä»¶å®ç°è¿›è¡Œæ¨¡æ‹Ÿå¹¶ä¸”æ›¿æ¢æ‰, ä»è€Œéšè—å¤–éƒ¨ç»„ä»¶çš„å®ç°,
ä½¿å¾—å•å…ƒæµ‹è¯•å°†ç„¦ç‚¹åªæ”¾åœ¨å½“å‰çš„é€»è¾‘(å½“å‰å•å…ƒ),&lt;/p&gt;
&lt;h2 id="_1"&gt;å®‰è£…&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;mock&lt;/code&gt; åœ¨ Python3 ä¸­æ˜¯å†…ç½®çš„, ç›´æ¥ &lt;code&gt;import unittest.mock&lt;/code&gt; å³å¯, 
ä½†æ˜¯åœ¨ Python2 ä¸­æ˜¯éœ€è¦é¢å¤–å®‰è£…çš„, å®‰è£…å®Œ &lt;code&gt;import mock&lt;/code&gt; å³å¯&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;pip&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;-U&lt;span class="w"&gt; &lt;/span&gt;mock
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="_2"&gt;æŠ€å·§&lt;/h2&gt;
&lt;p&gt;åœ¨æœ¬æ–‡ä¸è¯¦ç»†ä»‹ç»å¦‚ä½•ä½¿ç”¨, å…·ä½“è¯·å‚è§&lt;a href="https://docs.python.org/3/library/unittest.mock.html"&gt;å®˜æ–¹æ–‡æ¡£&lt;/a&gt;.
è¿™é‡Œåˆ†äº«å‡ ä¸ªæŠ€å·§.&lt;/p&gt;
&lt;p&gt;å®‰è£…å®˜æ–¹æ–‡æ¡£ç»™çš„ç¤ºä¾‹ä¸€å¼€å§‹åƒä¸‹é¢è¿™ä¹ˆä½¿ç”¨ mock&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DemoTestCase&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;unittest&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TestCase&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nd"&gt;@mock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;patch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;pkg.mod.dep_mod.func&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;autospec&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_demo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;func_mock&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;func_mock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;return_value&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;

        &lt;span class="c1"&gt;# real test code&lt;/span&gt;
        &lt;span class="n"&gt;func_mock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;assert_called_with&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;arg1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arg2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä½†æ˜¯å½“æ•´ä¸ªæµ‹è¯•éƒ½ä¾èµ–è¿™ä¸ªç»„ä»¶æ—¶ä¸Šé¢çš„ä½¿ç”¨æ–¹å¼å°±ä¼šäº§ç”Ÿå¤§é‡çš„ç›¸åŒçš„åˆå§‹åŒ–ä»£ç , 
æ‰€ä»¥å®šä¹‰äº†ä¸€ä¸ªè£…é¥°å™¨å‘ä¸‹é¢è¿™æ ·&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;unittest&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;functools&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;mock&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;_mock_wrapper&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nd"&gt;@functools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wraps&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nd"&gt;@mock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;patch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;pkg.mod.dep_mod.func&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;autospec&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;wrapper&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;func_mock&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;func_mock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;return_value&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;func_mock&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;wrapper&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DemoTestCase&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;unittest&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TestCase&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nd"&gt;@_mock_wrapper&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_demo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;func_mock&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="c1"&gt;# real test code&lt;/span&gt;
        &lt;span class="n"&gt;func_mock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;assert_called_with&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;arg1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arg2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šé¢æ“ä½œæ˜¯å¾ˆæ–¹ä¾¿, ä½†æ˜¯æœ‰å‡ ä¸ªç¼ºç‚¹:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä»£ç ä¸å¤Ÿæ¸…æ™°&lt;/li&gt;
&lt;li&gt;å¦‚æœå¢åŠ  mock ç»„ä»¶åˆ™éœ€è¦ä¿®æ”¹æ¯ä¸€ä¸ªè¢«è£…é¥°å‡½æ•°æ¥æ”¶çš„å‚æ•°&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æ‰€ä»¥åœ¨ä»”ç»†é˜…è¯»å®˜æ–¹æ–‡æ¡£åå‘ç°, &lt;code&gt;mock.patch&lt;/code&gt; è¿”å›ä¸€ä¸ªå¯¹è±¡, å¯ä»¥é€šè¿‡ &lt;code&gt;start&lt;/code&gt;/&lt;code&gt;stop&lt;/code&gt; æ–¹æ³•æ¥åº”ç”¨.
æ‰€ä»¥äº§ç”Ÿäº†ä¸‹é¢çš„ä»£ç .&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DemoTestCase&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;unittest&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TestCase&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;setUp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;DemoTestCase&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setUp&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_patcher&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;patch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;pkg.mod.dep_mod.func&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;autospec&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_func_mock&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_patcher&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_func_mock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;return_value&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;tearDown&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;DemoTestCase&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tearDown&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="c1"&gt;# cleanup&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_patcher&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_demo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="c1"&gt;# real test code&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_func_mock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;assert_called_with&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;arg1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arg2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å½“ç„¶å¦‚æœæœ‰å¤šä¸ªä¾èµ–ç»„ä»¶éœ€è¦ &lt;code&gt;mock&lt;/code&gt; å¯ä»¥å°† &lt;code&gt;patcher&lt;/code&gt; å­˜åœ¨ä¸€ä¸ªåˆ—è¡¨é‡Œåœ¨ &lt;code&gt;tearDown&lt;/code&gt; æ–¹æ³•é‡Œç»Ÿä¸€æ¸…ç†.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ä¸è¦å¿˜è®°æ¸…ç†, å› ä¸ºå½“å‰ &lt;code&gt;mock&lt;/code&gt; çš„ç»„ä»¶åº”å½“ä»…åœ¨å½“å‰æµ‹è¯•é‡Œç”Ÿæ•ˆ, å¦‚æœå¿˜è®°äº†æ¸…ç†å¯èƒ½ä¼šå½±å“åˆ°å…¶ä»–æµ‹è¯•.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœå½“å‰å•å…ƒæµ‹è¯•ä»…æœ‰éƒ¨åˆ†æµ‹è¯•ä¾èµ–è¯¥ç»„ä»¶ä¹Ÿå¯ä»¥é€šè¿‡ä¸Šä¸‹æ–‡ç®¡ç†çš„æ–¹å¼è¿›è¡Œç®¡ç†, æ›´åŠ çµæ´».&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;contextlib&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;DemoTestCase&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;unittest&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TestCase&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nd"&gt;@contextlib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;contextmanger&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;_mock_context&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;patcher&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;patch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;pkg.mod.dep_mod.func&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;autospec&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;func_mock&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;patcher&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="n"&gt;func_mock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;return_value&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
            &lt;span class="k"&gt;yield&lt;/span&gt; &lt;span class="n"&gt;func_mock&lt;/span&gt;
        &lt;span class="k"&gt;finally&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;patcher&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test_demo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;with&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_mock_context&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;func_mock&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="c1"&gt;# real test code&lt;/span&gt;
            &lt;span class="n"&gt;func_mock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;assert_called_with&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;arg1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;arg2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="_3"&gt;å†™åœ¨åé¢çš„è¯&lt;/h2&gt;
&lt;p&gt;æµ‹è¯•å¯¹ä¸€ä¸ªé¡¹ç›®å¾ˆé‡è¦, ç‰¹åˆ«æ˜¯å¯¹ä¸Šäº†è§„æ¨¡çš„é¡¹ç›®, ä¸Šäº† &lt;code&gt;mock&lt;/code&gt; ä¹‹åæˆ‘èŠ±äº†å¾ˆé•¿æ—¶é—´å°†å·²æœ‰é¡¹ç›®çš„æµ‹è¯•æ•´ç†å®Œæ¯•, 
ä½¿æµ‹è¯•æœ‰æ•ˆå¹¶ä¸”å¯ä»¥å…¨éƒ¨ &lt;code&gt;passed&lt;/code&gt;. 
æœ‰äº†è‰¯å¥½çš„åŸºç¡€ä¹‹åæ¥ä¸‹æ¥å°±å¾ˆæ–¹ä¾¿çš„ä½¿ç”¨äº†ä¸€äº›é›†æˆå·¥å…·æ¥é™åˆ¶ä¸è§„èŒƒçš„ä»£ç æäº¤åˆ°é•¿æœŸåˆ†æ”¯, 
è¿™éƒ¨åˆ†å†…å®¹å°†æ”¾åœ¨ä¸‹ä¸€ç¯‡å»åˆ†äº«.&lt;/p&gt;</content><category term="Python"></category><category term="Python"></category><category term="mock"></category><category term="unittest"></category></entry><entry><title>Python å†…å­˜æ³„éœ²å®æˆ˜åˆ†æ</title><link href="https://www.linuxzen.com/python-nei-cun-xie-lu-shi-zhan-fen-xi.html" rel="alternate"></link><published>2015-03-30T17:29:00+08:00</published><updated>2015-03-30T17:29:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2015-03-30:/python-nei-cun-xie-lu-shi-zhan-fen-xi.html</id><summary type="html">&lt;h2 id="_1"&gt;å¼•å­&lt;/h2&gt;
&lt;p&gt;ä¹‹å‰ä¸€ç›´ç›²ç›®çš„è®¤ä¸º Python ä¸ä¼šå­˜åœ¨å†…å­˜æ³„éœ², ä½†æ˜¯çœ¼çœ‹ç€ä¸Šçº¿çš„é¡¹ç›®éšç€è¿è¡Œæ—¶é—´çš„å¢é•¿
è€Œè¶Šæ¥è¶Šå¤§çš„å†…å­˜å ç”¨, æˆ‘ â€¦&lt;/p&gt;</summary><content type="html">&lt;h2 id="_1"&gt;å¼•å­&lt;/h2&gt;
&lt;p&gt;ä¹‹å‰ä¸€ç›´ç›²ç›®çš„è®¤ä¸º Python ä¸ä¼šå­˜åœ¨å†…å­˜æ³„éœ², ä½†æ˜¯çœ¼çœ‹ç€ä¸Šçº¿çš„é¡¹ç›®éšç€è¿è¡Œæ—¶é—´çš„å¢é•¿
è€Œè¶Šæ¥è¶Šå¤§çš„å†…å­˜å ç”¨, æˆ‘æ„è¯†åˆ°æˆ‘å†™çš„ç¨‹åºåœ¨å‘ç”Ÿå†…å­˜æ³„éœ², ä¹‹å‰ debug è¿‡ 
&lt;a href="http://www.linuxzen.com/logging-mo-kuai-wu-yong-dao-zhi-de-nei-cun-xie-lu.html"&gt;logging æ¨¡å—å¯¼è‡´çš„å†…å­˜æ³„éœ²&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;ç›®å‰çœ‹æ¥, è¿˜æœ‰åˆ«çš„åœ°æ–¹å¼•èµ·çš„å†…å­˜æ³„éœ². ç»è¿‡ä¸€å¤©çš„å¥‹æˆ˜, ç»ˆäºæ‰¾åˆ°äº†å†…å­˜æ³„éœ²çš„åœ°æ–¹, ç›®å‰é¡¹ç›®
è·‘äº†å¾ˆé•¿æ—¶é—´, åœ¨ä¸šåŠ¡é‡è¾ƒå°çš„æ—¶å€™å†…å­˜è¿˜æ˜¯èƒ½å›åˆ°åˆšå¯åŠ¨çš„æ—¶å€™çš„å†…å­˜å ç”¨.&lt;/p&gt;
&lt;h2 id="_2"&gt;ä»€ä¹ˆæƒ…å†µä¸‹ä¸ç”¨è¿™ä¹ˆéº»çƒ¦&lt;/h2&gt;
&lt;p&gt;å¦‚æœä½ çš„ç¨‹åºåªæ˜¯è·‘ä¸€ä¸‹å°±é€€å‡ºå¤§å¯ä¸å¿…å¤§è´¹å‘¨ç« çš„å»æŸ¥æ‰¾æ˜¯å¦æœ‰å†…å­˜æ³„éœ², å› ä¸º Python åœ¨é€€å‡ºæ—¶
ä¼šé‡Šæ”¾å®ƒæ‰€åˆ†é…çš„æ‰€æœ‰å†…å­˜, å¦‚æœä½ çš„ç¨‹åºéœ€è¦è¿ç»­è·‘å¾ˆé•¿æ—¶é—´é‚£ä¹ˆå°±è¦ä»”ç»†çš„æŸ¥æ‰¾æ˜¯å¦
äº§ç”Ÿäº†å†…å­˜æ³„éœ².&lt;/p&gt;
&lt;h2 id="_3"&gt;åœºæ™¯&lt;/h2&gt;
&lt;p&gt;å¦‚ä½•äº§ç”Ÿçš„å†…å­˜æ³„éœ²å‘¢, é¡¹ç›®æ˜¯ä¸€ä¸ª TCP server, æ¯å½“æœ‰è¿æ¥è¿‡æ¥æ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªè¿æ¥å®ä¾‹æ¥è¿›è¡Œ
ç®¡ç†, æ¯æ¬¡æ–­å¼€æ—¶è¿æ¥å®ä¾‹è¿˜è¢«å ç”¨å¹¶æ²¡æœ‰é‡Šæ”¾. æ²¡æœ‰è¢«é‡Šæ”¾çš„åŸå› è‚¯å®šæ˜¯å› ä¸ºæœ‰æŸä¸ªåœ°æ–¹å¯¹è¿æ¥
å®ä¾‹çš„å¼•ç”¨æ²¡æœ‰é‡Šæ”¾, æ‰€ä»¥éšç€æ—¶é—´çš„æ¨ç§», è¿æ¥åˆ›å»ºåˆ†é…å†…å­˜, è¿æ¥æ–­å¼€å¹¶æ²¡æœ‰é‡Šæ”¾æ‰å†…å­˜, æ‰€ä»¥
å°±ä¼šäº§ç”Ÿå†…å­˜æ³„éœ².&lt;/p&gt;
&lt;h2 id="_4"&gt;è°ƒè¯•æ–¹æ³•&lt;/h2&gt;
&lt;p&gt;ç”±äºä¸çŸ¥é“å…·ä½“æ˜¯å“ªé‡Œå¼•èµ·çš„å†…å­˜æ³„éœ², æ‰€ä»¥è¦è€å¿ƒçš„ä¸€ç‚¹ç‚¹è°ƒè¯•. &lt;/p&gt;
&lt;p&gt;ç”±äºçŸ¥é“äº†æ–­å¼€è¿æ¥æ—¶æ²¡æœ‰é‡Šæ”¾, æ‰€ä»¥æˆ‘å°±ä¸åœçš„æ¨¡æ‹Ÿåˆ›å»ºè¿æ¥ç„¶åå‘é€ä¸€äº›åŒ…åæ–­å¼€è¿æ¥, 
ç„¶åé€šè¿‡ä¸‹é¢ä¸€è¡Œ shell æ¥è§‚å¯Ÿå†…å­˜å ç”¨æƒ…å†µ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nv"&gt;PID&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;50662&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;true&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;do&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;ps&lt;span class="w"&gt; &lt;/span&gt;aux&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$PID&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;-v&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;awk&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;{print $5&amp;quot; &amp;quot;$6}&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;t&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;sleep&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœåœ¨å¢é•¿äº†ä¸€å®šçš„é‡åä¿æŒä½å°±è¯´æ˜å·²ç»æ²¡æœ‰äº§ç”Ÿæ³„éœ².&lt;/p&gt;
&lt;p&gt;åŒæ—¶å¯ä»¥åœ¨å¯¹è±¡è¯¥é‡Šæ”¾çš„æ—¶å€™æŸ¥çœ‹å¯¹è±¡çš„å¼•ç”¨è®¡æ•°, é€šè¿‡ &lt;code&gt;sys.getrefcount(obj)&lt;/code&gt;. å¦‚æœå¼•ç”¨è®¡æ•°å˜ä¸ºäº† &lt;code&gt;2&lt;/code&gt; 
åˆ™è¯´æ˜è¯¥å¯¹è±¡åœ¨è·³å‡ºå‘½åç©ºé—´åå°±ä¼šè¢«æ­£ç¡®å›æ”¶.&lt;/p&gt;
&lt;h2 id="_5"&gt;äº§ç”ŸåŸå› &lt;/h2&gt;
&lt;p&gt;é¡¹ç›®ä¸­ä¸¤ç§æƒ…å†µå¯¼è‡´å¯¹è±¡æ²¡æœ‰è¢«æ­£ç¡®å›æ”¶:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è¢«é€€å‡ºæ‰å›æ”¶çš„å¯¹è±¡å¼•ç”¨&lt;/li&gt;
&lt;li&gt;äº¤å‰å¼•ç”¨&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="_6"&gt;è¢«é€€å‡ºæ‰å›æ”¶çš„å¯¹è±¡å¼•ç”¨&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†è¿½è¸ªè¿æ¥æ‰€ä»¥æŠŠè¿æ¥å¯¹è±¡åŒæ—¶æ”¾åœ¨ä¸€ä¸ªåˆ—è¡¨é‡Œ, è€Œè¿™ä¸ªåˆ—è¡¨åªæœ‰åœ¨ç¨‹åºé€€å‡ºæ—¶æ‰ä¼šè¢«å›æ”¶, 
å¦‚æœä¸æ­£ç¡®å¤„ç†, é‚£ä¹ˆåˆ†é…çš„å¯¹è±¡å°†ä¹Ÿä¼šåªåœ¨ç¨‹åºé€€å‡ºæ—¶æ‰ä¼šè¢«å›æ”¶.&lt;/p&gt;
&lt;p&gt;å…¨å±€å˜é‡å’Œç±»å˜é‡éƒ½åªä¼šåœ¨ç¨‹åºé€€å‡ºçš„æ—¶å€™æ‰ä¼šè¢«å›æ”¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;_CONNECTIONS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;

&lt;span class="c1"&gt;# ...&lt;/span&gt;
&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;address&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;pass&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;server_loop&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="c1"&gt;# ...&lt;/span&gt;
    &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;address&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;server_sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;accept&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;connection&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;address&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;_CONNECTIONS&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="c1"&gt;# ...&lt;/span&gt;
    &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šé¢æŠŠæ‰€æœ‰å»ºç«‹çš„è¿æ¥éƒ½æ”¾åœ¨å…¨å±€å˜é‡ &lt;code&gt;_CONNECTIONS&lt;/code&gt; é‡Œ, å¦‚æœåœ¨å…³é—­çš„æ—¶å€™ä¸ä»è¿™ä¸ªåˆ—è¡¨
é‡Œå–å‡º(å‡å°‘å¼•ç”¨)åˆ™ connection å¯¹è±¡å°±ä¸ä¼šè¢«å›æ”¶, åˆ™æ¯å»ºç«‹ä¸€æ¬¡è¿æ¥å°±ä¼šæœ‰ä¸ªè¿æ¥å¯¹è±¡å’Œè¿æ¥
å¯¹è±¡å¼•ç”¨çš„å¯¹è±¡ä¸ä¼šè¢«å›æ”¶.&lt;/p&gt;
&lt;p&gt;å¦‚æœæŠŠå¯¹è±¡æ”¾åœ¨ä¸€ä¸ªç±»å±æ€§é‡Œä¹Ÿæ˜¯ä¸€æ ·çš„, å› ä¸ºç±»å¯¹è±¡åœ¨ç¨‹åºä¸€å¼€å§‹å°±åˆ†é…, å¹¶åœ¨ç¨‹åºé€€å‡ºæ—¶æ‰è¢«å›æ”¶.&lt;/p&gt;
&lt;p&gt;è§£å†³åŠæ³•å°±æ˜¯åœ¨é€€å‡ºæ—¶ä»åˆ—è¡¨(æˆ–å…¶ä»–å¯¹è±¡)é‡Œè§£é™¤å¯¹å¯¹è±¡çš„å¼•ç”¨(åˆ é™¤)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;_CONNECTIONS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;

&lt;span class="c1"&gt;# ...&lt;/span&gt;
&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;address&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;pass&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;server_loop&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="c1"&gt;# ...&lt;/span&gt;
    &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;address&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;server_sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;accept&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;connection&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;address&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;_CONNECTIONS&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="c1"&gt;# ...&lt;/span&gt;
        &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;finally&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;_CONNECTIONS&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;remove&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# XXX&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_7"&gt;äº¤å‰å¼•ç”¨&lt;/h3&gt;
&lt;p&gt;æœ‰æ—¶å€™æˆ‘ä»¬ä¸ºå¯¹è±¡åˆ†é…ä¸€ä¸ªå®ä¾‹å±æ€§æ—¶éœ€è¦å°†è‡ªå·±æœ¬èº«èµ‹å€¼ç»™å®ä¾‹å±æ€§, ä½œä¸ºå®ä¾‹å±æ€§çš„å®ä¾‹å±æ€§,
è¯´ç€å¾ˆæ‹—å£, çœ‹ä¸€ä¸‹ä»£ç :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ConnectionHandler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_conn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;connection&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;address&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_conn_handler&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ConnectionHandler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# XXX&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šé¢çš„ä»£ç å°±ä¼šäº§ç”Ÿäº¤å‰å¼•ç”¨, äº¤å‰å¼•ç”¨ä¼šè®©è§£é‡Šå™¨å›°æƒ‘, ä»è€Œä¹‹ååªèƒ½é 2ä»£å’Œ3ä»£å›æ”¶, è¿™ä¸ªè¿‡ç¨‹å¯èƒ½ä¼šå¾ˆæ…¢.&lt;/p&gt;
&lt;p&gt;è§£å†³è¿™ç§é—®é¢˜çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨ &lt;code&gt;å¼±å¼•ç”¨&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;weakref&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ConnectionHandler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_conn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;connection&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;address&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_conn_handler&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ConnectionHandler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;weakref&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;proxy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="c1"&gt;# XXX&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_8"&gt;æ—¥å¿—æ¨¡å—&lt;/h3&gt;
&lt;p&gt;å‚è§ &lt;a href="http://www.linuxzen.com/logging-mo-kuai-wu-yong-dao-zhi-de-nei-cun-xie-lu.html"&gt;logging æ¨¡å—å¯¼è‡´çš„å†…å­˜æ³„éœ²&lt;/a&gt;.&lt;/p&gt;
&lt;h2 id="_9"&gt;å‚è€ƒ&lt;/h2&gt;
&lt;p&gt;&lt;a href="http://www.cnblogs.com/vamei/p/3232088.html"&gt;Python åƒåœ¾å›æ”¶&lt;/a&gt;&lt;/p&gt;</content><category term="Python"></category><category term="Python"></category><category term="å†…å­˜"></category><category term="æ³„éœ²"></category><category term="å¼•ç”¨"></category><category term="å›æ”¶"></category><category term="äº¤å‰"></category></entry><entry><title>logging æ¨¡å—è¯¯ç”¨å¯¼è‡´çš„å†…å­˜æ³„éœ²</title><link href="https://www.linuxzen.com/logging-mo-kuai-wu-yong-dao-zhi-de-nei-cun-xie-lu.html" rel="alternate"></link><published>2015-01-31T10:58:00+08:00</published><updated>2015-01-31T10:58:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2015-01-31:/logging-mo-kuai-wu-yong-dao-zhi-de-nei-cun-xie-lu.html</id><summary type="html">&lt;p&gt;é¦–å…ˆä»‹ç»ä¸‹æ€ä¹ˆå‘ç°çš„å§, çº¿ä¸Šçš„é¡¹ç›®æ—¥å¿—æ˜¯é€šè¿‡ &lt;code&gt;logging&lt;/code&gt; æ¨¡å—æ‰“åˆ° syslog é‡Œ, 
è·‘äº†ä¸€æ®µæ—¶é—´åå‘ç° syslog çš„ UDP è¿æ¥è¶…è¿‡äº† 8W, æ²¡é”™æ˜¯ 8 â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;é¦–å…ˆä»‹ç»ä¸‹æ€ä¹ˆå‘ç°çš„å§, çº¿ä¸Šçš„é¡¹ç›®æ—¥å¿—æ˜¯é€šè¿‡ &lt;code&gt;logging&lt;/code&gt; æ¨¡å—æ‰“åˆ° syslog é‡Œ, 
è·‘äº†ä¸€æ®µæ—¶é—´åå‘ç° syslog çš„ UDP è¿æ¥è¶…è¿‡äº† 8W, æ²¡é”™æ˜¯ 8 W. ä¸»è¦æ˜¯ logging 
æ¨¡å—ç”¨çš„ä¸å¯¹&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä¹‹å‰æœ‰è¿™ä¹ˆä¸€ä¸ªéœ€æ±‚, å°±æ˜¯é’ˆå¯¹æ¯ä¸€ä¸ªè¿æ¥æ—¥å¿—è¾“å‡ºå½“å‰è¿æ¥çš„ä¿¡æ¯, æ‰€ä»¥æ¯ä¸€ä¸ª
è¿æ¥å°±åˆ›å»ºäº†ä¸€ä¸ªæ—¥å¿—å®ä¾‹, å¹¶åˆ†é…ä¸€ä¸ª &lt;code&gt;Formatter&lt;/code&gt;, åˆ›å»ºæ—¥å¿—å®ä¾‹ä¸ºäº†åŒºåˆ†å…¶ä»–è¿æ¥
æ‰€ä»¥æˆ‘å°±ç®€å•ç²—æš´çš„ç”¨äº†å½“å‰å¯¹è±¡çš„ id æ¥ä½œä¸ºæ—¥å¿—åç§°:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;logging&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_logger_name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Connection.&lt;/span&gt;&lt;span class="si"&gt;{}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;id&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;logger&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getLogger&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_logger_name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å½“ç„¶æµ‹è¯•ç¯å¢ƒæ˜¯å¼€ DEBUG, å¼€ DEBUG å°±ä¸ä¼šå¾€ syslog é‡Œæ‰“, æ‰€ä»¥ä¸ä¼šå‡ºç° UDP è¿æ¥æ•°
è¿‡å¤š, ä¹Ÿå°±ä¸ä¼šçŸ¥é“æœ‰å†…å­˜æ³„éœ²çš„, æˆ‘ä»¬æ¥çœ‹çœ‹è¿™æ ·ä¸ºä»€ä¹ˆä¼šå¯¼è‡´å†…å­˜æ³„éœ², é¦–å…ˆçœ‹çœ‹ 
&lt;code&gt;getLogger&lt;/code&gt; çš„ä»£ç :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;getLogger&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;    Return a logger with the specified name, creating it if necessary.&lt;/span&gt;

&lt;span class="sd"&gt;    If no name is specified, return the root logger.&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;manager&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getLogger&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;root&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸»è¦è°ƒç”¨äº† &lt;code&gt;Logger.manager.getLogger&lt;/code&gt;, è¿™ä¸ªå‡½æ•°æœ‰ä¸‹é¢ä¸€æ®µä»£ç ç‰‡æ®µ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loggerDict&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;rv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loggerDict&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;isinstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rv&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PlaceHolder&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                    &lt;span class="n"&gt;ph&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rv&lt;/span&gt;
                    &lt;span class="n"&gt;rv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loggerClass&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;_loggerClass&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                    &lt;span class="n"&gt;rv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;manager&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;
                    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loggerDict&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rv&lt;/span&gt;
                    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_fixupChildren&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ph&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;rv&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_fixupParents&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rv&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;rv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loggerClass&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;_loggerClass&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="n"&gt;rv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;manager&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loggerDict&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;rv&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_fixupParents&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;rv&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;logging æ¨¡å—ä¸ºäº†ä¿è¯åŒä¸€ä¸ªåç§°å¼•ç”¨åŒä¸€ä¸ªæ—¥å¿—å®ä¾‹,æ‰€ä»¥å°±æŠŠæ‰€æœ‰çš„æ—¥å¿—å®ä¾‹å…¨éƒ¨å­˜
åœ¨äº†ä¸€ä¸ª &lt;code&gt;loggerDict&lt;/code&gt; çš„å­—å…¸é‡Œ, æ‰€ä»¥é™¤éç¨‹åºé€€å‡º, åˆ›å»ºçš„æ—¥å¿—å®ä¾‹å¼•ç”¨æ˜¯ä¸ä¼šé‡Šæ”¾çš„,
æ‰€ä»¥æ—¥å¿—å®ä¾‹é‡Œçš„ &lt;code&gt;handlers&lt;/code&gt; ä¹Ÿä¸ä¼šé‡Šæ”¾. ä¹‹å‰æˆ‘åˆç”¨çš„å¯¹è±¡çš„ id æ¥ä½œä¸ºæ—¥å¿—åç§°
çš„ä¸€éƒ¨åˆ†, æ‰€ä»¥ &lt;code&gt;SyslogHandler&lt;/code&gt; åˆ›å»ºçš„ UDP è¿æ¥å°±ä¸€ç›´è¢«å ç”¨å¯¼è‡´äº†è¿‡å¤šçš„ UDP è¿æ¥. &lt;/p&gt;
&lt;p&gt;ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜æˆ‘åœ¨è¿æ¥å…³é—­çš„æ—¶å€™åŠ å…¥äº†å¦‚ä¸‹ä»£ç :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;logging&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;manager&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loggerDict&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_logger_name&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;manager&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;
&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;logger&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;handlers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æŒ‰è¯´åªåŠ ä¸Šä¸Šé¢ç¬¬ä¸€è¡Œçš„ä»£ç å°±åº”è¯¥é‡Šæ”¾äº†, ä½†æ˜¯æ²¡æœ‰, æ‰€ä»¥åˆæœ‰äº†ç¬¬ä¸‰è¡Œä»£ç , SyslogHandler
æ‰æœ€ç»ˆé‡Šæ”¾, è¿™ä¸ªé—®é¢˜æš‚æ—¶è¿˜ä¸çŸ¥é“ä¸ºä»€ä¹ˆ, è¿˜éœ€è¦å†æŸ¥æŸ¥.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2015-03-30 æ›´æ–°&lt;/strong&gt;
å¦‚æœæ—¥å¿—åç§°æ˜¯ä»¥ &lt;code&gt;.&lt;/code&gt; åˆ†éš”, logging æ¨¡å—åˆ™ä¼šå°†æœ€åä¸€éƒ¨åˆ†ä½œä¸ºæ—¥å¿—å, å¹¶å¾€ä¸Šå»å¯»æ‰¾ &lt;code&gt;çˆ¶ Logger&lt;/code&gt;,
å¦‚æœæ‰¾ä¸åˆ°åˆ™åˆ›å»º &lt;code&gt;PlaceHolder&lt;/code&gt; å¯¹è±¡ä½œä¸ºçˆ¶, å¹¶å¼•ç”¨ &lt;code&gt;Logger&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚åˆ›å»ºçš„ Logger åç§°ä¸º &lt;code&gt;a.b.c&lt;/code&gt;, é‚£ä¹ˆå®é™…çš„åç§°åˆ™ä¸º &lt;code&gt;c&lt;/code&gt;, å¹¶å°† &lt;code&gt;b&lt;/code&gt; ä½œä¸º &lt;code&gt;c&lt;/code&gt; çš„çˆ¶, &lt;code&gt;a&lt;/code&gt; ä½œä¸º &lt;code&gt;b&lt;/code&gt; çš„
çˆ¶, å¦‚æœæ²¡æœ‰è¯¥åç§°çš„ &lt;code&gt;Logger&lt;/code&gt; åˆ™åˆ›å»º &lt;code&gt;PlaceHolder&lt;/code&gt; å¯¹è±¡ä½œä¸ºä»£æ›¿, &lt;code&gt;PlaceHolder&lt;/code&gt; ä¼šåˆ›å»ºå¯¹å½“å‰ &lt;code&gt;Logger&lt;/code&gt;
çš„å¼•ç”¨. æ‰€ä»¥éœ€è¦è¢«å›æ”¶çš„æ—¥å¿—å¯¹è±¡åç§°é‡Œä¸åº”åŒ…å« &lt;code&gt;.&lt;/code&gt;&lt;/p&gt;</content><category term="Python"></category><category term="Python"></category><category term="logging"></category><category term="å†…å­˜æ³„éœ²"></category></entry><entry><title>åŸºäº Python ç”Ÿæˆå™¨çš„ Tornado åç¨‹å¼‚æ­¥</title><link href="https://www.linuxzen.com/ji-yu-python-sheng-cheng-qi-de-tornado-xie-cheng-yi-bu.html" rel="alternate"></link><published>2014-12-19T17:15:00+08:00</published><updated>2014-12-19T17:15:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2014-12-19:/ji-yu-python-sheng-cheng-qi-de-tornado-xie-cheng-yi-bu.html</id><summary type="html">&lt;p&gt;&lt;a href="http://www.tornadoweb.org/en/branch4.0/releases/v4.0.0.html"&gt;Tornado 4.0&lt;/a&gt; å·²ç»å‘å¸ƒäº†å¾ˆé•¿ä¸€æ®µæ—¶é—´äº†,
æ–°ç‰ˆæœ¬å¹¿æ³›çš„åº”ç”¨äº†åç¨‹(&lt;code&gt;Future&lt;/code&gt;)ç‰¹æ€§.  æˆ‘ä»¬ç›®å‰å·²ç»å°† Tornado å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬, è€Œä¸”ä¹Ÿå¤§é‡çš„ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a href="http://www.tornadoweb.org/en/branch4.0/releases/v4.0.0.html"&gt;Tornado 4.0&lt;/a&gt; å·²ç»å‘å¸ƒäº†å¾ˆé•¿ä¸€æ®µæ—¶é—´äº†,
æ–°ç‰ˆæœ¬å¹¿æ³›çš„åº”ç”¨äº†åç¨‹(&lt;code&gt;Future&lt;/code&gt;)ç‰¹æ€§.  æˆ‘ä»¬ç›®å‰å·²ç»å°† Tornado å‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬, è€Œä¸”ä¹Ÿå¤§é‡çš„ä½¿ç”¨åç¨‹ç‰¹æ€§. &lt;/p&gt;
&lt;p&gt;å¾ˆé•¿æ—¶é—´æ²¡æœ‰æ›´æ–°åšå®¢, ä»Šå¤©å°±ç®€å•ä»‹ç»ä¸‹ Tornado åç¨‹å®ç°åŸç†, Tornado çš„åç¨‹æ˜¯åŸºäº Python çš„ç”Ÿæˆå™¨å®ç°çš„, 
æ‰€ä»¥é¦–å…ˆæ¥å›é¡¾ä¸‹ç”Ÿæˆå™¨.&lt;/p&gt;
&lt;h2 id="_1"&gt;ç”Ÿæˆå™¨&lt;/h2&gt;
&lt;p&gt;Python çš„ç”Ÿæˆå™¨å¯ä»¥ä¿å­˜æ‰§è¡ŒçŠ¶æ€ å¹¶åœ¨ä¸‹æ¬¡è°ƒç”¨çš„æ—¶å€™æ¢å¤, é€šè¿‡åœ¨å‡½æ•°ä½“å†…ä½¿ç”¨ &lt;code&gt;yield&lt;/code&gt; å…³é”®å­—
æ¥åˆ›å»ºä¸€ä¸ªç”Ÿæˆå™¨, é€šè¿‡å†…ç½®å‡½æ•° &lt;code&gt;next&lt;/code&gt; æˆ–ç”Ÿæˆå™¨çš„ &lt;code&gt;next&lt;/code&gt; æ–¹æ³•æ¥æ¢å¤ç”Ÿæˆå™¨çš„çŠ¶æ€. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="k"&gt;yield&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬è°ƒç”¨ &lt;code&gt;test&lt;/code&gt; å‡½æ•°, æ­¤æ—¶å¹¶ä¸ä¼šè¿”å›ç»“æœ, è€Œæ˜¯ä¼šè¿”å›ä¸€ä¸ªç”Ÿæˆå™¨&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;test&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;generator&lt;/span&gt; &lt;span class="nb"&gt;object&lt;/span&gt; &lt;span class="n"&gt;test&lt;/span&gt; &lt;span class="n"&gt;at&lt;/span&gt; &lt;span class="mh"&gt;0x100b3b320&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬è°ƒç”¨å…¶ &lt;code&gt;next&lt;/code&gt; æ–¹æ³•åˆ™è¿”å› &lt;code&gt;yield&lt;/code&gt; å…³é”®å­—ä¹‹åçš„å†…å®¹.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;test&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœæˆ‘ä»¬æ¥ç€è°ƒç”¨  &lt;code&gt;next&lt;/code&gt; æ–¹æ³•, åé¢åˆæ²¡æœ‰ &lt;code&gt;yield&lt;/code&gt; å…³é”®å­—ç»§ç»­è¿”å›çš„è¯, ä¼šæŠ›å‡ºä¸€ä¸ª
&lt;code&gt;StopIteration&lt;/code&gt; å¼‚å¸¸.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;yield&lt;/code&gt; å…³é”®å­—ä¸ä»…ä»…èƒ½ä»ç”Ÿæˆå™¨å†…éƒ¨è¿”å›çŠ¶æ€, åŒæ—¶ä¹Ÿå¯ä»¥å°†å¤–éƒ¨ä¿¡æ¯ä¼ é€’åˆ°ç”Ÿæˆå™¨å†…éƒ¨,
é€šè¿‡å°† &lt;code&gt;yeild&lt;/code&gt; å…³é”®é‡Œèµ‹å€¼ç»™å˜é‡, å¹¶è°ƒç”¨ç”Ÿæˆå™¨çš„ &lt;code&gt;send&lt;/code&gt; æ–¹æ³•æ¥å°†å¯¹è±¡ä¼ é€’åˆ°ç”Ÿæˆå™¨
å†…éƒ¨. éœ€è¦æ³¨æ„çš„æ˜¯ç”Ÿæˆå™¨çš„å¼€å§‹å¿…é¡»è°ƒç”¨å…¶ &lt;code&gt;next&lt;/code&gt; æ–¹æ³•, åé¢ &lt;code&gt;send&lt;/code&gt; æ–¹æ³•è°ƒç”¨çš„åŒæ—¶
ä¹Ÿä¼šè§¦å‘ &lt;code&gt;next&lt;/code&gt; åŠ¨ä½œ. å¦‚æœæ²¡æœ‰å˜é‡æ¥æ”¶ &lt;code&gt;yield&lt;/code&gt; å…³é”®å­—é‚£ä¹ˆ &lt;code&gt;send&lt;/code&gt; ä¼ é€’çš„å€¼å°†ä¼š
è¢«ä¸¢å¼ƒ.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;yield&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é¦–å…ˆè°ƒç”¨ &lt;code&gt;next&lt;/code&gt; ä¸Šé¢å‡½æ•°è¿”å›çš„ç”Ÿæˆå™¨å°†è¿”å› &lt;code&gt;None&lt;/code&gt;, å¦‚æœè¿™æ—¶å€™ç›´æ¥è°ƒç”¨ &lt;code&gt;next&lt;/code&gt; å°†
ä¼šç»™ç”Ÿæˆå™¨å‘é€ &lt;code&gt;None&lt;/code&gt;, å¦‚æœè°ƒç”¨ &lt;code&gt;send&lt;/code&gt; å‘é€ä¸€ä¸ªå€¼, å°†æ‰“å°è¿™ä¸ªå€¼å¹¶æŠ›å‡º &lt;code&gt;StopIteration&lt;/code&gt;
å¼‚å¸¸.&lt;/p&gt;
&lt;h2 id="_2"&gt;ä¸€ä¸ªç®€å•åœ°åç¨‹&lt;/h2&gt;
&lt;p&gt;ä»¥ä¸Šå°±æ˜¯å®ç°åç¨‹çš„æ‰€æœ‰åŸºç¡€, ä¸ºäº†åŠ æ·±ç†è§£, æˆ‘ä»¬è¿™é‡Œå†™ä¸€ä¸ªå°ä¾‹å­, ä¾‹å­æˆ‘ä»¬åªä½¿ç”¨åç¨‹
å¼€å¯ä¸¤ä¸ªç”šè‡³å¤šä¸ªæ­»å¾ªç¯, ä¸‹é¢å°±æ˜¯ä¸€ä¸ªæå…¶ç®€å•åœ°ä¾‹å­::&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c1"&gt;# -*- coding:utf-8 -*-&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;absolute_import&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;with_statement&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;loop1&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot; å¾ªç¯1è´Ÿè´£æŠ›å‡ºä¸€ä¸ªå‡½æ•°å’Œå¯¹åº”çš„å‚æ•°, å¹¶æ¥æ”¶ç»“æœ&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
    &lt;span class="n"&gt;ret&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;ret&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;yield&lt;/span&gt; &lt;span class="nb"&gt;sum&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ret&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ret&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ret&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Loop1 ret&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ret&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;loop2&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot; å¾ªç¯2 è´Ÿè´£æ¥æ”¶å‡½æ•°å¹¶è®¡ç®—ç»“æœ, ç„¶å yield å‡ºç»“æœ&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;yield&lt;/span&gt;
        &lt;span class="k"&gt;yield&lt;/span&gt; &lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Loop2&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="n"&gt;l1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;loop1&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;l2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;loop2&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;tmp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;l1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;l2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;next&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;ret&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;l2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;tmp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;l1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ret&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šé¢ä¾‹å­é‡Œ loop1 è´Ÿè´£äº§ç”Ÿä»»åŠ¡, loop2 è´Ÿè´£æ‰§è¡Œä»»åŠ¡, ä¸»å¾ªç¯è´Ÿè´£è°ƒåº¦ä»»åŠ¡å¹¶å°†ä»»åŠ¡ç»“æœå‘å›ç»™
ä»»åŠ¡äº§ç”Ÿè€….&lt;/p&gt;
&lt;h2 id="tornado"&gt;Tornado å¦‚ä½•åšçš„&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬é¦–å…ˆçœ‹ä¸€ä¸ªä½¿ç”¨ Tornado åç¨‹å¼‚æ­¥çš„ä¾‹å­&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c1"&gt;# -*- coding:utf-8 -*-&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;absolute_import&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;print_function&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;with_statement&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tornado&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;gen&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tornado&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;web&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tornado&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;httpclient&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;ActionHandler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;web&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RequestHandler&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

    &lt;span class="nd"&gt;@gen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;coroutine&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;yield&lt;/span&gt; &lt;span class="n"&gt;httpclient&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AsyncHTTPClient&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fetch&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://www.linuxzen.com&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="c1"&gt;# ...&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å…¶å®åŸç†åœ¨ä¸Šé¢ç®€å•åœ°ä¾‹å­é‡Œå·²ç»è®²æ¸…æ¥šäº†, æˆ‘ä»¬æ¥ç®€å•åˆ†æä¸€éä¸Šé¢çš„ä¾‹å­, é¦–å…ˆ Tornado å¾—åˆ°
&lt;code&gt;ActionHandler.get&lt;/code&gt; æ–¹æ³•æŠ›å‡º(&lt;code&gt;next&lt;/code&gt;)çš„ä¸€ä¸ªä»»åŠ¡, ç„¶åå¼‚æ­¥çš„å»æ‰§è¡Œä»»åŠ¡, å½“ä»»åŠ¡(ç½‘ç»œè¯·æ±‚)ç»“æŸæˆ–
å¼‚å¸¸æ—¶ Tornado å–å¾—äº‹ä»¶é€šçŸ¥ç„¶åå°†ç»“æœæ”¾å›(&lt;code&gt;send&lt;/code&gt;)åˆ°è¯¥æ–¹æ³•ä¸­è®©è¯¥æ–¹æ³•ç»§ç»­æ‰§è¡Œ.&lt;/p&gt;
&lt;p&gt;ç”±äºæ˜¯å¼‚æ­¥çš„, è°ƒç”¨è¿™ä¸ªæ–¹æ³•å¹¶ä¸ä¼šé˜»å¡å…¶ä»–ä»»åŠ¡æ‰§è¡Œ.&lt;/p&gt;
&lt;p&gt;è¿™æ—¶å€™æˆ‘ä»¬çš„æ–¹æ³•å…¶å®å°±æ˜¯ä¸Šä¸ªä¾‹å­ &lt;code&gt;loop1&lt;/code&gt; å‡½æ•°, è€Œ &lt;code&gt;Tornado&lt;/code&gt; è°ƒåº¦å¹¶æ‰§è¡Œäº†å…¶æŠ›å‡ºçš„ä»»åŠ¡.&lt;/p&gt;
&lt;h2 id="_3"&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;Tornado çš„åç¨‹å¼‚æ­¥å¯ä»¥è®©å¼‚æ­¥çœ‹èµ·æ¥æ˜¯é¡ºåºæ‰§è¡Œçš„, å¯ä»¥ä»ä¸€å¤§ä¸²çš„ &lt;code&gt;callback&lt;/code&gt; ä¸­è§£è„±å‡ºæ¥.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Tornado&lt;/code&gt; çš„åç¨‹å¼‚æ­¥å¹¶ä¸æ˜¯è¿™ä¸‰è¨€ä¸¤è¯­èƒ½è¯´æ¸…æ¥šçš„, å…¶ä¸­æœ‰å¾ˆå¤æ‚çš„å°è£…å’Œä¼ é€’, æœ‰å…´è¶£å¯ä»¥è‡ªå·±
é˜…è¯»æºç .&lt;/p&gt;</content><category term="Python"></category><category term="Python"></category><category term="generator"></category><category term="coroutine"></category><category term="åç¨‹"></category><category term="ç”Ÿæˆå™¨"></category><category term="Tornado"></category></entry><entry><title>Python å…¥é—¨æŒ‡å—</title><link href="https://www.linuxzen.com/python-ru-men-zhi-nan.html" rel="alternate"></link><published>2014-05-23T14:29:00+08:00</published><updated>2014-05-23T14:29:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2014-05-23:/python-ru-men-zhi-nan.html</id><summary type="html">&lt;h1 id="_1"&gt;å¼•å­&lt;/h1&gt;
&lt;p&gt;ç»å¸¸èƒ½åœ¨ Python ç¾¤é‡Œçœ‹åˆ°å¾ˆå¤šæ–°äººåœ¨é—®ä¸€äº›éå¸¸åŸºç¡€çš„é—®é¢˜, åŸºæœ¬æ¯å¤©éƒ½åœ¨é‡å¤çš„é—®è¿™äº›é—®é¢˜,
åœ¨è¿™é‡Œå°±æ€»ç»“ä¸€ä¸‹è¿™äº› â€¦&lt;/p&gt;</summary><content type="html">&lt;h1 id="_1"&gt;å¼•å­&lt;/h1&gt;
&lt;p&gt;ç»å¸¸èƒ½åœ¨ Python ç¾¤é‡Œçœ‹åˆ°å¾ˆå¤šæ–°äººåœ¨é—®ä¸€äº›éå¸¸åŸºç¡€çš„é—®é¢˜, åŸºæœ¬æ¯å¤©éƒ½åœ¨é‡å¤çš„é—®è¿™äº›é—®é¢˜,
åœ¨è¿™é‡Œå°±æ€»ç»“ä¸€ä¸‹è¿™äº›é—®é¢˜.&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå£°æ˜, æœ¬æ–‡ä¸æ‰“ç®—æ•™ä¼šä½  Python, æœ¬æ–‡åŠ›å›¾é™ˆåˆ—ä¸€äº›æ–°æ‰‹å®¹æ˜“é‡åˆ°çš„é—®é¢˜, å¹¶ä¼å›¾æ•™ä¼šä½ 
å¦‚ä½•å­¦ä¹  Python, åœ¨é‡åˆ°é—®é¢˜çš„æ—¶å€™å¦‚ä½•æé—®.&lt;/p&gt;
&lt;h1 id="_2"&gt;å…³äºç‰ˆæœ¬&lt;/h1&gt;
&lt;p&gt;å­¦ä¹  Python çš„ç¬¬ä¸€æ­¥éœ€è¦é€‰æ‹©ç‰ˆæœ¬, Python 3.x å’Œ 2.x çš„æ–­å±‚è¾ƒå¤§, 3.x ä¸å‘åå…¼å®¹ 2.x.
Python ç°åœ¨ä¸»æµåº”è¯¥è¿˜æ˜¯ Python 2.7, Python 2.7 å°†ä¼šæ˜¯ Python 2.x çš„æœ€åä¸€ä¸ªç‰ˆæœ¬, å¹¶ä¸”
ä¼šæ”¯æŒåˆ° 2020 å¹´. ä½†æ˜¯ Python 3 ä¹Ÿåœ¨å¥åº·å‘å±•, ä¼šæ…¢æ…¢å–ä»£ Python 2.7 æˆä¸ºä¸»æµç‰ˆæœ¬.&lt;/p&gt;
&lt;h2 id="_3"&gt;é€‰æ‹©ç‰ˆæœ¬&lt;/h2&gt;
&lt;p&gt;åœ¨ä½ è¦å¼€å§‹å­¦ä¹  Python ä¹‹å‰å°±æ˜¯è¦ç¡®å®šè¦å­¦ä¹ çš„ç‰ˆæœ¬,
ä¸ç®¡ä½ æ˜¯é€‰æ‹© 2 è¿˜æ˜¯ 3, è™½ç„¶æœ‰å·®åˆ«, ä½†ä¸æ˜¯å¾ˆå¤§, ç­‰ä½ ç†Ÿæ‚‰äº†ä¹‹åå°±å¯ä»¥è§¦ç±»æ—é€š.
ä¸å¿…å¤ªå®³æ€•é€‰æ‹©äº†ä¸€ä¸ªç‰ˆæœ¬åˆ°æ—¶å€™æ— æ³•å…¼é¡¾å¦ä¸€ä¸ªç‰ˆæœ¬.&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ æ— æ³•ç¡®å®šè¦å­¦ä¹ çš„ç‰ˆæœ¬,å¯ä»¥æ ¹æ®ä»¥ä¸‹æ–¹æ³•æ¥ç¡®å®šè¦å­¦ä¹ çš„ç‰ˆæœ¬.&lt;/p&gt;
&lt;h3 id="_4"&gt;æ‰‹ä¸Šå·²æœ‰çš„æ•™ç¨‹&lt;/h3&gt;
&lt;p&gt;å¦‚æœä½ æ‰‹ä¸Šå·²ç»æœ‰äº†ä¸€æœ¬å…³äº Python åŸºç¡€çš„ä¹¦, é‚£ä¹ˆä¹¦çš„å¼€å¤´åº”è¯¥ä¼šäº¤ä»£ Python ç‰ˆæœ¬.
é‚£å°±æ ¹æ®è¿™ä¸ªæ•™ç¨‹é€‰æ‹©è¦å­¦ä¹ çš„ç‰ˆæœ¬.&lt;/p&gt;
&lt;h3 id="_5"&gt;è¦ä¸Šæ‰‹çš„é¡¹ç›®&lt;/h3&gt;
&lt;p&gt;å¦‚æœä½ å·²ç»æœ‰ä¸€ä¸ª Python é¡¹ç›®ç­‰ç€ä½ å»ä¸Šæ‰‹, é‚£ä¹ˆå…ˆäº†è§£é¡¹ç›®éœ€è¦ä»€ä¹ˆç‰ˆæœ¬. ç„¶åæ ¹æ®
éœ€è¦çš„ç‰ˆæœ¬æ‰¾æ”¯æŒå¯¹åº”ç‰ˆæœ¬çš„åŸºç¡€ä¹¦ç±.&lt;/p&gt;
&lt;h3 id="python-3"&gt;ç›´æ¥é€‰æ‹© Python 3&lt;/h3&gt;
&lt;p&gt;å¦‚æœä½ æ²¡æœ‰ä»¥ä¸Šçš„è´Ÿæ‹…, é‚£ä¹ˆæ¨èä½ ç›´æ¥å­¦ä¹  Python 3, ä½†æ˜¯ä½ è¦æ‰¾åˆ°ä¸€æœ¬æ”¯æŒ Python 3
çš„å…¥é—¨ä¹¦ç±, ä¸ç„¶ä½ å‰æœŸä½ ä¼šå‘ç°æ‰€æœ‰çš„éƒ½æ˜¯é”™çš„, ä¼šç›´æ¥æ‰“æ¶ˆä½ çš„è‡ªä¿¡å¿ƒ.&lt;/p&gt;
&lt;p&gt;Python 3 çš„åº•å±‚å…¨éƒ¨ç”¨ unicode å®ç°, æ‰€ä»¥ä¸ä¼šé‡åˆ° Python2 çƒ¦äººçš„ &lt;code&gt;UnicodeDecodeError&lt;/code&gt;
ç±»ä¼¼çš„å¼‚å¸¸, å…³äºè¿™ä¸ªåé¢ä¼šè®²åˆ°.&lt;/p&gt;
&lt;h2 id="_6"&gt;ç‰ˆæœ¬å·®å¼‚&lt;/h2&gt;
&lt;p&gt;Python å®˜ç½‘å·²ç»æœ‰è¯¦ç»†çš„ç‰ˆæœ¬å·®å¼‚(&lt;a href="https://docs.python.org/3/whatsnew/3.0.html"&gt;è¿™é‡Œ&lt;/a&gt;)&lt;/p&gt;
&lt;p&gt;è¿™é‡Œç®€å•åˆ—å‡ºå‡ ä¸ªä¸»è¦å·®å¼‚&lt;/p&gt;
&lt;h3 id="print"&gt;print çš„æ”¹å˜&lt;/h3&gt;
&lt;p&gt;åœ¨ Python2 é‡Œ print æ˜¯ä¸€ä¸ªè¯­å¥, ç”¨ä»¥ä¸‹æ–¹å¼è¾“å‡º&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Hello world!&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åœ¨ Python 3 é‡Œ print å˜æˆäº†ä¸€ä¸ª å‡½æ•°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Hello world&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_7"&gt;è¾“å…¥å‡½æ•°çš„æ”¹å˜&lt;/h3&gt;
&lt;p&gt;åœ¨ Python 2 é‡Œç”¨ &lt;code&gt;raw_input&lt;/code&gt; å‡½æ•°è·å–è¾“å…¥&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Enter your name: &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åœ¨ Python 3 é‡Œç”¨ &lt;code&gt;input&lt;/code&gt; å‡½æ•°ä»£æ›¿ &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Enter your name: &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å½“ç„¶è¿˜æœ‰å¾ˆå¤š, è¿™é‡Œä¸ä¸€ä¸€åˆ—ä¸¾, å¦‚æœä½ ä»¥åå¯¹ Python æœ‰äº†ä¸€å®šäº†è§£, å¯ä»¥çœ‹çœ‹
&lt;a href="https://www.ibm.com/developerworks/cn/linux/l-python3-1/"&gt;è¿™ç¯‡&lt;/a&gt;æ–‡ç« &lt;/p&gt;
&lt;h2 id="_8"&gt;å¤šç‰ˆæœ¬å…±å­˜&lt;/h2&gt;
&lt;p&gt;Python æ˜¯å¯ä»¥å¤šä¸ªç‰ˆæœ¬å…±å­˜çš„, å¦‚æœå¯ä»¥ä½ å¯ä»¥åŒæ—¶å®‰è£… Python 2 å’Œ 3, è‡ªå·±
åŠ¨æ‰‹äº²è‡ªæ¯”è¾ƒä¸€ä¸‹.&lt;/p&gt;
&lt;h2 id="_9"&gt;ä»£ç å…¼å®¹&lt;/h2&gt;
&lt;p&gt;Python 2 å’Œ 3 æ˜¯å¯ä»¥é€šè¿‡ä¸€äº›æŠ€å·§æ¥å®ç°å…¼å®¹çš„, è¿™ç‚¹è¶…å‡ºäº†æœ¬æ–‡è®¨è®ºçš„èŒƒç•´, 
å¦‚æƒ³äº†è§£å¯ä»¥ä¸Šç½‘æœç´¢.&lt;/p&gt;
&lt;h1 id="python-shell"&gt;å…³äº Python Shell&lt;/h1&gt;
&lt;p&gt;Python Shell å°±æ˜¯ä½ åœ¨å‘½ä»¤è¡Œä¸‹è¿è¡Œ &lt;code&gt;python&lt;/code&gt; æŒ‡ä»¤åå‡ºæ¥çš„ä¸€ä¸ªäº¤äº’å¼ shell,
æˆ–è€…è¿è¡Œ Windows ä¸‹çš„ &lt;code&gt;IDLE&lt;/code&gt; å‡ºæ¥çš„çª—å£å«åš Python Shell, Python Shell 
æä¾›ä¸€ç§ "æ‰€è§å³æ‰€å¾—" çš„æ–¹å¼æ¥è¿è¡Œ Python è¯­å¥, è¿™å°†æ˜¯ä½ å­¦ä¹  Python
çš„ä¸€ç§é‡è¦å·¥å…·.&lt;/p&gt;
&lt;h2 id="python-shell_1"&gt;åŒºåˆ† Python Shell å’Œ å‘½ä»¤&lt;/h2&gt;
&lt;p&gt;ä½†æ˜¯æˆ‘è§åˆ°å¾ˆå¤šäººé—®åƒä¸‹é¢é‚£æ ·è¿è¡Œè„šæœ¬ä¸ºä»€ä¹ˆä¼šå‡ºé”™&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;python&lt;/span&gt; &lt;span class="n"&gt;script&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ ·æ˜¯é”™è¯¯çš„, Python Shell æ˜¯è¿è¡Œ Python è¯­å¥çš„, è€Œ &lt;code&gt;python script.py&lt;/code&gt; æ˜¯
ä¸€æ¡å‘½ä»¤, æ„ä¸ºè¿è¡Œ &lt;code&gt;script.py&lt;/code&gt; è¿™ä¸ªæ–‡ä»¶é‡Œçš„ Python è¯­å¥.&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çœŸæ­£è¦åšçš„æ˜¯åœ¨å‘½ä»¤è¡Œä¸‹æ‰§è¡Œè¿™ä¸ªå‘½ä»¤, æ‰€è°“å‘½ä»¤è¡Œå°±æ˜¯ Windows ä¸‹
Win+R è¾“å…¥ cmd å›è½¦å¼¹å‡ºçš„çª—å£.&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ åœ¨å‘½ä»¤è¡Œä¸‹è¿è¡Œå¤±è´¥è¯·ä¸Šç½‘æœç´¢äº†è§£å…³äº &lt;code&gt;PATH&lt;/code&gt; çš„ç›¸å…³çŸ¥è¯†.&lt;/p&gt;
&lt;h1 id="python-2"&gt;å…³äº Python 2&lt;/h1&gt;
&lt;p&gt;å¦‚æœä½ é€‰æ‹©äº† Python 2, é‚£ä¹ˆå°±æœ‰éœ€è¦é¢å¯¹ä¸€äº›é—®é¢˜.&lt;/p&gt;
&lt;h2 id="_10"&gt;ä¸­æ–‡å­—ç¬¦&lt;/h2&gt;
&lt;p&gt;å¦‚æœä½ çš„ Python æºç æ–‡ä»¶é‡Œå‡ºç°äº†ä¸­æ–‡å­—ç¬¦, ä½ å°±ä¼šå‘ç°æ— æ³•è¿è¡Œå‡ºç°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;SyntaxError&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Non&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;ASCII&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;character&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;\xe5&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;xx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;py&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;on&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;but&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;no&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;encoding&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;declared&lt;/span&gt;&lt;span class="o"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;see&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="n"&gt;www&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;python&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;org&lt;/span&gt;&lt;span class="sr"&gt;/peps/&lt;/span&gt;&lt;span class="n"&gt;pep&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;0263&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;html&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;details&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä½ åªéœ€è¦åœ¨æ–‡ä»¶çš„æœ€ä¸Šé¢åŠ ä¸Šä¸€è¡Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;#-*- coding: utf-8 -*-&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å³å¯&lt;/p&gt;
&lt;h2 id="unicodedecodeerror"&gt;UnicodeDecodeError å¼‚å¸¸&lt;/h2&gt;
&lt;p&gt;å¦‚æœä½ ä¸å¹¸é‡åˆ°äº†è¿™ä¸ªé”™è¯¯, é‚£ä¹ˆä¸€èˆ¬æ˜¯å› ä¸ºå­—ç¬¦ä¸²è¿æ¥å¼•èµ·çš„, æ¯”å¦‚ä¸‹é¢è¿™æ ·çš„ä»£ç &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ä¸­å›½&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœä½ å­¦è¿‡äº†åŸºç¡€ä½ å°±ä¼šçŸ¥é“ &lt;code&gt;u''&lt;/code&gt; åŒ…å›´çš„å­—ç¬¦ä¸²æ˜¯ &lt;code&gt;unicode&lt;/code&gt;, Python 2 é‡Œæœ‰ä¸¤ç§ç±»å‹çš„
å­—ç¬¦ä¸² &lt;code&gt;str&lt;/code&gt; å’Œ &lt;code&gt;unicode&lt;/code&gt;, ä¸Šé¢çš„ &lt;code&gt;'ä¸­å›½'&lt;/code&gt; å°±æ˜¯ &lt;code&gt;str&lt;/code&gt; ç±»å‹, &lt;code&gt;u'a'&lt;/code&gt; å°±æ˜¯ &lt;code&gt;unicode&lt;/code&gt;
ç±»å‹.&lt;/p&gt;
&lt;p&gt;å¦‚æœè¿™ä¸¤ç§ç±»å‹çš„å­—ç¬¦ä¸²ç›¸è¿, &lt;code&gt;str&lt;/code&gt; ç±»å‹çš„å­—ç¬¦ä¸²ä¼šå‘ &lt;code&gt;unicode&lt;/code&gt; åšéšå¼è½¬åŒ–, è€Œéšå¼è½¬æ¢
é»˜è®¤çš„ç¼–ç æ˜¯ &lt;code&gt;ascii&lt;/code&gt;, æ˜æ˜¾ &lt;code&gt;ascii&lt;/code&gt; ç¼–ç ä¸å¯èƒ½åŒ…å«ä»»ä½•æ±‰å­—, æ‰€ä»¥å°±ä¼šæŠ›å‡ºè¿™ä¸ªå¼‚å¸¸.&lt;/p&gt;
&lt;p&gt;å¦‚æœä¸Šé¢åè¿‡æ¥å°±ä¸ä¼šæŠ›å‡ºå¼‚å¸¸, å› ä¸º &lt;code&gt;ascii&lt;/code&gt; é‡ŒåŒ…å« &lt;code&gt;a&lt;/code&gt; è¿™ä¸ªå­—ç¬¦&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ä¸­å›½&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åœ¨æ–‡ä»¶ä¸­ä½¿ç”¨ç»Ÿä¸€çš„ç±»å‹çš„å­—ç¬¦ä¸²å¯ä»¥è§„é¿è¿™ä¸ªé—®é¢˜, è¦ä¹ˆéƒ½ä½¿ç”¨ &lt;code&gt;u''&lt;/code&gt; åŒ…å›´çš„å­—ç¬¦ä¸², 
è¦ä¹ˆéƒ½ä½¿ç”¨ &lt;code&gt;''&lt;/code&gt; åŒ…å›´çš„å­—ç¬¦ä¸²&lt;/p&gt;
&lt;p&gt;å½“ç„¶ä¸Šé¢å•å¼•å·æ˜¯å¯ä»¥æ¢æˆåŒå¼•å·çš„.&lt;/p&gt;
&lt;h1 id="traceback"&gt;å…³äº Traceback&lt;/h1&gt;
&lt;p&gt;Python åœ¨ç¨‹åºå‡ºé”™çš„æ—¶å€™ä¼šå‘ç»ˆç«¯æ‰“å°ä¸€ä¸²ç•¥é•¿çš„ä¿¡æ¯å«åš &lt;code&gt;Traceback&lt;/code&gt;, åƒä¸‹é¢è¿™æ ·:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;Traceback&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;most&lt;/span&gt; &lt;span class="n"&gt;recent&lt;/span&gt; &lt;span class="n"&gt;call&lt;/span&gt; &lt;span class="n"&gt;last&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
  &lt;span class="n"&gt;File&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;test.py&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="n"&gt;module&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
  &lt;span class="n"&gt;File&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;test.py&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;main&lt;/span&gt;
    &lt;span class="n"&gt;test&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
  &lt;span class="n"&gt;File&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;test.py&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;test&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39;ä¸­å›½&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;
&lt;span class="ne"&gt;UnicodeDecodeError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ascii&amp;#39;&lt;/span&gt; &lt;span class="n"&gt;codec&lt;/span&gt; &lt;span class="n"&gt;can&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;t decode byte 0xe4 in position 0: ordinal not in range(128)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™ä¸€æ®µä¿¡æ¯å¾ˆè¯¦ç»†çš„æè¿°äº†å‡ºé”™çš„åœ°æ–¹å’Œè¯¦ç»†çš„è°ƒç”¨ä¿¡æ¯, å½“ç„¶è¿˜æœ‰é”™è¯¯æè¿°.&lt;/p&gt;
&lt;p&gt;çœ‹æ‡‚ Traceback å°†ä¼šæœ‰åŠ©äºä½ æ›´å¥½çš„å­¦ä¹  Python. è¿™æ®µ Traceback è¯´æ˜&lt;/p&gt;
&lt;p&gt;åœ¨ test.py çš„ç¬¬ 16 è¡Œ main å‡½æ•°é‡Œ, è°ƒç”¨äº†åœ¨ 14 è¡Œçš„ test å‡½æ•°, 
test å‡½æ•°é‡Œæ–‡ä»¶çš„ç¬¬ 10 è¡Œçš„è¯­å¥è§¦å‘äº† UnicodeDecodeError å¼‚å¸¸.&lt;/p&gt;
&lt;p&gt;ç®€ç›´å¤ªæ¸…æ™°äº†, å¦‚æœä½ è§‰å¾—ä¸æ¸…æ™°çš„è¯å°±æ€ªæˆ‘æè¿°çš„ä¸å¥½å§.&lt;/p&gt;
&lt;h1 id="_11"&gt;å…³äºç¬¬ä¸‰æ–¹åº“&lt;/h1&gt;
&lt;p&gt;Python æœ‰å¤§é‡çš„ç¬¬ä¸‰æ–¹åº“, å¹¶ä¸”æœ‰ &lt;code&gt;setuptools&lt;/code&gt; å·¥å…·å¯ä»¥å®‰è£…è¿™äº›åº“, setuptools
æä¾›äº† &lt;code&gt;easy_install&lt;/code&gt; å‘½ä»¤å¯ä»¥ä»ç½‘ä¸Šè‡ªåŠ¨ä¸‹è½½å¹¶å®‰è£…ç¬¬ä¸‰æ–¹åº“, å¯ä»¥å‚è§
&lt;a href="https://pypi.python.org/pypi/setuptools#installation-instructions"&gt;è¿™é‡Œ&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="_12"&gt;å…³äºæé—®&lt;/h1&gt;
&lt;p&gt;å¦‚æœä½ é‡åˆ°äº†é—®é¢˜, è§£å†³ä¸äº†éœ€è¦æé—®çš„æ—¶å€™, è¯·å°½é‡çš„æä¾›ä½ çš„ä»£ç å’Œè¯¦ç»†çš„ Traceback.
ä»£ç ç›´æ¥å‘å‡ºæ¥ä¸æ˜¯å¾ˆå¥½çš„æ–¹å¼, è¯·å°½é‡è´´åˆ°æ”¯æŒä»£ç é«˜äº®çš„ç½‘ç«™ä¸Š, å¹¶ä¿æŒç¼©è¿›.&lt;/p&gt;
&lt;p&gt;æ¨èçš„ä¸‹é¢ä¸¤ä¸ªè´´ä»£ç çš„ç½‘ç«™:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://pastebin.com"&gt;http://pastebin.com&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://paste.ubuntu.org.cn"&gt;http://paste.ubuntu.org.cn&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="_13"&gt;å…³äºå·¥å…·&lt;/h1&gt;
&lt;h2 id="_14"&gt;ç¼–è¾‘å™¨&lt;/h2&gt;
&lt;p&gt;å¦‚æœåœ¨å­¦ä¹ åˆæœŸå¹¶ä¸æ¨è IDE ä½œä¸ºå¼€å‘å·¥å…·, ä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨å¯èƒ½æœ‰åŠ©äºä½ çš„å­¦ä¹ ,
æŒ‰ç…§å›°éš¾ç¨‹åº¦ç”±ä½åˆ°é«˜æ¨èä¸‹é¢å‡ ç§æ–‡æœ¬ç¼–è¾‘å™¨:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://code.google.com/p/ulipad/"&gt;ulipad&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://notepad-plus-plus.org/"&gt;notepad++&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://www.sublimetext.com/"&gt;Sublime Text&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="http://vim.org"&gt;Vim&lt;/a&gt; / &lt;a href="http://www.gnu.org/software/emacs/"&gt;Emacs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœä½ æƒ³è¦ä¸€æ¬¾åŠŸèƒ½å¼ºå¤§çš„ IDE é‚£ä¹ˆæ¨èä½  &lt;a href="http://www.jetbrains.com/pycharm/"&gt;PyCharm&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="_15"&gt;å…¶ä»–å·¥å…·&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://ipython.org"&gt;IPython&lt;/a&gt; ä¸€ä¸ª Python Shell å¢å¼ºå·¥å…·&lt;/li&gt;
&lt;li&gt;&lt;a href="http://virtualenv.readthedocs.org/en/latest/"&gt;virtualenv&lt;/a&gt; å¯ä»¥ç”¨å®ƒè·å–ä¸€ä¸ªå¹²å‡€çš„ Python å¼€å‘ç¯å¢ƒ&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id="_16"&gt;å…³äºä¹¦ç±&lt;/h1&gt;
&lt;p&gt;Python åŸºç¡€ä¹¦ç±æœ‰å¾ˆå¤š: ã€Šç®€æ˜ Python æ•™ç¨‹ã€‹ï¼Œ ã€ŠPython æ ¸å¿ƒç¼–ç¨‹ã€‹ã€ŠPython å­¦ä¹ æ‰‹å†Œã€‹ã€ŠPythonå‚è€ƒæ‰‹å†Œã€‹
ç­‰éƒ½æ˜¯å¾ˆä¸é”™çš„å…¥é—¨ä¹¦ç±.&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ å·²ç»æŒæ¡äº† Python åŸºç¡€, æƒ³ç»§ç»­é˜…è¯»æ·±å…¥ Python, è¿™é‡Œæ¨èä¸¤æœ¬ Python è¿›é˜¶ä¹¦ç±:
ã€ŠPython é«˜çº§ç¼–ç¨‹ã€‹ã€ŠPython æ ‡å‡†åº“ã€‹&lt;/p&gt;
&lt;h1 id="_17"&gt;å…³äºä»£ç è§„èŒƒ&lt;/h1&gt;
&lt;p&gt;è‰¯å¥½çš„ä»£ç è§„èŒƒå¯ä»¥è®©ä½ çš„ç¨‹åºæ›´åŠ çš„ç®€æ´ã€ç¾è§‚å’Œæ˜“è¯». Python æœ‰è‡ªå·±çš„ä»£ç 
è§„èŒƒ, å¯ä»¥å‚è§ &lt;a href="http://legacy.python.org/dev/peps/pep-0008/"&gt;PEP8&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="_18"&gt;å†™åœ¨åé¢çš„è¯&lt;/h1&gt;
&lt;p&gt;é›¶é›¶æ•£æ•£çš„ä»‹ç»äº†ä¸€äº›, åœ¨æ­¤æŠ›ç –å¼•ç‰æ¬¢è¿å¤§å®¶è¡¥å……. ç¼–å†™ Python æ˜¯å¿«ä¹çš„, 
å¸Œæœ›æœ¬æ–‡å¯ä»¥å¯¹å¼€å§‹å­¦ Python çš„æœ‹å‹æœ‰ç‚¹å¸®åŠ©, ç¥ä½ ä»¬å­¦ä¹ æ„‰å¿«.&lt;/p&gt;</content><category term="Python"></category><category term="Python"></category><category term="å…¥é—¨"></category><category term="æŒ‡å—"></category><category term="æ–°æ‰‹"></category><category term="é”™è¯¯"></category><category term="ä¹¦ç±"></category><category term="å·¥å…·"></category></entry><entry><title>PyQt ä¸­ç”¨ QtNetwork å¼‚æ­¥å‘èµ·HTTPè¯·æ±‚</title><link href="https://www.linuxzen.com/pyqt-zhong-yong-qtnetwork-yi-bu-fa-qi-httpqing-qiu.html" rel="alternate"></link><published>2014-05-07T15:52:00+08:00</published><updated>2014-05-07T15:52:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2014-05-07:/pyqt-zhong-yong-qtnetwork-yi-bu-fa-qi-httpqing-qiu.html</id><summary type="html">&lt;h2 id="_1"&gt;å¼•å­&lt;/h2&gt;
&lt;p&gt;æœ€è¿‘æœ‰éœ€æ±‚è¦åœ¨ PyQt ä¸­è¯·æ±‚ä¸€ä¸ªé“¾æ¥, å› ä¸ºæ¯”è¾ƒç®€å•ç›´æ¥ç”¨ urllib2 å¤„ç†äº†, ä½†æ˜¯ urllib2 åœ¨
æœ‰å»¶æ—¶çš„æ—¶å€™ä¼šé€ æˆ GUI ç•Œé¢å¡æ­». æ‰€ä»¥ â€¦&lt;/p&gt;</summary><content type="html">&lt;h2 id="_1"&gt;å¼•å­&lt;/h2&gt;
&lt;p&gt;æœ€è¿‘æœ‰éœ€æ±‚è¦åœ¨ PyQt ä¸­è¯·æ±‚ä¸€ä¸ªé“¾æ¥, å› ä¸ºæ¯”è¾ƒç®€å•ç›´æ¥ç”¨ urllib2 å¤„ç†äº†, ä½†æ˜¯ urllib2 åœ¨
æœ‰å»¶æ—¶çš„æ—¶å€™ä¼šé€ æˆ GUI ç•Œé¢å¡æ­». æ‰€ä»¥ä»Šå¤©ç ”ç©¶ç ”ç©¶ QtNetwork æ¨¡å—.&lt;/p&gt;
&lt;p&gt;QtNetwork ä¸­çš„è¯·æ±‚åœ¨ PyQt ä¸­éƒ½æ˜¯å¼‚æ­¥çš„.&lt;/p&gt;
&lt;h2 id="qhttp"&gt;ç®€å•çš„è¯·æ±‚ QHttp&lt;/h2&gt;
&lt;h3 id="get"&gt;å‘èµ·ä¸€ä¸ªGETè¯·æ±‚&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;PyQt4.QtNetwork.QHttp&lt;/code&gt; å¯ä»¥å‘èµ·ä¸€ä¸ªç®€å•è¯·æ±‚, éœ€è¦æ³¨æ„çš„æ˜¯è¿™ä¸ªå¯¹è±¡éœ€è¦é€šè¿‡è°ƒç”¨
&lt;code&gt;setHost&lt;/code&gt; è®¾ç½®è¯·æ±‚ä¸»æœº, ç„¶å è°ƒç”¨ &lt;code&gt;get&lt;/code&gt;/&lt;code&gt;post&lt;/code&gt; ä¼ å…¥ &lt;code&gt;path&lt;/code&gt; æ‰èƒ½æ­£å¸¸ä½¿ç”¨.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c1"&gt;# -*- coding:utf-8 -*-&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtNetwork&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MainWidget&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QWidget&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MainWidget&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtNetwork&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QHttp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="c1"&gt;# ç»‘å®š done ä¿¡å·&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;done&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;on_req_done&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QUrl&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://linuxzen.com/&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="c1"&gt;# è®¾ç½®ä¸»æœº&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setHost&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getId&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;on_req_done&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Success&amp;quot;&lt;/span&gt;
            &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readAll&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Error&amp;quot;&lt;/span&gt;


&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QApplication&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
    &lt;span class="n"&gt;main&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MainWidget&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exec_&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_2"&gt;ä¿å­˜æ–‡ä»¶&lt;/h3&gt;
&lt;p&gt;å¦‚æœæƒ³è¦ä¸‹è½½æ–‡ä»¶, å¯ä»¥ç»™ &lt;code&gt;get&lt;/code&gt; æ–¹æ³•ä¼ ä¸€ä¸ª &lt;code&gt;QtCore.QFile&lt;/code&gt; å¯¹è±¡, ä¼šå°†è¯·æ±‚å†…å®¹ä¿å­˜
åˆ°æ–‡ä»¶&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c1"&gt;# -*- coding:utf-8 -*-&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtNetwork&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MainWidget&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QWidget&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MainWidget&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtNetwork&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QHttp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;done&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;on_req_done&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QUrl&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://www.linuxzen.com/&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setHost&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QFile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;./test&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getId&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;on_req_done&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="c1"&gt;# print self.http.readAll(), error&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Success&amp;quot;&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Error&amp;quot;&lt;/span&gt;


&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QApplication&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
    &lt;span class="n"&gt;main&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MainWidget&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exec_&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šé¢ä»£ç å°†è¯·æ±‚ä¸‹æ¥çš„å†…å®¹ä¿å­˜åˆ°å½“å‰ç›®å½•çš„ test æ–‡ä»¶é‡Œ.&lt;/p&gt;
&lt;h3 id="_3"&gt;å¤„ç†å¤´éƒ¨ä¿¡æ¯&lt;/h3&gt;
&lt;p&gt;ç°åœ¨æœ‰ä¸€ä¸ªéœ€æ±‚å°±æ˜¯æœ‰ä¸€ä¸ªé“¾æ¥ä¼šè¿”å›ä¸€ä¸ª 301 æˆ– 302 çš„è·³è½¬, ä½†æ˜¯ &lt;code&gt;PyQt4.QtNetwork.QHttp&lt;/code&gt; æ²¡æœ‰å®ç°è‡ªåŠ¨è·³è½¬, éœ€è¦æˆ‘ä»¬è‡ªåŠ¨åˆ¤æ–­å¤´ä¿¡æ¯è¿›è¡Œè·³è½¬.&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å¯ä»¥ç»‘å®š&lt;code&gt;PyQt4.QtNetwork.QHttp.responseHeaderReceived&lt;/code&gt;çš„ä¿¡å·æ¥å¤„ç†å¤´éƒ¨ä¿¡æ¯,
è¿™ä¸ªä¿¡å·å°†ç»™æ§½ä¼ é€’ä¸€ä¸ª &lt;code&gt;PyQt4.QtNetwork.QHttpResponseHeader&lt;/code&gt; çš„å®ä¾‹.&lt;/p&gt;
&lt;p&gt;é€šè¿‡åˆ¤æ–­çŠ¶æ€å—, å¹¶æŠ“å– &lt;code&gt;Location&lt;/code&gt; å¤´å®ç°è·³è½¬&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c1"&gt;# -*- coding:utf-8 -*-&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtNetwork&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MainWidget&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QWidget&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MainWidget&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtNetwork&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QHttp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;done&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;on_req_done&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;responseHeaderReceived&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;on_response_header&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QUrl&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://t.cn/zTocACq&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setHost&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;out&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QFile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;./test&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getId&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;on_response_header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;response_header&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;response_header&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;statusCode&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;301&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;302&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
            &lt;span class="n"&gt;location&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;response_header&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Location&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Redirect to: &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;location&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getId&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;location&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;tmp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QUrl&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;location&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="p"&gt;()):&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tmp&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setHost&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setPath&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;location&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;/&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;out&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;on_req_done&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;error&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Success&amp;quot;&lt;/span&gt;
            &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readAll&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Error&amp;quot;&lt;/span&gt;


&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QApplication&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
    &lt;span class="n"&gt;main&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MainWidget&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exec_&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿è¡Œä¸Šé¢ä»£ç , ä½ å°†çœ‹åˆ°ä¸‹é¢è¾“å‡º&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Redirect to: http://www.linuxzen.com
Success
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_4"&gt;å¤„ç†å‚æ•°&lt;/h3&gt;
&lt;p&gt;å¦‚æœä½ çš„ GET è¯·æ±‚çš„ url æ˜¯å¸¦ç€å‚æ•°ä¼ ç»™ &lt;code&gt;QUrl&lt;/code&gt; çš„, é‚£ä¹ˆ &lt;code&gt;QUrl.path()&lt;/code&gt; å°†ä¸ä¼šè¿”å›å¸¦å‚æ•°çš„
è·¯å¾„éœ€è¦è‡ªå·±å¤„ç†. å¯ä»¥å‚è§ä¸‹é¢çš„å¤„ç†å‡½æ•°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_query_string&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;queryPairDelimiter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
            &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{0}{1}{2}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;queryValueDelimiter&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;queryItems&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¯·æ±‚çš„æ—¶å€™åŠ ä¸Šå°±è¡Œäº†&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;?&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_query_string&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="cookie-qnetworkaccessmanager"&gt;å¤„ç† Cookie ---- QNetworkAccessManager&lt;/h2&gt;
&lt;p&gt;QHttp æ˜¯æ— æ³•è‡ªåŠ¨è®°å½• Cookie å’Œè®¾ç½® Cookieçš„, å¦‚æœæœ‰è¿™ä¸ªéœ€æ±‚å°±éœ€è¦ &lt;code&gt;PyQt4.QtNetwork.QNetworkAccessManager&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;QNetworkAccessManager&lt;/code&gt; çš„è¯·æ±‚æ–¹æ³•ä¸åœ¨æ˜¯ä¼ å…¥ä¸€ä¸ª QString, è€Œæ˜¯éœ€è¦ä¼ å…¥ä¸€ä¸ª 
&lt;code&gt;PyQt4.QtNetwork.QNetworkRequest&lt;/code&gt; çš„å®ä¾‹.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;QNetworkAccessManager&lt;/code&gt; åŒæ ·æ˜¯å¼‚æ­¥çš„, å¯ä»¥ç»‘å®š &lt;code&gt;QNetworkAccessManager.finished&lt;/code&gt; ä¿¡å·, 
è¿™ä¸ªä¿¡å·å°†ä¼šç»™æ§½ä¼ é€’ä¸€ä¸ª &lt;code&gt;PyQt4.QtNetwork.QNetworkReply&lt;/code&gt; çš„å®ä¾‹.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;QNetworkAccessManager.setCookieJar&lt;/code&gt; å¯ä»¥è®¾ç½®ä¸€ä¸ª &lt;code&gt;PyQt4.QtNetwork.QNetworkCookieJar&lt;/code&gt; å¯¹è±¡æ¥
è‡ªåŠ¨ä¿å­˜å’Œè®¾ç½® Cookie.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c1"&gt;# -*- coding:utf-8 -*-&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtNetwork&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MainWidget&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QWidget&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MainWidget&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_cookiejar&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtNetwork&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QNetworkCookieJar&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;manager&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtNetwork&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QNetworkAccessManager&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parent&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;manager&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setCookieJar&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_cookiejar&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;manager&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;finished&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;on_reply&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;req&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtNetwork&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QNetworkRequest&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
            &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QUrl&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://www.google.com.hk&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;manager&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;req&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;on_reply&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reply&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;reply&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_cookiejar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;allCookies&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;reply&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rawHeaderList&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="c1"&gt;# print reply.readAll()&lt;/span&gt;


&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QApplication&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
    &lt;span class="n"&gt;widget&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MainWidget&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;widget&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exec_&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ ·å°±å¯ä»¥æºå¸¦ Cookie å»è¯·æ±‚ä¸€äº›éœ€è¦ Cookie è®¤è¯çš„è¯·æ±‚.&lt;/p&gt;
&lt;h2 id="_5"&gt;æ€»ç»“&lt;/h2&gt;
&lt;p&gt;è¿˜æœ‰å¾ˆå¤šå†…å®¹å°±ä¸ä¸€ä¸€ä»‹ç», æ¯”å¦‚é…åˆ &lt;code&gt;QProgressBar&lt;/code&gt;, æ·»åŠ å¤´éƒ¨ä¿¡æ¯, POST è¯·æ±‚, ç­‰.&lt;/p&gt;
&lt;p&gt;è¿™é‡Œåªæ˜¯ç®€å•ä»‹ç»ä¸‹ Qt è‡ªå·±çš„ç½‘ç»œè¯·æ±‚å¤„ç†æ–¹æ³•. åœ¨ PyQt é‡Œç”¨ urllib ç­‰åº“æ˜æ˜¾ä¸æ˜¯å¥½çš„
è§£å†³åŠæ³•, å› ä¸ºä¼šé€ æˆç•Œé¢å¡æ­». ä½†æ˜¯ PyQt4 çš„æ–¹å¼ä¹Ÿå®åœ¨ä¸æ˜¯å¾ˆä¼˜é›…. è¦æ¥æ¥å›å›çš„è°ƒå¾ˆå¤š
ä¸œè¥¿. ä½†æ˜¯æœ€èµ·ç ä¸ä¼šé€ æˆç•Œé¢çš„å¡æ­».&lt;/p&gt;</content><category term="PyQt"></category><category term="PyQt"></category><category term="QtNetwork"></category><category term="QHttp"></category><category term="QNetworkAccessManager"></category><category term="HTTP"></category><category term="ç½‘ç»œ"></category><category term="å¼‚æ­¥"></category></entry><entry><title>Tornado å¤šè¿›ç¨‹å®ç°åˆ†æ</title><link href="https://www.linuxzen.com/tornado-duo-jin-cheng-shi-xian-fen-xi.html" rel="alternate"></link><published>2014-04-11T14:35:00+08:00</published><updated>2014-04-11T14:35:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2014-04-11:/tornado-duo-jin-cheng-shi-xian-fen-xi.html</id><summary type="html">&lt;h2 id="_1"&gt;å¼•å­&lt;/h2&gt;
&lt;p&gt;Tornado æ˜¯ä¸€ä¸ªç½‘ç»œå¼‚æ­¥çš„çš„webå¼€å‘æ¡†æ¶, å¹¶ä¸”å¯ä»¥åˆ©ç”¨å¤šè¿›ç¨‹è¿›è¡Œæé«˜æ•ˆç‡, 
ä¸‹é¢æ˜¯åˆ›å»ºä¸€ä¸ªå¤šè¿›ç¨‹ tornado ç¨‹åºçš„ä¾‹å­.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c1"&gt;# -*- coding:utf-8 â€¦&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;h2 id="_1"&gt;å¼•å­&lt;/h2&gt;
&lt;p&gt;Tornado æ˜¯ä¸€ä¸ªç½‘ç»œå¼‚æ­¥çš„çš„webå¼€å‘æ¡†æ¶, å¹¶ä¸”å¯ä»¥åˆ©ç”¨å¤šè¿›ç¨‹è¿›è¡Œæé«˜æ•ˆç‡, 
ä¸‹é¢æ˜¯åˆ›å»ºä¸€ä¸ªå¤šè¿›ç¨‹ tornado ç¨‹åºçš„ä¾‹å­.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c1"&gt;# -*- coding:utf-8 -*-&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;tornado.web&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;tornado.httpserver&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;tornado.ioloop&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;tornado.netutil&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;tornado.process&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;LongHandler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tornado&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;web&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;RequestHandler&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getpid&lt;/span&gt;&lt;span class="p"&gt;()))&lt;/span&gt;
        &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tornado&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;web&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Application&lt;/span&gt;&lt;span class="p"&gt;(([&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;LongHandler&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;sockets&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tornado&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;netutil&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bind_sockets&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;8090&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;tornado&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;process&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fork_processes&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;server&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tornado&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;httpserver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HTTPServer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_sockets&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sockets&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;tornado&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ioloop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;IOLoop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šé¢ä»£ç ä½¿ç”¨ &lt;code&gt;tornado.process.fork_processes&lt;/code&gt; åˆ›å»ºäº†2ä¸ªå­è¿›ç¨‹, åŒæ—¶ç”¨æ—¶è®¿é—®è¿™ä¸ª
æœåŠ¡ä¸¤æ¬¡,  åˆ†åˆ«ä¼šè¿”å›ä¸¤ä¸ªç›¸é‚»çš„pid. å¯ä»¥çœ‹åˆ° tornado ç¡®å®ä½¿ç”¨äº†ä¸¤ä¸ªè¿›ç¨‹æ¥åŒæ—¶å®Œæˆä»»åŠ¡.&lt;/p&gt;
&lt;p&gt;æˆ‘ä¸€ç›´å¾ˆå¥½å¥‡ tornado æ˜¯å¦‚ä½•å°†è¯·æ±‚è°ƒåº¦åˆ°å­è¿›ç¨‹, å¤šä¸ªå­è¿›ç¨‹åˆå¦‚ä½•ä¸åŒæ—¶å¤„ç†ä¸€ä¸ªè¯·æ±‚å‘¢?&lt;/p&gt;
&lt;h2 id="_2"&gt;æ¢ç©¶&lt;/h2&gt;
&lt;p&gt;æˆ‘ä»¬é¦–å…ˆæ˜¯è°ƒç”¨ &lt;code&gt;tornado.netutil.bind_sockets&lt;/code&gt; æ¥åˆ›å»ºä¸€ä¸ª socket(æˆ–ä¸€ä¸ª socket åˆ—è¡¨),&lt;/p&gt;
&lt;p&gt;æ¥ç€æˆ‘ä»¬è°ƒç”¨ &lt;code&gt;tornado.process.fork_processes&lt;/code&gt; æ¥ fork å­è¿›ç¨‹, 
é˜…è¯»æ­¤å‡½æ•°çš„ä»£ç ä¼šå‘ç°è¿™ä¸ªå‡½æ•°ä»…ä»…æ˜¯åˆ›å»ºå­è¿›ç¨‹, ç„¶åä¸»è¿›ç¨‹è´Ÿè´£ç­‰å¾…å­è¿›ç¨‹, å¦‚æœå­è¿›
ç¨‹é€€å‡ºåˆ™ä¼šæ ¹æ®æ¡ä»¶é‡å¯å­è¿›ç¨‹, å¦‚æœå­è¿›ç¨‹å…¨éƒ¨é€€å‡ºå¹¶ä¸ç¬¦åˆé‡å¯æ¡ä»¶,åˆ™ä¸»è¿›ç¨‹é€€å‡º.&lt;/p&gt;
&lt;p&gt;è°ƒç”¨è¿™ä¸ªå‡½æ•°ä¹‹å, å­è¿›ç¨‹ä¸­å‡½æ•°ä¼šè¿”å›, å­è¿›ç¨‹åˆ™ç»§ç»­æ‰§è¡Œè°ƒç”¨è¿™ä¸ªå‡½æ•°ä¹‹åçš„ä»£ç .&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬åœ¨ fork å­è¿›ç¨‹ååšäº†å¦‚ä¸‹æ“ä½œ.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    &lt;span class="n"&gt;server&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tornado&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;httpserver&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HTTPServer&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_sockets&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sockets&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;tornado&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ioloop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;IOLoop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬å…ˆçœ‹çœ‹ &lt;code&gt;tornado.httpserver.HTTPServer.add_sockets&lt;/code&gt; å‘ç°&lt;code&gt;HTTPServer&lt;/code&gt;æ˜¯ç»§æ‰¿çš„
&lt;code&gt;tornado.netutil.TCPServer&lt;/code&gt;, add_sockets ä¹Ÿæ˜¯å®ç°åœ¨ &lt;code&gt;TCPServer&lt;/code&gt; ä¸­&lt;/p&gt;
&lt;p&gt;&lt;code&gt;tornado.netutil.TCPServer.add_sockets&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;add_sockets&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sockets&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;io_loop&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;io_loop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;IOLoop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;sock&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;sockets&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_sockets&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fileno&lt;/span&gt;&lt;span class="p"&gt;()]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sock&lt;/span&gt;
            &lt;span class="n"&gt;add_accept_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_handle_connection&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                               &lt;span class="n"&gt;io_loop&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;io_loop&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸»è¦æ˜¯æ˜ å°„äº†ä¸‹ socket å’Œ socket å¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦, æˆ‘ä»¬çœ‹çœ‹å®ƒè°ƒç”¨çš„
&lt;code&gt;add_accept_handler&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;add_accept_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;io_loop&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;io_loop&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;io_loop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;IOLoop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;accept_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;events&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;address&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;accept&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error&lt;/span&gt; &lt;span class="k"&gt;as&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;errno&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EWOULDBLOCK&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;errno&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EAGAIN&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                    &lt;span class="k"&gt;return&lt;/span&gt;
                &lt;span class="k"&gt;raise&lt;/span&gt;
            &lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;address&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;io_loop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fileno&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;accept_handler&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;IOLoop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;READ&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬çŸ¥é“ &lt;strong&gt;I/Oå¤šè·¯å¤ç”¨&lt;/strong&gt; åœ¨å¤„ç†æœåŠ¡ç«¯ socket æ—¶, å½“æœ‰è¿æ¥è¯·æ±‚è¿‡æ¥æ—¶, ä¼šè§¦å‘
å¯è¯»çš„äº‹ä»¶, æ­¤å‡½æ•°å°† socket åœ¨ä¸»äº‹ä»¶å¾ªç¯ä¸­æ³¨å†Œè¯»äº‹ä»¶(IOLoop.READ), å®ƒçš„å›è°ƒ
ä¼šåˆ›å»ºè¿æ¥, æˆ‘æ³¨æ„åˆ°å›è°ƒé‡Œçš„å¼‚å¸¸æ•è·æœ‰è¿™æ ·å‡ è¡Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;errno&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EWOULDBLOCK&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;errno&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EAGAIN&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                    &lt;span class="k"&gt;return&lt;/span&gt;
                &lt;span class="k"&gt;raise&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å‘ç°åœ¨åˆ›å»ºè¿æ¥çš„æ—¶å€™ä¼šè·³è¿‡è¿™ä¸ªå¼‚å¸¸å‘¢, ä¸ºä»€ä¹ˆ?é‚£ä¹ˆ &lt;code&gt;EWOULDBLOCK&lt;/code&gt; å’Œ &lt;code&gt;EAGAIN&lt;/code&gt; æ˜¯æ˜¯ä»€ä¹ˆå‘¢?
é€šè¿‡æŸ¥æ‰¾çŸ¥é“å®ƒçš„æ„æ€æ˜¯åœ¨éé˜»å¡æ¨¡å¼ä¸‹, ä¸éœ€è¦é‡è¯»æˆ–é‡å†™, &lt;code&gt;EAGAIN&lt;/code&gt; æ˜¯ &lt;code&gt;EWOULDBLOCK&lt;/code&gt; åœ¨
Windows ä¸Šçš„åå­—, æ‰€ä»¥çœ‹åˆ°è¿™é‡Œå°±å¾ˆæ˜ç¡®äº†.&lt;/p&gt;
&lt;h2 id="_3"&gt;ç»“è®º&lt;/h2&gt;
&lt;p&gt;Tornado å¤šè¿›ç¨‹çš„å¤„ç†æµç¨‹æ˜¯å…ˆåˆ›å»º socket, ç„¶åå† fork å­è¿›ç¨‹, è¿™æ ·æ‰€æœ‰çš„å­è¿›ç¨‹å®é™…éƒ½ç›‘å¬
ä¸€ä¸ª(æˆ–å¤šä¸ª)æ–‡ä»¶æè¿°ç¬¦, ä¹Ÿå°±æ˜¯éƒ½åœ¨ç›‘å¬åŒæ ·çš„ socket.&lt;/p&gt;
&lt;p&gt;å½“è¿æ¥è¿‡æ¥æ‰€æœ‰çš„å­è¿›ç¨‹éƒ½ä¼šæ”¶åˆ°å¯è¯»äº‹ä»¶, è¿™æ—¶å€™æ‰€æœ‰çš„å­è¿›ç¨‹éƒ½ä¼šè·³åˆ° &lt;code&gt;accept_handler&lt;/code&gt;
å›è°ƒå‡½æ•°, å°è¯•å»ºç«‹è¿æ¥.&lt;/p&gt;
&lt;p&gt;ä¸€æ—¦å…¶ä¸­ä¸€ä¸ªå­è¿›ç¨‹æˆåŠŸçš„å»ºç«‹äº†è¿æ¥, å½“å…¶ä»–å­è¿›ç¨‹å†å°è¯•å»ºç«‹è¿™ä¸ªè¿æ¥çš„æ—¶å€™å°±ä¼šè§¦å‘
&lt;code&gt;EWOULDBLOCK&lt;/code&gt;(æˆ– EAGAIN) é”™è¯¯. è¿™æ—¶å€™å›è°ƒå‡½æ•°åˆ¤æ–­æ˜¯è¿™ä¸ªé”™è¯¯åˆ™è¿”å›å‡½æ•°ä¸åšå¤„ç†.&lt;/p&gt;
&lt;p&gt;å½“æˆåŠŸå»ºç«‹è¿æ¥çš„å­è¿›ç¨‹è¿˜åœ¨å¤„ç†è¿™ä¸ªè¿æ¥çš„æ—¶å€™åˆè¿‡æ¥ä¸€ä¸ªè¿æ¥, è¿™æ—¶å€™å°±ä¼šæœ‰å¦å¤–ä¸€ä¸ª
å­è¿›ç¨‹æ¥æ‰‹è¿™ä¸ªè¿æ¥.&lt;/p&gt;
&lt;p&gt;Tornado å°±æ˜¯é€šè¿‡è¿™æ ·ä¸€ç§æœºåˆ¶, åˆ©ç”¨å¤šè¿›ç¨‹æå‡æ•ˆç‡, ç”±äºè¿æ¥åªèƒ½ç”±ä¸€ä¸ªå­è¿›ç¨‹æˆåŠŸåˆ›å»º,
åŒä¸€ä¸ªè¯·æ±‚ä¹Ÿå°±ä¸ä¼šè¢«å¤šä¸ªå­è¿›ç¨‹å¤„ç†.&lt;/p&gt;
&lt;h2 id="_4"&gt;åè®°&lt;/h2&gt;
&lt;p&gt;å†™å®Œæ‰å‘ç°, æˆ‘æ‰€ä½¿ç”¨çš„ä»£ç æ˜¯ tornado-2.4.post2 ç‰ˆæœ¬, å½“å‰æœ€æ–°ä»£ç æ˜¯ 3.3.0, 
æŸ¥çœ‹äº†ä¸‹æœ€æ–°ä»£ç , æœ€æ–°ä»£ç &lt;code&gt;TCPServer&lt;/code&gt; å†™åˆ°å•ç‹¬ &lt;code&gt;tornado.tcpserver&lt;/code&gt; é‡Œäº†, å…¶ä»–å’Œæœ¬æ–‡
ç›¸å…³çš„å¹¶æ²¡æœ‰ä»€ä¹ˆå¤§çš„å˜åŒ–.&lt;/p&gt;</content><category term="Python"></category><category term="Python"></category><category term="fork_processes"></category><category term="tornado"></category><category term="å¤šè¿›ç¨‹"></category><category term="web"></category><category term="æå‡"></category><category term="æ•ˆç‡"></category></entry><entry><title>è®°ä¸€æ¬¡ zsh äº§ç”Ÿåƒµå°¸è¿›ç¨‹è§£å†³</title><link href="https://www.linuxzen.com/ji-yi-ci-zsh-chan-sheng-jiang-shi-jin-cheng-jie-jue.html" rel="alternate"></link><published>2014-03-21T10:47:00+08:00</published><updated>2014-03-21T10:47:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2014-03-21:/ji-yi-ci-zsh-chan-sheng-jiang-shi-jin-cheng-jie-jue.html</id><summary type="html">&lt;h2 id="_1"&gt;é—®é¢˜æè¿°&lt;/h2&gt;
&lt;p&gt;ä»Šå¤©ä½¿ç”¨ vmplayer è¿è¡Œäº† xp ç³»ç»Ÿ, å…³é—­ååœ¨ zsh é‡Œç»§ç»­æ•²å‘½ä»¤å°±é˜»å¡äº†,
ç„¶åå°±å…³é—­äº†ç»ˆç«¯é‡æ–°æ‰“å¼€, è¿˜æ˜¯é˜»å¡, é‡å¤å‡ æ¬¡ â€¦&lt;/p&gt;</summary><content type="html">&lt;h2 id="_1"&gt;é—®é¢˜æè¿°&lt;/h2&gt;
&lt;p&gt;ä»Šå¤©ä½¿ç”¨ vmplayer è¿è¡Œäº† xp ç³»ç»Ÿ, å…³é—­ååœ¨ zsh é‡Œç»§ç»­æ•²å‘½ä»¤å°±é˜»å¡äº†,
ç„¶åå°±å…³é—­äº†ç»ˆç«¯é‡æ–°æ‰“å¼€, è¿˜æ˜¯é˜»å¡, é‡å¤å‡ æ¬¡ä¾ç„¶å¦‚æ­¤. ç„¶åä½¿ç”¨ gVim
å°† shell åˆ‡æ¢åˆ° bash, ç»ˆç«¯å¯ä»¥æ­£å¸¸æ‰“å¼€, ç„¶åè¿è¡Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;ps&lt;span class="w"&gt; &lt;/span&gt;aux&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;zsh
wh&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;27552&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.1&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;47244&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;5164&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;?&lt;span class="w"&gt;        &lt;/span&gt;Ss&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;09&lt;/span&gt;:38&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;:00&lt;span class="w"&gt; &lt;/span&gt;zsh
wh&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;27553&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.1&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;47244&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;5156&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;?&lt;span class="w"&gt;        &lt;/span&gt;Ss&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;09&lt;/span&gt;:38&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;:00&lt;span class="w"&gt; &lt;/span&gt;zsh
wh&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;27600&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;47348&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;3492&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;?&lt;span class="w"&gt;        &lt;/span&gt;D&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;09&lt;/span&gt;:38&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;:00&lt;span class="w"&gt; &lt;/span&gt;zsh
wh&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;27609&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;47348&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;3488&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;?&lt;span class="w"&gt;        &lt;/span&gt;D&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;09&lt;/span&gt;:38&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;:00&lt;span class="w"&gt; &lt;/span&gt;zsh
wh&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;27614&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;47348&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;3484&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;?&lt;span class="w"&gt;        &lt;/span&gt;D&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;09&lt;/span&gt;:38&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;:00&lt;span class="w"&gt; &lt;/span&gt;zsh
wh&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;27697&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.1&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;47248&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;5172&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;?&lt;span class="w"&gt;        &lt;/span&gt;Ss&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;09&lt;/span&gt;:39&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;:00&lt;span class="w"&gt; &lt;/span&gt;-/bin/zsh
wh&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;27718&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;47356&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;3496&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;?&lt;span class="w"&gt;        &lt;/span&gt;D&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;09&lt;/span&gt;:39&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;:00&lt;span class="w"&gt; &lt;/span&gt;-/bin/zsh
root&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;28040&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;36640&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2812&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;tty2&lt;span class="w"&gt;     &lt;/span&gt;Ss+&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;09&lt;/span&gt;:40&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;:00&lt;span class="w"&gt; &lt;/span&gt;-zsh
wh&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;28628&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;47356&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;3492&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;?&lt;span class="w"&gt;        &lt;/span&gt;D&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;09&lt;/span&gt;:42&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;:00&lt;span class="w"&gt; &lt;/span&gt;-/bin/zsh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;s&gt;å‘ç°å¥½å¤šåƒµå°¸è¿›ç¨‹, è€Œä¸”éƒ½ kill ä¸æ‰.&lt;/s&gt;
å‘ç°å¥½å¤š D çŠ¶æ€çš„è¿›ç¨‹, æŸ¥çœ‹ &lt;code&gt;ps&lt;/code&gt; çš„æ‰‹å†Œ, D çŠ¶æ€çš„è§£é‡Šæ˜¯&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;D    uninterruptible sleep (usually io)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿›ç¨‹å¯èƒ½æ˜¯ç”± I/O å¼•èµ·çš„ä¸å¯é—´æ–­çš„ç­‰å¾….&lt;/p&gt;
&lt;h2 id="_2"&gt;è§£å†³&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆå½“ç„¶æ˜¯ &lt;code&gt;strace&lt;/code&gt; ç™»åœº&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;strace&lt;span class="w"&gt; &lt;/span&gt;zsh
...
pipe&lt;span class="o"&gt;([&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="o"&gt;])&lt;/span&gt;&lt;span class="w"&gt;                            &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
fcntl&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;F_DUPFD,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt;                   &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;
close&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt;                                &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
fcntl&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;4&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;F_DUPFD,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt;                   &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;12&lt;/span&gt;
close&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt;                                &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
rt_sigprocmask&lt;span class="o"&gt;(&lt;/span&gt;SIG_BLOCK,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;CHLD&lt;span class="o"&gt;]&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;CHLD&lt;span class="w"&gt; &lt;/span&gt;WINCH&lt;span class="o"&gt;]&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;8&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
clone&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nv"&gt;child_stack&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;flags&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;CLONE_CHILD_CLEARTID&lt;span class="p"&gt;|&lt;/span&gt;CLONE_CHILD_SETTID&lt;span class="p"&gt;|&lt;/span&gt;SIGCHLD,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;child_tidptr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;0x7fd94caef9d0&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;8750&lt;/span&gt;
close&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;12&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt;                               &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
fcntl&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;F_GETFL&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt;                      &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;flags&lt;span class="w"&gt; &lt;/span&gt;O_RDONLY&lt;span class="o"&gt;)&lt;/span&gt;
fstat&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;st_mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;S_IFIFO&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="m"&gt;0600&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;st_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;...&lt;span class="o"&gt;})&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
mmap&lt;span class="o"&gt;(&lt;/span&gt;NULL,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;4096&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;PROT_READ&lt;span class="p"&gt;|&lt;/span&gt;PROT_WRITE,&lt;span class="w"&gt; &lt;/span&gt;MAP_PRIVATE&lt;span class="p"&gt;|&lt;/span&gt;MAP_ANONYMOUS,&lt;span class="w"&gt; &lt;/span&gt;-1,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;0x7fd94caf3000
lseek&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;SEEK_CUR&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt;                  &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-1&lt;span class="w"&gt; &lt;/span&gt;ESPIPE&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;Illegal&lt;span class="w"&gt; &lt;/span&gt;seek&lt;span class="o"&gt;)&lt;/span&gt;
read&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;,
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä»ä¸Šé¢å¯ä»¥çœ‹å‡º, zsh æ‰“å¼€äº†ä¸€ä¸ª pipe, ä½†æ˜¯è¯»å–çš„æ—¶å€™é˜»å¡äº†.&lt;/p&gt;
&lt;p&gt;ç°åœ¨è°ƒç”¨ &lt;code&gt;strace -f&lt;/code&gt; æŸ¥çœ‹ç®¡é“å¦ä¸€å¤´çš„åœ¨åšäº›ä»€ä¹ˆ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;strace&lt;span class="w"&gt; &lt;/span&gt;-f&lt;span class="w"&gt; &lt;/span&gt;zsh
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;28429&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;chdir&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;..&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt;                 &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;28429&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;stat&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;..&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;st_mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;S_IFDIR&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="m"&gt;0755&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;st_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;4096&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;...&lt;span class="o"&gt;})&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;28429&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;openat&lt;span class="o"&gt;(&lt;/span&gt;AT_FDCWD,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;..&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;O_RDONLY&lt;span class="p"&gt;|&lt;/span&gt;O_NONBLOCK&lt;span class="p"&gt;|&lt;/span&gt;O_DIRECTORY&lt;span class="p"&gt;|&lt;/span&gt;O_CLOEXEC&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;28429&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;getdents&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;/*&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;12&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;entries&lt;span class="w"&gt; &lt;/span&gt;*/,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;32768&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;344&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;28429&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;lstat&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;../home&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;st_mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;S_IFDIR&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="m"&gt;0755&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;st_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;4096&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;...&lt;span class="o"&gt;})&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;28429&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;close&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt;                    &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;28429&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;chdir&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;..&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt;                 &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;28429&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;stat&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;..&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;st_mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;S_IFDIR&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="m"&gt;0755&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;st_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;4096&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;...&lt;span class="o"&gt;})&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;28429&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;openat&lt;span class="o"&gt;(&lt;/span&gt;AT_FDCWD,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;..&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;O_RDONLY&lt;span class="p"&gt;|&lt;/span&gt;O_NONBLOCK&lt;span class="p"&gt;|&lt;/span&gt;O_DIRECTORY&lt;span class="p"&gt;|&lt;/span&gt;O_CLOEXEC&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;28429&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;getdents&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;/*&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;26&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;entries&lt;span class="w"&gt; &lt;/span&gt;*/,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;32768&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;672&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;28429&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;lstat&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;../lib&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="nv"&gt;st_mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;S_IFLNK&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="m"&gt;0777&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;st_size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;7&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;...&lt;span class="o"&gt;})&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="o"&gt;[&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;28429&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;lstat&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;../mnt&amp;quot;&lt;/span&gt;,
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šé¢å¯ä»¥çœ‹åˆ° zsh åœ¨ &lt;code&gt;lstat("../mnt")&lt;/code&gt; çš„æ—¶å€™äº§ç”Ÿäº†ç­‰å¾…&lt;/p&gt;
&lt;p&gt;/mnt ä¸€èˆ¬æŒ‚è½½ä¸€äº›ä¸œè¥¿, è¿è¡Œ &lt;code&gt;df -h&lt;/code&gt; æŸ¥çœ‹ä¸€ä¸‹, å‘ç°ä¹Ÿå¾ˆæ…¢, å½“ç„¶ strace ä¸‹ å®ƒ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;strace&lt;span class="w"&gt; &lt;/span&gt;df&lt;span class="w"&gt; &lt;/span&gt;-h
...
stat&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/mnt&amp;quot;&lt;/span&gt;,
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å‘ç°å®ƒåŒæ ·å¡åœ¨äº†è¯»å– &lt;code&gt;/mnt&lt;/code&gt;. å°è¯• &lt;code&gt;umount&lt;/code&gt; å®ƒ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;sudo&lt;span class="w"&gt; &lt;/span&gt;umount&lt;span class="w"&gt; &lt;/span&gt;/mnt
umount:&lt;span class="w"&gt; &lt;/span&gt;/mnt:&lt;span class="w"&gt; &lt;/span&gt;target&lt;span class="w"&gt; &lt;/span&gt;is&lt;span class="w"&gt; &lt;/span&gt;busy
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;In&lt;span class="w"&gt; &lt;/span&gt;some&lt;span class="w"&gt; &lt;/span&gt;cases&lt;span class="w"&gt; &lt;/span&gt;useful&lt;span class="w"&gt; &lt;/span&gt;info&lt;span class="w"&gt; &lt;/span&gt;about&lt;span class="w"&gt; &lt;/span&gt;processes&lt;span class="w"&gt; &lt;/span&gt;that
&lt;span class="w"&gt;         &lt;/span&gt;use&lt;span class="w"&gt; &lt;/span&gt;the&lt;span class="w"&gt; &lt;/span&gt;device&lt;span class="w"&gt; &lt;/span&gt;is&lt;span class="w"&gt; &lt;/span&gt;found&lt;span class="w"&gt; &lt;/span&gt;by&lt;span class="w"&gt; &lt;/span&gt;lsof&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;8&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;or&lt;span class="w"&gt; &lt;/span&gt;fuser&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;.&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¯´æ˜¯è¢«æŸä¸ªç¨‹åºä½¿ç”¨, ç°åœ¨è¯¥ &lt;code&gt;lsof&lt;/code&gt; ç™»åœºäº†&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;lsof&lt;span class="w"&gt; &lt;/span&gt;/mnt
lsof&lt;span class="w"&gt; &lt;/span&gt;/mnt
lsof:&lt;span class="w"&gt; &lt;/span&gt;WARNING:&lt;span class="w"&gt; &lt;/span&gt;can&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;t&lt;span class="w"&gt; &lt;/span&gt;stat&lt;span class="o"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;cifs&lt;span class="w"&gt; &lt;/span&gt;file&lt;span class="w"&gt; &lt;/span&gt;system&lt;span class="w"&gt; &lt;/span&gt;/mnt
&lt;span class="w"&gt;      &lt;/span&gt;Output&lt;span class="w"&gt; &lt;/span&gt;information&lt;span class="w"&gt; &lt;/span&gt;may&lt;span class="w"&gt; &lt;/span&gt;be&lt;span class="w"&gt; &lt;/span&gt;incomplete.
lsof:&lt;span class="w"&gt; &lt;/span&gt;status&lt;span class="w"&gt; &lt;/span&gt;error&lt;span class="w"&gt; &lt;/span&gt;on&lt;span class="w"&gt; &lt;/span&gt;/mnt:&lt;span class="w"&gt; &lt;/span&gt;Host&lt;span class="w"&gt; &lt;/span&gt;is&lt;span class="w"&gt; &lt;/span&gt;down
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¥½å§, çœ‹åˆ°è¿™é‡Œæˆ‘å°±æƒ³æ˜ç™½äº†, å› ä¸ºå¼€è™šæ‹Ÿæœºçš„æ—¶å€™æˆ‘æŒ‚è½½äº†è™šæ‹Ÿæœºé‡Œçš„ä¸€ä¸ªå…±äº«ç›®å½•&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;sudo&lt;span class="w"&gt; &lt;/span&gt;mount&lt;span class="w"&gt; &lt;/span&gt;-t&lt;span class="w"&gt; &lt;/span&gt;cifs&lt;span class="w"&gt; &lt;/span&gt;-o&lt;span class="w"&gt; &lt;/span&gt;guest&lt;span class="w"&gt; &lt;/span&gt;//ip.of.host/share&lt;span class="w"&gt; &lt;/span&gt;/mnt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åœ¨è™šæ‹Ÿæœºå…³é—­ä¹‹åæ²¡æœ‰å¸è½½, å¯¼è‡´åœ¨å¯¹è¿™ä¸ªç›®å½• &lt;code&gt;stat&lt;/code&gt; çš„æ—¶å€™ä¼šæœ‰ä¸€ä¸ªç½‘ç»œè¶…æ—¶æ—¶é—´.&lt;/p&gt;
&lt;p&gt;ç„¶åå°±å¸è½½å®ƒ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;umount&lt;span class="w"&gt; &lt;/span&gt;-a&lt;span class="w"&gt; &lt;/span&gt;-t&lt;span class="w"&gt; &lt;/span&gt;cifs&lt;span class="w"&gt; &lt;/span&gt;-l&lt;span class="w"&gt; &lt;/span&gt;/mnt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="_3"&gt;ç»“æœ&lt;/h2&gt;
&lt;p&gt;ç°åœ¨æ‰“å¼€ zsh ä¹Ÿä¸é˜»å¡äº†, &lt;code&gt;df -h&lt;/code&gt; ä¹ŸåŒæ ·ä¸é˜»å¡äº†. ä¸Šé¢ Ss çš„è¿›ç¨‹å¯ä»¥ç”¨ -9 æ€æ‰,
ä½†æ˜¯ D çŠ¶æ€è¿›ç¨‹æ— æ³•æ€æ‰.&lt;/p&gt;
&lt;h2 id="_4"&gt;å‚è€ƒ&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;lsof: &lt;a href="http://www.ibm.com/developerworks/cn/aix/library/au-lsof.html"&gt;http://stackoverflow.com/questions/74626/how-do-you-force-a-cifs-connection-to-unmount&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;å¸è½½ cifs: &lt;a href="http://stackoverflow.com/questions/74626/how-do-you-force-a-cifs-connection-to-unmount"&gt;http://stackoverflow.com/questions/74626/how-do-you-force-a-cifs-connection-to-unmount&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="_5"&gt;æ›´æ–°&lt;/h2&gt;
&lt;p&gt;ç»è¿‡ &lt;a href="http://lilydjwg.is-programmer.com/"&gt;ä¾äº‘&lt;/a&gt; å’Œ &lt;a href="http://eleveni386.7axu.com"&gt;eleven&lt;/a&gt;
çš„æŒ‡æ­£å¯¹æ–‡ç« åšäº†ä¸€äº›ä¿®æ”¹, æ„Ÿè°¢ä¸¤ä½.&lt;/p&gt;</content><category term="Linux"></category><category term="zsh"></category><category term="è¿›ç¨‹"></category><category term="é˜»å¡"></category><category term="å‘½ä»¤"></category><category term="D"></category><category term="åƒµå°¸"></category></entry><entry><title>è§£å†³ä¸€ç›´å´©æºƒçš„ Adobe Flash Player</title><link href="https://www.linuxzen.com/jie-jue-yi-zhi-beng-kui-de-adobe-flash-player.html" rel="alternate"></link><published>2014-03-12T00:00:00+08:00</published><updated>2014-03-12T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2014-03-12:/jie-jue-yi-zhi-beng-kui-de-adobe-flash-player.html</id><summary type="html">&lt;p&gt;1æœˆä»½çš„æ—¶å€™å†³å®šä» Ubuntu æ¢åˆ° Archlinux, æ¢å®Œä¹‹å Flash Player å°±ä¸€ç›´æ²¡æ­£å¸¸è¿‡.
ä¸€æ‰“å¼€è§†å±å°± crash.  ä»é‚£ä¹‹åå°±ä¸€ç›´ç”¨æ‰‹æœºçœ‹è§†å±, å¾ˆåˆ«æ‰­, æ”¾ç€å¤§å±ä¸ç”¨ä¸€ç›´ç›¯ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;1æœˆä»½çš„æ—¶å€™å†³å®šä» Ubuntu æ¢åˆ° Archlinux, æ¢å®Œä¹‹å Flash Player å°±ä¸€ç›´æ²¡æ­£å¸¸è¿‡.
ä¸€æ‰“å¼€è§†å±å°± crash.  ä»é‚£ä¹‹åå°±ä¸€ç›´ç”¨æ‰‹æœºçœ‹è§†å±, å¾ˆåˆ«æ‰­, æ”¾ç€å¤§å±ä¸ç”¨ä¸€ç›´ç›¯ç€æ‰‹æœºçœ‹çœ‹.
ä»Šå¤©ä¸‹å®šå†³å¿ƒæ‰¾æ‰¾åŸå› . google äº†ä¸€é˜µä¹Ÿæ²¡æœ‰å•¥ç»“æœ, æ‰€ä»¥æˆ‘å†³å®šå¸è½½ç°æœ‰çš„, æ‰‹åŠ¨å®‰è£…ä¸€ä¸ªè¯•è¯•.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;sudo&lt;span class="w"&gt; &lt;/span&gt;pacman&lt;span class="w"&gt; &lt;/span&gt;-R&lt;span class="w"&gt; &lt;/span&gt;flashplugin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç»“æœå¸è½½çš„æ—¶å€™è¾“å‡ºæ®µä¿¡æ¯:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;warning: /etc/adobe/mms.cfg saved as /etc/adobe/mms.cfg.pacsave
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæˆ‘çœ‹äº†ä¸‹æ–‡ä»¶å†…å®¹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;cat&lt;span class="w"&gt; &lt;/span&gt;/etc/adobe/mms.cfg.pacsave
&lt;span class="c1"&gt;#Hardware video decoding&lt;/span&gt;
&lt;span class="nv"&gt;EnableLinuxHWVideoDecode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç¬é—´è§‰å¾—å¯èƒ½æ˜¯è¿™ä¸ªé€‰é¡¹å¼•èµ·çš„, æ‰€ä»¥æˆ‘åˆè£…ä¸Šäº† flashplugin&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;sudo&lt;span class="w"&gt; &lt;/span&gt;pacman&lt;span class="w"&gt; &lt;/span&gt;-S&lt;span class="w"&gt; &lt;/span&gt;flashplugin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åŒæ ·çœ‹åˆ°ä¸€æ®µä¿¡æ¯&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;If&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;you&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;have&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;an&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;NVIDIA&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;card&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;that&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;supports&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;libvdpau&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;or&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Broadcom&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Crystal&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HD&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;chips&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;uncomment&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;EnableLinuxHWVideoDecode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;adobe&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mms&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cfg&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;If&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;you&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;into&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;problems&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;please&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;contact&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;nVidia&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ow"&gt;or&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Broadcom&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;along&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;with&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;your&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;system&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;driver&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;version&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="n"&gt;Optional&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dependencies&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;flashplugin&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nl"&gt;libvdpau&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;GPU&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;acceleration&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;on&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Nvidia&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;card&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;installed&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæˆ‘å°±çŸ¥é“äº†ä¸ºä»€ä¹ˆä¼šå‡ºç°é‚£ä¸ªé€‰é¡¹æ‰“å¼€çš„æƒ…å†µäº†, ä¸€å¼€å§‹å®‰è£… Archlinux çš„æ—¶å€™æˆ‘è¯¯ä»¥ä¸ºæˆ‘çš„æ˜¾å¡æ˜¯ NVIDIA çš„,
ç„¶åå°±å®‰è£…äº† NVIDIA çš„é©±åŠ¨, åæ¥ä»”ç»†ä¸€çœ‹åŸæ¥æ˜¯é›†æˆçš„ Intel æ˜¾å¡XD, ä¼°è®¡åœ¨ä¸€å¼€å§‹å®‰è£… flashplugin
çš„æ—¶å€™è‡ªåŠ¨å¼€å¯äº†. ç„¶åæ¢äº†æ˜¾å¡é©±åŠ¨æˆ‘ä¹Ÿä¸æ¸…æ¥š.ç°åœ¨çœ‹æ–°çš„é…ç½®æ–‡ä»¶ EnableLinuxHWVIdeoDecode=1 æ˜¯æ³¨é‡Šæ‰çš„.&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥å°±æ˜¯éªŒè¯å–½, æ‰“å¼€ä¸€ä¸ªè§†å±, æœç„¶ä¸ crash äº†.&lt;/p&gt;
&lt;p&gt;ç„¶åå¼€å¯è¿™ä¸ªé€‰é¡¹, æœç„¶é¢„æ–™ä¸­çš„æ¥ç€ crash.&lt;/p&gt;</content><category term="Linux"></category><category term="archlinux"></category><category term="flash player"></category><category term="crash"></category><category term="è§£å†³"></category></entry><entry><title>ä½¿ç”¨ Pygments å¯¹ Vimwiki è¿›è¡Œä»£ç é«˜äº®</title><link href="https://www.linuxzen.com/shi-yong-pygments-dui-vimwiki-jin-xing-dai-ma-gao-liang.html" rel="alternate"></link><published>2013-12-27T00:00:00+08:00</published><updated>2013-12-27T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-12-27:/shi-yong-pygments-dui-vimwiki-jin-xing-dai-ma-gao-liang.html</id><summary type="html">&lt;p&gt;Vimwiki æ¨èçš„ä»£ç é«˜äº®æœºåˆ¶æ˜¯é€šè¿‡ä¸€ä¸ª JavaScript æ’ä»¶æ¥å®Œæˆçš„, é‚£æ ·éœ€è¦åŠ è½½å¾ˆå¤š js,
æ‰€ä»¥ä¸æƒ³ä½¿ç”¨, æ¯”è¾ƒå€¾å‘ä½¿ç”¨ Pygments åœ¨ Vimwiki ç”Ÿæˆ HTML çš„ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;Vimwiki æ¨èçš„ä»£ç é«˜äº®æœºåˆ¶æ˜¯é€šè¿‡ä¸€ä¸ª JavaScript æ’ä»¶æ¥å®Œæˆçš„, é‚£æ ·éœ€è¦åŠ è½½å¾ˆå¤š js,
æ‰€ä»¥ä¸æƒ³ä½¿ç”¨, æ¯”è¾ƒå€¾å‘ä½¿ç”¨ Pygments åœ¨ Vimwiki ç”Ÿæˆ HTML çš„æ—¶å€™å¯¹ä»£ç è¿›è¡Œé«˜äº®.&lt;/p&gt;
&lt;h1 id="_1"&gt;å°è¯•&lt;/h1&gt;
&lt;h2 id="custom_wiki2html"&gt;ä½¿ç”¨ custom_wiki2html é€‰é¡¹&lt;/h2&gt;
&lt;p&gt;ä»”ç»†çš„çœ‹äº† Vimwiki çš„å¸®åŠ©æ–‡æ¡£, å‘ç°æœ‰ä¸€ä¸ª custom_wiki2html 
(&lt;code&gt;:h vimwiki-option-custom_wiki2html&lt;/code&gt;) çš„é€‰é¡¹å¯ä»¥æŒ‡å®šè‡ªå·±
çš„è„šæœ¬æ¥å¤„ç† wiki2html, å°è¯•äº†ä¸€ä¸‹, å‘ç°è¿™ä¸ªè„šæœ¬æ˜¯åœ¨ç”Ÿæˆ HTML ä¹‹å‰è°ƒç”¨,
è€Œä¸”å¦‚æœå¯¹ wiki æ–‡ä»¶å¤„ç†ä¹‹åæ— æ³•æ›¿æ¢å›åŸæ¥çš„å†…å®¹(åæ¥å‘ç°è¿™ä¸ªä»…ä»…æ˜¯å¯¹ä½¿ç”¨ Markdown
è¯­æ³•ä½œä¸º Wiki è¯­æ³•è®¾å®šçš„), æ‰€ä»¥æ”¾å¼ƒäº†.&lt;/p&gt;
&lt;h2 id="fork"&gt;Fork ä»“åº“, æ›´æ”¹ä»£ç &lt;/h2&gt;
&lt;p&gt;åæ¥æƒ³æƒ³æ—¢ç„¶åŸç”Ÿçš„æ²¡æœ‰è§£å†³åŠæ³•, æ‰€ä»¥å°±å¹²è„†åœ¨ github ä¸Š fork äº†ä»“åº“
clone åˆ°æœ¬åœ°è¿›è¡Œä¿®æ”¹, é€šè¿‡ç›´æ¥ hack ä»£ç åœ¨ Vimwiki å¤„ç†ä¹‹å‰å¯¹ä»£ç è¿›è¡Œé«˜äº®.&lt;/p&gt;
&lt;h3 id="_2"&gt;æ€è·¯&lt;/h3&gt;
&lt;p&gt;ç²—ç•¥çš„çœ‹äº†ä¸‹ä»£ç , Vimwiki æ˜¯å°†æ–‡ä»¶è¯»å…¥, ç„¶åé€è¡Œå¤„ç†, çœ‹æ¥åªèƒ½åœ¨æ–‡ä»¶è¯»å–ä¹‹å
å¯¹å†…å®¹åšä¸€äº›æ“ä½œ.&lt;/p&gt;
&lt;p&gt;Vimscript çš„ readfile è¿”å›ä¸€ä¸ªåˆ—è¡¨, æ¯ä¸€ä¸ªå…ƒç´ ä»£è¡¨ä¸€è¡Œ, ç¼–å†™ä¸€ä¸ªå‡½æ•°å¤„ç†è¿™ä¸ª
åˆ—è¡¨, å¹¶è¿”å›, åœ¨ autoload/vimwiki/html.vim é‡Œçš„ ç¬¬ 1350 è¡Œæ‰¾åˆ°
&lt;code&gt;vimwiki#html#CustomWiki2HTML&lt;/code&gt; å‡½æ•°, å¹¶åœ¨å…¶ä¸Šé¢æ·»åŠ ä¸€ä¸ªå‡½æ•°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="p"&gt;!&lt;/span&gt; s:highlight_code_with_pygments&lt;span class="p"&gt;(&lt;/span&gt;lsource&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c"&gt;&amp;quot;{{{&lt;/span&gt;
  &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;!&lt;/span&gt;has&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;python&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;a&lt;/span&gt;:lsource
  &lt;span class="k"&gt;endif&lt;/span&gt;
  &lt;span class="k"&gt;let&lt;/span&gt; s:lsource &lt;span class="p"&gt;=&lt;/span&gt; deepcopy&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;a&lt;/span&gt;:lsource&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;let&lt;/span&gt; s:content &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;python&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt;EOF
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;handle&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
  &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;vim&lt;/span&gt;

  &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;re&lt;/span&gt;
  &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;

  &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pygments&lt;/span&gt;
  &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;ImportError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;vim&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;echoerr &amp;#39;Cannot import pygments library, please install it.&amp;#39;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt;

  &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pygments.lexers&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;get_lexer_by_name&lt;/span&gt;
  &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pygments.formatters&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;HtmlFormatter&lt;/span&gt;
  &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pygments&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;highlight&lt;/span&gt;
  &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pygments.util&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;ClassNotFound&lt;/span&gt;

  &lt;span class="n"&gt;CODE_RE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;re&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;\n({{{(\w*?)\s(.*?)\s}}})&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;re&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;M&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;re&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;U&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;re&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;S&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

  &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;vim&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;eval&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;s:lsource&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;
  &lt;span class="n"&gt;css_class&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;vim&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;eval&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;VimwikiGet(&amp;#39;pygments_class&amp;#39;)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lang_type&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;code&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;CODE_RE&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;findall&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;lang_type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;lang_type&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;text&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="n"&gt;lexer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_lexer_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;lang_type&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;ClassNotFound&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="n"&gt;lexer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_lexer_by_name&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;text&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;formatter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;HtmlFormatter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;encoding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;utf8&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cssclass&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;css_class&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                              &lt;span class="n"&gt;noclasses&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;style&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                              &lt;span class="n"&gt;linenos&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nowrap&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;hcode&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;highlight&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lexer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;formatter&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;hcode&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
      &lt;span class="n"&gt;new&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;

  &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;new&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;vim&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;let s:content=&amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;&amp;#39;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;#39;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\&amp;#39;&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="n"&gt;handle&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

EOF

  &lt;span class="k"&gt;if&lt;/span&gt; s:content &lt;span class="p"&gt;!=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;let&lt;/span&gt; s:lsource &lt;span class="p"&gt;=&lt;/span&gt; split&lt;span class="p"&gt;(&lt;/span&gt;s:content&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;\n&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
  &lt;span class="k"&gt;endif&lt;/span&gt;

  &lt;span class="k"&gt;return&lt;/span&gt; s:lsource
&lt;span class="k"&gt;endfunction&lt;/span&gt; &lt;span class="c"&gt;&amp;quot;}}}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶ååœ¨ &lt;code&gt;vimwiki#html#Wiki2HTML&lt;/code&gt; å‡½æ•°å†…è¯»å–æ–‡ä»¶çš„ä¸‹é¢è°ƒç”¨æ­¤å‡½æ•°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;...
    &lt;span class="k"&gt;let&lt;/span&gt; lsource &lt;span class="p"&gt;=&lt;/span&gt; readfile&lt;span class="p"&gt;(&lt;/span&gt;wikifile&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;let&lt;/span&gt; lsource &lt;span class="p"&gt;=&lt;/span&gt; s:highlight_code_with_pygments&lt;span class="p"&gt;(&lt;/span&gt;lsource&lt;span class="p"&gt;)&lt;/span&gt;
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å½“ç„¶éœ€è¦è¿˜éœ€è¦æ‹·è´ css æ–‡ä»¶, ä¿®æ”¹æ¨¡æ¿ç­‰, è¿™é‡Œä¸ä¸€ä¸€è¯¦è¿°&lt;/p&gt;
&lt;h3 id="_3"&gt;ç»“æœ&lt;/h3&gt;
&lt;p&gt;å¥½å§, ç¡®å®å·¥ä½œäº†, ä½†æ˜¯æ–°çš„é—®é¢˜å‡ºæ¥äº†, é«˜äº®åæ›¿æ¢æˆHTMLçš„å†…å®¹ä¼šè¢« Vimwiki ç¬¬äºŒæ¬¡å¤„ç†
æ‰€ä»¥ HTML çš„æ ¼å¼å…¨ä¹±äº†,  CSS æ ·å¼ä¹Ÿè‚¯å®šä¸è¡Œäº†. æ‰¾äº†ä¸€ä¸‹æ²¡æœ‰åŠæ³•èƒ½é¿å… Vimwiki ä¸
å¤„ç†ä¸€æ®µå†…å®¹(ä¸ºä»€ä¹ˆå·²ç»æ˜¯ HTMl äº† Vimwiki è¿˜è¦å¤„ç†å‘¢)&lt;/p&gt;
&lt;p&gt;ä¸Šè¿°æ–¹æ³•ä¸è¡Œ, é‚£åªèƒ½å†æƒ³æƒ³åŠæ³•äº†&lt;/p&gt;
&lt;h3 id="nowiki"&gt;ä½¿ç”¨ç‰¹æ®Šçš„æ³¨é‡Š: %nowiki&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†è§£å†³ä¸Šé¢é‡å¤å¤„ç†å·²è½¬åŒ–æˆ HTML å†…å®¹çš„é—®é¢˜, æˆ‘æ·»åŠ  %nowiki è¯­æ³•,
ä»¥ %nowiki è¿™ä¸ªå¼€å¤´çš„è¡Œå°†ä¸å¤„ç†. ç„¶åå°†é«˜äº®çš„ä»£ç æ›¿æ¢æˆ %nowiki å¼€å§‹çš„è¡Œ,
å°†ä¸Šé¢ Python ç›¸å…³ä»£ç åŠ ä¸Šå¦‚ä¸‹å†…å®¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;hcode&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;highlight&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;lexer&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;formatter&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# æ·»åŠ ä»¥ä¸‹è¯­å¥&lt;/span&gt;
&lt;span class="n"&gt;hcode&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;%nowiki&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;%nowiki&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;hcode&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;hcode&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;..&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæ‰¾åˆ° &lt;code&gt;s:parse_line&lt;/code&gt; å‡½æ•°, åœ¨å¤„ç† toc çš„ä¸‹é¢æ·»åŠ &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c"&gt;  &amp;quot; toc -- placeholder &amp;quot;{{{&lt;/span&gt;
  &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;!&lt;/span&gt;processed
    &lt;span class="k"&gt;if&lt;/span&gt; line &lt;span class="p"&gt;=~&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;^\s*%toc&amp;#39;&lt;/span&gt;
      &lt;span class="k"&gt;let&lt;/span&gt; processed &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
      &lt;span class="k"&gt;let&lt;/span&gt; param &lt;span class="p"&gt;=&lt;/span&gt; matchstr&lt;span class="p"&gt;(&lt;/span&gt;line&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;^\s*%toc\s\zs.*&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="k"&gt;let&lt;/span&gt; state.placeholder &lt;span class="p"&gt;=&lt;/span&gt; [&lt;span class="s1"&gt;&amp;#39;toc&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; param]
    &lt;span class="k"&gt;endif&lt;/span&gt;
  &lt;span class="k"&gt;endif&lt;/span&gt;
&lt;span class="c"&gt;  &amp;quot;}}}&lt;/span&gt;

&lt;span class="c"&gt;  &amp;quot; æ·»åŠ å¤„ç† nowiki&lt;/span&gt;
&lt;span class="c"&gt;  &amp;quot; nowiki &amp;quot;{{{&lt;/span&gt;
  &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;!&lt;/span&gt;processed
    &lt;span class="k"&gt;if&lt;/span&gt; line&lt;span class="p"&gt;=~&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;^\s*%nowiki&amp;#39;&lt;/span&gt;
      &lt;span class="k"&gt;let&lt;/span&gt; processed &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
      &lt;span class="k"&gt;call&lt;/span&gt; add&lt;span class="p"&gt;(&lt;/span&gt;res_lines&lt;span class="p"&gt;,&lt;/span&gt; substitute&lt;span class="p"&gt;(&lt;/span&gt;line&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;^\s*%nowiki&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;endif&lt;/span&gt;
  &lt;span class="k"&gt;endif&lt;/span&gt; &lt;span class="c"&gt;&amp;quot;}}}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæ‰¾åˆ° &lt;code&gt;s:safe_html&lt;/code&gt; å‡½æ•°, æ·»åŠ å¦‚ä¸‹è¯­å¥&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="p"&gt;!&lt;/span&gt; s:safe_html&lt;span class="p"&gt;(&lt;/span&gt;line&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c"&gt;&amp;quot;{{{&lt;/span&gt;
&lt;span class="c"&gt;  &amp;quot; ä¸å¤„ç† %nowiki &lt;/span&gt;
  &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="k"&gt;a&lt;/span&gt;:line&lt;span class="p"&gt;=~&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;^\s*%nowiki&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="k"&gt;a&lt;/span&gt;:line
  &lt;span class="k"&gt;endif&lt;/span&gt;

  ...
&lt;span class="k"&gt;endfunction&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¤§åŠŸå‘Šæˆ, è¿™æ ·å°±å¯ä»¥æ­£å¸¸çš„ä½¿ç”¨ pygments è¿›è¡Œé«˜äº®ä»£ç &lt;/p&gt;
&lt;h1 id="_4"&gt;æˆæœ&lt;/h1&gt;
&lt;p&gt;ä¿®æ”¹åçš„ä»£ç æ”¾åœ¨äº† github ä¸Š, åœ¨ &lt;a href="https://github.com/coldnight/vimwiki"&gt;è¿™é‡Œ&lt;/a&gt;, 
æœ‰éœ€è¦çš„å¯ä»¥å®‰è£…, ä½†è¿™ä¸ªæ›´æ”¹ä»…ä»…æ˜¯å¯¹æˆ‘ä¸ªäººä½¿ç”¨, å¯èƒ½ä¸ä¼šè·Ÿéšä¸»çº¿ç¨‹ç‰ˆæœ¬çš„æ›´æ–°.&lt;/p&gt;
&lt;p&gt;å½“ç„¶æˆ‘æ·»åŠ äº†ä¸€äº›é€‰é¡¹æ¥å¼€å¯/å…³é—­ä½¿ç”¨pygments, å®‰è£…ååœ¨ Vim ä¸­æ‰§è¡Œ &lt;code&gt;:h vimwiki-option-use_pygments&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å¤§å®¶é€šè¿‡ä»£ç ä¹Ÿçœ‹åˆ°äº†, è¦ä½¿ç”¨æ”¹å˜ä¹‹åçš„æ’ä»¶ Vim éœ€è¦ç¼–è¯‘ +python å¹¶ä¸”éœ€è¦å®‰è£… pygments Python åº“.&lt;/p&gt;</content><category term="Vim"></category><category term="vim"></category><category term="vimwiki"></category><category term="pygments"></category><category term="python"></category><category term="highlight"></category></entry><entry><title>ä½¿ç”¨ Vimwiki + git åšçŸ¥è¯†ç®¡ç†</title><link href="https://www.linuxzen.com/shi-yong-vimwiki-git-zuo-zhi-shi-guan-li.html" rel="alternate"></link><published>2013-12-26T00:00:00+08:00</published><updated>2013-12-26T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-12-26:/shi-yong-vimwiki-git-zuo-zhi-shi-guan-li.html</id><summary type="html">&lt;p&gt;ä¸€ç›´åœ¨æ‰¾ä¸€ä¸ªåˆé€‚çš„çŸ¥è¯†ç®¡ç†å·¥å…·, ç”¨è¿‡ Evernote, ä½†æ˜¯ä¸æ”¯æŒ Markdown, ç”¨äº†ä¸€æ®µæ—¶é—´ä¹Ÿæ”¾å¼ƒäº†.
æœ€è¿‘ python-cn åˆ—è¡¨é‡Œä¹Ÿåœ¨è®¨è®ºè¿™ä¸ªé—®é¢˜, çœ‹åˆ° â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;ä¸€ç›´åœ¨æ‰¾ä¸€ä¸ªåˆé€‚çš„çŸ¥è¯†ç®¡ç†å·¥å…·, ç”¨è¿‡ Evernote, ä½†æ˜¯ä¸æ”¯æŒ Markdown, ç”¨äº†ä¸€æ®µæ—¶é—´ä¹Ÿæ”¾å¼ƒäº†.
æœ€è¿‘ python-cn åˆ—è¡¨é‡Œä¹Ÿåœ¨è®¨è®ºè¿™ä¸ªé—®é¢˜, çœ‹åˆ°æœ‰äººä½¿ç”¨ Vimwiki, æ‰€ä»¥å°±å°è¯•äº†ä¸€ä¸‹.&lt;/p&gt;
&lt;p&gt;å®‰è£…å,è¯•ç€å†™äº†ç‚¹ä¸œè¥¿, å‘ç°å¾ˆæ–¹ä¾¿åšçŸ¥è¯†ç®¡ç†å’Œè®°å½•ç¬”è®°, å¯ä»¥ç”ŸæˆHTML, å¯ä»¥å®šåˆ¶æ¨¡æ¿,
è¿™é‡Œä¸è®¨è®ºå¦‚ä½•ä½¿ç”¨, Vimwiki çš„æ–‡æ¡£ä»‹ç»çš„å¾ˆè¯¦ç»†,&lt;/p&gt;
&lt;p&gt;æˆ‘ä½¿ç”¨&lt;a href="http://bootcss.com"&gt;bootstrap&lt;/a&gt;å’Œ jquery å¯¹æ¨¡æ¿è¿›è¡Œäº†ä¸€äº›å®šåˆ¶:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;æ·»åŠ å¯¼èˆª&lt;/li&gt;
&lt;li&gt;å°†tocç§»åŠ¨åˆ°å·¦ä¾§&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ä¸‹é¢å°†ä»‹ç»æˆ‘æ˜¯å¦‚ä½•åšçš„, å¹¶åœ¨æœ€åé™„ä¸Šå¦‚ä½•éƒ¨ç½²çš„&lt;/p&gt;
&lt;h3 id="_1"&gt;æŒ‡å®šæ¨¡æ¿&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆéœ€è¦æ›´æ”¹é»˜è®¤æ¨¡æ¿&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    &lt;span class="k"&gt;let&lt;/span&gt; &lt;span class="k"&gt;g&lt;/span&gt;:vimwiki_list &lt;span class="p"&gt;=&lt;/span&gt; [{&lt;span class="s1"&gt;&amp;#39;path&amp;#39;&lt;/span&gt;: &lt;span class="s1"&gt;&amp;#39;~/vimwiki&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    \    &lt;span class="s1"&gt;&amp;#39;path_html&amp;#39;&lt;/span&gt;: &lt;span class="s1"&gt;&amp;#39;~/vimwiki_html&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    \    &lt;span class="s1"&gt;&amp;#39;template_path&amp;#39;&lt;/span&gt;: &lt;span class="s1"&gt;&amp;#39;~/vimwiki/template&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    \    &lt;span class="s1"&gt;&amp;#39;template_default&amp;#39;&lt;/span&gt;: &lt;span class="s2"&gt;&amp;quot;default.tpl&amp;quot;&lt;/span&gt;}]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¹¶å°†é»˜è®¤çš„æ¨¡æ¿ä½œä¸ºæ¨¡æ¿è¿›è¡Œä¿®æ”¹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mkdir&lt;span class="w"&gt; &lt;/span&gt;-p&lt;span class="w"&gt; &lt;/span&gt;~/vimwiki/template
cp&lt;span class="w"&gt; &lt;/span&gt;~/.vim/bundle/vimwiki/autoload/vimwiki/default.tpl&lt;span class="w"&gt; &lt;/span&gt;~/vimwiki/template
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_2"&gt;æ·»åŠ é™æ€æ–‡ä»¶&lt;/h3&gt;
&lt;p&gt;å°†jqeuryå’Œbootstrapçš„jså’Œcssæ–‡ä»¶æ”¾åˆ° ~/vimwik_htmlç›®å½•ä¸‹,&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ç»Ÿä¸€ä¿®æ”¹å’Œå‘å¸ƒ Wiki, æˆ‘å°†é™æ€æ–‡ä»¶æ”¾åœ¨ ~/vimwiki çš„ static ç›®å½•ä¸‹, 
å¹¶åœ¨ ~/vimwiki_html åˆ›å»ºä¸€ä¸ªè½¯é“¾é“¾æ¥åˆ°è¿™ä¸ªç›®å½•, ä¸‹é¢æ˜¯æˆ‘ static ç›®å½•çš„ä¸€ä¸ªå¿«ç…§&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;tree&lt;span class="w"&gt; &lt;/span&gt;~/vimwiki/static&lt;span class="w"&gt; &lt;/span&gt;
~/vimwiki/static
â”œâ”€â”€&lt;span class="w"&gt; &lt;/span&gt;bootstrap
â”‚&lt;span class="w"&gt;Â Â  &lt;/span&gt;â”œâ”€â”€&lt;span class="w"&gt; &lt;/span&gt;css
â”‚&lt;span class="w"&gt;Â Â  &lt;/span&gt;â”‚&lt;span class="w"&gt;Â Â  &lt;/span&gt;â”œâ”€â”€&lt;span class="w"&gt; &lt;/span&gt;bootstrap.min.css
â”‚&lt;span class="w"&gt;Â Â  &lt;/span&gt;â”‚&lt;span class="w"&gt;Â Â  &lt;/span&gt;â””â”€â”€&lt;span class="w"&gt; &lt;/span&gt;bootstrap-theme.min.css
â”‚&lt;span class="w"&gt;Â Â  &lt;/span&gt;â”œâ”€â”€&lt;span class="w"&gt; &lt;/span&gt;fonts
â”‚&lt;span class="w"&gt;Â Â  &lt;/span&gt;â”‚&lt;span class="w"&gt;Â Â  &lt;/span&gt;â”œâ”€â”€&lt;span class="w"&gt; &lt;/span&gt;glyphicons-halflings-regular.eot
â”‚&lt;span class="w"&gt;Â Â  &lt;/span&gt;â”‚&lt;span class="w"&gt;Â Â  &lt;/span&gt;â”œâ”€â”€&lt;span class="w"&gt; &lt;/span&gt;glyphicons-halflings-regular.svg
â”‚&lt;span class="w"&gt;Â Â  &lt;/span&gt;â”‚&lt;span class="w"&gt;Â Â  &lt;/span&gt;â”œâ”€â”€&lt;span class="w"&gt; &lt;/span&gt;glyphicons-halflings-regular.ttf
â”‚&lt;span class="w"&gt;Â Â  &lt;/span&gt;â”‚&lt;span class="w"&gt;Â Â  &lt;/span&gt;â””â”€â”€&lt;span class="w"&gt; &lt;/span&gt;glyphicons-halflings-regular.woff
â”‚&lt;span class="w"&gt;Â Â  &lt;/span&gt;â””â”€â”€&lt;span class="w"&gt; &lt;/span&gt;js
â”‚&lt;span class="w"&gt;Â Â      &lt;/span&gt;â””â”€â”€&lt;span class="w"&gt; &lt;/span&gt;bootstrap.min.js
â”œâ”€â”€&lt;span class="w"&gt; &lt;/span&gt;css
â”‚&lt;span class="w"&gt;Â Â  &lt;/span&gt;â””â”€â”€&lt;span class="w"&gt; &lt;/span&gt;wiki.css
â””â”€â”€&lt;span class="w"&gt; &lt;/span&gt;js
&lt;span class="w"&gt;    &lt;/span&gt;â”œâ”€â”€&lt;span class="w"&gt; &lt;/span&gt;jquery-1.8.3.min.js
&lt;span class="w"&gt;    &lt;/span&gt;â””â”€â”€&lt;span class="w"&gt; &lt;/span&gt;wiki.js

&lt;span class="m"&gt;6&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;directories,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;files
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å…¶ä¸­&lt;code&gt;wiki.js&lt;/code&gt;å’Œ&lt;code&gt;wiki.css&lt;/code&gt;åˆ†åˆ«æ˜¯è‡ªå®šä¹‰çš„Javascriptå’ŒCSS
ç„¶ååœ¨~/vimwiki_htmlä¸­åˆ›å»ºé“¾æ¥&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;ln&lt;span class="w"&gt; &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;~/vimwiki/static&lt;span class="w"&gt; &lt;/span&gt;~/vimwiki_html/static
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_3"&gt;åœ¨æ¨¡æ¿ä¸­å¼•ç”¨é™æ€æ–‡ä»¶&lt;/h3&gt;
&lt;p&gt;ç»“åˆ &lt;code&gt;%root_path%&lt;/code&gt;æ¨¡æ¿å˜é‡å¼•å…¥é™æ€æ–‡ä»¶&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;link&lt;/span&gt; &lt;span class="na"&gt;rel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Stylesheet&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text/css&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%root_path%static/css/wiki.css&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;link&lt;/span&gt; &lt;span class="na"&gt;rel&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;Stylesheet&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text/css&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%root_path%static/bootstrap/css/bootstrap.min.css&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt; &lt;span class="na"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text/javascript&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;src&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%root_path%static/js/jquery-1.8.3.min.js&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt; &lt;span class="na"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text/javascript&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;src&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%root_path%static/bootstrap/js/bootstrap.min.js&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt; &lt;span class="na"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text/javascript&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;src&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%root_path%static/js/wiki.js&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_4"&gt;åˆ›å»ºå¯¼èˆª&lt;/h3&gt;
&lt;p&gt;æ ¹æ® Boostrap æ–‡æ¡£ä¸­çš„ä¾‹å­å¾ˆå®¹æ˜“å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªå¥½çœ‹çš„å¯¼èˆª&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;nav&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;navbar navbar-default navbar-inverse&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;role&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;navigation&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
 &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;container&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;navbar-header&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;button&lt;/span&gt; &lt;span class="na"&gt;data-target&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;.bs-navbar-collapse&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;data-toggle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;collapse&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;button&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;navbar-toggle&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;span&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;sr-only&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;span&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;span&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;icon-bar&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;span&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;span&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;icon-bar&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;span&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;span&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;icon-bar&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;span&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
      &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;button&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;navbar-brand&amp;quot;&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;/index.html&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;cold&amp;#39;s wiki&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;collapse navbar-collapse&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;ul&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;nav navbar-nav&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%root_path%index.html&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;é¦–é¡µ&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%root_path%diary/diary.html&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;æ—¥è®°&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
            &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt; &lt;span class="na"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;%root_path%TODO.html&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;TODO&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;a&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;li&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
        &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;ul&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
 &lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;nav&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åå°† content å˜é‡æ”¾åœ¨ 'contaniner' ä¸­&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt; &lt;span class="na"&gt;class&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;container content-body&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
    %content%
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;div&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="toc"&gt;æ›¿æ¢æ ·å¼å’Œå°† toc ç§»åŠ¨åˆ°å·¦ä¾§&lt;/h3&gt;
&lt;p&gt;æ›¿æ¢è¡¨æ ¼æ ·å¼&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;table&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;addClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;table table-bordered table-striped table-hover&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åå°† &lt;code&gt;toc&lt;/code&gt; ç§»åŠ¨åˆ°å³ä¾§, å¹¶ä½¿ç”¨ &lt;code&gt;affix&lt;/code&gt; æ•ˆæœ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;// ç”Ÿæˆå·¦ä¾§tocå¯¼èˆª&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.toc&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;html&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="nx"&gt;trim&lt;/span&gt;&lt;span class="p"&gt;()){&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;html&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.content-body&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;html&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;toc_html&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;lt;div class=&amp;quot;toc&amp;quot;&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.toc&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;html&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;lt;/div&amp;gt;&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;content&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;html&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;toc_html&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;html&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;lt;div class=&amp;quot;col-md-3&amp;quot;&amp;gt;\n&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nx"&gt;toc_html&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;\n&amp;lt;/div&amp;gt;\n&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nx"&gt;html&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;lt;div class=&amp;quot;col-md-9&amp;quot;&amp;gt;\n&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="nx"&gt;content&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;\n&amp;lt;/div&amp;gt;\n&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nx"&gt;html&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;html&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sr"&gt;/blockquote/g&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;pre&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.content-body&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;html&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;html&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.toc&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;addClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;bs-sidebar&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="cm"&gt;/* $(&amp;quot;.toc&amp;quot;).attr(&amp;quot;role&amp;quot;, &amp;quot;complementary&amp;quot;); */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.toc&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;attr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;data-spy&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;affix&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="cm"&gt;/* $(&amp;quot;.toc&amp;quot;).attr(&amp;quot;data-offset-top&amp;quot;, &amp;quot;200&amp;quot;) */&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;uls&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.toc&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;find&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ul&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;var&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;lt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;uls&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="o"&gt;++&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nx"&gt;ul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;uls&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="nx"&gt;i&lt;/span&gt;&lt;span class="p"&gt;];&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ul&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;parent&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.toc&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ul&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;parent&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;.toc&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nx"&gt;console&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;log&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ul&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;parent&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="nx"&gt;hasClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;toc&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;));&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ul&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;parent&lt;/span&gt;&lt;span class="p"&gt;().&lt;/span&gt;&lt;span class="nx"&gt;hasClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;toc&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ul&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;addClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;nav bs-sidenav&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;ul&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;addClass&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;nav&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®Œæ•´çš„&lt;a href="http://wiki.linuxzen.com/static/js/wiki.js"&gt;wiki.js&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="_5"&gt;è‡ªå®šä¹‰æ ·å¼&lt;/h2&gt;
&lt;p&gt;æˆ‘åŒæ—¶è¿˜ç”¨ Vimwiki åšTODOç®¡ç†, åŸæœ‰çš„æ ·å¼æ„Ÿè§‰æŒºä¸é”™çš„, å°±æ‹·è´äº†ä¸€ä»½, 
è¿˜æœ‰ä¸€ç‚¹æ˜¯ä» bootcss.com æ–‡æ¡£é¡µé¢æ‰’ä¸‹æ¥çš„,
å¯ä»¥åœ¨&lt;a href="http://wiki.linuxzen.com/static/css/wiki.css"&gt;è¿™é‡Œ&lt;/a&gt;çœ‹åˆ°.&lt;/p&gt;
&lt;h2 id="_6"&gt;éƒ¨ç½²&lt;/h2&gt;
&lt;p&gt;æˆ‘å°†æˆ‘çš„vimwikiä¸Šä¼ åˆ°äº† &lt;a href="https://bitbucket.org"&gt;bitbucket&lt;/a&gt;, ç„¶åæ·»åŠ äº†ä¸€ä¸ªå®šä¹‰æ›´æ–°çš„è„šæœ¬,
ä¸‹é¢æ˜¯è„šæœ¬å†…å®¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/sh&lt;/span&gt;
&lt;span class="nv"&gt;PWD&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/home/yourusername/vimwiki&amp;quot;&lt;/span&gt;
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$PWD&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
git&lt;span class="w"&gt; &lt;/span&gt;pull&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Allready up-to-date.&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&amp;gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/dev/null

&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$?&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-ne&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;then&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;vim&lt;span class="w"&gt; &lt;/span&gt;+VimwikiIndex&lt;span class="w"&gt; &lt;/span&gt;+VimwikiAll2HTML&lt;span class="w"&gt; &lt;/span&gt;+qa
&lt;span class="k"&gt;fi&lt;/span&gt;
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šé¢è„šæœ¬å‘½åä¸º &lt;code&gt;update.sh&lt;/code&gt; ä¿å­˜åœ¨ &lt;code&gt;~/vimwiki&lt;/code&gt; ä¸‹, é€šè¿‡ &lt;code&gt;crontab&lt;/code&gt; è¿›è¡Œå®šæ—¶è°ƒç”¨&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;crontab&lt;span class="w"&gt; &lt;/span&gt;-l
*/30&lt;span class="w"&gt; &lt;/span&gt;*&lt;span class="w"&gt; &lt;/span&gt;*&lt;span class="w"&gt; &lt;/span&gt;*&lt;span class="w"&gt; &lt;/span&gt;*&lt;span class="w"&gt; &lt;/span&gt;/bin/bash&lt;span class="w"&gt; &lt;/span&gt;/home/yourusername/vimwiki/update.sh&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/dev/null
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="disqus"&gt;ä½¿ç”¨ Disqus è¯„è®ºç³»ç»Ÿ&lt;/h3&gt;
&lt;p&gt;æˆ‘åœ¨ &lt;code&gt;template/default.tpl&lt;/code&gt; æ·»åŠ äº†ä»£ç æ¥ä½¿ç”¨ &lt;code&gt;Disqus&lt;/code&gt; è¯„è®ºç³»ç»Ÿ, è¿™é‡Œä¸åœ¨è¯¦è¿°&lt;/p&gt;
&lt;h3 id="wiki"&gt;å·²ç»ä¸Šçº¿çš„Wiki&lt;/h3&gt;
&lt;p&gt;å½“ç„¶ç°åœ¨æˆ‘å·²ç»éƒ¨ç½²äº†è‡ªå·±çš„wiki, çŒ›å‡»&lt;a href="http://wiki.linuxzen.com"&gt;è¿™é‡Œ&lt;/a&gt;è¿›å…¥&lt;/p&gt;
&lt;h3 id="_7"&gt;æ¥ä¸‹æ¥&lt;/h3&gt;
&lt;p&gt;ç°åœ¨wikiè¿˜æ²¡æœ‰ä»£ç é«˜äº®, æˆ‘ä¸æƒ³ä½¿ç”¨é‚£ä¸ªjsçš„é«˜äº®, æƒ³é€šè¿‡ &lt;code&gt;pygments&lt;/code&gt; æ¥åšä»£ç é«˜äº®,
æ‰€ä»¥æ¥ä¸‹æƒ³é€šè¿‡ &lt;code&gt;pygments&lt;/code&gt; å¯¹ä»£ç è¿›è¡Œé«˜äº®&lt;/p&gt;
&lt;h3 id="_8"&gt;å‚è€ƒ&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="http://www.berlinix.com/vim/vimwiki_with_bootstrap_jquery.php"&gt;ç”¨jQueryå’ŒBootstrapç¾åŒ–VimWikiè¾“å‡º&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="Vim"></category><category term="vim"></category><category term="vimwiki"></category><category term="wiki"></category><category term="çŸ¥è¯†"></category><category term="ç®¡ç†"></category><category term="git"></category></entry><entry><title>å°†Pelicanç‰ˆæœ¬æ›´æ–°åˆ°3.3</title><link href="https://www.linuxzen.com/jiang-pelicanban-ben-geng-xin-dao-33.html" rel="alternate"></link><published>2013-12-24T00:00:00+08:00</published><updated>2013-12-24T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-12-24:/jiang-pelicanban-ben-geng-xin-dao-33.html</id><summary type="html">&lt;p&gt;è®°å½•å‡çº§Pelicanåˆ°3.3çš„è¿‡ç¨‹å’Œä¸€äº›åæ§½,&lt;/p&gt;</summary><content type="html">&lt;p&gt;ç”¨Pelicanæœ‰ä¸€æ®µæ—¶é—´äº†, ç”±äºé‡è£…äº†ç³»ç»Ÿ, æ‰€ä»¥å®‰è£…&lt;code&gt;Pelican&lt;/code&gt;çš„æœ€æ–°ç‰ˆæœ¬,æœ€æ–°ç‰ˆæœ¬ä¸º &lt;code&gt;3.3&lt;/code&gt;, é¡ºä¾¿ä¹Ÿå‡çº§æ¨¡æ¿å’Œæ’ä»¶.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Pelican&lt;/code&gt;ç‰¹åˆ«å–œæ¬¢æ›´æ”¹é…ç½®æ–‡ä»¶,  è€Œä¸”é”™è¯¯æç¤ºéå¸¸çƒ‚, å®Œå…¨ä¸çŸ¥é“åœ¨è¯´ä»€ä¹ˆ, è€Œä¸”æ²¡æœ‰å®‰è£…markdownåŒ…çš„è¯æ ¹æœ¬ä¸æç¤º, ä»…ä»…å°±é”™è¯¯é€€å‡º, ä¸‹é¢å°±è¿™æ¬¡å‡çº§è¶Šåˆ°çš„é—®é¢˜åšä¸ªè®°å½•.&lt;/p&gt;
&lt;h2 id="makefile"&gt;Makefile&lt;/h2&gt;
&lt;p&gt;Pelicanå‡çº§åä¼šæœ‰å¾ˆå¤šè«åå¥‡å¦™çš„é—®é¢˜, é¦–å…ˆä¹‹å‰çš„&lt;code&gt;Makefile&lt;/code&gt;ä¸èƒ½ä½¿ç”¨, æ‰€ä»¥éœ€è¦é‡æ–°ç”Ÿæˆä¸€ä»½:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;pelican-quickstart .
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å½“ç„¶ä¸Šé¢æ“ä½œä¼šæ›´æ”¹é…ç½®æ–‡ä»¶, æˆ‘ç”¨gitç®¡ç†, æ‰€ä»¥å¾ˆæ–¹ä¾¿çš„&lt;code&gt;checkout&lt;/code&gt;, å¦‚æœä½ çš„ä¸æ˜¯, å…ˆå¤‡ä»½ä¸‹é…ç½®æ–‡ä»¶å§.&lt;/p&gt;
&lt;h2 id="atom-feed"&gt;ATOM Feed&lt;/h2&gt;
&lt;p&gt;ç„¶å&lt;code&gt;make html&lt;/code&gt;çš„æ—¶å€™å¤±è´¥æç¤º&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;File /path/to/project/output/feeds/all.atom.xml is to be overwritten!&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;çœ‹äº† &lt;a href="https://github.com/getpelican/pelican"&gt;pelican&lt;/a&gt;ä¸Šçš„&lt;code&gt;issue&lt;/code&gt; åŸæ¥æ˜¯æ›´æ”¹äº†&lt;code&gt;FEED_ATOM&lt;/code&gt;çš„é…ç½®é¡¹, ä½¿ç”¨äº† &lt;code&gt;FEED_ALL_ATOM&lt;/code&gt;é…ç½®é¡¹, å°†&lt;code&gt;FEED_ATOM&lt;/code&gt;é…ç½®é¡¹æ”¹ä¸º&lt;code&gt;FEED_ALL_ATOM&lt;/code&gt;é…ç½®å³å¯&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯æ”¹å®Œä¹‹åé¡µé¢çš„ATOM FEEDé“¾æ¥æ²¡æœ‰æŒ‡å‘æ­£ç¡®çš„åœ°å€, æŸ¥çœ‹æ¨¡æ¿æ–‡ä»¶, å‘ç°æ¨¡æ¿è¿˜åœ¨å¼•ç”¨&lt;code&gt;FEED_ATOM&lt;/code&gt;, æ”¹æˆ&lt;code&gt;FEED_ALL_ATOM&lt;/code&gt;å³å¯.&lt;/p&gt;
&lt;h2 id="markdown"&gt;Markdown&lt;/h2&gt;
&lt;p&gt;å¦‚æœè«åå¥‡å¦™çš„é”™è¯¯, æ²¡æœ‰é”™è¯¯ä¿¡æ¯, ä¹Ÿæ²¡æœ‰è¾“å‡ºHTML, é‚£ä¹ˆå¯èƒ½å°±æ˜¯&lt;code&gt;markdown&lt;/code&gt;åŒ…æ²¡è£…, &lt;code&gt;Pelican&lt;/code&gt;çš„é”™è¯¯æç¤ºçœŸå¿ƒæ— è¯­.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;easy_install -U markdown
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="markdown_1"&gt;Markdown ä»£ç é«˜äº®&lt;/h3&gt;
&lt;p&gt;Markdown æ˜¯é€šè¿‡æŒ‡å®š MD_EXTENSIONS é€‰é¡¹ç±»é…ç½®ä»£ç é«˜äº®çš„ä¹‹å‰é…ç½®è¿™æ ·å°±å¯ä»¥&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;MD_EXTENSIONS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;  &lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;codehilite&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;extra&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;fenced_code&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;tables&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;sane_lists&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä½†æ˜¯å‘ç°ç°åœ¨æ— æ³•é«˜äº®ä»£ç , æŸ¥çœ‹äº†æºç åŸæ¥è¦æ‰‹åŠ¨æŒ‡å®šé«˜äº® css, ä¸ç„¶cssä¼šè®¾ç½®æˆ
 codhilite 
 &lt;code&gt;python
MD_EXTENSIONS =  (['codehilite(css_class=highlight)', 'extra',
                   'fenced_code', 'tables', 'sane_lists'])&lt;/code&gt;&lt;/p&gt;
&lt;h2 id="_1"&gt;é™æ€æ–‡ä»¶&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Pelican&lt;/code&gt;å»æ‰äº†&lt;code&gt;FILE\_TO\_COPY&lt;/code&gt;é¡¹, æ‰€ä»¥ä¹‹å‰æ‹·è´&lt;code&gt;robots.txt&lt;/code&gt;ä¹‹ç±»çš„æ–‡ä»¶, å°±ä¼šå¤±æ•ˆ, ä½¿ç”¨&lt;code&gt;STATIC_PATHS&lt;/code&gt;å³å¯&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;STATIC_PATHS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;upload&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;extra/robots.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;extra/404.html&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœæƒ³æŒ‡å®šé™æ€æ–‡ä»¶ä½ç½®, å¯ä»¥ä½¿ç”¨&lt;code&gt;STATIC_SAVE_AS&lt;/code&gt;, ä¼šå°†é™æ€æ–‡ä»¶å­˜åˆ°å¦å¤–ä¸€ä¸ªç›®å½•,
è€Œä¸”å¯¹æ‰€æœ‰&lt;code&gt;STATIC_PATHS&lt;/code&gt;é¡¹ç”Ÿæ•ˆ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;STATIC_SAVE_AS = &amp;quot;static/&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¹Ÿå¯ä»¥ä½¿ç”¨ &lt;code&gt;EXTRA_PATH_METADATA&lt;/code&gt;æ¥ä¸ºæ¯ä¸€é¡¹æŒ‡å®šè·¯å¾„&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;EXTRA_PATH_METADATA = {
    &amp;quot;extra/robots.txt&amp;quot;:{&amp;quot;path&amp;quot;:&amp;quot;robots.txt&amp;quot;},
    &amp;quot;extra/404.html&amp;quot;: {&amp;quot;path&amp;quot;:&amp;quot;404.html&amp;quot;},
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è‡³æ­¤, &lt;code&gt;Pelican&lt;/code&gt;å‡çº§å®Œæ¯•&lt;/p&gt;</content><category term="Python"></category><category term="pelican3.3"></category><category term="å‡çº§"></category></entry><entry><title>PyQt + QML å¿«é€Ÿå¼€å‘GUIæ€»ç»“</title><link href="https://www.linuxzen.com/pyqt-qml-kuai-su-kai-fa-guizong-jie.html" rel="alternate"></link><published>2013-11-06T15:25:00+08:00</published><updated>2013-11-06T15:25:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-11-06:/pyqt-qml-kuai-su-kai-fa-guizong-jie.html</id><summary type="html">&lt;p&gt;æœ€è¿‘ç»“æŸä¸€ä¸ªä½¿ç”¨PyQt+QMLå¼€å‘çš„é¡¹ç›®, åœ¨æ­¤å¯¹ä¸€äº›ç»éªŒåšå‡ºæ€»ç»“åˆ†äº«å‡ºæ¥.
ç»“åˆQMLç¡®å®å¯ä»¥å¿«é€Ÿçš„æ„å»ºå‡ºGUIç¨‹åº, ä½†æ˜¯ç›¸å…³èµ„æ–™å¤ªå°‘, ç‰¹åˆ«æ˜¯ä¸­æ–‡èµ„æ–™,
è€Œä¸”å‘å¤ªå¤š, ç‰¹åˆ« â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;æœ€è¿‘ç»“æŸä¸€ä¸ªä½¿ç”¨PyQt+QMLå¼€å‘çš„é¡¹ç›®, åœ¨æ­¤å¯¹ä¸€äº›ç»éªŒåšå‡ºæ€»ç»“åˆ†äº«å‡ºæ¥.
ç»“åˆQMLç¡®å®å¯ä»¥å¿«é€Ÿçš„æ„å»ºå‡ºGUIç¨‹åº, ä½†æ˜¯ç›¸å…³èµ„æ–™å¤ªå°‘, ç‰¹åˆ«æ˜¯ä¸­æ–‡èµ„æ–™,
è€Œä¸”å‘å¤ªå¤š, ç‰¹åˆ«æ˜¯å’Œåç«¯PyQtç»“åˆçš„æ—¶å€™æœ‰å¾ˆå¤šè«åå¥‡å¦™çš„é—®é¢˜.
è¿™ç¯‡æ–‡ç« ä¼šæ€»ç»“è¿™äº›é—®é¢˜, é¿å…ä»¥åç¢°åˆ°æ— ä»ä¸‹æ‰‹.&lt;/p&gt;
&lt;p&gt;PS:QMLçš„ä¸€äº›åŸºç¡€é—®é¢˜ä¸ä¼šåœ¨è¿™é‡Œè®¨è®º, æœ¬ç¯‡æ–‡ç« ä»…è®¨è®ºä¸€äº›ç»éªŒæ€§çš„é—®é¢˜, æœ¬ç¯‡æ–‡ç« ä½¿ç”¨PyQt4&lt;/p&gt;
&lt;p&gt;&lt;em&gt;è¯·ç•™æ„æ–‡ç« ä¸­é—´çš„&amp;quot;æ³¨æ„&amp;quot;&lt;/em&gt;&lt;/p&gt;
&lt;div class="section" id="pyqt"&gt;
&lt;h2&gt;å¦‚ä½•å’ŒPyQtäº¤äº’&lt;/h2&gt;
&lt;p&gt;QMLå’ŒPyQtäº¤äº’ä¸»è¦æœ‰ä¸‰ç§æ–¹æ³•: PyQtæ¸²æŸ“æ•°æ®, ä¿¡å·ä¼ é€’, QMLæä¾›æ¥å£&lt;/p&gt;
&lt;div class="section" id="pyqtqml"&gt;
&lt;h3&gt;ä½¿ç”¨PyQtæ˜¾ç¤ºQML&lt;/h3&gt;
&lt;p&gt;è¦æƒ³åœ¨Pythoné‡Œä½¿ç”¨PyQtæ¥è°ƒç”¨QMLæ˜¾ç¤º, éœ€è¦ç”¨åˆ° &lt;tt class="docutils literal"&gt;PyQt4.QtDeclarative.QDeclarativeView&lt;/tt&gt; å®ä¾‹çš„ &lt;tt class="docutils literal"&gt;setSource&lt;/tt&gt; å°†ä¸€ä¸ª &lt;tt class="docutils literal"&gt;PyQt4.QtCore.QUrl&lt;/tt&gt; å¯¹è±¡ä¼ é€’è¿›å», ç„¶åè°ƒç”¨ &lt;tt class="docutils literal"&gt;PyQt4.QtDeclarative.QDeclarativeView&lt;/tt&gt; å¯¹è±¡çš„ &lt;tt class="docutils literal"&gt;show&lt;/tt&gt; æ–¹æ³•, ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4.QtDeclarative&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QDeclarativeView&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4.QtGui&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QApplication&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4.QtCore&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QUrl&lt;/span&gt;

&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QApplication&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;

&lt;span class="n"&gt;view&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QDeclarativeView&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setSource&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;QUrl&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/path/to/demo.qml&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exec_&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="pyqtqml-1"&gt;
&lt;h3&gt;é€šè¿‡PyQtæ¸²æŸ“æ•°æ®åˆ°QML&lt;/h3&gt;
&lt;p&gt;æ¸²æŸ“QMLå˜é‡æœ‰ä¸¤ç§æ–¹æ³•, ä¸€ç§æ˜¯QMLä¸­æ²¡æœ‰å®šä¹‰çš„å˜é‡, ä¸€ç§æ˜¯åœ¨QMLä¸­å·²ç»å®šä¹‰å¥½çš„å˜é‡,
ç¬¬ä¸€ç§æ˜¯é¢„å®šä¹‰å˜é‡, ç¬¬äºŒç§æ˜¯è®¾ç½®å˜é‡&lt;/p&gt;
&lt;div class="section" id="section-1"&gt;
&lt;h4&gt;é¢„å®šä¹‰å˜é‡&lt;/h4&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;PyQt4.QtDeclarative.QDeclarativeView&lt;/tt&gt; çš„ &lt;tt class="docutils literal"&gt;rootContext&lt;/tt&gt; æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªQMLä¸Šä¸‹æ–‡, é€šè¿‡è¿™ä¸ªå¯¹è±¡å¯ä»¥å¯¹QMLè¿›è¡Œä¸€äº›å˜é‡çš„é¢„å®šä¹‰&lt;/p&gt;
&lt;p&gt;&lt;em&gt;æ³¨æ„&lt;/em&gt;, é¢„å®šä¹‰å˜é‡å¿…é¡»åœ¨ &lt;tt class="docutils literal"&gt;setSource&lt;/tt&gt; è°ƒç”¨ä¹‹å‰è¿›è¡Œ, è¿˜æœ‰å¦‚æœæ˜¯å­—ç¬¦ä¸²ç±»å‹å¦‚è¦ä½¿ç”¨ &lt;tt class="docutils literal"&gt;PyQt4.QtCore.QString&lt;/tt&gt; è¿›è¡Œè½¬æ¢,
æ•°å­—å¯ä»¥ä¸ç”¨è½¬æ¢, å¦‚æœæ˜¯åˆ—è¡¨æˆ–å­—å…¸éœ€è¦ä½¿ç”¨ &lt;tt class="docutils literal"&gt;PyQt4.QtCore.QVariant&lt;/tt&gt; è¿›è¡Œè½¬æ¢, ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­:&lt;/p&gt;
&lt;p&gt;test.qml:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="nx"&gt;Qt&lt;/span&gt; &lt;span class="mf"&gt;4.7&lt;/span&gt;

&lt;span class="nx"&gt;Rectangle&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;id: test&lt;/span&gt;
    &lt;span class="k"&gt;width:&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;height:&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt;

    &lt;span class="nx"&gt;Text&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;anchors.fill:&lt;/span&gt;&lt;span class="nx"&gt;parent&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;text:&lt;/span&gt; &lt;span class="nx"&gt;textData&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;test.py:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4.QtDeclarative&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QDeclarativeView&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4.QtGui&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QApplication&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4.QtCore&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QUrl&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QString&lt;/span&gt;


&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QApplication&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;

&lt;span class="n"&gt;view&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QDeclarativeView&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;rootContext&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rootContext&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;rootContext&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setContextProperty&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;textData&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QString&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;hi&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setSource&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;QUrl&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;test.qml&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exec_&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å¦‚æœå°† &lt;tt class="docutils literal"&gt;rootContext&lt;/tt&gt; ä¸¤è¡Œç§»åˆ° &lt;tt class="docutils literal"&gt;view.setSource&lt;/tt&gt; ä¸‹é¢, QMLé‡Œå°†æ‰¾ä¸åˆ°å¯¹ &lt;tt class="docutils literal"&gt;textData&lt;/tt&gt; çš„å¼•ç”¨&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="section-2"&gt;
&lt;h4&gt;è®¾ç½®å˜é‡&lt;/h4&gt;
&lt;p&gt;å¦‚æœQMLé‡Œå·²ç»å®šä¹‰å¥½äº†å˜é‡, è€Œæˆ‘ä»¬å°±å¯ä»¥åœ¨PyQté‡Œå¯¹å®ƒè¿›è¡Œæ›´æ”¹, å¯¹QMLé‡Œçš„å˜é‡æ›´æ”¹éœ€è¦ä½¿ç”¨ &lt;tt class="docutils literal"&gt;PyQt4.QtDeclarative.QDeclarativeView&lt;/tt&gt; å¯¹è±¡çš„ &lt;tt class="docutils literal"&gt;rootObject&lt;/tt&gt; æ–¹æ³•è¿”å›çš„ &lt;tt class="docutils literal"&gt;rootObject&lt;/tt&gt; å¯¹è±¡, è°ƒç”¨ &lt;tt class="docutils literal"&gt;rootObject&lt;/tt&gt; å¯¹è±¡çš„ &lt;tt class="docutils literal"&gt;setProperty&lt;/tt&gt; æ–¹æ³•å³å¯å¯¹QMLé‡Œå˜é‡åšå‡ºæ›´æ”¹&lt;/p&gt;
&lt;p&gt;&lt;em&gt;æ³¨æ„&lt;/em&gt;, ä½¿ç”¨ &lt;tt class="docutils literal"&gt;rootObject&lt;/tt&gt; å¯¹QMLçš„æ›´æ”¹å¿…é¡»åœ¨ &lt;tt class="docutils literal"&gt;setSource&lt;/tt&gt; ä¹‹å, å¦åˆ™ &lt;tt class="docutils literal"&gt;rootObject&lt;/tt&gt; æ–¹æ³•å°†è¿”å› &lt;em&gt;None&lt;/em&gt;, ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­&lt;/p&gt;
&lt;p&gt;test.qml:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="nx"&gt;Qt&lt;/span&gt; &lt;span class="mf"&gt;4.7&lt;/span&gt;

&lt;span class="nx"&gt;Rectangle&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;id: test&lt;/span&gt;
    &lt;span class="nx"&gt;property&lt;/span&gt; &lt;span class="nx"&gt;string&lt;/span&gt; &lt;span class="nx"&gt;textData&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="k"&gt;width:&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;height:&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt;

    &lt;span class="nx"&gt;Text&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;anchors.fill:&lt;/span&gt;&lt;span class="nx"&gt;parent&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;text:&lt;/span&gt; &lt;span class="nx"&gt;textData&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;test.py:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4.QtDeclarative&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QDeclarativeView&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4.QtGui&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QApplication&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4.QtCore&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QUrl&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QString&lt;/span&gt;


&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QApplication&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;

&lt;span class="n"&gt;view&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QDeclarativeView&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setSource&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;QUrl&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;test.qml&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;rootObject&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rootObject&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;rootObject&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setProperty&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;textData&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QString&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;hi&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exec_&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸Šé¢ä¾‹å­æˆ‘ä»¬åœ¨QMLå®šä¹‰äº† &lt;tt class="docutils literal"&gt;textData&lt;/tt&gt; å˜é‡, å¹¶åœ¨ &lt;tt class="docutils literal"&gt;setSource&lt;/tt&gt; ä¹‹åä½¿ç”¨ &lt;tt class="docutils literal"&gt;rootObject&lt;/tt&gt; çš„ &lt;tt class="docutils literal"&gt;setProperty&lt;/tt&gt; å¯¹ &lt;tt class="docutils literal"&gt;textData&lt;/tt&gt; å˜é‡è¿›è¡Œäº†æ›´æ”¹&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="qml"&gt;
&lt;h3&gt;QMLä¿¡å·çš„ä¼ é€’&lt;/h3&gt;
&lt;p&gt;QMLæœ‰ä¿¡å·æœºåˆ¶, å¯ä»¥åœ¨QMLä¹‹é—´ä½¿ç”¨JavaScriptè¿›è¡Œè§¦å‘å’Œæ¥æ”¶, å½“ç„¶ä¹Ÿå¯ä»¥å°†ä¿¡å·ä¼ é€’ç»™åç«¯çš„PyQt,
æˆ‘ä»¬åœ¨æ­¤ä¸è®¨è®ºQMLå†…éƒ¨çš„ä¿¡å·, æˆ‘ä»¬ä»…è®¨è®ºQMLä¿¡å·ä¼ é€’åˆ°PyQtè¿™éƒ¨åˆ†, QMLä½¿ç”¨signalåˆ›å»ºä¿¡å·, ä¿¡å·å¯ä»¥æºå¸¦å‚æ•°,
ä½¿ç”¨è°ƒç”¨å‡½æ•°çš„æ–¹æ³•å¯ä»¥è§¦å‘ä¿¡å·, ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­:&lt;/p&gt;
&lt;p&gt;test.qml&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="nx"&gt;Qt&lt;/span&gt; &lt;span class="mf"&gt;4.7&lt;/span&gt;

&lt;span class="nx"&gt;Rectangle&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;id: test&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="nx"&gt;signal&lt;/span&gt; &lt;span class="nx"&gt;mclicked&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;   &lt;span class="c1"&gt;// å®šä¹‰ä¿¡å·&lt;/span&gt;

    &lt;span class="nx"&gt;Text&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;anchors.fill:&lt;/span&gt;&lt;span class="nx"&gt;parent&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;text:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Click Me&amp;quot;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="nx"&gt;MouseArea&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;onClicked:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;mclicked&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;  &lt;span class="c1"&gt;// è§¦å‘ä¿¡å·&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸Šé¢æˆ‘ä»¬å®šä¹‰äº†ä¸€ä¸ª &lt;tt class="docutils literal"&gt;mclicked&lt;/tt&gt; çš„ä¿¡å·, å¹¶ä¸”åœ¨ç‚¹å‡»æ—¶ä¼šè§¦å‘è¿™ä¸ªä¿¡å·, PyQt å¯ä»¥é€šè¿‡ &lt;tt class="docutils literal"&gt;rootObject&lt;/tt&gt; è·å–è¿™ä¸ªä¿¡å·, å¹¶ä¸ºè¿™ä¸ªä¿¡å·ç»‘å®šæ§½:&lt;/p&gt;
&lt;p&gt;test.py&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4.QtDeclarative&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QDeclarativeView&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4.QtGui&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QApplication&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4.QtCore&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QUrl&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QString&lt;/span&gt;


&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QApplication&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;

&lt;span class="n"&gt;view&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QDeclarativeView&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setSource&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;QUrl&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;test.qml&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;on_click&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;hi&amp;quot;&lt;/span&gt;

&lt;span class="n"&gt;rootObject&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rootObject&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;rootObject&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mclicked&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;on_click&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exec_&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸Šé¢ä¸ºQMLçš„ &lt;tt class="docutils literal"&gt;mclicked&lt;/tt&gt; ä¿¡å·ç»‘å®šäº†ä¸€ä¸ªå‡½æ•°, å½“ç‚¹å‡»QMLçª—ä½“æ—¶, æ§åˆ¶å°å°±ä¼šè¾“å‡º hi&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="qml-1"&gt;
&lt;h3&gt;QMLæä¾›æ¥å£&lt;/h3&gt;
&lt;p&gt;ä¸Šé¢æˆ‘ä»¬å®šä¹‰äº†ä¿¡å·, å¦‚æœå“åº”ä¿¡å·ä»…ä»…åœ¨æ§åˆ¶å°è¾“å‡ºæ²¡æœ‰æ„ä¹‰, æˆ‘ä»¬å¯ä»¥é€šè¿‡QMLåœ¨é¡¶çº§å…ƒç´ å®šä¹‰JavaScriptå‡½æ•°
å‘PyQtæä¾›æ¥å£, ä¸‹é¢æ˜¯ä¾‹å­:&lt;/p&gt;
&lt;p&gt;test.qml&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="nx"&gt;Qt&lt;/span&gt; &lt;span class="mf"&gt;4.7&lt;/span&gt;

&lt;span class="nx"&gt;Rectangle&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;id: test&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="nx"&gt;signal&lt;/span&gt; &lt;span class="nx"&gt;mclicked&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;   &lt;span class="c1"&gt;// å®šä¹‰ä¿¡å·&lt;/span&gt;

    &lt;span class="nx"&gt;Text&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;id: testText&lt;/span&gt;
        &lt;span class="k"&gt;anchors.fill:&lt;/span&gt;&lt;span class="nx"&gt;parent&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;text:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Click Me&amp;quot;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="nx"&gt;MouseArea&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;onClicked:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;mclicked&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;  &lt;span class="c1"&gt;// è§¦å‘ä¿¡å·&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;set_text&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;text&lt;/span&gt;&lt;span class="p"&gt;){&lt;/span&gt;
        &lt;span class="nx"&gt;testText&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;text&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸Šé¢æˆ‘ä»¬åœ¨QMLé¡¶çº§å…ƒç´ å®šä¹‰äº†ä¸€ä¸ª &lt;tt class="docutils literal"&gt;set_text&lt;/tt&gt; å‡½æ•°, æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ &lt;tt class="docutils literal"&gt;rootObject&lt;/tt&gt; è¿›è¡Œè°ƒç”¨&lt;/p&gt;
&lt;p&gt;test.py&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4.QtDeclarative&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QDeclarativeView&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4.QtGui&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QApplication&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4.QtCore&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QUrl&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QString&lt;/span&gt;


&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QApplication&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;

&lt;span class="n"&gt;view&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QDeclarativeView&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setSource&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;QUrl&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;test.qml&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;on_click&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;rootObject&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_text&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Clicked&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;rootObject&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;rootObject&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;rootObject&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mclicked&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;on_click&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;view&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exec_&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸Šé¢æˆ‘ä»¬ç”¨å“åº”ä¿¡å·çš„æ§½, é€šè¿‡ &lt;tt class="docutils literal"&gt;rootObject&lt;/tt&gt; è°ƒç”¨QMLæä¾›çš„å‡½æ•°æ¥å£, å½“ç‚¹å‡»çª—ä½“æ—¶, æ˜¾ç¤ºæ–‡å­—ä¼šä» &lt;tt class="docutils literal"&gt;Click Me&lt;/tt&gt; å˜æˆ &lt;tt class="docutils literal"&gt;Clicked&lt;/tt&gt;,
å½“ç„¶è¿™ä»…ä»…æ˜¯ä¸ªä¾‹å­, è¿™ç§å“åº”å¯ä»¥åœ¨QMLé‡Œç›´æ¥å®Œæˆ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="nx"&gt;Qt&lt;/span&gt; &lt;span class="mf"&gt;4.7&lt;/span&gt;

&lt;span class="nx"&gt;Rectangle&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;id: test&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="nx"&gt;signal&lt;/span&gt; &lt;span class="nx"&gt;mclicked&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;   &lt;span class="c1"&gt;// å®šä¹‰ä¿¡å·&lt;/span&gt;

    &lt;span class="nx"&gt;Text&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;id: testText&lt;/span&gt;
        &lt;span class="k"&gt;anchors.fill:&lt;/span&gt;&lt;span class="nx"&gt;parent&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;text:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Click Me&amp;quot;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="nx"&gt;MouseArea&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;onClicked:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;mclicked&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;  &lt;span class="c1"&gt;// è§¦å‘ä¿¡å·&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="kd"&gt;function&lt;/span&gt; &lt;span class="nx"&gt;set_text&lt;/span&gt;&lt;span class="p"&gt;(){&lt;/span&gt;
        &lt;span class="nx"&gt;testText&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Clicked&amp;quot;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="k"&gt;Component.onCompleted :&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="nx"&gt;mclicked&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nx"&gt;set_text&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;  &lt;span class="c1"&gt;// åœ¨åŠ è½½å®Œæˆåä¸ºmclickedä¿¡å·ç»‘å®šæ§½&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="section-3"&gt;
&lt;h2&gt;ä¸€äº›å‘&lt;/h2&gt;
&lt;div class="section" id="qml-2"&gt;
&lt;h3&gt;QMLå…¨éƒ¨å˜é‡å†…éƒ¨çŠ¶æ€æ›´æ”¹&lt;/h3&gt;
&lt;p&gt;QMLå®šä¹‰ä½¿ç”¨ &lt;tt class="docutils literal"&gt;property&lt;/tt&gt; å®šä¹‰çš„å˜é‡æ˜¯å…¨å±€çš„, è¿™äº›å˜é‡æ˜¯æ— æ³•å¯¹å…¶å†…éƒ¨çŠ¶æ€è¿›è¡Œæ›´æ”¹çš„,
å½“ç„¶æ•°å­—å’Œå­—ç¬¦ä¸²æ²¡æœ‰è¿™æ–¹é¢é—®é¢˜, ä½†æ˜¯æ•°ç»„å’Œå¯¹è±¡çš„æ›´æ”¹å°±ä¸è¡Œ, æ¯”å¦‚ä¸‹é¢çš„æ›´æ”¹æ˜¯æ— æ•ˆçš„&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="nx"&gt;Qt&lt;/span&gt; &lt;span class="mf"&gt;4.7&lt;/span&gt;

&lt;span class="nx"&gt;Rectangle&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;id: test&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nx"&gt;property&lt;/span&gt; &lt;span class="nx"&gt;variant&lt;/span&gt; &lt;span class="k"&gt;testData:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;a&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;b&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;2&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="nx"&gt;Repeater&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;model:&lt;/span&gt;&lt;span class="nx"&gt;testData&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

        &lt;span class="nx"&gt;Text&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;text:&lt;/span&gt; &lt;span class="nx"&gt;modelData&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="nx"&gt;MouseArea&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;id: testArea&lt;/span&gt;
        &lt;span class="nx"&gt;anchors&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;fill&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;onClicked:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="nx"&gt;testData&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;0&amp;quot;&lt;/span&gt;
            &lt;span class="nx"&gt;testData&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;1&amp;quot;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸Šé¢æ˜¯æ— æ³•æ›´æ”¹testDataçš„å†…éƒ¨çŠ¶æ€çš„, è§£å†³åŠæ³•æ˜¯å…ˆå°†å…¨å±€å˜é‡èµ‹å€¼ç»™å±€éƒ¨å˜é‡, æ›´æ”¹å®Œæ¯•åè¦†ç›–å…¨å±€å˜é‡&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="nx"&gt;Qt&lt;/span&gt; &lt;span class="mf"&gt;4.7&lt;/span&gt;

&lt;span class="nx"&gt;Rectangle&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;id: test&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nx"&gt;property&lt;/span&gt; &lt;span class="nx"&gt;variant&lt;/span&gt; &lt;span class="k"&gt;testData:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;a&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;b&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;2&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="nx"&gt;Repeater&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;model:&lt;/span&gt;&lt;span class="nx"&gt;testData&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

        &lt;span class="nx"&gt;Text&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;text:&lt;/span&gt; &lt;span class="nx"&gt;modelData&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;

    &lt;span class="nx"&gt;MouseArea&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;id: testArea&lt;/span&gt;
        &lt;span class="nx"&gt;anchors&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;fill&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;onClicked:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="kd"&gt;var&lt;/span&gt; &lt;span class="nx"&gt;tmp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;testData&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;  &lt;span class="c1"&gt;// èµ‹å€¼ç»™å±€éƒ¨å˜é‡&lt;/span&gt;
            &lt;span class="nx"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;0&amp;quot;&lt;/span&gt;
            &lt;span class="nx"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;1&amp;quot;&lt;/span&gt;
            &lt;span class="nx"&gt;testData&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nx"&gt;tmp&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸Šé¢å³å¯æˆåŠŸæ›´æ”¹ &lt;tt class="docutils literal"&gt;testData&lt;/tt&gt; çš„å†…éƒ¨çŠ¶æ€&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="section-4"&gt;
&lt;h3&gt;ç©ºåˆ—è¡¨å¼•å‘çš„æ®µé”™è¯¯&lt;/h3&gt;
&lt;p&gt;ä»PyQtå‘QMLä¸­æ¸²æŸ“æ•°æ®, éš¾å…ä¼šæ¸²æŸ“ç©ºåˆ—è¡¨, ä½†æ˜¯è¿™åœ¨æŸäº›å¹³å°(Windows)ä¼šå¼•å‘æ®µé”™è¯¯, æå¾—äººè«åå…¶å¦™,
è§£å†³åŠæ³•å°±æ˜¯å°†ç©ºåˆ—è¡¨è½¬æ¢ä¸º &lt;em&gt;None&lt;/em&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="section-5"&gt;
&lt;h2&gt;ä¸€äº›æŠ€å·§&lt;/h2&gt;
&lt;div class="section" id="js"&gt;
&lt;h3&gt;ç»“åˆjs&lt;/h3&gt;
&lt;p&gt;ç»™å…ƒç´ çš„å±æ€§èµ‹å€¼æ˜¯å¯ä»¥ä½¿ç”¨jsè¯­å¥çš„, å½“ç„¶å¤æ‚çš„è¯­å¥å¯ä»¥å†™æˆå‡½æ•°,æŒ‡å®šè¿™ä¸ªå‡½æ•°, ä½¿ç”¨å‡½æ•°çš„è¿”å›å€¼,
ä¸‹é¢æ˜¯ä¸€ä¸ªéš”è¡Œå˜è‰²çš„ä¾‹å­:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="nx"&gt;Qt&lt;/span&gt; &lt;span class="mf"&gt;4.7&lt;/span&gt;

&lt;span class="nx"&gt;Rectangle&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;width:&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;height:&lt;/span&gt; &lt;span class="mi"&gt;400&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
    &lt;span class="nx"&gt;Repeater&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="k"&gt;model:&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="nx"&gt;Rectangle&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
            &lt;span class="k"&gt;width:&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;height:&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
            &lt;span class="k"&gt;color:&lt;/span&gt; &lt;span class="nx"&gt;index&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt; &lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;blue&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;black&amp;quot;&lt;/span&gt;
        &lt;span class="p"&gt;}&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="section-6"&gt;
&lt;h3&gt;è‡ªå®šä¹‰å…ƒç´ &lt;/h3&gt;
&lt;p&gt;å¤šå¤„éƒ½ä½¿ç”¨çš„å†…å®¹, å¯ä»¥æå–å‡ºæ¥æ”¾åœ¨ä¸€ä¸ªä»¥å¤§å†™å¼€å¤´çš„æ–‡ä»¶åçš„æ–‡ä»¶é‡Œ, ç„¶ååŒç›®å½•ä½¿ç”¨æ–‡ä»¶åå°±å¯ä»¥å¼•ç”¨è¿™ä¸ªå…ƒç´ ,
å…¶ä»–ç›®å½•å¯ä»¥ä½¿ç”¨ &lt;tt class="docutils literal"&gt;import&lt;/tt&gt; å¯¼å…¥è¿™ä¸ªç›®å½•(ç›¸å¯¹è·¯å¾„å¯¼å…¥), å°±å¯ä»¥ä½¿ç”¨ç›®å½•é‡Œçš„å…ƒç´ äº†,&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚æˆ‘åœ¨ &lt;tt class="docutils literal"&gt;Demo.qml&lt;/tt&gt;  å®šä¹‰äº†ä¸€äº›å†…å®¹,  åŒç›®å½•æˆ–å¯¼å…¥è¿™ä¸ªç›®å½•çš„å…¶ä»–QMLæ–‡ä»¶æˆ‘å°±å¯ä»¥ç›´æ¥ä½¿ç”¨ &lt;tt class="docutils literal"&gt;Demo&lt;/tt&gt; å…ƒç´ äº†&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="section-7"&gt;
&lt;h3&gt;è‡ªå®šä¹‰å…ƒç´ å±æ€§&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†æ›´å¥½çš„å¯é‡ç”¨, å®šä¹‰ä¸€äº›å±æ€§æ˜¯å¿…é¡»çš„ å¯ä»¥ç”¨é€šè¿‡  &lt;tt class="docutils literal"&gt;property alias source:target&lt;/tt&gt; å®šä¹‰å±æ€§åˆ«å, å½“åˆ«äººå¼•ç”¨
è¿™ä¸ªå…ƒç´ , å¹¶åœ¨å…ƒç´ å†…å®šä¹‰ &lt;tt class="docutils literal"&gt;source&lt;/tt&gt; å±æ€§, å°±ä¼šè‡ªåŠ¨æ˜ å°„åˆ° &lt;tt class="docutils literal"&gt;target&lt;/tt&gt; ä¸Š, ä¸‹é¢æ˜¯ä¸€ä¸ªä¾‹å­&lt;/p&gt;
&lt;p&gt;Demo.qml&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="nx"&gt;Qt&lt;/span&gt; &lt;span class="mf"&gt;4.7&lt;/span&gt;

&lt;span class="nx"&gt;Rectangle&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;id: demo&lt;/span&gt;
    &lt;span class="k"&gt;width:&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;height:&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="nx"&gt;property&lt;/span&gt; &lt;span class="nx"&gt;alias&lt;/span&gt; &lt;span class="k"&gt;text:&lt;/span&gt; &lt;span class="nx"&gt;demoText&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="nx"&gt;text&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="nx"&gt;Text&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;id: demoText&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;text:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Demo&amp;quot;&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;test.qml&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="nx"&gt;Qt&lt;/span&gt; &lt;span class="mf"&gt;4.7&lt;/span&gt;

&lt;span class="nx"&gt;Demo&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;text:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Nice Demo&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä½¿ç”¨qmlviwer æŸ¥çœ‹ test.qml, ä¼šæ˜¾ç¤º &amp;quot;Nice Demo&amp;quot; æ–‡å­—&lt;/p&gt;
&lt;p&gt;å½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥åœ¨è‡ªå®šä¹‰å…ƒç´ ä½¿ç”¨ &lt;tt class="docutils literal"&gt;property&lt;/tt&gt; å®šä¹‰å˜é‡, åœ¨ä½¿ç”¨è¯¥å…ƒç´ æ—¶å®šä¹‰è¯¥å±æ€§:&lt;/p&gt;
&lt;p&gt;Demo.qml&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="nx"&gt;Qt&lt;/span&gt; &lt;span class="mf"&gt;4.7&lt;/span&gt;

&lt;span class="nx"&gt;Rectangle&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="kd"&gt;id: demo&lt;/span&gt;
    &lt;span class="k"&gt;width:&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="k"&gt;height:&lt;/span&gt; &lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="nx"&gt;property&lt;/span&gt; &lt;span class="nx"&gt;string&lt;/span&gt; &lt;span class="k"&gt;textData:&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Demo&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

    &lt;span class="nx"&gt;Text&lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="kd"&gt;id: demoText&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
        &lt;span class="k"&gt;text:&lt;/span&gt; &lt;span class="nx"&gt;textData&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;test.qml&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kr"&gt;import&lt;/span&gt; &lt;span class="nx"&gt;Qt&lt;/span&gt; &lt;span class="mf"&gt;4.7&lt;/span&gt;

&lt;span class="nx"&gt;Demo&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="k"&gt;textData:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Nice Demo&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</content><category term="PyQt"></category><category term="QML"></category><category term="PyQt"></category><category term="Gui"></category><category term="Python"></category><category term="Qt"></category></entry><entry><title>æ¨èå‡ æ¬¾æœ€è¿‘å‘ç°éå¸¸é…·çš„Vimæ’ä»¶</title><link href="https://www.linuxzen.com/tui-jian-ji-kuan-zui-jin-fa-xian-fei-chang-ku-de-vimcha-jian.html" rel="alternate"></link><published>2013-10-18T13:14:00+08:00</published><updated>2013-10-18T13:14:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-10-18:/tui-jian-ji-kuan-zui-jin-fa-xian-fei-chang-ku-de-vimcha-jian.html</id><summary type="html">&lt;p&gt;æœ€è¿‘çœ‹ä¸€ä¸ªgithubä¸Šçš„Vimé…ç½®, å‘ç°äº†å‡ æ¬¾éå¸¸é…·è€Œä¸”éå¸¸æœ‰ç”¨çš„Vimæ’ä»¶:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;delimitMate
ç”¨äºè¡¥å…¨æ‹¬å·å’Œå¼•å·&lt;/li&gt;
&lt;li&gt;vim-surround
ç”¨äºå¿«é€Ÿåˆ‡æ¢æ‹¬å·/å¼•å·æˆ–è€…æ ‡ç­¾&lt;/li&gt;
&lt;li&gt;GitGutter
å®æ—¶ â€¦&lt;/li&gt;&lt;/ul&gt;</summary><content type="html">&lt;p&gt;æœ€è¿‘çœ‹ä¸€ä¸ªgithubä¸Šçš„Vimé…ç½®, å‘ç°äº†å‡ æ¬¾éå¸¸é…·è€Œä¸”éå¸¸æœ‰ç”¨çš„Vimæ’ä»¶:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;delimitMate
ç”¨äºè¡¥å…¨æ‹¬å·å’Œå¼•å·&lt;/li&gt;
&lt;li&gt;vim-surround
ç”¨äºå¿«é€Ÿåˆ‡æ¢æ‹¬å·/å¼•å·æˆ–è€…æ ‡ç­¾&lt;/li&gt;
&lt;li&gt;GitGutter
å®æ—¶æ˜¾ç¤ºgitæ›´æ”¹&lt;/li&gt;
&lt;li&gt;Gitv
æŸ¥çœ‹Gitè¯¦ç»†æäº¤æ—¥å¿—(ç±»ä¼¼gitk)&lt;/li&gt;
&lt;li&gt;vim-commentary
Vimæ‰¹é‡æ³¨é‡Šå·¥å…·, å¯ä»¥æ³¨é‡Šå¤šè¡Œå’Œå»é™¤å¤šè¡Œæ³¨é‡Š&lt;/li&gt;
&lt;li&gt;indentLine
æ›´åŠ ç¾è§‚çš„æ˜¾ç¤ºç¼©è¿›å¯¹é½çº¿&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å…ˆæ”¾ä¸Šå½•å±:&lt;/p&gt;
&lt;div style="width:800; height: 500"&gt;
    &lt;script type="text/javascript" src="http://asciinema.org/a/5981.js" id="asciicast-5981" async&gt;&lt;/script&gt;
&lt;/div&gt;&lt;div class="section" id="section-1"&gt;
&lt;h2&gt;å®‰è£…&lt;/h2&gt;
&lt;p&gt;ä¸Šé¢æ’ä»¶å¯ä»¥é€šè¿‡ Vundle æ¥å®‰è£… (äº†è§£VundleçŒ›å‡» &lt;a class="reference external" href="http://www.linuxzen.com/vimpei-zhi-xi-lie-cha-jian-guan-li.html"&gt;è¿™é‡Œ&lt;/a&gt;), ä¸‹é¢æ˜¯ &lt;tt class="docutils literal"&gt;.vimrc&lt;/tt&gt; çš„é…ç½®&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;Bundle &lt;span class="s2"&gt;&amp;quot;Yggdroot/indentLine&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;airblade/vim-gitgutter&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;gregsexton/gitv&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;tpope/vim-commentary&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;tpope/vim-surround&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;Raimondi/delimitMate&amp;quot;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ç„¶åé‡æ–°æ‰“å¼€ Vim, æ‰§è¡Œ &lt;tt class="docutils literal"&gt;:BundleIntall&lt;/tt&gt; ç­‰å¾…å®‰è£…å®Œæˆ&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="section-2"&gt;
&lt;h2&gt;é…ç½®ä½¿ç”¨&lt;/h2&gt;
&lt;p&gt;delimitMateå’ŒGitGutterå®‰è£…å®Œæˆä¸ç”¨ä»»ä½•é…ç½®å³å¯ä½¿ç”¨, ä¸‹é¢æˆ‘ä»¬å…ˆä»‹ç» &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;vim-surround&lt;/span&gt;&lt;/tt&gt; æ’ä»¶çš„ä½¿ç”¨&lt;/p&gt;
&lt;div class="section" id="vim-surround"&gt;
&lt;h3&gt;vim-surround&lt;/h3&gt;
&lt;p&gt;è¿™ä¸ªæ’ä»¶å¯ä»¥å¿«é€Ÿçš„ä¸ºå­—ç¬¦ä¸²åŒ…å›´/æ”¹å˜æˆ–å»é™¤å¼•å·/æ‹¬å·æˆ–è€…HTMLæ ‡ç­¾&lt;/p&gt;
&lt;div class="section" id="section-3"&gt;
&lt;h4&gt;ä¸ºå•ä¸ªå•è¯åŒ…å›´&lt;/h4&gt;
&lt;p&gt;åœ¨å‘½ä»¤æ¨¡å¼ä¸‹, ä½¿ç”¨ &lt;tt class="docutils literal"&gt;ysiw&lt;/tt&gt; + &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;'/&amp;quot;/(/[/{&lt;/span&gt;&lt;/tt&gt; å°±å¯ä»¥ä¸ºå…‰æ ‡ä¸‹çš„ä¸€ä¸ªå•è¯åŒ…å›´ä¸Š &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;'/&amp;quot;/(/[/{&lt;/span&gt;&lt;/tt&gt;&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ &lt;tt class="docutils literal"&gt;ysiw'&lt;/tt&gt; ä¸ºå…‰æ ‡ä¸‹çš„å•è¯åŒ…å›´ä¸Šå•å¼•å·, &lt;tt class="docutils literal"&gt;ysiw&amp;quot;&lt;/tt&gt; ä¸ºå…‰æ ‡ä¸‹å•è¯åŒ…å›´ä¸ŠåŒå¼•å·, ä¾æ­¤ç±»æ¨.&lt;/p&gt;
&lt;p&gt;vim-surround åŒæ—¶è¿˜æ”¯æŒåŒ…å›´htmlæ ‡ç­¾, å°†å…‰æ ‡æ”¾åˆ°æŸå•è¯è¯•è¯•ä¸‹é¢æŒ‡ä»¤&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;ysiw&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
ysiw&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;p&lt;/span&gt; class&lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;meta&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="section-4"&gt;
&lt;h4&gt;åŒ…å›´ä¸€è¡Œ&lt;/h4&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;yssb&lt;/tt&gt; å¯ä»¥å¿«é€Ÿä¸ºä¸€è¡ŒåŒ…å›´åœ†æ‹¬å·,  &lt;tt class="docutils literal"&gt;yss&lt;/tt&gt; + &lt;tt class="docutils literal"&gt;&lt;span class="pre"&gt;'/&amp;quot;/(/[/{&lt;/span&gt;&lt;/tt&gt; å¯ä»¥ä¸ºæ­£è¡Œå¿«é€ŸåŒ…å›´ç›¸åº”çš„å¼•å·/æ‹¬å·&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ &lt;tt class="docutils literal"&gt;yss&amp;quot;&lt;/tt&gt;  ä¸ºä¸€è¡ŒåŒ…å›´åŒå¼•å·&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="section-5"&gt;
&lt;h4&gt;æ›´æ”¹åŒ…å›´&lt;/h4&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;cs&lt;/tt&gt; æŒ‡ä»¤å¯ä»¥æ›´æ”¹åŒ…å›´, æ¯”å¦‚ &lt;tt class="docutils literal"&gt;cs'&amp;quot;&lt;/tt&gt; æ˜¯å°†å•å¼•å·å˜æˆåŒå¼•å·, &lt;tt class="docutils literal"&gt;cs&amp;quot;(&lt;/tt&gt; æ˜¯å°†åŒå¼•å·å˜æˆåœ†æ‹¬å·&lt;/p&gt;
&lt;p&gt;vim-surroundæ”¯æŒå°†æ‹¬å·æˆ–è€…å¼•å·å˜æ›´ä¸ºhtmlæ ‡ç­¾, è¯•è¯•ä¸‹é¢å‘½ä»¤&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="k"&gt;cs&lt;/span&gt;&amp;#39;&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;p&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸Šé¢å‘½ä»¤å°†å•å¼•å·æ¢æˆ &lt;tt class="docutils literal"&gt;&amp;lt;p&amp;gt;&lt;/tt&gt; æ ‡ç­¾&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="section-6"&gt;
&lt;h4&gt;å»é™¤åŒ…å›´&lt;/h4&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;ds&lt;/tt&gt; æŒ‡ä»¤å¯ä»¥å–å‡ºåŒ…å›´, åé¢éœ€è·ŸåŒ…å›´çš„å†…å®¹, &lt;tt class="docutils literal"&gt;ds&amp;quot;&lt;/tt&gt; æ˜¯å»é™¤åŒå¼•å·åŒ…å›´, ``&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="indentline"&gt;
&lt;h3&gt;indentLine&lt;/h3&gt;
&lt;p&gt;è¿™ä¸ªæ’ä»¶å®‰è£…æˆåŠŸåå°±ä¼šæ˜¾ç¤ºç¼©è¿›å¯¹é½çº¿, æˆ‘ä»¬ä»…ä»…åœ¨ &lt;tt class="docutils literal"&gt;.vimrc&lt;/tt&gt; é‡ŒåŠ ä¸€è¡Œæ¥åˆ‡æ¢æ˜¯å¦æ˜¾ç¤º&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;map &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;leader&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;&lt;span class="k"&gt;il&lt;/span&gt; :IndentLinesToggle&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;CR&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ &lt;tt class="docutils literal"&gt;&amp;lt;leader&amp;gt; il&lt;/tt&gt; (æˆ‘çš„leaderæ˜ å°„çš„,)æ¥åˆ‡æ¢æ˜¯å¦æ˜¾ç¤ºå¯¹é½çº¿&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="gitv"&gt;
&lt;h3&gt;Gitv&lt;/h3&gt;
&lt;p&gt;Gitv å®ç°äº†å¯ä»¥ç”¨Vimæ¥æŸ¥çœ‹Gitçš„è¯¦ç»†æäº¤ä¿¡æ¯, åªéœ€è¦æ‰“å¼€Vim æ‰§è¡Œ &lt;tt class="docutils literal"&gt;:Gitv&lt;/tt&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="vim-commentary"&gt;
&lt;h3&gt;vim-commentary&lt;/h3&gt;
&lt;p&gt;è¿™ä¸ªæ’ä»¶å¯ä»¥å¿«é€Ÿæ³¨é‡Šä¸åæ³¨é‡Šå¤šè¡Œå†…å®¹, ä½†æ˜¯å®ƒçš„æ³¨é‡Šç¬¦ä½¿ç”¨çš„æ˜¯ &lt;tt class="docutils literal"&gt;commentstring&lt;/tt&gt;, é»˜è®¤æ˜¯ &lt;tt class="docutils literal"&gt;/* %s */&lt;/tt&gt;, ä½†è¿™ä¸ªå€¼æ»¡è¶³ä¸äº†Python å’Œ Shellè¿™æ ·çš„è¯­è¨€,
åœ¨ &lt;tt class="docutils literal"&gt;.vimrc&lt;/tt&gt; æ·»åŠ å¦‚ä¸‹å†…å®¹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;autocmd &lt;span class="nb"&gt;FileType&lt;/span&gt; python&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="k"&gt;shell&lt;/span&gt; &lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nb"&gt;commentstring&lt;/span&gt;&lt;span class="p"&gt;=&lt;/span&gt;#\ %s                 &lt;span class="c"&gt;&amp;quot; è®¾ç½®Pythonæ³¨é‡Šå­—ç¬¦&lt;/span&gt;
autocmd &lt;span class="nb"&gt;FileType&lt;/span&gt; mako &lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nb"&gt;cms&lt;/span&gt;&lt;span class="p"&gt;=&lt;/span&gt;##\ %s
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;Visual&lt;/tt&gt; æ¨¡å¼ä¸‹ &lt;tt class="docutils literal"&gt;gc&lt;/tt&gt; å‘½ä»¤å¯ä»¥æ³¨é‡Šé€‰ä¸­çš„è¡Œ&lt;/p&gt;
&lt;p&gt;æ™®é€šæ¨¡å¼ä¸‹  &lt;tt class="docutils literal"&gt;gcc&lt;/tt&gt; æŒ‡ä»¤å¯ä»¥å¿«é€Ÿæ³¨é‡Šä¸€è¡Œ&lt;/p&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;gcu&lt;/tt&gt; å¯ä»¥æ’¤é”€æ³¨é‡Š&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="section-7"&gt;
&lt;h2&gt;æœ€å&lt;/h2&gt;
&lt;p&gt;æœ‰ä»€ä¹ˆæ²¡ä»‹ç»åˆ°çš„å¤§å®¶å¯ä»¥çœ‹çœ‹å¸®åŠ©, å¤§å®¶ä¹Ÿå¯ä»¥å›´è§‚è¿™ä¸ªå¼ºå¤§Vimé…ç½®: &lt;a class="reference external" href="https://github.com/liangxianzhe/dotvim"&gt;https://github.com/liangxianzhe/dotvim&lt;/a&gt;&lt;/p&gt;
&lt;/div&gt;
</content><category term="Vim"></category><category term="Vim"></category><category term="æ’ä»¶"></category><category term="é…·"></category><category term="ç¼©è¿›å¯¹é½çº¿"></category><category term="Git"></category><category term="surround"></category><category term="delimitMate"></category></entry><entry><title>Vim ç›¸å¯¹è¡Œå·</title><link href="https://www.linuxzen.com/vim-xiang-dui-xing-hao.html" rel="alternate"></link><published>2013-10-09T14:50:00+08:00</published><updated>2013-10-09T14:50:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-10-09:/vim-xiang-dui-xing-hao.html</id><summary type="html">&lt;p class="first last"&gt;å¤§å®¶åœ¨ç”¨Vimæ—¶æ˜¯å¦ä¼šé‡åˆ°æƒ³å¤åˆ¶å¤šè¡Œæˆ–è€…æƒ³å¿«é€Ÿå‘ä¸‹/å‘ä¸Šç§»åŠ¨å¤šè¡Œæ—¶è€Œä¸çŸ¥é“è¡Œæ•°çš„æƒ…å†µ, ç›¸å¯¹è¡Œå·å°†å¸®åŠ©ä½ è½»æ˜“çš„å®Œæˆç±»ä¼¼çš„ä»»åŠ¡&lt;/p&gt;
</summary><content type="html">&lt;p&gt;åœ¨ä½¿ç”¨ç”¨Vimæ—¶æ—¶å¸¸ä¼šé‡åˆ°åƒå¤åˆ¶å¤šè¡Œæˆ–è€…æƒ³å¿«é€Ÿå‘ä¸‹/å‘ä¸Šç§»åŠ¨å¤šè¡Œæ—¶è€Œä¸çŸ¥é“è¡Œæ•°çš„æƒ…å†µ, ä»Šå¤©å‘ç°ä¸€ä¸ªVimå¯¹æ­¤æœ‰å¸®åŠ©çš„ç‰¹æ€§: &lt;strong&gt;ç›¸å¯¹è¡Œå·&lt;/strong&gt;.
ç›¸å¯¹è¡Œå·å°†ä¼šåœ¨æ¯è¡Œå‰æ˜¾ç¤ºç›¸å¯¹äºå…‰æ ‡æ‰€åœ¨è¡Œçš„è¡Œå·, ç›¸å¯¹è¡Œå·ä½ ç»™å‡ºæŸäº›å‚ç›´ç§»åŠ¨å‘½ä»¤æ—¶éœ€è¦çš„è®¡æ•°å€¼&lt;/p&gt;
&lt;p&gt;åœ¨ &lt;tt class="docutils literal"&gt;Vim 7.4&lt;/tt&gt; ä¹‹å‰çš„ç‰ˆæœ¬, å¯ç”¨ç›¸å¯¹è¡Œå·å½“å‰è¡Œå·å°†å˜ä¸º0, æ— æ³•æ˜¾ç¤ºæ­£å¸¸çš„è¡Œå·, åœ¨ &lt;tt class="docutils literal"&gt;Vim 7.4&lt;/tt&gt; ä¸­åˆ™å¯ä»¥æ­£å¸¸çš„æ˜¾ç¤ºå½“å‰è¡Œå·çš„åŒæ—¶æ¥æ˜¾ç¤ºç›¸å¯¹è¡Œå·, ä¸‹é¢æœ‰ä¸¤å¼ å›¾å¯ä»¥å¯¹æ¯”&lt;/p&gt;
&lt;p&gt;Vim 7.3&lt;/p&gt;
&lt;img alt="Vim 7.3" src="/static/upload/vim_rn_pre_74.png" /&gt;
&lt;p&gt;Vim 7.4&lt;/p&gt;
&lt;img alt="Vim 7.3" src="/static/upload/vim_rn_74.png" /&gt;
&lt;p&gt;ä»ä¸Šé¢çš„å›¾ç‰‡çœ‹æ¥, å¯ç”¨ç›¸å¯¹è¡Œå·åå¯ä»¥å¾ˆç›´è§‚çš„çœ‹åˆ°å½“å‰è¡Œè·ç¦»ä¸Šé¢/ä¸‹é¢æŸè¡Œçš„è¡Œæ•°&lt;/p&gt;
&lt;p&gt;å¯ä»¥ä½¿ç”¨ä»¥ä¸‹æŒ‡ä»¤å¯ç”¨è¿™ä¸ªç‰¹æ€§&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;set relativenumber
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;å¯ç”¨ç›¸å¯¹è¡Œå·åå†ä¹Ÿä¸ç”¨ä¸ºäº†å¤åˆ¶å¤šè¡Œè´¹åŠ›æ°”çš„å»æ•°äº†, so easy!&lt;/p&gt;
</content><category term="Vim"></category><category term="Vim"></category><category term="ç›¸å¯¹"></category><category term="è¡Œå·"></category></entry><entry><title>PyQt4 ä¿¡å·å’Œæ§½è¯¦è§£</title><link href="https://www.linuxzen.com/pyqt4-xin-hao-he-cao-xiang-jie.html" rel="alternate"></link><published>2013-09-22T10:10:00+08:00</published><updated>2013-09-22T10:10:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-09-22:/pyqt4-xin-hao-he-cao-xiang-jie.html</id><summary type="html">&lt;p class="first last"&gt;æœ€è¿‘åœ¨å¼€å‘ä¸€ä¸ªåŸºäº &lt;tt class="docutils literal"&gt;PyQt4&lt;/tt&gt; çš„çš„ GUIç¨‹åº, ä½¿ç”¨è¿‡ç¨‹ä¸­ä¸€äº›å¯¹ä¿¡å·å’Œæ§½çš„ç†è§£åˆ†äº«ç»™å¤§å®¶&lt;/p&gt;
</summary><content type="html">&lt;p&gt;Python å¯ä»¥å¼€å‘GUIæœ‰å¾ˆå¤šåº“å¯ä»¥é€‰æ‹©, ä¹‹å‰ä½¿ç”¨è¿‡ &lt;tt class="docutils literal"&gt;wxPython&lt;/tt&gt;, å·²ç»å¾ˆé•¿æ—¶é—´æ²¡ç”¨è¿‡, åŸºæœ¬éƒ½å¿˜å…‰äº†, ç”±äºå•ä½ä¹Ÿä½¿ç”¨ &lt;tt class="docutils literal"&gt;PyQt&lt;/tt&gt; , ä¹‹å‰ç†Ÿæ‚‰é¡¹ç›®æ—¶çœ‹è¿‡ä¸€æ®µæ—¶é—´, ä½†æ˜¯ç”±äºæ²¡æœ‰å®é™…é¡¹ç›®ç»éªŒ, æ‰€ä»¥ &lt;tt class="docutils literal"&gt;PyQt&lt;/tt&gt; å¾ˆç”Ÿç–, æœ€è¿‘æ­£å¥½ç»™å®¶é‡Œå†™ä¸ªå°çš„è´¢åŠ¡è½¯ä»¶ç»ƒç»ƒæ‰‹. åœ¨ç”¨çš„è¿‡ç¨‹ä¸­å¯¹ &lt;tt class="docutils literal"&gt;PyQt&lt;/tt&gt; ç†Ÿæ‚‰ä¸å°‘, ä¹‹å‰è§‰å¾— &lt;tt class="docutils literal"&gt;PyQt&lt;/tt&gt; æœ€éš¾æŒæ¡çš„å°±æ˜¯ &lt;tt class="docutils literal"&gt;ä¿¡å·&lt;/tt&gt; å’Œ &lt;tt class="docutils literal"&gt;æ§½&lt;/tt&gt; , æ‰€ä»¥ç°åœ¨å…ˆæ¥è®¨è®ºè¿™ä¸ª&lt;/p&gt;
&lt;div class="section" id="section-1"&gt;
&lt;h2&gt;æ¦‚è§ˆ&lt;/h2&gt;
&lt;p&gt;ä¿¡å·å’Œæ§½å¯ä»¥è¯´æ˜¯ &lt;tt class="docutils literal"&gt;Qt&lt;/tt&gt; çš„ç²¾é«“æ‰€åœ¨, æœ‰äº›ç±»ä¼¼ Javascript çš„äº‹ä»¶å“åº”æœºåˆ¶, æ‰€ä»¥å’±å…ˆä»¥ &lt;tt class="docutils literal"&gt;JQuery&lt;/tt&gt; æ¥åšä¸ªç¤ºä¾‹, åœ¨ &lt;tt class="docutils literal"&gt;JQuery&lt;/tt&gt; ä¸­æˆ‘ä»¬è·å–ä¸€ä¸ªå…ƒç´ , å¹¶ä¸”ç»‘å®šä¸€ä¸ªäº‹ä»¶, ä¼ é€’ä¸€ä¸ªåŒ¿åå‡½æ•°æ¥å“åº”è¯¥äº‹ä»¶&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="cm"&gt;&amp;lt;!-- éœ€å¯¼å…¥ jquery åº“ --&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;button&lt;/span&gt; &lt;span class="na"&gt;id&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;test&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;ç‚¹æˆ‘&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;button&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt; &lt;span class="na"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;text/javascript&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nx"&gt;$&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;#test&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;).&lt;/span&gt;&lt;span class="nx"&gt;click&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kd"&gt;function&lt;/span&gt;&lt;span class="p"&gt;(){&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nx"&gt;alert&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ç‚¹ç–¼æˆ‘äº†!!!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;)};&lt;/span&gt;
&lt;span class="p"&gt;&amp;lt;/&lt;/span&gt;&lt;span class="nt"&gt;script&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä»¥ä¸Šä»£ç , å½“ç‚¹å‡»æŒ‰é’® &lt;tt class="docutils literal"&gt;ç‚¹æˆ‘&lt;/tt&gt; æ—¶ä¼šå¼¹å‡ºä¸€ä¸ªå¯¹è¯æ¡†, è¿™å°±æ˜¯å“åº”äº†ç‚¹å‡»äº‹ä»¶.&lt;/p&gt;
&lt;p&gt;ä¿¡å·å’Œæ§½æœ‰ç€ç±»ä¼¼çš„æœºåˆ¶, &lt;tt class="docutils literal"&gt;QObject.connect&lt;/tt&gt; å¯ä»¥è¿æ¥ä¸€ä¸ª &lt;tt class="docutils literal"&gt;QObject&lt;/tt&gt; çš„ä¿¡å·åˆ°å¦ä¸€ä¸ª &lt;tt class="docutils literal"&gt;QObject&lt;/tt&gt; çš„æ§½, &lt;tt class="docutils literal"&gt;PyQt&lt;/tt&gt; åŒæ—¶å¯ä»¥å°†ä¿¡å·è¿æ¥åˆ°ä¸€ä¸ª &lt;tt class="docutils literal"&gt;callback&lt;/tt&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;

&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QApplication&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;

&lt;span class="n"&gt;w&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QWidget&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;showMsg&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QMessageBox&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;information&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ä¿¡æ¯&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ok&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;btn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QPushButton&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ç‚¹æˆ‘&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;btn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGNAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;clicked()&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;showMsg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exec_&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸Šé¢ä¾‹å­å°†ä¸€ä¸ª button å¯¹è±¡çš„ &lt;tt class="docutils literal"&gt;clicked()&lt;/tt&gt; ä¿¡å·è¿æ¥åˆ° &lt;tt class="docutils literal"&gt;showMsg&lt;/tt&gt; å‡½æ•°. ä¹Ÿå°±æ˜¯è¯´ &lt;tt class="docutils literal"&gt;ShowMsg&lt;/tt&gt; å“åº”äº†ä¸€ä¸ªæŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶.&lt;/p&gt;
&lt;p&gt;PyQt æœ‰ä¸€ç§ç±»ä¼¼ &lt;tt class="docutils literal"&gt;JQuery&lt;/tt&gt; å“åº”äº‹ä»¶çš„æ–¹å¼, æ¥è¿æ¥ä¿¡å·å’Œæ§½&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;

&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QApplication&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;

&lt;span class="n"&gt;w&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QWidget&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;showMsg&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QMessageBox&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;information&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ä¿¡æ¯&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ok&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;btn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QPushButton&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ç‚¹æˆ‘&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;btn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clicked&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;showMsg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;   &lt;span class="c1"&gt;# XXX æ­¤å¤„ä¸ä¸Šé¢ä¾‹å­ä¸åŒ&lt;/span&gt;

&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exec_&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="section-2"&gt;
&lt;h2&gt;ä¿¡å·&lt;/h2&gt;
&lt;p&gt;è¦æƒ³äº†è§£ä¿¡å·çš„æœ¬è´¨, æˆ‘ä»¬éœ€è¦äº†è§£ä¿¡å·çš„åˆ›å»ºå’Œ &lt;tt class="docutils literal"&gt;QObject.emit&lt;/tt&gt; æ–¹æ³•, &lt;tt class="docutils literal"&gt;emit&lt;/tt&gt; æ–¹æ³•ç”¨æ¥å‘å°„ä¿¡å·&lt;/p&gt;
&lt;div class="section" id="section-3"&gt;
&lt;h3&gt;å®šä¹‰ä¿¡å·&lt;/h3&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;PyQt4.QtCore.pyqtSignal&lt;/tt&gt; å‡½æ•°å¯ä»¥ä¸º &lt;tt class="docutils literal"&gt;QObject&lt;/tt&gt; åˆ›å»ºä¸€ä¸ªä¿¡å·&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MyButton&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QPushButton&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;myclicked&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pyqtSignal&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸Šé¢ä¾‹å­ä¸º &lt;tt class="docutils literal"&gt;MyButton&lt;/tt&gt; åˆ›å»ºäº†ä¸€ä¸ª &lt;tt class="docutils literal"&gt;myclicked()&lt;/tt&gt; çš„ä¿¡å·&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="section-4"&gt;
&lt;h3&gt;å¸¦å‚æ•°çš„ä¿¡å·&lt;/h3&gt;
&lt;p&gt;ä¿¡å·å¯ä»¥æºå¸¦å‚æ•°, å¹¶åœ¨å‘å°„ä¿¡å·æ—¶æºå¸¦ä¼ é€’ç»™æ§½&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MyButton&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QPushButton&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;myclicked&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pyqtSignal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸Šé¢ä¾‹å­å®šä¹‰äº† &lt;tt class="docutils literal"&gt;myclicked(int)&lt;/tt&gt; ä¿¡å·, å¯ä»¥æºå¸¦ä¸€ä¸ª, å‘å°„æ—¶ä¿¡å·æ—¶å¯ä»¥æºå¸¦ä¸€ä¸ªæ•´æ•°&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="section-5"&gt;
&lt;h3&gt;å‘å°„ä¿¡å·&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†å‘å°„æˆ‘ä»¬è‡ªå®šä¹‰çš„ä¿¡å·, æˆ‘ä»¬å¯¹ &lt;tt class="docutils literal"&gt;QPushButton&lt;/tt&gt; è¿›è¡Œä¸€ä¸‹å°è£…, è‡ªåŠ¨ç»‘å®š &lt;tt class="docutils literal"&gt;clicked()&lt;/tt&gt; ä¿¡å·, å¹¶å‘å°„è‡ªå®šä¹‰çš„ä¿¡å·&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MyButton&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QPushButton&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;myclicked&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pyqtSignal&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QPushButton&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGNAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;clicked()&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;myclicked&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;emit&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QApplication&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;

&lt;span class="n"&gt;w&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QWidget&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;showMsg&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QMessageBox&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;information&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ä¿¡æ¯&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ok&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;btn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MyButton&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ç‚¹æˆ‘&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;btn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGNAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;myclicked()&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;showMsg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exec_&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸Šé¢æˆ‘ä»¬å°è£…äº† &lt;tt class="docutils literal"&gt;QPushButton&lt;/tt&gt; è®©ä»–åœ¨æ”¶åˆ°ç‚¹å‡»ä¿¡å·æ—¶åŒæ—¶å‘é€ &lt;tt class="docutils literal"&gt;myclicked()&lt;/tt&gt; ä¿¡å·.&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ä¹Ÿå¯ä»¥ä¸å®šä¹‰ä¿¡å·, ç›´æ¥å‘é€ä¿¡å·, ä¸Šé¢çš„ä¾‹å­ä¹Ÿå¯ä»¥è¿™ä¹ˆå†™&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MyButton&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QPushButton&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QPushButton&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGNAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;clicked()&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;emitClicked&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;emitClicked&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;emit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGNAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;myclicked()&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;


&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QApplication&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;

&lt;span class="n"&gt;w&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QWidget&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;showMsg&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QMessageBox&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;information&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ä¿¡æ¯&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ok&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="n"&gt;btn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MyButton&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ç‚¹æˆ‘&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;btn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGNAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;myclicked()&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;showMsg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exec_&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸Šé¢ä¾‹å­æˆ‘ä»¬æ²¡æœ‰å®šä¹‰ä¿¡å·, ä»…ä»…æ˜¯åœ¨å“åº” &lt;tt class="docutils literal"&gt;clicked()&lt;/tt&gt; ä¿¡å·çš„å‡½æ•°å†…ç›´æ¥å‘é€ &lt;tt class="docutils literal"&gt;myclicked()&lt;/tt&gt; ä¿¡å·&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="section-6"&gt;
&lt;h3&gt;å‘å°„å¸¦å‚æ•°çš„ä¿¡å·&lt;/h3&gt;
&lt;p&gt;æœ‰æ—¶æˆ‘ä»¬å±•ç¤ºäº†ä¸€ä¸ªåˆ—è¡¨, å¹¶æƒ³æä¾›æŸ¥çœ‹æŸé¡¹åˆ—è¡¨çš„è¯¦ç»†å†…å®¹, æˆ‘ä»¬ä¼šåœ¨åˆ—è¡¨é¡¹çš„æœ«ç«¯åŠ ä¸€ä¸ªæŸ¥çœ‹æŒ‰é’®, è¿™æ—¶æˆ‘ä»¬å¦‚ä½•åœ¨æŒ‰æŒ‰é’®çš„æ—¶å€™å¾—çŸ¥è¿™æ˜¯é‚£ä¸€é¡¹å‘¢? è¿™æ—¶å°±éœ€è¦å¸¦å‚æ•°çš„ä¿¡å·,  ä¿¡å·æ˜¯å¯ä»¥å¸¦å‚æ•°çš„, å‚æ•°ä¼šåœ¨ä¿¡å·å‘é€æ—¶æºå¸¦, å¹¶ä¼ é€’ç»™æ¥æ”¶æ­¤ä¿¡å·çš„æ§½&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MyButton&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QPushButton&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;myclicked&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pyqtSignal&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QPushButton&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;_id&lt;/span&gt;

        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGNAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;clicked()&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;emitMyclicked&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;emitMyclicked&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;myclicked&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;emit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QApplication&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;

&lt;span class="n"&gt;w&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QWidget&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;resize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;showMsg&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_id&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QMessageBox&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;information&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ä¿¡æ¯&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;æŸ¥çœ‹ &lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;_id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="n"&gt;btn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MyButton&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;æŸ¥çœ‹1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;btn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGNAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;myclicked(int)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;showMsg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;btn2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MyButton&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;æŸ¥çœ‹2&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;btn2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;move&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;btn2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGNAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;myclicked(int)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;showMsg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exec_&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸Šé¢ä¾‹å­å¯ä»¥çœ‹å‡º, &lt;tt class="docutils literal"&gt;QObject.emit&lt;/tt&gt; å‘é€å¸¦å‚æ•°çš„ä¿¡å·æ—¶è¦æºå¸¦å‚æ•°. å½“ç„¶ä¸Šé¢ä¾‹å­ä¹Ÿå¯ä»¥ç”¨ä¸‹é¢æ–¹å¼æ¥å†™&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MyButton&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QPushButton&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_id&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;_id&lt;/span&gt;
        &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QPushButton&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGNAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;clicked()&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;emitClicked&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;emitClicked&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;emit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGNAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;myclicked(int)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QApplication&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;

&lt;span class="n"&gt;w&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QWidget&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;resize&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;showMsg&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_id&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QMessageBox&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;information&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ä¿¡æ¯&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;æŸ¥çœ‹ &lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;_id&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="n"&gt;btn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MyButton&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;æŸ¥çœ‹1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;btn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGNAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;myclicked(int)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;showMsg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;btn2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MyButton&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;æŸ¥çœ‹2&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;btn2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;move&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;btn2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGNAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;myclicked(int)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;showMsg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;w&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exec_&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class="section" id="section-7"&gt;
&lt;h2&gt;æ§½&lt;/h2&gt;
&lt;p&gt;æˆ‘ä¸€å¼€å§‹å­¦ä¹  PyQt çš„ä¿¡å·å’Œæ§½çš„æ—¶å€™çœ‹åˆ°é‚£ä¸ª &lt;a class="reference external" href="http://jimmykuu.sinaapp.com/static/PyQt4_Tutorial/html/events_and_signals.html#id1"&gt;æ»‘å—çš„ä¾‹å­&lt;/a&gt;  ä¸€ç›´æçš„æˆ‘å¾ˆè¿·ç³Š, ä¸çŸ¥æ‰€ä»¥, ä¹Ÿæ²¡å­¦ä¼šæ€ä¹ˆç”¨.
è¿™é‡Œå’±å°±è‡ªå·±åˆ›å»ºä¸€ä¸ªæ§½, å°±èƒ½äº†è§£ä»€ä¹ˆæ˜¯æ§½å’Œæ§½è¯¥æ€ä¹ˆç”¨.&lt;/p&gt;
&lt;p&gt;ä¸Šé¢æˆ‘ä»¬ä¸€ç›´ä½¿ç”¨ &lt;tt class="docutils literal"&gt;å‡½æ•°&lt;/tt&gt; (callback)ä½œä¸ºæ§½, ä¸‹é¢æˆ‘ä»¬æ¥ä»‹ç»ä½¿ç”¨ &lt;cite&gt;çœŸæ­£&lt;/cite&gt; çš„æ§½&lt;/p&gt;
&lt;div class="section" id="section-8"&gt;
&lt;h3&gt;åˆ›å»ºæ§½&lt;/h3&gt;
&lt;p&gt;&lt;tt class="docutils literal"&gt;QtCore.pyqtSlot&lt;/tt&gt; å‡½æ•°è¿”å›ä¸€ä¸ª &lt;tt class="docutils literal"&gt;è£…é¥°å™¨&lt;/tt&gt; ç”¨äºè£…é¥° &lt;tt class="docutils literal"&gt;QObject&lt;/tt&gt; çš„æ–¹æ³•, ä½¿ä¹‹æˆä¸ºä¸€ä¸ªæ§½(æˆ‘å¼€å§‹ä¸€ç›´ä»¥ä¸º &lt;tt class="docutils literal"&gt;QObject&lt;/tt&gt; çš„ä¸€ä¸ªæ–¹æ³•å°±æ˜¯ä¸€ä¸ªæ§½ å›§rz), ä¸‹é¢ä¾‹å­æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªæ§½&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;MainWidget&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QWidget&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QWidget&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


        &lt;span class="n"&gt;btn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QPushButton&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ç‚¹æˆ‘&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;btn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SIGNAL&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;clicked()&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                     &lt;span class="n"&gt;QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SLOT&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;onClicked()&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;

    &lt;span class="nd"&gt;@QtCore&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pyqtSlot&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;onClicked&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QMessageBox&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;information&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ä¿¡æ¯&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;ç”±æ§½å¼¹å‡º&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QtGui&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;QApplication&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
&lt;span class="n"&gt;m&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MainWidget&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;show&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exec_&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;ä¸Šé¢ä¾‹å­æˆ‘ä»¬ä¸º &lt;tt class="docutils literal"&gt;MainWidget&lt;/tt&gt; åˆ›å»ºäº†ä¸€ä¸ªæ§½, å¹¶å°† &lt;tt class="docutils literal"&gt;btn&lt;/tt&gt; çš„ &lt;tt class="docutils literal"&gt;clicked()&lt;/tt&gt; ä¿¡å·è¿æ¥åˆ°è¿™ä¸ªæ§½&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡æ‰€æœ‰ä¾‹å­éƒ½æ˜¯ç»è¿‡æµ‹è¯•å¯ä»¥è¿è¡Œçš„, æ‰€ä»¥å¤§å®¶å¦‚æœå¯¹ä¿¡å·å’Œæ§½è¿˜æ˜¯æœ‰ç‚¹è¿·ç³Šä¸å¦¨å°†ä¾‹å­ä¸­çš„ä»£ç æ•²ä¸€ä¸‹å¹¶è¿è¡Œ, å»ºè®®æ”¹æ”¹ä¾‹å­, è§£ç­”è‡ªå·±çš„ç–‘æƒ‘&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
</content><category term="PyQt"></category><category term="PyQt4"></category><category term="ä¿¡å·"></category><category term="æ§½"></category><category term="Qt"></category><category term="Python"></category><category term="GUI"></category></entry><entry><title>Linux ä¸‹ Python å®ç°æŒ‰ä»»æ„é”®é€€å‡º</title><link href="https://www.linuxzen.com/linux-xia-python-shi-xian-an-ren-yi-jian-tui-chu.html" rel="alternate"></link><published>2013-08-20T09:54:00+08:00</published><updated>2013-08-20T09:54:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-08-20:/linux-xia-python-shi-xian-an-ren-yi-jian-tui-chu.html</id><summary type="html">&lt;p&gt;åˆå­¦Pythonæ—¶åœ¨æ€»æƒ³å®ç°ä¸€ä¸ªæŒ‰ä»»æ„é”®ç»§ç»­/é€€å‡ºçš„ç¨‹åº(å—.batæ¯’å®³), å¥ˆä½•ä¸€ç›´å†™ä¸å‡ºæ¥, æœ€è¿‘å­¦ä¹ Unix Cæ—¶å‘ç°å¯ä»¥é€šè¿‡&lt;code&gt;termios.h&lt;/code&gt;åº“æ¥å®ç°, å°è¯•ä¸€ä¸‹å‘ç°Pythonä¹Ÿæœ‰è¿™ä¸ªåº“, æ‰€ä»¥ç»ˆäºå†™å‡ºä¸€ä¸ªè¿™æ ·çš„ç¨‹åº â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;åˆå­¦Pythonæ—¶åœ¨æ€»æƒ³å®ç°ä¸€ä¸ªæŒ‰ä»»æ„é”®ç»§ç»­/é€€å‡ºçš„ç¨‹åº(å—.batæ¯’å®³), å¥ˆä½•ä¸€ç›´å†™ä¸å‡ºæ¥, æœ€è¿‘å­¦ä¹ Unix Cæ—¶å‘ç°å¯ä»¥é€šè¿‡&lt;code&gt;termios.h&lt;/code&gt;åº“æ¥å®ç°, å°è¯•ä¸€ä¸‹å‘ç°Pythonä¹Ÿæœ‰è¿™ä¸ªåº“, æ‰€ä»¥ç»ˆäºå†™å‡ºä¸€ä¸ªè¿™æ ·çš„ç¨‹åº. ä¸‹é¢æ˜¯ä»£ç :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c1"&gt;# -*- coding:utf-8 -*-&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;termios&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;press_any_key_exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# è·å–æ ‡å‡†è¾“å…¥çš„æè¿°ç¬¦&lt;/span&gt;
    &lt;span class="n"&gt;fd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fileno&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="c1"&gt;# è·å–æ ‡å‡†è¾“å…¥(ç»ˆç«¯)çš„è®¾ç½®&lt;/span&gt;
    &lt;span class="n"&gt;old_ttyinfo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;termios&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tcgetattr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# é…ç½®ç»ˆç«¯&lt;/span&gt;
    &lt;span class="n"&gt;new_ttyinfo&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;old_ttyinfo&lt;/span&gt;&lt;span class="p"&gt;[:]&lt;/span&gt;

    &lt;span class="c1"&gt;# ä½¿ç”¨éè§„èŒƒæ¨¡å¼(ç´¢å¼•3æ˜¯c_lflag ä¹Ÿå°±æ˜¯æœ¬åœ°æ¨¡å¼)&lt;/span&gt;
    &lt;span class="n"&gt;new_ttyinfo&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;=&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;termios&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ICANON&lt;/span&gt;
    &lt;span class="c1"&gt;# å…³é—­å›æ˜¾(è¾“å…¥ä¸ä¼šè¢«æ˜¾ç¤º)&lt;/span&gt;
    &lt;span class="n"&gt;new_ttyinfo&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;=&lt;/span&gt; &lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="n"&gt;termios&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ECHO&lt;/span&gt;

    &lt;span class="c1"&gt;# è¾“å‡ºä¿¡æ¯&lt;/span&gt;
    &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdout&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="c1"&gt;# ä½¿è®¾ç½®ç”Ÿæ•ˆ&lt;/span&gt;
    &lt;span class="n"&gt;termios&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tcsetattr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;termios&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TCSANOW&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;new_ttyinfo&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="c1"&gt;# ä»ç»ˆç«¯è¯»å–&lt;/span&gt;
    &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# è¿˜åŸç»ˆç«¯è®¾ç½®&lt;/span&gt;
    &lt;span class="n"&gt;termios&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tcsetattr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;termios&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;TCSANOW&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;old_ttyinfo&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;press_any_key_exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;æŒ‰ä»»æ„é”®ç»§ç»­...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;press_any_key_exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;æŒ‰ä»»æ„é”®é€€å‡º...&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å…¶ä»–å…³äº&lt;code&gt;termios&lt;/code&gt;çš„ä¿¡æ¯å¯ä»¥å‚è€ƒLinuxæ‰‹å†Œ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;man&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;termios
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦è¡¥å……ä¸€ä¸‹*nixç»ˆç«¯çš„ä¸‰ç§æ¨¡å¼(æ‘˜è‡ª&amp;lt;Unix-Linuxç¼–ç¨‹å®è·µæ•™ç¨‹&amp;gt;)&lt;/p&gt;
&lt;h3 id="_1"&gt;è§„èŒƒæ¨¡å¼&lt;/h3&gt;
&lt;p&gt;è§„èŒƒæ¨¡å¼, ä¹Ÿè¢«æˆä¸ºcookedæ¨¡å¼, æ˜¯ç”¨æˆ·å¸¸è§çš„æ¨¡å¼.é©±åŠ¨ç¨‹åºè¾“å…¥çš„å­—ç¬¦ä¿å­˜åœ¨ç¼“å†²åŒº, å¹¶ä¸”ä»…åœ¨æ¥æ”¶åˆ°å›è½¦é”®æ—¶æ‰å°†è¿™äº›ç¼“å†²çš„å­—ç¬¦å‘é€åˆ°ç¨‹åº.ç¼“å†²æ•°æ®ä½¿é©±åŠ¨ç¨‹åºå¯ä»¥å®ç°æœ€åŸºæœ¬çš„ç¼–è¾‘åŠŸèƒ½, è¢«æŒ‡æ´¾è¿™äº›åŠŸèƒ½çš„ç‰¹å®šé”®åœ¨é©±åŠ¨ç¨‹åºé‡Œè®¾ç½®, å¯ä»¥é€šè¿‡å‘½ä»¤sttyæˆ–ç³»ç»Ÿè°ƒç”¨tcsetattræ¥ä¿®æ”¹&lt;/p&gt;
&lt;h3 id="_2"&gt;éè§„èŒƒæ¨¡å¼&lt;/h3&gt;
&lt;p&gt;å½“ç¼“å†²å’Œç¼–è¾‘åŠŸèƒ½è¢«å…³é—­æ—¶, è¿æ¥è¢«æˆä¸ºéè§„èŒƒæ¨¡å¼.ç»ˆç«¯å¤„ç†å™¨ä»æ—§è¿›è¡Œç‰¹å®šçš„å­—ç¬¦å¤„ç†, ä¾‹å¦‚å¤„ç†Ctrl-CåŠæ¢è¡Œç¬¦ä¹‹é—´çš„è½¬æ¢, ä½†æ˜¯ç¼–è¾‘é”®å°†æ²¡æœ‰æ„ä¹‰, å› æ­¤ç›¸åº”çš„è¾“å…¥è¢«è§†ä¸ºå¸¸è§„çš„æ•°æ®è¾“å…¥
ç¨‹åºéœ€è¦è‡ªå·±å®ç°ç¼–è¾‘åŠŸèƒ½&lt;/p&gt;
&lt;h3 id="raw"&gt;rawæ¨¡å¼&lt;/h3&gt;
&lt;p&gt;å½“æ‰€æœ‰å¤„ç†éƒ½è¢«å…³é—­å, é©±åŠ¨ç¨‹åºå°†è¾“å…¥ç›´æ¥ä¼ é€’ç»™ç¨‹åº, è¿æ¥è¢«æˆä¸ºrawæ¨¡å¼.&lt;/p&gt;</content><category term="Python"></category><category term="Python"></category><category term="Linux"></category><category term="ä»»æ„é”®"></category><category term="é€€å‡º"></category><category term="æŒ‰"></category></entry><entry><title>Vim ä»£ç è¡¥å…¨å’Œæ£€æŸ¥: YouCompleteMe &amp; syntastic</title><link href="https://www.linuxzen.com/vim-dai-ma-bu-quan-he-jian-cha-youcompleteme-syntastic.html" rel="alternate"></link><published>2013-08-14T00:00:00+08:00</published><updated>2013-08-14T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-08-14:/vim-dai-ma-bu-quan-he-jian-cha-youcompleteme-syntastic.html</id><summary type="html">&lt;p&gt;Vim 7.4 å‘å¸ƒ, æœ€è¿‘å‡çº§äº†Vim, å¹¶å®‰è£…äº†YouCompleteMeå’ŒSyntasticæ’ä»¶, è¿™é‡Œè®°å½•ä¸‹è¿‡ç¨‹&lt;/p&gt;
&lt;h2 id="vim"&gt;å‡çº§Vim&lt;/h2&gt;
&lt;p&gt;YouCompleteMe éœ€è¦Vim 7.3.584+çš„æ”¯æŒ, å¹¶ä¸”å¼€å¯ +python , å¯ä»¥é€šè¿‡&lt;code&gt;:version&lt;/code&gt;æŸ¥çœ‹
å‡çº§ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;Vim 7.4 å‘å¸ƒ, æœ€è¿‘å‡çº§äº†Vim, å¹¶å®‰è£…äº†YouCompleteMeå’ŒSyntasticæ’ä»¶, è¿™é‡Œè®°å½•ä¸‹è¿‡ç¨‹&lt;/p&gt;
&lt;h2 id="vim"&gt;å‡çº§Vim&lt;/h2&gt;
&lt;p&gt;YouCompleteMe éœ€è¦Vim 7.3.584+çš„æ”¯æŒ, å¹¶ä¸”å¼€å¯ +python , å¯ä»¥é€šè¿‡&lt;code&gt;:version&lt;/code&gt;æŸ¥çœ‹
å‡çº§Viméœ€è¦å…ˆå¸è½½åŸæœ‰çš„Vim&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sudo&lt;span class="w"&gt; &lt;/span&gt;apt-get&lt;span class="w"&gt; &lt;/span&gt;remove&lt;span class="w"&gt; &lt;/span&gt;vim&lt;span class="w"&gt; &lt;/span&gt;vim-tiny&lt;span class="w"&gt; &lt;/span&gt;vim-common&lt;span class="w"&gt; &lt;/span&gt;vim-runtime&lt;span class="w"&gt; &lt;/span&gt;gvim&lt;span class="w"&gt; &lt;/span&gt;vim-gui-common
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¹¶å®‰è£…ä»¥ä¸‹ä¾èµ–&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sudo apt-get install libncurses5-dev libgnome2-dev libgnomeui-dev \
    libgtk2.0-dev libatk1.0-dev libbonoboui2-dev \
    libcairo2-dev libx11-dev libxpm-dev libxt-dev \
    python-dev ruby-dev mercurial checkinstall
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸‹è½½æœ€æ–°çš„Vimæºç , è¿™é‡Œä»ä»£ç ä»“åº“è·å–(éœ€è¦&lt;code&gt;hg&lt;/code&gt;æ²¡æœ‰è‡ªè¡Œå®‰è£…)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;hg&lt;span class="w"&gt; &lt;/span&gt;clone&lt;span class="w"&gt; &lt;/span&gt;https://vim.googlecode.com/hg/&lt;span class="w"&gt; &lt;/span&gt;vim
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åè¿›å…¥ç›®å½•ç¼–è¯‘å®‰è£…Vim&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;vim
./configure&lt;span class="w"&gt; &lt;/span&gt;--with-features&lt;span class="o"&gt;=&lt;/span&gt;huge&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;--enable-rubyinterp&lt;span class="o"&gt;=&lt;/span&gt;yes&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;--enable-pythoninterp&lt;span class="o"&gt;=&lt;/span&gt;yes&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;--enable-python3interp&lt;span class="o"&gt;=&lt;/span&gt;yes&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;--enable-perlinterp&lt;span class="o"&gt;=&lt;/span&gt;yes&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;--enable-luainterp&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;yes&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;--enable-gui&lt;span class="o"&gt;=&lt;/span&gt;gtk2&lt;span class="w"&gt; &lt;/span&gt;--enable-cscope&lt;span class="w"&gt; &lt;/span&gt;--prefix&lt;span class="o"&gt;=&lt;/span&gt;/usr
make&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;VIMRUNTIMEDIR&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/usr/share/vim/vim74
sudo&lt;span class="w"&gt; &lt;/span&gt;checkinstall
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="llvm"&gt;å®‰è£…llvm&lt;/h2&gt;
&lt;p&gt;å¦‚æœæƒ³æ˜¯æƒ³Cç³»è¯­è¨€çš„è¡¥å…¨, éœ€è¦libclang 3.2ä»¥ä¸Šçš„ç‰ˆæœ¬, Ubuntu 12.10 è‡ªå¸¦çš„æ˜¯3.0, æ‰€ä»¥å…ˆå®‰è£…LLVM, å¯ä»¥ä¸‹è½½äºŒè¿›åˆ¶æ–‡ä»¶/ç¼–è¯‘å®‰è£…&lt;/p&gt;
&lt;h4 id="_1"&gt;ä¸‹è½½äºŒè¿›åˆ¶&lt;/h4&gt;
&lt;p&gt;åˆ°&lt;a href="http://llvm.org/releases/download.html#3.3"&gt;llvm.org&lt;/a&gt;ä¸Šä¸‹è½½ç›¸åº”çš„ç‰ˆæœ¬è§£å‹åˆ°~/ycm_temp&lt;/p&gt;
&lt;h4 id="_2"&gt;ç¼–è¯‘&lt;/h4&gt;
&lt;p&gt;ä¸‹è½½&lt;a href="http://llvm.org/releases/3.3/cfe-3.3.src.tar.gz"&gt;clang&lt;/a&gt;å’Œ&lt;a href="http://llvm.org/releases/3.3/llvm-3.3.src.tar.gz"&gt;llvm&lt;/a&gt;, è§£å‹llvm&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mkdir&lt;span class="w"&gt; &lt;/span&gt;~/ycm_temp
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;~/ycm_temp
tar&lt;span class="w"&gt; &lt;/span&gt;-zxvf&lt;span class="w"&gt; &lt;/span&gt;llvm-3.3.src.tar.gz&lt;span class="w"&gt; &lt;/span&gt;-C&lt;span class="w"&gt; &lt;/span&gt;llvm.src
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è§£å‹ clangåˆ°llvm.src/tools&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;tar&lt;span class="w"&gt; &lt;/span&gt;-zxvf&lt;span class="w"&gt; &lt;/span&gt;cfe-3.3.src.tar.gz&lt;span class="w"&gt; &lt;/span&gt;-C&lt;span class="w"&gt; &lt;/span&gt;~/ycm_temp/llvm.src/tools/
mv&lt;span class="w"&gt; &lt;/span&gt;~/ycm_temp/llvm.src/tools/cfe-3.3.src&lt;span class="w"&gt; &lt;/span&gt;~/ycm_temp/llvm/tools/clang
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç¼–è¯‘llvmä¼šè‡ªåŠ¨ç¼–è¯‘clang&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;~/ycm_temp
mkdir&lt;span class="w"&gt; &lt;/span&gt;llvm_build
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;llvm_build
cmake&lt;span class="w"&gt; &lt;/span&gt;../llvm.src/CMakeList.txt&lt;span class="w"&gt; &lt;/span&gt;../llvm.src
make
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="youcompleteme"&gt;å®‰è£…YouCompleteMe&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨Vundleå®‰è£…YouComplete(çŒ›å‡»&lt;a href="/vimpei-zhi-xi-lie-cha-jian-guan-li.html"&gt;è¿™é‡Œ&lt;/a&gt;äº†è§£Vundle)&lt;/p&gt;
&lt;h3 id="ycm_core"&gt;ç¼–è¯‘ycm_core&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mkdir&lt;span class="w"&gt; &lt;/span&gt;~/ycm_build
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;~/ycm_build
cmake&lt;span class="w"&gt; &lt;/span&gt;-G&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Unix Makefiles&amp;quot;&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;~/.vim/bundle/YouCompleteMe/cpp&lt;span class="w"&gt; &lt;/span&gt;-DEXTERNAL_LIBCLANG_PATH&lt;span class="o"&gt;=&lt;/span&gt;~/ycm_temp/llvm.src/lib/libclang.so&lt;span class="w"&gt; &lt;/span&gt;
make&lt;span class="w"&gt; &lt;/span&gt;ycm_core
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸‹è½½llvmäºŒè¿›åˆ¶çš„å¯ä»¥å‚è€ƒ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;cmake&lt;span class="w"&gt; &lt;/span&gt;-G&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Unix Makefiles&amp;quot;&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;~/.vim/bundle/YouCompleteMe/cpp&lt;span class="w"&gt; &lt;/span&gt;-DEXTERNAL_LIBCLANG_PATH&lt;span class="o"&gt;=&lt;/span&gt;~/ycm_temp/llvm_root_path/lib/libclang.so
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_3"&gt;é…ç½®&lt;/h3&gt;
&lt;p&gt;YouCompleteMe éœ€è¦ä¸€ä¸ªé…ç½®æ–‡ä»¶æ¥è¡¥å…¨, å¯ä»¥å‚è€ƒ&lt;a href="https://github.com/Valloric/YouCompleteMe/blob/master/cpp/ycm/.ycm_extra_conf.py"&gt;å®˜æ–¹é…ç½®æ–‡ä»¶&lt;/a&gt;, å¯ä»¥å°†é…ç½®æ–‡ä»¶è‡³äºé¡¹ç›®æ ¹ç›®å½•æˆ–è€…ä¸Šçº§ç›®å½•, YouCompleteMe ä¼šè‡ªåŠ¨æ£€æµ‹åŠ è½½, ä¹Ÿå¯ä»¥é€šè¿‡æŒ‡å®š&lt;code&gt;g:ycm_global_ycm_extra_conf&lt;/code&gt;æŒ‡å®šä¸€ä¸ªå…¨å±€çš„é…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;YouCompleteMe æ¯æ¬¡åŠ è½½é…ç½®æ–‡ä»¶ä¼šæœ‰ä¸€ä¸ªæç¤º, å¾ˆçƒ¦äºº, å¯ä»¥é€šè¿‡å°†&lt;code&gt;g:ycm_confirm_extra_conf&lt;/code&gt;ç½®ä¸º0å…³é—­æç¤º&lt;/p&gt;
&lt;h3 id="python"&gt;è¡¥å…¨Python&lt;/h3&gt;
&lt;p&gt;YouCompleteMe é€šè¿‡ &lt;code&gt;jedi&lt;/code&gt;æ’ä»¶æ¥è¡¥å…¨Python, å¯ä»¥é€šè¿‡&lt;code&gt;Vundle&lt;/code&gt;å®‰è£…æ­¤æ’ä»¶,åœ¨.vimrcä¸­æ·»åŠ &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Bundle &amp;quot;davidhalter/jedi&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="_4"&gt;ä»£ç æ£€æŸ¥&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;syntastic&lt;/code&gt;æ˜¯ä¸€ä¸ªä»£ç æ£€æŸ¥çš„æ’ä»¶, é€šè¿‡&lt;code&gt;Vundle&lt;/code&gt;å®‰è£…å®ƒ, åœ¨.vimrcä¸­æ·»åŠ &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Bundle &amp;quot;scrooloose/syntastic&amp;quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é‡æ–°æ‰“å¼€Vim, æ‰§è¡Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;:BundleInstall
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_5"&gt;é…ç½®&lt;/h3&gt;
&lt;p&gt;å› ä¸ºPythonå·²ç»æœ‰&lt;code&gt;pylint&lt;/code&gt;æ¥æ£€æŸ¥, è€Œä¸”&lt;code&gt;syntastic&lt;/code&gt;æ£€æŸ¥Pythonä¼šåœ¨ä¿å­˜æ—¶æœ‰å¾ˆé•¿æ—¶é—´çš„å¡é¡¿, æ‰€ä»¥ç¦ç”¨å®ƒå¯¹Pythonæ–‡ä»¶çš„æ£€æŸ¥&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;let g:syntastic_ignore_files=[&amp;quot;.*\.py$&amp;quot;]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Vim"></category><category term="Vim"></category><category term="è¡¥å…¨"></category><category term="7.4"></category><category term="å‡çº§"></category><category term="æ£€æŸ¥"></category><category term="Cè¯­è¨€"></category><category term="YouCompleteMe"></category><category term="syntastic"></category></entry><entry><title>å‘å¸ƒä¸€ä¸ªåŸºäºTornadoçš„é«˜æ•ˆå¼‚æ­¥çš„HTTPå®¢æˆ·ç«¯åº“</title><link href="https://www.linuxzen.com/fa-bu-yi-ge-ji-yu-tornadode-gao-xiao-yi-bu-de-httpke-hu-duan-ku.html" rel="alternate"></link><published>2013-08-01T10:46:00+08:00</published><updated>2013-08-01T10:46:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-08-01:/fa-bu-yi-ge-ji-yu-tornadode-gao-xiao-yi-bu-de-httpke-hu-duan-ku.html</id><summary type="html">&lt;p&gt;å‰é¢çš„åšæ–‡æåˆ°è¿‡&lt;a href="/shi-yong-tornadojin-xing-wang-luo-yi-bu-bian-cheng.html"&gt;ä½¿ç”¨tornadoè¿›è¡Œç½‘ç»œå¼‚æ­¥ç¼–ç¨‹&lt;/a&gt;, ä¹Ÿ&lt;a href="/jie-yong-tornadoshi-xian-gao-xiao-de-webqqji-qi-ren.html"&gt;ä½¿ç”¨tornadoå®ç°äº†ä¸€ä¸ªé«˜æ•ˆçš„WebQQæœºå™¨äºº&lt;/a&gt;, ç”±äºtornadoå†…ç½®çš„&lt;code&gt;AsyncHTTPClient&lt;/code&gt;åŠŸèƒ½è¿‡äºå•ä¸€, æ‰€ä»¥è‡ªå·±å†™äº†ä¸€ä¸ªåŸºäºTornadoçš„HTTPå®¢æˆ·ç«¯åº“, é‰´äºè‡ªå·±å¤šå¤„ä½¿ç”¨äº†è¿™ä¸ªåº“, æ‰€ä»¥ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;å‰é¢çš„åšæ–‡æåˆ°è¿‡&lt;a href="/shi-yong-tornadojin-xing-wang-luo-yi-bu-bian-cheng.html"&gt;ä½¿ç”¨tornadoè¿›è¡Œç½‘ç»œå¼‚æ­¥ç¼–ç¨‹&lt;/a&gt;, ä¹Ÿ&lt;a href="/jie-yong-tornadoshi-xian-gao-xiao-de-webqqji-qi-ren.html"&gt;ä½¿ç”¨tornadoå®ç°äº†ä¸€ä¸ªé«˜æ•ˆçš„WebQQæœºå™¨äºº&lt;/a&gt;, ç”±äºtornadoå†…ç½®çš„&lt;code&gt;AsyncHTTPClient&lt;/code&gt;åŠŸèƒ½è¿‡äºå•ä¸€, æ‰€ä»¥è‡ªå·±å†™äº†ä¸€ä¸ªåŸºäºTornadoçš„HTTPå®¢æˆ·ç«¯åº“, é‰´äºè‡ªå·±å¤šå¤„ä½¿ç”¨äº†è¿™ä¸ªåº“, æ‰€ä»¥ä»é¡¹ç›®ä¸­æå–å‡ºæ¥, å†™æˆä¸€ä¸ªå•ç‹¬åº“ &lt;code&gt;tornadohttpclient&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;s&gt;TornadoHTTPClient æ˜¯ä¸€ä¸ªåŸºäºTornadoçš„é«˜æ•ˆçš„å¼‚æ­¥HTTPå®¢æˆ·ç«¯åº“, æ”¯æŒCookieå’Œä»£ç†, ç›®å‰ä»…åœ¨&lt;code&gt;Python2.7&lt;/code&gt;å¹³å°ä¸Šæµ‹è¯•è¿‡, ä¸æ”¯æŒ&lt;code&gt;Python3&lt;/code&gt;&lt;/s&gt;&lt;/p&gt;
&lt;p&gt;å¬å–äº†ä»™å­å›çš„æ„è§, ç›´æ¥å¯¹&lt;code&gt;tornado.curl_httpclient.CurlAsyncHTTPClient&lt;/code&gt;è¿›è¡Œå°è£…&lt;/p&gt;
&lt;h2 id="_1"&gt;å®‰è£…&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆä»git clone ä¸‹ä»£ç &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;git&lt;span class="w"&gt; &lt;/span&gt;clone&lt;span class="w"&gt; &lt;/span&gt;https://github.com/coldnight/tornadohttpclient.git
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åå®‰è£…å®ƒ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;tornadohttpclient
python&lt;span class="w"&gt; &lt;/span&gt;setup.py&lt;span class="w"&gt; &lt;/span&gt;install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="_2"&gt;æ•™ç¨‹&lt;/h2&gt;
&lt;h3 id="get"&gt;GET&lt;/h3&gt;
&lt;p&gt;TornadoHTTPClientçš„getæ–¹æ³•å¯ä»¥å‘èµ·ä¸€ä¸ªgetè¯·æ±‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tornadohttpclient&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;TornadoHTTPClient&lt;/span&gt;

&lt;span class="c1"&gt;# å®ä¾‹åŒ–&lt;/span&gt;
&lt;span class="n"&gt;http&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;TornadoHTTPClient&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c1"&gt;# å‘å‡ºgetè¯·æ±‚&lt;/span&gt;
&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://www.linuxzen.com&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# å¼€å§‹ä¸»äº‹ä»¶å¾ªç¯&lt;/span&gt;
&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="post"&gt;POST&lt;/h3&gt;
&lt;p&gt;TornadoHTTPClientçš„postæ–¹æ³•å¯ä»¥å‘èµ·ä¸€ä¸ªpostè¯·æ±‚&lt;/p&gt;
&lt;h3 id="_3"&gt;è¯»å–å“åº”&lt;/h3&gt;
&lt;p&gt;ä¸Šé¢ä»…ä»…å‘å‡ºäº†è¯·æ±‚, ä½†æ˜¯æˆ‘ä»¬æ— æ³•è¯»å–GETè¯·æ±‚å›æ¥çš„æ•°æ®, æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå›è°ƒæ¥è¯»å–å“åº”&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tornadohttpclient&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;TornadoHTTPClient&lt;/span&gt;

&lt;span class="n"&gt;http&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;TornadoHTTPClient&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;body&lt;/span&gt;
    &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://www.linuxzen.com&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é€šè¿‡&lt;code&gt;callback&lt;/code&gt;å…³é”®å­—å‚æ•°æˆ‘ä»¬å¯ä»¥ä¼ è¿›ä¸€ä¸ªå›è°ƒå‡½æ•°, å½“è¯·æ±‚æˆåŠŸæ—¶ä¼šè°ƒç”¨æ­¤å‡½æ•°, å¹¶ç»™æ­¤å‡½æ•°ä¼ é€’ä¸€ä¸ªä¸&lt;code&gt;urllib2.urlopen&lt;/code&gt;è¿”å›ä¸€æ ·çš„reponseå®ä¾‹&lt;/p&gt;
&lt;h3 id="_4"&gt;ä¸Šä¼ æ–‡ä»¶&lt;/h3&gt;
&lt;p&gt;&lt;code&gt;upload&lt;/code&gt;æ–¹æ³•å¯ä»¥ä¸Šä¼ æ–‡ä»¶, å…¶æ¥å—ä¸€ä¸ªurlå’Œæ–‡ä»¶çš„fieldå’Œæ–‡ä»¶è·¯å¾„, è¿˜æœ‰å…¶ä»–postå‚æ•°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tornadohttpclient&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;TornadoHTTPClient&lt;/span&gt;

&lt;span class="n"&gt;http&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;TornadoHTTPClient&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;æ‰“å¼€å›¾ç‰‡é“¾æ¥&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; &amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;effective_url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;upload&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://paste.linuxzen.com&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;img&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;img_test.png&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                    &lt;span class="n"&gt;callback&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="callback"&gt;ç»™callbackä¼ é€’å‚æ•°&lt;/h3&gt;
&lt;p&gt;æœ‰æ—¶å€™callbackå¯èƒ½éœ€è¦è®¿é—®å±€éƒ¨å˜é‡, å¯ä»¥é€šè¿‡ &lt;code&gt;args&lt;/code&gt;å’Œ&lt;code&gt;kwargs&lt;/code&gt;å…³é”®å­—å‚æ•°, å°†&lt;code&gt;callback&lt;/code&gt;çš„å‚æ•°ä¼ é€’ç»™&lt;code&gt;get&lt;/code&gt;/&lt;code&gt;post&lt;/code&gt;æ–¹æ³•, &lt;code&gt;args&lt;/code&gt;å‚æ•°å°†ä¼šåœ¨&lt;code&gt;response&lt;/code&gt;å‚æ•°ä¹‹åè¢«ä¼ é€’,
&lt;code&gt;args&lt;/code&gt;å‚æ•°ç±»å‹åº”å½“æ˜¯ä¸€ä¸ªå…ƒç»„, &lt;code&gt;kwargs&lt;/code&gt;å‚æ•°ç±»å‹åº”å½“æ˜¯ä¸€ä¸ªå­—å…¸&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tornadohttpclient&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;TornadoHTTPClient&lt;/span&gt;

&lt;span class="n"&gt;http&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;TornadoHTTPClient&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;times&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;body&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;times&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;times&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://www.linuxzen.com&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_5"&gt;å‘é€å»¶è¿Ÿè¯·æ±‚&lt;/h3&gt;
&lt;p&gt;æœ‰æ—¶æˆ‘ä»¬éœ€è¦å»¶è¿Ÿå‡ ç§’ä¹Ÿå‘é€è¯·æ±‚æˆ–æ¯éš”å‡ ç§’å°±å‘é€ä¸€ä¸ªè¯·æ±‚, &lt;code&gt;get&lt;/code&gt;/&lt;code&gt;post&lt;/code&gt;æ–¹æ³•çš„&lt;code&gt;delay&lt;/code&gt;å…³é”®å­—å‚æ•°å¯ä»¥è§£å†³, &lt;code&gt;delay&lt;/code&gt;å‚æ•°æ¥å—ä¸€ä¸ªå•ä½ä¸ºç§’çš„æ•°å­—, å¹¶å»¶è¿Ÿ&lt;code&gt;delay&lt;/code&gt;ç§’åå‘èµ·è¯·æ±‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tornadohttpclient&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;TornadoHTTPClient&lt;/span&gt;

&lt;span class="n"&gt;http&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;TornadoHTTPClient&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;times&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;body&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;times&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&lt;/span&gt; &lt;span class="mi"&gt;9&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="c1"&gt;# å»¶è¿Ÿ10ç§’å‘é€æ­¤è¯·æ±‚&lt;/span&gt;
        &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://www.linuxzen.com&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;times&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;delay&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://www.linuxzen.com&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_6"&gt;ç»™è¯·æ±‚ä¼ é€’å‚æ•°&lt;/h3&gt;
&lt;p&gt;TornadoHTTPClient çš„ &lt;code&gt;get&lt;/code&gt;/&lt;code&gt;post&lt;/code&gt;æ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°&lt;code&gt;params&lt;/code&gt;å¯ä»¥å®šä¹‰è¯·æ±‚æ—¶ä¼ é€’çš„å‚æ•°&lt;code&gt;params&lt;/code&gt;çš„ç±»å‹ä¸ºå­—å…¸æˆ–è€…&lt;code&gt;((key, value), )&lt;/code&gt;ç±»å‹çš„å…ƒç»„æˆ–åˆ—è¡¨,ä¾‹å¦‚ä½¿ç”¨ç™¾åº¦æœç´¢&lt;code&gt;TornadoHTTPClient&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tornadohttpclient&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;TornadoHTTPClient&lt;/span&gt;

&lt;span class="n"&gt;http&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;TornadoHTTPClient&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;body&lt;/span&gt;
    &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://www.baidu.com/s&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;wd&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;tornado&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),),&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä»¥ä¸Šä¹Ÿä½¿ç”¨ä¸POSTæ–¹æ³•, æ¯”å¦‚ç™»å½•ç½‘ç«™&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tornadohttpclient&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;TornadoHTTPClient&lt;/span&gt;

&lt;span class="n"&gt;http&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;TornadoHTTPClient&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;body&lt;/span&gt;
    &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;post&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://ip.or.domain/login&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;username&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;cold&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;password&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;pwd&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)),&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="http"&gt;æŒ‡å®šHTTPå¤´&lt;/h3&gt;
&lt;p&gt;TornadoHTTPClient çš„&lt;code&gt;get&lt;/code&gt;/&lt;code&gt;post&lt;/code&gt;æ–¹æ³•çš„ &lt;code&gt;headers&lt;/code&gt;å…³é”®å­—å‚æ•°å¯ä»¥è‡ªå®šé¢å¤–çš„HTTPå¤´ä¿¡æ¯, å‚æ•°ç±»å‹ä¸ºä¸€ä¸ªå­—å…¸&lt;/p&gt;
&lt;p&gt;æŒ‡å®šUser-Agentå¤´&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tornadohttpclient&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;TornadoHTTPClient&lt;/span&gt;

&lt;span class="n"&gt;http&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;TornadoHTTPClient&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;body&lt;/span&gt;
    &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;headers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(((&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;User-Agent&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="s2"&gt;&amp;quot;Mozilla/5.0 (X11; Linux x86_64)&amp;quot;&lt;/span&gt;\
                &lt;span class="s2"&gt;&amp;quot; AppleWebKit/537.11 (KHTML, like Gecko)&amp;quot;&lt;/span&gt;\
                &lt;span class="s2"&gt;&amp;quot; Chrome/23.0.1271.97 Safari/537.11&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="p"&gt;))&lt;/span&gt;

&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://www.linuxzen.com&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_7"&gt;ä½¿ç”¨ä»£ç†&lt;/h3&gt;
&lt;p&gt;TornadoHTTPClient çš„&lt;code&gt;set_proxy&lt;/code&gt;æ–¹æ³•å¯ä»¥è®¾ç½®ä»£ç†, å…¶æ¥å—ä¸¤ä¸ªå‚æ•°, åˆ†åˆ«æ˜¯ä»£ç†çš„ ä¸»æœºå/ip ä»£ç†çš„ç«¯å£, &lt;code&gt;unset_proxy&lt;/code&gt;å¯ä»¥å–æ¶ˆä»£ç†&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tornadohttpclient&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;TornadoHTTPClient&lt;/span&gt;

&lt;span class="n"&gt;http&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;TornadoHTTPClient&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;body&lt;/span&gt;
    &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unset_proxy&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_proxy&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;127.0.0.1&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;8087&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;http://shell.appspot.com&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="cookie"&gt;Cookie&lt;/h3&gt;
&lt;p&gt;TornadoHTTPClientä¼šè‡ªåŠ¨è®°å½•å’Œè£…è½½Cookie, å¯ä»¥é€šè¿‡ TornadoHTTPClientå®ä¾‹å±æ€§ cookie è·å–Cookie&lt;/p&gt;</content><category term="Python"></category><category term="tornado"></category><category term="http"></category><category term="client"></category><category term="module"></category><category term="Python"></category><category term="é«˜æ•ˆ"></category></entry><entry><title>è§£å†³gitæäº¤æ•æ„Ÿä¿¡æ¯(å›é€€gitç‰ˆæœ¬åº“åˆ°æŸä¸€ä¸ªcommit)</title><link href="https://www.linuxzen.com/jie-jue-gitti-jiao-min-gan-xin-xi-hui-tui-gitban-ben-ku-dao-mou-yi-ge-commit.html" rel="alternate"></link><published>2013-06-07T00:00:00+08:00</published><updated>2013-06-07T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-06-07:/jie-jue-gitti-jiao-min-gan-xin-xi-hui-tui-gitban-ben-ku-dao-mou-yi-ge-commit.html</id><summary type="html">&lt;p&gt;gitæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç‰ˆæœ¬åº“, ç°åœ¨å¾ˆå¤šäººç”¨å®ƒ, å¹¶åœ¨githubä¸Šåˆ›å»ºé¡¹ç›®, ç›¸ä¿¡å¤§å®¶éƒ½æœ‰è¿‡å°†æ•æ„Ÿä¿¡æ¯æäº¤ç‰ˆæœ¬çš„ç»å†, å¦‚ä½•åˆ é™¤? å¥½åƒåªæœ‰åˆ é™¤ç‰ˆæœ¬åº“æ¥è§£å†³, å…¶å®æˆ‘ä»¬ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;gitæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç‰ˆæœ¬åº“, ç°åœ¨å¾ˆå¤šäººç”¨å®ƒ, å¹¶åœ¨githubä¸Šåˆ›å»ºé¡¹ç›®, ç›¸ä¿¡å¤§å®¶éƒ½æœ‰è¿‡å°†æ•æ„Ÿä¿¡æ¯æäº¤ç‰ˆæœ¬çš„ç»å†, å¦‚ä½•åˆ é™¤? å¥½åƒåªæœ‰åˆ é™¤ç‰ˆæœ¬åº“æ¥è§£å†³, å…¶å®æˆ‘ä»¬å¯ä»¥é€šè¿‡å›é€€ç‰ˆæœ¬åº“åˆ é™¤ç›¸åº”çš„commitæ¥å°†æäº¤çš„æ•æ„Ÿä¿¡æ¯å»æ‰.&lt;/p&gt;
&lt;h2 id="_1"&gt;å¤‡ä»½æœ¬åœ°ä»£ç &lt;/h2&gt;
&lt;p&gt;é¦–å…ˆæˆ‘ä»¬å°†æœ¬åœ°ä»£ç çš„æ›´æ”¹å¤‡ä»½ä¸€ä¸‹, ä»¥é˜²ä¸¢å¤±æ›´æ”¹&lt;/p&gt;
&lt;h2 id="commit"&gt;å›é€€æœ¬åœ°ä»£ç çš„commit&lt;/h2&gt;
&lt;p&gt;å¤‡ä»½å®Œæ•°æ®, æˆ‘ä»¬å°±å¯ä»¥å…ˆå›é€€æœ¬åœ°çš„ç‰ˆæœ¬åº“&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;git&lt;span class="w"&gt; &lt;/span&gt;reset&lt;span class="w"&gt; &lt;/span&gt;--hard&lt;span class="w"&gt; &lt;/span&gt;HEAD~1&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# å›é€€åˆ°ä¸Šä¸€æ¬¡çš„æäº¤, å¦‚æœæ˜¯ä¸Šnæ¬¡å°±å°†1æ”¹æˆå¯¹åº”çš„æ•°å­—&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="_2"&gt;å›é€€è¿œç«¯ç‰ˆæœ¬åº“&lt;/h2&gt;
&lt;p&gt;æ¥ä¸‹æ¥å¦‚æœä½ ç›´æ¥æäº¤ä¼šå‘ç°æäº¤ä¸äº†, è¯´è¿œç«¯åšäº†æ›´æ”¹éœ€è¦å…ˆpullä¸€ä¸‹, å¦‚æœpullå’±ä»¬å°±ç™½ç™½åšä¸Šé¢çš„æ“ä½œ, æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨åˆ«çš„åˆ†æ”¯æ“ä½œ&lt;/p&gt;
&lt;h3 id="_3"&gt;æ–°å»ºä¸€ä¸ªåˆ†æ”¯, å¹¶æäº¤&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;git&lt;span class="w"&gt; &lt;/span&gt;checkout&lt;span class="w"&gt; &lt;/span&gt;-b&lt;span class="w"&gt; &lt;/span&gt;temp
git&lt;span class="w"&gt; &lt;/span&gt;push&lt;span class="w"&gt; &lt;/span&gt;origin&lt;span class="w"&gt; &lt;/span&gt;temp:temp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_4"&gt;é‡å»ºä¸»åˆ†æ”¯&lt;/h3&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬å¯ä»¥åˆ é™¤å¹¶é‡å»ºä¸»åˆ†æ”¯, å¦‚æœæ˜¯&lt;code&gt;github&lt;/code&gt;çš„è¯éœ€è¦å°†&lt;code&gt;Default Branch&lt;/code&gt;åˆ‡æ¢åˆ°åˆ«çš„åˆ†æ”¯(é¡¹ç›®ä¸»é¡µ-&amp;gt;Settingså³å¯çœ‹åˆ°)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;git&lt;span class="w"&gt; &lt;/span&gt;push&lt;span class="w"&gt; &lt;/span&gt;origin&lt;span class="w"&gt; &lt;/span&gt;--delete&lt;span class="w"&gt; &lt;/span&gt;master&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# åˆ é™¤è¿œç«¯ä¸»åˆ†æ”¯&lt;/span&gt;
git&lt;span class="w"&gt; &lt;/span&gt;branch&lt;span class="w"&gt; &lt;/span&gt;-d&lt;span class="w"&gt; &lt;/span&gt;master&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="c1"&gt;# åˆ é™¤æœ¬åœ°ä¸»åˆ†æ”¯&lt;/span&gt;
git&lt;span class="w"&gt; &lt;/span&gt;checkout&lt;span class="w"&gt; &lt;/span&gt;-b&lt;span class="w"&gt; &lt;/span&gt;master&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="c1"&gt;# æ–°å»ºä¸»åˆ†æ”¯å¹¶åˆ‡æ¢åˆ°ä¸»åˆ†æ”¯&lt;/span&gt;
git&lt;span class="w"&gt; &lt;/span&gt;push&lt;span class="w"&gt; &lt;/span&gt;origin&lt;span class="w"&gt; &lt;/span&gt;master&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="c1"&gt;# æäº¤ä¸»åˆ†æ”¯&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ ·æˆ‘ä»¬å°±åˆ é™¤ä¹‹å‰æäº¤çš„æ•æ„Ÿä¿¡æ¯(å¦‚æœæ˜¯&lt;code&gt;github&lt;/code&gt;ç°åœ¨å°±å¯ä»¥æŠŠé»˜è®¤åˆ†æ”¯åˆ‡æ¢åˆ° &lt;code&gt;master&lt;/code&gt;)&lt;/p&gt;
&lt;h3 id="_5"&gt;åˆ é™¤ä¸´æ—¶åˆ†æ”¯&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;git&lt;span class="w"&gt; &lt;/span&gt;branch&lt;span class="w"&gt; &lt;/span&gt;-d&lt;span class="w"&gt; &lt;/span&gt;temp
git&lt;span class="w"&gt; &lt;/span&gt;push&lt;span class="w"&gt; &lt;/span&gt;origin&lt;span class="w"&gt; &lt;/span&gt;--delete&lt;span class="w"&gt; &lt;/span&gt;temp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="git"></category><category term="git"></category><category term="æ•æ„Ÿä¿¡æ¯"></category><category term="å›é€€"></category><category term="commit"></category><category term="ç‰ˆæœ¬åº“"></category></entry><entry><title>Pual æ›´æ–°æ”¯æŒSimSimiå¯ä»¥è¿›è¡Œäº’åŠ¨</title><link href="https://www.linuxzen.com/pual-geng-xin-zhi-chi-simsimike-yi-jin-xing-hu-dong.html" rel="alternate"></link><published>2013-05-30T09:50:00+08:00</published><updated>2013-05-30T09:50:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-05-30:/pual-geng-xin-zhi-chi-simsimike-yi-jin-xing-hu-dong.html</id><summary type="html">&lt;p&gt;&lt;a href="http://www.linuxzen.com/jie-yong-tornadoshi-xian-gao-xiao-de-webqqji-qi-ren.html"&gt;Pual&lt;/a&gt; è·‘äº†è®¸ä¹…, é€šè¿‡ä¸€æ®µæ—¶é—´çš„ä¿®æ”¹ç°åœ¨Pualä¸»è¦æ”¯æŒä»¥ä¸‹åŠŸèƒ½:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‹±æ±‰äº’è¯‘&lt;/li&gt;
&lt;li&gt;ä¸ºæ¯ä¸ªç”¨æˆ·åˆ†é…ä¸€ä¸ªsessionçš„å«æœ‰ä¸Šä¸‹æ–‡çš„Python shell&lt;/li&gt;
&lt;li&gt;è´´ä»£ç &lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;æ€»è€Œè¨€ä¹‹å°±æ˜¯ä¸€ä¸ªè¢«åŠ¨å‹çš„è¾…åŠ©æœº â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a href="http://www.linuxzen.com/jie-yong-tornadoshi-xian-gao-xiao-de-webqqji-qi-ren.html"&gt;Pual&lt;/a&gt; è·‘äº†è®¸ä¹…, é€šè¿‡ä¸€æ®µæ—¶é—´çš„ä¿®æ”¹ç°åœ¨Pualä¸»è¦æ”¯æŒä»¥ä¸‹åŠŸèƒ½:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;è‹±æ±‰äº’è¯‘&lt;/li&gt;
&lt;li&gt;ä¸ºæ¯ä¸ªç”¨æˆ·åˆ†é…ä¸€ä¸ªsessionçš„å«æœ‰ä¸Šä¸‹æ–‡çš„Python shell&lt;/li&gt;
&lt;li&gt;è´´ä»£ç &lt;/li&gt;
&lt;/ul&gt;
&lt;hr&gt;
&lt;p&gt;æ€»è€Œè¨€ä¹‹å°±æ˜¯ä¸€ä¸ªè¢«åŠ¨å‹çš„è¾…åŠ©æœºå™¨äºº, ç¾¤é‡Œæœ‰åŒå­¦å»ºè®®&lt;code&gt;AI&lt;/code&gt;åŠŸèƒ½, ä½†æ˜¯æˆ‘æ°´å¹³ä¸å¤Ÿæ²¡åŠæ³•è®¾è®¡å’Œå®ç°&lt;code&gt;AI&lt;/code&gt;éƒ¨åˆ†, æ‰€ä»¥æƒ³è°ƒç”¨&lt;code&gt;SimSimi&lt;/code&gt;å®ç°&lt;code&gt;AI&lt;/code&gt;, å‘ç°å®˜æ–¹Keyæ‰å…è´¹7å¤©, æˆ‘è¿™ç­‰ç©·è‹¦äººå¦‚ä½•æ˜¯ä¹°ä¸èµ·keyçš„, googleå‘ç°æœ‰ä¸€ä¸ªéå®˜æ–¹APIå¯ä»¥è°ƒç”¨, ä½†æ˜¯è¢«å°äº†.ä½†å’±ä¸æ˜¯ä¸ªå®¹æ˜“æ”¾å¼ƒçš„äºº, ç»è¿‡ä¸€ç•ªæŠ˜è…¾éå®˜æ–¹APIå¯ä»¥æ­£å¸¸è°ƒç”¨, æ‰€ä»¥Pualä¹Ÿæœ‰&lt;code&gt;AI&lt;/code&gt;åŠŸèƒ½äº†, åªè¦åœ¨æœ‰Pualçš„ç¾¤é‡Œå‘é€&lt;code&gt;Pual&lt;/code&gt;æ‰“å¤´çš„æ¶ˆæ¯ å°±å¯ä»¥å’Œ&lt;code&gt;Pual&lt;/code&gt;äº’åŠ¨&lt;/p&gt;
&lt;p&gt;&lt;a href="https://github.com/coldnight/pual_bot"&gt;é¡¹ç›®åœ°å€&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Pualå¸å·æ˜¯:1685359365, å¤§å®¶å¯ä»¥å…ˆåŠ å¥½å‹å›ç­”éªŒè¯é—®é¢˜:cold, ç„¶åå°†å®ƒæ‹‰å…¥ç¾¤å†…è¿›è¡Œè°ƒæˆ&lt;/p&gt;</content><category term="Python"></category><category term="Pual"></category><category term="Python"></category><category term="bot"></category><category term="SimSimi"></category></entry><entry><title>è¯´è¯´Pythonè£…é¥°å™¨</title><link href="https://www.linuxzen.com/shuo-shuo-pythonzhuang-shi-qi.html" rel="alternate"></link><published>2013-05-20T14:52:00+08:00</published><updated>2013-05-20T14:52:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-05-20:/shuo-shuo-pythonzhuang-shi-qi.html</id><summary type="html">&lt;p&gt;è£…é¥°å™¨å¯¹ä¸Pythonæ–°æ‰‹ä»¥è‡³äºç†Ÿæ‚‰Pythonçš„äººéƒ½æ˜¯ä¸€ä¸ªéš¾ç†è§£, éš¾å†™çš„ä¸œè¥¿. é‚£ä¹ˆä»Šå¤©å°±åˆ†äº«ä¸€ä¸‹æˆ‘å¯¹Python è£…é¥°å™¨çš„ç†è§£&lt;/p&gt;
&lt;p&gt;æ‰€è°“è£…é¥°å™¨ä»…ä»…æ˜¯ä¸€ç§è¯­æ³•ç³–, å¯ä½œç”¨çš„å¯¹è±¡å¯ä»¥ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;è£…é¥°å™¨å¯¹ä¸Pythonæ–°æ‰‹ä»¥è‡³äºç†Ÿæ‚‰Pythonçš„äººéƒ½æ˜¯ä¸€ä¸ªéš¾ç†è§£, éš¾å†™çš„ä¸œè¥¿. é‚£ä¹ˆä»Šå¤©å°±åˆ†äº«ä¸€ä¸‹æˆ‘å¯¹Python è£…é¥°å™¨çš„ç†è§£&lt;/p&gt;
&lt;p&gt;æ‰€è°“è£…é¥°å™¨ä»…ä»…æ˜¯ä¸€ç§è¯­æ³•ç³–, å¯ä½œç”¨çš„å¯¹è±¡å¯ä»¥æ˜¯å‡½æ•°ä¹Ÿå¯ä»¥æ˜¯ç±», è£…é¥°å™¨æœ¬èº«æ˜¯ä¸€ä¸ªå‡½æ•°, å…¶ä¸»è¦å·¥ä½œæ–¹å¼å°±æ˜¯å°†è¢«è£…é¥°çš„ç±»æˆ–è€…å‡½æ•°å½“ä½œå‚æ•°ä¼ é€’ç»™è£…é¥°å™¨å‡½æ•°, æ¯”å¦‚å®šä¹‰å¦‚ä¸‹è£…é¥°å™¨&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;run_time&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;wrapper&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;start&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;-&lt;/span&gt; &lt;span class="n"&gt;start&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;wrapper&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬ç”¨è¿™ä¸ªè£…é¥°å™¨è£…é¥°ä¸€ä¸ª&lt;code&gt;test&lt;/code&gt;å‡½æ•°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nd"&gt;@run_time&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;just a test&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å‰é¢è¯´è¿‡å…¶å®è£…é¥°å™¨å°±æ˜¯ä¸€ä¸ªè¯­æ³•ç³–, å°±æ˜¯å°†è¢«è£…é¥°çš„å‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’ç»™è£…é¥°å™¨å‡½æ•°, æ‰€ä»¥ä¸Šé¢å¯ä»¥å±•å¼€ä¸º&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;test&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;run_time&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è£…é¥°å™¨å°†åœ¨è§£é‡Šå™¨è¿è¡Œä¸€å¼€å§‹å°±è¢«åŠ è½½, ä»è€Œå°†è¢«è£…é¥°çš„å‡½æ•°å°†è¢«å±•å¼€æˆå¦‚ä¸Šæ–¹å¼, å› ä¸º &lt;code&gt;run_time&lt;/code&gt;è£…é¥°å™¨è¿”å›&lt;code&gt;wrapper&lt;/code&gt;å‡½æ•°, æ‰€ä»¥å½“è°ƒç”¨&lt;code&gt;test&lt;/code&gt;å‡½æ•°æ—¶å…¶å®å°±æ˜¯å¯¹&lt;code&gt;wrapper&lt;/code&gt;çš„è°ƒç”¨&lt;/p&gt;
&lt;p&gt;å¦‚æœä½ åœ¨Python shellä¸‹æ‰§è¡Œä»¥ä¸Šè¯­å¥å°±ä¼šå‘ç°å®šä¹‰å®Œ&lt;code&gt;test&lt;/code&gt;å‡½æ•°ç„¶åæŸ¥çœ‹&lt;code&gt;test&lt;/code&gt;æ—¶, shellæ‰€å±•ç¤ºçš„æ˜¯wrapperå‡½æ•°:
&lt;a href="http://www.linuxzen.com"&gt;&lt;img alt="è¯´è¯´Pythonè£…é¥°å™¨" src="/static/upload/pyshell.png"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;æ¥ä¸‹æ¥è¯´è¯´å¦‚ä½•ç¼–å†™å¸¦å‚æ•°çš„è£…é¥°å™¨, å¤§å®¶å¦‚æœç»†å¿ƒçš„è¯å°±å¯ä»¥å‘ç°å…¶å®å¸¦å‚æ•°çš„è£…é¥°å™¨æ˜¯ç»è¿‡è°ƒç”¨"è£…é¥°å™¨"å‡½æ•°è¿”å›çš„ä¸€ä¸ªè£…é¥°å™¨, ä¹‹æ‰€ä»¥è£…é¥°å™¨ä¸Šæ‰“å¼•å·æ˜¯è¯´æ˜å…¶å®è¿™ä¸ªæ‰€è°“çš„"è£…é¥°å™¨"åªä¸è¿‡æ˜¯ä¸€ä¸ªæ™®é€šçš„å‡½æ•°, ä½†è¿™ä¸ªæ™®é€šçš„å‡½æ•°è¿”å›ä¸€ä¸ªè£…é¥°å™¨, å¯ä»¥å‚çœ‹ä¸‹é¢ä¾‹å­:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;decorator&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__url__&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;func&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;decorator&lt;/span&gt;

&lt;span class="nd"&gt;@route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;index&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Hi&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¤§å®¶å¯ä»¥å‘ç°åœ¨ä½¿ç”¨&lt;code&gt;route&lt;/code&gt;è£…é¥°å™¨æ—¶æˆ‘ä»¬å…¶å®æ˜¯è°ƒç”¨äº†&lt;code&gt;route&lt;/code&gt;å‡½æ•°, &lt;code&gt;route&lt;/code&gt;å‡½æ•°è¿”å›ä¸€ä¸ª&lt;code&gt;decorator&lt;/code&gt;è£…é¥°å™¨, å› ä¸ºæˆ‘ä»¬ä¸éœ€è¦åœ¨è£…é¥°å™¨å†…è¿è¡Œå‡½æ•°, æ‰€ä»¥ä¸éœ€è¦ä¸€ä¸ª&lt;code&gt;wrapper&lt;/code&gt;å‡½æ•°æ¥æ”¶é›†å‚æ•°.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;ä»¥ä¸Šå°±æ˜¯å…¨éƒ¨å†…å®¹, å¸Œæœ›å¯¹è£…é¥°å™¨ä¸€çŸ¥åŠè§£çš„äººæœ‰äº›è®¸å¸®åŠ©&lt;/p&gt;</content><category term="Python"></category><category term="Python"></category><category term="è£…é¥°å™¨"></category></entry><entry><title>clubotæ›´æ–°: ä½¿ç”¨SQLAlchemyé‡å†™æ•°æ®åº“éƒ¨åˆ†å’Œæ”¹ç”¨Tornado MainLoop</title><link href="https://www.linuxzen.com/clubotgeng-xin-shi-yong-sqlalchemyzhong-xie-shu-ju-ku-bu-fen-he-gai-yong-tornado-mainloop.html" rel="alternate"></link><published>2013-04-26T15:40:00+08:00</published><updated>2013-04-26T15:40:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-04-26:/clubotgeng-xin-shi-yong-sqlalchemyzhong-xie-shu-ju-ku-bu-fen-he-gai-yong-tornado-mainloop.html</id><summary type="html">&lt;p&gt;&lt;a href="/python-shi-yong-pyxmpp2bian-xie-gtalkqun.html"&gt;clubot&lt;/a&gt;åœ¨æˆ‘çš„vpsä¸Šè·‘äº†æœ‰ä¸€æ®µæ—¶é—´äº†, æœ€è¿‘æ¥è§¦äº†&lt;code&gt;SQLAlchemy&lt;/code&gt; ç„¶ååè§‚&lt;code&gt;clubot&lt;/code&gt;çš„æ•°æ®åº“ä»£ç éƒ¨åˆ†, æ„Ÿè§‰ä»£ç åˆé­æœ‰ä¹±å®åœ¨çœ‹ä¸è¿‡çœ¼, æ‰€ä»¥å°±ä½¿ç”¨&lt;code&gt;SQLAlchemy&lt;/code&gt;é‡å†™äº†æ•°æ®åº“ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;&lt;a href="/python-shi-yong-pyxmpp2bian-xie-gtalkqun.html"&gt;clubot&lt;/a&gt;åœ¨æˆ‘çš„vpsä¸Šè·‘äº†æœ‰ä¸€æ®µæ—¶é—´äº†, æœ€è¿‘æ¥è§¦äº†&lt;code&gt;SQLAlchemy&lt;/code&gt; ç„¶ååè§‚&lt;code&gt;clubot&lt;/code&gt;çš„æ•°æ®åº“ä»£ç éƒ¨åˆ†, æ„Ÿè§‰ä»£ç åˆé­æœ‰ä¹±å®åœ¨çœ‹ä¸è¿‡çœ¼, æ‰€ä»¥å°±ä½¿ç”¨&lt;code&gt;SQLAlchemy&lt;/code&gt;é‡å†™äº†æ•°æ®åº“æ¨¡å—, å¹¶å°†&lt;code&gt;epoll&lt;/code&gt;çš„MainLoopæ”¹æˆ&lt;a href="http://lilydjwg.is-programmer.com/"&gt;ä»™å­å›&lt;/a&gt;æ‰€å†™çš„&lt;a href="https://github.com/lilydjwg/pyxmpp2"&gt;TornadoMainLoop&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="_1"&gt;æ›´æ–°å†…å®¹&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;æ•°æ®åº“ä½¿ç”¨&lt;code&gt;SQLAlchemy&lt;/code&gt;é‡å†™&lt;/li&gt;
&lt;li&gt;&lt;code&gt;MainLoop&lt;/code&gt;æ”¹ç”¨&lt;code&gt;TornadoMainLoop&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;æ”¹å˜ä»£ç ç»“æ„, æ¸…ç†éƒ¨åˆ†ä»£ç &lt;/li&gt;
&lt;li&gt;å°†&lt;code&gt;history&lt;/code&gt;å‘½ä»¤æ”¹ä¸º&lt;code&gt;old&lt;/code&gt;, å¹¶æ”¯æŒæ—¶é—´æŸ¥è¯¢&lt;/li&gt;
&lt;li&gt;åºŸå¼ƒä¸€äº›ä¸å¸¸ç”¨çš„å‘½ä»¤&lt;/li&gt;
&lt;li&gt;æ”¹å˜æ•°æ®åº“è¡¨ç»“æ„&lt;/li&gt;
&lt;li&gt;åºŸå¼ƒ&lt;code&gt;channel&lt;/code&gt;åŠŸèƒ½, &lt;code&gt;cd&lt;/code&gt;å‘½ä»¤ä»…æ”¯æŒåˆ‡æ¢èŠå¤©å’Œå®‰é™æ¨¡å¼&lt;/li&gt;
&lt;li&gt;åˆ é™¤ä¸€äº›ä¸ç”¨çš„é…ç½®&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id="_2"&gt;å¦‚ä½•å‡çº§&lt;/h2&gt;
&lt;p&gt;æ•°æ®åº“è¡¨ç»“æ„åšäº†æ›´æ”¹, æ‰€ä»¥ä¸ºäº†å…¼å®¹ä¹‹å‰çš„æ•°æ®åº“æœ¬æ¬¡è¡¨åå‰åŠ ä¸Š&lt;code&gt;clubot_&lt;/code&gt;å‰ç¼€, å¹¶é…ä»¥&lt;code&gt;update.py&lt;/code&gt;è„šæœ¬ç”¨ä»¥æ”¯æŒå°†æ—§çš„æ•°æ®å¯¼å…¥.&lt;/p&gt;
&lt;h2 id="_3"&gt;æ–°çš„ä¾èµ–&lt;/h2&gt;
&lt;p&gt;æœ¬æ¬¡æ›´æ–°æ·»åŠ äº†ä¾èµ–, ç°åœ¨ä¾èµ–åŒ…æ‹¬:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;pyxmpp2&lt;/li&gt;
&lt;li&gt;dnspython&lt;/li&gt;
&lt;li&gt;tornado&lt;/li&gt;
&lt;li&gt;sqlalchemy&lt;/li&gt;
&lt;li&gt;MySQL-python&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="_4"&gt;ä¹±ç &lt;/h2&gt;
&lt;p&gt;å¦‚æœæ•°æ®å¯¼å…¥åä¹±ç , å¯ä»¥å‚è€ƒ&lt;a href="/sqlalchemy-mysqlshu-ju-ku-luan-ma-jie-jue.html"&gt;è¿™ç¯‡æ–‡ç« &lt;/a&gt;&lt;/p&gt;
&lt;h2 id="_5"&gt;é¡¹ç›®åœ°å€&lt;/h2&gt;
&lt;p&gt;æœ€åæ”¾ä¸Š&lt;a href="https://github.com/coldnight/clubot"&gt;é¡¹ç›®åœ°å€&lt;/a&gt;&lt;/p&gt;</content><category term="Python"></category><category term="clubot"></category><category term="pyxmpp2"></category><category term="gtalk"></category><category term="xmpp"></category><category term="æ›´æ–°"></category><category term="é‡å†™"></category><category term="SQLAlchemy"></category><category term="tornado"></category></entry><entry><title>SQLAlchemy MySQLæ•°æ®åº“ä¹±ç è§£å†³</title><link href="https://www.linuxzen.com/sqlalchemy-mysqlshu-ju-ku-luan-ma-jie-jue.html" rel="alternate"></link><published>2013-04-26T00:00:00+08:00</published><updated>2013-04-26T00:00:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-04-26:/sqlalchemy-mysqlshu-ju-ku-luan-ma-jie-jue.html</id><summary type="html">&lt;p&gt;ä»Šå¤©å¯¹&lt;a href="/python-shi-yong-pyxmpp2bian-xie-gtalkqun.html"&gt;clubot&lt;/a&gt;è¿›è¡Œäº†&lt;a href="/clubotgeng-xin-shi-yong-sqlalchemyzhong-xie-shu-ju-ku-bu-fen-he-gai-yong-tornado-mainloop.html"&gt;å‡çº§&lt;/a&gt;, ä½†æ˜¯å¯¼å…¥æ•°æ®åä¸­æ–‡ä¹±ç , ä¸€å¼€æ˜¯æ‰¾èµ„æ–™è¯´æ˜¯åœ¨åˆ›å»ºå¼•æ“çš„æ—¶å€™æ·»åŠ ç¼–ç ä¿¡æ¯:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;engine&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;create_engine&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;mysql://root:@localhost:3306/clubot?charset â€¦&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;ä»Šå¤©å¯¹&lt;a href="/python-shi-yong-pyxmpp2bian-xie-gtalkqun.html"&gt;clubot&lt;/a&gt;è¿›è¡Œäº†&lt;a href="/clubotgeng-xin-shi-yong-sqlalchemyzhong-xie-shu-ju-ku-bu-fen-he-gai-yong-tornado-mainloop.html"&gt;å‡çº§&lt;/a&gt;, ä½†æ˜¯å¯¼å…¥æ•°æ®åä¸­æ–‡ä¹±ç , ä¸€å¼€æ˜¯æ‰¾èµ„æ–™è¯´æ˜¯åœ¨åˆ›å»ºå¼•æ“çš„æ—¶å€™æ·»åŠ ç¼–ç ä¿¡æ¯:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;engine&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;create_engine&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;mysql://root:@localhost:3306/clubot?charset=utf8&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä½†æ˜¯è¿™å¹¶ä¸è¡Œ, ç„¶åæŸ¥çœ‹è¡¨ä¿¡æ¯:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;show&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;create&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;table&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clubot_members&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="n"&gt;clubot_members&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;CREATE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;TABLE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`clubot_members`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`id`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;NOT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;NULL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;AUTO_INCREMENT&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`email`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;varchar&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;DEFAULT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`nick`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;varchar&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;DEFAULT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`last_say`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;timestamp&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;NULL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;DEFAULT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`last_change`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;timestamp&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;NULL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;DEFAULT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`isonline`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;DEFAULT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`join_date`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;timestamp&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;NULL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;DEFAULT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;NULL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;PRIMARY&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;KEY&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n n-Quoted"&gt;`id`&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;UNIQUE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;KEY&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`email`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n n-Quoted"&gt;`email`&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;UNIQUE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;KEY&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`nick`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n n-Quoted"&gt;`nick`&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;ENGINE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;InnoDB&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;AUTO_INCREMENT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;DEFAULT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;CHARSET&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;latin1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å‘ç°åŸæ¥åˆ›å»ºè¡¨çš„æ—¶å€™ç”¨çš„&lt;code&gt;latin1&lt;/code&gt;ç¼–ç , è€Œè€çš„è¡¨æ˜¯ç”¨&lt;code&gt;utf-8&lt;/code&gt;ç¼–ç åˆ›å»ºçš„, &lt;code&gt;SQLAlchemy&lt;/code&gt;ä¸­å¹¶æ²¡æœ‰å‘ç°æœ‰åˆ›å»ºè¡¨æ—¶æŒ‡å®šæŒ‡å®šç¼–ç çš„æ–¹æ³•. æ‰€ä»¥åªèƒ½åœ¨&lt;code&gt;MySQL&lt;/code&gt;æœ¬èº«æ¥æ‰¾:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;show&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;VARIABLES&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;like&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;character%%&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;+--------------------------+-----------------------------+&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Variable_name&lt;/span&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;Value&lt;/span&gt;&lt;span class="w"&gt;                       &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;+--------------------------+-----------------------------+&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;character_set_client&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;utf8&lt;/span&gt;&lt;span class="w"&gt;                        &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;character_set_connection&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;utf8&lt;/span&gt;&lt;span class="w"&gt;                        &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;character_set_database&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;latin1&lt;/span&gt;&lt;span class="w"&gt;                      &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;character_set_filesystem&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;binary&lt;/span&gt;&lt;span class="w"&gt;                      &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;character_set_results&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;utf8&lt;/span&gt;&lt;span class="w"&gt;                        &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;character_set_server&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;latin1&lt;/span&gt;&lt;span class="w"&gt;                      &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;character_set_system&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;utf8&lt;/span&gt;&lt;span class="w"&gt;                        &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;character_sets_dir&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;data&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;share&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mysql&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;charsets&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;+--------------------------+-----------------------------+&lt;/span&gt;
&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;rows&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;show&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;create&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;database&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clubot&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;+----------+-------------------------------------------------------------------+&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;Database&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;Create&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;Database&lt;/span&gt;&lt;span class="w"&gt;                                                   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;+----------+-------------------------------------------------------------------+&lt;/span&gt;
&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clubot&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;CREATE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;DATABASE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n n-Quoted"&gt;`clubot`&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="cm"&gt;/*!40100 DEFAULT CHARACTER SET latin1 */&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;
&lt;span class="o"&gt;+----------+-------------------------------------------------------------------+&lt;/span&gt;
&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;row&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kt"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;0.00&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sec&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å‘ç° &lt;code&gt;MySQL&lt;/code&gt;é»˜è®¤çš„å’Œæ•°æ®åº“éƒ½æ˜¯&lt;code&gt;latin1&lt;/code&gt;çš„ç¼–ç , æ‰€ä»¥æ›´æ”¹æ•°æ®åº“é…ç½®&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/etc/mysql/my.cnf&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;# MySQLé…ç½®æ–‡ä»¶åœ¨Ubuntuä¸Šçš„ä½ç½®, å…¶ä»–ç³»ç»Ÿå¯èƒ½æœ‰å·®å¼‚&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åˆ†åˆ«åœ¨&lt;code&gt;[client]&lt;/code&gt; &lt;code&gt;[mysqld]&lt;/code&gt;ä¸‹æ·»åŠ &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;default-character-set = utf8
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ—¶é‡å¯MySQLå±…ç„¶èµ·ä¸æ¥, è¯´&lt;code&gt;default-character-set&lt;/code&gt;æ˜¯æ— æ•ˆçš„å˜é‡, æŸ¥çœ‹&lt;code&gt;MySQL&lt;/code&gt;ç‰ˆæœ¬å‘ç°æ˜¯5.5, æ‰¾èµ„æ–™è¯´5.5çš„æœåŠ¡ç«¯ç¼–ç è®¾ç½®å˜é‡æ˜¯&lt;code&gt;character-set-server&lt;/code&gt;, æ‰€ä»¥å°†&lt;code&gt;[mysqld]&lt;/code&gt;ä¸Šçš„&lt;code&gt;default-character-set = utf8&lt;/code&gt;æ”¹ä¸º &lt;code&gt;character-set-server = utf8&lt;/code&gt;, å¹¶é‡å¯&lt;code&gt;MySQL&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åæ›´æ”¹æ•°æ®åº“ç¼–ç :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;alter&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;database&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clubot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;character&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;utf8&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åˆ é™¤æ–°å»ºçš„è¡¨, å¹¶é‡æ–°å¯¼å…¥æ•°æ®ä¸­æ–‡å°±æ­£å¸¸äº†&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;use&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clubot&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;drop&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;table&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clubot_status&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;drop&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;table&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clubot_infos&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;drop&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;table&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clubot_history&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;drop&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;table&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clubot_members&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Python"></category><category term="sqlalchemy"></category><category term="MySQL"></category><category term="æ•°æ®åº“"></category><category term="ä¹±ç "></category><category term="utf8"></category></entry><entry><title>grepæŒ½æ•‘äº†æˆ‘ä¸€ä¸ªä¸‹åˆ: æ¢å¤rm -fåˆ é™¤çš„ä»£ç </title><link href="https://www.linuxzen.com/grepwan-jiu-liao-wo-yi-ge-xia-wu-hui-fu-rm-fshan-chu-de-dai-ma.html" rel="alternate"></link><published>2013-04-25T14:36:00+08:00</published><updated>2013-04-25T14:36:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-04-25:/grepwan-jiu-liao-wo-yi-ge-xia-wu-hui-fu-rm-fshan-chu-de-dai-ma.html</id><summary type="html">&lt;p&gt;ä»Šå¤©å¯¹ä»£ç è¿›è¡Œé‡æ„, æ–°æ·»åŠ äº†ä¸€ä¸ª&lt;code&gt;logics.py&lt;/code&gt;æ¨¡å—, ä½†å¹¶æ²¡æœ‰åŠ å…¥åˆ°gitåº“ä¸­,  ç„¶åå¯¹ä»£ç è¿›è¡Œæ¸…ç†, æœ‰ä¸€ä¸ª&lt;code&gt;logs&lt;/code&gt;æ–‡ä»¶å¤¹æ˜¯ä¸éœ€è¦çš„æ‰€ä»¥ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;ä»Šå¤©å¯¹ä»£ç è¿›è¡Œé‡æ„, æ–°æ·»åŠ äº†ä¸€ä¸ª&lt;code&gt;logics.py&lt;/code&gt;æ¨¡å—, ä½†å¹¶æ²¡æœ‰åŠ å…¥åˆ°gitåº“ä¸­,  ç„¶åå¯¹ä»£ç è¿›è¡Œæ¸…ç†, æœ‰ä¸€ä¸ª&lt;code&gt;logs&lt;/code&gt;æ–‡ä»¶å¤¹æ˜¯ä¸éœ€è¦çš„æ‰€ä»¥æˆ‘æ‰“ç®—æ¸…æ‰å®ƒ, ä½†æ˜¯&lt;code&gt;zsh&lt;/code&gt;å°†è¡¥å…¨å®šä½åˆ°&lt;code&gt;logics.py&lt;/code&gt;, æ‰‹ä¸Šçš„åŠ¨ä½œå¿«è¿‡äº†è„‘å­,ç›´æ¥æŒ‰äº†å›è½¦, åšå®Œå¿ƒæƒ³å®Œäº†, ä¸€ä¸Šåˆç™½è´¹äº†, è¿˜è¦èŠ±ä¸€ä¸‹åˆçš„æ—¶é—´æ¥é‡æ–°å†™å‡ºè¿™ä¸ªä»£ç , è™½ç„¶æ˜çŸ¥æ²¡æœ‰å¸Œæœ›,ä½†æ˜¯æˆ‘è¿˜æ˜¯ä¸æƒ³æ”¾å¼ƒ, äºæ˜¯å°±googleä¸€ä¸‹æœ‰æ— è§£å†³åŠæ³•,æ„å¤–çš„æ˜¯æ‰¾åˆ°ä¸€ç¯‡æ–‡ç« :&lt;a href="http://www.vpsee.com/2010/08/using-grep-to-recover-text-files/"&gt;ç”¨grepæ¢å¤è¯¯åˆ çš„æ–‡æœ¬&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;å¥½å§è™½ç„¶ä¸çŸ¥é“èƒ½ä¸èƒ½ç”¨, ä½†æ˜¯æˆ‘è¦è¯•è¯•, å› ä¸ºæˆ‘ä¸æƒ³å†èŠ±ä¸€ä¸ªä¸‹åˆæ¥é‡å†™è¿™ä¸ªæ¨¡å—, æˆ‘åœ¨æ¨¡å—é‡Œå®šä¹‰äº†ä¸€ä¸ª&lt;code&gt;Logics&lt;/code&gt;ç±»å¹¶ä¸”ä¸Šé¢å·®ä¸å¤š30è¡Œ, å¾€ä¸‹å·®ä¸å¤š300è¡Œçš„æ ·å­, æˆ‘åˆ é™¤&lt;code&gt;logics.py&lt;/code&gt;æ‰€åœ¨çš„åˆ†åŒºæ˜¯&lt;code&gt;/dev/sda7&lt;/code&gt;, æ‰€ä»¥æˆ‘è¿è¡Œäº†ä¸‹é¢å‘½ä»¤:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;grep&lt;span class="w"&gt; &lt;/span&gt;-a&lt;span class="w"&gt; &lt;/span&gt;-B&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;50&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-A&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;400&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;class Logics(object):&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/dev/sda7&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;tmp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç»è¿‡æ¼«é•¿çš„ç­‰å¾…, è¿™ä¸ªå‘½ä»¤è¿˜æ²¡ç»“æŸ, æˆ‘å¿ä¸ä½çœ‹äº†ä¸‹ tmpçš„å†…å®¹, æˆ‘å‘ç°æˆ‘æ‰¾åˆ°äº†è¿™æ®µä»£ç &lt;/p&gt;
&lt;p&gt;å½“ç„¶æŸå¤±å¹¶ä¸æ˜¯æ²¡æœ‰, æŸå¤±å°±æ˜¯ä¸­æ–‡æ³¨é‡Šå…¨éƒ¨ä¹±ç , ä½†æˆ‘æ»¡è¶³äº†, æˆ‘åªè¦é‡å†™æ³¨é‡Šå°±å¯ä»¥äº†.&lt;/p&gt;</content><category term="Linux"></category><category term="Linux"></category><category term="grep"></category><category term="rm"></category><category term="-f"></category><category term="æ¢å¤"></category></entry><entry><title>å€Ÿç”¨Tornadoå®ç°é«˜æ•ˆçš„WebQQæœºå™¨äºº</title><link href="https://www.linuxzen.com/jie-yong-tornadoshi-xian-gao-xiao-de-webqqji-qi-ren.html" rel="alternate"></link><published>2013-04-23T13:36:00+08:00</published><updated>2013-04-23T13:36:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-04-23:/jie-yong-tornadoshi-xian-gao-xiao-de-webqqji-qi-ren.html</id><summary type="html">&lt;p&gt;ä¹‹å‰æœ‰å†™è¿‡ä¸€ç¯‡æ–‡ç« ä»‹ç»ä½¿ç”¨&lt;code&gt;Pyxmpp2&lt;/code&gt;æ¡¥æ¥QQå’Œxmppçš„æ–‡ç« (&lt;a href="/shi-yong-webqqxie-yi-qiao-jie-xmpphe-qqqun.html"&gt;è¿™é‡Œ&lt;/a&gt;).åæ¥æˆ‘æ‰“ç®—å°†WebQQå•ç‹¬å‡ºæ¥è¿è¡Œ, ä¸€å¼€å§‹ç›´æ¥æ‹·è´äº†&lt;code&gt;pyxmpp2&lt;/code&gt;çš„mainloop, ä½†æ˜¯è·‘èµ·æ¥é—®é¢˜å¤šå¤š, æ‰€ä»¥æˆ‘åˆ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;ä¹‹å‰æœ‰å†™è¿‡ä¸€ç¯‡æ–‡ç« ä»‹ç»ä½¿ç”¨&lt;code&gt;Pyxmpp2&lt;/code&gt;æ¡¥æ¥QQå’Œxmppçš„æ–‡ç« (&lt;a href="/shi-yong-webqqxie-yi-qiao-jie-xmpphe-qqqun.html"&gt;è¿™é‡Œ&lt;/a&gt;).åæ¥æˆ‘æ‰“ç®—å°†WebQQå•ç‹¬å‡ºæ¥è¿è¡Œ, ä¸€å¼€å§‹ç›´æ¥æ‹·è´äº†&lt;code&gt;pyxmpp2&lt;/code&gt;çš„mainloop, ä½†æ˜¯è·‘èµ·æ¥é—®é¢˜å¤šå¤š, æ‰€ä»¥æˆ‘åˆç ”ç©¶äº†åˆ©ç”¨&lt;code&gt;Tornado&lt;/code&gt;è¿›è¡Œç½‘ç»œç¼–ç¨‹(&lt;a href="/shi-yong-tornadojin-xing-wang-luo-yi-bu-bian-cheng.html"&gt;è¿™é‡Œ&lt;/a&gt;), æ‰€ä»¥æˆ‘æ”¾å¼ƒäº†&lt;code&gt;Pyxmpp2&lt;/code&gt;çš„mainloop,ä½¿ç”¨&lt;code&gt;Tornado&lt;/code&gt;è¿›è¡Œé‡å†™&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæ”¾å‡º&lt;a href="https://github.com/coldnight/pual_bot"&gt;é¡¹ç›®ä»£ç &lt;/a&gt;&lt;/p&gt;
&lt;h2 id="_1"&gt;å¼•å­&lt;/h2&gt;
&lt;p&gt;WebQQåè®®æ˜¯ä¸€å¥—åŸºäº&lt;code&gt;HTTP&lt;/code&gt;çš„QQåè®®, è€Œç”¨&lt;code&gt;Python&lt;/code&gt;çš„&lt;code&gt;urllib2&lt;/code&gt;åº“è¿›è¡Œè¯·æ±‚å¤ªæ…¢, å› ä¸ºHTTPæœ¬èº«å°±ä½¿ç”¨socketè¯·æ±‚, æ‰€ä»¥æ”¹ç”¨å¤šè·¯å¤ç”¨I/Oæ¨¡å‹, è€Œ&lt;code&gt;Tornado&lt;/code&gt;ç®€å•é«˜æ•ˆ, çœ‹è¿‡ä»£ç åå¯ä»¥è½»æ¾ä¸Šæ‰‹.å¹³å°å…¼å®¹æ€§å¾ˆå¥½, æ‰€ä»¥é€‰æ‹©&lt;code&gt;Tornado&lt;/code&gt;ä½œä¸ºç½‘ç»œæ¡†æ¶.&lt;/p&gt;
&lt;h2 id="_2"&gt;åŸç†&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆå®ç°äº†ä¸€ä¸ª &lt;code&gt;HTTPStream&lt;/code&gt;ç±», å…¶ä¸»è¦æ¥å£æ˜¯&lt;code&gt;add_request&lt;/code&gt;æ–¹æ³•, å®ƒæ¥å—ä¸€ä¸ªå¿…é€‰å‚æ•°:&lt;code&gt;request&lt;/code&gt; æ˜¯ä¸€ä¸ª &lt;code&gt;urllib2.Request&lt;/code&gt;çš„å®ä¾‹, å’Œä¸€ä¸ªå¯é€‰å‚æ•°:&lt;code&gt;readback&lt;/code&gt;æ˜¯ä¸€ä¸ªæ¥å—ä¸€ä¸ª&lt;code&gt;urllib2.urlopen(request)&lt;/code&gt;è¿”å›çš„&lt;code&gt;Response&lt;/code&gt;å‚æ•°çš„è¯»å–å‡½æ•°, ä»£ç å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;HTTPStream&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# çœç•¥è‹¥å¹²ä»£ç &lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;add_request&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;readback&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="nb"&gt;isinstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;urllib2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Request&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;ValueError&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Not a invaid requset&amp;quot;&lt;/span&gt;

        &lt;span class="c1"&gt;# æ­¤å¤„æ˜“è§¦å‘timeoutå¼‚å¸¸, çœç•¥å¤„ç†å¼‚å¸¸ä»£ç &lt;/span&gt;
        &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;http_sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;make_http_sock_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="n"&gt;fd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fileno&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fd_map&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sock&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fd_request_map&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;
        &lt;span class="n"&gt;callback&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;partial&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_handle_events&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;readback&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ioloop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;callback&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;IOLoop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;WRITE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;HTTPStream.add_request&lt;/code&gt;å°†&lt;code&gt;urllib2.Request&lt;/code&gt;çš„å®ä¾‹è§£æå‡ºä¸€ä¸ª&lt;code&gt;socket&lt;/code&gt;å’Œä¸€ä¸ªç”¨äº&lt;code&gt;socket&lt;/code&gt;å‘é€çš„æ•°æ®.å‰é¢æ–‡ç« ä»‹ç»è¿‡äº†, &lt;code&gt;tornado.ioloop.IOLoop.add_handler&lt;/code&gt;ç”¨äºå°†æ³¨å†Œsocket, å…¶éœ€è¦ä¸‰ä¸ªå‚æ•°: socketçš„æ–‡ä»¶æè¿°ç¬¦, æ¥å—æ–‡ä»¶æè¿°ç¬¦å’Œäº‹ä»¶å‚æ•°çš„å›è°ƒ, å’Œæ³¨å†Œçš„äº‹ä»¶.&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬ç”¨åˆ°çš„å›è°ƒæ˜¯&lt;code&gt;HTTPStream._handle_events&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;HTTPStream&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="c1"&gt;# çœç•¥è‹¥å¹²ä»£ç &lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;_handle_events&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;readback&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;event&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot; ç”¨äºå¤„ç†Tornadoäº‹ä»¶&lt;/span&gt;
&lt;span class="sd"&gt;        Arguments:&lt;/span&gt;
&lt;span class="sd"&gt;            `request`   -   urllib.Request&lt;/span&gt;
&lt;span class="sd"&gt;            `data`      -   socketè¦å†™å…¥çš„æ•°æ®&lt;/span&gt;
&lt;span class="sd"&gt;            `readback`  -   è¯»å–å‡½æ•°&lt;/span&gt;
&lt;span class="sd"&gt;            ä»¥ä¸Šå‚æ•°åº”å½“ä½¿ç”¨partialå°è£…ç„¶åå°†æ­¤æ–¹æ³•ä½œä¸ºIOLoop.add_handlerçš„callback&lt;/span&gt;
&lt;span class="sd"&gt;            `fd`        -   IOLoopä¼ é€’ æ–‡ä»¶æè¿°ç¬¦&lt;/span&gt;
&lt;span class="sd"&gt;            `event`     -   IOLoopä¼ é€’ tornado&lt;/span&gt;
&lt;span class="sd"&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fd_map&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;event&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;IOLoop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;READ&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="c1"&gt;# çœç•¥é”™è¯¯å¤„ç†&lt;/span&gt;
            &lt;span class="n"&gt;resp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;http_sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;make_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;args&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;readback&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;resp&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setblocking&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;threading&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Thread&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_delay_request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setDaemon&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_request&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ioloop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;remove_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;event&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;IOLoop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;WRITE&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendall&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;readback&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ioloop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;IOLoop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;READ&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ioloop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;remove_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;event&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;IOLoop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ERROR&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®ƒæ¥å—çš„å‚æ•°ä¸Šé¢æ³¨é‡Šå†™çš„å¾ˆæ¸…æ¥š, ä¸åšè§£é‡Š, æ‰€ä»¥å°†æ­¤æ–¹æ³•é€šè¿‡&lt;code&gt;functools.partial&lt;/code&gt;å°è£…åšä¸º&lt;code&gt;callback&lt;/code&gt;ä¼ é€’ç»™&lt;code&gt;tornado.ioloop.IOLoop.add_handler&lt;/code&gt;, å¹¶æ³¨å†Œä¸º&lt;code&gt;å†™&lt;/code&gt;äº‹ä»¶, ä»¥ä¾¿å‘é€&lt;code&gt;HTTP&lt;/code&gt;è¯·æ±‚.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;HTTPStream._handle_events&lt;/code&gt;ç”¨äºå¤„ç†äº‹ä»¶, å½“äº‹ä»¶ä¸ºå†™æ—¶å°±å‘é€&lt;code&gt;HTTP&lt;/code&gt;è¯·æ±‚(æ ¹æ®&lt;code&gt;urllib2.Request&lt;/code&gt;ç”Ÿæˆçš„ç”¨äºå‘é€çš„æ•°æ®), å¹¶åˆ¤æ–­æ˜¯å¦æœ‰è¯»å–å‡½æ•°, æœ‰åˆ™æ³¨å†Œ&lt;code&gt;è¯»&lt;/code&gt;äº‹ä»¶, å½“äº‹ä»¶ä¸ºè¯»æ—¶å°±ä»socketä¸­æ„å»ºä¸€ä¸ª&lt;code&gt;Response&lt;/code&gt;å¹¶ä¼ é€’ç»™è¯»å–å‡½æ•°, è¯»å–å‡½æ•°ä¼šè¿”å›3ä¸ªå€¼, åˆ†åˆ«ä¸º: ä¸‹ä¸€ä¸ªè¯·æ±‚, è¯·æ±‚çš„è¯»å–å‡½æ•°(å¯ä¸ºNone, ä¸ºNoneåˆ™åªè¯·æ±‚ä¸è¯»å–), ä¸‹ä¸€ä¸ªè¯·æ±‚çš„å»¶è¿Ÿ(å¤šé•¿äº‹ä»¶åæ·»åŠ æ­¤è¯·æ±‚, å¯é€‰, å•ä½ä¸ºç§’)&lt;/p&gt;
&lt;p&gt;ä¾æ®è¯»å–å‡½æ•°è¿”å›çš„ä¸‰ä¸ªå€¼æ¥ç¡®å®šä¸‹ä¸€ä¸ªè¯·æ±‚, å¹¶å®Œæˆä¸€ç³»åˆ—çš„è¯·æ±‚. æ›´åŠ å®Œæ•´çš„ä»£ç è¯·å‚è§æ–‡ç« å¼€å¤´ç»™å‡ºçš„é¡¹ç›®ä»£ç &lt;/p&gt;
&lt;p&gt;&lt;code&gt;HTTPStream.http_sock.make_response&lt;/code&gt;æ‰§è¡Œæ—¶ä¼šå°†&lt;code&gt;socket&lt;/code&gt;è®¾ä¸ºé˜»å¡, å› ä¸ºä¸è®¾ç½®é˜»å¡ä¼šå‡ºç°&lt;code&gt;httplib.BadStatusLine&lt;/code&gt;å¼‚å¸¸.è¯»å–å‡½æ•°æ‰§è¡Œå®Œæ¯•,é‡æ–°å°†&lt;code&gt;socket&lt;/code&gt;è®¾ç½®ä¸ºéé˜»å¡, å¹¶ç§»é™¤æ­¤&lt;code&gt;socket&lt;/code&gt;(è™½ç„¶åšäº†è¿™æ ·çš„å¤„ç†ä½†æ˜¯QQè¿æ¥æ—¶é—´ç¨é•¿è¿˜æ˜¯ä¼šè§¦å‘&lt;code&gt;httplib.BadStatusLine&lt;/code&gt;å¼‚å¸¸)&lt;/p&gt;
&lt;h2 id="2013-04-26"&gt;2013-04-26 æ›´æ–°&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;è§£å†³ åœ¨çº¿æ—¶é—´ç¨é•¿, å½“ç»è¿‡å¤šæ¬¡è¯·æ±‚åä¼šè§¦å‘&lt;code&gt;socket.gaierror(-2, 'Name or service not known')&lt;/code&gt; å¼‚å¸¸&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="_3"&gt;å­˜åœ¨é—®é¢˜&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;æ²¡æœ‰é‡è¯•æœºåˆ¶&lt;/li&gt;
&lt;/ol&gt;</content><category term="Python"></category><category term="tornado"></category><category term="é«˜æ•ˆ"></category><category term="webqq"></category><category term="å¹¶å‘"></category><category term="åè®®"></category></entry><entry><title>ä½¿ç”¨Pelicanæ‰“é€ é™æ€åšå®¢</title><link href="https://www.linuxzen.com/shi-yong-pelicanda-zao-jing-tai-bo-ke.html" rel="alternate"></link><published>2013-04-18T09:40:00+08:00</published><updated>2013-04-18T09:40:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-04-18:/shi-yong-pelicanda-zao-jing-tai-bo-ke.html</id><summary type="html">&lt;p&gt;å‰é¢æœ‰æ–‡ç« ä»‹ç»æœ¬ç«™é‡‡ç”¨äº†&lt;code&gt;Python&lt;/code&gt;ç¼–å†™çš„&lt;code&gt;Pelican&lt;/code&gt;é™æ€ç”Ÿæˆåšå®¢ç³»ç»Ÿ, ä¹‹æ‰€ä»¥æ²¡æœ‰ä½¿ç”¨å½“å‰å¾ˆç«çš„&lt;code&gt;Jekyll&lt;/code&gt;, æ˜¯å› ä¸ºå®ƒæ˜¯&lt;code&gt;Ruby&lt;/code&gt;ç¼–å†™, è€Œæˆ‘åˆå¯¹ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;å‰é¢æœ‰æ–‡ç« ä»‹ç»æœ¬ç«™é‡‡ç”¨äº†&lt;code&gt;Python&lt;/code&gt;ç¼–å†™çš„&lt;code&gt;Pelican&lt;/code&gt;é™æ€ç”Ÿæˆåšå®¢ç³»ç»Ÿ, ä¹‹æ‰€ä»¥æ²¡æœ‰ä½¿ç”¨å½“å‰å¾ˆç«çš„&lt;code&gt;Jekyll&lt;/code&gt;, æ˜¯å› ä¸ºå®ƒæ˜¯&lt;code&gt;Ruby&lt;/code&gt;ç¼–å†™, è€Œæˆ‘åˆå¯¹&lt;code&gt;Ruby&lt;/code&gt;æ²¡æœ‰å•¥å…´è¶£, æ‰€ä»¥è¿˜æ˜¯é€‰æ‹©äº†ä½¿ç”¨äº†æˆ‘ç†Ÿæ‚‰çš„Pythonç¼–å†™çš„è¿™å¥—ç³»ç»Ÿ, æˆ‘ç”¨äº†ä¸€æ®µæ—¶é—´,æ‰“ç®—å°†ä½¿ç”¨ç»éªŒåˆ†äº«å‡ºæ¥&lt;/p&gt;
&lt;h2 id="_1"&gt;ä»‹ç»&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Pelican&lt;/code&gt;æ˜¯ä¸€å¥—å¼€æºçš„ä½¿ç”¨Pythonç¼–å†™çš„åšå®¢é™æ€ç”Ÿæˆ, å¯ä»¥æ·»åŠ æ–‡ç« å’Œå’Œåˆ›å»ºé¡µé¢, å¯ä»¥ä½¿ç”¨&lt;code&gt;MarkDown&lt;/code&gt; &lt;code&gt;reStructuredText&lt;/code&gt; å’Œ &lt;code&gt;AsiiDoc&lt;/code&gt; çš„æ ¼å¼æ¥æŠ’å†™, åŒæ—¶ä½¿ç”¨ &lt;code&gt;Disqus&lt;/code&gt;è¯„è®ºç³»ç»Ÿ, æ”¯æŒ &lt;code&gt;RSS&lt;/code&gt;å’Œ&lt;code&gt;Atom&lt;/code&gt;è¾“å‡º, æ’ä»¶, ä¸»é¢˜, ä»£ç é«˜äº®ç­‰åŠŸèƒ½, é‡‡ç”¨&lt;code&gt;Jajin2&lt;/code&gt;æ¨¡æ¿å¼•æ“, å¯ä»¥å¾ˆå®¹æ˜“çš„æ›´æ”¹æ¨¡æ¿&lt;/p&gt;
&lt;h2 id="_2"&gt;å®‰è£…&lt;/h2&gt;
&lt;p&gt;å¯ä»¥ä»&lt;code&gt;github&lt;/code&gt;å…‹éš†æœ€æ–°çš„ä»£ç å®‰è£…, å¹¶ä¸”å»ºè®®åœ¨&lt;code&gt;virtualenv&lt;/code&gt;ä¸‹ä½¿ç”¨:&lt;/p&gt;
&lt;h3 id="virtualenv"&gt;å»ºç«‹ virtualenv&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;virtualenv&lt;span class="w"&gt; &lt;/span&gt;pelican&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;# åˆ›å»º&lt;/span&gt;
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;pelican
sh&lt;span class="w"&gt; &lt;/span&gt;bin/activate&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="c1"&gt;# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šé¢å»ºç«‹äº†ä¸€ä¸ªPythonçš„è™šæ‹Ÿç¯å¢ƒ(è¿™ä¸ªå‘½ä»¤ä¸æ˜¯å†…ç½®å¯ä»¥ä½¿ç”¨ &lt;code&gt;easy_install virtualenv&lt;/code&gt; å®‰è£…)&lt;/p&gt;
&lt;h3 id="githubpelican"&gt;ä»githubå…‹éš†æœ€æ–°ä»£ç å®‰è£…Pelican&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;git&lt;span class="w"&gt; &lt;/span&gt;clone&lt;span class="w"&gt; &lt;/span&gt;git://github.com/getpelican/pelican.git&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="c1"&gt;# ä»£ç &lt;/span&gt;
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;pelican
python&lt;span class="w"&gt; &lt;/span&gt;setup.py&lt;span class="w"&gt; &lt;/span&gt;install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šé¢æ­¥éª¤å®Œæˆåå°±å®‰è£…äº†Pelican&lt;/p&gt;
&lt;h2 id="_3"&gt;å¼€å§‹ä¸€ä¸ªåšå®¢&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mkdir&lt;span class="w"&gt; &lt;/span&gt;/path/to/your/blog
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/path/to/your/blog
pelican-quickstart
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åœ¨å›ç­”ä¸€ç³»åˆ—é—®é¢˜è¿‡åä½ çš„åšå®¢å°±å»ºæˆçš„, ä¸»è¦ç”Ÿæˆä¸‹åˆ—æ–‡ä»¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;.
&lt;span class="p"&gt;|&lt;/span&gt;--&lt;span class="w"&gt; &lt;/span&gt;content&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="c1"&gt;# æ‰€æœ‰æ–‡ç« æ”¾äºæ­¤ç›®å½•&lt;/span&gt;
&lt;span class="p"&gt;|&lt;/span&gt;--&lt;span class="w"&gt; &lt;/span&gt;develop_server.sh&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;# ç”¨äºå¼€å¯æµ‹è¯•æœåŠ¡å™¨&lt;/span&gt;
&lt;span class="p"&gt;|&lt;/span&gt;--&lt;span class="w"&gt; &lt;/span&gt;Makefile&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="c1"&gt;# æ–¹ä¾¿ç®¡ç†åšå®¢çš„Makefile&lt;/span&gt;
&lt;span class="p"&gt;|&lt;/span&gt;--&lt;span class="w"&gt; &lt;/span&gt;output&lt;span class="w"&gt;                 &lt;/span&gt;&lt;span class="c1"&gt;# é™æ€ç”Ÿæˆæ–‡ä»¶&lt;/span&gt;
&lt;span class="p"&gt;|&lt;/span&gt;--&lt;span class="w"&gt; &lt;/span&gt;pelicanconf.py&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="c1"&gt;# é…ç½®æ–‡ä»¶&lt;/span&gt;
&lt;span class="p"&gt;|&lt;/span&gt;--&lt;span class="w"&gt; &lt;/span&gt;publishconf.py&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="c1"&gt;# é…ç½®æ–‡ä»¶&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_4"&gt;å†™ä¸€ç¯‡æ–‡ç« &lt;/h3&gt;
&lt;p&gt;åœ¨ &lt;code&gt;content&lt;/code&gt; ç›®å½•æ–°å»ºä¸€ä¸ª &lt;code&gt;test.md&lt;/code&gt;æ–‡ä»¶, å¡«å…¥ä¸€ä¸‹å†…å®¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Title: æ–‡ç« æ ‡é¢˜
Date: 2013-04-18
Category: æ–‡ç« ç±»åˆ«
Tag: æ ‡ç­¾1, æ ‡ç­¾2

è¿™é‡Œæ˜¯å†…å®¹
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæ‰§è¡Œ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;make&lt;span class="w"&gt; &lt;/span&gt;html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç”¨ä»¥ç”Ÿæˆhtml&lt;/p&gt;
&lt;p&gt;ç„¶åæ‰§è¡Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;./develop_server.sh&lt;span class="w"&gt; &lt;/span&gt;start
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¼€å¯ä¸€ä¸ªæµ‹è¯•æœåŠ¡å™¨, è¿™ä¼šåœ¨æœ¬åœ° 8000 ç«¯å£å»ºç«‹ä¸€ä¸ªæµ‹è¯•webæœåŠ¡å™¨, å¯ä»¥ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€:&lt;code&gt;http://localhost:8000&lt;/code&gt;æ¥è®¿é—®è¿™ä¸ªæµ‹è¯•æœåŠ¡å™¨, ç„¶åå°±å¯ä»¥æ¬£èµåˆ°ä½ çš„åšå®¢äº†&lt;/p&gt;
&lt;h3 id="_5"&gt;åˆ›å»ºä¸€ä¸ªé¡µé¢&lt;/h3&gt;
&lt;p&gt;è¿™é‡Œä»¥åˆ›å»º &lt;code&gt;About&lt;/code&gt;é¡µé¢ä¸ºä¾‹&lt;/p&gt;
&lt;p&gt;åœ¨&lt;code&gt;content&lt;/code&gt;ç›®å½•åˆ›å»º&lt;code&gt;pages&lt;/code&gt;ç›®å½•&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mkdir&lt;span class="w"&gt; &lt;/span&gt;content/pages
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶ååˆ›å»º&lt;code&gt;About.md&lt;/code&gt;å¹¶å¡«å…¥ä¸‹é¢å†…å®¹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Title:&lt;span class="w"&gt; &lt;/span&gt;About&lt;span class="w"&gt; &lt;/span&gt;Me
Date:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2013&lt;/span&gt;-04-18

About&lt;span class="w"&gt; &lt;/span&gt;me&lt;span class="w"&gt; &lt;/span&gt;content
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ‰§è¡Œ &lt;code&gt;make html&lt;/code&gt; ç”Ÿæˆhtml, ç„¶åæ‰“å¼€ &lt;code&gt;http://localhost:8000&lt;/code&gt;æŸ¥çœ‹æ•ˆæœ&lt;/p&gt;
&lt;h3 id="pelican"&gt;è®©Pelicanæ”¯æŒè¯„è®º&lt;/h3&gt;
&lt;p&gt;Pelican ä½¿ç”¨&lt;code&gt;Disqus&lt;/code&gt;è¯„è®º, å¯ä»¥ç”³è¯·åœ¨&lt;a href="https://disqus.com/"&gt;Disqus&lt;/a&gt;ä¸Šç”³è¯·ä¸€ä¸ªç«™ç‚¹, ç„¶ååœ¨&lt;code&gt;pelicanconf.py&lt;/code&gt;é‡Œæ·»åŠ æˆ–ä¿®æ”¹&lt;code&gt;DISQUS_SITENAME&lt;/code&gt;é¡¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;DISQUS_SITENAME&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;linuxzen&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ‰§è¡Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;make&lt;span class="w"&gt; &lt;/span&gt;html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æµè§ˆå™¨æ‰“å¼€ &lt;code&gt;http://localhost:8000&lt;/code&gt;æŸ¥çœ‹æ•ˆæœ&lt;/p&gt;
&lt;h3 id="_6"&gt;æ›´æ¢ä¸»é¢˜&lt;/h3&gt;
&lt;p&gt;Pelicanæœ¬èº«ä¹Ÿæä¾›äº†ä¸€äº›ä¸»é¢˜å¯ä¾›é€‰æ‹©, å¯ä»¥ä»githubå…‹éš†ä¸‹æ¥&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;git&lt;span class="w"&gt; &lt;/span&gt;clone&lt;span class="w"&gt; &lt;/span&gt;git://github.com/getpelican/pelican-themes.git&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="c1"&gt;# ä¸»é¢˜&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶ååœ¨é‡Œé¢æ‰¾åˆ°æƒ³è¦çš„ä¸»é¢˜, ç„¶åæ‹·åˆ°åšå®¢é¡¹ç›®å½“å‰ç›®å½•, è¿™é‡Œå·²&lt;code&gt;neat&lt;/code&gt;ä¸ºä¾‹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;cp&lt;span class="w"&gt; &lt;/span&gt;-r&lt;span class="w"&gt; &lt;/span&gt;/path/to/themes/from/github/neat&lt;span class="w"&gt; &lt;/span&gt;.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶ååœ¨ &lt;code&gt;pelicanconf.py&lt;/code&gt; é…ç½®æ–‡ä»¶é‡Œæ·»åŠ æˆ–ä¿®æ”¹ &lt;code&gt;THEME&lt;/code&gt;é¡¹ä¸º &lt;code&gt;neat&lt;/code&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;THEME&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;neat&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é‡æ–°æ‰§è¡Œ &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;make&lt;span class="w"&gt; &lt;/span&gt;html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæ‰“å¼€ &lt;code&gt;http://localhost:8000&lt;/code&gt; æŸ¥çœ‹æ•ˆæœ&lt;/p&gt;
&lt;h3 id="_7"&gt;ä½¿ç”¨æ’ä»¶&lt;/h3&gt;
&lt;p&gt;Pelican ä¸€å¼€å§‹æ˜¯å°†æ’ä»¶å†…ç½®çš„, ä½†æ˜¯æ–°ç‰ˆæœ¬ Pelicanå°†æ’ä»¶éš”ç¦»äº†å‡ºæ¥, æ‰€ä»¥æˆ‘ä»¬è¦åˆ°githubä¸Š å…‹éš†ä¸€ä»½æ–°çš„æ’ä»¶, åœ¨åšå®¢ç›®å½•æ‰§è¡Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;git&lt;span class="w"&gt; &lt;/span&gt;clone&lt;span class="w"&gt; &lt;/span&gt;git://github.com/getpelican/pelican-plugins.git&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# æ’ä»¶&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç°åœ¨æˆ‘ä»¬åšå®¢ç›®å½•å°±æ–°æ·»äº†ä¸€ä¸ª &lt;code&gt;pelican-plugins&lt;/code&gt;ç›®å½•, æˆ‘ä»¬å·²é…ç½®&lt;code&gt;sitemap&lt;/code&gt;æ’ä»¶ä¸ºä¾‹,
&lt;code&gt;sitemap&lt;/code&gt;æ’ä»¶å¯ä»¥ç”Ÿæˆ &lt;code&gt;sitemap.xml&lt;/code&gt; ä¾›æœç´¢å¼•æ“ä½¿ç”¨&lt;/p&gt;
&lt;p&gt;åœ¨&lt;code&gt;pelicanconf.py&lt;/code&gt;é…ç½®æ–‡ä»¶é‡ŒåŠ ä¸Šå¦‚ä¸‹é¡¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;PLUGIN_PATH&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;pelican-plugins&amp;quot;&lt;/span&gt;

&lt;span class="n"&gt;PLUGINS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;sitemap&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="c1"&gt;## é…ç½®sitemap æ’ä»¶&lt;/span&gt;
&lt;span class="n"&gt;SITEMAP&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;format&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;xml&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;priorities&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;articles&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;indexes&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;pages&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="mf"&gt;0.3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;},&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;changefreqs&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;articles&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;monthly&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;indexes&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;daily&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="s2"&gt;&amp;quot;pages&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;monthly&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åå†æ‰§è¡Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;make&lt;span class="w"&gt; &lt;/span&gt;html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ‰“å¼€æµè§ˆå™¨è¯·æ±‚ &lt;code&gt;http://localhost:8000/sitemap.xml&lt;/code&gt;å³å¯çœ‹åˆ°ç”Ÿæˆçš„ Sitemap äº†&lt;/p&gt;
&lt;h3 id="_8"&gt;æ‹·è´é™æ€æ–‡ä»¶&lt;/h3&gt;
&lt;p&gt;å¦‚æœæˆ‘ä»¬å®šä¹‰é™æ€çš„æ–‡ä»¶, è¯¥å¦‚ä½•å°†å®ƒåœ¨æ¯æ¬¡ç”Ÿæˆçš„æ—¶å€™æ‹·è´åˆ° output ç›®å½•å‘¢, æˆ‘ä»¬ä»¥&lt;code&gt;robots.txt&lt;/code&gt; ä¸ºä¾‹, åœ¨æˆ‘ä»¬çš„ content/extra ä¸‹é¢æˆ‘ä»¬æ”¾äº†ä¸€ä¸ªå®šä¹‰å¥½çš„ &lt;code&gt;robots.txt&lt;/code&gt;æ–‡ä»¶, åœ¨&lt;code&gt;pelicanconf.py&lt;/code&gt;æ›´æ”¹æˆ–æ·»åŠ  &lt;code&gt;FILES_TO_COPY&lt;/code&gt;é¡¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;FILES_TO_COPY&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;
    &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;extra/robots.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;robots.txt&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ ·åœ¨æ¯æ¬¡ç”Ÿæˆhtmlçš„æ—¶å€™éƒ½ä¼šæŠŠ &lt;code&gt;content/extra&lt;/code&gt;ä¸‹çš„ &lt;code&gt;robots.txt&lt;/code&gt; æ‹·è´åˆ° &lt;code&gt;output&lt;/code&gt;ç›®å½•ä¸‹&lt;/p&gt;
&lt;h3 id="_9"&gt;æ‹·è´é™æ€ç›®å½•&lt;/h3&gt;
&lt;p&gt;å¦‚æœæ˜¯ä¸€ä¸ªé™ç›®å½•æ€ä¹ˆåŠ? æˆ‘ä»¬å¯ä»¥åœ¨&lt;code&gt;pelicanconf.py&lt;/code&gt;é‡Œæ·»åŠ æˆ–ä¿®æ”¹ &lt;code&gt;STATIC_PATHS&lt;/code&gt;é¡¹, æ¯”å¦‚æˆ‘ä»¬æœ‰ä¸ª&lt;code&gt;img&lt;/code&gt;ç›®å½•ç”¨æ¥æ”¾æ–‡ç« æ‰€ä½¿ç”¨çš„å›¾ç‰‡, æˆ‘ä»¬å¯ä»¥åœ¨&lt;code&gt;pelicanconf.py&lt;/code&gt;æ·»åŠ &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;STATIC_PATHS&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;img&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæ‰§è¡Œ &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;make&lt;span class="w"&gt; &lt;/span&gt;html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶å Pelican å°±ä¼šå°† &lt;code&gt;img&lt;/code&gt;ç›®å½•æ‹·è´åˆ° &lt;code&gt;output/static/&lt;/code&gt; ä¸‹&lt;/p&gt;
&lt;h2 id="_10"&gt;éƒ¨ç½²&lt;/h2&gt;
&lt;p&gt;ä¸Šé¢éƒ½å¼„å®Œä¹‹åä½ å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªåŠŸèƒ½å¥å…¨çš„åšå®¢ç³»ç»Ÿ, æ¥ä¸‹æ¥å°±æ˜¯éƒ¨ç½²åˆ°æœåŠ¡å™¨, ä¸Šä¼ åˆ°æœåŠ¡å™¨å¹¶ç»“åˆnginxæˆ–è€…apacheç­‰webæœåŠ¡å™¨éƒ¨ç½²è¿™é‡Œå°±ä¸åœ¨è¯¦è¿°&lt;/p&gt;
&lt;h2 id="_11"&gt;å‚è€ƒ&lt;/h2&gt;
&lt;p&gt;å¦‚æœè¿˜æœ‰å…¶ä»–é—®é¢˜è¯·å‚è€ƒ&lt;a href="http://docs.getpelican.com/"&gt;å®˜æ–¹æ‰‹å†Œ&lt;/a&gt;&lt;/p&gt;</content><category term="Python"></category><category term="Python"></category><category term="é™æ€"></category><category term="ç”Ÿæˆ"></category><category term="Pelican"></category><category term="åšå®¢"></category></entry><entry><title>ä½¿ç”¨Tornadoè¿›è¡Œç½‘ç»œå¼‚æ­¥ç¼–ç¨‹</title><link href="https://www.linuxzen.com/shi-yong-tornadojin-xing-wang-luo-yi-bu-bian-cheng.html" rel="alternate"></link><published>2013-04-15T16:09:00+08:00</published><updated>2013-04-15T16:09:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-04-15:/shi-yong-tornadojin-xing-wang-luo-yi-bu-bian-cheng.html</id><summary type="html">&lt;h2 id="tornado"&gt;Tornado&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Tornado&lt;/code&gt; æ˜¯ä¸€æ¬¾éé˜»å¡å¯æ‰©å±•çš„ä½¿ç”¨Pythonç¼–å†™çš„webæœåŠ¡å™¨å’ŒPython Webæ¡†æ¶, å¯ä»¥ä½¿ç”¨&lt;code&gt;Tornado&lt;/code&gt;ç¼–å†™Webç¨‹åºå¹¶ä¸ä¾èµ–ä»»ä½•webæœåŠ¡å™¨ç›´æ¥æä¾›é«˜æ•ˆçš„webæœåŠ¡.æ‰€ä»¥&lt;code&gt;Tornado&lt;/code&gt;ä¸ä»…ä»…æ˜¯ä¸€ä¸ªwebæ¡†æ¶è€Œä¸”è¿˜æ˜¯ä¸€æ¬¾å¯ä»¥ç”¨äºç”Ÿäº§ç¯å¢ƒçš„é«˜æ•ˆçš„webæœåŠ¡å™¨&lt;/p&gt;
&lt;p&gt;Torando åœ¨Linuxå’ŒFreeBSDä¸Šä½¿ç”¨é«˜æ•ˆçš„å¼‚æ­¥I/Oæ¨¡å‹ &lt;code&gt;epoll&lt;/code&gt; å’Œ&lt;code&gt;kqueue&lt;/code&gt;æ¥å®ç°é«˜æ•ˆçš„webæœåŠ¡å™¨, æ‰€ä»¥ â€¦&lt;/p&gt;</summary><content type="html">&lt;h2 id="tornado"&gt;Tornado&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Tornado&lt;/code&gt; æ˜¯ä¸€æ¬¾éé˜»å¡å¯æ‰©å±•çš„ä½¿ç”¨Pythonç¼–å†™çš„webæœåŠ¡å™¨å’ŒPython Webæ¡†æ¶, å¯ä»¥ä½¿ç”¨&lt;code&gt;Tornado&lt;/code&gt;ç¼–å†™Webç¨‹åºå¹¶ä¸ä¾èµ–ä»»ä½•webæœåŠ¡å™¨ç›´æ¥æä¾›é«˜æ•ˆçš„webæœåŠ¡.æ‰€ä»¥&lt;code&gt;Tornado&lt;/code&gt;ä¸ä»…ä»…æ˜¯ä¸€ä¸ªwebæ¡†æ¶è€Œä¸”è¿˜æ˜¯ä¸€æ¬¾å¯ä»¥ç”¨äºç”Ÿäº§ç¯å¢ƒçš„é«˜æ•ˆçš„webæœåŠ¡å™¨&lt;/p&gt;
&lt;p&gt;Torando åœ¨Linuxå’ŒFreeBSDä¸Šä½¿ç”¨é«˜æ•ˆçš„å¼‚æ­¥I/Oæ¨¡å‹ &lt;code&gt;epoll&lt;/code&gt; å’Œ&lt;code&gt;kqueue&lt;/code&gt;æ¥å®ç°é«˜æ•ˆçš„webæœåŠ¡å™¨, æ‰€ä»¥ tornadoåœ¨Linuxä¸Šå’ŒFreeBSDç³»åˆ—æ€§èƒ½å¯ä»¥è¾¾åˆ°æœ€é«˜&lt;/p&gt;
&lt;h2 id="_1"&gt;æ¥å£&lt;/h2&gt;
&lt;p&gt;å½“ç„¶æˆ‘ä»¬å¯ä»¥ä¸ä»…ä»…æŠŠ&lt;code&gt;Tornado&lt;/code&gt;çœ‹ä½œæ˜¯ä¸€ä¸ªwebæ¡†æ¶å’ŒwebæœåŠ¡å™¨, æˆ‘ä»¬å¯ä»¥åˆ©ç”¨&lt;code&gt;Tornado&lt;/code&gt;æä¾›çš„æ¥å£è¿›è¡Œé«˜æ•ˆçš„ç½‘ç»œå¼‚æ­¥ç¼–ç¨‹,&lt;/p&gt;
&lt;p&gt;&lt;code&gt;tornado.ioloop.IOLoop&lt;/code&gt; æä¾›äº†ä¸‰ä¸ªæ¥å£å¯ä»¥ç”¨äºç½‘ç»œç¼–ç¨‹:&lt;/p&gt;
&lt;h3 id="add_handler"&gt;add_handler&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;add_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;events&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_handlers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;stack_context&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wrap&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_impl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;register&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;events&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ERROR&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;add_handler&lt;/code&gt;ç”¨äºæ·»åŠ socketåˆ°ä¸»å¾ªç¯ä¸­, æ¥å—ä¸‰ä¸ªå‚æ•°:
* fd æ˜¯socketçš„æ–‡ä»¶æè¿°ç¬¦
* handler æ˜¯å¤„ç†æ­¤socketçš„ callbackå‡½æ•°
* events æ˜¯æ­¤socketæ³¨å†Œçš„äº‹ä»¶&lt;/p&gt;
&lt;h3 id="update_handler"&gt;update_handler&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;update_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;events&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_impl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;modify&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;events&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ERROR&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;update_handler&lt;/code&gt;ç”¨äºæ›´æ–°ä½å¾ªç¯ä¸­å·²å­˜åœ¨çš„socketå“åº”äº‹ä»¶, æ¥å—ä¸¤ä¸ªå‚æ•°:
* fd æ˜¯socketå¯¹åº”çš„æ–‡ä»¶æè¿°ç¬¦
* events æ˜¯æ³¨å†Œçš„æ–°äº‹ä»¶&lt;/p&gt;
&lt;h3 id="remove_handler"&gt;remove_handler&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;remove_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_handlers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_events&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_impl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unregister&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;Exception&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;gen_log&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;debug&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Error deleting fd from IOLoop&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;exc_info&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;remove_handler&lt;/code&gt;ç”¨äºç§»é™¤ä¸»å¾ªç¯ä¸­å·²å­˜åœ¨çš„socket&lt;/p&gt;
&lt;h2 id="_2"&gt;äº‹ä»¶&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;tornado.ioloop.IOLoop&lt;/code&gt;åŒæ—¶æä¾›äº†4ç§å“åº”äº‹ä»¶:&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;äº‹ä»¶&lt;/th&gt;
&lt;th&gt;æè¿°&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;tornado.ioloop.IOLoop.NONE&lt;/td&gt;
&lt;td&gt;æ— äº‹ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;tornado.ioloop.IOLoop.READ&lt;/td&gt;
&lt;td&gt;è¯»äº‹ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;tornado.ioloop.IOLoop.WRITE&lt;/td&gt;
&lt;td&gt;å†™äº‹ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;tornado.ioloop.IOLoop.ERROR&lt;/td&gt;
&lt;td&gt;å‘ç”Ÿé”™è¯¯çš„äº‹ä»¶&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;h2 id="_3"&gt;å®ä¾‹&lt;/h2&gt;
&lt;p&gt;æ ¹æ®ä¸Šé¢çš„æ¥å£å’Œäº‹ä»¶æˆ‘ä»¬å°±å¯ä»¥å†™å‡ºä¸€ä¸ªç®€å•çš„ echo server&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c1"&gt;# -*- coding:utf-8 -*-&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#   Author  :   cold&lt;/span&gt;
&lt;span class="c1"&gt;#   E-mail  :   wh_linux@126.com&lt;/span&gt;
&lt;span class="c1"&gt;#   Date    :   13/04/15 15:08:51&lt;/span&gt;
&lt;span class="c1"&gt;#   Desc    :   Tornado Echo Server&lt;/span&gt;
&lt;span class="c1"&gt;#   HOME    :   http://www.linuxzen.com&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;Queue&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;socket&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;functools&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;partial&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tornado.ioloop&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;IOLoop&lt;/span&gt;

&lt;span class="n"&gt;sock&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AF_INET&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SOCK_STREAM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setblocking&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;              &lt;span class="c1"&gt;# å°†socketè®¾ç½®ä¸ºéé˜»å¡&lt;/span&gt;

&lt;span class="n"&gt;server_address&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;localhost&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10000&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;server_address&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;listen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;fd_map&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;              &lt;span class="c1"&gt;# æ–‡ä»¶æè¿°ç¬¦åˆ°socketçš„æ˜ å°„&lt;/span&gt;
&lt;span class="n"&gt;message_queue_map&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;   &lt;span class="c1"&gt;# socketåˆ°æ¶ˆæ¯é˜Ÿåˆ—çš„æ˜ å°„&lt;/span&gt;

&lt;span class="n"&gt;fd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fileno&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;fd_map&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sock&lt;/span&gt;

&lt;span class="n"&gt;ioloop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;IOLoop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;instance&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;handle_client&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cli_addr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;event&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fd_map&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;event&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;IOLoop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;READ&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;recv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1024&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;     received &amp;#39;&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;&amp;#39; from &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cli_addr&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="c1"&gt;# æ¥æ”¶åˆ°æ¶ˆæ¯æ›´æ”¹äº‹ä»¶ä¸ºå†™, ç”¨äºå‘é€æ•°æ®åˆ°å¯¹ç«¯&lt;/span&gt;
            &lt;span class="n"&gt;ioloop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;IOLoop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;WRITE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;message_queue_map&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;put&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;     closing &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;cli_addr&lt;/span&gt;
            &lt;span class="n"&gt;ioloop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;remove_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="k"&gt;del&lt;/span&gt; &lt;span class="n"&gt;message_queue_map&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;event&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;IOLoop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;WRITE&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;next_msg&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;message_queue_map&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_nowait&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;Queue&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Empty&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt; queue empty&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;cli_addr&lt;/span&gt;
            &lt;span class="n"&gt;ioloop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;IOLoop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;READ&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;sending &amp;quot;&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;&amp;quot; to &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;next_msg&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cli_addr&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;next_msg&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;event&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;IOLoop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ERROR&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot; exception on &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;cli_addr&lt;/span&gt;
        &lt;span class="n"&gt;ioloop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;remove_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;del&lt;/span&gt; &lt;span class="n"&gt;message_queue_map&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;


&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;handle_server&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;event&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fd_map&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;event&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="n"&gt;IOLoop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;READ&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cli_addr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;accept&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;     connection &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;cli_addr&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setblocking&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;conn_fd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fileno&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;fd_map&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;conn_fd&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conn&lt;/span&gt;
        &lt;span class="n"&gt;handle&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;partial&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;handle_client&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cli_addr&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;   &lt;span class="c1"&gt;# å°†cli_addrä½œä¸ºç¬¬ä¸€ä¸ªå‚æ•°&lt;/span&gt;
        &lt;span class="c1"&gt;# å°†è¿æ¥å’Œhandleæ³¨å†Œä¸ºè¯»äº‹ä»¶åŠ å…¥åˆ° tornado ioloop&lt;/span&gt;
        &lt;span class="n"&gt;ioloop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;conn_fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;handle&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;IOLoop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;READ&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;message_queue_map&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Queue&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Queue&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;   &lt;span class="c1"&gt;# åˆ›å»ºå¯¹åº”çš„æ¶ˆæ¯é˜Ÿåˆ—&lt;/span&gt;


&lt;span class="n"&gt;ioloop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;handle_server&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;IOLoop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;READ&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;ioloop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šé¢ä»£ç å°±å»ºç«‹äº†ä¸€ä¸ªéé˜»å¡çš„é«˜æ•ˆçš„å¼‚æ­¥çš„echo server&lt;/p&gt;</content><category term="Python"></category><category term="Python"></category><category term="tornado"></category><category term="ç½‘ç»œ"></category><category term="å¼‚æ­¥"></category><category term="ç¼–ç¨‹"></category></entry><entry><title>ä½¿ç”¨WebQQåè®®æ¡¥æ¥XMPPå’ŒQQç¾¤</title><link href="https://www.linuxzen.com/shi-yong-webqqxie-yi-qiao-jie-xmpphe-qqqun.html" rel="alternate"></link><published>2013-03-14T16:09:00+08:00</published><updated>2013-03-14T16:09:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-03-14:/shi-yong-webqqxie-yi-qiao-jie-xmpphe-qqqun.html</id><summary type="html">&lt;h2 id="_1"&gt;ä»‹ç»&lt;/h2&gt;
&lt;p&gt;æ— æ„ä¸­çœ‹è§æœ‰äººåˆ©ç”¨WebQQåè®®å¼€å‘å‡ºLinuxä¸‹Pidginçš„æ’ä»¶, è®©Pidginæ¥æ”¶å‘QQæ¶ˆæ¯, çªç„¶æƒ³å°†&lt;a href="/python-shi-yong-pyxmpp2bian-xie-gtalkqun.html"&gt;clubot&lt;/a&gt;å’ŒQQç¾¤æ¥æ¡¥æ¥èµ·æ¥ä¸€å®šéå¸¸æœ‰è¶£,è¿™æ ·å°±å¯ä»¥é€šè¿‡gtalkæ”¶å‘QQæ¥çš„æ¶ˆæ¯, ä¸è¿‡å‰æœŸè¿˜æ˜¯æƒ³å°†&lt;code&gt;clubot&lt;/code&gt;å’ŒQQç¾¤æ¡¥æ¥èµ·æ¥.&lt;/p&gt;
&lt;h2 id="_2"&gt;å®æ–½&lt;/h2&gt;
&lt;p&gt;æƒ³åˆ°äº†å°±å¼€å§‹å¼„å‘— â€¦&lt;/p&gt;</summary><content type="html">&lt;h2 id="_1"&gt;ä»‹ç»&lt;/h2&gt;
&lt;p&gt;æ— æ„ä¸­çœ‹è§æœ‰äººåˆ©ç”¨WebQQåè®®å¼€å‘å‡ºLinuxä¸‹Pidginçš„æ’ä»¶, è®©Pidginæ¥æ”¶å‘QQæ¶ˆæ¯, çªç„¶æƒ³å°†&lt;a href="/python-shi-yong-pyxmpp2bian-xie-gtalkqun.html"&gt;clubot&lt;/a&gt;å’ŒQQç¾¤æ¥æ¡¥æ¥èµ·æ¥ä¸€å®šéå¸¸æœ‰è¶£,è¿™æ ·å°±å¯ä»¥é€šè¿‡gtalkæ”¶å‘QQæ¥çš„æ¶ˆæ¯, ä¸è¿‡å‰æœŸè¿˜æ˜¯æƒ³å°†&lt;code&gt;clubot&lt;/code&gt;å’ŒQQç¾¤æ¡¥æ¥èµ·æ¥.&lt;/p&gt;
&lt;h2 id="_2"&gt;å®æ–½&lt;/h2&gt;
&lt;p&gt;æƒ³åˆ°äº†å°±å¼€å§‹å¼„å‘—, äºæ˜¯ä¸Šç½‘æ‰¾äº†å†™æœ‰å…³WebQQçš„åè®®, é¦–å…ˆå†™å‡ºäº†ä¸€ä¸ªæ ¹æ®&lt;code&gt;urllib2&lt;/code&gt;çš„ç‰ˆæœ¬å¹¶ä½¿ç”¨çº¿ç¨‹åŒæ—¶è·‘WebQQå’Œxmpp, æºç å¯ä»¥æŸ¥çœ‹:
&lt;a href="https://github.com/coldnight/qxbot/tree/threading_version"&gt;thread_version&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="_3"&gt;ä¼˜åŒ–&lt;/h2&gt;
&lt;p&gt;ä¸Šé¢çš„çº¿ç¨‹ç‰ˆæ•ˆç‡ä¸æ˜¯å¾ˆé«˜, ç”±äºéƒ½æ˜¯ç½‘ç»œè¯·æ±‚, æ‰€ä»¥æƒ³åŠ å…¥å¯ä»¥åŠ å…¥åˆ°pyxmpp2çš„mainloopä¸­, ä½¿ç”¨å¤ç”¨I/Oæ¨¡å‹æ¥æé«˜æ•ˆç‡, é¦–å…ˆéœ€è¦è§£å†³çš„æ˜¯å°†httpè¯·æ±‚é€šè¿‡urllib2æ”¹ä¸ºsocket, äºæ˜¯å†™å‡ºHTTPSockç±»æ¥å®ç°è¿™ä¸ªéœ€æ±‚:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c1"&gt;# -*- coding:utf-8 -*-&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#   Author  :   Wood.D&lt;/span&gt;
&lt;span class="c1"&gt;#   E-mail  :   wh_linux@126.com&lt;/span&gt;
&lt;span class="c1"&gt;#   Date    :   13/03/04 09:58:26&lt;/span&gt;
&lt;span class="c1"&gt;#   Desc    :   Http Socket å®ç°&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;ssl&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;socket&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;urllib&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;urllib2&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;httplib&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;urlparse&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;tempfile&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;cookielib&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;lib.utils&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;Form&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;HTTPSock&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot; æ„å»ºæ”¯æŒCookieçš„HTTP socket&lt;/span&gt;
&lt;span class="sd"&gt;    ä¾›å¯å¤ç”¨çš„I/Oæ¨¡å‹è°ƒç”¨&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;cookiefile&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tempfile&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mktemp&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cookiejar&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;cookielib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MozillaCookieJar&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cookiefile&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;make_request&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;GET&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot; æ ¹æ®url å‚æ•° æ„å»º urllib2.Request &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;request&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;urllib2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Request&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;isinstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;Form&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Content-Type&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_content_type&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
            &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Content-Length&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
            &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="nb"&gt;isinstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;tuple&lt;/span&gt;&lt;span class="p"&gt;)):&lt;/span&gt;
            &lt;span class="n"&gt;params&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;urllib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;urlencode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;GET&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{0}&lt;/span&gt;&lt;span class="s2"&gt;?&lt;/span&gt;&lt;span class="si"&gt;{1}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="n"&gt;request&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;urllib2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Request&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="n"&gt;request&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;urllib2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Request&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Content-Type&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;application/x-www-form-urlencoded&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cookiejar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_cookie_header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unredirected_hdrs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;make_response&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;req&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot; æ ¹æ®socketå’Œurlib2.Request æ„å»ºResponse &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;httplib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;HTTPResponse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;strict&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;buffering&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;begin&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

        &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;recv&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;
        &lt;span class="n"&gt;fp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_fileobject&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="n"&gt;resp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;urllib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;addinfourl&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;req&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_full_url&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
        &lt;span class="n"&gt;resp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;
        &lt;span class="n"&gt;resp&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;msg&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;reason&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cookiejar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extract_cookies&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;resp&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;req&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cookiejar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;resp&lt;/span&gt;


    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;make_http_sock_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot; æ ¹æ®urllib2.Request æ„å»ºsocketå’Œç”¨äºå‘é€çš„HTTPæºæ•°æ® &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_full_url&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;headers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;headers&lt;/span&gt;
        &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_data&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;parse&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;urlparse&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;urlparse&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;urllib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;splitport&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parse&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;netloc&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;typ&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;parse&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;scheme&lt;/span&gt;
        &lt;span class="n"&gt;port&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="nb"&gt;getattr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;httplib&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;typ&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;upper&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;_PORT&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;  &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_http_source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;parse&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;hasattr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;do_&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;typ&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="nb"&gt;getattr&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;do_&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;typ&lt;/span&gt;&lt;span class="p"&gt;)(&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;do_http&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;sock&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AF_INET&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SOCK_STREAM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;settimeout&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
        &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setblocking&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;sock&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;do_https&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;keyfile&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;certfile&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;sock&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AF_INET&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SOCK_STREAM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;settimeout&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
        &lt;span class="n"&gt;sock&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ssl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wrap_socket&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;keyfile&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;certfile&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setblocking&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;sock&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_http_source&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;parse&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;parse&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;
        &lt;span class="n"&gt;query&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;parse&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;query&lt;/span&gt;
        &lt;span class="n"&gt;path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;path&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;?&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;query&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;query&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="n"&gt;path&lt;/span&gt;
        &lt;span class="n"&gt;path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;path&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;path&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;/&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;method&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;POST&amp;quot;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;GET&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;_buffer&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{0}&lt;/span&gt;&lt;span class="s2"&gt; &lt;/span&gt;&lt;span class="si"&gt;{1}&lt;/span&gt;&lt;span class="s2"&gt; HTTP/1.1&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
        &lt;span class="n"&gt;e_headers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[(&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lower&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;items&lt;/span&gt;&lt;span class="p"&gt;()]&lt;/span&gt;
        &lt;span class="n"&gt;headers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
        &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Host&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;parse&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;netloc&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Connection&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;keep-alive&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Accept&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;*/*&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Accept-Charset&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;UTF-8,*;q=0.5&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Accept-Encoding&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;gzip,deflate,sdch&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Accept-Language&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;zh-CN,zh;q=0.8&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;User-Agent&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Mozilla/5.0 (X11; Linux x86_64)&amp;quot;&lt;/span&gt;\
                        &lt;span class="s2"&gt;&amp;quot; AppleWebKit/537.11 (KHTML, like Gecko)&amp;quot;&lt;/span&gt;\
                        &lt;span class="s2"&gt;&amp;quot; Chrome/23.0.1271.97 Safari/537.11&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;e_headers&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Content-Length&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;   &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;headers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;_buffer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;{0}&lt;/span&gt;&lt;span class="s2"&gt;: &lt;/span&gt;&lt;span class="si"&gt;{1}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;_buffer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extend&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\r\n&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;_buffer&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;isinstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;

    &lt;span class="nd"&gt;@property&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;cookie&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cookiejar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_cookies&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸»è¦æ˜¯æ ¹æ®&lt;code&gt;urllib2.Request&lt;/code&gt;æ„å»ºsocketå’Œsocketè¦å‘é€çš„æ•°æ®, ç„¶åå°†socketè¿”å›çš„æ•°æ®æ„å»ºæˆ&lt;code&gt;response&lt;/code&gt;, ç„¶åç¼–å†™ä¸€äº›handlersæ¥åŠ å…¥åˆ°mainloopä¸­å»,ä¼˜åŒ–åçš„ç‰ˆæœ¬:
&lt;a href="https://github.com/coldnight/qxbot/tree/master"&gt;epoll_version&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;è¿™ä¸ªç‰ˆæœ¬ä½¿ç”¨äº†epollä½œä¸ºä¸»å¾ªç¯, æ›´åŠ é«˜æ•ˆ.&lt;/p&gt;
&lt;h2 id="_4"&gt;æœ€æ–°ç‰ˆæœ¬&lt;/h2&gt;
&lt;p&gt;æœ€æ–°ç‰ˆæœ¬åˆ†ç¦»äº†WebQQä½œä¸ºä¸€ä¸ªåŒ…, å¦‚ä»…éœ€WebQQçš„åŠŸèƒ½å¯ä»¥å¾ˆæ–¹ä¾¿çš„åˆ†ç¦»å‡ºæ¥(å½“ç„¶è¦ä»¿ç…§pyxmpp2æ¥å®ç°ä¸€å¥—äº‹ä»¶æœºåˆ¶), æºç :
&lt;a href="https://github.com/coldnight/qxbot/"&gt;last&lt;/a&gt;&lt;/p&gt;</content><category term="Python"></category><category term="WebQQ"></category><category term="xmpp"></category><category term="python"></category><category term="XMPP"></category><category term="pyxmpp2"></category></entry><entry><title>ä½¿ç”¨Pelicanåšå®¢é™æ€ç”Ÿæˆç³»ç»Ÿ</title><link href="https://www.linuxzen.com/shi-yong-pelicanbo-ke-jing-tai-sheng-cheng-xi-tong.html" rel="alternate"></link><published>2013-03-14T15:12:00+08:00</published><updated>2013-03-14T15:12:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-03-14:/shi-yong-pelicanbo-ke-jing-tai-sheng-cheng-xi-tong.html</id><summary type="html">&lt;h1 id="_1"&gt;ä»‹ç»&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘æµè¡Œä½¿ç”¨é™æ€ç”Ÿæˆçš„åšå®¢, çœ‹äº†å¾ˆå¤šæ„Ÿè§‰å¾ˆæ£’æ€»æƒ³å°è¯•ä¸€ä¸‹, å¤§åé¼é¼çš„&lt;code&gt;Jekyll&lt;/code&gt;ä½¿ç”¨ruby,çœ‹äº†å¾ˆå¤šæ–‡æ¡£ä»‹ç»,ä¾æ—§ä¸èƒ½ â€¦&lt;/p&gt;</summary><content type="html">&lt;h1 id="_1"&gt;ä»‹ç»&lt;/h1&gt;
&lt;p&gt;æœ€è¿‘æµè¡Œä½¿ç”¨é™æ€ç”Ÿæˆçš„åšå®¢, çœ‹äº†å¾ˆå¤šæ„Ÿè§‰å¾ˆæ£’æ€»æƒ³å°è¯•ä¸€ä¸‹, å¤§åé¼é¼çš„&lt;code&gt;Jekyll&lt;/code&gt;ä½¿ç”¨ruby,çœ‹äº†å¾ˆå¤šæ–‡æ¡£ä»‹ç»,ä¾æ—§ä¸èƒ½å…¥é—¨ä½¿ç”¨,ä¹Ÿè®¸æ˜¯ç”¨Rubyç¼–å†™,å¯¹å®ƒæ¯”è¾ƒè¿Ÿé’.çœ‹åˆ°äº†ä¸€æ¬¾Pythonç¼–å†™çš„é™æ€ç”Ÿæˆç³»ç»Ÿ&lt;code&gt;Pelican&lt;/code&gt;, è¯•ç”¨åé™¤äº†æ¨¡æ¿è¾ƒå°‘å¤–æ„Ÿè§‰è¿˜æ˜¯ä¸é”™çš„,ä½¿ç”¨&lt;code&gt;Markdown&lt;/code&gt;å’Œ&lt;code&gt;Rst&lt;/code&gt;ç¼–å†™.&lt;/p&gt;
&lt;h1 id="_2"&gt;å®‰è£…&lt;/h1&gt;
&lt;p&gt;å¯ä»¥è¯•ç”¨&lt;code&gt;pip&lt;/code&gt;æ¥å®‰è£…&lt;code&gt;Pelican&lt;/code&gt;, é€šè¿‡&lt;code&gt;pelican-quickstart&lt;/code&gt;è„šæœ¬å¯ä»¥å¿«é€Ÿæ„å»ºä¸€ä¸ªç«™ç‚¹,è¯¦ç»†ä¸åœ¨æè¿°.å¯ä»¥çœ‹çœ‹å®ƒçš„æ–‡æ¡£&lt;/p&gt;
&lt;h2 id="_3"&gt;æ¨¡æ¿&lt;/h2&gt;
&lt;p&gt;æ¨¡æ¿é‡‡ç”¨&lt;code&gt;neat&lt;/code&gt;,è¿™ä¸ªæ¨¡æ¿è®¾è®¡ç®€å•(çœ‹æˆ‘çš„é¡µé¢å°±çŸ¥é“æœ‰å¤šç®€å•äº†)æˆ‘éå¸¸å–œæ¬¢, ä½†æ˜¯æœ‰å‡ ä¸ªé“¾æ¥&lt;code&gt;bug&lt;/code&gt;,bugä¸æ˜¯å¾ˆéš¾æ‰¾,å¾ˆè½»æ¾å°±èƒ½æ‰¾å‡ºæ¥, è¿™é‡Œä¸åˆ—å‡ºæ¥, åŸºäºè¿™ä¸ªæ¨¡æ¿æˆ‘åšäº†ä¸€ç‚¹æ›´æ”¹.&lt;/p&gt;
&lt;h1 id="_4"&gt;ä½¿ç”¨&lt;/h1&gt;
&lt;p&gt;åœ¨æ‰§è¡Œ&lt;code&gt;pelican-quickstart&lt;/code&gt;æ˜¯å¼€å¯Makefile, å¯ä»¥é€šè¿‡makeå¾ˆç®€å•çš„ç”Ÿæˆhtml.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;make&lt;span class="w"&gt; &lt;/span&gt;html&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# ç”Ÿæˆhtml&lt;/span&gt;
make&lt;span class="w"&gt; &lt;/span&gt;clean&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# åˆ é™¤output&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="_5"&gt;æŠ€å·§&lt;/h2&gt;
&lt;p&gt;æˆ‘æ˜¯å°†ç”Ÿæˆçš„htmlé€šè¿‡nginxæ¥æ‰“å¼€(Nginxé…ç½®å°±å¾ˆç®€å•äº†, è¿™é‡Œå°±ä¸åšä»‹ç»), é‚£ä¹ˆå¦‚ä½•ç¡®ä¿æ›´æ–°å‘¢?æˆ‘å°†æ•´ä¸ªåšå®¢ä¸Šä¼ åˆ°github, è¿™æ ·éšæ—¶éšåœ°å¯ä»¥&lt;code&gt;clone&lt;/code&gt;ä¸‹æ¥è¿›è¡Œæ›´æ”¹ç„¶å&lt;code&gt;push&lt;/code&gt;ä¸Šå»,åœ¨æœåŠ¡å™¨æˆ‘é€šè¿‡crontabæ¥å®šæ—¶æ›´æ–°html&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;crontab&lt;span class="w"&gt; &lt;/span&gt;-e
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ·»åŠ å¦‚ä¸‹å†…å®¹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;*/5&lt;span class="w"&gt; &lt;/span&gt;*&lt;span class="w"&gt; &lt;/span&gt;*&lt;span class="w"&gt; &lt;/span&gt;*&lt;span class="w"&gt; &lt;/span&gt;*&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/path/to/your/blogsource/&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;git&lt;span class="w"&gt; &lt;/span&gt;pull&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/dev/null
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ ·å°±å¯ä»¥æ²¡5åˆ†é’Ÿæ›´æ–°ä¸€æ¬¡&lt;/p&gt;</content><category term="Python"></category><category term="åšå®¢"></category><category term="Pelican"></category><category term="é™æ€"></category><category term="è¿ç§»"></category></entry><entry><title>vLog ä¸€ä¸ªä½¿ç”¨Pythonç¼–å†™çš„è½»é‡çº§åšå®¢ç³»ç»Ÿ</title><link href="https://www.linuxzen.com/vlog-yi-ge-shi-yong-pythonbian-xie-de-qing-liang-ji-bo-ke-xi-tong.html" rel="alternate"></link><published>2013-02-05T16:43:00+08:00</published><updated>2013-02-05T16:43:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-02-05:/vlog-yi-ge-shi-yong-pythonbian-xie-de-qing-liang-ji-bo-ke-xi-tong.html</id><summary type="html">&lt;h2 id="_1"&gt;ä»‹ç»&lt;/h2&gt;
&lt;h3 id="vlog"&gt;ä½•ä¸ºvLog&lt;/h3&gt;
&lt;p&gt;å¤§å®¶æœ‰äººå¯èƒ½æ³¨æ„åˆ°åšå®¢æ”¹å˜äº†,æ˜¯çš„å‰é¢ä¹Ÿæœ‰æ–‡ç« æåˆ°ä»wordpressè¿ç§»åˆ°vlog,ä½†æ˜¯ä½•ä¸ºvLogè¿™é‡Œç»™å¤§å®¶ç®€è¦çš„è¯´æ˜ä¸€ä¸‹,vLogæ˜¯æˆ‘ä½¿ç”¨&lt;code&gt;Python&lt;/code&gt;çš„&lt;code&gt;tornado&lt;/code&gt;æ¡†æ¶å’Œ&lt;code&gt;Jinja2&lt;/code&gt;æ¨¡æ¿å¼•æ“,åŸºäº â€¦&lt;/p&gt;</summary><content type="html">&lt;h2 id="_1"&gt;ä»‹ç»&lt;/h2&gt;
&lt;h3 id="vlog"&gt;ä½•ä¸ºvLog&lt;/h3&gt;
&lt;p&gt;å¤§å®¶æœ‰äººå¯èƒ½æ³¨æ„åˆ°åšå®¢æ”¹å˜äº†,æ˜¯çš„å‰é¢ä¹Ÿæœ‰æ–‡ç« æåˆ°ä»wordpressè¿ç§»åˆ°vlog,ä½†æ˜¯ä½•ä¸ºvLogè¿™é‡Œç»™å¤§å®¶ç®€è¦çš„è¯´æ˜ä¸€ä¸‹,vLogæ˜¯æˆ‘ä½¿ç”¨&lt;code&gt;Python&lt;/code&gt;çš„&lt;code&gt;tornado&lt;/code&gt;æ¡†æ¶å’Œ&lt;code&gt;Jinja2&lt;/code&gt;æ¨¡æ¿å¼•æ“,åŸºäºMySQLæ•°æ®çš„ä¸€ä¸ªè½»é‡çº§çš„åšå®¢ç³»ç»Ÿ,æ­¤ç³»ç»ŸåŠŸèƒ½æ¯”è¾ƒè–„å¼±,å¤„äºå¼€å‘åˆæœŸ,ä½¿ç”¨&lt;code&gt;Markdown&lt;/code&gt;çš„æ ¼å¼æ¥æŠ’å†™åšæ–‡.&lt;/p&gt;
&lt;h3 id="vlog_1"&gt;ä¸ºä»€ä¹ˆvLog&lt;/h3&gt;
&lt;p&gt;vLogåå°ååˆ†ç®€å•(å¯ä»¥è¯´æ˜¯ç®€é™‹),åŠŸèƒ½ä¹Ÿç®€å•,å°±æ˜¯ä¸€æ¬¾ç®€å•çš„åšå®¢ç³»ç»Ÿ,æä¾›äº†Pythonç»ˆç«¯è„šæœ¬,å¯ä»¥åœ¨ç»ˆç«¯æ¥æŠ’å†™åšæ–‡, vLogä½¿ç”¨ä¸€å¥—éå¸¸ç®€å•çš„ç¼“å­˜ç³»ç»Ÿ,ç¼“å­˜ä½¿ç”¨memcachedä½¿å¾—é¡µé¢åŠ è½½é€Ÿåº¦éå¸¸å¿«.&lt;/p&gt;
&lt;h3 id="vlog_2"&gt;ä¸ºä»€ä¹ˆä¸vLog&lt;/h3&gt;
&lt;p&gt;ç›¸å¯¹ä¸wordpress vlogéå¸¸ç®€é™‹,ä»…ä»…æä¾›ç®€å•çš„åšå®¢åŠŸèƒ½,è€Œä¸”ä½¿ç”¨Pythonç¼–å†™ä¸»æœºæ–¹é¢æ”¯æ´ä¸å¤ªå¤š,è™½ç„¶æœ‰&lt;code&gt;SAE&lt;/code&gt;å’Œ&lt;code&gt;GAE&lt;/code&gt;çš„æ”¯æ´,ä½†æ˜¯æˆ‘æ²¡å¼„è¿‡,æ‰€ä»¥æ²¡æœ‰æ”¯æ´&lt;code&gt;SAE&lt;/code&gt;å’Œ&lt;code&gt;GAE&lt;/code&gt;(å¦‚æœä½ æœ‰å…´è¶£,å¯ä»¥æ·»åŠ ç›¸å…³æ”¯æŒ)&lt;/p&gt;
&lt;h2 id="_2"&gt;å®‰è£…&lt;/h2&gt;
&lt;h3 id="_3"&gt;å¹³å°&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Linux&lt;/li&gt;
&lt;li&gt;python2.7&lt;/li&gt;
&lt;li&gt;MySQL&lt;/li&gt;
&lt;li&gt;Memcached 1.4.5&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="_4"&gt;ä¾èµ–åº“&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;tornado&lt;/li&gt;
&lt;li&gt;jinja2&lt;/li&gt;
&lt;li&gt;MySQLdb&lt;/li&gt;
&lt;li&gt;pylibmc&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="_5"&gt;å¼€å§‹å®‰è£…&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆç¡®è®¤config.pyçš„DEBUGæ˜¯æ‰“å¼€çš„,ç„¶åæ‰§è¡Œrun.py,æ‰“å¼€æµè§ˆå™¨è¾“å…¥å½“å‰åœ°å€,ä¼šè·³è½¬åˆ°å®‰è£…é¡µé¢.æŒ‰ç…§æç¤ºå®‰è£…,å®‰è£…å®Œæ¯•åå¯ä»¥å…³é—­DEBUG&lt;/p&gt;
&lt;h2 id="wordpress"&gt;ä»Wordpressä¸­å¯¼å…¥&lt;/h2&gt;
&lt;h3 id="wordpress_1"&gt;ä»Wordpresså¯¼å‡º&lt;/h3&gt;
&lt;p&gt;åœ¨wordpressç®¡ç†åå°é€‰æ‹©å·¥å…·-&amp;gt;å¯¼å‡º,ä¸‹è½½å¯¼å‡ºæ–‡ä»¶å¯ä»¥å¯¼å‡ºä¸€ä»½xml&lt;/p&gt;
&lt;h3 id="_6"&gt;ç§»åŠ¨åª’ä½“æ–‡ä»¶&lt;/h3&gt;
&lt;p&gt;å°†/path/to/your/wordpress/wp-content/uploads/ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ç§»åŠ¨åˆ°/path/to/your/vlog/web/static/upload ä¸‹å³å¯&lt;/p&gt;
&lt;p&gt;åŠ¡å¿…è¦å…ˆæ‰§è¡Œè¿™ä¸€æ­¥ç„¶åå†åœ¨åå°é‡Œå¯¼å…¥xml&lt;/p&gt;
&lt;h3 id="vlog_3"&gt;å¯¼å…¥åˆ°vLog&lt;/h3&gt;
&lt;p&gt;è¿›å…¥vLogåå°,é€‰æ‹©å¯¼å…¥,æµè§ˆé€‰ä¸­å¯¼å‡ºçš„xml, ç„¶åé€‰æ‹©å¼€å§‹,ç­‰å¾…æç¤ºæˆåŠŸåå³å¯¼å…¥æˆåŠŸ&lt;/p&gt;
&lt;h3 id="_7"&gt;æ‰‹åŠ¨æ›´æ”¹æ²¡æœ‰ç”Ÿæ•ˆçš„é“¾æ¥&lt;/h3&gt;
&lt;p&gt;è™½ç„¶æˆ‘å·²ç»ç«­å°½æ‰€èƒ½çš„è®©ä½ æ‰‹å¤´çš„å·¥ä½œæ›´å°‘,ä½†æ˜¯è¿˜ä¸å¤Ÿ,è¿˜æ˜¯å­˜åœ¨è®¸å¤šéœ€è¦æ‰‹åŠ¨æ›´æ”¹çš„åœ°æ–¹,
æ¯”å¦‚æ¯ç¯‡æ–‡ç« çš„æ²¡æœ‰æ›¿æ¢æ‰çš„å›¾ç‰‡é“¾æ¥&lt;/p&gt;
&lt;h3 id="_8"&gt;ä¸è¶³&lt;/h3&gt;
&lt;p&gt;ç½‘ç«™è¿ç§»åæˆ‘å·²ç»å°½åŠ›çš„æ¥ä¿æŒåŸæ¥çš„é“¾æ¥æœ‰æ•ˆ,ä½†æ˜¯æˆ‘ä»…ä»…çŸ¥é“æˆ‘åŸæ¥çš„wordpressçš„é“¾æ¥,æ‰€ä»¥ä»…ä»…å…¼å®¹äº†æˆ‘åŸæ¥ä½¿ç”¨wordpressçš„æ—§é“¾æ¥,å¦‚æœæ²¡èƒ½å…¼å®¹æ‚¨çš„wordpressçš„é“¾æ¥åœ¨æ­¤è¡¨ç¤ºæ­‰æ„,æ‚¨å¯ä»¥è‡ªå·±æ·»åŠ æäº¤ç»™æˆ‘,æˆ–è€…å°†æ‚¨çš„é“¾æ¥æäº¤ç»™æˆ‘ç”±æˆ‘æ¥ç»™æ‚¨æ·»åŠ &lt;/p&gt;
&lt;h2 id="nginx"&gt;ç»“åˆnginx&lt;/h2&gt;
&lt;p&gt;å‚é˜…&lt;a href="http://www.tornadoweb.cn/documentation#_14"&gt;tornadoæ–‡æ¡£&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="_9"&gt;æºä»£ç &lt;/h2&gt;
&lt;p&gt;ä»£ç æ”¾åœ¨githubä¸Š: &lt;a href="https://github.com/coldnight/vlog"&gt;vLog&lt;/a&gt;&lt;/p&gt;</content><category term="Python"></category><category term="vLog"></category><category term="tornado"></category><category term="blog"></category><category term="åšå®¢"></category><category term="è½»é‡"></category><category term="markdown"></category></entry><entry><title>ä½¿ç”¨æ›´åŠ é«˜æ•ˆçš„epollä½œä¸ºpyxmpp2çš„ä¸»å¾ªç¯</title><link href="https://www.linuxzen.com/shi-yong-geng-jia-gao-xiao-de-epollzuo-wei-pyxmpp2de-zhu-xun-huan.html" rel="alternate"></link><published>2013-02-05T16:06:00+08:00</published><updated>2013-02-05T16:06:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-02-05:/shi-yong-geng-jia-gao-xiao-de-epollzuo-wei-pyxmpp2de-zhu-xun-huan.html</id><summary type="html">&lt;h2 id="_1"&gt;å¼•å­&lt;/h2&gt;
&lt;p&gt;ä¹‹å‰&lt;a href="/python-shi-yong-pyxmpp2bian-xie-gtalkqun.html"&gt;clubot&lt;/a&gt;ä½¿ç”¨çš„pyxmpp2çš„é»˜è®¤mainloopä¹Ÿå°±æ˜¯ä¸€ä¸ªpollçš„ä¸»å¾ªç¯,ä½†æ˜¯&lt;code&gt;clubot&lt;/code&gt;ä¸Šçº¿åèµ„æºå ç”¨éå¸¸å‰å®³,ä½¿ç”¨&lt;code&gt;strace&lt;/code&gt;è·Ÿè¸ªå‘ç°&lt;code&gt;clubot&lt;/code&gt;åœ¨ä¸åœçš„&lt;code&gt;poll&lt;/code&gt;,æŸ¥çœ‹&lt;code&gt;pyxmpp2&lt;/code&gt;ä»£ç å‘ç°&lt;code&gt;pyxmpp2&lt;/code&gt;çš„&lt;code&gt;poll&lt;/code&gt;åœ¨ä½¿ç”¨è¶… â€¦&lt;/p&gt;</summary><content type="html">&lt;h2 id="_1"&gt;å¼•å­&lt;/h2&gt;
&lt;p&gt;ä¹‹å‰&lt;a href="/python-shi-yong-pyxmpp2bian-xie-gtalkqun.html"&gt;clubot&lt;/a&gt;ä½¿ç”¨çš„pyxmpp2çš„é»˜è®¤mainloopä¹Ÿå°±æ˜¯ä¸€ä¸ªpollçš„ä¸»å¾ªç¯,ä½†æ˜¯&lt;code&gt;clubot&lt;/code&gt;ä¸Šçº¿åèµ„æºå ç”¨éå¸¸å‰å®³,ä½¿ç”¨&lt;code&gt;strace&lt;/code&gt;è·Ÿè¸ªå‘ç°&lt;code&gt;clubot&lt;/code&gt;åœ¨ä¸åœçš„&lt;code&gt;poll&lt;/code&gt;,æŸ¥çœ‹&lt;code&gt;pyxmpp2&lt;/code&gt;ä»£ç å‘ç°&lt;code&gt;pyxmpp2&lt;/code&gt;çš„&lt;code&gt;poll&lt;/code&gt;åœ¨ä½¿ç”¨è¶…æ—¶é˜»å¡æ—¶ä½¿ç”¨&lt;code&gt;æœ€å°&lt;/code&gt;è¶…æ—¶æ—¶é—´,è€Œ&lt;code&gt;æœ€å°&lt;/code&gt;è¶…æ—¶æ—¶é—´ä¸€ç›´æ˜¯0,æ‰€ä»¥ä¼šå˜æˆä¸€ä¸ªæ²¡æœ‰è¶…æ—¶çš„éé˜»å¡&lt;code&gt;poll&lt;/code&gt;å¾ˆæµªè´¹èµ„æº,ä¸æ‰“ç®—æ›´æ”¹åº“ä»£ç ,æ‰€ä»¥è‡ªå·±ä»¿ç…§pollçš„mainloopå†™äº†ä¸€ä¸ªæ›´åŠ é«˜æ•ˆçš„&lt;code&gt;epoll&lt;/code&gt;çš„mainloop&lt;/p&gt;
&lt;h2 id="_2"&gt;å®ç°&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c1"&gt;# -*- coding:utf-8 -*-&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#   Author  :   cold&lt;/span&gt;
&lt;span class="c1"&gt;#   E-mail  :   wh_linux@126.com&lt;/span&gt;
&lt;span class="c1"&gt;#   Date    :   13/01/06 10:41:31&lt;/span&gt;
&lt;span class="c1"&gt;#   Desc    :   Clubot epoll mainloop&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;__future__&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;absolute_import&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;division&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;select&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pyxmpp2.mainloop.interfaces&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;HandlerReady&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PrepareAgain&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pyxmpp2.mainloop.base&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;MainLoopBase&lt;/span&gt;

&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;plugin.util&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;get_logger&lt;/span&gt;



&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;EpollMainLoop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MainLoopBase&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot; Main event loop based on the epoll() syscall on Linux system &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;READ_ONLY&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EPOLLIN&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EPOLLPRI&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EPOLLHUP&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;
                 &lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EPOLLERR&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EPOLLET&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;READ_WRITE&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;READ_ONLY&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EPOLLOUT&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;settings&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;handlers&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;epoll&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;epoll&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_handlers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_unprepared_handlers&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_timeout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_exists_fd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;logger&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;get_logger&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;MainLoopBase&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;handlers&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="k"&gt;return&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;_add_io_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_unprepared_handlers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_configure_io_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;_configure_io_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;check_events&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;handler&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_unprepared_handlers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;old_fileno&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_unprepared_handlers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="n"&gt;prepared&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_prepare_io_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;old_fileno&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;
            &lt;span class="n"&gt;prepared&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
        &lt;span class="n"&gt;fileno&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fileno&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;old_fileno&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;fileno&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="n"&gt;old_fileno&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;del&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_handlers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;old_fileno&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_exists&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;old_fileno&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;epoll&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unregister&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;old_fileno&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;prepared&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_unprepared_handlers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fileno&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;fileno&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt;

        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_handlers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;fileno&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;handler&lt;/span&gt;
        &lt;span class="n"&gt;events&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;is_readable&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
            &lt;span class="n"&gt;events&lt;/span&gt; &lt;span class="o"&gt;|=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;READ_ONLY&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;is_writable&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
            &lt;span class="n"&gt;events&lt;/span&gt; &lt;span class="o"&gt;|=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;READ_WRITE&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;events&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;fileno&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_exists_fd&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;epoll&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;modify&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fileno&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;events&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_exists_fd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="n"&gt;fileno&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;epoll&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;register&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fileno&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;events&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;_prepare_io_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;ret&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;prepare&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;isinstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ret&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;HandlerReady&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="k"&gt;del&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_unprepared_handlers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="n"&gt;prepared&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
        &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="nb"&gt;isinstance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ret&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PrepareAgain&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;ret&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;timeout&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_timeout&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_timeout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_timeout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;ret&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;timeout&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                    &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_timeout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ret&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;timeout&lt;/span&gt;
            &lt;span class="n"&gt;prepared&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;TypeError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Unexpected result from prepare()&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;prepared&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;_remove_io_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;handler&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_unprepared_handlers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;old_fileno&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_unprepared_handlers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="k"&gt;del&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_unprepared_handlers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;old_fileno&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fileno&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;old_fileno&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;del&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_handlers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;old_fileno&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_exists&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;old_fileno&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;epoll&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;unregister&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;old_fileno&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;KeyError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;pass&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;loop_iteration&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;timeout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;60&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;next_timeout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sources_handled&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_call_timeout_handlers&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;check_events&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_quit&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;sources_handled&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;handler&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_unprepared_handlers&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_configure_io_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;handler&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_timeout&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;timeout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;timeout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_timeout&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;next_timeout&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;timeout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;min&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;next_timeout&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;timeout&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;timeout&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;timeout&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;    &lt;span class="c1"&gt;# å¸¦æœ‰è¶…æ—¶çš„éé˜»å¡,è§£çº¦èµ„æº&lt;/span&gt;
        &lt;span class="n"&gt;events&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;epoll&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;poll&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;timeout&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;events&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EPOLLIN&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EPOLLPRI&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EPOLLET&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_handlers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;handle_read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EPOLLOUT&lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EPOLLET&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_handlers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;handle_write&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EPOLLERR&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EPOLLET&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_handlers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;handle_err&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;flag&lt;/span&gt; &lt;span class="o"&gt;&amp;amp;&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EPOLLHUP&lt;/span&gt; &lt;span class="o"&gt;|&lt;/span&gt; &lt;span class="n"&gt;select&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;EPOLLET&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_handlers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;handle_hup&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
            &lt;span class="c1"&gt;#if flag &amp;amp; select.EPOLLNVAL:&lt;/span&gt;
                &lt;span class="c1"&gt;#self._handlers[fd].handle_nval()&lt;/span&gt;

            &lt;span class="n"&gt;sources_handled&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_configure_io_handler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_handlers&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;sources_handled&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="_3"&gt;ä½¿ç”¨&lt;/h2&gt;
&lt;p&gt;å¦‚ä½•ä½¿ç”¨æ–°çš„mainloop?åªéœ€åœ¨å®ä¾‹åŒ–Clientæ—¶ä¼ å…¥&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;mainloop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;EpollMainLoop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;client&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;my_jid&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;version_provider&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;settings&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mainloop&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ ·å°±ä¼šä½¿ç”¨epollä½œä¸ºmainloop&lt;/p&gt;
&lt;h2 id="_4"&gt;æ³¨æ„&lt;/h2&gt;
&lt;p&gt;epollä»…ä»…åœ¨&lt;code&gt;Linux&lt;/code&gt;ä¸‹æ”¯æŒ&lt;/p&gt;
&lt;h2 id="_5"&gt;å†™åœ¨åé¢çš„è¯&lt;/h2&gt;
&lt;p&gt;æ¬¢è¿å¤§å®¶åŠ å…¥åˆ°&lt;code&gt;clubot@vim-cn.com&lt;/code&gt;ä¸­æ¥è®¨è®ºæœ‰å…³Python/vim/Linux/å¼€æºç­‰è¯é¢˜&lt;/p&gt;</content><category term="Python"></category><category term="epoll"></category><category term="python"></category><category term="gtalk"></category><category term="ç¾¤"></category><category term="Linux"></category><category term="clubot"></category></entry><entry><title>Python é‡å¤å®‰è£…åŒ…æŠ¥é”™</title><link href="https://www.linuxzen.com/python-zhong-fu-an-zhuang-bao-bao-cuo.html" rel="alternate"></link><published>2013-01-25T14:55:00+08:00</published><updated>2013-01-25T14:55:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-01-25:/python-zhong-fu-an-zhuang-bao-bao-cuo.html</id><summary type="html">&lt;p&gt;æœ€è¿‘å†™ç¨‹åºç”¨åˆ°argparseæ€»æ˜¯ä¼šæŠ¥é”™&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;/usr/lib/python2.7/dist-packages/pygments/plugin.py:39: UserWarning: Module argparse was already imported from /usr/lib/python2.7/argparse.pyc, but /usr/local/lib/python2.7/dist-packages is being added to sys.path
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸€å¼€å§‹ä¹Ÿæ²¡æ€ä¹ˆ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;æœ€è¿‘å†™ç¨‹åºç”¨åˆ°argparseæ€»æ˜¯ä¼šæŠ¥é”™&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;/usr/lib/python2.7/dist-packages/pygments/plugin.py:39: UserWarning: Module argparse was already imported from /usr/lib/python2.7/argparse.pyc, but /usr/local/lib/python2.7/dist-packages is being added to sys.path
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸€å¼€å§‹ä¹Ÿæ²¡æ€ä¹ˆåœ¨æ„,ä¸å½±å“ä»€ä¹ˆ,ä½†æ˜¯åæ¥æ€»æ˜¯å‡ºæ¥ä¸¥é‡å½±å“å¿ƒæƒ…,google äº†æ²¡å•¥æ˜ç¡®çš„æŠ¥é”™,åæ¥ä»”ç»†çœ‹æŠ¥é”™ä¿¡æ¯,æƒ³èµ·æ¥ä»¥å‰å¯èƒ½åº„è¿‡argparseè¿™ä¸ªåŒ…æµ‹è¯•,ä½†æ˜¯æ²¡æœ‰åˆ é™¤
æ‰§è¡Œ&lt;code&gt;ls /usr/local/lib/python2.7/dist-packages/&lt;/code&gt;æŸ¥çœ‹æœç„¶æœ‰ä¸€ä¸ªargparse.&lt;/p&gt;
&lt;p&gt;æ‰§è¡Œ&lt;code&gt;sudo pip uninstall argparse&lt;/code&gt;çƒ¦äººçš„é”™è¯¯æç¤ºæ¶ˆå¤±äº†.&lt;/p&gt;</content><category term="Python"></category><category term="python"></category><category term="åŒ…"></category><category term="é‡å¤"></category><category term="å®‰è£…"></category><category term="å¸è½½"></category></entry><entry><title>Linux ä¸‹ä½¿ç”¨Pythonæˆªå›¾è‡ªåŠ¨åˆ†äº«</title><link href="https://www.linuxzen.com/linux-xia-shi-yong-pythonjie-tu-zi-dong-fen-xiang.html" rel="alternate"></link><published>2013-01-22T16:59:00+08:00</published><updated>2013-01-22T16:59:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-01-22:/linux-xia-shi-yong-pythonjie-tu-zi-dong-fen-xiang.html</id><summary type="html">&lt;h2 id="_1"&gt;å¼•å­&lt;/h2&gt;
&lt;p&gt;Linuxä¸‹ä¸æ”¯æŒQQç­‰åŠŸèƒ½ä¸°å¯Œçš„IM,è™½ç„¶å¯ä»¥é€šè¿‡wineè¿è¡ŒQQ2012,ä½†æ˜¯è¿˜æ˜¯å–œæ¬¢åœ¨gtalkç¾¤ä¸­èŠå¤©,gtalkç¾¤ä¸æ”¯æŒå›¾ç‰‡æ–¹å¼,è¿™å°±è¦é æˆ‘ä»¬å¤§å®¶è‡ªå·±æ¥è§£å†³äº†,&lt;a href="http://eleveni386.7axu.com"&gt;eleven&lt;/a&gt;å¼€æ”¾äº†ä¸€ä¸ªImageä¸Šä¼ å’Œæ˜¾ç¤ºæ¥å£,æä¾›äº†ä½¿ç”¨&lt;code&gt;curl&lt;/code&gt;æ¥è§£å†³,ä½† â€¦&lt;/p&gt;</summary><content type="html">&lt;h2 id="_1"&gt;å¼•å­&lt;/h2&gt;
&lt;p&gt;Linuxä¸‹ä¸æ”¯æŒQQç­‰åŠŸèƒ½ä¸°å¯Œçš„IM,è™½ç„¶å¯ä»¥é€šè¿‡wineè¿è¡ŒQQ2012,ä½†æ˜¯è¿˜æ˜¯å–œæ¬¢åœ¨gtalkç¾¤ä¸­èŠå¤©,gtalkç¾¤ä¸æ”¯æŒå›¾ç‰‡æ–¹å¼,è¿™å°±è¦é æˆ‘ä»¬å¤§å®¶è‡ªå·±æ¥è§£å†³äº†,&lt;a href="http://eleveni386.7axu.com"&gt;eleven&lt;/a&gt;å¼€æ”¾äº†ä¸€ä¸ªImageä¸Šä¼ å’Œæ˜¾ç¤ºæ¥å£,æä¾›äº†ä½¿ç”¨&lt;code&gt;curl&lt;/code&gt;æ¥è§£å†³,ä½†æ˜¯æˆ‘ä»¬å…¬å¸çš„ç½‘ç»œä½¿ç”¨&lt;code&gt;squid&lt;/code&gt;ç¦æ­¢äº†&lt;code&gt;curl&lt;/code&gt;çš„è®¿é—®,æ‰€ä»¥æ•´å¤©çœ‹ä»–ä»¬è¿™ä¹ˆçˆ½çš„åˆ†äº«å›¾ç‰‡æˆ‘ä¹Ÿä¸ç”˜å¿ƒé˜¿,æ‰€ä»¥å°±ä½¿ç”¨Pythonå†™äº†ä¸€ä¸ªåˆ†äº«å›¾ç‰‡çš„è„šæœ¬&lt;/p&gt;
&lt;h2 id="_2"&gt;å®ç°&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨scrotæˆªå›¾,ç„¶åä½¿ç”¨urllib2åº“ä¸Šä¼ å›¾ç‰‡,å¦‚æœå­˜åœ¨PyQt4åº“åˆ™ä¼šå°†ç»“æœæ”¾åˆ°å‰ªè´´æ¿ä¸Š,å¦‚æœä¸å­˜åœ¨åˆ™è¾“å‡º,è‡ªè¡Œå¤åˆ¶&lt;/p&gt;
&lt;h2 id="_3"&gt;ä»£ç &lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c1"&gt;# -*- coding:utf-8 -*-&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#   Author  :   cold&lt;/span&gt;
&lt;span class="c1"&gt;#   E-mail  :   wh_linux@126.com&lt;/span&gt;
&lt;span class="c1"&gt;#   Date    :   13/01/21 09:54:39&lt;/span&gt;
&lt;span class="c1"&gt;#   Desc    :   è´´ä»£ç å’Œå›¾ç‰‡&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;urllib2&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nn"&gt;json&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;mimetools&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;mimetypes&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;itertools&lt;/span&gt;

&lt;span class="n"&gt;__host__&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;http://eleveni386.7axu.com&amp;quot;&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Form&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form_fields&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;files&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;boundary&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mimetools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;choose_boundary&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;application/x-www-form-urlencoded&amp;quot;&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_content_type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;add_field&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form_fields&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;add_file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fieldname&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;fileHandle&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mimetype&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;body&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;fileHandle&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;mimetype&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;mimetype&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;mimetypes&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;guess_type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
                         &lt;span class="ow"&gt;or&lt;/span&gt;
                         &lt;span class="s1"&gt;&amp;#39;applicatioin/octet-stream&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;files&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="n"&gt;fieldname&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mimetype&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;content_type&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;multipart/form-data; boundary=&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;boundary&lt;/span&gt;

        &lt;span class="k"&gt;return&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__str__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;parts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
        &lt;span class="n"&gt;part_boundary&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;--&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;boundary&lt;/span&gt;

        &lt;span class="n"&gt;parts&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extend&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
            &lt;span class="p"&gt;[&lt;/span&gt; &lt;span class="n"&gt;part_boundary&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
             &lt;span class="s1"&gt;&amp;#39;Content-Disposition: form-data; name=&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;&amp;quot;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
             &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
             &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
             &lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;form_fields&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;files&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;parts&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extend&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;
                &lt;span class="n"&gt;part_boundary&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="s1"&gt;&amp;#39;Content-Disposition: form-data; name=&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;&amp;quot;; filename=&amp;quot;&lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;&amp;quot;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;\
                &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;
                &lt;span class="s1"&gt;&amp;#39;Content-Type: &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="n"&gt;body&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
            &lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;field_name&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content_type&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;body&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;files&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="n"&gt;flattened&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;itertools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;chain&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;parts&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;flattened&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;--&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;boundary&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;--&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;flattened&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\r\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;flattened&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;HttpHelper&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;GET&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_form&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_body&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_method&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_dst_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;make_request&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;make_request&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_url&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_url&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;startswith&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;http://&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;http://&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_url&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;urllib2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Request&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_form&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Content-Type&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_content_type&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Content-Length&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_body&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_data&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_body&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;add_header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;val&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;change&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;params&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{},&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;GET&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_params&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;params&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_method&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;make_request&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;urllib2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;urlopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_dst_url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;geturl&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;json&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loads&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;argparse&lt;/span&gt;
    &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt;
    &lt;span class="n"&gt;parser&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;argparse&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ArgumentParser&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_argument&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;dest&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;path&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;nargs&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;?&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;args&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;parser&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;parse_args&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;path&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/tmp/tmpscrot.png&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;system&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;scrot -s &lt;/span&gt;&lt;span class="si"&gt;{0}&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;form&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Form&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;filename&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;os&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_file&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;fieldname&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;mypic&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                  &lt;span class="n"&gt;fileHandle&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="n"&gt;http&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;HttpHelper&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;__host__&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/Image/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;form&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;PyQt4.QtGui&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;QApplication&lt;/span&gt;
        &lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QApplication&lt;/span&gt;&lt;span class="p"&gt;([])&lt;/span&gt;
        &lt;span class="n"&gt;cb&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;QApplication&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;clipboard&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;cb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setText&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;url&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="_4"&gt;å®‰è£…&lt;/h2&gt;
&lt;p&gt;å°†ä¸Šé¢ä»£ç ä¿å­˜ä¸€ä¸ªæ–‡ä»¶,æ”¾åœ¨&lt;code&gt;PATH&lt;/code&gt;è·¯å¾„é‡Œ,èµ‹äºˆ&lt;code&gt;æ‰§è¡Œæƒé™&lt;/code&gt;å³å¯&lt;/p&gt;
&lt;h2 id="_5"&gt;ä½¿ç”¨&lt;/h2&gt;
&lt;p&gt;é»˜è®¤çš„ä¸è·Ÿå›¾ç‰‡åœ°å€åˆ™ä¼šæˆªå›¾,æˆªå›¾å®Œæ¯•åè‡ªåŠ¨åˆ†äº«,å¦‚å®‰è£…äº†PyQt4åº“åˆ™ä¼šå°†ç»“æœæ”¾åˆ°å‰ªè´´æ¿,å¦‚æ²¡æœ‰åˆ™è¾“å‡ºç»“æœ.å¦‚æœè„šæœ¬ç»™äº†å›¾ç‰‡è·¯å¾„å‚æ•°åˆ™ä¸Šä¼ ç»™å®šè·¯å¾„çš„å›¾ç‰‡&lt;/p&gt;</content><category term="Python"></category><category term="Linux"></category><category term="scrot"></category><category term="æˆªå›¾"></category><category term="python"></category></entry><entry><title>vLogä½¿ç”¨Tornadoæ¡†æ¶ç»“åˆmemcachedç¼“å­˜é¡µé¢</title><link href="https://www.linuxzen.com/vlogshi-yong-tornadokuang-jia-jie-he-memcachedhuan-cun-ye-mian.html" rel="alternate"></link><published>2013-01-16T16:14:00+08:00</published><updated>2013-01-16T16:14:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-01-16:/vlogshi-yong-tornadokuang-jia-jie-he-memcachedhuan-cun-ye-mian.html</id><summary type="html">&lt;h2 id="_1"&gt;åŸå› &lt;/h2&gt;
&lt;p&gt;Blogæ˜¯ä¸€ä¸ªæ›´æ–°å¹¶ä¸å¾ˆé¢‘ç¹çš„ä¸€å¥—ç³»ç»Ÿ,ä½†æ˜¯æ¯æ¬¡åˆ·æ–°é¡µé¢éƒ½è¦æ›´æ–°æ•°æ®åº“åè€Œå¾ˆæµªè´¹èµ„æº,æ·»åŠ é™æ€é¡µé¢ç”Ÿæˆæ˜¯ä¸€ä¸ªè§£å†³åŠæ³•,åŒæ—¶ç¼“å­˜æ˜¯ä¸€ä¸ªæ›´å¥½çš„ â€¦&lt;/p&gt;</summary><content type="html">&lt;h2 id="_1"&gt;åŸå› &lt;/h2&gt;
&lt;p&gt;Blogæ˜¯ä¸€ä¸ªæ›´æ–°å¹¶ä¸å¾ˆé¢‘ç¹çš„ä¸€å¥—ç³»ç»Ÿ,ä½†æ˜¯æ¯æ¬¡åˆ·æ–°é¡µé¢éƒ½è¦æ›´æ–°æ•°æ®åº“åè€Œå¾ˆæµªè´¹èµ„æº,æ·»åŠ é™æ€é¡µé¢ç”Ÿæˆæ˜¯ä¸€ä¸ªè§£å†³åŠæ³•,åŒæ—¶ç¼“å­˜æ˜¯ä¸€ä¸ªæ›´å¥½çš„ä¸»æ„,å¯ä»¥ç»“åˆMemcachedæ·»åŠ å°‘é‡çš„ä»£ç è¿›è¡Œç¼“å­˜,è€Œä¸”å…å»å»äº†æ¯æ¬¡æ›´æ–°æ–‡ç« éƒ½è¦é‡æ–°ç”Ÿæˆé™æ€é¡µé¢,ç‰¹åˆ«å½“é¡µé¢ç‰¹åˆ«å¤šæ—¶.&lt;/p&gt;
&lt;h2 id="_2"&gt;å®ç°&lt;/h2&gt;
&lt;p&gt;ä¸»è¦é€šè¿‡é¡µé¢çš„uriè¿›è¡Œç¼“å­˜,ç»“åˆtornado.web.RequestHandlerçš„prepareå’Œon_finishæ–¹æ³•å‡½æ•°,
prepare ä¸»è¦æ˜¯è¯·æ±‚å‰æ‰§è¡Œ,on_finish()æ˜¯è¯·æ±‚ç»“æŸä¹‹å‰æ‰§è¡Œ.åœ¨æ¸²æŸ“æ¨¡æ¿æ—¶ç¼“å­˜é¡µé¢å†…å®¹,ç„¶ååœ¨è¯·æ±‚å‰æ£€æµ‹æ˜¯å¦æœ‰ç¼“å­˜,å¦‚æœæœ‰ç›´æ¥è¾“å‡ºç¼“å­˜,ç»“æŸè¯·æ±‚,åœ¨POSTæäº¤ä¹‹åæ¸…ç©ºæ‰€æœ‰ç¼“å­˜,é‡æ–°ç”Ÿæˆç¼“å­˜,ä»è€Œä¿è¯å†…å®¹å®æ—¶æ€§.ç”±äºç™»å½•ç”¨æˆ·å’Œæ™®é€šç”¨æˆ·çš„é¡µé¢ä¸ç›¸åŒ,æ‰€ä»¥ä¸ç¼“å­˜ç™»å½•ç”¨æˆ·é¡µé¢(ä»£ç ä¸­æ²¡æœ‰ä½“ç°,è¯·è‡ªè¡Œå®ç°).ä¸»è¦pythonä»£ç (çœç•¥äº†æ¨¡æ¿æ¸²æŸ“çš„ä»£ç ):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c1"&gt;# -*- coding:utf-8 -*-&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#   Author  :   cold&lt;/span&gt;
&lt;span class="c1"&gt;#   E-mail  :   wh_linux@126.com&lt;/span&gt;
&lt;span class="c1"&gt;#   Date    :   13/01/14 09:57:31&lt;/span&gt;
&lt;span class="c1"&gt;#   Desc    :   &lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;config&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pylibmc&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;tornado.web&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;RequestHandler&lt;/span&gt;
&lt;span class="c1"&gt;#### çœç•¥Cacheç±»å®šä¹‰ #####&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Memcached&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;_mc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pylibmc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Client&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CACHE_HOST&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;binary&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__enter__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CACHED&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Memcached&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Cache&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__exit__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;exc_type&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;exc_val&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;exc_tb&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;pass&lt;/span&gt;

    &lt;span class="nd"&gt;@classmethod&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_cache&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;cls&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;cls&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_mc&lt;/span&gt;

    &lt;span class="nd"&gt;@classmethod&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;cls&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;cls&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_mc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;default&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;

    &lt;span class="nd"&gt;@classmethod&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;cls&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;timeout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;timeout&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;timeout&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;timeout&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="n"&gt;config&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;CACHE_TIMEOUT&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;cls&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_mc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;timeout&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="nd"&gt;@classmethod&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;delete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;cls&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;cls&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_mc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;delete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="nd"&gt;@classmethod&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;cls&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;cls&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;_mc&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flush_all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__getattr__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Memcached&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__setattr__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;Memcached&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;BaseHandler&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;RequestHandler&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot; ç»§æ‰¿tornadoè¯·æ±‚åŸºç±»,é‡å†™ prepareå’Œon_finishæ–¹æ³• &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;cache&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Memcached&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;render&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;template_path&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kwargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot; æ¸²æŸ“æ¨¡æ¿ &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="c1"&gt;# çœç•¥æ¸²æŸ“æ¨¡æ¿ä»£ç &lt;/span&gt;
        &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;     &lt;span class="c1"&gt;# æ¸²æŸ“æ¨¡æ¿åçš„å†…å®¹&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;GET&amp;quot;&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;CACHED&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; \
           &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;startswith&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/admin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cache&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uri&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# å°†æ¸²æŸ“åçš„å†…å®¹ç¼“å­˜èµ·æ¥&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;prepare&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="nb"&gt;super&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;BaseHandler&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;prepare&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="c1"&gt;# å¦‚æœè¯·æ±‚æ˜¯GETæ–¹æ³•,è€Œä¸”ä¸æ˜¯è¯·æ±‚åå°&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;GET&amp;quot;&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="n"&gt;CACHED&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; \
           &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;startswith&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/admin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

            &lt;span class="c1"&gt;# å°è¯•è·å–å½“å‰é¡µé¢çš„ç¼“å­˜&lt;/span&gt;
            &lt;span class="n"&gt;cache&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cache&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;uri&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="c1"&gt;# è·å–ç¼“å­˜åˆ™è¾“å‡ºé¡µé¢,ç»“æŸè¯·æ±‚&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;cache&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;finish&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cache&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;on_finish&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot; é‡å†™ç»“æŸè¯·æ±‚å‰çš„æ–¹æ³•å‡½æ•° &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;method&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;POST&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="c1"&gt;# å¦‚æœé‡åˆ°POSTæäº¤åˆ™æ¸…ç©ºç¼“å­˜&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cache&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;flush&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç¼“å­˜ç³»ç»Ÿåœ¨&lt;code&gt;redis&lt;/code&gt;å’Œ&lt;code&gt;Memcached&lt;/code&gt;é€‰æ‹©äº†å¾ˆä¹…,å› ä¸ºåªæ˜¯å•çº¯çš„ç¼“å­˜é¡µé¢æ‰€ä»¥æœ€åé€‰æ‹©äº†&lt;code&gt;memcached&lt;/code&gt;,ä½¿ç”¨&lt;code&gt;pylibmc&lt;/code&gt; pythonåº“.&lt;/p&gt;
&lt;h2 id="_3"&gt;æµ‹è¯•&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨webbench ç½‘ç«™å‹åŠ›æµ‹è¯•å¯¹æ¯”äº†ç¼“å­˜å‰åçš„ç»“æœ:
ä½¿ç”¨ç¼“å­˜å‰&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;webbench&lt;span class="w"&gt; &lt;/span&gt;-c&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;500&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-t&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;http://www.linuxzen.com/
Webbench&lt;span class="w"&gt; &lt;/span&gt;-&lt;span class="w"&gt; &lt;/span&gt;Simple&lt;span class="w"&gt; &lt;/span&gt;Web&lt;span class="w"&gt; &lt;/span&gt;Benchmark&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.5
Copyright&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;c&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Radim&lt;span class="w"&gt; &lt;/span&gt;Kolar&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1997&lt;/span&gt;-2004,&lt;span class="w"&gt; &lt;/span&gt;GPL&lt;span class="w"&gt; &lt;/span&gt;Open&lt;span class="w"&gt; &lt;/span&gt;Source&lt;span class="w"&gt; &lt;/span&gt;Software.

Benchmarking:&lt;span class="w"&gt; &lt;/span&gt;GET&lt;span class="w"&gt; &lt;/span&gt;http://www.linuxzen.com/
&lt;span class="m"&gt;500&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;clients,&lt;span class="w"&gt; &lt;/span&gt;running&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;sec.

&lt;span class="nv"&gt;Speed&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;54&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;pages/min,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;38160&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;bytes/sec.
Requests:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;27&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;susceed,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;failed.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä½¿ç”¨ç¼“å­˜å:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;$&lt;span class="w"&gt; &lt;/span&gt;webbench&lt;span class="w"&gt; &lt;/span&gt;-c&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;500&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-t&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;http://www.linuxzen.com/
Webbench&lt;span class="w"&gt; &lt;/span&gt;-&lt;span class="w"&gt; &lt;/span&gt;Simple&lt;span class="w"&gt; &lt;/span&gt;Web&lt;span class="w"&gt; &lt;/span&gt;Benchmark&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.5
Copyright&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;c&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Radim&lt;span class="w"&gt; &lt;/span&gt;Kolar&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1997&lt;/span&gt;-2004,&lt;span class="w"&gt; &lt;/span&gt;GPL&lt;span class="w"&gt; &lt;/span&gt;Open&lt;span class="w"&gt; &lt;/span&gt;Source&lt;span class="w"&gt; &lt;/span&gt;Software.

Benchmarking:&lt;span class="w"&gt; &lt;/span&gt;GET&lt;span class="w"&gt; &lt;/span&gt;http://www.linuxzen.com/
&lt;span class="m"&gt;500&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;clients,&lt;span class="w"&gt; &lt;/span&gt;running&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;sec.

&lt;span class="nv"&gt;Speed&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;256&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;pages/min,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;238544&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;bytes/sec.
Requests:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;128&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;susceed,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;failed.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ˜æ˜¾å¿«äº†å¾ˆå¤š...&lt;/p&gt;</content><category term="Python"></category><category term="Linux"></category><category term="python"></category><category term="Memcached"></category><category term="pylibmc"></category><category term="ç¼“å­˜"></category><category term="vLog"></category></entry><entry><title>Vimé…ç½®ç³»åˆ—(äºŒ) â€”- å¥½çœ‹çš„statusline</title><link href="https://www.linuxzen.com/vimpei-zhi-xi-lie-er-hao-kan-de-statusline.html" rel="alternate"></link><published>2013-01-05T15:01:00+08:00</published><updated>2013-01-05T15:01:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-01-05:/vimpei-zhi-xi-lie-er-hao-kan-de-statusline.html</id><summary type="html">&lt;p&gt;Vimæ˜¯ä¸€æ¬¾æ–‡æœ¬ç¼–è¾‘å™¨,ä½†æ˜¯è¿™å¹¶ä¸å½±å“å®ƒæœ‰ä¸€ä¸ªå¥½çœ‹çš„å¤–è§‚,å¤§å®¶éƒ½çŸ¥é“Vimå¯ä»¥é€šè¿‡é…è‰²æ–¹æ¡ˆæ¥æ”¹å˜Vimçš„å¤–è§‚,æ»¡è¶³ä¸€äº›â€˜å¥½è‰²ä¹‹å¾’â€™,ä¹‹å‰å¤§å®¶å¯èƒ½ä¹Ÿä¸»æ„åˆ°æˆªå›¾ä¸­ä¸€ä¸ªéå¸¸æ¼‚äº® â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;Vimæ˜¯ä¸€æ¬¾æ–‡æœ¬ç¼–è¾‘å™¨,ä½†æ˜¯è¿™å¹¶ä¸å½±å“å®ƒæœ‰ä¸€ä¸ªå¥½çœ‹çš„å¤–è§‚,å¤§å®¶éƒ½çŸ¥é“Vimå¯ä»¥é€šè¿‡é…è‰²æ–¹æ¡ˆæ¥æ”¹å˜Vimçš„å¤–è§‚,æ»¡è¶³ä¸€äº›â€˜å¥½è‰²ä¹‹å¾’â€™,ä¹‹å‰å¤§å®¶å¯èƒ½ä¹Ÿä¸»æ„åˆ°æˆªå›¾ä¸­ä¸€ä¸ªéå¸¸æ¼‚äº®çš„statusline,è¿™æ˜¯é€šè¿‡Vimçš„ä¸€ä¸ªPowerlineçš„æ’ä»¶å®ç°çš„.ä¹‹å‰æˆ‘ä»¬é…ç½®äº†Vundleçš„æ’ä»¶ç®¡ç†(ä¼ é€é—¨)æˆ‘ä»¬å¯ä»¥ç”¨Vundleå®‰è£…Powerline,åœ¨.vimrc(Windowså¯èƒ½æ˜¯_vimrc)ä¸­æ·»åŠ :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Bundle &lt;span class="s2"&gt;&amp;quot;Lokaltog/vim-powerline&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åé‡æ–°æ‰“å¼€vimæ‰§è¡Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="p"&gt;:&lt;/span&gt;BundleInstall
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœä½ å’Œgithubç•…é€šçš„è¯å°±ä¼šé¡ºåˆ©å®‰è£…æ’ä»¶,ç„¶ååœ¨.vimrcé‡Œæ·»åŠ &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nb"&gt;laststatus&lt;/span&gt;&lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;
&lt;span class="k"&gt;let&lt;/span&gt; &lt;span class="k"&gt;g&lt;/span&gt;:Powerline_symbols&lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;unicode&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœgvimæ‰“å¼€éœ€è¦ä½¿ç”¨/path/to/your/bundle/vim-powerline/fontpatcher/fontpatcherç»™å½“å‰gvimä½¿ç”¨çš„å­—ä½“æ‰“ä¸Šè¡¥ä¸(ä¾èµ–éœ€è¦fontforgeå’Œpython)&lt;/p&gt;
&lt;p&gt;ç„¶åé‡æ–°æ‰“å¼€vimä½ å°±ä¼šå‘ç°ä¸€ä¸ªæ¼‚äº®çš„statusline&lt;/p&gt;
&lt;p&gt;&lt;img alt="å¥½çœ‹çš„statusline" src="/upload/VimPythonComment1.png"&gt;&lt;/p&gt;</content><category term="Vim"></category><category term="é…ç½®"></category><category term="ç³»åˆ—"></category><category term="æ¼‚äº®"></category><category term="æ’ä»¶"></category><category term="vim"></category><category term="statusline"></category><category term="Powerline"></category></entry><entry><title>Vim ç»“åˆPythonç¼–å†™çš„ç¿»è¯‘æ’ä»¶</title><link href="https://www.linuxzen.com/vim-jie-he-pythonbian-xie-de-fan-yi-cha-jian.html" rel="alternate"></link><published>2013-01-04T17:58:00+08:00</published><updated>2013-01-04T17:58:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2013-01-04:/vim-jie-he-pythonbian-xie-de-fan-yi-cha-jian.html</id><summary type="html">&lt;p&gt;æœ€è¿‘é‡å†™äº†ä¸€ä¸‹ä¹‹å‰ç”¨Pythonå†™çš„ä¸€ä¸ªç»ˆç«¯ç¿»è¯‘å·¥å…·,æƒ³ç€Vim7.3 æ”¯æŒPythonäºæ˜¯æƒ³å°†è¿™ä¸ªåŠŸèƒ½å†™ä¸ºä¸€ä¸ªæ’ä»¶è®©Vimä¹Ÿæ”¯æŒç¿»è¯‘åŠŸèƒ½,ç°åœ¨è‹±æ±‰ç¿»è¯‘æ¯”è¾ƒå®Œå–„, &lt;Leader&gt;tä¼šç¿»è¯‘å…‰æ ‡ä¸‹å•è¯,é€‰ä¸­çš„ç¿»è¯‘è¿˜ä¸å®Œå–„,ä»…ä»…æ˜¯ä¸ªåŠæˆå“,åœ¨æ­¤æŠ›ç –å¼• â€¦&lt;/leader&gt;&lt;/p&gt;</summary><content type="html">&lt;p&gt;æœ€è¿‘é‡å†™äº†ä¸€ä¸‹ä¹‹å‰ç”¨Pythonå†™çš„ä¸€ä¸ªç»ˆç«¯ç¿»è¯‘å·¥å…·,æƒ³ç€Vim7.3 æ”¯æŒPythonäºæ˜¯æƒ³å°†è¿™ä¸ªåŠŸèƒ½å†™ä¸ºä¸€ä¸ªæ’ä»¶è®©Vimä¹Ÿæ”¯æŒç¿»è¯‘åŠŸèƒ½,ç°åœ¨è‹±æ±‰ç¿»è¯‘æ¯”è¾ƒå®Œå–„, &lt;Leader&gt;tä¼šç¿»è¯‘å…‰æ ‡ä¸‹å•è¯,é€‰ä¸­çš„ç¿»è¯‘è¿˜ä¸å®Œå–„,ä»…ä»…æ˜¯ä¸ªåŠæˆå“,åœ¨æ­¤æŠ›ç –å¼•ç‰.å°†ä¸‹é¢ä»£ç å¤åˆ¶ä¿å­˜ä¸ºtranslate.vim æ”¾åˆ°~/.vim/pluginç›®å½•ä¸‹å³å¯,ä»£ç å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c"&gt;&amp;quot;   Author  :   cold&lt;/span&gt;
&lt;span class="c"&gt;&amp;quot;   E-mail  :   wh_linux@126.com&lt;/span&gt;
&lt;span class="c"&gt;&amp;quot;   Date    :   2012/12/20 16:23&lt;/span&gt;
&lt;span class="c"&gt;&amp;quot;   Desc    :   è‹±æ±‰/æ±‰è‹±ç¿»è¯‘æ’ä»¶&lt;/span&gt;
&lt;span class="c"&gt;&amp;quot;   Useage  :&lt;/span&gt;
&lt;span class="c"&gt;&amp;quot;                  &amp;lt;Leader&amp;gt; t ç¿»è¯‘å½“å‰å…‰æ ‡ä¸‹å†…å®¹ //XXX ä¸­æ–‡ä¸è¡Œ&lt;/span&gt;
&lt;span class="c"&gt;&amp;quot;                  &amp;lt;Leader&amp;gt; lt ç¿»è¯‘å½“å‰è¡Œ&lt;/span&gt;
&lt;span class="c"&gt;&amp;quot;                  &amp;lt;Leader&amp;gt; vt ç¿»è¯‘é€‰ä¸­çš„å†…å®¹&lt;/span&gt;

&lt;span class="k"&gt;function&lt;/span&gt; GetCursorWord&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;let&lt;/span&gt; column &lt;span class="p"&gt;=&lt;/span&gt; get&lt;span class="p"&gt;(&lt;/span&gt;getpos&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;-&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;let&lt;/span&gt; line &lt;span class="p"&gt;=&lt;/span&gt; getline&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;let&lt;/span&gt; word &lt;span class="p"&gt;=&lt;/span&gt; strpart&lt;span class="p"&gt;(&lt;/span&gt;line&lt;span class="p"&gt;,&lt;/span&gt; column&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;let&lt;/span&gt; &lt;span class="k"&gt;start&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
        &lt;span class="k"&gt;let&lt;/span&gt; tmp &lt;span class="p"&gt;=&lt;/span&gt; strpart&lt;span class="p"&gt;(&lt;/span&gt;line&lt;span class="p"&gt;,&lt;/span&gt; column &lt;span class="p"&gt;+&lt;/span&gt; &lt;span class="k"&gt;start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; tmp &lt;span class="p"&gt;=~&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;[a-zA-Z]&amp;quot;&lt;/span&gt;
            &lt;span class="k"&gt;let&lt;/span&gt; word &lt;span class="p"&gt;=&lt;/span&gt; word . tmp
        &lt;span class="k"&gt;else&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;
        &lt;span class="k"&gt;endif&lt;/span&gt;
        &lt;span class="k"&gt;let&lt;/span&gt; &lt;span class="k"&gt;start&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="k"&gt;start&lt;/span&gt; &lt;span class="p"&gt;+&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;endwhile&lt;/span&gt;
    &lt;span class="k"&gt;let&lt;/span&gt; &lt;span class="k"&gt;start&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
        &lt;span class="k"&gt;let&lt;/span&gt; tmp &lt;span class="p"&gt;=&lt;/span&gt; strpart&lt;span class="p"&gt;(&lt;/span&gt;line&lt;span class="p"&gt;,&lt;/span&gt; column &lt;span class="p"&gt;-&lt;/span&gt; &lt;span class="k"&gt;start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; tmp &lt;span class="p"&gt;=~&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;[a-zA-Z]&amp;#39;&lt;/span&gt;
            &lt;span class="k"&gt;let&lt;/span&gt; word &lt;span class="p"&gt;=&lt;/span&gt; tmp . word
        &lt;span class="k"&gt;else&lt;/span&gt;
            &lt;span class="k"&gt;break&lt;/span&gt;
        &lt;span class="k"&gt;endif&lt;/span&gt;
        &lt;span class="k"&gt;let&lt;/span&gt; &lt;span class="k"&gt;start&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="k"&gt;start&lt;/span&gt; &lt;span class="p"&gt;+&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;endwhile&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; word
endfunc

&lt;span class="k"&gt;function&lt;/span&gt; Translate&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;m&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c"&gt;    &amp;quot; m 1 -&amp;gt; ç¿»è¯‘å½“å‰è¡Œ&lt;/span&gt;
&lt;span class="c"&gt;    &amp;quot; m 2 -&amp;gt; ç¿»è¯‘é€‰ä¸­&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="k"&gt;mode&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="p"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;n&amp;#39;&lt;/span&gt;
        &lt;span class="k"&gt;let&lt;/span&gt; word &lt;span class="p"&gt;=&lt;/span&gt; GetCursorWord&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="c"&gt;&amp;quot; å¦‚æœæ˜¯å‘½ä»¤æ¨¡å¼åˆ™å–å½“å‰å­—ç¬¦ä¸‹å•è¯&lt;/span&gt;
    &lt;span class="k"&gt;endif&lt;/span&gt;
&lt;span class="c"&gt;    &amp;quot;XXX Visual æ¨¡å¼mode()å‘½ä»¤è¿”å›n&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="k"&gt;a&lt;/span&gt;:&lt;span class="k"&gt;m&lt;/span&gt; &lt;span class="p"&gt;==&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;
        &lt;span class="k"&gt;let&lt;/span&gt; word &lt;span class="p"&gt;=&lt;/span&gt; getreg&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;*&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;     &lt;span class="c"&gt;&amp;quot; å¦‚æœæ˜¯é€‰æ‹©æ¨¡å¼è·å–é€‰æ‹©å—&lt;/span&gt;

    &lt;span class="k"&gt;endif&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="k"&gt;a&lt;/span&gt;:&lt;span class="k"&gt;m&lt;/span&gt; &lt;span class="p"&gt;==&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt;
        &lt;span class="k"&gt;let&lt;/span&gt; word &lt;span class="p"&gt;=&lt;/span&gt; getline&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;endif&lt;/span&gt;
&lt;span class="k"&gt;python&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;&amp;lt;&lt;/span&gt; EOF

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;vim&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;urllib&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;urllib2&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Translate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;object&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot; ä½¿ç”¨googleè¿›è¡Œè‹±-&amp;gt;æ±‰, æ±‰-&amp;gt;è‹±çš„ç¿»è¯‘ &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;zh-CN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dst&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;en&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;http://translate.google.cn/translate_a/t&amp;#39;&lt;/span&gt;
        &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;client&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;t&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                           &lt;span class="n"&gt;hl&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;zh-CN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tl&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dst&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                           &lt;span class="n"&gt;multires&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;prev&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;btn&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                           &lt;span class="n"&gt;ssel&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;src&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;hl&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sl&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="k"&gt;return&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;loads&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot; åŠ è½½ç¿»è¯‘ç»“æœ &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;,,&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;[,&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,,&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;,&amp;quot;&amp;quot;,&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;[,&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;[&amp;quot;&amp;quot;,&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="c1"&gt;#content = content.replace(&amp;#39;,]&amp;#39;, &amp;#39;&amp;quot;&amp;quot;,]&amp;#39;)&lt;/span&gt;
        &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;eval&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;desc&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;pinyin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="n"&gt;others&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;desc&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;others&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
                &lt;span class="n"&gt;others&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="se"&gt;\t&lt;/span&gt;&lt;span class="si"&gt;{0}&lt;/span&gt;&lt;span class="se"&gt;\t&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]:&lt;/span&gt;
                    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                        &lt;span class="n"&gt;others&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;
        &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
            &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
            &lt;span class="n"&gt;source&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt;
            &lt;span class="n"&gt;pinyin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pinyin&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
        &lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;translate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot; è°ƒç”¨googleç¿»è¯‘ &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;params&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;urllib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;urlencode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;req&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;urllib2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Request&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;params&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;req&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;User-Agent&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                       &lt;span class="s2"&gt;&amp;quot;Mozilla/5.0+(compatible;+Googlebot/2.1;&amp;quot;&lt;/span&gt;
                       &lt;span class="s2"&gt;&amp;quot;++http://www.google.com/bot.html)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="n"&gt;res&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;urllib2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;urlopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;req&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;res&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;loads&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;auto_translate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot; è‡ªåŠ¨æ£€æµ‹å½“å‰è¯­è¨€è¿›è¡Œç¿»è¯‘ &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
    &lt;span class="n"&gt;text&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;decode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;z&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;src&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;zh-CN&amp;#39;&lt;/span&gt;
        &lt;span class="n"&gt;dst&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;en&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;src&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;en&amp;#39;&lt;/span&gt;
        &lt;span class="n"&gt;dst&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;zh-CN&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Translate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;encode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;src&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;dst&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;translate&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;

&lt;span class="n"&gt;word&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;vim&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;eval&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;word&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;auto_translate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;word&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="n"&gt;vim&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;echo &amp;quot;æºè¯: &amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;source&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;vim&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;echo &amp;quot;ç»“æœ: &amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;result&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;vim&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;echo &amp;quot;æ‹¼éŸ³: &amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;pinyin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;others&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;vim&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;echo &amp;quot;å…¶ä»–é‡Šä¹‰: &amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;vim&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;echo &amp;quot;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;others&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

EOF

endfunc
nmap &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;Leader&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;&lt;span class="k"&gt;t&lt;/span&gt; :&lt;span class="k"&gt;call&lt;/span&gt; Translate&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;cr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
nmap &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;Leader&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;&lt;span class="k"&gt;lt&lt;/span&gt; :&lt;span class="k"&gt;call&lt;/span&gt; Translate&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;cr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;span class="c"&gt;&amp;quot;XXX æ— æ³•åˆ¤æ–­å½“å‰æ¨¡å¼,ä½¿ç”¨æ˜ å°„æ›¿ä»£&lt;/span&gt;
map &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;Leader&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;&lt;span class="k"&gt;ts&lt;/span&gt; :&lt;span class="k"&gt;call&lt;/span&gt; Translate&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;cr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Vim"></category><category term="ç¿»è¯‘"></category><category term="æ’ä»¶"></category><category term="vim"></category><category term="python"></category></entry><entry><title>Vimé…ç½®ç³»åˆ—(ä¸€) ---- æ’ä»¶ç®¡ç†</title><link href="https://www.linuxzen.com/vimpei-zhi-xi-lie-yi-cha-jian-guan-li.html" rel="alternate"></link><published>2012-12-14T08:57:00+08:00</published><updated>2012-12-14T08:57:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-12-14:/vimpei-zhi-xi-lie-yi-cha-jian-guan-li.html</id><summary type="html">&lt;p&gt;æœ€è¿‘å¯¹Vimè¿›è¡Œäº†ä¸€ç•ªè¾ƒå¤§çš„é…ç½®å˜åŠ¨,æ‰€ä»¥å°±æƒ³å†™å‡ºä¸€ä¸ªç³»åˆ—æ¥å°†é…ç½®è¿‡ç¨‹åˆ†äº«ä¸‹æ¥,ä¾›éœ€è¦çš„æœ‹å‹å‚è€ƒ.æˆ‘ä»¬ä¹‹å‰é…ç½®Vimæ’ä»¶æ˜¯ä¸€å¤§åŠ©åŠ›,å¯ä»¥å¸®åŠ©æˆ‘ä»¬åšä¸€äº›æ¯”è¾ƒ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;æœ€è¿‘å¯¹Vimè¿›è¡Œäº†ä¸€ç•ªè¾ƒå¤§çš„é…ç½®å˜åŠ¨,æ‰€ä»¥å°±æƒ³å†™å‡ºä¸€ä¸ªç³»åˆ—æ¥å°†é…ç½®è¿‡ç¨‹åˆ†äº«ä¸‹æ¥,ä¾›éœ€è¦çš„æœ‹å‹å‚è€ƒ.æˆ‘ä»¬ä¹‹å‰é…ç½®Vimæ’ä»¶æ˜¯ä¸€å¤§åŠ©åŠ›,å¯ä»¥å¸®åŠ©æˆ‘ä»¬åšä¸€äº›æ¯”è¾ƒcoolæˆ–è¿™æ¯”è¾ƒå®ç”¨çš„åŠŸèƒ½,ä½†æ˜¯æˆ‘ä¹‹å‰éƒ½æ˜¯ç›´æ¥æœç´¢æ’ä»¶ç„¶åä¸‹è½½ä¸‹æ¥,æ‰‹åŠ¨æ‹·è´åˆ°ç›¸åº”çš„æ’ä»¶,è¿™ç§æ„Ÿè§‰è‚¯å®šæ˜¯ä¸çˆ½,ä¸ç®¡æ˜¯Linuxè¿˜æ˜¯Python/Rubyéƒ½æœ‰ä¸€å¥—è‡ªå·±çš„åŒ…ç®¡ç†å™¨,å¯ä»¥æ¯”è¾ƒæ™ºèƒ½çš„æœç´¢/å®‰è£…/å‡çº§/å¸è½½åŒ….Vimä¹Ÿæœ‰ç±»ä¼¼åŠŸèƒ½çš„æ’ä»¶Vundle,ä»–æ˜¯ä¸€æ¬¾Vimæ’ä»¶ç®¡ç†å™¨,ä¾èµ–äºgit,gitæ˜¯ä¸€æ¬¾éå¸¸æ£’çš„VCSè¿™é‡Œä¸åšä»‹ç»,æœ‰å…´è¶£çš„å¯ä»¥äº†è§£ä¸€ä¸‹.Vundleå¯ä»¥æ ¹æ®é…ç½®æ–‡ä»¶çš„githubæˆ–å…¶ä»–gitçš„è·¯å¾„è‡ªè¡Œå®‰è£…/å‡çº§æ’ä»¶.ä¸‹é¢æˆ‘ä»¬æ¥ä»‹ç»å¦‚ä½•å®‰è£…:
é¦–å…ˆåœ¨ä½ çš„~/.vimä¸‹æˆ–è€…$VIM/vimfiles($VIMæ˜¯vimçš„å®‰è£…è·¯å¾„)åˆ›å»ºbundleç›®å½•&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mkdir&lt;span class="w"&gt; &lt;/span&gt;~/.vim/bundle
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åä½¿ç”¨gitå…‹éš†Vundleé¡¹ç›®:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;git&lt;span class="w"&gt; &lt;/span&gt;clone&lt;span class="w"&gt; &lt;/span&gt;https://github.com/gmarik/vundle.git&lt;span class="w"&gt; &lt;/span&gt;~/.vim/bundle/vundle
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶ååœ¨ä½ çš„.vimrcé‡Œæ·»åŠ ä¸‹é¢å†…å®¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nb"&gt;nocompatible&lt;/span&gt;
&lt;span class="k"&gt;filetype&lt;/span&gt; off                              &lt;span class="c"&gt;&amp;quot; å…ˆå…³é—­æ–‡ä»¶ç±»å‹&lt;/span&gt;
&lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nb"&gt;rtp&lt;/span&gt;&lt;span class="p"&gt;+=~&lt;/span&gt;&lt;span class="sr"&gt;/.vim/&lt;/span&gt;bundle/vundle             &lt;span class="c"&gt;&amp;quot; å°†vundleè·¯å¾„æ·»åŠ åˆ°æ’ä»¶vimè·¯å¾„&lt;/span&gt;
&lt;span class="k"&gt;call&lt;/span&gt; vundle#rc&lt;span class="p"&gt;()&lt;/span&gt;                          &lt;span class="c"&gt;&amp;quot; æ‰§è¡ŒVundleåˆå§‹åŒ–&lt;/span&gt;
Bundle &lt;span class="s1"&gt;&amp;#39;gmarik/vundle&amp;#39;&lt;/span&gt;                    &lt;span class="c"&gt;&amp;quot; å°†VundleåŠ å…¥åˆ°bundle&lt;/span&gt;

&lt;span class="k"&gt;filetype&lt;/span&gt; indent plugin &lt;span class="k"&gt;on&lt;/span&gt;                 &lt;span class="c"&gt;&amp;quot; å®‰è£…å®Œåæ‰“å¼€æ–‡ä»¶ç±»å‹&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚éœ€åŠ ä¸Šæ’ä»¶åˆ™åœ¨Bundle 'gmarik/vundle'ååŠ ä¸Šç›¸åº”çš„Bundle,å¦‚æœæ˜¯githubåˆ™å¯ä»¥åªè¾“å…¥åé¢çš„ç›¸å¯¹è·¯å¾„,å¦‚æœæ˜¯å…¶ä»–gitåˆ™éœ€è¾“å…¥å…¨éƒ¨url,ä¸‹é¢ç»™å‡ºä¸€ä¸ªå®Œæ•´çš„ä¾‹å­:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nb"&gt;nocompatible&lt;/span&gt;
&lt;span class="k"&gt;filetype&lt;/span&gt; off
&lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nb"&gt;rtp&lt;/span&gt;&lt;span class="p"&gt;+=~&lt;/span&gt;&lt;span class="sr"&gt;/.vim/&lt;/span&gt;bundle/vundle
&lt;span class="k"&gt;call&lt;/span&gt; vundle#rc&lt;span class="p"&gt;()&lt;/span&gt;
Bundle &lt;span class="s1"&gt;&amp;#39;gmarik/vundle&amp;#39;&lt;/span&gt;
&lt;span class="c"&gt;&amp;quot;Bundle &amp;quot;MarcWeber/vim-addon-mw-utils&amp;quot;&lt;/span&gt;
&lt;span class="c"&gt;&amp;quot;Bundle &amp;quot;tomtom/tlib_vim&amp;quot;&lt;/span&gt;
&lt;span class="c"&gt;&amp;quot;Bundle &amp;quot;honza/snipmate-snippets&amp;quot;&lt;/span&gt;
&lt;span class="c"&gt;&amp;quot;Bundle &amp;quot;garbas/vim-snipmate&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;Shougo/neocomplcache&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;Lokaltog/vim-powerline&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;drakeguan/vim-vcscommand&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;scrooloose/nerdtree&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;pix/vim-taglist&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;nathanaelkane/vim-indent-guides&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;clones/vim-cecutil&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;tpope/vim-fugitive&amp;quot;&lt;/span&gt;
&lt;span class="c"&gt;&amp;quot;Bundle &amp;quot;c9s/bufexplorer&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;jnwhiteh/vim-golang&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;kevinw/pyflakes-vim&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;mbriggs/mark.vim&amp;quot;&lt;/span&gt;
&lt;span class="c"&gt;&amp;quot;Bundle &amp;quot;vim-scripts/TabBar&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;vim-scripts/DrawIt&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;vim-scripts/calendar.vim--Matsumoto&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;vim-scripts/Python-mode-klen&amp;quot;&lt;/span&gt;
&lt;span class="c"&gt;&amp;quot;Bundle &amp;quot;vim-scripts/pydoc.vim&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;vim-scripts/VOoM&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;vim-scripts/qiushibaike&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;vim-scripts/AuthorInfo&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;vim-scripts/javacomplete&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;vim-scripts/javaDoc.vim&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;drmingdrmer/xptemplate.git&amp;quot;&lt;/span&gt;
Bundle &lt;span class="s2"&gt;&amp;quot;vim-scripts/Java-Syntax-and-Folding&amp;quot;&lt;/span&gt;

&lt;span class="k"&gt;filetype&lt;/span&gt; indent plugin &lt;span class="k"&gt;on&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä»¥ä¸Šæ˜¯æˆ‘çš„Vundleé…ç½®,å†åé¢çš„æ–‡ç« ä¼šå¯¹å…¶ä¸­ä¸€äº›åšå‡ºä»‹ç»:&lt;/p&gt;
&lt;p&gt;é…ç½®å®Œåä¿å­˜ä½¿ç”¨Vimæ‰“å¼€ä»»æ„æ–‡æ¡£æ‰§è¡Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="p"&gt;:&lt;/span&gt;BundleInstall
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœç½‘ç»œé€šç•…Bundleä¼šé€ä¸ªå®‰è£…æ¯ä¸ªæ’ä»¶.&lt;/p&gt;
&lt;p&gt;åŒæ—¶è¿˜æœ‰:BundleSearchç”¨äºæœç´¢æ’ä»¶,éå¸¸æ–¹ä¾¿.&lt;/p&gt;</content><category term="Vim"></category><category term="é…ç½®"></category><category term="ç³»åˆ—"></category><category term="ç®¡ç†"></category><category term="æ’ä»¶"></category><category term="Vundle"></category><category term="vim"></category><category term="Bundle"></category></entry><entry><title>Vimæ‰“å¼€Pythonæºç è‡ªåŠ¨æ·»åŠ #!è¡Œå’Œç¼–ç è¡Œ å‡çº§ç‰ˆ</title><link href="https://www.linuxzen.com/vimda-kai-pythonyuan-ma-zi-dong-tian-jia-xing-he-bian-ma-xing-sheng-ji-ban.html" rel="alternate"></link><published>2012-12-13T14:31:00+08:00</published><updated>2012-12-13T14:31:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-12-13:/vimda-kai-pythonyuan-ma-zi-dong-tian-jia-xing-he-bian-ma-xing-sheng-ji-ban.html</id><summary type="html">&lt;p&gt;ä¹‹å‰ç»™å¤§å®¶åˆ†äº«è¿‡ä¸€ä¸ªæ‰“å¼€Pythonæºä»£ç æ—¶è‡ªåŠ¨æ·»åŠ #!è¡Œå’Œç¼–ç è¡Œæ¥é¿å…ä¸€äº›é‡å¤çš„å·¥ä½œ,é‚£ä¸ªæ˜¯å› ä¸ºéœ€è¦å¤§é‡ç¼–å†™æ—¶ä¸´æ—¶çš„è§£å†³æ–¹æ¡ˆ,åæ¥ä½¿ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;ä¹‹å‰ç»™å¤§å®¶åˆ†äº«è¿‡ä¸€ä¸ªæ‰“å¼€Pythonæºä»£ç æ—¶è‡ªåŠ¨æ·»åŠ #!è¡Œå’Œç¼–ç è¡Œæ¥é¿å…ä¸€äº›é‡å¤çš„å·¥ä½œ,é‚£ä¸ªæ˜¯å› ä¸ºéœ€è¦å¤§é‡ç¼–å†™æ—¶ä¸´æ—¶çš„è§£å†³æ–¹æ¡ˆ,åæ¥ä½¿ç”¨ä¸­ä¼šå‡ºç°ä¸€äº›é—®é¢˜,æ¯”å¦‚æŸ¥çœ‹åˆ«äººæºç æ—¶ä¹Ÿä¼šæ›´æ”¹ä¸€äº›ä¸œè¥¿,ä»è€Œé€ æˆgitä¸å¿…è¦çš„æ›´æ–°å’Œæ‰‹åŠ¨åˆ é™¤çš„é¢å¤–åŠ¨ä½œ,æ‰€ä»¥åˆå†™äº†ä¸€ä¸ª,åªæ˜¯åœ¨æ–‡ä»¶æ˜¯æ–°æ‰“å¼€æ–‡ä»¶æ—¶æˆ–è€…ç©ºæ–‡ä»¶æ‰è‡ªåŠ¨æ·»åŠ çš„æ–¹æ³•,åŒæ—¶å†æ‰“å¼€pythonæºæ–‡ä»¶å°†è¿™ä¸ªæ–¹æ³•ç»‘å®šè¦F4ä¸Šå¯ä»¥æ‰‹åŠ¨æ·»åŠ ,å¹¶ä¼šåˆ¤æ–­æ˜¯å¦æœ‰è¿™ä¸¤è¡Œ,å¦‚æœæœ‰åˆ™ä¸æ‰§è¡ŒåŠ¨ä½œ,åŒæ—¶ä¹Ÿæ·»åŠ äº†ä¸€äº›è¾…åŠ©æ€§æ³¨é‡Š, æ¯”å¦‚ ä½œè€…/é‚®ç®±/åˆ›å»ºæ—¥æœŸå’Œæè¿°,ä»£ç å®ç°å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c"&gt;&amp;quot;Python æ³¨é‡Š&lt;/span&gt;
&lt;span class="k"&gt;function&lt;/span&gt; InsertPythonComment&lt;span class="p"&gt;()&lt;/span&gt;
    exe &lt;span class="s1"&gt;&amp;#39;normal&amp;#39;&lt;/span&gt;.&lt;span class="m"&gt;1&lt;/span&gt;.&lt;span class="s1"&gt;&amp;#39;G&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;let&lt;/span&gt; line &lt;span class="p"&gt;=&lt;/span&gt; getline&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; line &lt;span class="p"&gt;=~&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;^#!.*$&amp;#39;&lt;/span&gt; &lt;span class="p"&gt;||&lt;/span&gt; line &lt;span class="p"&gt;=~&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;^#.*coding:.*$&amp;#39;&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt;
    &lt;span class="k"&gt;endif&lt;/span&gt;
    normal O
    &lt;span class="k"&gt;call&lt;/span&gt; setline&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;#!/usr/bin/env python&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    normal &lt;span class="k"&gt;o&lt;/span&gt;
    &lt;span class="k"&gt;call&lt;/span&gt; setline&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;# -*- coding:utf-8 -*-&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    normal &lt;span class="k"&gt;o&lt;/span&gt;
    &lt;span class="k"&gt;call&lt;/span&gt; setline&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;#&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    normal &lt;span class="k"&gt;o&lt;/span&gt;
    &lt;span class="k"&gt;call&lt;/span&gt; setline&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;#   Author  :   &amp;#39;&lt;/span&gt;.&lt;span class="k"&gt;g&lt;/span&gt;:python_author&lt;span class="p"&gt;)&lt;/span&gt;
    normal &lt;span class="k"&gt;o&lt;/span&gt;
    &lt;span class="k"&gt;call&lt;/span&gt; setline&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;#   E-mail  :   &amp;#39;&lt;/span&gt;.&lt;span class="k"&gt;g&lt;/span&gt;:python_email&lt;span class="p"&gt;)&lt;/span&gt;
    normal &lt;span class="k"&gt;o&lt;/span&gt;
    &lt;span class="k"&gt;call&lt;/span&gt; setline&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;#   Date    :   &amp;#39;&lt;/span&gt;.strftime&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;%y/%m/%d %H:%M:%S&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    normal &lt;span class="k"&gt;o&lt;/span&gt;
    &lt;span class="k"&gt;call&lt;/span&gt; setline&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;#   Desc    :   &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    normal &lt;span class="k"&gt;o&lt;/span&gt;
    &lt;span class="k"&gt;call&lt;/span&gt; setline&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;#&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    normal &lt;span class="k"&gt;o&lt;/span&gt;
    &lt;span class="k"&gt;call&lt;/span&gt; cursor&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;7&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="m"&gt;17&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;endfunction&lt;/span&gt;
&lt;span class="k"&gt;function&lt;/span&gt; InsertCommentWhenOpen&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="k"&gt;a&lt;/span&gt;:lastline &lt;span class="p"&gt;==&lt;/span&gt; &lt;span class="m"&gt;1&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class="p"&gt;!&lt;/span&gt;getline&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;call&lt;/span&gt; InsertPythonComment&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;end&lt;/span&gt;
endfunc
&lt;span class="k"&gt;au&lt;/span&gt; &lt;span class="nb"&gt;FileType&lt;/span&gt; python :%&lt;span class="k"&gt;call&lt;/span&gt; InsertCommentWhenOpen&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;au&lt;/span&gt; &lt;span class="nb"&gt;FileType&lt;/span&gt; python map &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;F4&lt;span class="p"&gt;&amp;gt;&lt;/span&gt; :&lt;span class="k"&gt;call&lt;/span&gt; InsertPythonComment&lt;span class="p"&gt;()&amp;lt;&lt;/span&gt;&lt;span class="k"&gt;cr&lt;/span&gt;&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å°†ä¸Šé¢çš„ä»£ç æ”¾åˆ°ä½ çš„vimrcä¸­,åŒæ—¶åœ¨vimrcæ·»åŠ :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;let&lt;/span&gt; &lt;span class="k"&gt;g&lt;/span&gt;:python_author &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;               # å§“å
&lt;span class="k"&gt;let&lt;/span&gt; &lt;span class="k"&gt;g&lt;/span&gt;:python_email  &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;wh_linux@126.com&amp;#39;&lt;/span&gt;   # é‚®ç®±
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ ·åœ¨æ¯æ¬¡æ‰“å¼€ç©ºçš„pythonæºæ–‡ä»¶æ—¶å°±ä¼šæ·»åŠ è¿™äº›æ³¨é‡Šä¿¡æ¯,å¹¶å¯ä»¥åœ¨éç©ºæ²¡æœ‰è¿™äº›æ³¨é‡Šçš„æƒ…å†µä¸‹æŒ‰F4æ·»åŠ ,é…ç½®ç©å,æ‰“å¼€ç©ºçš„pythonæºæ–‡ä»¶æ•ˆæœå¦‚ä¸‹:
&lt;img alt="å¥½çœ‹çš„statusline" src="/upload/VimPythonComment1.png"&gt;&lt;/p&gt;</content><category term="Vim"></category><category term="è‡ªåŠ¨"></category><category term="ç¼–ç ä¿¡æ¯"></category><category term="æ·»åŠ "></category><category term="vim"></category><category term="shbang line"></category><category term="python"></category></entry><entry><title>Awesome+tmux+gnomeDoæ‰“é€ é«˜æ•ˆLinuxæ¡Œé¢ç¯å¢ƒ</title><link href="https://www.linuxzen.com/awesometmuxgnomedoda-zao-gao-xiao-linuxzhuo-mian-huan-jing.html" rel="alternate"></link><published>2012-12-04T13:21:00+08:00</published><updated>2012-12-04T13:21:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-12-04:/awesometmuxgnomedoda-zao-gao-xiao-linuxzhuo-mian-huan-jing.html</id><summary type="html">&lt;h2 id="_1"&gt;å¼•è¨€&lt;/h2&gt;
&lt;p&gt;è¿‘æœŸä¸€ç›´åœ¨Linuxä¸‹å·¥ä½œ,ä½¿ç”¨Ubuntu 11.10,ç»è¿‡ä¸€æ®µæ—¶é—´çš„ä½¿ç”¨å’Œç£¨åˆ,ç»ˆäºæ‰“é€ å‡ºä¸€å¥—é€‚åˆè‡ªå·±çš„é«˜æ•ˆLinuxæ¡Œé¢ç¯å¢ƒ,ä¹‹å‰ä¹Ÿåœ¨åšå®¢ä¸­é›¶æ•£çš„ â€¦&lt;/p&gt;</summary><content type="html">&lt;h2 id="_1"&gt;å¼•è¨€&lt;/h2&gt;
&lt;p&gt;è¿‘æœŸä¸€ç›´åœ¨Linuxä¸‹å·¥ä½œ,ä½¿ç”¨Ubuntu 11.10,ç»è¿‡ä¸€æ®µæ—¶é—´çš„ä½¿ç”¨å’Œç£¨åˆ,ç»ˆäºæ‰“é€ å‡ºä¸€å¥—é€‚åˆè‡ªå·±çš„é«˜æ•ˆLinuxæ¡Œé¢ç¯å¢ƒ,ä¹‹å‰ä¹Ÿåœ¨åšå®¢ä¸­é›¶æ•£çš„å†™äº†å‡ ç¯‡æ–‡ç« åˆ†äº«,åœ¨æ­¤åšä¸€ç•ªæ€»ç»“.&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå…ˆæ”¾å‡ºæ¡Œé¢æˆªå›¾
&lt;img alt="Awesome æ¡Œé¢æˆªå›¾" src="/upload/MyDesktop.png"&gt;&lt;/p&gt;
&lt;h2 id="awesome"&gt;Awesome&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨Ubuntu 11.10ä¸ä¹ æƒ¯é»˜è®¤æ­è½½çš„Unity,Gnome 3ä¹Ÿä¸å°½äººå¦‚æ„,ä¹Ÿä½¿ç”¨xfce/openbox,ä½†ä½¿ç”¨éƒ½ä¸æ˜¯å¾ˆå¥½,æ²¡æœ‰Windowsçš„ä½“éªŒå¥½,ç„¶åæ¥è§¦äº†Awesome,Awesomeæ˜¯ä¸€æ¬¾å¹³é“ºå¼çª—ä½“ç®¡ç†å™¨,Awesomeä¼šå»é™¤çª—å£çš„æ ‡é¢˜æ ç­‰.ä¼šä½¿çª—å£å°½é‡å°çš„å ç”¨æ¡Œé¢ç©ºé—´,è€Œä¸”å¤§éƒ¨åˆ†çª—å£æ“ä½œéƒ½å¯ä»¥é€šè¿‡é”®ç›˜æ¥è¿›è¡Œæ“ä½œ,å…é™¤äº†å„ä½èº«ä¸ºé”®ç›˜é«˜æ‰‹çš„ç å†œä»¬é¢‘ç¹æ‹¿é¼ æ ‡çš„çƒ¦æ¼.&lt;/p&gt;
&lt;h3 id="_2"&gt;å®‰è£…&lt;/h3&gt;
&lt;p&gt;Awesome Ubuntuä¸‹å®‰è£…ååˆ†ç®€å•:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sudo&lt;span class="w"&gt; &lt;/span&gt;apt-get&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;awesome
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_3"&gt;é…ç½®&lt;/h3&gt;
&lt;h4 id="_4"&gt;æ‹·è´é…ç½®æ–‡ä»¶&lt;/h4&gt;
&lt;p&gt;Awesome çš„é…ç½®æ–‡ä»¶ä½¿ç”¨luaè„šæœ¬,æ‰€ä»¥å¦‚æœä½ ä¼šluaé…ç½®èµ·æ¥ä¼šå¾—å¿ƒåº”æ‰‹,æˆ‘ä»¬å…ˆæ‹·è´ä¸€ä¸ªåŸºç¡€é…ç½®æ–‡ä»¶,ç„¶ååœ¨è¿™ä¸ªåŸºç¡€ä¸Šè¿›è¡Œæ›´æ”¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;cp&lt;span class="w"&gt; &lt;/span&gt;/etc/xdg/awesome/rc.lua&lt;span class="w"&gt; &lt;/span&gt;~/.config/awesome&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;#  ~/.confgä¸‹å¦‚æ²¡æœ‰awesomeåˆ™æ‰‹åŠ¨åˆ›å»º&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4 id="_5"&gt;é…ç½®è‡ªåŠ¨å¯ç¨‹åº&lt;/h4&gt;
&lt;p&gt;ä½¿ç”¨awesomeä¹‹åä¹‹å‰è®¾ç½®çš„è‡ªåŠ¨å¯åŠ¨å°±ä¼šå¤±æ•ˆ,å› ä¸ºAwesomeå¯åŠ¨æ˜¯é€šè¿‡é…ç½®æ–‡ä»¶æ§åˆ¶çš„,åœ¨é…ç½®æ–‡ä»¶(~/.config/awesome/rc.lua)åŠ ä¸Šå¦‚ä¸‹å†…å®¹å¯ä»¥é…ç½®è‡ªå¯åŠ¨ç¨‹åº:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;autorun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;
&lt;span class="n"&gt;autorunApps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 
&lt;span class="p"&gt;{&lt;/span&gt; 
    &lt;span class="s2"&gt;&amp;quot;pidgin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;fcitx&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;dbus-launch gnome-do&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;guake&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;/opt/qq2012/wineapp/qq/qq.sh&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kr"&gt;if&lt;/span&gt; &lt;span class="n"&gt;autorun&lt;/span&gt; &lt;span class="kr"&gt;then&lt;/span&gt;
    &lt;span class="kr"&gt;for&lt;/span&gt; &lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;#&lt;/span&gt;&lt;span class="n"&gt;autorunApps&lt;/span&gt; &lt;span class="kr"&gt;do&lt;/span&gt;
        &lt;span class="n"&gt;awful&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;util&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spawn_with_shell&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;autorunApps&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="kr"&gt;end&lt;/span&gt;
&lt;span class="kr"&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åœ¨autorunAppsä¸­æ·»åŠ è¦è‡ªåŠ¨å¯åŠ¨ç¨‹åºçš„å‘½ä»¤å³å¯åœ¨ç™»å½•æ—¶å¯åŠ¨ç›¸åº”çš„ç¨‹åº&lt;/p&gt;
&lt;h4 id="gnome"&gt;ä½¿ç”¨gnomeæ¡Œé¢å…ƒç´ &lt;/h4&gt;
&lt;p&gt;awesomeä»…ä»…æ˜¯ä¸€æ¬¾çª—ä½“ç®¡ç†å™¨,å¦‚æœä¸è¿›è¡Œç›¸åº”é…ç½®awesomeä¼šä½¿ç”¨é»˜è®¤çš„x windowå…ƒç´ ,éå¸¸ä¸‘é™‹æˆ‘ä»¬æ¥é…ç½®awesomeä½¿ç”¨GNOMEæ¡Œé¢ç®¡ç†:
åœ¨å®¿ä¸»ç›®å½•åˆ›å»º.xinitrc,æ·»åŠ å¦‚ä¸‹å†…å®¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/sh&lt;/span&gt;
gnome-settings-daemon&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="c1"&gt;# ä½¿ç”¨gnomeæ¡Œé¢å…ƒç´ &lt;/span&gt;
nm-applet&lt;span class="w"&gt; &lt;/span&gt;--sm-disable&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# æ‰˜ç›˜æ æ·»åŠ ç½‘å¡å›¾æ ‡&lt;/span&gt;
&lt;span class="nb"&gt;exec&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;awesome
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœä¸ç”Ÿæ•ˆ,åˆ™æ‰§è¡Œä¸‹é¢å‘½ä»¤:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ln&lt;span class="w"&gt; &lt;/span&gt;-sf&lt;span class="w"&gt; &lt;/span&gt;~/.xinitrc&lt;span class="w"&gt; &lt;/span&gt;~/.xprofile
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_6"&gt;ç¾åŒ–&lt;/h3&gt;
&lt;p&gt;å¯ä»¥è‡ªå·±ç¼–å†™luaè„šæœ¬å¯¹Awesomeè¿›è¡Œç¾åŒ–,å½“ç„¶è¿˜æœ‰å¾ˆå¤šå·²ç»å†™å¥½çš„é…ç½®,æˆ‘ä»¬å«ä»–ä¸ºä¸»é¢˜
awesomeçš„æ‰€æœ‰ä¸»é¢˜å¯ä»¥åœ¨ https://github.com/mikar/awesome-themes ä¸Šä¸‹è½½.
æˆ‘ä»¬å¯ä»¥ä½¿ç”¨gitå°†ä¸»é¢˜æ•´ä½“å…‹éš†ä¸‹æ¥&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;git&lt;span class="w"&gt; &lt;/span&gt;clone&lt;span class="w"&gt; &lt;/span&gt;git://github.com/mikar/awesome-themes.git&lt;span class="w"&gt; &lt;/span&gt;~/.config/awesome/themes
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åä¿®æ”¹~/.config/awesome/rc.luaçš„beautiful.init()çš„å‚æ•°æ”¹ä¸ºä¸»é¢˜çš„è·¯å¾„:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;beautiful&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;init&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/your/home/path/.config/awesome/themes/bamboo/theme.lua&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœèƒŒæ™¯å›¾ç‰‡æ— æ³•æ˜¾ç¤º,å®‰è£…feh:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sudo&lt;span class="w"&gt; &lt;/span&gt;apt-get&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;feh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_7"&gt;ä½¿ç”¨&lt;/h3&gt;
&lt;p&gt;é…ç½®å®Œæˆåæ³¨é”€ä½¿ç”¨Awesomeä¼šè¯ç™»å½•,Awesomeä½¿ç”¨Winé”®ä½œä¸ºä¸»é”®,å‡ ä¸ªå¸¸ç”¨çš„ä¸º:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Win+num å¯ä»¥åœ¨å¤šä¸ªæ¡Œé¢åˆ‡æ¢
Win+Ctrl+r å¯ä»¥é‡å¯Awesome,
Win+k/jå¯ä»¥åˆ‡æ¢çª—å£(ç±»Vimæ“ä½œ),
Win+m/nå¯ä»¥æœ€å¤§/å°åŒ–çª—å£,
Win+Shift+num å¯ä»¥å°†å½“å‰çª—å£å‘é€åˆ°å…¶ä»–æ¡Œé¢.
Win+Shift+Cå¯ä»¥å…³é—­å½“å‰çª—å£,
Win+Spaceå¯ä»¥åˆ‡æ¢å¸ƒå±€,Awesomeæœ‰å¤šç§å¸ƒå±€,è¿™é‡Œä¸ä½œä»‹ç»,å¤§å®¶å¯ä»¥è‡ªå·±ç¨ä½œå°è¯•.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸‹é¢ç»™å‡ºå®Œæ•´çš„å¿«æ·é”®:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Mod4 + Enter           æ‰“å¼€ç»ˆç«¯                                               
Mod4 + r               æ‰§è¡Œç¨‹åºæˆ–å‘½ä»¤
Mod4 + w               æ‰“å¼€Awesomeä¸»èœå•ï¼ˆé¼ æ ‡å³é”®å…³é—­ï¼‰                                                   
Mod4 + Shift + c       å…³é—­å½“å‰çª—å£æˆ–åº”ç”¨                                     
Mod4 + Control + r     é‡å¯Awesome                                            
Mod4 + Shift + q       é€€å‡ºAwesome

Mod4 + j               åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªçª—å£                                       
Mod4 + k               åˆ‡æ¢åˆ°å‰ä¸€ä¸ªçª—å£                                       
Mod4 + Left            æŸ¥çœ‹å‰ä¸€ä¸ªtag                                          
Mod4 + Right           æŸ¥çœ‹åä¸€ä¸ªtag                                          
Mod4 + 1-9             åˆ‡æ¢åˆ°tag 1-9                                          

Mod4 + Control + j     åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªå±å¹•                                       
Mod4 + Control + k     åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªå±å¹•                                       
Mod4 + Shift + j       å½“å‰çª—å£å’Œå‰ä¸€ä¸ªçª—å£äº’æ¢ä½ç½®                           
Mod4 + Shift + k       å½“å‰çª—å£å’Œåä¸€ä¸ªçª—å£äº’æ¢ä½ç½®                           
Mod4 + h               æŠŠä¸»åŒºåŸŸçš„å®½åº¦å¢å¤§5%                                   
Mod4 + l               æŠŠä¸»åŒºåŸŸçš„å®½åº¦å‡å°‘5%

Mod4 + m               æœ€å¤§åŒ–çª—å£
Mod4 + n               æœ€å°åŒ–çª—å£

Mod4 + Shift + h       å¢åŠ ä¸»åŒºåŸŸçª—å£çš„æ•°é‡                                   
Mod4 + Shift + l       å‡å°‘ä¸»åŒºåŸŸçª—å£çš„æ•°é‡                                   
Mod4 + Space           åˆ‡æ¢çª—å£å¸ƒå±€                                           
Mod4 + Shift + space   æŠŠå½“å‰tagæ›´æ¢ä¸ºå‰ä¸€ç§å¸ƒå±€                              
Mod4 + Control + space åˆ‡æ¢å½“å‰çª—å£æ˜¯å¦ä¸ºæµ®åŠ¨                                 

Mod4 + Shift + i       æ˜¾ç¤ºå½“å‰çª—å£çš„Classå’Œinstanceï¼Œè¿™åœ¨å†™è„šæœ¬çš„æ—¶å€™å°¤å…¶æœ‰ç”¨

Mod4 + Shift + r       é‡ç»˜å½“å‰çª—å£                                           
Mod4 + t               æ ‡è®°çª—å£ï¼ˆå¯æ ‡è®°å¤šä¸ªï¼‰                                 
Mod4 + Shift + F1~F9   æŠŠæ ‡è®°çš„çª—å£ç§»åŠ¨åˆ°ç¬¬1~9ä¸ªæ ‡è®°ä¸Š                        

Ctrl + Mod4 + 1~9      æŠŠå½“å‰æ¡Œé¢å’Œ1~9æ¡Œé¢æ˜¯æ˜¾ç¤º                              
Mod4 + 1~9             æ¢å¤                                                   

Mod4 + Esc             å¿«é€Ÿåˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªæ¡Œé¢
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ›´åŠ è¯¦å°½çš„ä»‹ç»å’Œé…ç½®è¯·å‚è§http://josephpan.net/blog/?p=992&lt;/p&gt;
&lt;h2 id="tmux"&gt;Tmux&lt;/h2&gt;
&lt;p&gt;tmuxæ˜¯ä¸€æ¬¾æ›¿ä»£screençš„äº§å“,é™¤äº†æ‹¥æœ‰screençš„åŸºæœ¬åŠŸèƒ½å¤–,è¿˜æœ‰çª—å£åˆ†éš”,å¤šäººå…±äº«ç­‰åŠŸèƒ½.å°¤å…¶æ˜¯çª—å£åˆ†éš”åŠŸèƒ½å¼‚å¸¸çªå‡º.åŒæ—¶tmuxç®€åŒ–äº†å¾ˆå¤šå¿«æ·é”®.è¿˜æ”¯æŒvi/emacsé£æ ¼çš„å¿«æ·é”®ç»‘å®š&lt;/p&gt;
&lt;h3 id="_8"&gt;å®‰è£…&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sudo&lt;span class="w"&gt; &lt;/span&gt;apt-get&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;tmux
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_9"&gt;é…ç½®&lt;/h3&gt;
&lt;p&gt;tmux ä½¿ç”¨~/.tmux.confä½œä¸ºé…ç½®æ–‡ä»¶,æ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†é…ç½®æ·»åŠ åˆ°è¿™ä¸ªæ–‡ä»¶ä¸­,ç½‘ä¸Šå¾ˆå¤šèµ„æ–™éƒ½å°†å‰ç¼€é”®ç»‘å®šåˆ°Ctrl+a,ä½†æˆ‘å–œæ¬¢ä½¿ç”¨Ctrl+aè·³åˆ°è¡Œé¦–,æ‰€ä»¥æˆ‘è¿˜æ˜¯ä½¿ç”¨é»˜è®¤çš„å‰ç¼€é”®Ctrl+b.ä¸‹é¢æ˜¯æˆ‘çš„é…ç½®æ–‡ä»¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;terminal&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;screen-256color&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;display&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3000&lt;/span&gt;&lt;span class="w"&gt;                   &lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;escape&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;history&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;limit&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;65535&lt;/span&gt;&lt;span class="w"&gt;                 &lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;base&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;                        &lt;/span&gt;
&lt;span class="n"&gt;setw&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;utf8&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;on&lt;/span&gt;&lt;span class="w"&gt;                           &lt;/span&gt;

&lt;span class="c1"&gt;# split window&lt;/span&gt;
&lt;span class="n"&gt;unbind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;quot;&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;splitw&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# vertical split (prefix -)&lt;/span&gt;
&lt;span class="n"&gt;unbind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;splitw&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# horizontal split (prefix |)&lt;/span&gt;

&lt;span class="c1"&gt;# select pane&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;selectp&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;U&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# above (prefix k)&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;selectp&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;D&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# below (prefix j)&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;selectp&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# left (prefix h)&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;selectp&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# right (prefix l)&lt;/span&gt;

&lt;span class="c1"&gt;# resize pane&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;k&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;resizep&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;U&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# upward (prefix Ctrl+k)&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;j&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;resizep&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;D&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# downward (prefix Ctrl+j)&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;h&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;resizep&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;L&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# to the left (prefix Ctrl+h)&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;resizep&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;R&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# to the right (prefix Ctrl+l)&lt;/span&gt;

&lt;span class="c1"&gt;# swap pane&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;u&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;swapp&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;U&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# swap with the previous pane (prefix Ctrl+u)&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;swapp&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;D&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# swap with the next pane (prefix Ctrl+d)&lt;/span&gt;

&lt;span class="c1"&gt;# misc&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lastp&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# select the last pane (prefix e)&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;last&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# select the last window (prefix Ctrl+e)&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;killp&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# kill pane (prefix q)&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;q&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;killw&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# kill window (prefix Ctrl+q)&lt;/span&gt;

&lt;span class="c1"&gt;# copy mode&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Escape&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="c1"&gt;# enter copy mode (prefix Escape)&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pasteb&lt;/span&gt;&lt;span class="w"&gt;                    &lt;/span&gt;&lt;span class="c1"&gt;# paste buffer (prefix Ctrl+p)&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;vi&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;begin&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;selection&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# select (v)&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;vi&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;selection&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# copy (y)&lt;/span&gt;

&lt;span class="c1"&gt;# zoom pane &amp;lt;-&amp;gt; window &lt;/span&gt;
&lt;span class="c1"&gt;# see also: http://tmux.svn.sourceforge.net/viewvc/tmux/trunk/examples/tmux-zoom.sh&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;^&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;tmux-zoom&amp;quot;&lt;/span&gt;

&lt;span class="c1"&gt;# app&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;!&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;splitw&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;htop&lt;/span&gt;&lt;span class="w"&gt;                                     &lt;/span&gt;&lt;span class="c1"&gt;# htop (prefix !)&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;m&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;prompt&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;splitw &amp;#39;exec man &lt;/span&gt;&lt;span class="si"&gt;%%&lt;/span&gt;&lt;span class="s2"&gt;&amp;#39;&amp;quot;&lt;/span&gt;&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="c1"&gt;# man (prefix m)&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;@&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;prompt&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;splitw &amp;#39;exec perldoc -t -f &lt;/span&gt;&lt;span class="si"&gt;%%&lt;/span&gt;&lt;span class="s2"&gt;&amp;#39;&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# perl func (prefix @)&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;prompt&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;splitw &amp;#39;exec perldoc -t -v &lt;/span&gt;&lt;span class="si"&gt;%%&lt;/span&gt;&lt;span class="s2"&gt;&amp;#39;&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# perl var (prefix *)&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;prompt&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;splitw &amp;#39;exec perldoc -t &lt;/span&gt;&lt;span class="si"&gt;%%&lt;/span&gt;&lt;span class="s2"&gt;&amp;#39;&amp;quot;&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# perl doc (prefix %)&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;prompt&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;splitw &amp;#39;exec ri &lt;/span&gt;&lt;span class="si"&gt;%%&lt;/span&gt;&lt;span class="s2"&gt;&amp;#39;&amp;quot;&lt;/span&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="c1"&gt;# ruby doc (prefix /)&lt;/span&gt;

&lt;span class="c1"&gt;# reload config (prefix r)&lt;/span&gt;
&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;source&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;~/.&lt;/span&gt;&lt;span class="n"&gt;tmux&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;conf&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;\&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;display&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Configuration reloaded!&amp;quot;&lt;/span&gt;

&lt;span class="n"&gt;setw&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;keys&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;vi&lt;/span&gt;
&lt;span class="n"&gt;setw&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;automatic&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rename&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;off&lt;/span&gt;

&lt;span class="c1"&gt;#-- colorscheme --#&lt;/span&gt;
&lt;span class="c1"&gt;# see also: https://github.com/daethorian/conf-tmux/blob/master/colors/zenburn.conf&lt;/span&gt;

&lt;span class="c1"&gt;# modes&lt;/span&gt;
&lt;span class="n"&gt;setw&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clock&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;colour&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;colour223&lt;/span&gt;
&lt;span class="n"&gt;setw&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;attr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bold&lt;/span&gt;
&lt;span class="n"&gt;setw&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fg&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;colour223&lt;/span&gt;
&lt;span class="n"&gt;setw&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;bg&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;colour235&lt;/span&gt;

&lt;span class="c1"&gt;# panes&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pane&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;border&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;bg&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;default&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pane&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;border&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fg&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;colour234&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pane&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;active&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;border&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;bg&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pane&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;active&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;border&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fg&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;green&lt;/span&gt;

&lt;span class="c1"&gt;# messages&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;attr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;bold&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fg&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;colour223&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;bg&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;default&lt;/span&gt;

&lt;span class="c1"&gt;#-- statusbar --#&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;utf8&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;on&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;interval&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;keys&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;vi&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;justify&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;left&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;display&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3000&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;bg&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;default&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fg&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;white&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;window&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;option&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;window&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;attr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;default&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;window&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;option&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;window&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fg&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;red&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;window&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;option&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;window&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;bg&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;default&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;length&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;55&lt;/span&gt;
&lt;span class="c1"&gt;#set -g status-left &amp;quot;#[fg=white,bg=blue] &amp;gt; #I #W &amp;lt; #[default] |&amp;quot; # 0:bash&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;#[fg=white,bg=default] &amp;gt; #S &amp;lt; #[default] |&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# session-name&lt;/span&gt;
&lt;span class="n"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;g&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;status&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;right&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;#[fg=red,bright][ #[fg=cyan]#H #[fg=red]]#[default] #[fg=yellow,bright]- %Y.%m.&lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s2"&gt; #[fg=green]%H:%M #[default]#[fg=magenta,bright](load: #(cat /proc/loadavg | cut -d &lt;/span&gt;&lt;span class="se"&gt;\&amp;quot;&lt;/span&gt;&lt;span class="s2"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&amp;quot;&lt;/span&gt;&lt;span class="s2"&gt; -f 1,2,3))#[default]&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_10"&gt;ä½¿ç”¨&lt;/h3&gt;
&lt;p&gt;æˆ‘ä½¿ç”¨terminatoré…åˆtmuxä½¿ç”¨,æ›´æ”¹terminatorçš„é…ç½®(~/.config/terminator/conf)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;[profiles]&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="k"&gt;[[default]]&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="na"&gt;login_shell&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;True&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="na"&gt;use_custom_command&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;True&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# å…è®¸è‡ªå®šä¹‰å‘½ä»¤&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="na"&gt;custom_command&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;tmux -2&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="c1"&gt;# æ‰“å¼€ç»ˆç«¯æ—¶æ‰§è¡Œtmux(-2 æ˜¯å¼ºåˆ¶ç»ˆç«¯ä½¿ç”¨256é¢œè‰²)   &lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="na"&gt;background_type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;transparent&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="na"&gt;scrollbar_position&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;hidden&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="na"&gt;foreground_color&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;&lt;/span&gt;&lt;span class="c1"&gt;#ffffff&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="na"&gt;show_titlebar&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;False&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="na"&gt;background_darkness&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;0.2&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_11"&gt;å¸¸ç”¨å¿«æ·é”®:&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Ctrl+b - åˆ›å»ºä¸€ä¸ªæ°´å¹³åˆ†éš” 
Ctrl+b | åˆ›å»ºä¸€ä¸ªå‚ç›´åˆ†éš”
Ctrl+b j/k/h/l ä¸Šä¸‹å·¦å³åˆ‡æ¢åˆ†å‰²çª—
Ctrl+b Ctrl+j/k/h/l å‘ä¸Šä¸‹å·¦å³æ‰©å±•åˆ†å‰²çª—å¤§å°
Ctrl+b c åˆ›å»ºä¸€ä¸ªçª—å£
Ctrl+b , é‡å‘½åçª—å£
Ctrl+b n åˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªçª—å£
Ctrl+b p åˆ‡æ¢åˆ°å‰ä¸€ä¸ªçª—å£
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="gnome-do"&gt;Gnome-Do&lt;/h2&gt;
&lt;p&gt;Gnome Do ä¹‹å‰åšå®¢é‡Œæœ‰ä»‹ç»è¯·çœ‹&lt;a href="/2012/9/1/Linuxæ¡Œé¢é«˜æ•ˆå·¥ä½œ----ä½¿ç”¨Gnome-DO/"&gt;è¿™é‡Œ&lt;/a&gt;,ç”±äºGonme Doä½¿ç”¨Win+Spaceå¿«æ·é”®å·²ç»è¢«Awesomeå ç”¨,æ‰€ä»¥ä¸ºäº†æ­£å¸¸ä½¿ç”¨Gnome Do æˆ‘å°†Gnome Doçš„å¿«æ·é”®ç»‘å®šåˆ°&lt;code&gt;Win+G&lt;/code&gt;.&lt;/p&gt;</content><category term="Linux"></category><category term="é«˜æ•ˆ"></category><category term="æ¡Œé¢"></category><category term="Tmux"></category><category term="Linux"></category><category term="gnome do"></category><category term="awesome"></category></entry><entry><title>AppArmorå¼•èµ·çš„æ— æ³•å¯åŠ¨Evince</title><link href="https://www.linuxzen.com/apparmoryin-qi-de-wu-fa-qi-dong-evince.html" rel="alternate"></link><published>2012-11-15T16:05:00+08:00</published><updated>2012-11-15T16:05:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-11-15:/apparmoryin-qi-de-wu-fa-qi-dong-evince.html</id><summary type="html">&lt;p&gt;ä»Šå¤©åœ¨Ubuntuä¸Šä½¿ç”¨æ–‡æ¡£æŸ¥çœ‹å™¨(Evince),æ€»æ˜¯æ‰“å¼€æ²¡æœ‰å“åº”,åœ¨å‘½ä»¤è¡Œä¸‹ä½¿ç”¨å‘½ä»¤:
evince
å´æç¤º:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;No protocol specified
Cannot parse arguments: æ— æ³•æ‰“å¼€æ˜¾ç¤ºï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;googleè¯´æ˜¯$XAUTHORITYæƒé™çš„é—®é¢˜,äºæ˜¯æŸ¥çœ‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ls&lt;span class="w"&gt; &lt;/span&gt;-l&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$XAUTHORITY&lt;/span&gt;
-rw-------&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;vim â€¦&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;ä»Šå¤©åœ¨Ubuntuä¸Šä½¿ç”¨æ–‡æ¡£æŸ¥çœ‹å™¨(Evince),æ€»æ˜¯æ‰“å¼€æ²¡æœ‰å“åº”,åœ¨å‘½ä»¤è¡Œä¸‹ä½¿ç”¨å‘½ä»¤:
evince
å´æç¤º:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;No protocol specified
Cannot parse arguments: æ— æ³•æ‰“å¼€æ˜¾ç¤ºï¼š
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;googleè¯´æ˜¯$XAUTHORITYæƒé™çš„é—®é¢˜,äºæ˜¯æŸ¥çœ‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ls&lt;span class="w"&gt; &lt;/span&gt;-l&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$XAUTHORITY&lt;/span&gt;
-rw-------&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;vim&lt;span class="w"&gt; &lt;/span&gt;vim&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;51&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;-11-15&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;12&lt;/span&gt;:12&lt;span class="w"&gt; &lt;/span&gt;/data/home/vim/.Xauthority
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ›´æ”¹ä¸ºå¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;chmod&lt;span class="w"&gt; &lt;/span&gt;+rw&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$XAUTHORITY&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿˜æ˜¯ä¸è¡Œ,è¿™æ—¶å€™çŒ›ç„¶æƒ³èµ·æŸ¥çœ‹æ—¥å¿—,æ—¥å¿—æœ‰å¦‚ä¸‹ä¸€è¡Œ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Nov 15 15:48:53 Vostro kernel: [13010.203241] type=1400 audit(1352965733.221:74): apparmor=&amp;quot;DENIED&amp;quot; operation=&amp;quot;open&amp;quot; parent=1 profile=&amp;quot;/usr/bin/evince&amp;quot; name=&amp;quot;/data/home/vim/.Xauthority&amp;quot; pid=7088 comm=&amp;quot;evince&amp;quot; requested_mask=&amp;quot;r&amp;quot; denied_mask=&amp;quot;r&amp;quot; fsuid=1000 ouid=1000
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¥½å§,é—®é¢˜æ˜¯ä¸€ä¸ªå«åšAppArmorçš„å†…æ ¸æ¨¡å—å¼•èµ·çš„,å®ƒé˜»æ­¢äº†evinceè¯»å–.Xauthority,æ‰¾åˆ°é…ç½®æ–‡ä»¶,æ·»åŠ :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sudo&lt;span class="w"&gt; &lt;/span&gt;vim&lt;span class="w"&gt; &lt;/span&gt;/etc/apparmor.d/usr.bin.evince&lt;span class="w"&gt; &lt;/span&gt;
@&lt;span class="o"&gt;{&lt;/span&gt;HOME&lt;span class="o"&gt;}&lt;/span&gt;/.Xauthority&lt;span class="w"&gt; &lt;/span&gt;rw,
sudo&lt;span class="w"&gt; &lt;/span&gt;/etc/init.d/apparmor&lt;span class="w"&gt; &lt;/span&gt;restart
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åšå®Œè¿™äº›è¿˜æ˜¯åˆ·åŒæ ·çš„æ—¥å¿—,æ— å¥ˆåªæœ‰ç¦ç”¨å®ƒäº†:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sudo&lt;span class="w"&gt; &lt;/span&gt;ln&lt;span class="w"&gt; &lt;/span&gt;-sf&lt;span class="w"&gt; &lt;/span&gt;/etc/apparmor.d/usr.bin.evince&lt;span class="w"&gt; &lt;/span&gt;/etc/apparmor.d/disable/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é‡å¯apparmorå°±èƒ½æ‰“å¼€Evinceäº†,éƒ½ä¸çŸ¥é“è¿™ç©æ„æ˜¯æ€ä¹ˆåŠ ä¸Šçš„,ä¹‹å‰éƒ½æ²¡é—®é¢˜.&lt;/p&gt;
&lt;p&gt;æ­¤æ¬¡è§£å†³çœ‹æ¥Linuxé—®é¢˜è§£å†³ä¹‹è·¯æ˜¯ä»æ—¥å¿—å¼€å§‹çš„,é•¿æ—¶é—´Linuxæ¡Œé¢å·¥ä½œå·®ç‚¹éƒ½ç»™å¿˜æ‰æ—¥å¿—çš„é‡è¦æ€§.&lt;/p&gt;</content><category term="Linux"></category><category term="Ubuntu"></category><category term="evince"></category><category term="apparmor"></category></entry><entry><title>python ä½¿ç”¨pyxmpp2ç¼–å†™gtalkç¾¤</title><link href="https://www.linuxzen.com/python-shi-yong-pyxmpp2bian-xie-gtalkqun.html" rel="alternate"></link><published>2012-10-29T14:48:00+08:00</published><updated>2012-10-29T14:48:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-10-29:/python-shi-yong-pyxmpp2bian-xie-gtalkqun.html</id><summary type="html">&lt;p&gt;gtalkæ˜¯ä¸€æ¬¾googleå¼€å‘çš„åŸºäºxmppåè®®çš„èŠå¤©è½¯ä»¶,å…¶ä¼˜ç‚¹å°±æ˜¯åè®®å¼€æº,æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»»ä½•æ”¯æŒxmppçš„å®¢æˆ·ç«¯åè®®æ¥é“¾æ¥gtalk,ä½†æ˜¯gtalkä¸æ”¯æŒç¾¤èŠå¤©,æ‰€ä»¥å„è·¯é«˜æ‰‹éƒ½ä¼šè‡ªå·±æ¥å¼€å‘ä¸€ä¸ªæœºå™¨äººæ¥æ”¯æŒç¾¤åŠŸèƒ½.&lt;/p&gt;
&lt;p&gt;å…¶å® â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;gtalkæ˜¯ä¸€æ¬¾googleå¼€å‘çš„åŸºäºxmppåè®®çš„èŠå¤©è½¯ä»¶,å…¶ä¼˜ç‚¹å°±æ˜¯åè®®å¼€æº,æˆ‘ä»¬å¯ä»¥é€šè¿‡ä»»ä½•æ”¯æŒxmppçš„å®¢æˆ·ç«¯åè®®æ¥é“¾æ¥gtalk,ä½†æ˜¯gtalkä¸æ”¯æŒç¾¤èŠå¤©,æ‰€ä»¥å„è·¯é«˜æ‰‹éƒ½ä¼šè‡ªå·±æ¥å¼€å‘ä¸€ä¸ªæœºå™¨äººæ¥æ”¯æŒç¾¤åŠŸèƒ½.&lt;/p&gt;
&lt;p&gt;å…¶å®ä¸»è¦åŸç†å°±æ˜¯æœºå™¨äººæ¥æ”¶åˆ°æ¶ˆæ¯åå†å°†æ¶ˆæ¯å¹¿æ’­å‡ºå»,ä»è€Œè¾¾åˆ°ç¾¤çš„æ•ˆæœ.&lt;/p&gt;
&lt;p&gt;pythonæœ‰ä¸¤ä¸ªæ¨¡å—å¯ä»¥ç”¨æ¥æ”¯æŒxmpp,åˆ†åˆ«æ˜¯pyxmppå’Œpyxmpp2,ä¹‹å‰ä¹Ÿç”¨pyxmppå†™äº†ä¸€ä¸ª,åŠŸèƒ½å’Œå…¼å®¹æ€§ä¸æ˜¯å¾ˆå¥½,ç»å¸¸å‡ºç°é—®é¢˜,æ‰€ä»¥åˆä½¿ç”¨pyxmpp2é‡å†™äº†ä¸€é,ä»Šå¤©ä¿®å¤äº†ä¸€äº›bug,æ‰€ä»¥å…¬å¸ƒå‡ºæ¥,å¤§å®¶å¯ä»¥ä¸‹è½½æµ‹è¯•,ä¹Ÿå¯ä»¥åŠ å…¥æˆ‘ä»¬ä½¿ç”¨gtalkè¿›è¡Œç¾¤äº¤æµ,&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬çš„gtalkæœºå™¨äººæ˜¯:&lt;code&gt;clubot@vim-cn.com&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å–œæ¬¢gtalk,åŒæ—¶å–œæ¬¢Linux/Python/Vimç­‰çˆ±å¥½è€…çš„åŒå­¦å¯ä»¥åŠ è¿›æ¥äº¤æµ&lt;/p&gt;
&lt;p&gt;å¦‚æœå¯¹æˆ‘ä»¬çš„ä»£ç æ¯”è¾ƒæ„Ÿå…´è¶£,å¯ä»¥è®¿é—®github,æˆ‘ä»¬å°†ä»£ç æ”¾åœ¨äº†githubä¸Š:https://github.com/coldnight/clubot&lt;/p&gt;
&lt;p&gt;ä¸‹é¢ä»‹ç»ä¸€ä¸‹å®‰è£…:&lt;/p&gt;
&lt;p&gt;ç¯å¢ƒä¸º:python 2.7, å› ä¸ºæœ‰å°‘é‡çš„shellæ‰€ä»¥ç³»ç»Ÿéœ€è¦Linux,ä¹Ÿå¯ç¨ä½œæ›´æ”¹æ”¯æŒwindows&lt;/p&gt;
&lt;p&gt;ä¸‹è½½æºç :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;git&lt;span class="w"&gt; &lt;/span&gt;clone&lt;span class="w"&gt; &lt;/span&gt;git://github.com/coldnight/clubot.git
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…ä¾èµ–:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;easy_install&lt;span class="w"&gt; &lt;/span&gt;pyxmpp2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¿®æ”¹settings.pyæ–‡ä»¶,å¡«å…¥botçš„è´¦æˆ·å’Œå¯†ç ,æ‰§è¡Œ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;python&lt;span class="w"&gt; &lt;/span&gt;clubot.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å³å¯å¼€å¯ç¾¤bot,ç¾¤botæ”¯æŒç¿»è¯‘,å¤©æ°”æŸ¥è¯¢,è´´ä»£ç ç­‰ç­‰å¾…åŠŸèƒ½.&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨æƒ³è´¡çŒ®ä»£ç å¯ä»¥åŠ å…¥æˆ‘ä»¬çš„botç¾¤:&lt;code&gt;clubot@vim-cn.com&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å¦‚æœæ‚¨æœ‰bugå¯ä»¥æäº¤åœ¨è¯„è®ºé‡Œ&lt;/p&gt;</content><category term="Python"></category><category term="ç¾¤"></category><category term="xmpp"></category><category term="pyxmpp2"></category><category term="python"></category><category term="gtalk"></category><category term="bot"></category></entry><entry><title>Linuxé«˜æ•ˆå·¥ä½œ----å¹³é“ºå¼çª—ä½“ç®¡ç†å™¨Awesome</title><link href="https://www.linuxzen.com/linuxgao-xiao-gong-zuo-ping-pu-shi-chuang-ti-guan-li-qi-awesome.html" rel="alternate"></link><published>2012-10-25T10:23:00+08:00</published><updated>2012-10-25T10:23:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-10-25:/linuxgao-xiao-gong-zuo-ping-pu-shi-chuang-ti-guan-li-qi-awesome.html</id><summary type="html">&lt;p&gt;åœ¨Linuxæ¡Œé¢ç¯å¢ƒä¸‹å¼€å‘,æ€»æƒ³æ›´é«˜æ•ˆçš„å·¥ä½œ,æˆ‘å·²ç»è£…å¤‡äº†Gnome Doå’Œterminator,ä½†æ˜¯æˆ‘è¿˜æ˜¯è§‰å¾—ä¸å¤Ÿå¿«æˆ‘æ›´åŠ å¸Œæœ›èƒ½è§£æ”¾å³æ‰‹(å½“ç„¶ä¸æ˜¯æ‰¾ä¸ªå¦¹å­æˆ’æ’¸,åªæ˜¯ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;åœ¨Linuxæ¡Œé¢ç¯å¢ƒä¸‹å¼€å‘,æ€»æƒ³æ›´é«˜æ•ˆçš„å·¥ä½œ,æˆ‘å·²ç»è£…å¤‡äº†Gnome Doå’Œterminator,ä½†æ˜¯æˆ‘è¿˜æ˜¯è§‰å¾—ä¸å¤Ÿå¿«æˆ‘æ›´åŠ å¸Œæœ›èƒ½è§£æ”¾å³æ‰‹(å½“ç„¶ä¸æ˜¯æ‰¾ä¸ªå¦¹å­æˆ’æ’¸,åªæ˜¯å³æ‰‹çš„é¼ æ ‡),è€Œä¸”terminatoråœ¨è·‘çš„ä¸œè¥¿è¿‡å¤šçš„æ—¶å€™å¼€å¤šä¸ªterminatorä¸å¤ªå¥½ç®¡ç†,è¿™æ—¶å€™ä¸€ä¸ªè¯è¿›å…¥äº†æˆ‘çš„çœ¼ç›å¹³é“ºå¼çª—ä½“ç®¡ç†å™¨,ä¸ä¼ ç»Ÿçª—ä½“ç®¡ç†å™¨ä¸åŒçš„æ˜¯å¹³é“ºå¼çª—ä½“ç®¡ç†å™¨çš„çª—å£ä¸ä¼šé‡å ,çª—å£ä¼šè¢«è‡ªåŠ¨è°ƒæ•´æˆæ­£å¥½é“ºæ»¡å…¨å±çš„å°ºå¯¸,ä¹Ÿå°±æ˜¯è¯´æ— è®ºå¼€å¤šå°‘çª—å£éƒ½ä¼šæŠŠå±å¹•å æ»¡,å¦‚æœæƒ³è±¡åŠ›è´«ä¹å°±è£…ä¸€ä¸ªè¯•è¯•å§:&lt;/p&gt;
&lt;p&gt;Awesomeæ˜¯ä¸€æ¬¾è¿è¡Œåœ¨Unixå’Œç±»Unix(Linux/FreeBSD)ç­‰ç³»ç»Ÿä¸Šçš„ä¸€æ¬¾å¹³é“ºå¼çª—ä½“ç®¡ç†å™¨,æœ‰å ç”¨èµ„æºå°,æ˜“äºç®¡ç†å’Œæ“ä½œç­‰ç­‰æœ‰ç‚¹,è¿™é‡Œä¸ç½—å—¦è¿™äº›è¯´è¯´å®‰è£…,Ubuntuå®‰è£…å¾ˆç®€å•&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sudo&lt;span class="w"&gt; &lt;/span&gt;apt-get&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;awesome
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…å¥½åç™»å‡ºä¼šè¯é€‰æ‹©awesomeç™»å½•,ç„¶åä½ æ˜¯å¦èŒ«ç„¶æ— çŸ¥æ²¡åŠæ³•å·¥ä½œäº†?å…ˆç®€å•ä»‹ç»ä¸‹ä½¿ç”¨æ–¹æ³•:&lt;/p&gt;
&lt;p&gt;æŒ‰&lt;code&gt;Winé”®+1~9&lt;/code&gt;å¯ä»¥åˆ‡æ¢æ¡Œé¢,&lt;/p&gt;
&lt;p&gt;æ²¡æœ‰èœå•å¯¹å§ å…¶å®å†å³ä¸Šè§’ç‚¹ä¸€ä¸‹å°±ä¼šå‡ºæ¥ä¸€ä¸ªèœå•,æ‰“å¼€ç¨‹åºä¼šå‘ç°æ ‡é¢˜æ çŠ¶æ€æ ä»€ä¹ˆéƒ½æœ¨æœ‰äº†å¤§å¤§èŠ‚çœäº†æ¡Œé¢ç©ºé—´,å¯é—®é¢˜æ¥äº†,æ€ä¹ˆå…³é—­å•Šä¸ç”¨æ‹…å¿ƒ&lt;/p&gt;
&lt;p&gt;æŒ‰ &lt;code&gt;Winé”®+Shift+C&lt;/code&gt;å¯ä»¥å…³é—­å½“å‰çª—å£&lt;/p&gt;
&lt;p&gt;æ‰“å¼€é»˜è®¤ç»ˆç«¯ &lt;code&gt;Winé”®+Enter&lt;/code&gt;å°±å¯ä»¥æ‰“å¼€ç»ˆç«¯&lt;/p&gt;
&lt;p&gt;å¯ä»¥æŒ‰ä½ &lt;code&gt;Winé”®+Shift+æ•°å­—&lt;/code&gt; å¯ä»¥å°†å½“å‰çª—å£å‘é€åˆ°ç›¸åº”çš„å·¥ä½œåŒº&lt;/p&gt;
&lt;p&gt;åŒæ ·å¯ä»¥åˆ‡æ¢å·¥ä½œåŒºçš„æ˜¯ &lt;code&gt;Win+j/Win+k&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Win+Space&lt;/code&gt;å¯ä»¥åˆ‡æ¢å½“å‰å·¥ä½œåŒºå¸ƒå±€&lt;/p&gt;
&lt;p&gt;æ˜¯ä¸æ˜¯å¾ˆé«˜æ•ˆ!æ˜¯ä¸æ˜¯è§£æ”¾äº†å³æ‰‹,é—®é¢˜æ¥äº†,æˆ‘çš„&lt;code&gt;gnome-do&lt;/code&gt;æ— æ³•ç”¨äº†,&lt;code&gt;win+space&lt;/code&gt;è¢«å äº†é˜¿,å¥½å§æˆ‘æŠŠ&lt;code&gt;Gnome-Do&lt;/code&gt;çš„å¿«æ·é”®è°ƒæˆ&lt;code&gt;Alt+Space&lt;/code&gt;,&lt;/p&gt;
&lt;p&gt;ä½†æ˜¯å¦‚ä½•æ·»åŠ å¼€æœºå¯åŠ¨ç¨‹åºå‘¢,å¾ˆç®€å•Awesomeçš„é…ç½®æ–‡ä»¶æ˜¯ä¸€ä¸ªluaè„šæœ¬(æˆ‘ä¸æ‡‚),å¯ä»¥åœ¨è¿™ä¸ªè„šæœ¬é‡Œæ·»åŠ å¯åŠ¨ç¨‹åº&lt;/p&gt;
&lt;p&gt;åˆ›å»ºé…ç½®æ–‡ä»¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;~/
mkdir&lt;span class="w"&gt; &lt;/span&gt;.config/awesome/
cp&lt;span class="w"&gt; &lt;/span&gt;/etc/xdg/awesome/rc.lua&lt;span class="w"&gt; &lt;/span&gt;.config/awesome/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç¼–è¾‘é…ç½®æ–‡ä»¶åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;autorun&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;true&lt;/span&gt;
&lt;span class="n"&gt;autorunApps&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; 
&lt;span class="p"&gt;{&lt;/span&gt; 
    &lt;span class="s2"&gt;&amp;quot;pidgin&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;thunderbird&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;gnome-do&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;guake&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
    &lt;span class="s2"&gt;&amp;quot;/opt/qq2012/wineapp/qq/qq.sh&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="kr"&gt;if&lt;/span&gt; &lt;span class="n"&gt;autorun&lt;/span&gt; &lt;span class="kr"&gt;then&lt;/span&gt;
    &lt;span class="kr"&gt;for&lt;/span&gt; &lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;#&lt;/span&gt;&lt;span class="n"&gt;autorunApps&lt;/span&gt; &lt;span class="kr"&gt;do&lt;/span&gt;
        &lt;span class="n"&gt;awful&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;util&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;spawn_with_shell&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;autorunApps&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
    &lt;span class="kr"&gt;end&lt;/span&gt;
&lt;span class="kr"&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¾ˆç®€å•å§,åº”è¯¥çœ‹å¾—å‡ºåœ¨å“ªé‡Œæ·»åŠ å¯åŠ¨çš„ç¨‹åºå§,è¿™é‡Œå¯åŠ¨äº†&lt;code&gt;pidgin&lt;/code&gt;,&lt;code&gt;é›·é¸Ÿ&lt;/code&gt;,&lt;code&gt;gnome-do&lt;/code&gt;,&lt;code&gt;guake&lt;/code&gt;å’Œ&lt;code&gt;wine&lt;/code&gt;çš„&lt;code&gt;qq2012&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;è¿˜æœ‰å¾ˆå¤šå¼ºå¤§çš„åŠŸèƒ½è¿™é‡Œå°±ä¸åœ¨ä»‹ç»é…ç½®æ–¹æ³•,å¯ä»¥è‡ªè¡Œgoogleä¹‹&lt;/p&gt;</content><category term="Linux"></category><category term="é«˜æ•ˆ"></category><category term="ç®¡ç†å™¨"></category><category term="çª—ä½“"></category><category term="æ¡Œé¢"></category><category term="å¹³é“ºå¼"></category><category term="Linux"></category><category term="awesome"></category></entry><entry><title>Pythonå°†æ±‰å­—æŒ‰æ‹¼éŸ³æ’åº--ä¸€ä¸ªå¤šéŸ³å­—å¼•å‘çš„æ‚²å‰§</title><link href="https://www.linuxzen.com/pythonjiang-yi-zi-an-pin-yin-pai-xu-yi-ge-duo-yin-zi-yin-fa-de-bei-ju.html" rel="alternate"></link><published>2012-10-24T18:29:00+08:00</published><updated>2012-10-24T18:29:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-10-24:/pythonjiang-yi-zi-an-pin-yin-pai-xu-yi-ge-duo-yin-zi-yin-fa-de-bei-ju.html</id><summary type="html">&lt;p&gt;ä»Šå¤©åŒäº‹å‘Šè¯‰æˆ‘ä¸€ä¸ªé¡¹ç›®éœ€è¦å°†æ±‰å­—æŒ‰æ‹¼éŸ³æ’åº,ä¹‹å‰æ²¡åšè¿‡å•Š,å°±googleä¹‹,downäº†ä¸€ä»½æ±‰å­—ä¸æ‹¼éŸ³çš„å¯¹ç…§è¡¨,å¯¹ç…§è¡¨æ ¼å¼å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;æ‹¼    pin1
éŸ³    yin1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å°†æ–‡ä»¶ä¿å­˜ä¸º&lt;code&gt;pinyindata&lt;/code&gt;,äºæ˜¯ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;ä»Šå¤©åŒäº‹å‘Šè¯‰æˆ‘ä¸€ä¸ªé¡¹ç›®éœ€è¦å°†æ±‰å­—æŒ‰æ‹¼éŸ³æ’åº,ä¹‹å‰æ²¡åšè¿‡å•Š,å°±googleä¹‹,downäº†ä¸€ä»½æ±‰å­—ä¸æ‹¼éŸ³çš„å¯¹ç…§è¡¨,å¯¹ç…§è¡¨æ ¼å¼å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;æ‹¼    pin1
éŸ³    yin1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å°†æ–‡ä»¶ä¿å­˜ä¸º&lt;code&gt;pinyindata&lt;/code&gt;,äºæ˜¯æœ‰äº†å¦‚ä¸‹å¯¹åº”çš„pythonä»£ç :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c1"&gt;# -*- coding:utf-8 -*-&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# Author : cold night&lt;/span&gt;
&lt;span class="c1"&gt;# E-mail : wh_linux@126.com&lt;/span&gt;
&lt;span class="c1"&gt;# Date   : 12-10-24 ä¸‹åˆ3:13&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;os&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;path&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;locale&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;SortedByPy&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;__PYDICT__&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;PYDATA_PATH&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;path&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dirname&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="vm"&gt;__file__&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;pinyindata&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__PYDICT__&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;py_file&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PYDATA_PATH&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;r&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;py_file&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readlines&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
                &lt;span class="n"&gt;word&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;pinyin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\t&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
                &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__PYDICT__&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="n"&gt;word&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;pinyin&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strip&lt;/span&gt;&lt;span class="p"&gt;()})&lt;/span&gt;
            &lt;span class="n"&gt;py_file&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_py&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;word&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;        è·å–æ±‰å­—æ‹¼éŸ³&lt;/span&gt;
&lt;span class="sd"&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
        &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;word&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;decode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;encode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__PYDICT__&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;cmp_by_py&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;        ä½¿ç”¨æ‹¼éŸ³æ¯”è¾ƒä¸¤ä¸ªæ±‰å­—çš„å…ˆå(ä½¿ç”¨å€’åº)&lt;/span&gt;
&lt;span class="sd"&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;

        &lt;span class="n"&gt;r1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_py&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;r2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_py&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;cmp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;iterable&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;        - `iterable` :&lt;/span&gt;
&lt;span class="sd"&gt;        - `key` : æœ‰åˆ™å¯¹åˆ—è¡¨ä¸­çš„å­—å…¸å¯¹åº”keyçš„å€¼è¿›è¡Œæ’åº&lt;/span&gt;
&lt;span class="sd"&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;v&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;enumerate&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iterable&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="n"&gt;v&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;f&lt;/span&gt; &lt;span class="o"&gt;&amp;lt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;z&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iterable&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;cmp&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cmp_by_py&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;sorted&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iterable&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmp&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cmp_by_py&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;]),&lt;/span&gt; &lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;sorted&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iterable&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmp&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cmp_by_py&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extend&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å—¯,å†™å¥½åæµ‹è¯•æ­£å¸¸,æäº¤åå‘Šè¯‰åŒäº‹,åŒäº‹ä¸€æµ‹å‘ç°é‡åº†æ€ä¹ˆè·‘åˆ°æœ€åå•Š,ä¸å¯¹å•Š,æœ‰bugå•Š,æˆ‘é‡æ–°å°†é‡åº†åŠ å…¥åˆ°æˆ‘çš„æµ‹è¯•,çœŸæ˜¯ä¸è¡Œé˜¿,å¥½å§å¯èƒ½æ˜¯å¯¹ç…§è¡¨çš„é—®é¢˜,æ‰“å¼€æ‰¾äº†ä¸‹,èƒ½æ‰¾åˆ°é‡å•Š,éš¾é“æ˜¯decodeå‡ºé—®é¢˜äº†,äºæ˜¯æ‰“å¼€å’±çš„ipython shell,ç»“æœè¾“å…¥é‡åº†,ä¸€å›è½¦ç»ˆç«¯å´©äº†,å¥½å§,æˆ‘å†è¯•è¿˜æ˜¯å´©,äºæ˜¯æˆ‘æƒ³å¯èƒ½æ˜¯utf-8çš„bugæˆ–è€…pythonçš„uft-8çš„bug,äºæ˜¯æˆ‘å°†æˆ‘çš„æƒ³æ³•å‘ŠçŸ¥äº†åŒäº‹,åŒäº‹ä¹Ÿæ‰“å¼€äº†&lt;code&gt;ipythonè¯•&lt;/code&gt;äº†ä¸‹,ç»“æœä»–çš„å¯ä»¥æ­£å¸¸è¾“å…¥,æ­£å¸¸decode/encode,è¿™ä¸‹æˆ‘æƒ³å¯èƒ½æ˜¯æ–¹æ³•çš„é—®é¢˜å§.&lt;/p&gt;
&lt;p&gt;äºæ˜¯çœ‹çœ‹æœ‰æ— åˆ«çš„åŠæ³•,çœ‹åˆ°ä¸€ä¸ªå¯¹Linuxæœ‰æ•ˆå¯èƒ½å¯¹windowæœ‰æ•ˆçš„åŠæ³•,å¥½å˜›æ­£å¥½å’±ä¹ŸLinuxæœæ–­æ‹¿è¿‡æ¥è¯•è¯•,äºæ˜¯ä¸‹é¢çš„ä»£ç è¯ç”Ÿäº†:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c1"&gt;# -*- coding:utf-8 -*-&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# Author : cold night&lt;/span&gt;
&lt;span class="c1"&gt;# E-mail : wh_linux@126.com&lt;/span&gt;
&lt;span class="c1"&gt;# Date   : 12-10-24 ä¸‹åˆ3:13&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#from os import path&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;locale&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;SortedByPy&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;__PYDICT__&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="c1"&gt;#PYDATA_PATH = path.join(path.dirname(__file__), &amp;#39;pinyindata&amp;#39;)&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="fm"&gt;__init__&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;        if not self.__PYDICT__:&lt;/span&gt;
&lt;span class="sd"&gt;            py_file = open(self.PYDATA_PATH, &amp;#39;r&amp;#39;)&lt;/span&gt;
&lt;span class="sd"&gt;            for line in py_file.readlines():&lt;/span&gt;
&lt;span class="sd"&gt;                word, pinyin = line.split(&amp;#39;\t&amp;#39;)&lt;/span&gt;
&lt;span class="sd"&gt;                self.__PYDICT__.update({word:pinyin.strip()})&lt;/span&gt;
&lt;span class="sd"&gt;            py_file.close()&lt;/span&gt;
&lt;span class="sd"&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="k"&gt;pass&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;get_py&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;word&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;        è·å–æ±‰å­—æ‹¼éŸ³&lt;/span&gt;
&lt;span class="sd"&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
        &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;word&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;decode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;encode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;__PYDICT__&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;cmp_by_py&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;        ä½¿ç”¨æ‹¼éŸ³æ¯”è¾ƒä¸¤ä¸ªæ±‰å­—çš„å…ˆå(ä½¿ç”¨å€’åº)&lt;/span&gt;
&lt;span class="sd"&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;

        &lt;span class="n"&gt;r1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_py&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;r2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_py&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;B&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;cmp&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;r2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;iterable&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;False&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;        - `iterable` :&lt;/span&gt;
&lt;span class="sd"&gt;        - `key` : æœ‰åˆ™å¯¹åˆ—è¡¨ä¸­çš„å­—å…¸å¯¹åº”keyçš„å€¼è¿›è¡Œæ’åº&lt;/span&gt;
&lt;span class="sd"&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="sd"&gt;&amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
&lt;span class="sd"&gt;        for i,v in enumerate(iterable):&lt;/span&gt;
&lt;span class="sd"&gt;            f = v[key][0] if key else v[0]&lt;/span&gt;
&lt;span class="sd"&gt;            if f &amp;lt;= &amp;#39;z&amp;#39;:result.append(iterable.pop(i))&lt;/span&gt;
&lt;span class="sd"&gt;        if key:&lt;/span&gt;
&lt;span class="sd"&gt;            result.sort(cmp = lambda x, y: self.cmp_by_py(x[key], y[key]), reverse= reverse)&lt;/span&gt;
&lt;span class="sd"&gt;        else:&lt;/span&gt;
&lt;span class="sd"&gt;            result.sort(reverse=reverse)&lt;/span&gt;
&lt;span class="sd"&gt;        &amp;quot;&amp;quot;&amp;quot;&lt;/span&gt;
        &lt;span class="n"&gt;locale&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;setlocale&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;locale&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;LC_ALL&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;zh_CN.UTF-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;sorted&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iterable&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmp&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;locale&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strcoll&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;r&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;sorted&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;iterable&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;cmp&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;locale&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;strcoll&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extend&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å†™å¥½äº†è·‘èµ·æ¥æµ‹è¯•å˜›,é‡åº†è¿˜æ˜¯èººåœ¨äº†æœ€å,æˆ‘æƒ³è¿™åº”è¯¥å°±æ˜¯utf-8çš„bugäº†å§,ç³»ç»Ÿéƒ½è¿™æ ·äº†,äºæ˜¯å’ŒåŒäº‹äº¤æµåè®¤ä¸ºä¹Ÿè®¸æ˜¯bugå§,å›åˆ°åº§ä½åæˆ‘è‹¦æ€å†¥æƒ³é˜¿,ç»å°½è„‘æ±å•Š,çœ‹çœ‹æœ‰æ²¡æœ‰åˆ«çš„åŠæ³•é˜¿,çªç„¶ä¸€é“é—ªç”µé˜¿,æˆ‘æ˜ç™½äº†,é‡&lt;code&gt;å¤šéŸ³å­—&lt;/code&gt;å•Šä¹Ÿè¯»&lt;code&gt;zhong&lt;/code&gt;å•Š,æ’åœ¨æœ€åæ˜¯å¯¹çš„å•Š,æ²¡æœ‰é”™è¯¯,ä¹Ÿæ²¡æœ‰bug,ä¸€ä¸ª&lt;code&gt;å¤šéŸ³å­—&lt;/code&gt;å¼•å‘çš„æ‚²å‰§å“‡.&lt;/p&gt;</content><category term="Python"></category><category term="æ±‰å­—æ’åº"></category><category term="æ±‰å­—"></category><category term="æ’åº"></category><category term="æ‹¼éŸ³"></category><category term="å¤šéŸ³å­—"></category><category term="python"></category></entry><entry><title>éƒ¨ç½²Tornadoæ—¶iptableså¼•å‘çš„çš„ä¸€ä¸ªé—®é¢˜</title><link href="https://www.linuxzen.com/bu-shu-tornadoshi-iptablesyin-fa-de-de-yi-ge-wen-ti.html" rel="alternate"></link><published>2012-09-29T19:11:00+08:00</published><updated>2012-09-29T19:11:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-09-29:/bu-shu-tornadoshi-iptablesyin-fa-de-de-yi-ge-wen-ti.html</id><summary type="html">&lt;p&gt;ä»Šå¤©åœ¨CentOSä¸Šéƒ¨ç½²äº†ä¸€ä¸ªTornado,ä½¿ç”¨nginxåšä»£ç†,&lt;/p&gt;
&lt;p&gt;tornadoä½¿ç”¨8888,ç«¯å£,ä½¿ç”¨nginxä½œä¸ºåå‘ä»£ç†,é…ç½®æ–‡ä»¶å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;server&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kn"&gt;listen&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kn"&gt;server_name&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;www.linuxzen.com&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kn"&gt;location&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kn"&gt;proxy_pass_header&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;Server&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kn"&gt;proxy_redirect&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;off&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kn"&gt;proxy_set_header&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;X-Real_IP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$remote_addr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kn"&gt;proxy_set_header&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;X-Scheme&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$scheme&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kn"&gt;proxy_pass&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;http://127.0.0.1:8888&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;iptables filterè¡¨çš„INPUTé“¾æ˜¯DROPçš„,æ‰€ä»¥æ·»åŠ  â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;ä»Šå¤©åœ¨CentOSä¸Šéƒ¨ç½²äº†ä¸€ä¸ªTornado,ä½¿ç”¨nginxåšä»£ç†,&lt;/p&gt;
&lt;p&gt;tornadoä½¿ç”¨8888,ç«¯å£,ä½¿ç”¨nginxä½œä¸ºåå‘ä»£ç†,é…ç½®æ–‡ä»¶å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;server&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kn"&gt;listen&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kn"&gt;server_name&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;www.linuxzen.com&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="kn"&gt;location&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kn"&gt;proxy_pass_header&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;Server&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kn"&gt;proxy_redirect&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="no"&gt;off&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kn"&gt;proxy_set_header&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;X-Real_IP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$remote_addr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kn"&gt;proxy_set_header&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;X-Scheme&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$scheme&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="kn"&gt;proxy_pass&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;http://127.0.0.1:8888&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;iptables filterè¡¨çš„INPUTé“¾æ˜¯DROPçš„,æ‰€ä»¥æ·»åŠ å¦‚ä¸‹è§„åˆ™:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;iptables&lt;span class="w"&gt; &lt;/span&gt;-A&lt;span class="w"&gt; &lt;/span&gt;INPUT&lt;span class="w"&gt; &lt;/span&gt;-p&lt;span class="w"&gt; &lt;/span&gt;tcp&lt;span class="w"&gt;  &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;127&lt;/span&gt;.0.0.1&lt;span class="w"&gt; &lt;/span&gt;--dport&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;8888&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-j&lt;span class="w"&gt; &lt;/span&gt;ACCEPT
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä½†æ˜¯è®¿é—®nginxæ€»æ˜¯è¿”å›502 Bad Gateway.ä¸€å¼€å§‹ä¸è®¤ä¸ºæ˜¯é˜²ç«å¢™çš„é—®é¢˜,æ‰€ä»¥ç™¾æ€ä¸å¾—å…¶è§£,å„ç§é—®é¢˜è¯•è¿‡éƒ½ä¸è¡Œä¹‹å,åæ¥æƒ³æƒ³tornadoè¿”å›æ•°æ®åŒæ ·ä¹Ÿæ˜¯ä¸€æ¡è¿›ç«™,æ‰€ä»¥è¿˜éœ€è¦æ·»åŠ ä¸€æ¡&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;iptables&lt;span class="w"&gt; &lt;/span&gt;-A&lt;span class="w"&gt; &lt;/span&gt;INPUT&lt;span class="w"&gt; &lt;/span&gt;-p&lt;span class="w"&gt; &lt;/span&gt;tcp&lt;span class="w"&gt; &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;127&lt;/span&gt;.0.0.1&lt;span class="w"&gt; &lt;/span&gt;--dport&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;8888&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-j&lt;span class="w"&gt; &lt;/span&gt;ACCEPT
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è‡³æ­¤,é€šè¿‡nginxæ‰èƒ½æ­£å¸¸è®¿é—®tornado&lt;/p&gt;</content><category term="Linux"></category><category term="tornado"></category><category term="nginx"></category><category term="iptables"></category><category term="bad gateway"></category><category term="502"></category></entry><entry><title>ç”¨Vimä¸ºPythonæºç è‡ªåŠ¨æ·»åŠ #!è¡Œå’Œç¼–ç è¡Œ</title><link href="https://www.linuxzen.com/yong-vimwei-pythonyuan-ma-zi-dong-tian-jia-xing-he-bian-ma-xing.html" rel="alternate"></link><published>2012-09-29T18:56:00+08:00</published><updated>2012-09-29T18:56:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-09-29:/yong-vimwei-pythonyuan-ma-zi-dong-tian-jia-xing-he-bian-ma-xing.html</id><summary type="html">&lt;p&gt;æ¯æ¬¡å¼€å§‹å†™Pythonæ‰“å¼€æ–‡ä»¶ç¬¬ä¸€ä»¶äº‹å°±æ˜¯å†™ä¸Š&lt;code&gt;#!/usr/bin/env pythonå’Œ&lt;/code&gt;ç¼–ç ä¹‹ç±»çš„ä¸œè¥¿,&lt;/p&gt;
&lt;p&gt;å¤ªå¤šäº†,å†™çƒ¦å°±,å†™äº†ä¸€ä¸ªæ‰“å¼€Pythonè‡ªåŠ¨å¡«å……çš„å‡½æ•°,å°†ä¸‹é¢å†…å®¹æ·»åŠ åˆ°&lt;code&gt;~/.vimrc&lt;/code&gt;ä¸‹å³å¯æ¯æ¬¡æ‰“å¼€å¦‚æœæ²¡æœ‰ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;æ¯æ¬¡å¼€å§‹å†™Pythonæ‰“å¼€æ–‡ä»¶ç¬¬ä¸€ä»¶äº‹å°±æ˜¯å†™ä¸Š&lt;code&gt;#!/usr/bin/env pythonå’Œ&lt;/code&gt;ç¼–ç ä¹‹ç±»çš„ä¸œè¥¿,&lt;/p&gt;
&lt;p&gt;å¤ªå¤šäº†,å†™çƒ¦å°±,å†™äº†ä¸€ä¸ªæ‰“å¼€Pythonè‡ªåŠ¨å¡«å……çš„å‡½æ•°,å°†ä¸‹é¢å†…å®¹æ·»åŠ åˆ°&lt;code&gt;~/.vimrc&lt;/code&gt;ä¸‹å³å¯æ¯æ¬¡æ‰“å¼€å¦‚æœæ²¡æœ‰ä¸Šè¿°è¡Œåˆ™ä¼šè‡ªåŠ¨å¡«å……:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;function&lt;/span&gt; InsertPythonHeader&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;let&lt;/span&gt; l1 &lt;span class="p"&gt;=&lt;/span&gt; getline&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;let&lt;/span&gt; l2 &lt;span class="p"&gt;=&lt;/span&gt; getline&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt;  &lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;\#!/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; l1&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;==&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt;
        exec &lt;span class="m"&gt;1&lt;/span&gt;
        normal O
        &lt;span class="k"&gt;call&lt;/span&gt; setline&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#!/usr/bin/env python&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;endif&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\#&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; l2&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;==&lt;/span&gt; &lt;span class="m"&gt;0&lt;/span&gt; &amp;amp;&amp;amp; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;-&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; l2&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="p"&gt;!=&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt; Â¦Â¦ &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;match&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;code&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; l2&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="p"&gt;!=&lt;/span&gt; &lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
        exec &lt;span class="m"&gt;2&lt;/span&gt;
        normal O
        &lt;span class="k"&gt;call&lt;/span&gt; setline&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;#-*- coding:utf-8 -*-&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;endif&lt;/span&gt;
&lt;span class="k"&gt;endfunction&lt;/span&gt;

&lt;span class="k"&gt;au&lt;/span&gt; &lt;span class="nb"&gt;FileType&lt;/span&gt; python &lt;span class="k"&gt;call&lt;/span&gt; InsertPythonHeader&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Vim"></category><category term="è‡ªåŠ¨"></category><category term="ç¼–ç ä¿¡æ¯"></category><category term="æ·»åŠ "></category><category term="vim"></category><category term="shbang line"></category><category term="python"></category></entry><entry><title>åˆ†äº«Vimä¸¤ç§å¥½ç”¨çš„åŠŸèƒ½:çŠ¶æ€è¡Œå’Œç©ºç™½å­—ç¬¦å¯è§</title><link href="https://www.linuxzen.com/fen-xiang-vimliang-chong-hao-yong-de-gong-neng-zhuang-tai-xing-he-kong-bai-zi-fu-ke-jian.html" rel="alternate"></link><published>2012-09-29T17:30:00+08:00</published><updated>2012-09-29T17:30:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-09-29:/fen-xiang-vimliang-chong-hao-yong-de-gong-neng-zhuang-tai-xing-he-kong-bai-zi-fu-ke-jian.html</id><summary type="html">&lt;p&gt;é©¬ä¸Šè¦æ”¾å‡äº†,æ²¡äº‹æŠ˜è…¾äº†ä¸€ä¸‹Vimå‘ç°äº†ä¸¤ä¸ªéå¸¸æ£’çš„åŠŸèƒ½,ä¸€ä¸ªæ˜¯ç»™Vimæ·»åŠ ä¸€ä¸ªçŠ¶æ€æ ,ä¸€ä¸ªæ˜¯å¯ä»¥åœ¨ç¼–è¾‘çš„æ—¶å€™æ˜¾ç¤ºç©ºç™½,&lt;/p&gt;
&lt;p&gt;æˆ‘çš„çŠ¶æ€æ æ˜¾ç¤ºäº†:
æ­£åœ¨ç¼–è¾‘çš„æ–‡ä»¶å â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;é©¬ä¸Šè¦æ”¾å‡äº†,æ²¡äº‹æŠ˜è…¾äº†ä¸€ä¸‹Vimå‘ç°äº†ä¸¤ä¸ªéå¸¸æ£’çš„åŠŸèƒ½,ä¸€ä¸ªæ˜¯ç»™Vimæ·»åŠ ä¸€ä¸ªçŠ¶æ€æ ,ä¸€ä¸ªæ˜¯å¯ä»¥åœ¨ç¼–è¾‘çš„æ—¶å€™æ˜¾ç¤ºç©ºç™½,&lt;/p&gt;
&lt;p&gt;æˆ‘çš„çŠ¶æ€æ æ˜¾ç¤ºäº†:
æ­£åœ¨ç¼–è¾‘çš„æ–‡ä»¶å,
é€‰é¡¹
æ˜¯Gitæ˜¾ç¤ºgitåˆ†æ”¯(éœ€è¦fugitiveæ’ä»¶)
æ–‡ä»¶ç±»å‹
å½“å‰ç›®å½•
å½“å‰å­—ç¬¦çš„ASCIIå’Œ16è¿›åˆ¶ç 
å³è¾¹æ˜¯å½“å‰å…‰æ ‡æ‰€åœ¨è¡Œ/åˆ—,æ–‡ä»¶çš„ä½ç½®çš„ç™¾åˆ†æ¯”,å’Œæ–‡ä»¶çš„é•¿åº¦
fugitive å¯ä»¥åœ¨gitè·å¾—:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;git clone http://github.com/tpope/vim-fugitive.git
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å°†pluginç›®å½•ä¸‹çš„fugitive.vimå¤åˆ¶åˆ°~/.vim/pluginä¸‹
åœ¨~/.vimrcæ·»åŠ å¦‚ä¸‹å†…å®¹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;if&lt;/span&gt; has&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;statusline&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nb"&gt;laststatus&lt;/span&gt;&lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;
    &lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nb"&gt;statusline&lt;/span&gt;&lt;span class="p"&gt;=&lt;/span&gt;%&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;%&lt;span class="k"&gt;f&lt;/span&gt;\   &lt;span class="c"&gt;&amp;quot; æ–‡ä»¶å&lt;/span&gt;
    &lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nb"&gt;statusline&lt;/span&gt;&lt;span class="p"&gt;+=&lt;/span&gt;%&lt;span class="k"&gt;w&lt;/span&gt;%&lt;span class="k"&gt;h&lt;/span&gt;%&lt;span class="k"&gt;m&lt;/span&gt;%&lt;span class="k"&gt;r&lt;/span&gt; &lt;span class="c"&gt;&amp;quot; é€‰é¡¹&lt;/span&gt;
    &lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nb"&gt;statusline&lt;/span&gt;&lt;span class="p"&gt;+=&lt;/span&gt;%{fugitive#&lt;span class="nb"&gt;statusline&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;} &lt;span class="c"&gt;&amp;quot;Git&lt;/span&gt;
    &lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nb"&gt;statusline&lt;/span&gt;&lt;span class="p"&gt;+=&lt;/span&gt;\ [%{&amp;amp;&lt;span class="nb"&gt;ff&lt;/span&gt;}/%Y]            &lt;span class="c"&gt;&amp;quot; filetype&lt;/span&gt;
    &lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nb"&gt;statusline&lt;/span&gt;&lt;span class="p"&gt;+=&lt;/span&gt;\ [%{getcwd&lt;span class="p"&gt;()&lt;/span&gt;}]          &lt;span class="c"&gt;&amp;quot; current dir&lt;/span&gt;
    &lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nb"&gt;statusline&lt;/span&gt;&lt;span class="p"&gt;+=&lt;/span&gt;\ [A&lt;span class="p"&gt;=&lt;/span&gt;\%&lt;span class="m"&gt;03&lt;/span&gt;.&lt;span class="m"&gt;3&lt;/span&gt;b&lt;span class="sr"&gt;/H=\%02.2B] &amp;quot; ASCII /&lt;/span&gt; Hexadecimal value of char
    &lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nb"&gt;statusline&lt;/span&gt;&lt;span class="p"&gt;+=&lt;/span&gt;%&lt;span class="p"&gt;=&lt;/span&gt;%&lt;span class="m"&gt;-14&lt;/span&gt;.&lt;span class="p"&gt;(&lt;/span&gt;%&lt;span class="k"&gt;l&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;%&lt;span class="k"&gt;c&lt;/span&gt;%V%&lt;span class="p"&gt;)&lt;/span&gt;\ %&lt;span class="k"&gt;p&lt;/span&gt;%%\ %L  &lt;span class="c"&gt;&amp;quot; Right aligned file nav info&lt;/span&gt;
&lt;span class="k"&gt;endif&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¦æƒ³åœ¨ç¼–è¾‘æ—¶å°†ç©ºç™½å¯è§å¯ä»¥åœ¨.vimrcä¸­æ·»åŠ å¦‚ä¸‹å†…å®¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;set&lt;/span&gt; &lt;span class="nb"&gt;listchars&lt;/span&gt;&lt;span class="p"&gt;=&lt;/span&gt;&lt;span class="k"&gt;tab&lt;/span&gt;:&lt;span class="p"&gt;&amp;gt;-,&lt;/span&gt;trail:&lt;span class="p"&gt;-,&lt;/span&gt;extends:#&lt;span class="p"&gt;,&lt;/span&gt;nbsp:&lt;span class="p"&gt;-&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å³å¯tabæ˜¾ç¤ºä¸º&amp;gt;---,ç©ºæ ¼æ˜¾ç¤º-,è¡Œå°¾çš„ç©ºç™½æ˜¾ç¤º-,&lt;/p&gt;
&lt;p&gt;è®¾ç½®å®Œåéå¸¸çš„cool,ä¸Šå›¾ä¸€å¼ :
&lt;img alt="vimç©ºç™½ç¬¦" src="/upload/Screenshot-2012-09-29-173517.png"&gt;&lt;/p&gt;</content><category term="Vim"></category><category term="ç©ºç™½"></category><category term="å­—ç¬¦"></category><category term="å¯è§"></category><category term="vim"></category><category term="statusline"></category></entry><entry><title>ç”¨Pythonå°†ç»å¯¹URLæ›¿æ¢æˆç›¸å¯¹URL</title><link href="https://www.linuxzen.com/yong-pythonjiang-jue-dui-urlti-huan-cheng-xiang-dui-url.html" rel="alternate"></link><published>2012-09-29T15:52:00+08:00</published><updated>2012-09-29T15:52:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-09-29:/yong-pythonjiang-jue-dui-urlti-huan-cheng-xiang-dui-url.html</id><summary type="html">&lt;p&gt;å…¬å¸ä¸€ä¸ªé¡¹ç›®éœ€è¦ä¸Šä¼ å›¾ç‰‡,ä¸€å¼€å§‹åŒäº‹å°†å›¾ç‰‡ä¸Šä¼ åç»“åˆå½“å‰ä¸»æœºæ‹¼æˆäº†ä¸€ä¸ªç»å¯¹çš„URL(&lt;a href="#"&gt;http://192.168.1.1:888/m/getimg?filename=xxx.jpg&lt;/a&gt;ç”± â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;å…¬å¸ä¸€ä¸ªé¡¹ç›®éœ€è¦ä¸Šä¼ å›¾ç‰‡,ä¸€å¼€å§‹åŒäº‹å°†å›¾ç‰‡ä¸Šä¼ åç»“åˆå½“å‰ä¸»æœºæ‹¼æˆäº†ä¸€ä¸ªç»å¯¹çš„URL(&lt;a href="#"&gt;http://192.168.1.1:888/m/getimg?filename=xxx.jpg&lt;/a&gt;ç”±äºåŒæ—¶ç»™æ‰‹æœºç»ˆç«¯æä¾›æ¥å£,åœ¨æ‰‹æœºç»ˆç«¯ä¼šå¼•èµ·ä¸€äº›bug,æ”¹å®Œä»£ç åè¦æ±‚å°†ä»¥å‰çš„uriæ›¿æ¢æˆç›¸å¯¹çš„URL(/m/getimg?filename=xxx.jpg),ç”±äºå›¾ç‰‡æ˜¯ç”¨imgæ ‡ç­¾åµŒå…¥åˆ°å†…å®¹åŒæ—¶ç”¨aæ ‡ç­¾æ‹¬èµ·æ˜¾ç¤ºå¤§å›¾çš„,æ‰€ä»¥éœ€è¦è¯»å–æ•°æ®åº“å¹¶å¯¹å†…å®¹è¿›è¡Œæ›¿æ¢,&lt;/p&gt;
&lt;p&gt;è„šæœ¬å†…å®¹å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c1"&gt;#-*- coding:utf-8 -*-&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# author  : cold night&lt;/span&gt;
&lt;span class="c1"&gt;# email   : wh_linux@126.com&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;pymongo&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;re&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;StringIO&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;StringIO&lt;/span&gt;

&lt;span class="n"&gt;conn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;pymongo&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Connection&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;db&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;test&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;replace_url&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;regex&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;re&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;compile&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;([hrefÂ¦src])=[&amp;quot;Â¦&lt;/span&gt;&lt;span class="se"&gt;\&amp;#39;&lt;/span&gt;&lt;span class="s1"&gt;]http://.*?(/m/getimg\?.*?)[&amp;quot;Â¦&lt;/span&gt;&lt;span class="se"&gt;\&amp;#39;&lt;/span&gt;&lt;span class="s1"&gt;]&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;results&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;test&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;db_coll&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;test&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;content&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="k"&gt;return&lt;/span&gt;
        &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;StringIO&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;seek&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;StringIO&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;readlines&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
            &lt;span class="n"&gt;t&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;regex&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sub&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;r&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;\1=&amp;quot;\2&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;seek&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;content&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;
        &lt;span class="n"&gt;_id&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;_id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;db_coll&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;_id&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;_id&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="n"&gt;r&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;results&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;results&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;replace_url&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Python"></category><category term="ç»å¯¹"></category><category term="ç›¸å¯¹"></category><category term="æ›¿æ¢"></category><category term="url"></category><category term="python"></category></entry><entry><title>ç”¨Pythonå¯¹å„ç§ç¼–ç¨‹è¯­è¨€è¿›è¡Œä»£ç é«˜äº®</title><link href="https://www.linuxzen.com/yong-pythondui-ge-chong-bian-cheng-yu-yan-jin-xing-dai-ma-gao-liang.html" rel="alternate"></link><published>2012-09-29T15:11:00+08:00</published><updated>2012-09-29T15:11:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-09-29:/yong-pythondui-ge-chong-bian-cheng-yu-yan-jin-xing-dai-ma-gao-liang.html</id><summary type="html">&lt;p&gt;åšäº†ä¸€ä¸ªåœ¨çº¿ä»£ç é«˜äº®çš„é¡¹ç›®,å› ä¸ºå†™çš„Gtalkç¾¤Botéœ€è¦è¿™ä¸ªåŠŸèƒ½æ”¯æŒ,è´´åˆ°ç¬¬ä¸‰æ–¹æ€•è¢«äººç»™å°,æ‰€ä»¥å¹²è„†æƒ³è‡ªå·±å†™ä¸€ä¸ª,å¼ºå¤§çš„Pythonä¸€å¦‚æ—¢å¾€æ²¡è®©æˆ‘å¤±æœ›,ä¸€ä¸ªå¼ºå¤§çš„Pygmentsæ¨¡å—å¯ä»¥å¯¹å¤šç§(å¾ˆå¤š â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;åšäº†ä¸€ä¸ªåœ¨çº¿ä»£ç é«˜äº®çš„é¡¹ç›®,å› ä¸ºå†™çš„Gtalkç¾¤Botéœ€è¦è¿™ä¸ªåŠŸèƒ½æ”¯æŒ,è´´åˆ°ç¬¬ä¸‰æ–¹æ€•è¢«äººç»™å°,æ‰€ä»¥å¹²è„†æƒ³è‡ªå·±å†™ä¸€ä¸ª,å¼ºå¤§çš„Pythonä¸€å¦‚æ—¢å¾€æ²¡è®©æˆ‘å¤±æœ›,ä¸€ä¸ªå¼ºå¤§çš„Pygmentsæ¨¡å—å¯ä»¥å¯¹å¤šç§(å¾ˆå¤š)è¯­è¨€è¿›è¡Œä»£ç é«˜äº®&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ¥ä»‹ç»ä¸€ä¸‹å®ƒ:&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå®‰è£…å¾ˆç®€å•,ä½¿ç”¨easy_installæ¥è¿›è¡Œå®‰è£…:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;easy_install&lt;span class="w"&gt; &lt;/span&gt;pygments
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…å®Œåæˆ‘ä»¬æ¥ä½¿ç”¨,Pythonçš„ç®€å•ä¸ä¼šè®©å¤§å®¶å¤±æœ›:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pygments.lexers&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;PythonLexver&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pygments.formatters&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;HtmlFormatter&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;pygments&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;highlight&lt;/span&gt;

&lt;span class="n"&gt;formatter&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;HtmlFormatter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;encoding&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;style&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;emacs&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;linenos&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;code&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;highlight&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;print &amp;quot;hello, world&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;PythonLexer&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;formatter&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;code&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h5 id="_1"&gt;ç»“æœ&lt;/h5&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&amp;#39;&lt;span class="nt"&gt;&amp;lt;table&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;highlighttable&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;tr&amp;gt;&amp;lt;td&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;linenos&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;div&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;linenodiv&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;pre&amp;gt;&lt;/span&gt;1&lt;span class="nt"&gt;&amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&amp;lt;/td&amp;gt;&amp;lt;td&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;code&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;div&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;highlight&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&amp;lt;pre&amp;gt;&amp;lt;span&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;k&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;print&lt;span class="nt"&gt;&amp;lt;/span&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;span&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="na"&gt;class=&lt;/span&gt;&lt;span class="s"&gt;&amp;quot;s&amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;gt;&lt;/span&gt;&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;hello,&lt;span class="w"&gt; &lt;/span&gt;world&lt;span class="ni"&gt;&amp;amp;quot;&lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;/span&amp;gt;&lt;/span&gt;\n&lt;span class="nt"&gt;&amp;lt;/pre&amp;gt;&amp;lt;/div&amp;gt;&lt;/span&gt;\n&lt;span class="nt"&gt;&amp;lt;/td&amp;gt;&amp;lt;/tr&amp;gt;&amp;lt;/table&amp;gt;&lt;/span&gt;&amp;#39;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ ·å°±ç®€å•çš„å¯¹ä»£ç è¿›è¡Œäº†é«˜äº®,å½“ç„¶å¦‚æœä½ åšäº†ä¸Šé¢æ“ä½œ,ç„¶åæŠŠå†…å®¹è¾“å…¥åˆ°ä¸€ä¸ªæ–‡ä»¶é‡ŒæŸ¥çœ‹,è‚¯å®šå¤§å‘¼å‘çˆ¹,å› ä¸ºæ ¹æœ¬æ²¡é«˜äº®,å› ä¸ºé»˜è®¤æ˜¯ä¸ä¼šè¾“å‡ºcssçš„ æˆ‘ä»¬è¿˜è¦è·å–cssåŠ å…¥åˆ°htmlä¸­å»:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;css&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;formatter&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_style_defs&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæŠŠcsså†…å®¹å’Œä¸Šé¢çš„htmlä¸€èµ·å†™å…¥åˆ°htmlæ–‡ä»¶å°±å¯ä»¥çœ‹åˆ°é«˜äº®çš„ä»£ç äº†(åƒä¸‡ä¸è¦å‘Šè¯‰æˆ‘ä½ ä¸çŸ¥é“cssåº”è¯¥æ”¾åœ¨ä»€ä¹ˆä½ç½®)&lt;/p&gt;
&lt;p&gt;æ¬¢è¿å¤§å®¶åŠ å…¥åˆ°æˆ‘ä»¬çš„gtalkç¾¤æ¥è®¨è®ºPython/vim/Linux æˆ–è€…è›‹ç–¼çš„æ—¶å€™èŠèŠäººç”Ÿ,æœ‰å¾ˆå¤šå¥½ç©çš„åŠŸèƒ½ç­‰ç€å¤§å®¶.
ä½¿ç”¨gtalkæ·»åŠ :clubot@vim-cn.com&lt;/p&gt;</content><category term="Python"></category><category term="é«˜äº®"></category><category term="ä»£ç "></category><category term="python"></category><category term="pygments"></category></entry><entry><title>Python ä¼˜é›…çš„æ“ä½œå­—å…¸</title><link href="https://www.linuxzen.com/python-you-ya-de-cao-zuo-zi-dian.html" rel="alternate"></link><published>2012-09-17T11:42:00+08:00</published><updated>2012-09-17T11:42:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-09-17:/python-you-ya-de-cao-zuo-zi-dian.html</id><summary type="html">&lt;p&gt;Python ä¸­çš„å­—å…¸æ˜¯Pythonä¸­ä¸€ä¸ªé”®å€¼æ˜ å°„çš„æ•°æ®ç»“æ„,ä¸‹é¢ä»‹ç»ä¸€ä¸‹å¦‚ä½•ä¼˜é›…çš„æ“ä½œå­—å…¸.&lt;/p&gt;
&lt;h2 id="11"&gt;1.1 åˆ›å»ºå­—å…¸&lt;/h2&gt;
&lt;p&gt;Pythonæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥åˆ›å»ºå­—å…¸,ç¬¬ä¸€ç§æ˜¯ä½¿ç”¨èŠ±æ‹¬å·,å¦ä¸€ç§æ˜¯ä½¿ç”¨å†…å»º
å‡½æ•°dict&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info â€¦&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;Python ä¸­çš„å­—å…¸æ˜¯Pythonä¸­ä¸€ä¸ªé”®å€¼æ˜ å°„çš„æ•°æ®ç»“æ„,ä¸‹é¢ä»‹ç»ä¸€ä¸‹å¦‚ä½•ä¼˜é›…çš„æ“ä½œå­—å…¸.&lt;/p&gt;
&lt;h2 id="11"&gt;1.1 åˆ›å»ºå­—å…¸&lt;/h2&gt;
&lt;p&gt;Pythonæœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥åˆ›å»ºå­—å…¸,ç¬¬ä¸€ç§æ˜¯ä½¿ç”¨èŠ±æ‹¬å·,å¦ä¸€ç§æ˜¯ä½¿ç”¨å†…å»º
å‡½æ•°dict&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="12"&gt;1.2 åˆå§‹åŒ–å­—å…¸&lt;/h2&gt;
&lt;p&gt;Pythonå¯ä»¥åœ¨åˆ›å»ºå­—å…¸çš„æ—¶å€™åˆå§‹åŒ–å­—å…¸&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;name&amp;quot;&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;       &lt;span class="c1"&gt;# æ›´ä¼˜é›…&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¾ˆæ˜æ˜¾ç¬¬äºŒç§æ–¹æ³•æ›´åŠ çš„ä¼˜é›…å’Œå‡å°‘ä¸€äº›ç‰¹æ®Šå­—ç¬¦çš„è¾“å…¥,ä½†æ˜¯æœ‰ç§æƒ…å†µç¬¬äºŒç§ä¸èƒ½èƒœä»»&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;  &lt;span class="c1"&gt;# {&amp;#39;name&amp;#39;:&amp;#39;cold&amp;#39;}&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# {&amp;#39;key&amp;#39;: &amp;#39;cold&amp;#39;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ˜æ˜¾ç¬¬äºŒç§æ–¹æ³•å°±ä¼šå¼•å‘ä¸€ä¸ªä¸å®¹æ˜“æ‰¾åˆ°çš„bug&lt;/p&gt;
&lt;p&gt;Pythonå­—å…¸è¿˜æœ‰ä¸€ç§åˆå§‹åŒ–æ–¹å¼,å°±æ˜¯ä½¿ç”¨å­—å…¸çš„fromkeysæ–¹æ³•å¯ä»¥ä»åˆ—è¡¨ä¸­è·å–å…ƒç´ ä½œä¸ºé”®å¹¶ç”¨Noneæˆ–fromkeysæ–¹æ³•çš„ç¬¬äºŒä¸ªå‚æ•°åˆå§‹åŒ–&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fromkeys&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fromkeys&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fromkeys&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="13"&gt;1.3 ä¼˜é›…çš„è·å–é”®å€¼&lt;/h2&gt;
&lt;p&gt;å­—å…¸å¯ä»¥è¿™æ ·è·å–åˆ°é”®çš„å€¼&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä½†æ˜¯å¦‚æœè·å–ä¸å­˜åœ¨çš„é”®çš„å€¼å°±ä¼šè§¦å‘çš„ä¸€ä¸ªKeyErrorå¼‚å¸¸,å­—å…¸æœ‰ä¸€ä¸ªgetæ–¹æ³•,å¯ä»¥ä½¿ç”¨å­—å…¸getæ–¹æ³•æ›´åŠ ä¼˜é›…çš„è·å–å­—å…¸&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;blog&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;www.linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blogname&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="kc"&gt;None&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blogname&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;linuxzen&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="s1"&gt;&amp;#39;linuxzen&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬çœ‹åˆ°ä½¿ç”¨getæ–¹æ³•è·å–ä¸å­˜åœ¨çš„é”®å€¼çš„æ—¶å€™ä¸ä¼šè§¦å‘å¼‚å¸¸,åŒæ—¶getæ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°,å½“ä¸å­˜åœ¨è¯¥é”®çš„æ—¶å€™å°±ä¼šè¿”å›ç¬¬äºŒä¸ªå‚æ•°çš„å€¼
æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä½¿ç”¨getæ›´åŠ çš„ä¼˜é›…&lt;/p&gt;
&lt;h2 id="14"&gt;1.4 æ›´æ–°/æ·»åŠ &lt;/h2&gt;
&lt;p&gt;Python å­—å…¸å¯ä»¥ä½¿ç”¨é”®ä½œä¸ºç´¢å¼•æ¥è®¿é—®/æ›´æ–°/æ·»åŠ å€¼&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;linuxzen.com&amp;#39;&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cold night&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åŒæ—¶Pythonå­—å…¸çš„updateæ–¹æ³•ä¹Ÿå¯ä»¥æ›´æ–°å’Œæ·»åŠ å­—å…¸&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;blog&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cold night&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;blogname&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;linuxzen&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cold night&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;blogname&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;linuxzen&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;blog&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;www.linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# æ›´ä¼˜é›…&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;www.linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;blogname&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;linuxzen&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Pythonå­—å…¸çš„updateæ–¹æ³•å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå­—å…¸æ¥æ›´æ–°å­—å…¸,ä¹Ÿå¯ä»¥ä½¿ç”¨å‚æ•°ä¼ é€’ç±»ä¼¼dictå‡½æ•°ä¸€æ ·çš„æ–¹å¼æ›´æ–°ä¸€ä¸ªå­—å…¸,ä¸Šé¢ä»£ç ä¸­å“¦åŠŸèƒ½çš„ç¬¬äºŒä¸ªæ›´åŠ ä¼˜é›…,ä½†æ˜¯åŒæ ·å’Œdictå‡½æ•°ç±»ä¼¼,é”®æ˜¯å˜é‡æ—¶ä¹Ÿåªå–å­—é¢å€¼&lt;/p&gt;
&lt;h2 id="15"&gt;1.5 å­—å…¸åˆ é™¤&lt;/h2&gt;
&lt;p&gt;å¯ä»¥è°ƒç”¨Pythonå†…ç½®å…³é”®å­—delæ¥åˆ é™¤ä¸€ä¸ªé”®å€¼&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;blog&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;del&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åŒæ—¶ä¹Ÿå¯ä»¥ä½¿ç”¨å­—å…¸çš„popæ–¹æ³•æ¥å–å‡ºä¸€ä¸ªé”®å€¼,å¹¶åˆ é™¤&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;blog&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pop&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="16"&gt;1.6 å…¶ä»–æ“ä½œ&lt;/h2&gt;
&lt;p&gt;è·å–æ‰€æœ‰key&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;blog&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è·å–key,valueå¹¶å¾ªç¯&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;blog&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;value&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;items&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;:&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;  &lt;span class="n"&gt;value&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;blog&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;linuxzen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;
&lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;cold&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Python"></category><category term="æ“ä½œ"></category><category term="å­—å…¸"></category><category term="ä¼˜é›…"></category><category term="python"></category><category term="dict"></category></entry><entry><title>Python å­—å…¸å’Œåˆ—è¡¨é™·é˜±</title><link href="https://www.linuxzen.com/python-zi-dian-he-lie-biao-xian-jing.html" rel="alternate"></link><published>2012-09-17T10:22:00+08:00</published><updated>2012-09-17T10:22:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-09-17:/python-zi-dian-he-lie-biao-xian-jing.html</id><summary type="html">&lt;p&gt;Python ä¸­æœ‰ä¸‰ä¸ªéå¸¸å¥½ç”¨çš„æ•°æ®ç»“æ„,åˆ—è¡¨,å…ƒç»„å’Œå­—å…¸,
å…ƒç»„æ˜¯ä¸å¯å˜çš„,åˆ—è¡¨å¯ä»¥ä¿å­˜ä»»æ„ç±»å‹çš„Pythonå¯¹è±¡,å¹¶å¯ä»¥éšæ„æ‰©å±•æ²¡æœ‰å¤§ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;Python ä¸­æœ‰ä¸‰ä¸ªéå¸¸å¥½ç”¨çš„æ•°æ®ç»“æ„,åˆ—è¡¨,å…ƒç»„å’Œå­—å…¸,
å…ƒç»„æ˜¯ä¸å¯å˜çš„,åˆ—è¡¨å¯ä»¥ä¿å­˜ä»»æ„ç±»å‹çš„Pythonå¯¹è±¡,å¹¶å¯ä»¥éšæ„æ‰©å±•æ²¡æœ‰å¤§å°é™åˆ¶,
å­—å…¸æ˜¯ä¸€ä¸ªkey-valueçš„é”®å€¼æ˜ å°„çš„ç±»å‹,å¯ä»¥å­˜æ”¾ä»»ä½•Pythonå¯¹è±¡,å¯ä»¥åµŒå¥—å­—å…¸,
å€¼å¯ä»¥æ˜¯å­—å…¸å…ƒç»„æˆ–è€…å­—å…¸&lt;/p&gt;
&lt;p&gt;è¿™é‡Œè¯´æ˜¯Python å­—å…¸å’Œåˆ—è¡¨çš„é™·é˜±ä¸å¦‚è¯´æ˜¯Pythonçš„ä¸€äº›ç‰¹æ€§,å¦‚æœä¸äº†è§£è¿™äº›ç‰¹æ€§
å°±ä¼šå¼•å‘ä¸€äº›éš¾ä»¥å¯»æ‰¾çš„bug&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬æ¥ä»‹ç»è¿™äº›ç‰¹æ€§&lt;/p&gt;
&lt;p&gt;Pythonä¸­æ‰€æœ‰å¯¹åˆ—è¡¨å’Œå­—å…¸çš„ä½¿ç”¨ä»…ä»…æ˜¯å¯¹åŸæ¥å¯¹è±¡çš„å¼•ç”¨è€Œä¸æ˜¯åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡
å¦‚ä¸‹é¢ä»£ç :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;blog&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;www.linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# åˆ›å»ºå­—å…¸{&amp;#39;name&amp;#39;:&amp;#39;cold&amp;#39;, &amp;#39;blog&amp;#39;:&amp;#39;www.linuxzen.com&amp;#39;}&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;     &lt;span class="c1"&gt;# èµ‹å€¼ç»™info2&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info2&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cold night&amp;#39;&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info2&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;www.linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cold night&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;www.linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cold night&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;names&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;night&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;linuxzen&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;names2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;names&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;names2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cold night&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;names&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;night&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;linuxzen&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cold night&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;names2&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;night&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;linuxzen&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cold night&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¤§å®¶çœ‹åˆ°å¦‚æœå°†åˆ—è¡¨æˆ–è€…å­—å…¸é‡æ–°èµ‹å€¼ç»™å¦å¤–ä¸€ä¸ªå˜é‡å¹¶æ²¡æœ‰è¾¾åˆ°é¢„æƒ³çš„æ•ˆæœ,
æˆ‘ä»¬æ›´æ”¹ä¸€ä¸ªçš„åŒæ—¶å¦å¤–ä¸€ä¸ªä¹Ÿåœ¨åŒæ—¶æ›´æ”¹,å¦‚æœæˆ‘ä»¬æƒ³ä¿ç•™ä¸€ä¸ªå¿«ç…§,å¾ˆæ˜æ˜¾æˆ‘ä»¬
æ²¡æœ‰è¾¾åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœ,å¦å¤–è¿˜æœ‰ä¸€ç§å¸¸è§çš„ä½¿ç”¨,å› ä¸ºæˆ‘ä»¬çŸ¥é“æ™®é€šå˜é‡ä¼ é€’ç»™
å‡½æ•°,å‡½æ•°åœ¨å†…éƒ¨æ›´æ”¹æ˜¯ä¸ä¼šå½±å“åˆ°å¤–éƒ¨å˜é‡çš„,é‚£ä¹ˆåˆ—è¡¨å’Œå­—å…¸å‘¢?
æˆ‘ä»¬æ¥çœ‹å¦‚ä¸‹ä»£ç ,æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªå‡½æ•°,æ˜¯å­—å…¸å°±æ·»åŠ ä¸€ä¸ªé”®å’Œå€¼,æ˜¯åˆ—è¡¨å°±åœ¨å°¾éƒ¨æ·»åŠ ä¸€ä¸ªå…ƒç´ &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;add_something&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nb"&gt;dict&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;             &lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;msg&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Hello,&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;     &lt;span class="k"&gt;elif&lt;/span&gt; &lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt;             &lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;add to the list&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;...&lt;/span&gt; 
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;www.linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;add_something&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;www.linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;msg&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Hello,cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;names&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;night&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;add_something&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;names&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;names&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;night&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;add to the list&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚ä¸Šä»£ç æ˜æ˜¾ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœ,å¦‚æœè¿™ä¸ªåˆ—è¡¨/å­—å…¸ä»…ä»…ç”¨åœ¨ä¸€ä¸ªåœ°æ–¹å¯èƒ½ä¸ä¼šå‘ç”Ÿä»€ä¹ˆ
å¦‚æœæˆ‘ä»¬å…¶ä»–åœ°æ–¹éœ€è¦åŒæ ·çš„åˆ—è¡¨è¿›è¡Œå¤„ç†,å¦‚æœä½ ä¸çŸ¥é“è¿™ä¸ªç‰¹æ€§å°±ä¼šäº§ç”Ÿå¾ˆéš¾å¯»æ‰¾çš„bug
å½“ä¸Šé¢å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„æˆ‘ä»¬è¯¥å¦‚ä½•é¿å…ä¸Šé¢å‘¢,æˆ‘ä»¬å¯ä»¥å¯¹åˆ—è¡¨/å­—å…¸åšä¸€ä¸ªæ‹·è´,è€Œä¸æ˜¯
ç®€å•çš„å¼•ç”¨&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;names&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;night&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;names2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;names&lt;/span&gt;&lt;span class="p"&gt;[:]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;names2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cold night&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;names&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;night&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;names2&lt;/span&gt;
&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;night&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cold night&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;cold night&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;www.linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;copy&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info2&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;www.linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cold night&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;info2&lt;/span&gt;
&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;www.linuxzen.com&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;name&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;cold&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šé¢ä»£ç åˆ—è¡¨ä½¿ç”¨[:]å¯ä»¥åˆ›å»ºä¸€ä¸ªåˆ—è¡¨çš„å‰¯æœ¬è€Œä¸æ˜¯å¼•ç”¨
å­—å…¸çš„copyæ–¹æ³•åŒæ ·å¯ä»¥åˆ›å»ºä¸€ä¸ªå­—å…¸çš„å‰¯æœ¬è€Œä¸æ˜¯å¼•ç”¨
è¿™æ ·å°±å¯ä»¥é¿å…ä¹‹å‰æ‰€è¯´çš„å¼•ç”¨çš„æƒ…å†µ&lt;/p&gt;</content><category term="Python"></category><category term="é™·é˜±"></category><category term="å¼•ç”¨"></category><category term="å­—å…¸"></category><category term="åˆ—è¡¨"></category><category term="python"></category></entry><entry><title>Linuxæ¡Œé¢é«˜æ•ˆå·¥ä½œ----ä½¿ç”¨Gnome DO</title><link href="https://www.linuxzen.com/linuxzhuo-mian-gao-xiao-gong-zuo-shi-yong-gnome-do.html" rel="alternate"></link><published>2012-09-01T08:03:00+08:00</published><updated>2012-09-01T08:03:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-09-01:/linuxzhuo-mian-gao-xiao-gong-zuo-shi-yong-gnome-do.html</id><summary type="html">&lt;p&gt;ä¸çŸ¥å¤§å®¶æ˜¯å¦å’Œæˆ‘ä¸€æ ·åœ¨winä¸‹ç³»ç»Ÿwin+rè¾“å…¥å‘½ä»¤æ¥å¿«é€Ÿå¯åŠ¨ç¨‹åº,è¿™ä¸¤å¤©åœ¨Linuxä¸‹ç¢°åˆ°ä¸€ä¸ªæ¯”è¿™æ›´çˆ½,æ›´å¿«çš„è½¯ä»¶,&lt;code&gt;Gnome Do&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Gnome Doèƒ½æ ¹æ®ç”¨æˆ·é”®å…¥çš„å†…å®¹è¿›è¡Œè‡ªåŠ¨åŒ¹é…ï¼Œä»è€Œå¿«é€Ÿæ‰“å¼€ç³»ç»Ÿä¸­å·²æœ‰çš„ç¨‹åºã€æ–‡ä»¶ã€ä¹¦ç­¾ç­‰ã€‚ä¸ä»…å¦‚æ­¤ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;ä¸çŸ¥å¤§å®¶æ˜¯å¦å’Œæˆ‘ä¸€æ ·åœ¨winä¸‹ç³»ç»Ÿwin+rè¾“å…¥å‘½ä»¤æ¥å¿«é€Ÿå¯åŠ¨ç¨‹åº,è¿™ä¸¤å¤©åœ¨Linuxä¸‹ç¢°åˆ°ä¸€ä¸ªæ¯”è¿™æ›´çˆ½,æ›´å¿«çš„è½¯ä»¶,&lt;code&gt;Gnome Do&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Gnome Doèƒ½æ ¹æ®ç”¨æˆ·é”®å…¥çš„å†…å®¹è¿›è¡Œè‡ªåŠ¨åŒ¹é…ï¼Œä»è€Œå¿«é€Ÿæ‰“å¼€ç³»ç»Ÿä¸­å·²æœ‰çš„ç¨‹åºã€æ–‡ä»¶ã€ä¹¦ç­¾ç­‰ã€‚ä¸ä»…å¦‚æ­¤ï¼ŒGNOME Do è¿˜åŒ…æ‹¬æ’ä»¶ï¼Œä»è€Œèƒ½å¤Ÿåšæ›´å¤šäº‹,&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ä½ å®‰è£…äº†pidginæ’ä»¶åªéœ€è¾“å…¥è”ç³»äººçš„åå­—å³å¯æ‰“å¼€ä¸ä»–/å¥¹çš„ä¼šè¯,å®‰è£…äº†fileè¿™ä¸ªæ’ä»¶è¾“å…¥æ–‡ä»¶/ç›®å½•çš„åå­—å³å¯æ‰“å¼€ç›®å½•æˆ–æ–‡ä»¶,&lt;/p&gt;
&lt;p&gt;å½“ç„¶è¿˜æœ‰ä¸€ä¸ªä¸è¶³å°±æ˜¯ä¸æ”¯æŒä¸­æ–‡&lt;/p&gt;
&lt;p&gt;ubuntuç”¨æˆ·å¯ä»¥æŒ‰ç…§ä¸‹é¢å®‰è£…:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sudo&lt;span class="w"&gt; &lt;/span&gt;apt-get&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;gnome-do
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¯åŠ¨ä¹‹åGnome doä¸ä¼šåœç•™ä»»åŠ¡æ æˆ–é€šçŸ¥æ åªéœ€æŒ‰&lt;code&gt;Win(ubuntuä¸‹ç§°ä¸ºsuper)+Space&lt;/code&gt;å³å¯å¯åŠ¨,è¾“å…¥ä½ æƒ³å¯åŠ¨çš„åº”ç”¨ç¨‹åºåå­—å³å¯æ‰“å¼€/å…³é—­ç­‰æ“ä½œ.æ˜¯ä¸æ˜¯å¾ˆé…·æé«˜ä¸å°‘çš„å·¥ä½œæ•ˆç‡&lt;/p&gt;</content><category term="Linux"></category><category term="é«˜æ•ˆ"></category><category term="æ¡Œé¢"></category><category term="Linux"></category><category term="gnome do"></category></entry><entry><title>æ¨èä¸¤æ¬¾ä¸é”™çš„ç»ˆç«¯è½¯ä»¶</title><link href="https://www.linuxzen.com/tui-jian-liang-kuan-bu-cuo-de-zhong-duan-ruan-jian.html" rel="alternate"></link><published>2012-08-29T09:36:00+08:00</published><updated>2012-08-29T09:36:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-08-29:/tui-jian-liang-kuan-bu-cuo-de-zhong-duan-ruan-jian.html</id><summary type="html">&lt;p&gt;ä¸€ç›´åœ¨Linuxä¸‹åšå¼€å‘,ä¸€ä¸ªå¥½ç”¨çš„ç»ˆç«¯è½¯ä»¶èƒ½å¸®ä½ èŠ‚çœå¾ˆå¤šæ—¶é—´å’Œç²¾åŠ›&lt;/p&gt;
&lt;p&gt;ä½œä¸ºä¸€ä¸ªç»å¸¸å–œæ¬¢æ•²å‘½ä»¤çš„äºº,å¯èƒ½è¦åŒæ—¶åšå¾ˆå¤šæ“ä½œ,Linuxå„ä¸ªæ¡Œé¢çš„çª—å£åˆ‡æ¢æœ‰å¤šé‚£å•¥,è¿™ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;ä¸€ç›´åœ¨Linuxä¸‹åšå¼€å‘,ä¸€ä¸ªå¥½ç”¨çš„ç»ˆç«¯è½¯ä»¶èƒ½å¸®ä½ èŠ‚çœå¾ˆå¤šæ—¶é—´å’Œç²¾åŠ›&lt;/p&gt;
&lt;p&gt;ä½œä¸ºä¸€ä¸ªç»å¸¸å–œæ¬¢æ•²å‘½ä»¤çš„äºº,å¯èƒ½è¦åŒæ—¶åšå¾ˆå¤šæ“ä½œ,Linuxå„ä¸ªæ¡Œé¢çš„çª—å£åˆ‡æ¢æœ‰å¤šé‚£å•¥,è¿™é‡Œå°±ä¸åæ§½äº†,
æˆ‘æ€»æ˜¯åœ¨æƒ³è¦åšå¦å¤–ä¸€ä¸ªæ“ä½œ,ä½†åˆä¸æƒ³ç»“æŸå½“å‰çš„å·¥ä½œ,ä¹‹å‰æˆ‘ä¹ æƒ¯äºå†æ‰“å¼€ä¸€ä¸ªç»ˆç«¯,ä½†æ˜¯åæ¥ç»ˆç«¯è¶Šæ¥è¶Šå¤šå¯¼è‡´æˆ‘æƒ³æ‰¾å›åŸæ¥çš„å·¥ä½œçš„æ—¶å€™å°±å˜çš„å¾ˆè´¹åŠ›,è€Œä¸”å¯¹æ¡Œé¢æœ‰æ´ç™–çš„äººä¸å…è®¸ä»»åŠ¡æ å¤ªæ‚
åæ¥å‘ç°äº†ä¸€æ¬¾ç»ˆç«¯è½¯ä»¶terminator,å®ƒæ”¯æŒåˆ†å‰²ç»ˆç«¯,å¹¶å¯ä»¥åœ¨ç»ˆç«¯ä¸­å¿«é€Ÿåˆ‡æ¢.è¿˜æœ‰ä¸€æ¬¾ä¸‹æ‹‰å¼çš„ç»ˆç«¯è½¯ä»¶Guakeå¯ä»¥éšæ„å‘¼å‡ºéšè—.ä¸‹é¢å°±ä¸€ä¸€ä»‹ç»ä¸€ä¸‹.&lt;/p&gt;
&lt;h2 id="1-terminator"&gt;1 å®‰è£…Terminator&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sudo&lt;span class="w"&gt; &lt;/span&gt;apt-get&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;terminator
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="2"&gt;2 ä½¿ç”¨&lt;/h2&gt;
&lt;p&gt;æ‰“å¼€TermintoræŒ‰&lt;code&gt;Ctrl-E&lt;/code&gt;(æ³¨æ„æ˜¯å¤§Eè¦æŒ‰ä½Shift)å¯ä»¥å‚ç›´åˆ†å‰²ç»ˆç«¯
&lt;code&gt;Ctrl-O&lt;/code&gt; å¯æ°´å¹³åˆ†å‰²ç»ˆç«¯
æŒ‰ä½Altç„¶åæŒ‰ä¸Šä¸‹å·¦å³å¯ä»¥åœ¨ä¸åŒçš„åˆ†å‰²çª—ä¸­åˆ‡æ¢
&lt;code&gt;Ctrl-D&lt;/code&gt; å¯ä»¥å…³é—­åˆ†å‰²çª—&lt;/p&gt;
&lt;h3 id="21"&gt;2.1 é…ç½®&lt;/h3&gt;
&lt;p&gt;terminatoré…ç½®æ–‡ä»¶åœ¨&lt;code&gt;~/.config/terminator/config&lt;/code&gt;
å¯ä»¥é€šè¿‡è¿™ä¸ªé…ç½®æ–‡ä»¶é…ç½®&lt;code&gt;terminator&lt;/code&gt;çš„å­—ä½“å’Œé¢œè‰²&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;font&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Monaco&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;10&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="p"&gt;#&lt;/span&gt;&lt;span class="err"&gt;è®¾ç½®ä½“å­—&lt;/span&gt;
&lt;span class="n"&gt;background_color&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;#204070&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;èƒŒæ™¯é¢œè‰²&lt;/span&gt;
&lt;span class="n"&gt;foreground_color&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;quot;#F0F0F0&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;å­—ä½“é¢œè‰²&lt;/span&gt;
&lt;span class="n"&gt;cursor_blink&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;True&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="p"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;è®¾ç½®å…‰æ ‡&lt;/span&gt;
&lt;span class="n"&gt;scrollbar_position&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;disabled&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;ç¦ç”¨æ»šåŠ¨æ¡&lt;/span&gt;
&lt;span class="n"&gt;titlebars&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;no&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;ç¦ç”¨æ ‡é¢˜æ &lt;/span&gt;
&lt;span class="n"&gt;background_darkness&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;0.4&lt;/span&gt;
&lt;span class="n"&gt;background_type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;transparent&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;èƒŒæ™¯ç±»å‹å¯ä»¥è®¾ç½®ä¸ºå›¾ç‰‡&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ›´å¤šé…ç½®å¯ä»¥å‚è§é…ç½®æ–‡ä»¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;man&lt;span class="w"&gt; &lt;/span&gt;terminator_config
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="3-guake"&gt;3 Guake&lt;/h2&gt;
&lt;p&gt;&lt;code&gt;Guake&lt;/code&gt;æ˜¯ä¸€ä¸ªä¸‹æ‹‰å¼çš„gnomeæ¡Œé¢ç¯å¢ƒä¸‹çš„ç»ˆç«¯ç¨‹åºï¼Œå› æ­¤ä½ åªéœ€è¦æŒ‰ä¸€ä¸ªé”®F12å°±å¯ä»¥è°ƒç”¨ä»–ï¼Œç„¶åå†æŒ‰ä¸€æ¬¡ä»¥ä¾¿éšè—ä»–ã€‚Guakeæ”¯æŒ&lt;code&gt;å¿«æ·é”®&lt;/code&gt;ã€&lt;code&gt;æ ‡ç­¾&lt;/code&gt;ã€&lt;code&gt;èƒŒæ™¯é€æ˜&lt;/code&gt;ç­‰ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;h3 id="31-guake"&gt;3.1 å®‰è£… Guake&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sudo apt-get install guake
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="32-guake"&gt;3.2 ä½¿ç”¨Guake&lt;/h3&gt;
&lt;p&gt;å¯ç”¨guakeåå³å¯æŒ‰&lt;code&gt;F12&lt;/code&gt;è°ƒå‡ºæ¥,å¾ˆé…·
å¿«æ·é”®å’Œgnome terminalç›¸åŒ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Ctrl-T æ–°å»ºæ ‡ç­¾
F2 é‡å‘½åæ ‡ç­¾
Ctrl-PageUp ä¸Šä¸€ä¸ªæ ‡ç­¾
Ctrl-PageDwon ä¸‹ä¸€ä¸ªæ ‡ç­¾
F11 å…¨å±
F12 éšè—/æ˜¾ç¤º
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Linux"></category><category term="ç»ˆç«¯"></category><category term="åˆ†å‰²"></category><category term="terminator"></category><category term="Linux"></category><category term="guake"></category></entry><entry><title>ç”¨bottle+mongodbå†™çš„blogç¨‹åºæ”¯æŒmysqlå•¦</title><link href="https://www.linuxzen.com/yong-bottlemongodbxie-de-blogcheng-xu-zhi-chi-mysqlla.html" rel="alternate"></link><published>2012-08-14T09:16:00+08:00</published><updated>2012-08-14T09:16:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-08-14:/yong-bottlemongodbxie-de-blogcheng-xu-zhi-chi-mysqlla.html</id><summary type="html">&lt;p&gt;å‰é¢åšæ–‡æåˆ°è¿‡,æœ¬äººç”¨bottle+mongodbå®ç°äº†ä»¥blogç¨‹åº,&lt;/p&gt;
&lt;p&gt;æœ€è¿‘æœ‰äº›ç©ºé—²æ—¶é—´,å°±é‡æ–°ç”¨mvcçš„æ¨¡å¼é‡å†™äº†ä¸€ä¸‹,å› ä¸ºmongodbå¤ªè¿‡è€—è´¹å†…å­˜,å¯¹ä¸€äº›å°å‹çš„vpså¤ªè¿‡åƒåŠ›æ‰€ä»¥åŠ å…¥äº†mysqlçš„æ”¯æŒ,&lt;/p&gt;
&lt;p&gt;è™½ç„¶è¾ƒä¸Šæ¬¡æœ‰äº›å®Œå–„,ä½†æ˜¯è¿˜æ˜¯æœ‰å¾ˆ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;å‰é¢åšæ–‡æåˆ°è¿‡,æœ¬äººç”¨bottle+mongodbå®ç°äº†ä»¥blogç¨‹åº,&lt;/p&gt;
&lt;p&gt;æœ€è¿‘æœ‰äº›ç©ºé—²æ—¶é—´,å°±é‡æ–°ç”¨mvcçš„æ¨¡å¼é‡å†™äº†ä¸€ä¸‹,å› ä¸ºmongodbå¤ªè¿‡è€—è´¹å†…å­˜,å¯¹ä¸€äº›å°å‹çš„vpså¤ªè¿‡åƒåŠ›æ‰€ä»¥åŠ å…¥äº†mysqlçš„æ”¯æŒ,&lt;/p&gt;
&lt;p&gt;è™½ç„¶è¾ƒä¸Šæ¬¡æœ‰äº›å®Œå–„,ä½†æ˜¯è¿˜æ˜¯æœ‰å¾ˆå¤šä¸è¶³ä»£ç æ”¾åœ¨äº†googlecodeä¸Š,ç”±äºæœ€è¿‘ä¸€ç›´åœ¨ä½¿ç”¨git,ç´¢æ€§ä¹Ÿå°±æ–°å»ºäº†ä¸€ä¸ªgitçš„é¡¹ç›®,ä¹‹å‰svnçš„é¡¹ç›®ä¹Ÿä¼šæ›´æ–°.&lt;/p&gt;
&lt;p&gt;æ‰€ä»¥å¤§å®¶æƒ³æµè§ˆä»£ç å¯ä»¥åˆ°ä¸‹é¢ä¸¤ä¸ªåœ°æ–¹å»,æœ‰ä»€ä¹ˆä¸è¶³å’Œå»ºè®®è¿˜è¯·æŒ‡æ•™,å¦‚æœä½ ä¹Ÿæƒ³åŠ å…¥è¿›æ¥,å¯ä»¥ç•™è¨€æˆ–å‘emailç»™æˆ‘:&lt;/p&gt;
&lt;p&gt;git:&lt;a href="http://code.google.com/p/linuxzen/source/browse/water"&gt;http://code.google.com/p/linuxzen/source/browse/water&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;svn:http://code.google.com/p/sharepythoncode/source/browse/water/&lt;/p&gt;</content><category term="Python"></category><category term="æ”¯æŒmysql"></category><category term="web"></category><category term="python"></category><category term="MySQL"></category><category term="mongodb"></category><category term="bottle"></category><category term="blog"></category></entry><entry><title>pythoné‡Œçš„ä¸‰ç›®è¿ç®—</title><link href="https://www.linuxzen.com/pythonli-de-san-mu-yun-suan.html" rel="alternate"></link><published>2012-08-10T16:28:00+08:00</published><updated>2012-08-10T16:28:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-08-10:/pythonli-de-san-mu-yun-suan.html</id><summary type="html">&lt;p&gt;ä¸‹é¢è¯´çš„å’Œä¸‰ç›®è¿ç®—æœ‰ç‚¹ç›¸ä¼¼,ä½†åˆä¸ä¸€æ ·,å®åœ¨ä¸çŸ¥é“è¯¥å¦‚ä½•æ‹Ÿå®šæ ‡é¢˜,å…ˆå°±æ˜¯è¿™ä¸ªæ ‡é¢˜å§,å¤§å®¶éƒ½çŸ¥é“pythonä¸­æ²¡æœ‰ä¸‰ç›®è¿ç®—,ä½†æ˜¯&lt;code&gt;and&lt;/code&gt;/&lt;code&gt;or&lt;/code&gt;æœ‰ç‚¹ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;ä¸‹é¢è¯´çš„å’Œä¸‰ç›®è¿ç®—æœ‰ç‚¹ç›¸ä¼¼,ä½†åˆä¸ä¸€æ ·,å®åœ¨ä¸çŸ¥é“è¯¥å¦‚ä½•æ‹Ÿå®šæ ‡é¢˜,å…ˆå°±æ˜¯è¿™ä¸ªæ ‡é¢˜å§,å¤§å®¶éƒ½çŸ¥é“pythonä¸­æ²¡æœ‰ä¸‰ç›®è¿ç®—,ä½†æ˜¯&lt;code&gt;and&lt;/code&gt;/&lt;code&gt;or&lt;/code&gt;æœ‰ç‚¹ç±»ä¼¼ä¸‰ç›®è¿ç®—:&lt;/p&gt;
&lt;h2 id="andor"&gt;and/or&lt;/h2&gt;
&lt;p&gt;å•ç‹¬ä½¿ç”¨è¡¨ç¤ºé€»è¾‘å…³ç³»ä¸å’Œæˆ–,ä¹Ÿå¯ä»¥ç»„å’Œä½¿ç”¨,ç”¨æ³•å¦‚ä¸‹&lt;/p&gt;
&lt;h3 id="and"&gt;and&lt;/h3&gt;
&lt;p&gt;andå‰åå¦‚æœæŸä¸€ä¸ªå€¼ä¸ºå‡(False, '', [], {}, Noneâ€¦)åˆ™è¿”å›ç¬¬ä¸€ä¸ªå‡å€¼
å¦‚æœæ‰€æœ‰å€¼éƒ½ä¸ºçœŸåˆ™è¿”å›æœ€åä¸€ä¸ªçœŸå€¼&lt;/p&gt;
&lt;h3 id="or"&gt;or&lt;/h3&gt;
&lt;p&gt;å¦‚æœorä»»æ„ä¸€ä¸ªå€¼ä¸ºçœŸ,åˆ™ç«‹åˆ»è¿”å›è¿™ä¸ªå€¼
å¦‚æœæ‰€æœ‰å€¼éƒ½ä¸ºå‡,åˆ™orè¿”å›æœ€åä¸€ä¸ªå‡å€¼&lt;/p&gt;
&lt;h3 id="_1"&gt;ä¾‹å­&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;test&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt; &lt;span class="c1"&gt;# result = True&lt;/span&gt;
&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;test&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ortest&amp;#39;&lt;/span&gt; &lt;span class="c1"&gt;# result = ortest&lt;/span&gt;
&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ortest&amp;#39;&lt;/span&gt; &lt;span class="c1"&gt;# result = False&lt;/span&gt;
&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;  &lt;span class="c1"&gt;# result = &amp;#39;&amp;#39;&lt;/span&gt;

&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Hall&amp;quot;&lt;/span&gt; &lt;span class="c1"&gt;# result = Hall&lt;/span&gt;
&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt; &lt;span class="c1"&gt;# result = None&lt;/span&gt;
&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;test&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;nottest&amp;#39;&lt;/span&gt; &lt;span class="c1"&gt;# result = test&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="if-else"&gt;ä½¿ç”¨å•è¡Œif else æ¨¡æ‹Ÿä¸‰ç›®è¿ç®—&lt;/h2&gt;
&lt;p&gt;result if True / False else fresult
ifä¸ºçœŸæ—¶å€™ç»“æœä¸ºresult,ä¸ºå‡çš„æ—¶å€™ç»“æœä¸ºfresult&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;test&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;not test&amp;#39;&lt;/span&gt; &lt;span class="c1"&gt;# result = &amp;#39;test&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;test&amp;#39;&lt;/span&gt; &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt; &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;not test&amp;#39;&lt;/span&gt; &lt;span class="c1"&gt;# result = &amp;#39;not test&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Python"></category><category term="å•è¡Œ"></category><category term="ä¸‰ç›®"></category><category term="python"></category><category term="or"></category><category term="if"></category><category term="else"></category><category term="and"></category></entry><entry><title>Python æ–­ç‚¹è°ƒè¯•</title><link href="https://www.linuxzen.com/python-duan-dian-diao-shi.html" rel="alternate"></link><published>2012-08-10T16:16:00+08:00</published><updated>2012-08-10T16:16:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-08-10:/python-duan-dian-diao-shi.html</id><summary type="html">&lt;h2 id="pdb"&gt;pdbæ¨¡å—&lt;/h2&gt;
&lt;p&gt;pdbæ˜¯ä¸€ä¸ªPython å†…ç½®çš„è°ƒå¼æ¨¡å—è¿™é‡Œç”¨æ¥ä»‹ç»ç”¨å®ƒè¿›è¡Œæ–­ç‚¹è°ƒè¯•&lt;/p&gt;
&lt;h3 id="_1"&gt;æ’å…¥æ–­ç‚¹&lt;/h3&gt;
&lt;p&gt;åœ¨éœ€è¦æ’å…¥æ–­ç‚¹çš„åœ°æ–¹æ’å…¥å¦‚ä¸‹ä»£ç å¯ä»¥æ’å…¥ä¸€ä¸ªæ–­ â€¦&lt;/p&gt;</summary><content type="html">&lt;h2 id="pdb"&gt;pdbæ¨¡å—&lt;/h2&gt;
&lt;p&gt;pdbæ˜¯ä¸€ä¸ªPython å†…ç½®çš„è°ƒå¼æ¨¡å—è¿™é‡Œç”¨æ¥ä»‹ç»ç”¨å®ƒè¿›è¡Œæ–­ç‚¹è°ƒè¯•&lt;/p&gt;
&lt;h3 id="_1"&gt;æ’å…¥æ–­ç‚¹&lt;/h3&gt;
&lt;p&gt;åœ¨éœ€è¦æ’å…¥æ–­ç‚¹çš„åœ°æ–¹æ’å…¥å¦‚ä¸‹ä»£ç å¯ä»¥æ’å…¥ä¸€ä¸ªæ–­ç‚¹
import pdb; pdb.set_trace()
å½“Pythonæ‰§è¡Œåˆ°è¿™æ¡è¯­å¥æ—¶åœ¨è¿è¡Œshellé‡Œå°±ä¼šä¸­æ–­æ‰§è¡Œå‡ºç°ä¸€ä¸ªç±»ä¼¼ä¸‹é¢çš„shellçª—å£&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;è¿™é‡Œä¼šå‡ºç°å½“å‰è¿è¡Œç¨‹åºçš„ä¿¡æ¯&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="err"&gt;æºæ–‡ä»¶å’Œå½“å‰å‡½æ•°&lt;/span&gt;
&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;è¿™é‡Œæ˜¯å°†è¦è¿è¡Œçš„è¯­å¥&lt;/span&gt;
&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Pdb&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="pdb_1"&gt;pdbæŒ‡ä»¤&lt;/h3&gt;
&lt;p&gt;è¿›å…¥(Pdb)åæœ‰å¾ˆå¤šå‘½ä»¤å¯ä»¥ä½¿ç”¨,å¯ä»¥ä½¿ç”¨ &lt;code&gt;h&lt;/code&gt; æŸ¥çœ‹å¸®åŠ©&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;l æŸ¥çœ‹ä»£ç ä¸Šä¸‹æ–‡&lt;/li&gt;
&lt;li&gt;p var ç›‘è§†å˜é‡var&lt;/li&gt;
&lt;li&gt;n å•æ­¥æ‰§è¡Œ&lt;/li&gt;
&lt;li&gt;b line  åœ¨lineè¡Œæ’å…¥æ–­ç‚¹&lt;/li&gt;
&lt;li&gt;c ç»§ç»­åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹,æ²¡æœ‰åˆ™æ‰§è¡Œç¨‹åº&lt;/li&gt;
&lt;li&gt;r æ‰§è¡Œåˆ°å‡½æ•°è¿”å›å‰&lt;/li&gt;
&lt;/ul&gt;</content><category term="Python"></category><category term="è°ƒè¯•"></category><category term="æ–­ç‚¹"></category><category term="python"></category><category term="pdb"></category><category term="debug"></category></entry><entry><title>sshè¯ä¹¦ç™»å½•é”™è¯¯</title><link href="https://www.linuxzen.com/sshzheng-shu-deng-lu-cuo-wu.html" rel="alternate"></link><published>2012-08-10T16:11:00+08:00</published><updated>2012-08-10T16:11:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-08-10:/sshzheng-shu-deng-lu-cuo-wu.html</id><summary type="html">&lt;h2&gt;é”™è¯¯æè¿°&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨è¯ä¹¦sshé“¾æ¥çš„æ—¶å€™æç¤ºä¸‹é¢é”™è¯¯ä¿¡æ¯&lt;/p&gt;
&lt;h2&gt;&lt;code&gt;Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).&lt;/code&gt;
å¯èƒ½åŸå› &lt;/h2&gt;
&lt;p&gt;authorizedkeys æˆ–.sshçš„æƒé™å¤ªopen .ssh ç›®å½•æ”¹æˆ755 æƒé™ authorizedkeys æ”¹æˆ600&lt;/p&gt;
&lt;h2&gt;è§£å†³&lt;/h2&gt;
&lt;p&gt;æŸ¥çœ‹æ—¥å¿—:
&lt;code&gt;cat /var/log/secure&lt;/code&gt;
å‘ç°
&lt;code&gt;Aug 8 17:15 â€¦&lt;/code&gt;&lt;/p&gt;</summary><content type="html">&lt;h2&gt;é”™è¯¯æè¿°&lt;/h2&gt;
&lt;p&gt;ä½¿ç”¨è¯ä¹¦sshé“¾æ¥çš„æ—¶å€™æç¤ºä¸‹é¢é”™è¯¯ä¿¡æ¯&lt;/p&gt;
&lt;h2&gt;&lt;code&gt;Permission denied (publickey,gssapi-keyex,gssapi-with-mic,password).&lt;/code&gt;
å¯èƒ½åŸå› &lt;/h2&gt;
&lt;p&gt;authorizedkeys æˆ–.sshçš„æƒé™å¤ªopen .ssh ç›®å½•æ”¹æˆ755 æƒé™ authorizedkeys æ”¹æˆ600&lt;/p&gt;
&lt;h2&gt;è§£å†³&lt;/h2&gt;
&lt;p&gt;æŸ¥çœ‹æ—¥å¿—:
&lt;code&gt;cat /var/log/secure&lt;/code&gt;
å‘ç°
&lt;code&gt;Aug 8 17:15:13 CentOS62 sshd[5624]: Authentication refused: bad ownership or modes for file /home/abc/.ssh/authorized_keys&lt;/code&gt;
æŸ¥çœ‹.sshæƒé™ä¸º775
.ssh æ‰‹åŠ¨åˆ›å»ºçš„æ—¶å€™æ˜¯775æƒé™,æ”¹æˆ755æƒé™åæ­£å¸¸
&lt;code&gt;# chmod 755 ~/.ssh&lt;/code&gt;&lt;/p&gt;</content><category term="Linux"></category><category term="è¯ä¹¦"></category><category term="æƒé™"></category><category term="ssh"></category><category term="authorized_keys"></category></entry><entry><title>lambda ç»“åˆmap/filter/reduce/sortedç­‰å‡½æ•°å¯¹åˆ—è¡¨è¿›è¡Œé«˜æ•ˆæ“ä½œ</title><link href="https://www.linuxzen.com/lambda-jie-he-mapfilterreducesorteddeng-han-shu-dui-lie-biao-jin-xing-gao-xiao-cao-zuo.html" rel="alternate"></link><published>2012-08-10T16:02:00+08:00</published><updated>2012-08-10T16:02:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-08-10:/lambda-jie-he-mapfilterreducesorteddeng-han-shu-dui-lie-biao-jin-xing-gao-xiao-cao-zuo.html</id><summary type="html">&lt;p&gt;lambda ç»“åˆmap/filter/reduce/sortedç­‰å‡½æ•°å¯¹åˆ—è¡¨è¿›è¡Œé«˜æ•ˆæ“ä½œ&lt;/p&gt;
&lt;h2 id="_1"&gt;ä»‹ç»&lt;/h2&gt;
&lt;h3 id="lambda"&gt;lambda&lt;/h3&gt;
&lt;p&gt;Pythonç”¨äºæ”¯æŒå°†å‡½æ•°èµ‹å€¼ç»™å˜é‡çš„ä¸€ä¸ªæ“ä½œç¬¦
é»˜è®¤æ˜¯è¿”å›çš„,æ‰€ä»¥ä¸ç”¨å†åŠ returnå…³é”®å­—,ä¸ç„¶ä¼šæŠ¥é”™&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;  &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;
&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# return 4&lt;/span&gt;
&lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nb"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;reduce&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;éœ€è¦ä¸¤ä¸ªå‚æ•°,ç¬¬ä¸€ä¸ª â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;lambda ç»“åˆmap/filter/reduce/sortedç­‰å‡½æ•°å¯¹åˆ—è¡¨è¿›è¡Œé«˜æ•ˆæ“ä½œ&lt;/p&gt;
&lt;h2 id="_1"&gt;ä»‹ç»&lt;/h2&gt;
&lt;h3 id="lambda"&gt;lambda&lt;/h3&gt;
&lt;p&gt;Pythonç”¨äºæ”¯æŒå°†å‡½æ•°èµ‹å€¼ç»™å˜é‡çš„ä¸€ä¸ªæ“ä½œç¬¦
é»˜è®¤æ˜¯è¿”å›çš„,æ‰€ä»¥ä¸ç”¨å†åŠ returnå…³é”®å­—,ä¸ç„¶ä¼šæŠ¥é”™&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;  &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;
&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# return 4&lt;/span&gt;
&lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nb"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;reduce&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;éœ€è¦ä¸¤ä¸ªå‚æ•°,ç¬¬ä¸€ä¸ªæ˜¯ä¸€ä¸ªå¤„ç†å‡½æ•°,ç¬¬äºŒä¸ªæ˜¯ä¸€ä¸ªåºåˆ—(list,tuple,dict)&lt;/p&gt;
&lt;h3 id="map"&gt;map()&lt;/h3&gt;
&lt;p&gt;å°†åºåˆ—ä¸­çš„å…ƒç´ é€šè¿‡å¤„ç†å‡½æ•°å¤„ç†åè¿”å›ä¸€ä¸ªæ–°çš„åˆ—è¡¨&lt;/p&gt;
&lt;h3 id="filter"&gt;filter()&lt;/h3&gt;
&lt;p&gt;å°†åºåˆ—ä¸­çš„å…ƒç´ é€šè¿‡å‡½æ•°è¿‡æ»¤åè¿”å›ä¸€ä¸ªæ–°çš„åˆ—è¡¨&lt;/p&gt;
&lt;h3 id="reduce"&gt;reduce()&lt;/h3&gt;
&lt;p&gt;å°†åºåˆ—ä¸­çš„å…ƒç´ é€šè¿‡ä¸€ä¸ªäºŒå…ƒå‡½æ•°å¤„ç†è¿”å›ä¸€ä¸ªç»“æœ&lt;/p&gt;
&lt;h2 id="lambda_1"&gt;å°†ä¸Šé¢ä¸‰ä¸ªå‡½æ•°å’Œlambdaç»“åˆä½¿ç”¨&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;li&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="c1"&gt;# åºåˆ—ä¸­çš„æ¯ä¸ªå…ƒç´ åŠ 1&lt;/span&gt;
&lt;span class="nb"&gt;map&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;li&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# [2,3,4,5,6]&lt;/span&gt;

&lt;span class="c1"&gt;# è¿”å›åºåˆ—ä¸­çš„å¶æ•°&lt;/span&gt;
&lt;span class="nb"&gt;filter&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;li&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# [2, 4]&lt;/span&gt;

&lt;span class="c1"&gt;# è¿”å›æ‰€æœ‰å…ƒç´ ç›¸ä¹˜çš„ç»“æœ&lt;/span&gt;
&lt;span class="n"&gt;reduce&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;x&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt; &lt;span class="n"&gt;y&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;li&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# 1*2*3*4*5 = 120&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="sorted-lambda"&gt;sorted() ç»“åˆlambdaå¯¹åˆ—è¡¨è¿›è¡Œæ’åº&lt;/h2&gt;
&lt;p&gt;sorted ç”¨äºåˆ—è¡¨çš„æ’åº,æ¯”åˆ—è¡¨è‡ªå¸¦çš„æ›´åŠ æ™ºèƒ½
æœ‰ä¸¤ä¸ªåˆ—è¡¨,æ¯ä¸ªåˆ—è¡¨ä¸­éƒ½æœ‰ä¸€ä¸ªå­—å…¸([{},{}])è¦æ±‚å°†ä¸¤ä¸ªè¿™æ ·çš„åˆ—è¡¨åˆå¹¶åæŒ‰ç…§æ—¶é—´æ’åº,
ä¸¤ä¸ªåˆ—è¡¨ä¸­çš„æ—¶é—´ä¸ºäº†èƒ½å¤Ÿé€šè¿‡jsonè¾“å‡ºå·²ç»ç”±æ—¶é—´æ ¼å¼è½¬å˜ä¸ºå­—ç¬¦ä¸²æ ¼å¼.å­—æ®µåä¸º sort_time
ç°åœ¨å°†ä»–ä»¬æŒ‰ç…§å€’åºæ’åˆ—&lt;/p&gt;
&lt;h3 id="sorted"&gt;sorted çš„ç”¨æ³•&lt;/h3&gt;
&lt;p&gt;sorted(iterable, cmp=None, key=None, reverse=False) --&amp;gt; new sorted list
* terableï¼šæ˜¯å¯è¿­ä»£ç±»å‹;
* cmpï¼šç”¨äºæ¯”è¾ƒçš„å‡½æ•°ï¼Œæ¯”è¾ƒä»€ä¹ˆç”±keyå†³å®š,æœ‰é»˜è®¤å€¼ï¼Œè¿­ä»£é›†åˆä¸­çš„ä¸€é¡¹;
* keyï¼šç”¨åˆ—è¡¨å…ƒç´ çš„æŸä¸ªå±æ€§å’Œå‡½æ•°è¿›è¡Œä½œä¸ºå…³é”®å­—ï¼Œæœ‰é»˜è®¤å€¼ï¼Œè¿­ä»£é›†åˆä¸­çš„ä¸€é¡¹;
* reverseï¼šæ’åºè§„åˆ™. reverse = True æˆ–è€… reverse = Falseï¼Œæœ‰é»˜è®¤å€¼ã€‚
* è¿”å›å€¼ï¼šæ˜¯ä¸€ä¸ªç»è¿‡æ’åºçš„å¯è¿­ä»£ç±»å‹ï¼Œä¸iterableä¸€æ ·ã€‚&lt;/p&gt;
&lt;h3 id="sortedlambdasort_time"&gt;sorted()ç»“åˆlambdaå¯¹å¯è¿­ä»£ç±»å‹ç”¨sort_timeæ’åº&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;sorted&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;sort_time&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;reverse&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Python"></category><category term="æ’åº"></category><category term="åˆ—è¡¨"></category><category term="sorted"></category><category term="reduce"></category><category term="python"></category><category term="map"></category><category term="list"></category><category term="lambda"></category><category term="filter"></category></entry><entry><title>Python å¸¸ç”¨çš„åˆ—è¡¨æ“ä½œ</title><link href="https://www.linuxzen.com/python-chang-yong-de-lie-biao-cao-zuo.html" rel="alternate"></link><published>2012-08-10T15:48:00+08:00</published><updated>2012-08-10T15:48:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-08-10:/python-chang-yong-de-lie-biao-cao-zuo.html</id><summary type="html">&lt;p&gt;è¿™é‡Œä»‹ç»å‡ ä¸ªå¸¸ç”¨çš„åˆ—è¡¨æ“ä½œ&lt;/p&gt;
&lt;h3 id="_1"&gt;æ·»åŠ å…ƒç´ &lt;/h3&gt;
&lt;p&gt;æ·»åŠ å…ƒç´ ä½¿ç”¨åˆ—è¡¨çš„å†…ç½®æ–¹æ³•append&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;number&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# number = [1, 2, 3, 4, 5]&lt;/span&gt;
&lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="c1"&gt;# number â€¦&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;è¿™é‡Œä»‹ç»å‡ ä¸ªå¸¸ç”¨çš„åˆ—è¡¨æ“ä½œ&lt;/p&gt;
&lt;h3 id="_1"&gt;æ·»åŠ å…ƒç´ &lt;/h3&gt;
&lt;p&gt;æ·»åŠ å…ƒç´ ä½¿ç”¨åˆ—è¡¨çš„å†…ç½®æ–¹æ³•append&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;number&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# number = [1, 2, 3, 4, 5]&lt;/span&gt;
&lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt; &lt;span class="c1"&gt;# number = [1, 2, 3, 4, 5, [6, 7]]&lt;/span&gt;
&lt;span class="n"&gt;number&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;b&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt; &lt;span class="c1"&gt;# number = [1, 2, 3, 4, [6, 7], {&amp;#39;a&amp;#39;, :&amp;#39;b&amp;#39;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¯ä»¥çœ‹åˆ°å¼ºå¤§çš„pythonåˆ—è¡¨å¯ä»¥åµŒå¥—ä»»æ„ç±»å‹&lt;/p&gt;
&lt;h3 id="_2"&gt;åˆ—è¡¨ç›¸åŠ &lt;/h3&gt;
&lt;p&gt;è¦æƒ³è¿æ¥ä¸¤ä¸ªåˆ—è¡¨,å¯ä»¥ä½¿ç”¨+å·è¿æ¥&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="c1"&gt;# c = [1, 2, 3, 4, 5, 6]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¹Ÿå¯ä»¥ä½¿ç”¨åˆ—è¡¨å†…ç½®æ–¹æ³•extendè¿æ¥ä¸¤ä¸ªåˆ—è¡¨&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;4&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;extend&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;b&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="c1"&gt;# a = [1, 2, 3, 4, 5, 6]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç”¨+å·ä¼šåˆ›å»ºä¸€ä¸ªæ–°é€šå¯¹è±¡,ä½¿ç”¨extendåˆ™åœ¨åŸæ¥çš„å¯¹è±¡ä¸Šé¢ä¿®æ”¹&lt;/p&gt;
&lt;h3 id="_3"&gt;åˆ—è¡¨å»é‡å¤&lt;/h3&gt;
&lt;p&gt;åˆ—è¡¨æœ¬èº«æ²¡æœ‰å»é™¤é‡å¤çš„åŠŸèƒ½,ä½†æ˜¯å¯ä»¥å€ŸåŠ©pythonçš„å¦å¤–ä¸€ä¸ªç±»å‹set(help(set)æŸ¥çœ‹)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;list&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt; &lt;span class="c1"&gt;# b = [1, 2, 3]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¹Ÿå¯ä»¥å€ŸåŠ©å­—å…¸ç±»å‹çš„å†…ç½®æ–¹æ³•&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;b&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{}&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fromkeys&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="c1"&gt;# b = [1, 2, 3]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Python"></category><category term="é‡å¤"></category><category term="ç›¸åŠ "></category><category term="æ·»åŠ "></category><category term="åˆ—è¡¨"></category><category term="python"></category></entry><entry><title>Pythonè¶…ç®€å•æˆªå–ä¸­æ–‡å­—ç¬¦ä¸²</title><link href="https://www.linuxzen.com/pythonchao-jian-dan-jie-qu-zhong-wen-zi-fu-chuan.html" rel="alternate"></link><published>2012-07-11T17:55:00+08:00</published><updated>2012-07-11T17:55:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-07-11:/pythonchao-jian-dan-jie-qu-zhong-wen-zi-fu-chuan.html</id><summary type="html">&lt;p&gt;webåº”ç”¨éš¾å…ä¼šæˆªå–å­—ç¬¦ä¸²çš„éœ€æ±‚,Pythonä¸­æˆªå–è‹±æ–‡å¾ˆå®¹æ˜“:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;abce&amp;#39;&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="s1"&gt;&amp;#39;abc&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä½†æ˜¯æˆªå–utf-8çš„ä¸­æ–‡æœºä¼šæˆªå–ä¸€åŠå¯¼è‡´ä¸€äº›ä¸æ˜¯ä¹±ç çš„ä¹±ç .å…¶å®utf8æˆªå–å¾ˆç®€å•,è¿™é‡Œè®°ä¸‹æ¥ä½œä¸ºå¤‡å¿˜&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;#-*- coding:utf8 -*-&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ä¸­æ–‡æˆªå–&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;decode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;encode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# ç»“æœu&amp;#39;ä¸­æ–‡æˆªå–&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å°±è¿™ä¹ˆ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;webåº”ç”¨éš¾å…ä¼šæˆªå–å­—ç¬¦ä¸²çš„éœ€æ±‚,Pythonä¸­æˆªå–è‹±æ–‡å¾ˆå®¹æ˜“:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;abce&amp;#39;&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="s1"&gt;&amp;#39;abc&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä½†æ˜¯æˆªå–utf-8çš„ä¸­æ–‡æœºä¼šæˆªå–ä¸€åŠå¯¼è‡´ä¸€äº›ä¸æ˜¯ä¹±ç çš„ä¹±ç .å…¶å®utf8æˆªå–å¾ˆç®€å•,è¿™é‡Œè®°ä¸‹æ¥ä½œä¸ºå¤‡å¿˜&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;#-*- coding:utf8 -*-&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ä¸­æ–‡æˆªå–&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;decode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;encode&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;utf8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# ç»“æœu&amp;#39;ä¸­æ–‡æˆªå–&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å°±è¿™ä¹ˆç®€å•&lt;/p&gt;</content><category term="Python"></category><category term="æˆªå–"></category><category term="å­—ç¬¦ä¸²"></category><category term="utf8"></category><category term="python"></category></entry><entry><title>mongoengineä½¿ç”¨ç¬”è®°</title><link href="https://www.linuxzen.com/mongoengineshi-yong-bi-ji.html" rel="alternate"></link><published>2012-06-23T10:02:00+08:00</published><updated>2012-06-23T10:02:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-06-23:/mongoengineshi-yong-bi-ji.html</id><summary type="html">&lt;p&gt;æœ€è¿‘é‡æ–°æ‹¾èµ·Django,ä½†æ˜¯Djangoå¹¶ä¸æ”¯æŒmongodb,ä½†æ˜¯æœ‰ä¸€ä¸ªæ¨¡å—mongoengineå¯ä»¥å®ç°Django Modelç±»ä¼¼çš„å°è£….ä½†æ˜¯mongoengineçš„ä¸­æ–‡æ–‡æ¡£å‡ ä¹æ²¡æœ‰,æœ‰çš„ä¹Ÿæ˜¯ç®€çŸ­çš„å‡ å¥ä»‹ç»å’Œä½¿ç”¨.ä¸‹é¢æˆ‘å°±åˆ†äº«ä¸€ä¸‹æˆ‘åœ¨ä½¿ç”¨è¿‡ç¨‹ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;æœ€è¿‘é‡æ–°æ‹¾èµ·Django,ä½†æ˜¯Djangoå¹¶ä¸æ”¯æŒmongodb,ä½†æ˜¯æœ‰ä¸€ä¸ªæ¨¡å—mongoengineå¯ä»¥å®ç°Django Modelç±»ä¼¼çš„å°è£….ä½†æ˜¯mongoengineçš„ä¸­æ–‡æ–‡æ¡£å‡ ä¹æ²¡æœ‰,æœ‰çš„ä¹Ÿæ˜¯ç®€çŸ­çš„å‡ å¥ä»‹ç»å’Œä½¿ç”¨.ä¸‹é¢æˆ‘å°±åˆ†äº«ä¸€ä¸‹æˆ‘åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­æ‰€è®°å½•ä¸‹çš„ä¸€äº›ç¬”è®°,å¯èƒ½æœ‰ç‚¹ä¹±.å¤§å®¶å¯ä»¥å‚è€ƒä¸€ä¸‹.&lt;/p&gt;
&lt;h2 id="mongoengine"&gt;å®‰è£…mongoengine&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;easy_install&lt;/span&gt; &lt;span class="n"&gt;pymongo&lt;/span&gt; &lt;span class="c1"&gt;# ä¾èµ–åº“&lt;/span&gt;
&lt;span class="n"&gt;easy_install&lt;/span&gt; &lt;span class="n"&gt;mongoengine&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="_1"&gt;åŸºæœ¬ä½¿ç”¨&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;mongoengine&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;datetime&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;
&lt;span class="c1"&gt;# è¿æ¥æ•°æ®åº“&lt;/span&gt;
&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;blog&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;   &lt;span class="c1"&gt;# è¿æ¥æœ¬åœ°blogæ•°æ®åº“&lt;/span&gt;
&lt;span class="c1"&gt;# å¦‚éœ€éªŒè¯å’ŒæŒ‡å®šä¸»æœºå&lt;/span&gt;
&lt;span class="c1"&gt;# connect(&amp;#39;blog&amp;#39;, host=&amp;#39;192.168.3.1&amp;#39;, username=&amp;#39;root&amp;#39;, password=&amp;#39;1234&amp;#39;)&lt;/span&gt;

&lt;span class="c1"&gt;# å®šä¹‰åˆ†ç±»æ–‡æ¡£&lt;/span&gt;
&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Categories&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Document&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="s1"&gt;&amp;#39; ç»§æ‰¿Documentç±»,ä¸ºæ™®é€šæ–‡æ¡£ &amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;StringField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;artnum&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;IntField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;date&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;DateTimeField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å’ŒDjangoçš„modelä½¿ç”¨å¾ˆç±»ä¼¼,æ‰€ä»¥ä¹Ÿä¸è§£é‡Šä»€ä¹ˆ.&lt;/p&gt;
&lt;h3 id="_2"&gt;æ’å…¥&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;cate&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Categories&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Linux&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;   &lt;span class="c1"&gt;# å¦‚æœrequiredä¸ºTrueåˆ™å¿…é¡»èµ‹äºˆåˆå§‹å€¼,å¦‚æœæœ‰default,èµ‹äºˆåˆå§‹å€¼åˆ™ä½¿ç”¨é»˜è®¤å€¼&lt;/span&gt;
&lt;span class="n"&gt;cate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt; &lt;span class="c1"&gt;# ä¿å­˜åˆ°æ•°æ®åº“&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_3"&gt;æŸ¥è¯¢å’Œæ›´æ–°&lt;/h3&gt;
&lt;p&gt;æ–‡æ¡£ç±»æœ‰ä¸€ä¸ª objects å±æ€§.æˆ‘ä»¬ä½¿ç”¨å®ƒæ¥æŸ¥è¯¢æ•°æ®åº“.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# è¿”å›é›†åˆé‡Œçš„æ‰€æœ‰æ–‡æ¡£å¯¹è±¡çš„åˆ—è¡¨&lt;/span&gt;
&lt;span class="n"&gt;cate&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Categories&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c1"&gt;# è¿”å›æ‰€æœ‰ç¬¦åˆæŸ¥è¯¢æ¡ä»¶çš„ç»“æœçš„æ–‡æ¡£å¯¹è±¡åˆ—è¡¨&lt;/span&gt;
&lt;span class="n"&gt;cate&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Categories&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Python&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# æ›´æ–°æŸ¥è¯¢åˆ°çš„æ–‡æ¡£:&lt;/span&gt;
&lt;span class="n"&gt;cate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;LinuxZen&amp;quot;&lt;/span&gt;
&lt;span class="n"&gt;cate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;æŸ¥è¯¢æ•°ç»„&lt;/span&gt; &lt;span class="n"&gt;é»˜è®¤æŸ¥è¯¢æ•°ç»„&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;=&amp;quot;&lt;/span&gt;&lt;span class="n"&gt;ä»£è¡¨çš„æ„æ€æ˜¯in&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Posts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Document&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;artid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;IntField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;title&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;StringField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;StringField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;author&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ReferenceField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;tags&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ListField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;StringField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;categories&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ReferenceField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Categories&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;comments&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;IntField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# å°†ä¼šè¿”å›æ‰€æœ‰tagsåŒ…å«codingçš„æ–‡æ¡£&lt;/span&gt;
&lt;span class="n"&gt;Posts&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tags&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;coding&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="referencefield"&gt;ReferenceField å¼•ç”¨å­—æ®µ:&lt;/h3&gt;
&lt;p&gt;é€šè¿‡å¼•ç”¨å­—æ®µå¯ä»¥é€šè¿‡æ–‡æ¡£ç›´æ¥è·å–å¼•ç”¨å­—æ®µå¼•ç”¨çš„é‚£ä¸ªæ–‡æ¡£:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Categories&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Document&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;StringField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;artnum&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;IntField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;date&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;DateTimeField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt; &lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Posts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Document&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

    &lt;span class="n"&gt;title&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;StringField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;StringField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;tags&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ListField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;StringField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;categories&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ReferenceField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Categories&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4 id="_4"&gt;æ’å…¥å¼•ç”¨å­—æ®µ&lt;/h4&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;cate&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;Categories&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Linux&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;cate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;post&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Posts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Linuxzen.com&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Linuxzen.com&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;tags&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Linux&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;web&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;categories&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;cate&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;post&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h4 id="_5"&gt;é€šè¿‡å¼•ç”¨å­—æ®µç›´æ¥è·å–å¼•ç”¨æ–‡æ¡£å¯¹è±¡&lt;/h4&gt;
&lt;p&gt;ä¸€èˆ¬æ–‡æ¡£æŸ¥è¯¢ä¼šè¿”å›ä¸€ä¸ªåˆ—è¡¨(å°½ç®¡åªæœ‰ä¸€ä¸ªç»“æœ),æˆ‘ä»¬æƒ³è¦è·å¾—ä¸€ä¸ªæ–‡æ¡£å¯¹è±¡å¯ä»¥ä½¿ç”¨ç´¢å¼•è·å–ç¬¬ä¸€ä¸ªæ–‡æ¡£å¯¹è±¡,ä½†æ˜¯mongoengineå»ºè®®ä½¿ç”¨first()æ¥è·å–ç¬¬ä¸€ä¸ª:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;cate&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Posts&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;all&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;categories&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;cate&lt;/span&gt;

&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;cate&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;
&lt;span class="sa"&gt;u&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Linux&amp;#39;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æŸ¥è¯¢åŒ…å«Linuxåˆ†ç±»çš„æ–‡ç« &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;cate&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Categories&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Linux&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;first&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;Posts&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;categories&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;cate&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="embeddeddocument"&gt;EmbeddedDocument åµŒå…¥æ–‡æ¡£&lt;/h3&gt;
&lt;p&gt;ç»§æ‰¿EmbeddedDocumentçš„æ–‡æ¡£ç±»å°±æ˜¯åµŒå…¥æ–‡æ¡£,åµŒå…¥æ–‡æ¡£ç”¨äºåµŒå…¥å…¶ä»–æ–‡æ¡£çš„EmbeddedDocumentField å­—æ®µ,æ¯”å¦‚ä¸Šé¢ä¾‹å­çš„tagså­—æ®µå¦‚æœæ”¹æˆåµŒå…¥æ–‡æ¡£çš„è¯å¯ä»¥å°†Postsæ–‡æ¡£ç±»æ”¹æˆå¦‚ä¸‹æ–¹å¼:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Posts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Document&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;

    &lt;span class="n"&gt;title&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;StringField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;max_length&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;StringField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;tags&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ListField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;EmbeddedDocumentField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Tags&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;required&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;categories&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ReferenceField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;Categories&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿˜éœ€è¦æ·»åŠ ä¸€ä¸ªTagsåµŒå…¥æ–‡æ¡£ç±»:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;Tags&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;EmbeddedDocument&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="n"&gt;name&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;StringField&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;date&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;DateTimeField&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;default&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;now&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬åƒå¦‚ä¸‹æ–¹å¼æ’å…¥Postsæ–‡æ¡£ä¸­çš„Tags&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;tag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Tags&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Linuxzen&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;post&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Posts&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;title&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Linuxzen.com&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Linuxzen.com&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tags&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tag&lt;/span&gt;&lt;span class="p"&gt;],&lt;/span&gt; &lt;span class="n"&gt;categories&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;cate&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;tag&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Tags&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;mysite&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;post&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tags&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tag&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;post&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="n"&gt;tags&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;post&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tags&lt;/span&gt;
&lt;span class="o"&gt;&amp;gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;tag&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;tags&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;tag&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;

&lt;span class="n"&gt;Linuxzen&lt;/span&gt;
&lt;span class="n"&gt;mysite&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_6"&gt;æ—¶é—´æ®µæŸ¥è¯¢&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    &lt;span class="n"&gt;start&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;year&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;month&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;month&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;emonth&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;eyear&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;year&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;emonth&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;month&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
        &lt;span class="n"&gt;eyear&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;year&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;end&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;datetime&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;eyear&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;emonth&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;articles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;Posts&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;date__gte&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;start&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;date__lt&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;end&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;order_by&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-date&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_7"&gt;åˆ†ç‰‡&lt;/h3&gt;
&lt;p&gt;sliceç”¨äºåˆ†ç‰‡&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# comments - skip 5, limit 10&lt;/span&gt;
&lt;span class="n"&gt;Page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fields&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;slice__comments&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;])&lt;/span&gt;

&lt;span class="c1"&gt;# ä¹Ÿå¯ä»¥ä½¿ç”¨ç´¢å¼•å€¼åˆ†ç‰‡&lt;/span&gt;

&lt;span class="c1"&gt;# limit 5&lt;/span&gt;
&lt;span class="n"&gt;users&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="p"&gt;[:&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="c1"&gt;# skip 5&lt;/span&gt;
&lt;span class="n"&gt;users&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;:]&lt;/span&gt;

&lt;span class="c1"&gt;# skip 10, limit 15&lt;/span&gt;
&lt;span class="n"&gt;users&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;15&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_8"&gt;ä½¿ç”¨åŸå§‹è¯­å¥æŸ¥è¯¢&lt;/h3&gt;
&lt;p&gt;å¦‚æœæƒ³ä½¿ç”¨åŸå§‹çš„pymongoæŸ¥è¯¢æ–¹å¼å¯ä»¥ä½¿ç”¨__raw__æ“ä½œç¬¦ Page.objects(&lt;strong&gt;raw&lt;/strong&gt;={'tags':'coding'})
ä½¿ç”¨$incå’Œ$setæ“ä½œç¬¦&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# æ›´æ–°åµŒå…¥æ–‡æ¡£commentså­—æ®µbyçš„å€¼ä¸ºjoeçš„æ–‡æ¡£å­—æ®µvoteså¢åŠ 1&lt;/span&gt;
&lt;span class="n"&gt;Page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;comments_by&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;joe&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;inc__votes&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# æ›´æ–°åµŒå…¥æ–‡æ¡£commentså­—æ®µbyçš„å€¼ä¸ºjoeçš„æ–‡æ¡£å­—æ®µvotesè®¾ç½®ä¸º1&lt;/span&gt;
&lt;span class="n"&gt;Page&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;comments_by&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;joe&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;set__votes&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_9"&gt;å…¶ä»–æŠ€å·§&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;#æŸ¥è¯¢ç»“æœè½¬æ¢æˆå­—å…¸&lt;/span&gt;
&lt;span class="n"&gt;users_dict&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;to_mongo&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c1"&gt;# æ’åº,æŒ‰æ—¥æœŸæ’åˆ—&lt;/span&gt;
&lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;order_by&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;date&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# æŒ‰æ—¥æœŸå€’åº&lt;/span&gt;

&lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;User&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;objects&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;order_by&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;-date&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Python"></category><category term="python"></category><category term="pymongo"></category><category term="nosql"></category><category term="mongoengine"></category><category term="mongodb"></category></entry><entry><title>bottleä½¿ç”¨Pythonè£…é¥°å™¨å·§å¦™è§£å†³ç”¨æˆ·éªŒè¯</title><link href="https://www.linuxzen.com/bottleshi-yong-pythonzhuang-shi-qi-qiao-miao-jie-jue-yong-hu-yan-zheng.html" rel="alternate"></link><published>2012-06-16T17:33:00+08:00</published><updated>2012-06-16T17:33:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-06-16:/bottleshi-yong-pythonzhuang-shi-qi-qiao-miao-jie-jue-yong-hu-yan-zheng.html</id><summary type="html">&lt;p&gt;ä¸Šç¯‡æ–‡ç« å‘å¸ƒäº†ä¸€ä¸ªè‡ªå·±å†™çš„ç”¨bottleå†™çš„webç¨‹åº,å…¶ä¸­æ”¶è·æœ€å¤§å°±æ˜¯Pythonè£…é¥°å™¨çš„ä½¿ç”¨.å‰å‡ å¤©ä¹Ÿæ˜¯æ¯”è¾ƒå¿™,æ‰€ä»¥æ²¡èƒ½åˆ†äº«å‡ºæ¥,ä»Šå¤©å°±ç»™å¤§å®¶åˆ†äº«ä¸€ä¸‹ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;ä¸Šç¯‡æ–‡ç« å‘å¸ƒäº†ä¸€ä¸ªè‡ªå·±å†™çš„ç”¨bottleå†™çš„webç¨‹åº,å…¶ä¸­æ”¶è·æœ€å¤§å°±æ˜¯Pythonè£…é¥°å™¨çš„ä½¿ç”¨.å‰å‡ å¤©ä¹Ÿæ˜¯æ¯”è¾ƒå¿™,æ‰€ä»¥æ²¡èƒ½åˆ†äº«å‡ºæ¥,ä»Šå¤©å°±ç»™å¤§å®¶åˆ†äº«ä¸€ä¸‹.&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæ¥åˆ†æä¸‹éœ€æ±‚,webç¨‹åºåå°éœ€è¦è®¤è¯,åå°é¡µé¢åŒ…å«å¤šä¸ªé¡µé¢,æœ€æ™®é€šçš„æ–¹æ³•å°±æ˜¯ä¸ºæ¯ä¸ªurlæ·»åŠ è®¤è¯,ä½†æ˜¯è¿™æ ·å°±éœ€è¦æ¯ä¸ªæ¯ä¸ªç»‘å®šurlçš„åå°å‡½æ•°éƒ½éœ€è¦æ·»åŠ ç±»ä¼¼æˆ–è€…ç›¸åŒçš„ä»£ç ,ä½†æ˜¯è¿™æ ·åšä»£ç å°±è¿‡åº¦å†—ä½™,è€Œä¸”ä¸åˆ©äºæ‰©å±•.&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬å…ˆä¸è°ˆåŠè£…é¥°å™¨,æˆ‘ä»¬éƒ½çŸ¥é“Pythonæ˜¯ä¸ªå¾ˆå¼ºå¤§çš„è¯­è¨€,å¥¹å¯ä»¥å°†å‡½æ•°å½“åšå‚æ•°ä¼ é€’ç»™å‡½æ•°,æœ€ç®€å•çš„:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;p&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Hello,world&amp;#39;&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;funcfactor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;calling function named&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="vm"&gt;__name__&lt;/span&gt;
    &lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;end&amp;#39;&lt;/span&gt;

&lt;span class="n"&gt;funcfactor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;# è¾“å‡ºä¸º:&lt;/span&gt;
&lt;span class="c1"&gt;# calling function named p&lt;/span&gt;
&lt;span class="c1"&gt;# Hello,world&lt;/span&gt;
&lt;span class="c1"&gt;# end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸€ç›®äº†ç„¶çš„ç¨‹åº,å®šä¹‰ä¸€ä¸ªå‡½æ•°p(),å°†å‡½æ•°på½“åšå‚æ•°ä¼ é€’ç»™å–Šå‡ºfuncfactor,åœ¨æ‰§è¡Œpå‡½æ•°å‰ååŠ ä¸Šä¸€äº›åŠ¨ä½œ.&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬è¿˜å¯ä»¥è¿™ä¹ˆåš:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;p&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Hello,world&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;funcfactor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;calling function named&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="vm"&gt;__name__&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;func&lt;/span&gt;

&lt;span class="n"&gt;func&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;funcfactor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="c1"&gt;# è¾“å‡ºä¸º:&lt;/span&gt;
&lt;span class="c1"&gt;# calling function named p&lt;/span&gt;
&lt;span class="n"&gt;Hello&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;world&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ­£å¦‚ä½ çœ‹åˆ°çš„,æˆ‘ä»¬å¯ä»¥å°†å‡½æ•°è¿”å›ç„¶åèµ‹äºˆä¸€ä¸ªå˜é‡,ç•™å¾…ç¨åè°ƒç”¨.ä½†æ˜¯è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬è¦æƒ³åœ¨å‡½æ•°æ‰§è¡Œååšç‚¹ä»€ä¹ˆå°±ä¸å¯èƒ½,ä½†æ˜¯æˆ‘ä»¬çš„Pythonæ˜¯å¼ºå¤§çš„,Pythonå¯ä»¥åœ¨å‡½æ•°ä¸­å†åµŒå¥—ä¸€ä¸ªå‡½æ•°,æˆ‘ä»¬å¯ä»¥åƒä¸‹é¢è¿™ä¹ˆåš:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;p&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Hello, world&amp;#39;&lt;/span&gt;

&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;funcfactor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;wrapper&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;do something at start&amp;#39;&lt;/span&gt;
        &lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;do something at end&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;wrapper&lt;/span&gt;

&lt;span class="n"&gt;func&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;funcfactor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="c1"&gt;#è¾“å‡ºä¸º:&lt;/span&gt;
&lt;span class="c1"&gt;# do something at start&lt;/span&gt;
&lt;span class="c1"&gt;# Hello, world&lt;/span&gt;
&lt;span class="c1"&gt;# do something at end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸‹é¢æˆ‘ä»¬æ¥çœ‹çœ‹è£…é¥°å™¨,ä¸Šé¢çš„ä»£ç è™½ç„¶å®ç°çš„ä¸€ä¸ªå¾ˆå›°éš¾çš„ä»»åŠ¡,ä½†æ˜¯è¿˜ä¸å¤Ÿä¼˜é›…,è€Œä¸”ä»£ç ä¸ç¬¦åˆPythonçš„å“²å­¦æ€æƒ³,æ‰€ä»¥è£…é¥°å™¨å°±åº”å£°è€Œå‡º,è£…é¥°å™¨æ²¡æœ‰å’Œä¸Šé¢çš„åŸç†ç›¸åŒ,åŒæ ·ç”¨äºåŒ…è£…å‡½æ•°,åªæ˜¯ä»£ç å®ç°ä¸Šæ›´åŠ ä¼˜é›…å’Œä¾¿äºé˜…è¯».è£…é¥°å™¨ä»¥@å¼€å¤´åé¢è·Ÿä¸Šè£…é¥°å™¨çš„åç§°,ç´§æ¥ç€ä¸‹ä¸€è¡Œå°±æ˜¯è¦åŒ…è£…çš„å‡½æ•°ä½“,ä¸Šé¢çš„ä¾‹å­ç”¨è£…é¥°å™¨å¯ç”¨å¦‚ä¸‹æ–¹å¼å®ç°:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;decorator&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;wrapper&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;do something at start&amp;#39;&lt;/span&gt;
        &lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;do something at end&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;wrapper&lt;/span&gt;

&lt;span class="nd"&gt;@decorator&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;p&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Hello, world&amp;#39;&lt;/span&gt;

&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="c1"&gt;#è¾“å‡ºä¸º:&lt;/span&gt;
&lt;span class="c1"&gt;# do something at start&lt;/span&gt;
&lt;span class="c1"&gt;# Hello, world&lt;/span&gt;
&lt;span class="c1"&gt;# do something at end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®é™…ä¸Šè£…é¥°å™¨å¹¶æ²¡æœ‰æ€§èƒ½æ–¹é¢æˆ–å…¶ä»–æ–¹é¢çš„æå‡,ä»…ä»…æ˜¯ä¸€ç§è¯­æ³•ç³–,å°±æ˜¯ä¸Šé¢ä¸€ä¸ªä¾‹å­çš„æ”¹å†™,è¿™æ ·æ›´åŠ ä¼˜é›…å’Œä¾¿ä¸é˜…è¯».
å¦‚æœæˆ‘ä»¬çš„p()å‡½æ•°ä¸æƒ³ä»…ä»…åªè¾“Hello,world,æˆ‘ä»¬æƒ³å‘æŸäº›æˆ‘ä»¬æŒ‡å®šçš„äººæ‰“æ‹›å‘¼:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;decorator&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;wrapper&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;do something at start&amp;#39;&lt;/span&gt;
        &lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;do something at end&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;wrapper&lt;/span&gt;

&lt;span class="nd"&gt;@decorator&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;p&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Hello&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;name&lt;/span&gt;

&lt;span class="n"&gt;p&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Jim&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="c1"&gt;#è¾“å‡ºä¸º:&lt;/span&gt;
&lt;span class="c1"&gt;# do something at start&lt;/span&gt;
&lt;span class="c1"&gt;# Hello Jim&lt;/span&gt;
&lt;span class="c1"&gt;# do something at end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è£…é¥°å™¨åœ¨è£…é¥°ä¸éœ€è¦å‚æ•°çš„è£…é¥°å™¨åµŒå¥—å‡½æ•°ä¸æ˜¯å¿…é¡»å¾—,å¦‚æœè¢«è£…é¥°çš„å‡½æ•°éœ€è¦å‚æ•°,å¿…é¡»åµŒå¥—ä¸€ä¸ªå‡½æ•°æ¥å¤„ç†å‚æ•°.
å†™åˆ°è¿™é‡Œæƒ³å¿…å¤§å®¶ä¹ŸçŸ¥é“è£…é¥°å™¨çš„ç”¨æ³•å’Œä½œç”¨.ç°åœ¨å›åˆ°æ­£é¢˜,å¦‚ä½•ä¼˜é›…çš„ç»™åå°urlåŠ ä¸ŠéªŒè¯åŠŸèƒ½?æ¯«æ— ç–‘é—®æˆ‘ä»¬ä½¿ç”¨è£…é¥°å™¨æ¥å¤„ç†:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;blog_auth&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="sd"&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class="sd"&gt;    å®šä¹‰ä¸€ä¸ªè£…é¥°å™¨ç”¨äºè£…é¥°éœ€è¦éªŒè¯çš„é¡µé¢&lt;/span&gt;
&lt;span class="sd"&gt;    è£…é¥°å™¨å¿…é¡»æ”¾åœ¨routeè£…é¥°å™¨ä¸‹é¢&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class="c1"&gt;# å®šä¹‰åŒ…è£…å‡½æ•°&lt;/span&gt;
    &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;wrapper&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="n"&gt;args&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kargs&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="c1"&gt;# è¯»å–cookie&lt;/span&gt;
            &lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;COOKIES&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
            &lt;span class="n"&gt;shell&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;COOKIES&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;shell&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
        &lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="c1"&gt;# å‡ºç°å¼‚å¸¸åˆ™é‡å®šå‘åˆ°ç™»å½•é¡µé¢&lt;/span&gt;
            &lt;span class="n"&gt;redirect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/login&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

        &lt;span class="c1"&gt;# éªŒè¯ç”¨æˆ·æ•°æ®&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;checkShell&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;shell&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="c1"&gt;# æ ¡éªŒæˆåŠŸåˆ™è¿”å›å‡½æ•°&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="o"&gt;**&lt;/span&gt;&lt;span class="n"&gt;kargs&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="c1"&gt;# å¦åˆ™åˆ™é‡å®šå‘åˆ°ç™»å½•é¡µé¢&lt;/span&gt;
            &lt;span class="n"&gt;redirect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/login&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;wrapper&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¯ä»¥å†éœ€è¦éªŒè¯çš„åœ°æ–¹æ·»åŠ blog_authè£…é¥°å™¨:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nd"&gt;@route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/admin:#/?#&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nd"&gt;@blog_auth&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;admin&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="sd"&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class="sd"&gt;    ç”¨äºæ˜¾ç¤ºåå°ç®¡ç†é¦–é¡µ&lt;/span&gt;
&lt;span class="sd"&gt;    &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;TEMPLATE&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;title&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ä»ªè¡¨ç›˜ | &amp;#39;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;TEMPLATE&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;BLOG_NAME&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;TEMPLATE&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;COOKIES&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;articles&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[]&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;article&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;posts&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;find&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sort&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;date&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;DESCENDING&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;limit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;articles&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;append&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;article&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="c1"&gt;# å°†æ–‡ç« åˆ—è¡¨äº¤ç»™å‰å°æ¨¡ç‰ˆ&lt;/span&gt;
    &lt;span class="n"&gt;TEMPLATE&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;articles&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;articles&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;admin.html&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;TEMPLATE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è‡³æ­¤bottleéªŒè¯çš„é—®é¢˜å°±å¾ˆä¼˜é›…çš„ç”¨è£…é¥°å™¨è§£å†³äº†.&lt;/p&gt;</content><category term="Python"></category><category term="éªŒè¯"></category><category term="è£…é¥°å™¨"></category><category term="ç”¨æˆ·"></category><category term="python"></category><category term="bottle"></category></entry><entry><title>ç”¨bottle+mongodbå†™çš„ä¸€ä¸ªblogç¨‹åº</title><link href="https://www.linuxzen.com/yong-bottlemongodbxie-de-yi-ge-blogcheng-xu.html" rel="alternate"></link><published>2012-06-16T16:20:00+08:00</published><updated>2012-06-16T16:20:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-06-16:/yong-bottlemongodbxie-de-yi-ge-blogcheng-xu.html</id><summary type="html">&lt;p&gt;æˆ‘ä¸ªäººè§‰å¾—æ›´å¥½æ›´å¿«çš„å­¦ä¹ å’ŒæŒæ¡æŸä¸ªä¸œè¥¿æœ€å¥½çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨å®ƒ,å¤šä½¿ç”¨å®ƒ.ç„¶ååœ¨ä¸€æ¬¡æ¬¡çš„è§£å†³é—®é¢˜ä¸­æ¥å¿«é€ŸæŒæ¡ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;æˆ‘ä¸ªäººè§‰å¾—æ›´å¥½æ›´å¿«çš„å­¦ä¹ å’ŒæŒæ¡æŸä¸ªä¸œè¥¿æœ€å¥½çš„æ–¹æ³•å°±æ˜¯ä½¿ç”¨å®ƒ,å¤šä½¿ç”¨å®ƒ.ç„¶ååœ¨ä¸€æ¬¡æ¬¡çš„è§£å†³é—®é¢˜ä¸­æ¥å¿«é€ŸæŒæ¡å’Œäº†è§£å®ƒ.ä½ è§‰å¾—å‘¢?å‰æ®µæ—¶é—´æ¥è§¦äº†bottleè¿™ä¸ªè½»é‡webæ¡†æ¶,å’Œnosqlæ•°æ®åº“mongodb,ä¸ºäº†æŒæ¡å’Œäº†è§£è¿™å¥¹ä»¬,æˆ‘è‡ªå·±åšäº†ä¸€ä¸ªblogç¨‹åº,å‚ç…§äº†vimer.cné‡Œçš„è®¾è®¡çš„ç‰©ç†è®¾è®¡.æ˜¯ç”¨bottleä½œä¸ºwebå¼€å‘æ¡†æ¶,mongodbä½œä¸ºåå°æ•°æ®åº“.ä¸»è¦å®ç°åŠŸèƒ½:&lt;/p&gt;
&lt;p&gt;å‰å°æ˜¾ç¤ºæ–‡ç« :
æŒ‰åˆ†ç±»æ˜¾ç¤º
æŒ‰æ ‡ç­¾æ˜¾ç¤º
æŒ‰æœˆä»½å½’æ¡£æ˜¾ç¤º
æœ€æ–°æ–‡ç« 
è¯„è®º
åå°ç®¡ç†:
ç®¡ç†æ–‡ç« 
ç®¡ç†åˆ†ç±»
ç®¡ç†è¯„è®º
å‘è¡¨æ–‡ç« 
ç”¨æˆ·éªŒè¯&lt;/p&gt;
&lt;p&gt;ç›®å½•ç»“æ„&lt;/p&gt;
&lt;p&gt;water&lt;/p&gt;
&lt;p&gt;+-app           ç¨‹åºç›®å½•&lt;/p&gt;
&lt;p&gt;|----admin.py  åå°ç®¡ç†&lt;/p&gt;
&lt;p&gt;|----blog.py   å‰å°æ˜¾ç¤º&lt;/p&gt;
&lt;p&gt;|----dbconn.py æ•°æ®åº“è¿æ¥&lt;/p&gt;
&lt;p&gt;|----encrypt.pyåŒ…å«åŠ å¯†å‡½æ•°&lt;/p&gt;
&lt;p&gt;+-static       é™æ€æ–‡ä»¶ç›®å½•:åŒ…æ‹¬js css image&lt;/p&gt;
&lt;p&gt;+-views        æ¨¡ç‰ˆç›®å½•&lt;/p&gt;
&lt;p&gt;+-index.py     ç”¨äºå¯åŠ¨æ•´ä¸ªç¨‹åº&lt;/p&gt;
&lt;p&gt;+-initiate.py  åˆå§‹åŒ–è„šæœ¬,ç”¨äºåˆ›å»ºä¸€ä¸ªç®¡ç†ç”¨æˆ·&lt;/p&gt;
&lt;p&gt;+-setting.py   è®¾ç½®æ–‡ä»¶,å„ç§è®¾ç½®&lt;/p&gt;
&lt;p&gt;+-static.py    ç”¨äºç¨‹åºå¤„ç†é™æ€æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;é¡¹ç›®ä»£ç æ”¾åœ¨äº†google codeä¸Š,å¯ä»¥è®¿é—®ä¸‹é¢é“¾æ¥æµè§ˆ:
http://code.google.com/p/sharepythoncode/source/browse/water/&lt;/p&gt;</content><category term="Python"></category><category term="é¡¹ç›®"></category><category term="å®ä¾‹"></category><category term="web"></category><category term="python"></category><category term="mongodb"></category><category term="bottle"></category></entry><entry><title>bottleçš„cookieæ“ä½œå°è®°(è·å–ä¸æ˜¯åœ¨å½“å‰é¡µé¢åˆ›å»ºçš„cookie)</title><link href="https://www.linuxzen.com/bottlede-cookiecao-zuo-xiao-ji-huo-qu-bu-shi-zai-dang-qian-ye-mian-chuang-jian-de-cookie.html" rel="alternate"></link><published>2012-06-02T17:51:00+08:00</published><updated>2012-06-02T17:51:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-06-02:/bottlede-cookiecao-zuo-xiao-ji-huo-qu-bu-shi-zai-dang-qian-ye-mian-chuang-jian-de-cookie.html</id><summary type="html">&lt;p&gt;è¿™ä¸¤å¤©ä¸ºç”¨bottle+mongodbå†™çš„ä¸€ä¸ªé¡¹ç›®åŠ ä¸Šç™»å½•åŠŸèƒ½,æ— å¥ˆæ€ä¹ˆéƒ½è·å–ä¸åˆ°ä¿å­˜çš„cookie,æ–‡æ¡£ç»™å‡ºè®©æˆ‘ä»¬è¿™æ ·æ“ä½œcookieçš„ä»£ç ç‰‡æ®µ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nd"&gt;@route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;â€™&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="err"&gt;â€™&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;login&lt;/span&gt; &lt;span class="p"&gt;():&lt;/span&gt;
      &lt;span class="n"&gt;username&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;forms&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;â€™&lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt; &lt;span class="err"&gt;â€™&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="n"&gt;password&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;forms&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;â€™&lt;/span&gt;&lt;span class="n"&gt;password&lt;/span&gt; &lt;span class="err"&gt;â€™&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;check_user_credentials&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;password â€¦&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;è¿™ä¸¤å¤©ä¸ºç”¨bottle+mongodbå†™çš„ä¸€ä¸ªé¡¹ç›®åŠ ä¸Šç™»å½•åŠŸèƒ½,æ— å¥ˆæ€ä¹ˆéƒ½è·å–ä¸åˆ°ä¿å­˜çš„cookie,æ–‡æ¡£ç»™å‡ºè®©æˆ‘ä»¬è¿™æ ·æ“ä½œcookieçš„ä»£ç ç‰‡æ®µ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nd"&gt;@route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;â€™&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="err"&gt;â€™&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;login&lt;/span&gt; &lt;span class="p"&gt;():&lt;/span&gt;
      &lt;span class="n"&gt;username&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;forms&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;â€™&lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt; &lt;span class="err"&gt;â€™&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="n"&gt;password&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;forms&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;â€™&lt;/span&gt;&lt;span class="n"&gt;password&lt;/span&gt; &lt;span class="err"&gt;â€™&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;check_user_credentials&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;password&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
           &lt;span class="n"&gt;response&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_cookie&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;account&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;secret&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="err"&gt;â€™&lt;/span&gt;&lt;span class="n"&gt;some&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;secret&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="err"&gt;â€™&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
           &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Welcome &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;!You are now logged in.&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;username&lt;/span&gt;
      &lt;span class="k"&gt;else&lt;/span&gt; &lt;span class="p"&gt;:&lt;/span&gt;
           &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Login failed.&amp;quot;&lt;/span&gt; 

&lt;span class="nd"&gt;@route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="err"&gt;â€™&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;restricted&lt;/span&gt;&lt;span class="err"&gt;â€™&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;restricted_area&lt;/span&gt; &lt;span class="p"&gt;():&lt;/span&gt;
      &lt;span class="n"&gt;username&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt; &lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_cookie&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;account&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;secret&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="err"&gt;â€™&lt;/span&gt;&lt;span class="n"&gt;some&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;secret&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;key&lt;/span&gt;&lt;span class="err"&gt;â€™&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
      &lt;span class="k"&gt;if&lt;/span&gt;  &lt;span class="n"&gt;username&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
           &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Hello &lt;/span&gt;&lt;span class="si"&gt;%s&lt;/span&gt;&lt;span class="s2"&gt;.Welcome back.&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;username&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è™½ç„¶æ–‡æ¡£ä¸Šæ²¡æœ‰ä½†æ˜¯è¿˜æœ‰ä¸€ç§æ“ä½œcookieçš„æ–¹å¼:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;bottle&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;

&lt;span class="nd"&gt;@route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/login&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;POST&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;login&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;POST&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;passwd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;POST&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;passwd&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;check_user_right&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;passwd&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;COOKIES&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;account&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;pass&lt;/span&gt;

&lt;span class="nd"&gt;@route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/admin&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;admin&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;COOKIES&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;pass&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä½†æ˜¯æ— è®ºæˆ‘ç”¨å“ªç§æ–¹å¼æ“ä½œæˆ‘éƒ½æ— æ³•è·å–cookie,ä¸ºä»€ä¹ˆå‘¢.ç™¾æ€ä¸å¾—å…¶è§£.ä½†æ˜¯æˆ‘çš„ä¸€ä¸ªå¤„ç†æ–‡ç« ç‚¹å‡»ç‡çš„æé†’äº†æˆ‘,ä»£ç å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nd"&gt;@route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/archrives/:aid#\d+#&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;article_show&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;aid&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;db&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;dbconn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ConnDB&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;artid&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;int&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;aid&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="c1"&gt;# è·å–å®¢æˆ·ç«¯ip&lt;/span&gt;
    &lt;span class="n"&gt;remoteip&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;environ&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;REMOTE_ADDR&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

    &lt;span class="n"&gt;artcookie&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;remoteip&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;ip&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;aid&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;COOKIES&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

    &lt;span class="c1"&gt;# åˆ¤æ–­cookieæ˜¯å¦å­˜åœ¨&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;artcookie&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;COOKIES&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;keys&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
        &lt;span class="c1"&gt;# å­˜åœ¨åˆ™æ›´æ–°æœ‰æ•ˆæ—¶é—´&lt;/span&gt;
        &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;COOKIES&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;artcookie&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
        &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;COOKIES&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;artcookie&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;max-age&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="c1"&gt;# ä¸å­˜åœ¨åˆ™æ›´æ–°æ–‡ç« æŸ¥çœ‹æ¬¡æ•°&lt;/span&gt;
        &lt;span class="n"&gt;db&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;posts&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;artid&lt;/span&gt;&lt;span class="p"&gt;},&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;$inc&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:{&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;views&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;}})&lt;/span&gt;

        &lt;span class="c1"&gt;# å¹¶è®¾ç½®cookie&lt;/span&gt;
        &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;COOKIES&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;artcookie&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
        &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;COOKIES&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;artcookie&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;max-age&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="mi"&gt;500&lt;/span&gt;

    &lt;span class="n"&gt;TEMPLATE&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;posts&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;getArtList&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;id&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;artid&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
    &lt;span class="n"&gt;TEMPLATE&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;update&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;setTempVar&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;template&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;article.html&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;TEMPLATE&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™é‡Œæ˜¯å¯ä»¥æ­£å¸¸è·å–åˆ°cookieçš„,è€Œä¸”ä»£ç æ²¡æœ‰ä»»ä½•åŒºåˆ«.å”¯ä¸€çš„åŒºåˆ«å°±æ˜¯ç”¨æˆ·è®¤è¯æ˜¯è·³è½¬äº†é¡µé¢.æ‰€ä»¥æˆ‘helpäº†ä¸€ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;bottle&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;
&lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;set_cookie&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;helpçš„ç»“æœå…¶ä¸­æœ‰ä¸¤ä¸ªå‚æ•°ä¸€ä¸ªæ˜¯path,å’Œdomain:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;    :param domain: the domain that is allowed to read the cookie.
      (default: current domain)
    :param path: limits the cookie to a given path (default: current path)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ˜æ˜¾bottleçš„cookieé»˜è®¤åªåœ¨å½“å‰è·¯å¾„ä¸‹èƒ½è¯»å–çš„åˆ°,æ‰€ä»¥è¦åˆ«çš„é¡µé¢è¯»å–åˆ°cookieæˆ‘ä»¬çš„ä»£ç é¡»æ”¹æˆå¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;bottle&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;response&lt;/span&gt;

&lt;span class="nd"&gt;@route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/login&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;method&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;POST&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;login&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;POST&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="n"&gt;passwd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;POST&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;passwd&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;check_user_right&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;user&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;passwd&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;COOKIES&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;account&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;user&lt;/span&gt;
        &lt;span class="n"&gt;response&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;COOKIES&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;account&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;][&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;path&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;/admin&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;pass&lt;/span&gt;

&lt;span class="nd"&gt;@route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/admin&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;admin&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;COOKIES&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;user&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ ·æˆ‘ä»¬å°±èƒ½åœ¨åˆ«çš„è·¯å¾„ä¸‹è®¿é—®æˆ‘ä»¬è®¾å®šçš„cookie.&lt;/p&gt;</content><category term="Python"></category><category term="web"></category><category term="python"></category><category term="cookie"></category><category term="bottle"></category></entry><entry><title>ä½¿ç”¨beakerè®©bottleæ”¯æŒsession</title><link href="https://www.linuxzen.com/shi-yong-beakerrang-bottlezhi-chi-session.html" rel="alternate"></link><published>2012-05-26T11:38:00+08:00</published><updated>2012-05-26T11:38:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-05-26:/shi-yong-beakerrang-bottlezhi-chi-session.html</id><summary type="html">&lt;p&gt;bottleæ˜¯ä¸€ä¸ªå°å‹webæ¡†æ¶,å¾ˆå°åªæœ‰ä¸€ä¸ªæ–‡ä»¶,ä½†åŠŸèƒ½ç¡®å¾ˆå¼ºå¤§,å­¦èµ·æ¥ä¹Ÿç®€å•,ç®€å•å’Œå°å·§çš„åŒæ—¶ä¹Ÿæœ‰å¾ˆå¤šä¸è¶³,æŸäº›åŠŸèƒ½æ”¯æŒè¿˜ä¸æ˜¯å¾ˆå®Œå–„,æ¯”å¦‚ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;bottleæ˜¯ä¸€ä¸ªå°å‹webæ¡†æ¶,å¾ˆå°åªæœ‰ä¸€ä¸ªæ–‡ä»¶,ä½†åŠŸèƒ½ç¡®å¾ˆå¼ºå¤§,å­¦èµ·æ¥ä¹Ÿç®€å•,ç®€å•å’Œå°å·§çš„åŒæ—¶ä¹Ÿæœ‰å¾ˆå¤šä¸è¶³,æŸäº›åŠŸèƒ½æ”¯æŒè¿˜ä¸æ˜¯å¾ˆå®Œå–„,æ¯”å¦‚session.ä½†æ˜¯ä¹Ÿæœ‰å®ƒè‡ªèº«çš„å¥½å¤„,æˆ‘ä»¬å¯ä»¥è‡ªå·±æˆ–ä½¿ç”¨åˆ«çš„æ¨¡å—æ¥æ‰©å±•å®ƒ,ä¸åƒdjango,å¾ˆå¼ºå¤§,ä½†æ˜¯æƒ³è¦è¿›ä¸€æ­¥æ‰©å±•çš„æ—¶å€™ç¡®æ— ä»ä¸‹æ‰‹.æˆ‘ä»¬å¯ä»¥æŠŠéå¸¸ç®€å•è€Œå¼ºå¤§çš„bottleè‡ªå·±åŠ¨æ‰‹å°†å®ƒå˜å¾—æ›´åŠ å¼ºå¤§å’Œå®Œå–„.&lt;/p&gt;
&lt;p&gt;bottleå°å·§æ”¯æŒcookieä½†æ˜¯ä¸æ”¯æŒsession.ä¸ºäº†å®‰å…¨èµ·è§æˆ‘ä»¬æœ‰æ—¶å€™å¸Œæœ›ä½¿ç”¨çš„session.æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸­é—´ä»¶beakeræ¥æ‰©å±•bottle,ä½¿æˆ‘ä»¬çš„bottleåº”ç”¨æ”¯æŒsession.åºŸè¯ä¸å¤šè¯´.é¦–å…ˆbeakerä¸æ˜¯å†…ç½®æ¨¡å—,æˆ‘ä»¬é¦–å…ˆæ¥å®‰è£…å®ƒ.å½“ç„¶ä½ å¯ä»¥ç½‘ä¸Šä¸‹åŒ…æ‰‹åŠ¨å®‰è£…,æˆ‘ä»¬ä½¿ç”¨æœ€ç®€å•çš„:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;easy_install&lt;span class="w"&gt; &lt;/span&gt;beaker
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ²¡æœ‰easy_installè¿™ä¸ªå‘½ä»¤?googleå§,è£…äº†ä¹‹åè¿˜æ˜¯æ²¡æœ‰,å¦‚è¿‡æ—¶winçš„è¯æ£€æŸ¥ç¯å¢ƒå˜é‡,å°†Pythonå®‰è£…ç›®å½•ä¸‹çš„Scriptsç›®å½•æ·»åŠ åˆ°ç¯å¢ƒå˜é‡.&lt;/p&gt;
&lt;p&gt;å®‰è£…å¥½åæˆ‘ä»¬å¦‚ä½•ä½¿ç”¨å®ƒ,ä¸‹é¢ä¸€æ®µå¸¦é¢æ˜¯ä½¿ç”¨çš„:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;bottle&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;route&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default_app&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;beaker.middleware&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;SessionMiddleware&lt;/span&gt;

&lt;span class="n"&gt;session_opts&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;{&lt;/span&gt;
                &lt;span class="s1"&gt;&amp;#39;session.type&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;file&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="s1"&gt;&amp;#39;session.cookei_expires&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;300&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="s1"&gt;&amp;#39;session.data_dir&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;./sessions&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                &lt;span class="s1"&gt;&amp;#39;sessioni.auto&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;
                &lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="nd"&gt;@route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/test&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;test&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;request&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;environ&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;beaker.session&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;test&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;test&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;
    &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;save&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Test conter: &lt;/span&gt;&lt;span class="si"&gt;%d&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;test&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;default_app&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;SessionMiddleware&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;session_opts&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿è¡Œè¿™æ®µä»£ç ,ä¼šæç¤º:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Bottle server starting up (using WSGIRefServer())...
Listening on http://127.0.0.1:8080/
Hit Ctrl-C to quit.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç°åœ¨æ‰“å¼€æµè§ˆå™¨è®¿é—®&lt;code&gt;http://127.0.0.1:8080/test&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;ä¸æ–­åˆ·æ–°å°±ä¼šå‘ç°æ•°å€¼ä¸æ–­åœ¨å¢å¤§.è¯´æ˜æˆ‘ä»¬çš„sessionå·²ç»æ­£å¸¸å·¥ä½œäº†&lt;/p&gt;</content><category term="Python"></category><category term="web"></category><category term="session"></category><category term="python"></category><category term="bottle"></category><category term="beaker"></category></entry><entry><title>ä½¿ç”¨Linux shellå®æ—¶æ£€æµ‹æ–‡ä»¶å˜æ›´</title><link href="https://www.linuxzen.com/shi-yong-linux-shellshi-shi-jian-ce-wen-jian-bian-geng.html" rel="alternate"></link><published>2012-05-18T11:16:00+08:00</published><updated>2012-05-18T11:16:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-05-18:/shi-yong-linux-shellshi-shi-jian-ce-wen-jian-bian-geng.html</id><summary type="html">&lt;p&gt;ä½¿ç”¨pythonåšwebå¼€å‘,ç°åœ¨æµè¡Œä½¿ç”¨uwsgiè°ƒç”¨pythonç¨‹åº,ä½†æ˜¯ä½¿ç”¨uwsgiä¸€æ®µæ—¶é—´å‘ç°æœ‰ä¸€ä¸ªå¼Šç«¯,å°±æ˜¯æ¯æ¬¡æ›´æ”¹æºä»£ç åå¿…é¡»é‡å¯uwsgiæ‰èƒ½ç”Ÿæ•ˆ,åŒ…æ‹¬æ›´æ”¹æ¨¡æ¿æ–‡ä»¶ä¹Ÿæ˜¯,æˆ‘æ˜¯ä¸ªæ‡’äºº,å†ç»è¿‡ä¸€æ®µ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;ä½¿ç”¨pythonåšwebå¼€å‘,ç°åœ¨æµè¡Œä½¿ç”¨uwsgiè°ƒç”¨pythonç¨‹åº,ä½†æ˜¯ä½¿ç”¨uwsgiä¸€æ®µæ—¶é—´å‘ç°æœ‰ä¸€ä¸ªå¼Šç«¯,å°±æ˜¯æ¯æ¬¡æ›´æ”¹æºä»£ç åå¿…é¡»é‡å¯uwsgiæ‰èƒ½ç”Ÿæ•ˆ,åŒ…æ‹¬æ›´æ”¹æ¨¡æ¿æ–‡ä»¶ä¹Ÿæ˜¯,æˆ‘æ˜¯ä¸ªæ‡’äºº,å†ç»è¿‡ä¸€æ®µæ—¶é—´åå¤çš„æ›´æ”¹-é‡å¯åæˆ‘ç»ˆäºå¿å—ä¸äº†,å†³å®šå†™ä¸€ä¸ªè„šæœ¬æ¥å®šæ—¶ç¨‹åºç›®å½•çš„æ–‡ä»¶æ”¹åŠ¨,å¹¶åŠæ—¶è‡ªåŠ¨é‡å¯uwsgi,æ¥è§£æ”¾æˆ‘çš„åŒæ‰‹å¯ä»¥ä¸ç”¨ç†ä¼šè¿™äº›çç¢çš„é‡å¯å·¥ä½œ. ç”¨äº†ç‚¹æ—¶é—´æ¥ç¼–å†™äº†ä¸€ä¸ªè„šæœ¬ç”¨æ¥åˆ¤æ–­æ˜¯å¦æ›´æ”¹,ç„¶ååˆ¤æ–­æ˜¯å¦éœ€è¦é‡å¯uwsgi.&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æ”¾å‡ºè„šæœ¬å†…å®¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="c1"&gt;# Author      : cold&lt;/span&gt;
&lt;span class="c1"&gt;# Homepage    : http://www.linuxzen.com&lt;/span&gt;
&lt;span class="c1"&gt;# Filename    : checkchange.sh&lt;/span&gt;
&lt;span class="c1"&gt;# Useage      : sh checkchange.sh [dir]&lt;/span&gt;
checkisdir&lt;span class="o"&gt;()&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# Have one argument&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# The argument is a directory&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;i&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;ls&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;sed&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;s/ /\n/g&amp;#39;&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;do&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-d&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;/&lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;
&lt;span class="w"&gt;                        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;bin&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-o&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;lib&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-o&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;include&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# ä¸æƒ³æ£€æµ‹çš„ç›®å½•(è¿™é‡Œæ˜¯ä½¿ç”¨virtualenvç”Ÿæˆçš„ç¯å¢ƒæ–‡ä»¶)&lt;/span&gt;
&lt;span class="w"&gt;                        &lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;
&lt;span class="w"&gt;                                &lt;/span&gt;&lt;span class="k"&gt;continue&lt;/span&gt;
&lt;span class="w"&gt;                        &lt;/span&gt;&lt;span class="k"&gt;fi&lt;/span&gt;
&lt;span class="w"&gt;                        &lt;/span&gt;&lt;span class="nv"&gt;dir&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;&lt;span class="s2"&gt;/&lt;/span&gt;&lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;                        &lt;/span&gt;checkisdir&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$dir&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;
&lt;span class="w"&gt;                        &lt;/span&gt;&lt;span class="nv"&gt;files&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$files&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;\n&amp;#39;&lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="nv"&gt;$i&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="k"&gt;fi&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$files&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;true&lt;/span&gt;
&lt;span class="k"&gt;do&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;/tmp/stat.tmp&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;i&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;checkisdir&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="k"&gt;do&lt;/span&gt;
&lt;span class="w"&gt;                        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;/tmp/patch.tmp&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="w"&gt;                        &lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;
&lt;span class="w"&gt;                                &lt;/span&gt;stat&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;Change&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/tmp/nstat.tmp
&lt;span class="w"&gt;                                &lt;/span&gt;rm&lt;span class="w"&gt; &lt;/span&gt;-f&lt;span class="w"&gt; &lt;/span&gt;/tmp/patch.tmp
&lt;span class="w"&gt;                                &lt;/span&gt;&lt;span class="k"&gt;continue&lt;/span&gt;
&lt;span class="w"&gt;                        &lt;/span&gt;&lt;span class="k"&gt;fi&lt;/span&gt;
&lt;span class="w"&gt;                        &lt;/span&gt;stat&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;Change&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/tmp/nstat.tmp
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;diff&lt;span class="w"&gt; &lt;/span&gt;/tmp/stat.tmp&lt;span class="w"&gt; &lt;/span&gt;/tmp/nstat.tmp&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/tmp/patch.tmp
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$?&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-eq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;
&lt;span class="w"&gt;                        &lt;/span&gt;sleep&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;
&lt;span class="w"&gt;                        &lt;/span&gt;/etc/init.d/uwsgi.py&lt;span class="w"&gt; &lt;/span&gt;restart&lt;span class="w"&gt;                    &lt;/span&gt;&lt;span class="c1"&gt;# å°†æ­¤å¤„æ›´æ”¹ä¸ºæƒ³è¦åšçš„æ“ä½œ&lt;/span&gt;
&lt;span class="w"&gt;                        &lt;/span&gt;patch&lt;span class="w"&gt; &lt;/span&gt;/tmp/stat.tmp&lt;span class="w"&gt; &lt;/span&gt;/tmp/patch.tmp
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="k"&gt;fi&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;i&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;checkisdir&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="k"&gt;do&lt;/span&gt;
&lt;span class="w"&gt;                        &lt;/span&gt;stat&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;Change&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/tmp/stat.tmp
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="k"&gt;continue&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;fi&lt;/span&gt;
&lt;span class="k"&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™é‡Œä¸»è¦æµ‹è¯•å˜æ›´åé‡å¯uwsgi,ä½¿ç”¨æ–¹æ³•:æˆ‘çš„bottleç¨‹åºåœ¨/code/pythonä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sh&lt;span class="w"&gt; &lt;/span&gt;checkchange.sh&lt;span class="w"&gt; &lt;/span&gt;/code/python&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœä½¿ç”¨svnå¯ä»¥å‚è€ƒä¸‹é¢ä»£ç :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="c1"&gt;# Author        : cold&lt;/span&gt;
&lt;span class="c1"&gt;# Homepage      : http://www.linuxzen.com&lt;/span&gt;
&lt;span class="c1"&gt;# Filename      : checkupdate.sh&lt;/span&gt;
&lt;span class="c1"&gt;# Describle     : To Check update of svn&lt;/span&gt;

&lt;span class="k"&gt;while&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;true&lt;/span&gt;
&lt;span class="k"&gt;do&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/code/python
&lt;span class="w"&gt;        &lt;/span&gt;svn&lt;span class="w"&gt; &lt;/span&gt;up&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;At&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/dev/null&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&amp;gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$?&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-eq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;sleep&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;fi&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;svn&lt;span class="w"&gt; &lt;/span&gt;up&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;Updated&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/dev/null&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&amp;gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$?&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-eq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;/etc/init.d/uwsgi.py&lt;span class="w"&gt; &lt;/span&gt;restart
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;fi&lt;/span&gt;
&lt;span class="k"&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Linux"></category><category term="æ£€æµ‹"></category><category term="æ–‡ä»¶"></category><category term="å®æ—¶"></category><category term="å˜æ›´"></category><category term="uwsgi"></category><category term="shell"></category><category term="python"></category><category term="Linux"></category><category term="bottle"></category></entry><entry><title>Gentooä¸‹æ­å»ºpython webç¯å¢ƒ(nginx+bottle+virtualenv+uwsgi)</title><link href="https://www.linuxzen.com/gentooxia-da-jian-python-webhuan-jing-nginxbottlevirtualenvuwsgi.html" rel="alternate"></link><published>2012-05-16T11:05:00+08:00</published><updated>2012-05-16T11:05:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-05-16:/gentooxia-da-jian-python-webhuan-jing-nginxbottlevirtualenvuwsgi.html</id><summary type="html">&lt;p&gt;æœ€è¿‘æ ¹æ®Gentooå®˜æ–¹æ–‡æ¡£æ•´äº†ä¸€å°Gentooçš„è™šæ‹Ÿæœº,æ„Ÿè§‰è¿˜æ˜¯ä¸é”™çš„,å†³å®šæ”¾å¼ƒCentOSæŠ•å¥”Gentoo,è¿™å‡ å¤©ç ”ç©¶NoSQL mongodbå’Œpythonçš„bottleæ¡†æ¶,web.pyæ•ˆç‡ä¸æ˜¯å¾ˆå¥½,è€Œä¸”æ˜¯ç±»çº§,bottleä½¿ç”¨è£…é¥°å™¨(è™½ç„¶å¯¹å¥¹è¿˜æ˜¯æ‡µæ‡‚é˜¶æ®µ,ä½†æ˜¯è²Œä¼¼å¾ˆå¼ºå¤§).æ„Ÿ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;æœ€è¿‘æ ¹æ®Gentooå®˜æ–¹æ–‡æ¡£æ•´äº†ä¸€å°Gentooçš„è™šæ‹Ÿæœº,æ„Ÿè§‰è¿˜æ˜¯ä¸é”™çš„,å†³å®šæ”¾å¼ƒCentOSæŠ•å¥”Gentoo,è¿™å‡ å¤©ç ”ç©¶NoSQL mongodbå’Œpythonçš„bottleæ¡†æ¶,web.pyæ•ˆç‡ä¸æ˜¯å¾ˆå¥½,è€Œä¸”æ˜¯ç±»çº§,bottleä½¿ç”¨è£…é¥°å™¨(è™½ç„¶å¯¹å¥¹è¿˜æ˜¯æ‡µæ‡‚é˜¶æ®µ,ä½†æ˜¯è²Œä¼¼å¾ˆå¼ºå¤§).æ„Ÿè§‰bottleæ›´åŠ å¼ºå¤§å’Œæ¥è¿‘python,æ²¡æœ‰å°è£…å¤ªå¤šä¸œè¥¿,djangoåªèƒ½ä¾ç…§å¥¹çš„æ€æƒ³æ¥åšè‡ªå·±çš„äº‹,æœ€åè¿˜æ˜¯é€‰æ‹©äº†bottleæ¥è¿›å…¥pythonçš„webä¸–ç•Œ,webæœåŠ¡å™¨åŒæ ·é€‰æ‹©nginx.virtualenvå¯ä»¥è®©ä¸€ä¸ªåº”ç”¨æœ‰ä¸€ä¸ªç›¸å¯¹ç‹¬ç«‹çš„ç¯å¢ƒ,ç‰¹åˆ«ç”¨äºå¤šè§£é‡Šå™¨ç¯å¢ƒæˆ–è€…ç»å¸¸å˜æ›´çš„ç¯å¢ƒ.uwsgiæ˜¯webå’Œpythonçš„ä¸­é—´ä»¶(å¯ä»¥è¿™ä¹ˆè§£é‡Šå§).&lt;/p&gt;
&lt;h2 id="_1"&gt;ç¯å¢ƒ:&lt;/h2&gt;
&lt;p&gt;ç³»ç»Ÿ:Gentoo
ip:192.168.3.1&lt;/p&gt;
&lt;p&gt;å¥½å§åºŸè¯ä¸å¤šè¯´,Gentooå®‰è£…è¿‡ç¨‹è¿™é‡Œä¸å†è¯¦è¿°,å®˜æ–¹æ–‡æ¡£å¾ˆè¯¦ç»†,ä¸‹é¢è®°å½•å®‰è£…é…ç½®è¿‡ç¨‹.
é¦–å…ˆGentooæ²¡æœ‰é»˜è®¤å®‰è£…vim,å…ˆå®‰è£…vim:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;emerge&lt;/span&gt; &lt;span class="n"&gt;vim&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="python"&gt;å®‰è£…é…ç½®Python&lt;/h3&gt;
&lt;p&gt;æœ€æ–°ç‰ˆçš„Gentooå®‰è£…å®Œæ¯•åé»˜è®¤ä½¿ç”¨python3.2,è€Œæˆ‘æƒ¯ç”¨Python2.7.å…ˆé¦–å…ˆå®‰è£…python2.7.
Gentooä½¿ç”¨emergeåŒ…ç®¡ç†,å®‰è£…Python2.7:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/usr/portage/dev-lang/python/
emerge&lt;span class="w"&gt; &lt;/span&gt;python-2.7.2-r3.ebuild
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç­‰å¾…å®‰è£…å®Œæˆåä½¿ç³»ç»Ÿé»˜è®¤ä½¿ç”¨python2.7,å…ˆæŸ¥çœ‹é»˜è®¤é¡¹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;eselect python list
Available Python interpreters:
  [1]   python2.7 
  [2]   python3.2 *
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é»˜è®¤ä½¿ç”¨3.2,é€‰æ‹©python2.7&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;eselect&lt;span class="w"&gt; &lt;/span&gt;python&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é€‰æ‹©è¿‡ååˆ«å¿˜è®°æ‰§è¡Œ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;python-updater
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¥½äº†æˆ‘å·²ç»å°†pythonæ¢æˆäº†å¸¸ç”¨çš„python2.7,ä¸‹é¢æ¥å®‰è£…easy_install:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;emerge&lt;span class="w"&gt; &lt;/span&gt;setuptools
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…å®Œåä½¿ç”¨easy_installå®‰è£…bottleæ¡†æ¶å’Œmongodbé©±åŠ¨:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;easy_install&lt;span class="w"&gt; &lt;/span&gt;bottle
easy_install&lt;span class="w"&gt; &lt;/span&gt;pymogon
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…uwsgi/nginx/virtualenv:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;emerge&lt;span class="w"&gt; &lt;/span&gt;nginx
emerge&lt;span class="w"&gt; &lt;/span&gt;uwsgi
emerge&lt;span class="w"&gt; &lt;/span&gt;virtualenv
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="virtualenv"&gt;ä½¿ç”¨virtualenvåˆ›å»ºåº”ç”¨&lt;/h3&gt;
&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨virtualenvåˆ›å»ºä¸€ä¸ªåº”ç”¨:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mkdir&lt;span class="w"&gt; &lt;/span&gt;/code/python
virtualenv&lt;span class="w"&gt; &lt;/span&gt;/code/python
&lt;span class="nb"&gt;source&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;bin/activate
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæŸ¥çœ‹åº”ç”¨ç›®å½•ä¸‹ä¼šå¤šå‡ºå‡ ä¸ªç›®å½•.&lt;/p&gt;
&lt;h3 id="uwsgi"&gt;é…ç½®uWSGI&lt;/h3&gt;
&lt;p&gt;é¦–å…ˆåˆ›å»ºä¸€ä¸ªuwsgié…ç½®æ–‡ä»¶,å¹¶ç¼–è¾‘å®ƒ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;cp&lt;span class="w"&gt; &lt;/span&gt;/etc/conf.d/uwsgi&lt;span class="w"&gt; &lt;/span&gt;/etc/conf.d/uwsgi.py
vi&lt;span class="w"&gt; &lt;/span&gt;/etc/conf.d/uwsgi.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ”¹æˆå†…å¦‚å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# Distributed under the terms of the GNU General Public License v2&lt;/span&gt;
&lt;span class="c1"&gt;# $Header: /var/cvsroot/gentoo-x86/www-servers/uwsgi/files/uwsgi.confd,v 1.1 2011/05/31 19:49:07 maksbotan Exp $&lt;/span&gt;

&lt;span class="c1"&gt;# DO NOT MODIFY THIS FILE DIRECTLY! CREATE A COPY AND MODIFY THAT INSTEAD!&lt;/span&gt;

&lt;span class="c1"&gt;# Path (or name) of UNIX/TCP socket to bind to&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="n"&gt;UWSGI_SOCKET&lt;/span&gt;&lt;span class="o"&gt;=/&lt;/span&gt;&lt;span class="k"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bottle&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="c1"&gt;# ä½¿ç”¨unix socket&lt;/span&gt;

&lt;span class="c1"&gt;# Enable threads?&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="n"&gt;UWSGI_THREADS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;

&lt;span class="c1"&gt;# The path to your uWSGI application.&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#UWSGI_PROGRAM=&lt;/span&gt;

&lt;span class="c1"&gt;# The path to your uWSGI xml config file.&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="n"&gt;UWSGI_XML_CONFIG&lt;/span&gt;&lt;span class="o"&gt;=/&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bottle&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;xml&lt;/span&gt;&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="c1"&gt;# ä½¿ç”¨xmlé…ç½®æ–‡ä»¶&lt;/span&gt;

&lt;span class="c1"&gt;# The number of child processes to spawn. The default is 1.&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="n"&gt;UWSGI_CHILDREN&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;

&lt;span class="c1"&gt;# The log file path. If empty logging is disabled&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="n"&gt;UWSGI_LOG_FILE&lt;/span&gt;&lt;span class="o"&gt;=/&lt;/span&gt;&lt;span class="k"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nb"&gt;log&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;uwsgi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="w"&gt;                    &lt;/span&gt;&lt;span class="c1"&gt;# å®šä¹‰æ—¥å¿—&lt;/span&gt;

&lt;span class="c1"&gt;# If you want to run your application inside a chroot then specify the&lt;/span&gt;
&lt;span class="c1"&gt;# directory here. Leave this blank otherwise.&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#UWSGI_CHROOT=/code/python&lt;/span&gt;

&lt;span class="c1"&gt;# If you want to run your application from a specific directiory specify&lt;/span&gt;
&lt;span class="c1"&gt;# it here. Leave this blank otherwise.&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;# UWSGI_DIR=&lt;/span&gt;

&lt;span class="c1"&gt;# The user and group to run your application as. If you do not specify these,&lt;/span&gt;
&lt;span class="c1"&gt;# the application will be run as root:root.&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="n"&gt;UWSGI_USER&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;

&lt;span class="c1"&gt;# Additional options you might want to pass to uWSGI&lt;/span&gt;
&lt;span class="c1"&gt;#&lt;/span&gt;
&lt;span class="c1"&gt;#UWSGI_EXTRA_OPTIONS=&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶ååˆ›å»ºbottle.xmlé…ç½®æ–‡ä»¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/code/bottle.xml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å†…å®¹å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nt"&gt;&amp;lt;uwsgi&amp;gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;socket&amp;gt;&lt;/span&gt;/var/tmp/bottle.sock&lt;span class="nt"&gt;&amp;lt;/socket&amp;gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;home&amp;gt;&lt;/span&gt;/code/python&lt;span class="nt"&gt;&amp;lt;/home&amp;gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;chdir&amp;gt;&lt;/span&gt;/code/python&lt;span class="nt"&gt;&amp;lt;/chdir&amp;gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;python-path&amp;gt;&lt;/span&gt;/code/python&lt;span class="nt"&gt;&amp;lt;/python-path&amp;gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;module&amp;gt;&lt;/span&gt;index&lt;span class="nt"&gt;&amp;lt;/module&amp;gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;master/&amp;gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;memory/&amp;gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;logto&amp;gt;&lt;/span&gt;/var/log/bottle.log&lt;span class="nt"&gt;&amp;lt;/logto&amp;gt;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;&amp;lt;daemonize&amp;gt;&lt;/span&gt;/var/log/uwsgi.log&lt;span class="nt"&gt;&amp;lt;/daemonize&amp;gt;&lt;/span&gt;
&lt;span class="nt"&gt;&amp;lt;/uwsgi&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å…¶ä¸­&lt;module&gt;&lt;/module&gt;å®šä¹‰çš„å°±æ˜¯ä½ çš„webç¨‹åº,ä¹Ÿå°±æ˜¯/code/pythonä¸‹è¦æœ‰ä¸€ä¸ªindex.py.&lt;/p&gt;
&lt;p&gt;é…ç½®å®Œæ¯•ååˆ›å»ºå¯åŠ¨è„šæœ¬:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ln -sf /etc/init.d/uwsgi /etc/init.d/uwsgi.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¹¶åŠ å…¥å¼€æœºå¯åŠ¨:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;rc-update add uwsgi.py default
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="nginx"&gt;é…ç½®nginx&lt;/h3&gt;
&lt;p&gt;ç¼–è¾‘é…ç½®æ–‡ä»¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi /etc/nginx/nginx.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¿®æ”¹å†…å®¹å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;listen&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.168&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;3.1&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;server_name&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linuxzen&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;access_log&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nb"&gt;log&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;nginx&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;localhost&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;access_log&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;main&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;error_log&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nb"&gt;log&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;nginx&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;localhost&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;error_log&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;info&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;python&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;location&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;uwsgi_params&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;uwsgi_param&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;UWSGI_PYTHOME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;python&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;uwsgi_param&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;UWSGI_CHDIR&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;python&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;                               &lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;uwsgi_param&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;UWSGI_SCRIPT&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;uwsgi_pass&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bottle&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åŒæ ·å°†nginxä½œä¸ºå¼€æœºå¯åŠ¨:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;rc-update add nginx default
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="_2"&gt;æµ‹è¯•&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆåˆ›å»ºä¸€ä¸ªbottleç¨‹åºä¾›æµ‹è¯•:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;vi&lt;/span&gt; &lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;code&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;python&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;py&lt;/span&gt;
&lt;span class="n"&gt;å‚è€ƒå†…å®¹å¦‚ä¸‹&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="c1"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c1"&gt;#-*- coding: utf8 -*-&lt;/span&gt;

&lt;span class="sd"&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class="sd"&gt;# Author    : cold night&lt;/span&gt;
&lt;span class="sd"&gt;# Filename  : index.py                                                          &lt;/span&gt;
&lt;span class="sd"&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;bottle&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;route&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;default_app&lt;/span&gt;

&lt;span class="nd"&gt;@route&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;index&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Hello world!&amp;quot;&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;host&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;localhost&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;8888&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;application&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;default_app&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åå¯åŠ¨nginxå’Œuwsgi:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;/etc/init.d/nginx start
/etc/init.d/uwsgi.py start
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åé€šè¿‡æµè§ˆå™¨è®¿é—®å³å¯çœ‹åˆ°&lt;code&gt;Hello world!&lt;/code&gt;&lt;/p&gt;</content><category term="Linux"></category><category term="web"></category><category term="virtualenv"></category><category term="uwsgi"></category><category term="python"></category><category term="Gentoo"></category><category term="bottle"></category><category term="nginx"></category></entry><entry><title>iptables:restorecon: command not foundæ— æ³•ä¿å­˜ç­–ç•¥è§£å†³</title><link href="https://www.linuxzen.com/iptablesrestorecon-command-not-foundwu-fa-bao-cun-ce-lue-jie-jue.html" rel="alternate"></link><published>2012-04-30T10:43:00+08:00</published><updated>2012-04-30T10:43:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-04-30:/iptablesrestorecon-command-not-foundwu-fa-bao-cun-ce-lue-jie-jue.html</id><summary type="html">&lt;p&gt;ä»Šå¤©æ›´æ–°äº†å‡ æ¡iptables,ä½†æ˜¯è¿è¡Œå‘½ä»¤&lt;code&gt;service iptables save&lt;/code&gt;ä¿å­˜æ—¶ç¡®æç¤º&lt;code&gt;iptables: Saving firewall rules to /etc/sysconfig/iptables: /etc/init.d/iptables: line 268: restorecon: command not found&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å¥½å§,å¾ˆæ˜æ˜¾çš„é”™è¯¯,æ‰¾ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;ä»Šå¤©æ›´æ–°äº†å‡ æ¡iptables,ä½†æ˜¯è¿è¡Œå‘½ä»¤&lt;code&gt;service iptables save&lt;/code&gt;ä¿å­˜æ—¶ç¡®æç¤º&lt;code&gt;iptables: Saving firewall rules to /etc/sysconfig/iptables: /etc/init.d/iptables: line 268: restorecon: command not found&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;å¥½å§,å¾ˆæ˜æ˜¾çš„é”™è¯¯,æ‰¾ä¸åˆ°restoreconå‘½ä»¤. æŸ¥æ‰¾ä¸€ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;which restorecon
whereis restorecon
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ²¡ç»“æœ,ç»§ç»­æ‰‹åŠ¨æŸ¥çœ‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;ls&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sbin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;Â¦&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;grep&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;restore&lt;/span&gt;
&lt;span class="n"&gt;lrwxrwxrwx&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;58&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;iptables&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;restore&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;iptables&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;multi&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æœ‰ä¸€æ¡ä½†æ˜¯ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„,çŒœæµ‹å¤§æ¦‚æ˜¯åŒ…æ²¡è£…
å…ˆyumæœç´¢ä¸€ä¸‹å§:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum search restorecon
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¥½å§ä¾ç„¶æ²¡æœ‰ç»“æœ.googleä¸€ä¸‹è¯´æ˜¯ç¼ºå°‘policycoreutilsè¿™ä¸ªåŒ….å®‰è£…è¿™ä¸ªåŒ…:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum -y install policycoreutils
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæŸ¥çœ‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;ls&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sbin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;l&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;Â¦&lt;/span&gt;&lt;span class="n"&gt;grep&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;restore&lt;/span&gt;
&lt;span class="n"&gt;lrwxrwxrwx&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="mi"&gt;14&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;09&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;58&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;iptables&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;restore&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;iptables&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;multi&lt;/span&gt;
&lt;span class="n"&gt;lrwxrwxrwx&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mi"&gt;8&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;restorecon&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;setfiles&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åè¿è¡Œå‘½ä»¤ä¿å­˜iptablesç­–ç•¥:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;service iptables save
iptables: Saving firewall rules to /etc/sysconfig/iptables: [  OK  ]
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åªæ˜¯ä¸€ç¯‡ç¬”è®°,è®°å½•é—®é¢˜æ–¹ä¾¿ä»¥åé‡åˆ°é—®é¢˜åæŸ¥æ‰¾.æœ‰ç‚¹ä¹±.æ²¡å¤šå°‘å†…å®¹.&lt;/p&gt;</content><category term="Linux"></category><category term="é˜²ç«å¢™"></category><category term="ç­–ç•¥"></category><category term="æ— æ³•ä¿å­˜"></category><category term="restorecon"></category><category term="iptables"></category></entry><entry><title>ç”¨Pythonå†™çš„ç»ˆç«¯ä¸‹çš„ç¿»è¯‘å·¥å…·</title><link href="https://www.linuxzen.com/yong-pythonxie-de-zhong-duan-xia-de-fan-yi-gong-ju.html" rel="alternate"></link><published>2012-04-23T23:23:00+08:00</published><updated>2012-04-23T23:23:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-04-23:/yong-pythonxie-de-zhong-duan-xia-de-fan-yi-gong-ju.html</id><summary type="html">&lt;p&gt;ä¸ºä»€ä¹ˆå†™è¿™ä¸ªç¨‹åº,ä¸ºä»€ä¹ˆä¸ç»™è¿™ä¸ªç¨‹åºé…å¤‡gui?åŸå› å¾ˆç®€å•,å› ä¸ºæˆ‘æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œæ§,Linuxä¹ æƒ¯äº†ä¸ä¹ æƒ¯äº†é¼ æ ‡,æ€»è§‰å¾—ç‚¹ç€ä¸å¦‚æ•²å‘½ä»¤å¿«,å„ä½åœ¨ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;ä¸ºä»€ä¹ˆå†™è¿™ä¸ªç¨‹åº,ä¸ºä»€ä¹ˆä¸ç»™è¿™ä¸ªç¨‹åºé…å¤‡gui?åŸå› å¾ˆç®€å•,å› ä¸ºæˆ‘æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œæ§,Linuxä¹ æƒ¯äº†ä¸ä¹ æƒ¯äº†é¼ æ ‡,æ€»è§‰å¾—ç‚¹ç€ä¸å¦‚æ•²å‘½ä»¤å¿«,å„ä½åœ¨çœ‹è¿™ç¯‡æ–‡ç« å°±è¯´æ˜å’Œæœ¬äººæœ‰ç›¸åŒçš„çˆ±å¥½.è¿™ä¸ªç”¨pythonå†™çš„ç¿»è¯‘å·¥å…·æ˜¯é€šè¿‡googleæ¥å®ç°çš„,ç”±äºgoogleè¿”å›çš„æ•°æ®ä¸æ˜¯å¾ˆè§„èŒƒ(æˆ–è€…è¯´æˆ‘æ²¡æœ‰æ‰¾åˆ°è§„å¾‹),ç°åœ¨å‰ä¸‰é¡¹èƒ½æ­£å¸¸æ˜¾ç¤º(æºè¯,ç¿»è¯‘ç»“æœ,å’Œæ±‰è¯­æ‹¼éŸ³).ä¸‹é¢çš„è¯æ€§å’Œå…¶ä»–é‡Šä¹‰å¯èƒ½ä¸åŒ,è§è°…,æœ›å¤§ç¥å¯ä»¥æŒ‡ç‚¹ä¸‹å°å¼Ÿå’Œå¸®å°å¼Ÿå®Œå–„,è¿™é‡Œèµ¶ç´§ä¸å°½.&lt;/p&gt;
&lt;p&gt;å¥½äº†ä¸è´¹è¯äº†,ä¸‹é¢æ”¾ä»£ç :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c1"&gt;# -*-coding:utf8 -*-&lt;/span&gt;
&lt;span class="sd"&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class="sd"&gt;#=============================================================================&lt;/span&gt;
&lt;span class="sd"&gt;#     FileName: translate.py&lt;/span&gt;
&lt;span class="sd"&gt;#         Desc: To translate with zh to en or en2zh&lt;/span&gt;
&lt;span class="sd"&gt;#       Author: cold&lt;/span&gt;
&lt;span class="sd"&gt;#        Email: wh_linux@126.com&lt;/span&gt;
&lt;span class="sd"&gt;#     HomePage: http://www.linuxzen.com&lt;/span&gt;
&lt;span class="sd"&gt;#      Version: 0.0.1&lt;/span&gt;
&lt;span class="sd"&gt;#   LastChange: 2012-04-23 23:04:08&lt;/span&gt;
&lt;span class="sd"&gt;#      History:&lt;/span&gt;
&lt;span class="sd"&gt;#=============================================================================&lt;/span&gt;
&lt;span class="sd"&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;

&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;urllib&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;urllib2&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;re&lt;/span&gt;

&lt;span class="c1"&gt;# æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;helpinfo&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class="s1"&gt;Usage: pytran {zh2enÂ¦en2zh} content&lt;/span&gt;
&lt;span class="s1"&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class="c1"&gt;# æ ¼å¼åŒ–è¾“å‡º&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;formatresult&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;srclang&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="n"&gt;resu&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;[[&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;srclang&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;en2zh&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="n"&gt;srclang&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;zh2en&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="n"&gt;firstre&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;resu&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;[&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;]&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;æºè¯:&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;firstre&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;ç»“æœ:&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;firstre&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;srclang&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;zh2en&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="n"&gt;piny&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;firstre&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;7&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;piny&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;firstre&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;æ‹¼éŸ³:&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;piny&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;srclang&lt;/span&gt;&lt;span class="o"&gt;==&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;zh2en&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="n"&gt;secresu&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;resu&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;[&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;secresu&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;resu&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;[&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;è¯æ€§:&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;secresu&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;replace&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;å…¶ä»–é‡Šä¹‰:&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;secresu&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;]&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt;

&lt;span class="c1"&gt;# è·å–å‘½ä»¤è¡Œå‚æ•°&lt;/span&gt;
&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;srclang&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;helpinfo&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;cont&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;helpinfo&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# åˆ¤æ–­ç¿»è¯‘ç›®æ ‡è¯­è¨€ç”¨æ¥ç¡®å®šä¼ é€å‚æ•°&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;srclang&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;zh2en&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;urllib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;urlencode&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;client&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;t&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;text&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="s1"&gt;&amp;#39;hl&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;zh-CN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;tl&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;en&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="s1"&gt;&amp;#39;multires&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;prev&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;btn&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="s1"&gt;&amp;#39;ssel&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;sc&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;span class="k"&gt;elif&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;srclang&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;en2zh&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;urllib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;urlencode&lt;/span&gt;&lt;span class="p"&gt;({&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;client&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;t&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;text&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="n"&gt;cont&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="s1"&gt;&amp;#39;hl&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;zh-CN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;sl&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;en&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;tl&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;zh-CN&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="s1"&gt;&amp;#39;multires&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;prev&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;btn&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;span class="s1"&gt;&amp;#39;ssel&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;0&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;sc&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;})&lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;helpinfo&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c1"&gt;# æ‰“å¼€googleç¿»è¯‘å†…å®¹&lt;/span&gt;
&lt;span class="n"&gt;url&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;http://translate.google.cn/translate_a/t&amp;#39;&lt;/span&gt;
&lt;span class="n"&gt;req&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;urllib2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;Request&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;url&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;req&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;add_header&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;User-Agent&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Mozilla/5.0+(compatible;+Googlebot/2.1;++http://www.google.com/bot.html)&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;fd&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;urllib2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;urlopen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;req&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;result&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

&lt;span class="c1"&gt;# æ ¼å¼åŒ–è¾“å‡º&lt;/span&gt;
&lt;span class="n"&gt;formatresult&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;srclang&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸ºäº†æ›´æ–¹ä¾¿çš„ä½¿ç”¨æˆ‘ä»¬æŠŠè¿™ä¸ªè„šæœ¬å‘½åä½pytranslate,æ”¾åˆ°/usr/binä¸‹,å¹¶èµ‹äºˆæ‰§è¡Œæƒé™:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;chmod +x /usr/bin/pytranslate
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨å®ƒè¿›è¡Œç¿»è¯‘äº†:
ç¿»è¯‘è‹±æ–‡åˆ°ä¸­æ–‡:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;pytranslate en2zh extent
æºè¯: extent
ç»“æœ: ç¨‹åº¦
æ‹¼éŸ³: ChÃ©ngdÃ¹
è¯æ€§: åè¯
å…¶ä»–é‡Šä¹‰:
ç¨‹åº¦
èŒƒå›´
å¹…åº¦
è§„æ¨¡
åº¦
åœ°æ­¥
å¹¿åº¦
é•¿åº¦
é¢
é•¿çŸ­
ä»½å„¿
ç•Œ
en
ç¿»è¯‘ä¸­æ–‡åˆ°è‹±æ–‡
pytranslate zh2en ä¸­å›½
æºè¯: ä¸­å›½
ç»“æœ: China
æ‹¼éŸ³: ZhÅngguÃ³
è¯æ€§: åè¯
å…¶ä»–é‡Šä¹‰:
China
zh-CN
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¥½å§ç›¸ä¿¡èªæ˜çš„ä½ è‚¯å®šå‘ç°å¦‚ä½•ä½¿ç”¨äº†è¿™é‡Œå°±ä¸ç½—å—¦äº†.&lt;/p&gt;</content><category term="Python"></category><category term="ç¿»è¯‘"></category><category term="ç»ˆç«¯"></category><category term="python"></category><category term="Linux"></category><category term="google"></category></entry><entry><title>ç”¨pythonå‘å¸¦é™„ä»¶çš„é‚®ä»¶ç”¨æ¥å®šæ—¶å¤‡ä»½mysqlæ•°æ®åº“</title><link href="https://www.linuxzen.com/yong-pythonfa-dai-fu-jian-de-you-jian-yong-lai-ding-shi-bei-fen-mysqlshu-ju-ku.html" rel="alternate"></link><published>2012-04-21T18:26:00+08:00</published><updated>2012-04-21T18:26:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-04-21:/yong-pythonfa-dai-fu-jian-de-you-jian-yong-lai-ding-shi-bei-fen-mysqlshu-ju-ku.html</id><summary type="html">&lt;p&gt;æœ€è¿‘è¿ç§»äº†wordpress,ç³»ç»Ÿå‡çº§ä¸ºCentOS 6,å¾ˆå¥‡æ€ªçš„ä¸€ä¸ªé—®é¢˜,åœ¨åŸæ¥CentOS 5.8ä¸‹ç”¨çš„å¾ˆæ­£å¸¸çš„å®šæ—¶å¤‡ä»½æ•°æ®åº“å¹¶é€šè¿‡é‚®ä»¶å‘é€çš„è„šæœ¬ä¸èƒ½å‘é€é™„ä»¶,å…¶ä»–éƒ½æ­£å¸¸,é‚®ä»¶å†…å®¹ä¹Ÿæ˜¯uuencodeç”Ÿæˆçš„æ–‡ä»¶ç¼–ç ,ä½†æ˜¯å°±æ˜¯ä¸äº§ç”Ÿé™„ä»¶.è€Œä¸” â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;æœ€è¿‘è¿ç§»äº†wordpress,ç³»ç»Ÿå‡çº§ä¸ºCentOS 6,å¾ˆå¥‡æ€ªçš„ä¸€ä¸ªé—®é¢˜,åœ¨åŸæ¥CentOS 5.8ä¸‹ç”¨çš„å¾ˆæ­£å¸¸çš„å®šæ—¶å¤‡ä»½æ•°æ®åº“å¹¶é€šè¿‡é‚®ä»¶å‘é€çš„è„šæœ¬ä¸èƒ½å‘é€é™„ä»¶,å…¶ä»–éƒ½æ­£å¸¸,é‚®ä»¶å†…å®¹ä¹Ÿæ˜¯uuencodeç”Ÿæˆçš„æ–‡ä»¶ç¼–ç ,ä½†æ˜¯å°±æ˜¯ä¸äº§ç”Ÿé™„ä»¶.è€Œä¸”æ‰¾ä¸å‡ºåŸå› ,æœ›æœ‰çŸ¥é“çš„ä¸åèµæ•™.&lt;/p&gt;
&lt;p&gt;ä¸ºäº†è§£å†³è¿™ä¸€é—®é¢˜,æˆ‘ç”¨Pythonå†™äº†ä¸€ä¸ªmailå®¢æˆ·ç«¯,å¯ä»¥å‘é€é™„ä»¶,æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œç¨‹åº.åºŸè¯ä¸å¤šè¯´.è´´ä»£ç :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c1"&gt;#-*- coding: utf8 -*-&lt;/span&gt;
&lt;span class="sd"&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class="sd"&gt;#=============================================================================&lt;/span&gt;
&lt;span class="sd"&gt;#     FileName: mail.py&lt;/span&gt;
&lt;span class="sd"&gt;#         Desc: To send email&lt;/span&gt;
&lt;span class="sd"&gt;#       Author: cold&lt;/span&gt;
&lt;span class="sd"&gt;#        Email: wh_linux@126.com&lt;/span&gt;
&lt;span class="sd"&gt;#     HomePage: http://www.linuxzen.com&lt;/span&gt;
&lt;span class="sd"&gt;#      Version: 0.0.1&lt;/span&gt;
&lt;span class="sd"&gt;#   LastChange: 2012-04-21 16:37:20&lt;/span&gt;
&lt;span class="sd"&gt;#      History:&lt;/span&gt;
&lt;span class="sd"&gt;#=============================================================================&lt;/span&gt;
&lt;span class="sd"&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;

&lt;span class="sd"&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class="sd"&gt;ç”¨äºå‘é€é‚®ä»¶,å¯ä»¥å‘é€é™„ä»¶&lt;/span&gt;
&lt;span class="sd"&gt;å‘½ä»¤è¡Œç¨‹åº&lt;/span&gt;
&lt;span class="sd"&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;smtplib&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;email.mime.text&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;MIMEText&lt;/span&gt;
&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;email.mime.multipart&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;MIMEMultipart&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;sys&lt;/span&gt;



&lt;span class="c1"&gt;# æ‰“å°å¸®åŠ©ä¿¡æ¯&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;helpinfo&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;
&lt;span class="s1"&gt;    Useage: pymail -u user@domain -p passwd -h smtp server host -t to who [-a attachment file path] [-n attachment name]&lt;/span&gt;
&lt;span class="s1"&gt;    Useage: email content use . to end&lt;/span&gt;
&lt;span class="s1"&gt;    -h  specify smtp server host&lt;/span&gt;
&lt;span class="s1"&gt;    -u  which user you login the smtp server,and must with it domain&lt;/span&gt;
&lt;span class="s1"&gt;    -p  the password of the smtp user&lt;/span&gt;
&lt;span class="s1"&gt;    -t  The email recipient,multiple addresses can use &amp;#39;,&amp;#39; split&lt;/span&gt;
&lt;span class="s1"&gt;    -a  Add attachment&lt;/span&gt;
&lt;span class="s1"&gt;    -n  Secify attachment name in the email&lt;/span&gt;

&lt;span class="s1"&gt;    Author:cold(wh_linux@126.com)&lt;/span&gt;
&lt;span class="s1"&gt;    Homepge:http://www.linuxzen.com&lt;/span&gt;
&lt;span class="s1"&gt;    &amp;#39;&amp;#39;&amp;#39;&lt;/span&gt;


&lt;span class="c1"&gt;# æ‰€æœ‰é€‰é¡¹&lt;/span&gt;
&lt;span class="n"&gt;options&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-t&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;-a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;-n&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;-h&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;-u&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;-p&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;-s&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="c1"&gt;# è·å–é€‰é¡¹é•¿åº¦&lt;/span&gt;
&lt;span class="n"&gt;argvnum&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# æ£€æµ‹å‘½ä»¤è¡Œå‚æ•°&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;argvnum&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;options&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Unknow option &amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;, Please use -h see help!&amp;#39;&lt;/span&gt;
            &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# å¦‚æœæ˜¯-hæˆ–è€…æ²¡æœ‰å‘½ä»¤è¡Œå‚æ•°åˆ™æ˜¾ç¤ºå¸®åŠ©&lt;/span&gt;
&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;-h&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;or&lt;/span&gt; &lt;span class="nb"&gt;len&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;helpinfo&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;helpinfo&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;


&lt;span class="c1"&gt;# æ£€æµ‹-nå‚æ•°&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-n&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="ow"&gt;and&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-a&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Error:option &amp;quot;-n&amp;quot; must use after -a&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="c1"&gt;# ä¸‹é¢åˆ™æ˜¯è·å–å„ä¸ªå‚æ•°å†…å®¹&lt;/span&gt;
&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;tmpmailto&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-t&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;  &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;tmpmailto&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;mailto&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tmpmailto&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;,&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;mailto&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;tmpmailto&lt;/span&gt;&lt;span class="p"&gt;,]&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;ValueError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Error: need Mail Recipient&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;exit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;

&lt;span class="n"&gt;haveattr&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;

&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;attrpath&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-a&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;attrname&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-n&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt; &lt;span class="p"&gt;]&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;ValueError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;attrname&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;attrpath&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;attrname&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;
    &lt;span class="n"&gt;haveattr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;
    &lt;span class="n"&gt;attrpath&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;


&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;mail_host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-h&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;ValueError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Waring: No specify smtp server use 127.0.0.1&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;mail_host&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;127.0.0.1&amp;#39;&lt;/span&gt;


&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;mail_useremail&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-u&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;ValueError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Waring: No specify user, use root&amp;#39;&lt;/span&gt;
    &lt;span class="n"&gt;mail_useremail&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;root@localhost&amp;#39;&lt;/span&gt;

&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;mail_sub&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-s&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;mail_sub&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;No Subject&amp;#39;&lt;/span&gt;

&lt;span class="n"&gt;mail_user&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mail_useremail&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;@&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;mail_postfix&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mail_useremail&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;@&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;

&lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;mail_pass&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;argv&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;-p&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;ValueError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
    &lt;span class="n"&gt;mail_pass&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;




&lt;span class="c1"&gt;# å®šä¹‰é‚®ä»¶å‘é€å‡½æ•°&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;send_mail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;to_list&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;sub&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;haveattr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;attrpath&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;attrname&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;me&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;mail_user&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;&amp;lt;&amp;quot;&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;mail_user&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;@&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="n"&gt;mail_postfix&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;gt;&amp;quot;&lt;/span&gt;

    &lt;span class="c1"&gt;# åˆ¤æ–­æ˜¯å¦æœ‰é™„ä»¶&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;haveattr&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="ow"&gt;not&lt;/span&gt; &lt;span class="n"&gt;attrpath&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Error : no input file of attachments&amp;#39;&lt;/span&gt;
            &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;

        &lt;span class="c1"&gt;# æœ‰é™„ä»¶åˆ™åˆ›å»ºä¸€ä¸ªå¸¦é™„ä»¶çš„å®ä¾‹&lt;/span&gt;
        &lt;span class="n"&gt;msg&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MIMEMultipart&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;

        &lt;span class="c1"&gt;# æ„é€ é™„ä»¶&lt;/span&gt;
        &lt;span class="n"&gt;att&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MIMEText&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;open&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;attrpath&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;rb&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(),&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;base64&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;utf8&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;att&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Content-Type&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;application/octest-stream&amp;#39;&lt;/span&gt;
        &lt;span class="n"&gt;att&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Content-Disposition&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;attachment;filename=&amp;quot;&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="n"&gt;attrname&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;quot;&amp;#39;&lt;/span&gt;
        &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;attach&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;att&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;attach&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;MIMEText&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="c1"&gt;# æ— è´£åˆ›å»ºä¸€ä¸ªæ–‡æœ¬çš„å®ä¾‹&lt;/span&gt;
        &lt;span class="n"&gt;msg&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;MIMEText&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;


    &lt;span class="c1"&gt;# é‚®ä»¶å¤´&lt;/span&gt;
    &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Subject&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sub&lt;/span&gt;
    &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;From&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;me&lt;/span&gt;
    &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;To&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;;&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;join&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;to_list&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="c1"&gt;# å‘é€é‚®ä»¶&lt;/span&gt;
        &lt;span class="n"&gt;s&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;smtplib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SMTP&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mail_host&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mail_host&lt;/span&gt; &lt;span class="o"&gt;!=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;127.0.0.1&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
            &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;login&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mail_user&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mail_pass&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendmail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;me&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;to_list&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;msg&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;as_string&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
        &lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;Exception&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="nb"&gt;str&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;e&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="kc"&gt;False&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__main__&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;

    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;
        &lt;span class="k"&gt;while&lt;/span&gt; &lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;raw_input&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
            &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
                &lt;span class="k"&gt;break&lt;/span&gt;
            &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;c&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;&lt;span class="se"&gt;\n&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;&lt;/span&gt;
    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="ne"&gt;EOFError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;sys&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;stdin&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
            &lt;span class="n"&gt;content&lt;/span&gt; &lt;span class="o"&gt;+=&lt;/span&gt; &lt;span class="n"&gt;line&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;send_mail&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;mailto&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mail_sub&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;content&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;haveattr&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;attrpath&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;attrname&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Success&amp;quot;&lt;/span&gt;
    &lt;span class="k"&gt;else&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="nb"&gt;print&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Failed&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å°†è¿™ä¸ªè„šæœ¬ä¿å­˜ä¸ºpymailæ”¾åˆ°/usr/bin/ä¸‹,å¹¶èµ‹äºˆå…¶æ‰§è¡Œæƒé™:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;chmod +x /usr/bin/pymail
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¯ä»¥ä½¿ç”¨ -hæŒ‡å®šsmtpå‘ä»¶æœåŠ¡å™¨,é»˜è®¤è®¤ä¸ºæŒ‡å®š-héœ€è¦è®¤è¯, æ‰€ä»¥å°±éœ€è¦smtpæœåŠ¡å™¨æ”¯æŒè®¤è¯,åŒæ—¶éœ€è¦-uæŒ‡å®šç”¨æˆ·å(éœ€åŠ "@åŸŸå"),-pæŒ‡å®šå¯†ç .
å¦‚æœä¸æŒ‡å®š-hå°±ä¼šä½¿ç”¨æœ¬åœ°smtpæœåŠ¡å™¨,é»˜è®¤ä¸éœ€è¦è®¤è¯,æ‰€ä»¥æœ¬åœ°çš„smtpæœåŠ¡å™¨å°±ä¸èƒ½æ”¯æŒè®¤è¯,åŒæ—¶ä¸éœ€æŒ‡å®š-u,-på‚æ•°&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;-t æŒ‡å®šæ”¶ä»¶äººå¤šä¸ªå¯ç”¨,å·åˆ†å‰².
-a æŒ‡å®šé™„ä»¶è·¯å¾„
-n æŒ‡å®šé™„ä»¶å(å¯çœç•¥)
-h æ˜¾ç¤ºå¸®åŠ©ä¿¡æ¯.
-s æŒ‡å®šé‚®ä»¶ä¸»é¢˜
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ‰§è¡Œåä¼šè¦æ±‚è¾“å…¥é‚®ä»¶å†…å®¹,å†™å®Œç”¨.ç»“æŸ
ä¹Ÿå¯ä»¥ç”¨ç®¡é“ä¸‹é¢ç»™å‡ºå‡ ä¸ªå®ä¾‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;#ä½¿ç”¨æœ¬åœ°smtpæœåŠ¡å‘é€&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;linuxzen.com backup&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;pymail&lt;span class="w"&gt; &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Linuxzen backup&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-t&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;123456&lt;/span&gt;@qq.com&lt;span class="w"&gt; &lt;/span&gt;-a&lt;span class="w"&gt; &lt;/span&gt;/tmp/linuxzen.tar.gz
&lt;span class="c1"&gt;# ä½¿ç”¨126é‚®ç®±å‘é€&lt;/span&gt;
&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;linuxzen.com backup&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;pymail&lt;span class="w"&gt; &lt;/span&gt;-u&lt;span class="w"&gt; &lt;/span&gt;linuxzen@126.com&lt;span class="w"&gt; &lt;/span&gt;-p&lt;span class="w"&gt; &lt;/span&gt;linuxzen.com&lt;span class="w"&gt; &lt;/span&gt;-h&lt;span class="w"&gt; &lt;/span&gt;smtp.126.com&lt;span class="w"&gt; &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Linuxzen backup &amp;quot; -t 123456@qq.com -a /tmp/linuxzen.tar.gz &lt;/span&gt;

&lt;span class="s1"&gt;# ä¸ä½¿ç”¨ç®¡é“å‘é€&lt;/span&gt;
&lt;span class="s1"&gt;pymail -u linuxzen@126.com -p linuxzen.com -h smtp.126.com -s &amp;#39;&lt;/span&gt;hello&lt;span class="w"&gt; &lt;/span&gt;world&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-t&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;123456&lt;/span&gt;@qq.com&lt;span class="w"&gt; &lt;/span&gt;-a&lt;span class="w"&gt; &lt;/span&gt;/tmp/linuxzen.tar.gz
Hello
this&lt;span class="w"&gt; &lt;/span&gt;is&lt;span class="w"&gt; &lt;/span&gt;a&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;test&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;mail
.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸‹é¢ä¹‹å‰ä½¿ç”¨çš„mysqlå®šæ—¶å¤‡ä»½çš„è„šæœ¬:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;PATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/usr/kerberos/sbin:/usr/kerberos/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin
&lt;span class="nv"&gt;DATE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;date&lt;span class="w"&gt; &lt;/span&gt;+%Y%m%d&lt;span class="sb"&gt;`&lt;/span&gt;
mysqldump&lt;span class="w"&gt; &lt;/span&gt;-u&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;blogdata&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/tmp/blogdate.&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$DATE&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;.sql
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/tmp
tar&lt;span class="w"&gt; &lt;/span&gt;-zcf&lt;span class="w"&gt; &lt;/span&gt;blogdata.&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$DATE&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;.sql.tar.gz&lt;span class="w"&gt; &lt;/span&gt;blogdata.&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$DATE&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;.sql
uuencode&lt;span class="w"&gt; &lt;/span&gt;blogdata.&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$DATE&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;.sql.tar.gz&lt;span class="w"&gt; &lt;/span&gt;blogdata.&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$DATE&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;.sql.tar.gz&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;mail&lt;span class="w"&gt; &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MySQL Backup&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;123456&lt;/span&gt;@qq.com
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ²¡æœ‰å‘½ä»¤uuencodeå®‰è£…sharutilsåŒ…å³å¯&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum -y install sharutils
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åä½¿ç”¨crontabè°ƒç”¨è¿™ä¸ªè„šæœ¬å®šæ—¶æ‰§è¡Œ,å‰é¢è¯´äº† è¿™ä¸ªè„šæœ¬åœ¨CentOS5.xä¸‹æ­£å¸¸å·¥ä½œ,ä½†æ˜¯æ”¾åˆ°CentOS6ä¸‹å°±ä¸å¸¦é™„ä»¶,æ‰€ä»¥ä½¿ç”¨æˆ‘ä»¬è‡ªå·±ç¼–å†™çš„pythonè„šæœ¬è„šæœ¬å†…å®¹å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;PATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/usr/kerberos/sbin:/usr/kerberos/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin
&lt;span class="nv"&gt;DATE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;date&lt;span class="w"&gt; &lt;/span&gt;+%Y%m%d&lt;span class="sb"&gt;`&lt;/span&gt;
mysqldump&lt;span class="w"&gt; &lt;/span&gt;-u&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;blogdata&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/tmp/myblog.&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$DATE&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;.sql
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/tmp
tar&lt;span class="w"&gt; &lt;/span&gt;-zcf&lt;span class="w"&gt; &lt;/span&gt;blogdata.&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$DATE&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;.sql.tar.gz&lt;span class="w"&gt; &lt;/span&gt;myblog.&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$DATE&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;.sql
&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MySQL backup&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;pymail&lt;span class="w"&gt; &lt;/span&gt;-u&lt;span class="w"&gt; &lt;/span&gt;linuzen@126.com&lt;span class="w"&gt; &lt;/span&gt;-p&lt;span class="w"&gt; &lt;/span&gt;linuxzen.com&lt;span class="w"&gt; &lt;/span&gt;-h&lt;span class="w"&gt; &lt;/span&gt;smtp.126.com&lt;span class="w"&gt; &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;MySQL backup&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-a&lt;span class="w"&gt; &lt;/span&gt;/tmp/blogdata.&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$DATE&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;.sql.tar.gz&lt;span class="w"&gt; &lt;/span&gt;-t&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;123456&lt;/span&gt;@qq.com
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨126é‚®ç®±æ¥å‘é€ è¿™æ ·å°±å¯ä»¥æŠŠè‡ªå¸¦çš„sendmail åœæ‰:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;service sendmail stop
chkonfig --del sendmail
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Python"></category><category term="é™„ä»¶"></category><category term="é‚®ä»¶"></category><category term="å®šæ—¶"></category><category term="å¤‡ä»½"></category><category term="python"></category><category term="pymail"></category><category term="MySQL"></category><category term="mail"></category></entry><entry><title>CentOSä¸‹æ­å»ºpython webç”Ÿäº§ç¯å¢ƒ(nginx+web.py+uwsgi)</title><link href="https://www.linuxzen.com/centosxia-da-jian-python-websheng-chan-huan-jing-nginxwebpyuwsgi.html" rel="alternate"></link><published>2012-04-19T17:59:00+08:00</published><updated>2012-04-19T17:59:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-04-19:/centosxia-da-jian-python-websheng-chan-huan-jing-nginxwebpyuwsgi.html</id><summary type="html">&lt;p&gt;å‰é¢éƒ½ä¸€ç¯‡æ–‡ç« ä»‹ç»ä»‹ç»äº†Ubuntuä¸‹web.pyçš„å¼€å‘ç¯å¢ƒæ­å»º,è¿™ç¯‡æ–‡ç« ä¸»è¦æ¥ä»‹ç»å¦‚ä½•è®©web.pyç»“åˆnginxæ¥å®ç°ç”Ÿäº§ç¯å¢ƒ&lt;/p&gt;
&lt;p&gt;é¦–å…ˆä½¿ç”¨ç¯å¢ƒä»‹ç»:
ç³»ç»Ÿ: CentOS 5.5 32ä½&lt;/p&gt;
&lt;p&gt;Pythonç‰ˆæœ¬:2.7.2&lt;/p&gt;
&lt;p&gt;nginx:1.0.13 â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;å‰é¢éƒ½ä¸€ç¯‡æ–‡ç« ä»‹ç»ä»‹ç»äº†Ubuntuä¸‹web.pyçš„å¼€å‘ç¯å¢ƒæ­å»º,è¿™ç¯‡æ–‡ç« ä¸»è¦æ¥ä»‹ç»å¦‚ä½•è®©web.pyç»“åˆnginxæ¥å®ç°ç”Ÿäº§ç¯å¢ƒ&lt;/p&gt;
&lt;p&gt;é¦–å…ˆä½¿ç”¨ç¯å¢ƒä»‹ç»:
ç³»ç»Ÿ: CentOS 5.5 32ä½&lt;/p&gt;
&lt;p&gt;Pythonç‰ˆæœ¬:2.7.2&lt;/p&gt;
&lt;p&gt;nginx:1.0.13&lt;/p&gt;
&lt;p&gt;ip:192.168.3.3/24&lt;/p&gt;
&lt;p&gt;ç”±äºCentOSé»˜è®¤è‡ªå¸¦éƒ½python(2.4.3)ç‰ˆæœ¬è¾ƒä½,æ‰€ä»¥æˆ‘ä»¬é‡‡ç”¨æ‰‹åŠ¨ç¼–è¯‘å®‰è£…pythonçš„æ–¹å¼æ¥ä½¿ç”¨python 2.7.2&lt;/p&gt;
&lt;p&gt;é¦–å…ˆå®‰è£…python 2.7.2&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;cd /usr/src/
mkdir python
cd python
#ä¸‹è½½python2.7.2
wget http://www.python.org/ftp/python/2.7.2/Python-2.7.2.tar.bz2
tar -jvxf Python-2.7.2.tar.bz2
cd Python-2.7.2
./configure --prefix=/usr/local/python27 --enable-unicode=ucs4
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å…ˆåˆ«æ€¥ç€å®‰è£…,ä¸ºä»€ä¹ˆåé¢çš„æ­¥éª¤èƒ½é¡ºåˆ©è¿›è¡Œæˆ‘ä»¬éœ€è¦æˆ‘ä»¬çš„pythonæ”¯æŒzlibæ¨¡å—,&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;Modules/Setup
&lt;span class="c1"&gt;#åœ¨454è¡Œå·¦å³æ‰¾åˆ°:#zlib zlibmodule.c -I$(prefix)/include -L$(exec_prefix)/lib -lz&lt;/span&gt;
&lt;span class="c1"&gt;# å»æ‰æ³¨é‡Š&lt;/span&gt;
zlib&lt;span class="w"&gt; &lt;/span&gt;zlibmodule.c&lt;span class="w"&gt; &lt;/span&gt;-I&lt;span class="k"&gt;$(&lt;/span&gt;prefix&lt;span class="k"&gt;)&lt;/span&gt;/include&lt;span class="w"&gt; &lt;/span&gt;-L&lt;span class="k"&gt;$(&lt;/span&gt;exec_prefix&lt;span class="k"&gt;)&lt;/span&gt;/lib&lt;span class="w"&gt; &lt;/span&gt;-lz
ç„¶åæ¥ç€ç¼–è¯‘
make&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…å®Œæˆåæˆ‘ä»¬æƒ³æ›´æ–¹é¢çš„ä½¿ç”¨æˆ‘ä»¬æ–°å®‰è£…çš„Pythonæˆ‘ä»¬åšå¦‚ä¸‹æ›´æ”¹.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mv&lt;span class="w"&gt; &lt;/span&gt;/usr/bin/python&lt;span class="w"&gt; &lt;/span&gt;/usr/bin/python24
ln&lt;span class="w"&gt; &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;/usr/local/python27/bin/python&lt;span class="w"&gt; &lt;/span&gt;/usr/bin/python
ln&lt;span class="w"&gt; &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;/usr/local/python27/bin/python2.7&lt;span class="w"&gt; &lt;/span&gt;/usr/bin/python2.7
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ ·æ”¹å®Œæˆ‘ä»¬çš„yumå°±æ— æ³•å·¥ä½œäº†,æˆ‘ä»¬è¦ä¿®æ”¹yumæ¥ä½¿yumå·¥ä½œ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/usr/bin/yum
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å°†/#!/usr/bin/pythonæ”¹ä¸º#!/usr/bin/python2.4å³å¯æ­£å¸¸å·¥ä½œ(ç‰ˆæœ¬å¯èƒ½ä¸ä¸€æ ·éœ€æŸ¥çœ‹è‡ªå·±ç³»ç»Ÿè‡ªå¸¦çš„ç‰ˆæœ¬æ˜¯ä»€ä¹ˆ)&lt;/p&gt;
&lt;p&gt;ç°åœ¨æˆ‘ä»¬æ‰§è¡Œpython -VæŸ¥çœ‹åº”è¯¥å°±æ˜¯æˆ‘ä»¬åˆšåˆšå®‰è£…çš„2.7.2ç‰ˆæœ¬:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;python&lt;span class="w"&gt; &lt;/span&gt;-V
Python&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.7.2
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬å®‰è£…äº†pythonä¸‹é¢æˆ‘ä»¬å°±æ¥æ­¦è£…æˆ‘ä»¬çš„æ–°python,&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬å…ˆä¸ºæ–°çš„Pythonå®‰è£…pythonçš„setuptools,é…å¤‡easy_install.easy_installç”¨äºå®‰è£…Pythonç¬¬ä¸‰æ–¹æ‰©å±•åŒ…è€Œä¸”åªè¦ä¸€ä¸ªå‘½ä»¤å³å¯å®Œæˆ:&lt;/p&gt;
&lt;p&gt;ä¸‹è½½:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;wget&lt;span class="w"&gt; &lt;/span&gt;http://pypi.python.org/packages/2.7/s/setuptools/setuptools-0.6c11-py2.7.egg#md5&lt;span class="o"&gt;=&lt;/span&gt;fe1f997bc722265116870bc7919059ea
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åç›´æ¥æ‰§è¡Œå®‰è£…:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;sh&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;setuptools&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;0.6&lt;/span&gt;&lt;span class="n"&gt;c11&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;py2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;7.&lt;/span&gt;&lt;span class="n"&gt;egg&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…å¥½ä¹‹åæˆ‘ä»¬åšä¸€ä¸ªè½¯é“¾æ¥æ–¹ä¾¿æˆ‘ä»¬ä½¿ç”¨:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ln -s /usr/local/python27/bin/easy_install* /usr/bin/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæˆ‘ä»¬æ¥ä½¿ç”¨easy_installæ¥å®‰è£…Pythonç¬¬ä¸‰æ–¹æ‰©å±•&lt;/p&gt;
&lt;p&gt;å®‰è£…æœ¬æ–‡æ‰€éœ€è¦çš„web.py&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;easy_install web.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæˆ‘ä»¬æ‰“å¼€Python shellè¾“å…¥&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;web&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœæ²¡æœ‰æŠ¥é”™åˆ™è¯´æ˜æˆ‘ä»¬å®‰è£…æˆåŠŸ
å®‰è£…flup:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;easy_install flup
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…Spawn-fcgi :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;wegt&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;www&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;lighttpd&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;net&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;download&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fcgi&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.6&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;3.&lt;/span&gt;&lt;span class="n"&gt;tar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gz&lt;/span&gt;
&lt;span class="n"&gt;tar&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;zxvf&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fcgi&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.6&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;3.&lt;/span&gt;&lt;span class="n"&gt;tar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gz&lt;/span&gt;
&lt;span class="n"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fcgi&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;1.6&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;span class="o"&gt;./&lt;/span&gt;&lt;span class="n"&gt;configure&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;--&lt;/span&gt;&lt;span class="n"&gt;prefix&lt;/span&gt;&lt;span class="o"&gt;=/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;local&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fcgi&lt;/span&gt;
&lt;span class="n"&gt;make&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;make&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;install&lt;/span&gt;
&lt;span class="n"&gt;ln&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;local&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fcgi&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;spawn&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fcgi&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;bin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åˆ°è¿™é‡Œæˆ‘ä»¬å°±å®Œæˆäº†Pythonçš„æ‰€æœ‰åŒ…å®‰è£…,ä¸‹é¢æˆ‘ä»¬æ¥éƒ¨ç½²nginx(æœ¬åšæœ‰å¤§é‡æ–‡ç« æ¥ä»‹ç»å®‰è£…nginx,è¿™é‡Œè¿˜æ˜¯å†æ¥ä¸€éå§..)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;zlib-devel&lt;span class="w"&gt; &lt;/span&gt;pcre-devel&lt;span class="w"&gt; &lt;/span&gt;openssl-devel&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# å®‰è£…ä¾èµ–&lt;/span&gt;
wget&lt;span class="w"&gt; &lt;/span&gt;http://nginx.org/download/nginx-1.0.13.tar.gz&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# ä¸‹è½½&lt;/span&gt;
tar&lt;span class="w"&gt; &lt;/span&gt;-zxvf&lt;span class="w"&gt; &lt;/span&gt;nginx-1.0.13.tar.gz
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;nginx-1.0.13
&lt;span class="w"&gt; &lt;/span&gt;./configure&lt;span class="w"&gt; &lt;/span&gt;--prefix&lt;span class="o"&gt;=&lt;/span&gt;/usr/local/nginx&lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# æŒ‡å®šå®‰è£…ç›®å½•ä¸º/usr/local/nginx&lt;/span&gt;
--with-openssl&lt;span class="o"&gt;=&lt;/span&gt;/usr/include/openssl&lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# å¯ç”¨ssl&lt;/span&gt;
--with-pcre&lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="w"&gt;                         &lt;/span&gt;&lt;span class="c1"&gt;# å¯ç”¨æ­£è§„è¡¨è¾¾å¼&lt;/span&gt;
--with-http_stub_status_module&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# å®‰è£…å¯ä»¥æŸ¥çœ‹nginxçŠ¶æ€çš„ç¨‹åº&lt;/span&gt;
make&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬ä¿®æ”¹nginxçš„é…ç½®æ–‡ä»¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nt"&gt;location&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="err"&gt;root&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="err"&gt;html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="err"&gt;index&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;index.html&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;index.htm&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="err"&gt;include&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;fastcgi_params&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="err"&gt;fastcgi_param&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;SCRIPT_FILENAME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;$fastcgi_script_name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="err"&gt;fastcgi_param&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;PATH_INFO&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;$fastcgi_script_name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="err"&gt;fastcgi_pass&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;tmp&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;pyweb&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="err"&gt;fastcgi_param&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;SERVER_ADDR&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;$server_addr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="err"&gt;fastcgi_param&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;SERVER_PORT&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;$server_port&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="err"&gt;fastcgi_param&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;SERVER_NAME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;$server_name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶ååˆ›å»ºä¸€ä¸ªweb.pyç¨‹åº:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/usr/bin/env python&lt;/span&gt;
&lt;span class="c1"&gt;#-*-coding:utf8-*-&lt;/span&gt;
&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;web&lt;/span&gt;
&lt;span class="n"&gt;urls&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/.*&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;hello&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;web&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;application&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;urls&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;globals&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;

&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;hello&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;GET&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
                &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Hello, world!&amp;#39;&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;web&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wsgi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;runwsgi&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="k"&gt;lambda&lt;/span&gt; &lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;addr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;web&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wsgi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;runfcgi&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;func&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;addr&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å°†å†…å®¹ä¿å­˜åˆ°/usr/local/nginx/html/ä¸‹å‘½åä¸ºindex.py(æˆ–ä»»æ„ä½ å–œæ¬¢çš„åå­—)
ç„¶åèµ‹äºˆå…¶æ‰§è¡Œæƒé™:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;chmod +x /usr/local/nginx/html/index.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é€šè¿‡å‘½ä»¤åˆ›å»ºspawn-fcgiè¿›ç¨‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;spawn-fcgi -d /usr/local/nginx/html/ -f /usr/local/nginx/html/index.py  -s /tmp/pyweb.sock -u nobody -g nobody
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨unix socket,å¹¶ç”¨nginxçš„ç”¨æˆ·æ¥åˆ›å»º.ç°åœ¨æˆ‘ä»¬è®¿é—®http://192.168.3.3/å°±å¯ä»¥çœ‹åˆ°:&lt;code&gt;Hello, world!&lt;/code&gt;&lt;/p&gt;</content><category term="Linux"></category><category term="web.py"></category><category term="web"></category><category term="uwsgi"></category><category term="spawn-fcgi"></category><category term="python"></category><category term="nginx"></category></entry><entry><title>lvs+keepalivedå®ç°é«˜å¯ç”¨ç¾¤é›†é…ç½®è¯¦è§£</title><link href="https://www.linuxzen.com/lvskeepalivedshi-xian-gao-ke-yong-qun-ji-pei-zhi-xiang-jie.html" rel="alternate"></link><published>2012-04-16T14:25:00+08:00</published><updated>2012-04-16T14:25:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-04-16:/lvskeepalivedshi-xian-gao-ke-yong-qun-ji-pei-zhi-xiang-jie.html</id><summary type="html">&lt;p&gt;lvsæ˜¯ä¸€ä¸ªå¼€æºçš„è½¯ä»¶ï¼Œç”±æ¯•ä¸šäºå›½é˜²ç§‘æŠ€å¤§å­¦çš„ç« æ–‡åµ©åšå£«äº1998å¹´5æœˆåˆ›ç«‹(ä¸­å›½äººçš„é¡¹ç›®)ï¼Œå¯ä»¥å®ç°LINUXå¹³å°ä¸‹çš„ç®€å•è´Ÿè½½å‡è¡¡ã€‚LVSæ˜¯Linux Virtual Serverçš„ç¼©å†™ï¼Œæ„æ€æ˜¯Linuxè™šæ‹ŸæœåŠ¡å™¨ã€‚æœ¬æ–‡å°†ä»‹ç»lvsç»“åˆkeepalivedå®ç°ä¸€ä¸ªé«˜ç§‘ç”¨çš„Linuxç¾¤é›†ç³»ç»Ÿ.&lt;/p&gt;
&lt;p&gt;lvsæœ‰ä¸‰ç§å·¥ä½œæ¨¡å¼NAT(åœ°å€è½¬æ¢),IP Tunneling â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;lvsæ˜¯ä¸€ä¸ªå¼€æºçš„è½¯ä»¶ï¼Œç”±æ¯•ä¸šäºå›½é˜²ç§‘æŠ€å¤§å­¦çš„ç« æ–‡åµ©åšå£«äº1998å¹´5æœˆåˆ›ç«‹(ä¸­å›½äººçš„é¡¹ç›®)ï¼Œå¯ä»¥å®ç°LINUXå¹³å°ä¸‹çš„ç®€å•è´Ÿè½½å‡è¡¡ã€‚LVSæ˜¯Linux Virtual Serverçš„ç¼©å†™ï¼Œæ„æ€æ˜¯Linuxè™šæ‹ŸæœåŠ¡å™¨ã€‚æœ¬æ–‡å°†ä»‹ç»lvsç»“åˆkeepalivedå®ç°ä¸€ä¸ªé«˜ç§‘ç”¨çš„Linuxç¾¤é›†ç³»ç»Ÿ.&lt;/p&gt;
&lt;p&gt;lvsæœ‰ä¸‰ç§å·¥ä½œæ¨¡å¼NAT(åœ°å€è½¬æ¢),IP Tunneling(IPéš§é“)ã€Direct Routing(ç›´æ¥è·¯ç”±)ã€‚
å·¥ä½œæ•ˆç‡æœ€ä½çš„æ˜¯NATæ¨¡å¼,ä½†NATæ¨¡å¼å¯ä»¥ç”¨äºå„ç§ç³»ç»Ÿ,å„ç§ç¯å¢ƒçš„è´Ÿè½½å‡è¡¡,åªéœ€è¦ä¸€ä¸ªå…¬ç½‘ipå³å¯å®ç°
IP Tunnelingæ¨¡å¼è°ƒåº¦å™¨å°†è¿æ¥åˆ†å‘åˆ°ä¸åŒçš„åç«¯real server,ç„¶åç”±real serverå¤„ç†è¯·æ±‚ç›´æ¥ç›¸åº”ç»™ç”¨æˆ·,å¤§å¤§æé«˜äº†è°ƒåº¦å™¨çš„è°ƒåº¦æ•ˆç‡,åç«¯real serveræ²¡æœ‰ç‰©ç†ä½ç½®å’Œé€»è¾‘å…³ç³»çš„é™åˆ¶,åç«¯real serverå¯ä»¥åœ¨Lan/Wlan,ä½†æ˜¯åç«¯real serverå¿…é¡»æ”¯æŒIPéš§é“åè®®.
DR(Direct Routing)æ˜¯æ•ˆç‡æœ€é«˜çš„,ä¸IP Tunnelingç±»ä¼¼,éƒ½æ˜¯å¤„ç†ä¸€èˆ¬è¿æ¥,å°†è¯·æ±‚ç»™åç«¯real server,ç„¶åç”±real serverå¤„ç†è¯·æ±‚ç›´æ¥ç›¸åº”ç»™ç”¨æˆ·,Direct Routingä¸IP Tunnelingç›¸æ¯”ï¼Œæ²¡æœ‰IPå°è£…çš„å¼€é”€ï¼Œä½†ç”±äºé‡‡ç”¨ç‰©ç†å±‚,æ‰€ä»¥DRæ¨¡å¼çš„è°ƒåº¦å™¨å’Œåç«¯real serverå¿…é¡»åœ¨ä¸€ä¸ªç‰©ç†ç½‘æ®µé‡Œ,ä¸­é—´ä¸èƒ½è¿‡è·¯ç”±å™¨(ä¹Ÿå°±æ˜¯ä¸€ä¸ªäº¤æ¢æœºç›¸è¿).&lt;/p&gt;
&lt;p&gt;lvsæ”¯æŒ8ç§ä¸åŒçš„è°ƒåº¦ç®—æ³•è½®å«(rr)ã€åŠ æƒè½®å«(wrr)ã€æœ€å°è¿æ¥(lc)ã€åŠ æƒæœ€å°è¿æ¥(wlc)ã€åŸºäºå±€éƒ¨æ€§æœ€å°è¿æ¥(lblc)ã€å¸¦å¤åˆ¶çš„åŸºäºå±€éƒ¨æ€§æœ€å°‘é“¾æ¥(lblcr)ã€ç›®æ ‡åœ°å€æ•£åˆ—(dh)å’Œæºåœ°å€æ•£åˆ—(sh).&lt;/p&gt;
&lt;p&gt;ä¸‹é¢å°±ä»‹ç»å¦‚ä½•æ¥å®‰è£…å’Œé…ç½®lvs+keepalived&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä½¿ç”¨ç¯å¢ƒ:
æ“ä½œç³»ç»Ÿ:CentOS 5.5  32bit&lt;/p&gt;
&lt;p&gt;ä¸»è°ƒåº¦å™¨:192.168.3.101/24&lt;/p&gt;
&lt;p&gt;å¤‡è°ƒåº¦å™¨:192.168.3.102/24&lt;/p&gt;
&lt;p&gt;åç«¯real server: 192.168.3.3/24 |192.168.3.102/24(æˆ‘ä»¬è¿™é‡Œä½¿ç”¨å¤‡ç”¨lvsä½œä¸ºä¸€ä¸ªæµ‹è¯•&lt;/p&gt;
&lt;p&gt;vip(virtual ip):192.168.3.100/24&lt;/p&gt;
&lt;p&gt;lvsåœ¨2.6çš„å†…æ ¸ä¸­æ˜¯é»˜è®¤æ”¯æŒçš„,æ‰€ä»¥æˆ‘ä»¬å°±ä¸éœ€è¦åœ¨æ¥å®‰è£…,ä½†æ˜¯æˆ‘ä»¬éœ€è¦å®‰è£…ç”¨æˆ·é…ç½®å·¥å…·ipvsadm&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum -y install ipvsadm           # åˆ†åˆ«åœ¨ä¸»ä»lvsä¸Šæ‰§è¡Œå®‰è£…ipvsadm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬æŸ¥çœ‹lvsæ˜¯å¦æ”¯æŒ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;lsmod Â¦ grep ip_vs          #
ip_vs                  78081  1
modprobe -lÂ¦ grep ip_vs
/lib/modules/2.6.18-194.el5/kernel/net/ipv4/ipvs/ip_vs.ko
/lib/modules/2.6.18-194.el5/kernel/net/ipv4/ipvs/ip_vs_dh.ko
/lib/modules/2.6.18-194.el5/kernel/net/ipv4/ipvs/ip_vs_ftp.ko
/lib/modules/2.6.18-194.el5/kernel/net/ipv4/ipvs/ip_vs_lblc.ko
/lib/modules/2.6.18-194.el5/kernel/net/ipv4/ipvs/ip_vs_lblcr.ko
/lib/modules/2.6.18-194.el5/kernel/net/ipv4/ipvs/ip_vs_lc.ko
/lib/modules/2.6.18-194.el5/kernel/net/ipv4/ipvs/ip_vs_nq.ko
/lib/modules/2.6.18-194.el5/kernel/net/ipv4/ipvs/ip_vs_rr.ko
/lib/modules/2.6.18-194.el5/kernel/net/ipv4/ipvs/ip_vs_sed.ko
/lib/modules/2.6.18-194.el5/kernel/net/ipv4/ipvs/ip_vs_sh.ko
/lib/modules/2.6.18-194.el5/kernel/net/ipv4/ipvs/ip_vs_wlc.ko
/lib/modules/2.6.18-194.el5/kernel/net/ipv4/ipvs/ip_vs_wrr.ko
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æœ¬æ–‡ä»‹ç»lvsçš„&lt;code&gt;DR&lt;/code&gt;æ¨¡å¼,é¦–å…ˆéƒ¨ç½²keepalived.æœ¬åšå‰é¢å·²ç»ä»‹ç»å¦‚ä½•æ¥å®‰è£…keepalived.è¿™é‡Œå°±ä¸åœ¨åªç®€å•çš„è´´ä¸€ä¸‹æ­¥éª¤:&lt;/p&gt;
&lt;p&gt;åœ¨ä¸»å¤‡æœåŠ¡å™¨ä¸Šéƒ¨ç½²keepalived(å› ä¸ºå‰é¢å·²ç»rpmåŒ…å®‰è£…äº†ipvsadm,æ‰€ä»¥å°±ä¸éœ€è¦é‡å¤å®‰è£…):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi /etc/sysctl.conf
net.ipv4.ip_forward = 1 # æ­¤å‚æ•°æ”¹ä¸º1
sysctl -p # ä½¿ä¿®æ”¹ç”Ÿæ•ˆ
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…ä¾èµ–:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum&lt;span class="w"&gt;  &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;openssl-devel
&lt;span class="c1"&gt;# ä¸‹è½½å¹¶å®‰è£…keepalived&lt;/span&gt;
wget&lt;span class="w"&gt; &lt;/span&gt;http://www.keepalived.org/software/keepalived-1.1.19.tar.gz
tar&lt;span class="w"&gt; &lt;/span&gt;-zxvf&lt;span class="w"&gt; &lt;/span&gt;keepalived-1.1.19.tar.gz
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;keepalived-1.1.19
./configure&lt;span class="w"&gt; &lt;/span&gt;--prefix&lt;span class="o"&gt;=&lt;/span&gt;/&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="c1"&gt;# å®‰è£…åœ¨é»˜è®¤ä½ç½®(é…ç½®æ–‡ä»¶,äºŒè¿›åˆ¶æ–‡ä»¶,å¯åŠ¨è„šæœ¬æ”¾åˆ°é»˜è®¤ä½ç½®)&lt;/span&gt;
--mandir&lt;span class="o"&gt;=&lt;/span&gt;/usr/local/share/man/&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
--with-kernel-dir&lt;span class="o"&gt;=&lt;/span&gt;/usr/src/kernels/2.6.18-194.el5-i686/&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# éœ€è¦å†…æ ¸çš„å¤´æ–‡ä»¶&lt;/span&gt;
make&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åœ¨ä¸»å¤‡lvsä¸Šå®‰è£…keepalivedå®Œæ¯•åæˆ‘ä»¬å…ˆæ¥é…ç½®ä¸»lvsä¸Šçš„keepalived:
ç¼–è¾‘é…ç½®æ–‡ä»¶&lt;code&gt;/etc/keepalived/keepalived.conf&lt;/code&gt;:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;!&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Configuration&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;File&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;keepalived&lt;/span&gt;

&lt;span class="n"&gt;global_defs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;notification_email&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;coldnight&lt;/span&gt;&lt;span class="nv"&gt;@linuxzen&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="w"&gt;                                   &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;å‘ç”Ÿæ•…éšœæ—¶å‘é€çš„é‚®ç®±&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;notification_email_from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linuxzen&lt;/span&gt;&lt;span class="nv"&gt;@linuxzen&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ä½¿ç”¨å“ªä¸ªé‚®ç®±å‘é€&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;smtp_server&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linuxzen&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="w"&gt;                                  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;å‘ä»¶æœåŠ¡å™¨&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;smtp_connect_timeout&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;router_id&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LVS_DEVEL&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;vrrp_instance&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VI_1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;state&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MASTER&lt;/span&gt;&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;æ ‡ç¤ºä¸ºä¸»lvs&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;interface&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;eth0&lt;/span&gt;&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HAæ£€æµ‹ç«¯å£&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;virtual_router_id&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;51&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ä¸»å¤‡çš„virtual_router_id&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;å¿…é¡»ç›¸åŒ&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;priority&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ä¼˜å…ˆçº§&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;å¤‡lvsè¦æ¯”ä¸»lvsç¨å°&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;advert_int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VRRP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Multicast&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;å¹¿æ’­å‘¨æœŸç§’æ•°&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;authentication&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;å®šä¹‰è®¤è¯&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;auth_type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PASS&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;è®¤è¯æ–¹å¼ä¸ºå£ä»¤è®¤è¯&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;auth_pass&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1111&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;å®šä¹‰å£ä»¤&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;virtual_ipaddress&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;å®šä¹‰vip&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;192.168.3.100&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;å¤šä¸ªvipå¯æ¢è¡Œæ·»åŠ &lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;virtual_server&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.168.3.100&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;delay_loop&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;æ¯éš”6ç§’æŸ¥çœ‹realserverçŠ¶æ€&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;lb_algo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;wlc&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;è°ƒåº¦ç®—æ³•ä¸ºåŠ æƒæœ€å°è¿æ¥æ•°&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;lb_kind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DR&lt;/span&gt;&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lvså·¥ä½œæ¨¡å¼ä¸ºDR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ç›´æ¥è·¯ç”±&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;æ¨¡å¼&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;nat_mask&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;255.255.255.0&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;persistence_timeout&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;åŒä¸€IP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;çš„è¿æ¥50ç§’å†…è¢«åˆ†é…åˆ°åŒä¸€å°realserver&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;æµ‹è¯•æ—¶å»ºè®®æ”¹ä¸º0&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;protocol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TCP&lt;/span&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ç”¨TCPç›‘æµ‹realserverçš„çŠ¶æ€&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;real_server&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.168.3.3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;å®šä¹‰realserver&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;weight&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;                       &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;å®šä¹‰æƒé‡&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;TCP_CHECK&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;æ³¨æ„TCP_CHECKå’Œ&lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="n"&gt;ä¹‹é—´çš„ç©ºæ ¼&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;å¦‚æœæ²¡æœ‰çš„è¯åªä¼šæ·»åŠ ç¬¬ä¸€ä¸ªrealserver&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;connect_timeout&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ä¸‰ç§’æ— å“åº”è¶…æ—¶&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;nb_get_retry&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;delay_before_retry&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;connect_port&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;real_server&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.168.3.102&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;weight&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;TCP_CHECK&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;connect_timeout&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;nb_get_retry&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;delay_before_retry&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;connect_port&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é…ç½®å¤‡ç”¨lvsçš„keepalived,åªéœ€è¦å°†state MASTER æ”¹ä¸ºstate BACKUP,é™ä½priority 100 çš„å€¼:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;!&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Configuration&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;File&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;keepalived&lt;/span&gt;

&lt;span class="n"&gt;global_defs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;notification_email&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;coldnight&lt;/span&gt;&lt;span class="nv"&gt;@linuxzen&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="w"&gt;                               &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;å‘ç”Ÿæ•…éšœæ—¶å‘é€çš„é‚®ç®±&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;notification_email_from&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linuxzen&lt;/span&gt;&lt;span class="nv"&gt;@linuxzen&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ä½¿ç”¨å“ªä¸ªé‚®ç®±å‘é€&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;smtp_server&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;linuxzen&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="w"&gt;                              &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;å‘ä»¶æœåŠ¡å™¨&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;smtp_connect_timeout&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;router_id&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LVS_DEVEL&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;vrrp_instance&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VI_1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;state&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;BACKUP&lt;/span&gt;&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;æ ‡ç¤ºä¸ºå¤‡lvs&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;interface&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;eth0&lt;/span&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;HAæ£€æµ‹ç«¯å£&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;virtual_router_id&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;51&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ä¸»å¤‡çš„virtual_router_id&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;å¿…é¡»ç›¸åŒ&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;priority&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;99&lt;/span&gt;&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ä¼˜å…ˆçº§&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;å¤‡lvsè¦æ¯”ä¸»lvsç¨å°&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;advert_int&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VRRP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Multicast&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;å¹¿æ’­å‘¨æœŸç§’æ•°&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;authentication&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;å®šä¹‰è®¤è¯&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;auth_type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;PASS&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;è®¤è¯æ–¹å¼ä¸ºå£ä»¤è®¤è¯&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;auth_pass&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1111&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;å®šä¹‰å£ä»¤&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;virtual_ipaddress&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;å®šä¹‰vip&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mf"&gt;192.168.3.100&lt;/span&gt;&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;å¤šä¸ªvipå¯æ¢è¡Œæ·»åŠ &lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;

&lt;span class="n"&gt;virtual_server&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.168.3.100&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;delay_loop&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;6&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;æ¯éš”6ç§’æŸ¥çœ‹realserverçŠ¶æ€&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;lb_algo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;wlc&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;è°ƒåº¦ç®—æ³•ä¸ºåŠ æƒæœ€å°è¿æ¥æ•°&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;lb_kind&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;DR&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;lvså·¥ä½œæ¨¡å¼ä¸ºDR&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ç›´æ¥è·¯ç”±&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="n"&gt;æ¨¡å¼&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;nat_mask&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;255.255.255.0&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;persistence_timeout&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;åŒä¸€IP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;çš„è¿æ¥50ç§’å†…è¢«åˆ†é…åˆ°åŒä¸€å°realserver&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;protocol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;TCP&lt;/span&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ç”¨TCPç›‘æµ‹realserverçš„çŠ¶æ€&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;real_server&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.168.3.3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;å®šä¹‰realserver&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;weight&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;                       &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;å®šä¹‰æƒé‡&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;TCP_CHECK&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;æ³¨æ„TCP_CHECKå’Œ&lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;&lt;span class="n"&gt;ä¹‹é—´çš„ç©ºæ ¼&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;å¦‚æœæ²¡æœ‰çš„è¯åªä¼šæ·»åŠ ç¬¬ä¸€ä¸ªrealserver&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;connect_timeout&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ä¸‰ç§’æ— å“åº”è¶…æ—¶&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;nb_get_retry&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;delay_before_retry&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;connect_port&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;real_server&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.168.3.102&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;weight&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;TCP_CHECK&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;connect_timeout&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;nb_get_retry&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;delay_before_retry&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;connect_port&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="err"&gt;}&lt;/span&gt;
&lt;span class="err"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç”±äºä½¿ç”¨keepalivedå°±ä¸éœ€è¦ä½¿ç”¨è„šæœ¬æ¥é…ç½®lvsè°ƒåº¦å™¨,ä½†æ˜¯è¿™é‡Œæˆ‘ä»¬è¿˜æ˜¯ä¼šç»™å‡ºä¸€ä¸ªè„šæœ¬å†…å®¹,ä½†æˆ‘ä»¬ä¸ä¼šç”¨åˆ°è¿™ä¸ªè„šæœ¬:lvså·²ç»å†…ç½®äºå†…æ ¸,é…ç½®å‘½ä»¤æ˜¯ipvsadm,æ‰€ä»¥lvsçš„ä¸€äº›æ“ä½œæ˜¯é€šè¿‡ipvsadmæ¥æ§åˆ¶.ä¸‹é¢æˆ‘ä»¬å°±ç¼–å†™è„šæœ¬æ¥å®ç°lvsçš„DRæ¨¡å¼:&lt;/p&gt;
&lt;p&gt;ç¼–å†™è„šæœ¬lvsdr:&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬æŠŠlvs&lt;code&gt;vi /etc/init.d/lvsdr&lt;/code&gt;æ·»åŠ å¦‚ä¸‹å†…å®¹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/sh&lt;/span&gt;
&lt;span class="c1"&gt;# å®šä¹‰è™šæ‹Ÿip&lt;/span&gt;
&lt;span class="nv"&gt;VIP&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.100
&lt;span class="c1"&gt;# å®šä¹‰realserver,å¹¶å·²é€—å·åˆ†å¼€&lt;/span&gt;
&lt;span class="nv"&gt;RIPS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.3,192.168.3.102&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;#,192.168.3.5,192.168.3.6&lt;/span&gt;

&lt;span class="c1"&gt;# å®šä¹‰æä¾›æœåŠ¡çš„ç«¯å£&lt;/span&gt;
&lt;span class="nv"&gt;SERVICE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;80&lt;/span&gt;

&lt;span class="c1"&gt;# è°ƒç”¨init.dè„šæœ¬çš„æ ‡å‡†åº“&lt;/span&gt;
.&lt;span class="w"&gt; &lt;/span&gt;/etc/rc.d/init.d/functions
&lt;span class="k"&gt;case&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;start&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Start LVS of DR Mode&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# lvs dræ¨¡å¼ä¸éœ€è¦è·¯ç”±è½¬å‘,ä½†æ˜¯keepalivedéœ€è¦&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;#echo &amp;quot;0&amp;quot; &amp;gt; /proc/sys/net/ipv4/ip_forward&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# å¼€å¯icmpåŒ…é‡å®šå‘&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/proc/sys/net/ipv4/conf/all/send_redirects
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/proc/sys/net/ipv4/conf/default/send_redirects
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/proc/sys/net/ipv4/conf/eth0/send_redirects
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# ç»‘å®šè™šæ‹Ÿip&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;ifconfig&lt;span class="w"&gt; &lt;/span&gt;eth0:0&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$VIP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;broadcast&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$VIP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;netmask&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;255&lt;/span&gt;.255.255.255&lt;span class="w"&gt; &lt;/span&gt;up
&lt;span class="w"&gt;        &lt;/span&gt;route&lt;span class="w"&gt; &lt;/span&gt;add&lt;span class="w"&gt; &lt;/span&gt;-host&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$VIP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;dev&lt;span class="w"&gt; &lt;/span&gt;eth0:0
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# æ¸…é™¤lvsè§„åˆ™&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;ipvsadm&lt;span class="w"&gt; &lt;/span&gt;-C
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# æ·»åŠ ä¸€æ¡è™šæ‹ŸæœåŠ¡å™¨è®°å½•&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# -pæŒ‡å®šä¸€å®šçš„æ—¶é—´å†…å°†ç›¸åŒçš„å®¢æˆ·ç«¯åˆ†é…åˆ°åŒä¸€å°åç«¯æœåŠ¡å™¨&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# ç”¨äºè§£å†³sessionçš„é—®é¢˜,æµ‹è¯•æ—¶æˆ–æœ‰åˆ«çš„è§£å†³æ–¹æ¡ˆæ—¶å»ºè®®å»æ‰&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;ipvsadm&lt;span class="w"&gt; &lt;/span&gt;-A&lt;span class="w"&gt; &lt;/span&gt;-t&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$VIP&lt;/span&gt;:&lt;span class="nv"&gt;$SERVICE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;wlc&lt;span class="w"&gt; &lt;/span&gt;-p

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# æ·»åŠ çœŸå®æœåŠ¡å™¨è®°å½•&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RIP&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$RIPS&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Â¦sed&lt;span class="w"&gt;  &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;s/,/\n/g&amp;#39;&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;do&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;ipvsadm&lt;span class="w"&gt; &lt;/span&gt;-a&lt;span class="w"&gt; &lt;/span&gt;-t&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$VIP&lt;/span&gt;:&lt;span class="nv"&gt;$SERVICE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-r&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$RIP&lt;/span&gt;:&lt;span class="nv"&gt;$SERVICE&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-g&lt;span class="w"&gt; &lt;/span&gt;-w&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# è®¾ç½®tcp tcpfin  udpçš„è¶…æ—¶è¿æ¥å€¼&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;ipvsadm&lt;span class="w"&gt; &lt;/span&gt;--set&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;120&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;300&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;ipvsadm
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;;;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;stop&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Stop LVS DR&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;ifconfig&lt;span class="w"&gt; &lt;/span&gt;eth0:0&lt;span class="w"&gt; &lt;/span&gt;down
&lt;span class="w"&gt;        &lt;/span&gt;ipvsadm&lt;span class="w"&gt; &lt;/span&gt;-C
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;*&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Usage:&lt;/span&gt;&lt;span class="nv"&gt;$0&lt;/span&gt;&lt;span class="s2"&gt; {start Â¦ stop}&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;exit&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;span class="k"&gt;esac&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç¼–è¾‘å®Œæ¯•ä¿å­˜é€€å‡º,ç„¶åç»™è¿™ä¸ªè„šæœ¬æ‰§è¡Œæƒé™:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;chmod +x /etc/init.d/lvsdr
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åå°±å¯ä»¥é€šè¿‡serviceå‘½ä»¤æ¥å¯åŠ¨lvs dræ¨¡å¼&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;service lvsdr start
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å°†è¿™ä¸ªè„šæœ¬åˆ†åˆ«æ”¾åˆ°ä¸»å¤‡lvsçš„/etc/init.d/ä¸‹,èµ‹äºˆæ‰§è¡Œæƒé™.
æˆ‘ä»¬çœŸæ­£éœ€è¦çš„æ˜¯realserverçš„è„šæœ¬,ä¸‹é¢æˆ‘ä»¬æ¥ç¼–å†™realserverè„šæœ¬,åŒæ ·æ”¾åœ¨/etc/init.d/ä¸‹,ç¼–è¾‘rsè„šæœ¬:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/etc/init.d/lvsrs
&lt;span class="c1"&gt;#!/bin/sh&lt;/span&gt;
&lt;span class="nv"&gt;VIP&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.100
.&lt;span class="w"&gt; &lt;/span&gt;/etc/rc.d/init.d/functions
&lt;span class="k"&gt;case&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;start&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;lo:0 port starting&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# ä¸ºäº†ç›¸åº”lvsè°ƒåº¦å™¨è½¬å‘è¿‡æ¥çš„åŒ…,éœ€åœ¨æœ¬åœ°loæ¥å£ä¸Šç»‘å®švip&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;ifconfig&lt;span class="w"&gt; &lt;/span&gt;lo:0&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$VIP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;broadcast&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$VIP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;netmask&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;255&lt;/span&gt;.255.255.255&lt;span class="w"&gt; &lt;/span&gt;up
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# é™åˆ¶arpè¯·æ±‚&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/proc/sys/net/ipv4/conf/lo/arp_ignore
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;2&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/proc/sys/net/ipv4/conf/lo/arp_announce
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;1&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/proc/sys/net/ipv4/conf/all/arp_ignore
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;2&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/proc/sys/net/ipv4/conf/all/arp_announce
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;stop&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;lo:0 port closing&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;ifconfig&lt;span class="w"&gt; &lt;/span&gt;lo:0&lt;span class="w"&gt; &lt;/span&gt;down
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;0&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/proc/sys/net/ipv4/conf/lo/arp_ignore
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;0&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/proc/sys/net/ipv4/conf/lo/arp_announce
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;0&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/proc/sys/net/ipv4/conf/all/arp_ignore
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;0&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/proc/sys/net/ipv4/conf/all/arp_announce
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;*&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Usage: &lt;/span&gt;&lt;span class="nv"&gt;$0&lt;/span&gt;&lt;span class="s2"&gt; {start Â¦ stop}&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;exit&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;span class="k"&gt;esac&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç»™è„šæœ¬èµ‹äºˆæ‰§è¡Œæƒé™&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;chmod +x /etc/init.d/lvsrs
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¹¶å°†è¿™ä¸ªè„šæœ¬æ”¾åˆ°æ‰€æœ‰çš„realserverçš„/etc/init.d/ä¸‹.ä¸‹é¢å¼€å§‹æµ‹è¯•:&lt;/p&gt;
&lt;p&gt;å…ˆæ¥ç¡®è®¤ä¸‹æˆ‘ä»¬åšçš„å˜åŠ¨:ä¸»ä»lvsåˆ†åˆ«å®‰è£…keepalived,å¹¶ä¸”åœ¨/etc/init.d/ä¸‹æ·»åŠ äº†lvsdrè„šæœ¬(ä¸ä½¿ç”¨).&lt;/p&gt;
&lt;p&gt;åç«¯realserveråˆ†åˆ«åœ¨/etc/init.d/ä¸‹æ·»åŠ äº†lvsrsè„šæœ¬.æˆ‘ä»¬å…ˆæµ‹è¯•keepalived:&lt;/p&gt;
&lt;p&gt;é¦–å…ˆåœ¨ä¸»è°ƒåº¦å™¨ä¸Šå¯åŠ¨keepalived:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;service keepalived start
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;tail&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;50&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nb"&gt;log&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;
&lt;span class="n"&gt;Mar&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;21&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;29&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;device&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;eth0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;left&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;promiscuous&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;mode&lt;/span&gt;
&lt;span class="n"&gt;Mar&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;21&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;22&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;29&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;1700&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;audit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mf"&gt;1332340150.598&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;12&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;eth0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;prom&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;old_prom&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;256&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;auid&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;4294967295&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ses&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;4294967295&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Starting&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;v1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;1.19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;04&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;2012&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_healthcheckers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Netlink&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reflector&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reports&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;IP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.168&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;3.101&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;added&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_healthcheckers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Registering&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Kernel&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;netlink&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reflector&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_healthcheckers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Registering&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Kernel&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;netlink&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;channel&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_healthcheckers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Opening&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/etc/keepalived/keepalived.conf&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_healthcheckers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Configuration&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;8897&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Bytes&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_healthcheckers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LinkWatch&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;netlink&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reflector&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Starting&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Healthcheck&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;process&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pid&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;5369&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Starting&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VRRP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;child&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;process&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pid&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;5370&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_vrrp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Netlink&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reflector&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reports&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;IP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.168&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;3.101&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;added&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_vrrp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Registering&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Kernel&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;netlink&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reflector&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_vrrp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Registering&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Kernel&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;netlink&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;channel&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_vrrp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Registering&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;gratutious&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ARP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;shared&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;channel&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_vrrp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Opening&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;file&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/etc/keepalived/keepalived.conf&amp;#39;&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_vrrp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Configuration&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;36512&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Bytes&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_vrrp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LinkWatch&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;netlink&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reflector&lt;/span&gt;&lt;span class="o"&gt;...&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;32&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_vrrp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VRRP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;sockpool&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ifindex&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;2&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;proto&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;112&lt;/span&gt;&lt;span class="p"&gt;),&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fd&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="mi"&gt;11&lt;/span&gt;&lt;span class="p"&gt;)]&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_vrrp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VRRP_Instance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;VI_1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Transition&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MASTER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;STATE&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;34&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_vrrp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VRRP_Instance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;VI_1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Entering&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MASTER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;STATE&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;34&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_vrrp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VRRP_Instance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;VI_1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;setting&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;protocol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VIPs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;34&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_healthcheckers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Netlink&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reflector&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reports&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;IP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.168&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;3.100&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;added&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;34&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_vrrp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VRRP_Instance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;VI_1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Sending&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;gratuitous&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ARPs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;on&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;eth0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.168&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;3.100&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;34&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_vrrp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Netlink&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reflector&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reports&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;IP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.168&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;3.100&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;added&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;39&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;master&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_vrrp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VRRP_Instance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;VI_1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Sending&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;gratuitous&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ARPs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;on&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;eth0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.168&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;3.100&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶ååœ¨å¤‡ç”¨è°ƒåº¦å™¨ä¸Šå¯åŠ¨keepalivedç„¶åæŸ¥çœ‹æ—¥å¿—:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;35&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;slave&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;Keepalived_vrrp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VRRP_Instance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;VI_1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Entering&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;BACKUP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;STATE&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;35&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;slave&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;Keepalived_vrrp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VRRP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;sockpool&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;ifindex(2), proto(112), fd(11,12)&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;35&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;slave&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;Keepalived_healthcheckers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Netlink&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reflector&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reports&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;IP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.168.3.102&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;added&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;35&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;slave&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;Keepalived_healthcheckers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Registering&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Kernel&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;netlink&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reflector&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;35&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;slave&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;Keepalived_healthcheckers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Registering&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Kernel&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;netlink&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;command&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;channel&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;35&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;slave&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;Keepalived_healthcheckers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Opening&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;file&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/etc/keepalived/keepalived.conf&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;35&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;slave&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;Keepalived_healthcheckers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Configuration&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;8895&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Bytes&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;35&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;slave&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;kernel&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;IPVS&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="n"&gt;wlc&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;scheduler&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;registered&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;33&lt;/span&gt;&lt;span class="err"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;35&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;slave&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;Keepalived_healthcheckers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;Using&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LinkWatch&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;kernel&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;netlink&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reflector&lt;/span&gt;&lt;span class="p"&gt;...&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åœ¨ä¸»è°ƒåº¦å™¨ä¸Šæ‰§è¡Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;service keepalived stop
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æŸ¥çœ‹å¤‡ç”¨è°ƒåº¦å™¨æ—¥å¿—:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;tail&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mi"&gt;20&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="nb"&gt;log&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;39&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;44&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;slave&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_vrrp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VRRP_Instance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;VI_1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Transition&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MASTER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;STATE&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;39&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;45&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;slave&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_vrrp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VRRP_Instance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;VI_1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Entering&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MASTER&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;STATE&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;39&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;45&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;slave&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_vrrp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VRRP_Instance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;VI_1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;setting&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;protocol&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VIPs&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;39&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;45&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;slave&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_vrrp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;VRRP_Instance&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;VI_1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Sending&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;gratuitous&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ARPs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;on&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;eth0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.168&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;3.100&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;39&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;45&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;slave&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_vrrp&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Netlink&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reflector&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reports&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;IP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.168&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;3.100&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;added&lt;/span&gt;
&lt;span class="n"&gt;Apr&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;13&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;39&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;45&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;slave&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Keepalived_healthcheckers&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Netlink&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reflector&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reports&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;IP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.168&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;3.100&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;added&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬çœ‹åˆ°keepalivedå·²ç»æˆåŠŸåˆ‡æ¢.&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬ä½¿ç”¨ipvsadmå‘½ä»¤æŸ¥çœ‹(åœ¨æ­¤ä¹‹å‰è¦ç¡®è®¤åç«¯realserverå·²ç»å¯åŠ¨äº†webæœåŠ¡):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;ipvsadm&lt;/span&gt;
&lt;span class="n"&gt;IP&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="kr"&gt;Virtual&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Server&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;version&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;1.2.1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;size&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="mi"&gt;4096&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="n"&gt;Prot&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;LocalAddress&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;Port&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Scheduler&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Flags&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;RemoteAddress&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;Port&lt;/span&gt;&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="n"&gt;Forward&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Weight&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ActiveConn&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;InActConn&lt;/span&gt;
&lt;span class="n"&gt;TCP&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mf"&gt;192.168.3.100&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;wlc&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.168.3.3&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="n"&gt;Route&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;192.168.3.102&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="n"&gt;Route&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶ååˆ†åˆ«å¯åŠ¨åç«¯realserverçš„lvsrsæœåŠ¡:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;servie lvsrs start
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæµè§ˆå™¨è®¿é—®192.168.3.100,å¦‚æœkeepalivedçš„persistence_timeoutå‚æ•°å€¼ä¸º0,è€Œä¸”ä¸¤ä¸ªåç«¯realserveræ˜¯ä¸åŒçš„å†…å®¹,åˆ·æ–°å°±å¯ä»¥çœ‹åˆ°ä¸¤ä¸ªä¸åŒçš„é¡µé¢äº¤æ›¿.&lt;/p&gt;</content><category term="Linux"></category><category term="é«˜å¯ç”¨"></category><category term="è¯¦è§£"></category><category term="ç¾¤é›†"></category><category term="lvs"></category><category term="Linux"></category><category term="keepalived"></category></entry><entry><title>ä½¿ç”¨Pythonè¿›è¡Œwebå¼€å‘</title><link href="https://www.linuxzen.com/shi-yong-pythonjin-xing-webkai-fa.html" rel="alternate"></link><published>2012-04-13T16:39:00+08:00</published><updated>2012-04-13T16:39:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-04-13:/shi-yong-pythonjin-xing-webkai-fa.html</id><summary type="html">&lt;p&gt;æœ€è¿‘æœ‰ä¸€ä¸ªå°çš„webé¡¹ç›®,æƒ³ç”¨å–œçˆ±éƒ½python,ä½†æ˜¯æƒ³åˆ°ä¹‹å‰æ¥è§¦è¿‡éƒ½djangoæˆ‘æ„Ÿè§‰ä¸€é˜µä¸å¯’è€Œæ —,ä¸ºä»€ä¹ˆ?Djangoçš„é…ç½®å¤ªè¿‡å¤æ‚,è€Œä¸”å°é¡¹ç›®ä¸å¤ªé€‚åˆMVCçš„å¼€å‘æ¨¡å¼,æ‰€ä»¥æˆ‘å°†ç›®å…‰è½¬å‘äº†web.pyè¿™ä¸ªå°å‹webæ¡†æ¶ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;æœ€è¿‘æœ‰ä¸€ä¸ªå°çš„webé¡¹ç›®,æƒ³ç”¨å–œçˆ±éƒ½python,ä½†æ˜¯æƒ³åˆ°ä¹‹å‰æ¥è§¦è¿‡éƒ½djangoæˆ‘æ„Ÿè§‰ä¸€é˜µä¸å¯’è€Œæ —,ä¸ºä»€ä¹ˆ?Djangoçš„é…ç½®å¤ªè¿‡å¤æ‚,è€Œä¸”å°é¡¹ç›®ä¸å¤ªé€‚åˆMVCçš„å¼€å‘æ¨¡å¼,æ‰€ä»¥æˆ‘å°†ç›®å…‰è½¬å‘äº†web.pyè¿™ä¸ªå°å‹webæ¡†æ¶,å¹¶ä¸”çœŸæ­£è®©æˆ‘åŠ¨å¿ƒéƒ½æ˜¯å…¶å®˜æ–¹ç½‘ç«™ä¸Šéƒ½ä¸€å¥è¯:"Django lets you write web apps in Django. TurboGears lets you write web apps in TurboGears. Web.py lets you write web apps in Python." â€”  Adam Atlas&lt;/p&gt;
&lt;p&gt;æœ€è¿‘åˆ‡æ¢äº†Ubuntuæ›¿æ¢äº†Win7ç³»ç»Ÿ,æ‰€ä»¥è¿™é‡Œä»‹ç»ä¸‹Ubuntuéƒ½å®‰è£…web.py&lt;/p&gt;
&lt;h3 id="easy_install"&gt;å®‰è£…easy_install&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sudo apt-get install python-pip
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="easy_installwebpy"&gt;ä½¿ç”¨easy_installå®‰è£…web.py&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sudo easy_install web.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_1"&gt;æµ‹è¯•æ˜¯å¦å®‰è£…æˆåŠŸ:&lt;/h3&gt;
&lt;p&gt;åœ¨python shellä¸­æ‰§è¡Œ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;web&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœæ²¡æœ‰æŠ¥é”™åˆ™web.pyå®‰è£…æˆåŠŸ.
ä¸‹é¢å¼€å§‹æˆ‘ä»¬ç¬¬ä¸€ä¸ªhello,world&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;web&lt;/span&gt;

&lt;span class="n"&gt;urls&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/.*&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;hello&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;                &lt;span class="c1"&gt;# æŒ‡å®šä»»ä½•urléƒ½æŒ‡å‘helloç±»&lt;/span&gt;
&lt;span class="n"&gt;app&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;web&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;application&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;urls&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="nb"&gt;globals&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt; &lt;span class="c1"&gt;# ç»‘å®šurl&lt;/span&gt;

&lt;span class="c1"&gt;# å®šä¹‰ç›¸åº”ç±»&lt;/span&gt;
&lt;span class="k"&gt;class&lt;/span&gt; &lt;span class="nc"&gt;hello&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;GET&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="bp"&gt;self&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
&lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;Hello, world!&amp;#39;&lt;/span&gt;

&lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="vm"&gt;__name__&lt;/span&gt; &lt;span class="o"&gt;==&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;__main__&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;span class="n"&gt;app&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åä¿å­˜ä¸º&lt;code&gt;hello.py&lt;/code&gt;å¹¶è¿è¡Œå®ƒ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;python hello.py
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åä¼šçœ‹åˆ°è¾“å‡º:http://0.0.0.0:8080/&lt;/p&gt;
&lt;p&gt;ç„¶åæµè§ˆå™¨è®¿é—®:http://localhost:8080å³å¯çœ‹åˆ°
&lt;code&gt;Hello, world!&lt;/code&gt;
æˆ‘ä»¬ç¬¬ä¸€ä¸ªç”¨pythonå†™çš„webç¨‹åºå°±å»ºç«‹å®Œæˆ.&lt;/p&gt;</content><category term="Python"></category><category term="å¼€å‘"></category><category term="web.py"></category><category term="Ubuntu"></category><category term="python"></category><category term="Linux"></category></entry><entry><title>Linuxä¸‹é…ç½®vimä¸€é”®ç¼–è¯‘C/C++å¹¶æ‰§è¡Œ</title><link href="https://www.linuxzen.com/linuxxia-pei-zhi-vimyi-jian-bian-yi-ccbing-zhi-xing.html" rel="alternate"></link><published>2012-04-05T12:07:00+08:00</published><updated>2012-04-05T12:07:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-04-05:/linuxxia-pei-zhi-vimyi-jian-bian-yi-ccbing-zhi-xing.html</id><summary type="html">&lt;p&gt;æœ€è¿‘åœ¨å­¦ä¹ C++,ç¼–è¾‘å™¨å½“ç„¶æ˜¯vim,æƒ³åœ¨ç¼–è¾‘çš„æ—¶å€™å¯ä»¥ä¸€é”®ç¼–è¯‘,äºæ˜¯è‡ªå·±å†™äº†ä¸€ä¸ªå°è„šæœ¬é…åˆvimæ¥å®ç°.ç”±äºåˆšå¼€å§‹å­¦,æ‰€ä»¥å¯¹C â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;æœ€è¿‘åœ¨å­¦ä¹ C++,ç¼–è¾‘å™¨å½“ç„¶æ˜¯vim,æƒ³åœ¨ç¼–è¾‘çš„æ—¶å€™å¯ä»¥ä¸€é”®ç¼–è¯‘,äºæ˜¯è‡ªå·±å†™äº†ä¸€ä¸ªå°è„šæœ¬é…åˆvimæ¥å®ç°.ç”±äºåˆšå¼€å§‹å­¦,æ‰€ä»¥å¯¹C/C++çš„æ‰©å±•åä¸å¤ªäº†è§£,æ‰€ä»¥åªå¯¹.cpp .cc .cè¿›è¡Œå¤„ç†.&lt;/p&gt;
&lt;p&gt;é¦–å…ˆåœ¨/usr/bin/ä¸‹åˆ›å»ºcompileè„šæœ¬:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi /usr/bin/compile
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ·»åŠ å¦‚ä¸‹å†…å®¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="c1"&gt;# Filename : compile&lt;/span&gt;
&lt;span class="c1"&gt;# Describe : To compile c/c++&lt;/span&gt;
&lt;span class="c1"&gt;# Author   : cold night(www.linuxzen.com)&lt;/span&gt;
&lt;span class="c1"&gt;# Version  : 0.2&lt;/span&gt;
&lt;span class="c1"&gt;# Change   : å¢åŠ ç»ˆç«¯ç€è‰² &lt;/span&gt;

clear
&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$#&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-eq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="k"&gt;then&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nv"&gt;filename&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="nv"&gt;$1&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nv"&gt;outname&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;%&lt;/span&gt;&lt;span class="se"&gt;\.&lt;/span&gt;&lt;span class="p"&gt;*&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nv"&gt;typename&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="si"&gt;${&lt;/span&gt;&lt;span class="nv"&gt;filename&lt;/span&gt;&lt;span class="p"&gt;#*&lt;/span&gt;&lt;span class="se"&gt;\.&lt;/span&gt;&lt;span class="si"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;test&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$typename&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;cpp&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;||&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$typename&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;cc&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-n&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Compiling...&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;g++&lt;span class="w"&gt; &lt;/span&gt;-o&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$outname&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$filename&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/tmp/errinfo&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$?&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-eq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;       \033[32;1mSuccess!!!\033[0m&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;------------------------&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\033[1;44mRunning...\033[0m&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;------------------------&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;./&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$outname&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;------------------------&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;       \033[1;31mError!!!\033[0m&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;------------------------&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\033[1;44mError Info:\033[0m&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;------------------------&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;cat&lt;span class="w"&gt; &lt;/span&gt;/tmp/errinfo
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;------------------------&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;fi&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;elif&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$typename&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;c&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Compiling...&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;------------------------&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;gcc&lt;span class="w"&gt; &lt;/span&gt;-o&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$outname&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$filename&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&amp;gt;/tmp/errinfo&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$?&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-eq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;       \033[32;1mSuccess!!!\033[0m&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;------------------------&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\033[1;44mRunning...\033[0m&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;------------------------&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;./&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$outname&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;------------------------&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;       \033[1;31mError!!!\033[0m&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;------------------------&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;\033[1;44mError Info:\033[0m&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;------------------------&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;cat&lt;span class="w"&gt; &lt;/span&gt;/tmp/errinfo
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;------------------------&amp;quot;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;fi&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;fi&lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;Error: No intput filename&amp;#39;&lt;/span&gt;
&lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åç»™è„šæœ¬èµ‹äºˆæ‰§è¡Œæƒé™&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;chmod +x /usr/bin/compile
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åç¼–è¾‘vimé…ç½®æ–‡ä»¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi ~/.vimrc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæ·»åŠ ä¸‹é¢å†…å®¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c"&gt;&amp;quot; C++ complier&lt;/span&gt;
autocmd &lt;span class="nb"&gt;FileType&lt;/span&gt; cpp map &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;F8&lt;span class="p"&gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;Esc&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;:&lt;span class="k"&gt;w&lt;/span&gt;&lt;span class="p"&gt;!&amp;lt;&lt;/span&gt;CR&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;:&lt;span class="p"&gt;!&lt;/span&gt;&lt;span class="k"&gt;compile&lt;/span&gt; %&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;CR&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
autocmd &lt;span class="nb"&gt;FileType&lt;/span&gt; &lt;span class="k"&gt;cc&lt;/span&gt; map &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;F8&lt;span class="p"&gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;Esc&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;:&lt;span class="k"&gt;w&lt;/span&gt;&lt;span class="p"&gt;!&amp;lt;&lt;/span&gt;CR&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;:&lt;span class="p"&gt;!&lt;/span&gt;&lt;span class="k"&gt;compile&lt;/span&gt; %&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;CR&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
autocmd &lt;span class="nb"&gt;FileType&lt;/span&gt; &lt;span class="k"&gt;c&lt;/span&gt; map &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;F8&lt;span class="p"&gt;&amp;gt;&lt;/span&gt; &lt;span class="p"&gt;&amp;lt;&lt;/span&gt;Esc&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;:&lt;span class="k"&gt;w&lt;/span&gt;&lt;span class="p"&gt;!&amp;lt;&lt;/span&gt;CR&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;:&lt;span class="p"&gt;!&lt;/span&gt;&lt;span class="k"&gt;compile&lt;/span&gt; %&lt;span class="p"&gt;&amp;lt;&lt;/span&gt;CR&lt;span class="p"&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é…ç½®å®Œæ¯•æˆ‘ä»¬å°±å¯ä»¥ç”¨vimç¼–è¾‘C/C++æºæ–‡ä»¶çš„æ—¶å€™æŒ‰F8å°±å¯ä»¥è¿›è¡Œä¸€é”®ç¼–è¯‘æ‰§è¡Œ.&lt;/p&gt;</content><category term="Vim"></category><category term="ç¼–è¯‘"></category><category term="ä¸€é”®"></category><category term="vim"></category><category term="Linux"></category><category term="C/C++"></category></entry><entry><title>ä½¿ç”¨cactiæ„å»ºç›‘æ§ç³»ç»Ÿ</title><link href="https://www.linuxzen.com/shi-yong-cactigou-jian-jian-kong-xi-tong.html" rel="alternate"></link><published>2012-03-14T14:02:00+08:00</published><updated>2012-03-14T14:02:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-03-14:/shi-yong-cactigou-jian-jian-kong-xi-tong.html</id><summary type="html">&lt;p&gt;Cactiæ˜¯ä¸€å¥—åŸºäºPHP,MySQL,SNMPåŠRRDToolå¼€å‘çš„ç½‘ç»œæµé‡ç›‘æµ‹å›¾å½¢åˆ†æå·¥å…·,å®ƒæ˜¯é€šè¿‡ snmpgetæ¥è·å–æ•°æ®ï¼Œä½¿ç”¨ RRDtoolç»˜ç”»å›¾å½¢,å¯ä»¥æŒ‡å®šæ¯ä¸€ä¸ªç”¨æˆ·èƒ½æŸ¥çœ‹æ ‘çŠ¶ç»“æ„ã€hostä»¥åŠä»»ä½•ä¸€å¼ å›¾ï¼Œè¿˜å¯ä»¥ä¸LDAPç»“åˆè¿›è¡Œç”¨æˆ·éªŒè¯ï¼ŒåŒæ—¶ä¹Ÿèƒ½è‡ªå·±å¢åŠ æ¨¡æ¿ï¼ŒåŠŸèƒ½éå¸¸å¼ºå¤§å®Œ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;Cactiæ˜¯ä¸€å¥—åŸºäºPHP,MySQL,SNMPåŠRRDToolå¼€å‘çš„ç½‘ç»œæµé‡ç›‘æµ‹å›¾å½¢åˆ†æå·¥å…·,å®ƒæ˜¯é€šè¿‡ snmpgetæ¥è·å–æ•°æ®ï¼Œä½¿ç”¨ RRDtoolç»˜ç”»å›¾å½¢,å¯ä»¥æŒ‡å®šæ¯ä¸€ä¸ªç”¨æˆ·èƒ½æŸ¥çœ‹æ ‘çŠ¶ç»“æ„ã€hostä»¥åŠä»»ä½•ä¸€å¼ å›¾ï¼Œè¿˜å¯ä»¥ä¸LDAPç»“åˆè¿›è¡Œç”¨æˆ·éªŒè¯ï¼ŒåŒæ—¶ä¹Ÿèƒ½è‡ªå·±å¢åŠ æ¨¡æ¿ï¼ŒåŠŸèƒ½éå¸¸å¼ºå¤§å®Œå–„ã€‚ç•Œé¢å‹å¥½ã€‚&lt;/p&gt;
&lt;p&gt;cactiæ˜¯ç”¨phpè¯­è¨€å®ç°çš„ä¸€ä¸ªè½¯ä»¶ï¼Œå®ƒçš„ä¸»è¦åŠŸèƒ½æ˜¯ç”¨snmpæœåŠ¡è·å–æ•°æ®ï¼Œç„¶åç”¨rrdtoolå‚¨å­˜å’Œæ›´æ–°æ•°æ®ï¼Œå½“ç”¨æˆ·éœ€è¦æŸ¥çœ‹æ•°æ®çš„æ—¶å€™ç”¨rrdtoolç”Ÿæˆå›¾è¡¨å‘ˆç°ç»™ç”¨æˆ·ã€‚å› æ­¤ï¼Œsnmpå’Œrrdtoolæ˜¯cactiçš„å…³é”®ã€‚Snmpå…³ç³»ç€æ•°æ®çš„æ”¶é›†ï¼Œrrdtoolå…³ç³»ç€æ•°æ®å­˜å‚¨å’Œå›¾è¡¨çš„ç”Ÿæˆã€‚&lt;/p&gt;
&lt;p&gt;cactiä¾èµ–äºPHP+MYSQLç¯å¢ƒ,å‰é¢çš„å‡ ç¯‡æ–‡ç« å·²ç»è¯¦ç»†è®²è§£äº†å¦‚ä½•åœ¨Linuxéƒ¨ç½²LNMPç¯å¢ƒ,è¿™ç¯‡æ–‡ç« æˆ‘ä»¬å°±æ˜¯ç”¨å‰é¢å‡ ç« æ‰€æ­å»ºçš„ç¯å¢ƒ,æ‰€ä»¥è¿™é‡Œä¸å†è®²è§£å¦‚ä½•æ­å»ºç¯å¢ƒ,å¦‚æœæ‚¨ä¸ä¼šå¯ä»¥å…ˆçœ‹çœ‹å‰å‡ ç¯‡æ–‡ç« .&lt;/p&gt;
&lt;p&gt;ä¸‹é¢å°±ä»‹ç»å¦‚ä½•æ¥éƒ¨ç½²cacti.&lt;/p&gt;
&lt;p&gt;é¦–å…ˆä»‹ç»æœ¬æ–‡æ‰€ä½¿ç”¨çš„ç¯å¢ƒ:
server:&lt;/p&gt;
&lt;p&gt;ç³»ç»Ÿä¸ºCentOS 5.5 32bit&lt;/p&gt;
&lt;p&gt;ip:192.168.3.120&lt;/p&gt;
&lt;p&gt;cacti:cacti-0.8.7i.tar.gz&lt;/p&gt;
&lt;p&gt;cactiä½¿ç”¨SNMPé‡‡é›†æ•°æ®,é¦–å…ˆå®‰è£…snmpæ•°æ®é‡‡é›†å·¥å…·:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;lm_sensors&lt;span class="w"&gt; &lt;/span&gt;net-snmp&lt;span class="w"&gt; &lt;/span&gt;net-snmp-utils
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åŒæ—¶cactiåˆä¾èµ–äºrrdtoolç”Ÿæˆå›¾è¡¨æ‰€ä»¥é¦–å…ˆå®‰è£…rrdtool:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;wget&lt;span class="w"&gt; &lt;/span&gt;http://oss.oetiker.ch/rrdtool/pub/rrdtool-1.4.7.tar.gz
yum&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;cairo-devel&lt;span class="w"&gt; &lt;/span&gt;glib2-devel&lt;span class="w"&gt; &lt;/span&gt;pango-devel&lt;span class="w"&gt; &lt;/span&gt;intltool&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# å®‰è£…rrdtoolä¾èµ–&lt;/span&gt;
./configure&lt;span class="w"&gt; &lt;/span&gt;--prefix&lt;span class="o"&gt;=&lt;/span&gt;/usr/local
make&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸‹é¢å°±æ¥ä¸‹è½½cactiå®‰è£…:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;wget&lt;span class="w"&gt; &lt;/span&gt;http://www.cacti.net/downloads/cacti-0.8.7i.tar.gz
tar&lt;span class="w"&gt; &lt;/span&gt;-zxvf&lt;span class="w"&gt; &lt;/span&gt;cacti-0.8.7i.tar.gz
cp&lt;span class="w"&gt; &lt;/span&gt;-r&lt;span class="w"&gt; &lt;/span&gt;cacti-0.8.7i&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nginx/html/cacti&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# å¤åˆ¶åˆ°htmlç›®å½•&lt;/span&gt;
useradd&lt;span class="w"&gt; &lt;/span&gt;cactiuser&lt;span class="w"&gt; &lt;/span&gt;-M&lt;span class="w"&gt; &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;/sbin/nologin&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="c1"&gt;# åˆ›å»ºcactiç”¨æˆ·&lt;/span&gt;
chown&lt;span class="w"&gt; &lt;/span&gt;-R&lt;span class="w"&gt; &lt;/span&gt;cactiuser.cactiuser&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nginx/html/cacti/rra/&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# æ”¹å˜å±ä¸»å’Œå±ç»„&lt;/span&gt;
chown&lt;span class="w"&gt; &lt;/span&gt;-R&lt;span class="w"&gt; &lt;/span&gt;cactiuser.cactiuser&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nginx/html/cacti/log/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åè¿›å…¥åˆ°æ•°æ®åº“åˆ›å»ºcactiæ•°æ®å’Œåˆ›å»ºä¸€ä¸ªç”¨æˆ·:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;create&lt;span class="w"&gt; &lt;/span&gt;database&lt;span class="w"&gt; &lt;/span&gt;cactidb&lt;span class="w"&gt; &lt;/span&gt;default&lt;span class="w"&gt; &lt;/span&gt;character&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;utf8&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;#åˆ›å»ºæ•°æ®åº“&lt;/span&gt;
grant&lt;span class="w"&gt; &lt;/span&gt;all&lt;span class="w"&gt; &lt;/span&gt;on&lt;span class="w"&gt; &lt;/span&gt;cactidb.*&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;cactiuser@localhost&lt;span class="w"&gt; &lt;/span&gt;identified&lt;span class="w"&gt; &lt;/span&gt;by&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;123456&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# åˆ›å»ºä¸€ä¸ªmysqlç”¨æˆ·&lt;/span&gt;
use&lt;span class="w"&gt; &lt;/span&gt;cactidb&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# ä½¿ç”¨åˆšæ‰åˆ›å»ºçš„æ•°æ®åº“&lt;/span&gt;
&lt;span class="nb"&gt;source&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nginx/html/cacti/cacti.sql&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# å¯¼å…¥cactiæ•°æ®&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ¥ä¸‹æ¥æˆ‘ä»¬ç¼–è¾‘cactié…ç½®æ–‡ä»¶/usr/local/nginx/html/cacti/include/config.php&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nginx/html/cacti/
vi&lt;span class="w"&gt; &lt;/span&gt;include/config.php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç¼–è¾‘ä¸‹é¢å†…å®¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nv"&gt;$database_type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;mysql&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="c1"&gt;# æ•°æ®åº“ç±»å‹&lt;/span&gt;
&lt;span class="nv"&gt;$database_default&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;cactidb&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="c1"&gt;# æ•°æ®åº“åå­—&lt;/span&gt;
&lt;span class="nv"&gt;$database_hostname&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;localhost&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# æ•°æ®åº“ä¸»æœº&lt;/span&gt;
&lt;span class="nv"&gt;$database_username&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;cactiuser&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# æ•°æ®åº“ç”¨æˆ·&lt;/span&gt;
&lt;span class="nv"&gt;$database_password&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;123456&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="c1"&gt;# æ•°æ®åº“å¯†ç &lt;/span&gt;
&lt;span class="nv"&gt;$database_port&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;3306&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="c1"&gt;# æ•°æ®åº“ç«¯å£&lt;/span&gt;
&lt;span class="nv"&gt;$database_ssl&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;false&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åä¿®æ”¹nginxé…ç½®æ–‡ä»¶åƒä¸‹é¢:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="w"&gt;        &lt;/span&gt;location&lt;span class="w"&gt; &lt;/span&gt;/&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;html&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;index&lt;span class="w"&gt;  &lt;/span&gt;index.php&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;location&lt;span class="w"&gt; &lt;/span&gt;~&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\.&lt;/span&gt;php$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_pass&lt;span class="w"&gt;        &lt;/span&gt;unix:/var/run/php-fpm/php-fpm.sock&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_index&lt;span class="w"&gt;       &lt;/span&gt;index.php&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_param&lt;span class="w"&gt; &lt;/span&gt;SCRIPT_FILENAME&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$document_root&lt;/span&gt;/&lt;span class="nv"&gt;$fastcgi_script_name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;include&lt;span class="w"&gt; &lt;/span&gt;fastcgi_params&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;include&lt;span class="w"&gt; &lt;/span&gt;fastcgi.conf&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é‡å¯nginx&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;pkill&lt;span class="w"&gt; &lt;/span&gt;-9&lt;span class="w"&gt; &lt;/span&gt;nginx
/usr/local/nginx/sbin/nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åè®¾ç½®phpæ—¶åŒº,&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nginx/html/cacti/
vi&lt;span class="w"&gt; &lt;/span&gt;include/global_constants.php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åœ¨ç¬¬äºŒè¡Œæ·»åŠ &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;date_default_timezone_set&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Asia/Chongqing&amp;quot;&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ¥ä¸‹æ¥é…ç½®snmp,ç¼–è¾‘/etc/snmp/snmpd.conf&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/etc/snmp/snmpd.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæ‰¾åˆ°41è¡Œå°†publicæ”¹æˆä¸€ä¸ªè¾ƒä¸ºå¤æ‚çš„åå­—:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;com2sec&lt;span class="w"&gt; &lt;/span&gt;notConfigUser&lt;span class="w"&gt;  &lt;/span&gt;default&lt;span class="w"&gt;       &lt;/span&gt;public
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæ‰¾åˆ°62è¡Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;access&lt;span class="w"&gt;  &lt;/span&gt;notConfigGroup&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;any&lt;span class="w"&gt;       &lt;/span&gt;noauth&lt;span class="w"&gt;    &lt;/span&gt;exact&lt;span class="w"&gt;  &lt;/span&gt;systemview&lt;span class="w"&gt; &lt;/span&gt;none&lt;span class="w"&gt; &lt;/span&gt;none
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å°†systemviewæ”¹æˆall:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;access&lt;span class="w"&gt;  &lt;/span&gt;notConfigGroup&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&amp;quot;&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;any&lt;span class="w"&gt;       &lt;/span&gt;noauth&lt;span class="w"&gt;    &lt;/span&gt;exact&lt;span class="w"&gt;  &lt;/span&gt;all&lt;span class="w"&gt; &lt;/span&gt;none&lt;span class="w"&gt; &lt;/span&gt;none
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åå»æ‰85è¡Œçš„æ³¨é‡Š:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;view&lt;span class="w"&gt; &lt;/span&gt;all&lt;span class="w"&gt;    &lt;/span&gt;included&lt;span class="w"&gt;  &lt;/span&gt;.1&lt;span class="w"&gt;                               &lt;/span&gt;&lt;span class="m"&gt;80&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¿å­˜é…ç½®æ–‡ä»¶åå¯åŠ¨snmp&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;service&lt;span class="w"&gt; &lt;/span&gt;snmpd&lt;span class="w"&gt; &lt;/span&gt;start
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶ååœ¨æµè§ˆå™¨é‡Œè¾“å…¥:http://192.168.3.120/cacti/
ç„¶åæ ¹æ®æç¤ºä¸€æ­¥æ­¥å®‰è£…,å®‰è£…å¥½åä½¿ç”¨adminå¯†ç adminç™»å½•.å¦‚æœç‚¹å‡»graphsä¸èƒ½æ˜¾ç¤ºå›¾åƒçš„è¯æ‰§è¡Œ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;php&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nginx/html/cacti/poller.php&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# nginxä¸‹ä¸ä¼šè‡ªåŠ¨ç”Ÿæˆ*.rrdæ–‡ä»¶å¿…é¡»æ‰‹åŠ¨æ‰§è¡Œè¿™æ¡å‘½ä»¤æ‰ä¼šç”Ÿæˆ,Debugæ²¡æŠ¥é”™,æµ‹è¯•æƒé™ä¹Ÿæ²¡é—®é¢˜,ä¸çŸ¥é“æ€ä¹ˆå›äº‹,æœ›çŸ¥é“çš„èƒ½å‘ŠçŸ¥å°å¼Ÿ&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸ºäº†æ–¹ä¾¿æŠŠè¿™å¥åŠ å…¥åˆ°cron,æ‰§è¡Œ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;vixie-cron&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;#å®‰è£…&lt;/span&gt;
service&lt;span class="w"&gt; &lt;/span&gt;crond&lt;span class="w"&gt; &lt;/span&gt;start
crontab&lt;span class="w"&gt; &lt;/span&gt;-e
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ·»åŠ å¦‚ä¸‹å†…å®¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;*/5&lt;span class="w"&gt; &lt;/span&gt;*&lt;span class="w"&gt; &lt;/span&gt;*&lt;span class="w"&gt; &lt;/span&gt;*&lt;span class="w"&gt; &lt;/span&gt;*&lt;span class="w"&gt; &lt;/span&gt;/usr/bin/php&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nginx/html/cacti/poller.php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¥½äº†è¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥æ‰“å¼€æŸ¥çœ‹ç”Ÿæˆçš„å›¾åƒäº†.
æ³¨æ„å¦‚æœæŠ¥å¦‚ä¸‹é”™è¯¯:
Call to undefined function session_unregister()
å°†session_unregister('username') æ”¹æˆ
$_SESSION['username']='';&lt;/p&gt;</content><category term="Linux"></category><category term="ç›‘æ§"></category><category term="lnmp"></category><category term="Linux"></category><category term="CentOS"></category><category term="cacti"></category></entry><entry><title>lnmpç¯å¢ƒæ­å»ºå®Œå…¨æ‰‹å†Œ(å››)â€”â€”lnmpæ­å»º(æºç å®‰è£…)</title><link href="https://www.linuxzen.com/lnmphuan-jing-da-jian-wan-quan-shou-ce-si-lnmpda-jian-yuan-ma-an-zhuang.html" rel="alternate"></link><published>2012-03-13T13:13:00+08:00</published><updated>2012-03-13T13:13:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-03-13:/lnmphuan-jing-da-jian-wan-quan-shou-ce-si-lnmpda-jian-yuan-ma-an-zhuang.html</id><summary type="html">&lt;p&gt;ä¸Šé¢3ç¯‡æˆ‘ä»¬ä¸»è¦å¯¹ç³»ç»Ÿè¿›è¡Œäº†å®‰è£…å’Œé…ç½®,å¹¶ä¸”é…ç½®äº†yumåŒ…ç®¡ç†å™¨,å®‰è£…äº†å‡ ä¸ªå¸¸ç”¨çš„å·¥å…·,è¿™ç¯‡æˆ‘ä»¬å°±æ¥ä»‹ç»å¦‚ä½•æ¥æ­å»ºlnmpç¯å¢ƒ.è¿™é‡Œçš„LNMPç¯å¢ƒæ˜¯æŒ‡Linuxä¸‹æ­å»ºNginx+MySQL+PHP.Nginxæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ HTTP å’Œ åå‘ä»£ç† æœåŠ¡å™¨ï¼Œä¹Ÿ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;ä¸Šé¢3ç¯‡æˆ‘ä»¬ä¸»è¦å¯¹ç³»ç»Ÿè¿›è¡Œäº†å®‰è£…å’Œé…ç½®,å¹¶ä¸”é…ç½®äº†yumåŒ…ç®¡ç†å™¨,å®‰è£…äº†å‡ ä¸ªå¸¸ç”¨çš„å·¥å…·,è¿™ç¯‡æˆ‘ä»¬å°±æ¥ä»‹ç»å¦‚ä½•æ¥æ­å»ºlnmpç¯å¢ƒ.è¿™é‡Œçš„LNMPç¯å¢ƒæ˜¯æŒ‡Linuxä¸‹æ­å»ºNginx+MySQL+PHP.Nginxæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„ HTTP å’Œ åå‘ä»£ç† æœåŠ¡å™¨ï¼Œä¹Ÿæ˜¯ä¸€ä¸ª IMAP/POP3/SMTP ä»£ç†æœåŠ¡å™¨ã€‚Nginxä¸ä»…å¯ä»¥ä½œä¸ºwebæœåŠ¡å™¨,ä¹Ÿå¯ä»¥ä½œä¸ºè´Ÿè½½å‡è¡¡å™¨,ä¹‹å‰ä¹Ÿæœ‰æ–‡ç« ä»‹ç»,å¤§å®¶å¯ä»¥çœ‹ä¸€ä¸‹.&lt;/p&gt;
&lt;p&gt;MySQLæ˜¯ä¸€æ¬¾å¼€æºå…è´¹çš„æ•°æ®è½¯ä»¶,MySQLæ˜¯ä¸€ä¸ªå°å‹å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œå…¶ä½“ç§¯å°ã€é€Ÿåº¦å¿«ã€æ€»ä½“æ‹¥æœ‰æˆæœ¬ä½ï¼Œå°¤å…¶æ˜¯å¼€æ”¾æºç è¿™ä¸€ç‰¹ç‚¹ï¼Œè®¸å¤šä¸­å°å‹ç½‘ç«™ä¸ºäº†é™ä½ç½‘ç«™æ€»ä½“æ‹¥æœ‰æˆæœ¬è€Œé€‰æ‹©äº†MySQLä½œä¸ºç½‘ç«™æ•°æ®åº“.&lt;/p&gt;
&lt;p&gt;PHPï¼Œæ˜¯è‹±æ–‡è¶…çº§æ–‡æœ¬é¢„å¤„ç†è¯­è¨€Hypertext Preprocessorçš„ç¼©å†™ã€‚PHP æ˜¯ä¸€ç§ HTML å†…åµŒå¼çš„è¯­è¨€ï¼Œæ˜¯ä¸€ç§åœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œçš„åµŒå…¥HTMLæ–‡æ¡£çš„è„šæœ¬è¯­è¨€ï¼Œè¯­è¨€çš„é£æ ¼æœ‰ç±»ä¼¼äºCè¯­è¨€ï¼Œè¢«å¹¿æ³›çš„è¿ç”¨ã€‚&lt;/p&gt;
&lt;p&gt;nginxå½“å‰æœ€æ–°ç¨³å®šç‰ˆæ˜¯nginx-1.0.13
é¦–å…ˆæˆ‘ä»¬ä¸‹è½½nginx,åœ¨Linuxä¸‹æ‰§è¡Œä¸‹é¢å‘½ä»¤:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/usr/src&lt;span class="w"&gt;                                           &lt;/span&gt;&lt;span class="c1"&gt;# ä¸€èˆ¬è½¯ä»¶æºç æ”¾åœ¨è¿™ä¸ªç›®å½•ä¸‹&lt;/span&gt;
wget&lt;span class="w"&gt; &lt;/span&gt;http://nginx.org/download/nginx-1.0.13.tar.gz&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# ä¸‹è½½&lt;/span&gt;
nginxä¼šæœ‰å‡ ä¸ªä¾èµ–åŒ…,æˆ‘ä»¬é¦–å…ˆå®‰è£…ä¾èµ–,ä¸è¦å®‰è£…è¿‡ç¨‹ä¸­ä¼šæŠ¥é”™:
yum&lt;span class="w"&gt;  &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;zlib-devel&lt;span class="w"&gt; &lt;/span&gt;pcre-devel&lt;span class="w"&gt; &lt;/span&gt;openssl-devel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸€èˆ¬æºä»£ç å®‰è£…åˆ†4ä¸ªæ­¥éª¤(æœ‰äººä¹Ÿä¼šçœå»ç¬¬ä¸€ä¸ªæ­¥éª¤),&lt;code&gt;è§£å‹&lt;/code&gt;(tarå‘½ä»¤)&lt;code&gt;é¢„ç¼–è¯‘&lt;/code&gt;(æ‰§è¡Œæºç åŒ…ä¸‹çš„configure),&lt;code&gt;ç¼–è¯‘&lt;/code&gt;(make),&lt;code&gt;ç¼–è¯‘å®‰è£…&lt;/code&gt;(make install)
é¦–å…ˆæˆ‘ä»¬è§£å‹æºç åŒ…:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;tar -zxvf nginx-1.0.13.tar.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™é‡Œè§£é‡Šä¸‹åŠ å‹å‚æ•°,zä»£è¡¨gzip(ä¹Ÿå°±æ˜¯åé¢çš„.gzæ–‡ä»¶)xä»£è¡¨åŠ å‹,vè¡¨ç¤ºæ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯,-fä½¿ç”¨æ¡£æ¡ˆæ–‡ä»¶æˆ–è®¾å¤‡(å¿…é€‰å‚æ•°)&lt;/p&gt;
&lt;p&gt;ç„¶åæˆ‘ä»¬è¿›è¡Œé¢„ç¼–è¯‘,ä¸€èˆ¬é¢„ç¼–è¯‘ä¼šå¸¦ä¸Šä¸€äº›å‚æ•°,å·²è¾¾åˆ°æˆ‘ä»¬æƒ³è¦å®‰è£…çš„æ•ˆæœ,æ¯”å¦‚å¯ç”¨æŸä¸ªåŠŸèƒ½,ç¦ç”¨æŸä¸ªåŠŸèƒ½:&lt;/p&gt;
&lt;p&gt;è¿›å…¥æºç åŒ…ç›®å½•è¿›è¡Œé¢„ç¼–è¯‘:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;nginx-1.0.13
&lt;span class="w"&gt; &lt;/span&gt;./configure&lt;span class="w"&gt; &lt;/span&gt;--prefix&lt;span class="o"&gt;=&lt;/span&gt;/usr/local/nginx&lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# æŒ‡å®šå®‰è£…ç›®å½•ä¸º/usr/local/nginx&lt;/span&gt;
--with-openssl&lt;span class="o"&gt;=&lt;/span&gt;/usr/include/openssl&lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# å¯ç”¨ssl&lt;/span&gt;
--with-pcre&lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="w"&gt;                         &lt;/span&gt;&lt;span class="c1"&gt;# å¯ç”¨æ­£è§„è¡¨è¾¾å¼&lt;/span&gt;
--with-http_stub_status_module&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# å®‰è£…å¯ä»¥æŸ¥çœ‹nginxçŠ¶æ€çš„ç¨‹åº&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å…¶ä¸­./configureæŒ‡æ‰§è¡Œå½“å‰ç›®å½•ä¸‹çš„&lt;code&gt;configure&lt;/code&gt;æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;é¢„ç¼–è¯‘å®Œæˆåæˆ‘ä»¬å°±å¯ä»¥è¿›è¡Œç¼–è¯‘å’Œå®‰è£…:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;make           #ç¼–è¯‘
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ‰§è¡Œåmakeåä¼šæœ‰å¤§é‡è¾“å‡º,ç­‰å¾…è¾“å‡ºå®Œæˆåå¦‚æœæ²¡æœ‰æŠ¥é”™å°±å¯ä»¥è¿›è¡Œå®‰è£…æ‰§è¡Œ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;make install   #å®‰è£…
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…å®Œæˆåæˆ‘ä»¬å¯ä»¥åˆ°ç›¸åº”çš„ç›®å½•æŸ¥çœ‹å®‰è£…çš„æ–‡ä»¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ls&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nginx/
conf&lt;span class="w"&gt;  &lt;/span&gt;html&lt;span class="w"&gt;  &lt;/span&gt;logs&lt;span class="w"&gt;  &lt;/span&gt;sbin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¥½äº†,ä¸‹é¢æˆ‘ä»¬å¯åŠ¨nginx:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;/usr/local/nginx/sbin/nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é€šè¿‡æŸ¥çœ‹ç«¯å£çœ‹nginxæ˜¯å¦å¯åŠ¨æˆåŠŸ,nginxå ç”¨TCPçš„80ç«¯å£,æ‰§è¡Œä¸‹é¢å‘½ä»¤:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt; netstat -antlp Â¦ grep 80
tcp        0      0 0.0.0.0:80                  0.0.0.0:*                   LISTEN      5946/nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬æŸ¥çœ‹80ç«¯å£æ˜¯å¼€æ”¾çš„&lt;/p&gt;
&lt;p&gt;ç„¶åæ‰“å¼€æµè§ˆå™¨è®¿é—®http://192.168.3.120,æˆ‘ä»¬ä¼šçœ‹åˆ°Welcome to nginx(ä¹‹å‰çš„ç‰ˆæœ¬æ˜¯ It's Work):&lt;/p&gt;
&lt;p&gt;nginxå®‰è£…å®Œæ¯•åæˆ‘ä»¬æ¥å®‰è£…MySQL ,æˆ‘ä»¬ä½¿ç”¨MySQl-5.0.95ç‰ˆé¦–å…ˆä¸‹è½½:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;wget&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;dev&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;mysql&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;com&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;get&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;Downloads&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;MySQL&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;5.0&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;mysql&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="mf"&gt;5.0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;95.&lt;/span&gt;&lt;span class="n"&gt;tar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;gz&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;from&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;http&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;//&lt;/span&gt;&lt;span class="n"&gt;mysql&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cdpa&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;nsysu&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;edu&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;tw&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…ä¹‹å‰æˆ‘ä»¬å…ˆåšä¸€äº›å‡†å¤‡å·¥ä½œ,&lt;/p&gt;
&lt;p&gt;å®‰è£…ä¾èµ–:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum -y install ncurses-devel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åˆ›å»ºMySQLç”¨æˆ·:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;useradd&lt;span class="w"&gt; &lt;/span&gt;-M&lt;span class="w"&gt; &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;/sbin/nologin&lt;span class="w"&gt; &lt;/span&gt;mysql&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# -Mä¸åˆ›å»ºhomeç›®å½•,-sæŒ‡å®šshellä¸ºä¸ç™»å½•&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åè¿›è¡Œå®‰è£…:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;tar&lt;span class="w"&gt; &lt;/span&gt;-zxvf&lt;span class="w"&gt; &lt;/span&gt;mysql-5.0.95.tar.gz
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;mysql-5.0.95
./configure&lt;span class="w"&gt; &lt;/span&gt;--prefix&lt;span class="o"&gt;=&lt;/span&gt;/usr/local/mysql&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
--without-debug&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="w"&gt;                                &lt;/span&gt;&lt;span class="c1"&gt;# å–æ¶ˆè°ƒè¯•æ¨¡å¼æé«˜æ€§èƒ½&lt;/span&gt;
--with-extra-charsets&lt;span class="o"&gt;=&lt;/span&gt;utf8,gbk&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="w"&gt;                 &lt;/span&gt;&lt;span class="c1"&gt;# ä»…ä»…æŒ‡å®šéœ€è¦çš„é»˜è®¤å­—ç¬¦é›†æé«˜æ€§èƒ½&lt;/span&gt;
--enable-assembler&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="w"&gt;                             &lt;/span&gt;&lt;span class="c1"&gt;# ä½¿ç”¨æ±‡ç¼–æ¨¡å¼æé«˜æ€§èƒ½&lt;/span&gt;
--with-mysqld-ldflags&lt;span class="o"&gt;=&lt;/span&gt;-all-static&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="c1"&gt;# ä»¥é™æ€æ–¹å¼ç¼–è¯‘æé«˜æ€§èƒ½&lt;/span&gt;
--with-client-ldflags&lt;span class="o"&gt;=&lt;/span&gt;-all-static&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
--with-unix-socket-path&lt;span class="o"&gt;=&lt;/span&gt;/tmp/mysql.sock&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# ä½¿ç”¨unix socketæé«˜æ€§èƒ½&lt;/span&gt;
--with-ssl
make
make&lt;span class="w"&gt; &lt;/span&gt;install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…å®Œæˆåå¤åˆ¶é…ç½®æ–‡ä»¶å’Œå¯åŠ¨è„šæœ¬:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;cp&lt;span class="w"&gt; &lt;/span&gt;support-files/my-medium.cnf&lt;span class="w"&gt; &lt;/span&gt;/etc/my.cnf&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="c1"&gt;# å¤åˆ¶é…ç½®æ–‡ä»¶&lt;/span&gt;
cp&lt;span class="w"&gt; &lt;/span&gt;support-files/mysql.server&lt;span class="w"&gt; &lt;/span&gt;/etc/init.d/mysqld&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# å¤åˆ¶å¯åŠ¨è„šæœ¬&lt;/span&gt;
chmod&lt;span class="w"&gt; &lt;/span&gt;+x&lt;span class="w"&gt; &lt;/span&gt;/etc/init.d/mysqld&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="c1"&gt;# ç»™å¯åŠ¨è„šæœ¬æ‰§è¡Œæƒé™&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸ºäº†ä»¥åæ–¹ä¾¿æˆ‘ä»¬ä¸ºæ‰€æœ‰çš„äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶å’ŒåŠ¨æ€é“¾æ¥åº“æ–‡ä»¶åšä¸€ä¸ªè½¯è¿æ¥:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ln&lt;span class="w"&gt; &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;/usr/local/mysql/bin/*&lt;span class="w"&gt; &lt;/span&gt;/usr/local/bin/&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="c1"&gt;# ä¸ºå¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶åšè½¯è¿æ¥&lt;/span&gt;
ln&lt;span class="w"&gt; &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;/usr/local/mysql/lib/mysql/lib*&lt;span class="w"&gt; &lt;/span&gt;/usr/lib/&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# ä¸ºåŠ¨æ€é“¾æ¥åº“åšä¸€ä¸ªè½¯è¿æ¥&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæˆ‘ä»¬åˆå§‹åŒ–æ•°æ®åº“:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mysql_install_db&lt;span class="w"&gt; &lt;/span&gt;--user&lt;span class="o"&gt;=&lt;/span&gt;mysql&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# ç”¨MySQLç”¨æˆ·å®‰è£…æ•°æ®åº“&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸ºäº†MySQLèƒ½æ­£å¸¸ä½¿ç”¨æˆ‘ä»¬éœ€è¦æ›´æ”¹ä¸€ä¸‹MySQLå®‰è£…ç›®å½•å’ŒMySQLçš„æ•°æ®åº“ç›®å½•çš„å±ä¸»å’Œå±ç»„:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;chown&lt;span class="w"&gt; &lt;/span&gt;-R&lt;span class="w"&gt; &lt;/span&gt;root.mysql&lt;span class="w"&gt; &lt;/span&gt;/usr/local/mysql/&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="c1"&gt;# æ›´æ”¹å®‰è£…ç›®å½•å±ä¸»ä¸ºroot,å±ç»„ä¸ºmysql&lt;/span&gt;
chown&lt;span class="w"&gt; &lt;/span&gt;-R&lt;span class="w"&gt; &lt;/span&gt;mysql.mysql&lt;span class="w"&gt; &lt;/span&gt;/usr/local/mysql/var/&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;# æ›´æ”¹æ•°æ®åº“ç›®å½•å±ä¸»å’Œå±ç»„éƒ½ä¸ºmysql&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™é‡Œçš„&lt;code&gt;-R&lt;/code&gt;å‚æ•°ç”¨æ¥åº”ç”¨åˆ°æ‰€æœ‰å­ç›®å½•å’Œæ–‡ä»¶&lt;/p&gt;
&lt;p&gt;é…ç½®å®Œæ¯•åæˆ‘ä»¬å¯åŠ¨mysql:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;service mysqld start
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç°åœ¨æˆ‘ä»¬æŸ¥çœ‹MySQLæ˜¯å¦å¯åŠ¨æˆåŠŸ,MySQLå ç”¨TCPçš„3306ç«¯å£,æˆ‘ä»¬æŸ¥çœ‹ç«¯å£æ˜¯å¦è¢«å ç”¨:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;netstat -antlp Â¦ grep 3306
tcp        0      0 0.0.0.0:3306                0.0.0.0:*                   LISTEN      32143/mysqld
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæˆ‘ä»¬é€šè¿‡mysqlå‘½ä»¤æ¥è¿æ¥mysql:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mysql
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¼šæ˜¾ç¤ºå¦‚ä¸‹å†…å®¹è¡¨ç¤ºå·²ç»æˆåŠŸå¯åŠ¨MySQLå¹¶å·²ç»è¿æ¥ä¸Š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;Welcome&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MySQL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;monitor&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;Commands&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;end&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;with&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;or&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;\g.&lt;/span&gt;
&lt;span class="n"&gt;Your&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;MySQL&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;connection&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;id&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;1&lt;/span&gt;
&lt;span class="n"&gt;Server&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nl"&gt;version:&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;5.0.95&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;log&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Source&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;distribution&lt;/span&gt;

&lt;span class="n"&gt;Copyright&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;c&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;2000&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;2011&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Oracle&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;and&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;or&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;its&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;affiliates&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;All&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;rights&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;reserved&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;

&lt;span class="n"&gt;Oracle&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;is&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;registered&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;trademark&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;of&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Oracle&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Corporation&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;and&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;or&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;its&lt;/span&gt;
&lt;span class="n"&gt;affiliates&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Other&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;names&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;may&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;be&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;trademarks&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;of&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;their&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;respective&lt;/span&gt;
&lt;span class="n"&gt;owners&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;

&lt;span class="n"&gt;Type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mh"&gt;&amp;#39;he&lt;/span&gt;&lt;span class="n"&gt;lp&lt;/span&gt;&lt;span class="p"&gt;;&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;or&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;\h&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;help&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Type&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sc"&gt;&amp;#39;\c&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;clear&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;the&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;current&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;input&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;statement&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;

&lt;span class="n"&gt;mysql&lt;/span&gt;&lt;span class="o"&gt;&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;MySQLå®‰è£…å®Œæ¯•ä¸‹é¢æˆ‘ä»¬å°±æ¥å®‰è£…PHP,å®‰è£…PHPå‰é¦–å…ˆè¦å®‰è£…å‡ ä¸ªæºç åŒ…ä¾èµ–:&lt;code&gt;libmcrypt&lt;/code&gt; &lt;code&gt;mhash&lt;/code&gt; &lt;code&gt;mcrypt&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;é¦–å…ˆæ¥å®‰è£…å‡ ä¸ªæºç åŒ…ä¾èµ–:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;wget&lt;span class="w"&gt; &lt;/span&gt;http://sourceforge.net/projects/mcrypt/files/Libmcrypt/2.5.8/libmcrypt-2.5.8.tar.bz2/download
tar&lt;span class="w"&gt; &lt;/span&gt;-jxvf&lt;span class="w"&gt; &lt;/span&gt;libmcrypt-2.5.8.tar.bz2&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# è¿™ä¸ªåŒ…æ˜¯bz2çš„  ä½¿ç”¨-jå‚æ•°è§£å‹&lt;/span&gt;
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;libmcrypt-2.5.8
./configure
make
make&lt;span class="w"&gt; &lt;/span&gt;install
&lt;span class="c1"&gt;####################################################&lt;/span&gt;
wget&lt;span class="w"&gt; &lt;/span&gt;http://sourceforge.net/projects/mhash/files/mhash/0.9.9.9/mhash-0.9.9.9.tar.bz2/download
tar&lt;span class="w"&gt; &lt;/span&gt;-jxvf&lt;span class="w"&gt; &lt;/span&gt;mhash-0.9.9.9.tar.bz2
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;mhash-0.9.9.9
./configure
make
make&lt;span class="w"&gt; &lt;/span&gt;install
&lt;span class="c1"&gt;# è¿™ä¸¤ä¸ªåŒ…å®‰è£…å®Œæˆåè¦æŠŠåŠ¨æ€é“¾æ¥åº“åšä¸€ä¸ªè½¯è¿æ¥åˆ°/usr/lib,ä»¥ä¸ºæ¥ä¸‹æ¥çš„mcryptä¾èµ–äºè¿™ä¸¤ä¸ªåŒ…&lt;/span&gt;
ln&lt;span class="w"&gt; &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;/usr/local/lib/libmcrypt*&lt;span class="w"&gt; &lt;/span&gt;/usr/lib
ln&lt;span class="w"&gt; &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;/usr/local/lib/libmhash.*&lt;span class="w"&gt; &lt;/span&gt;/usr/lib/
ln&lt;span class="w"&gt; &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;/usr/local/bin/libmcrypt-config&lt;span class="w"&gt; &lt;/span&gt;/usr/bin/libmcrypt-config
&lt;span class="c1"&gt;###########################################################&lt;/span&gt;
wget&lt;span class="w"&gt; &lt;/span&gt;http://sourceforge.net/projects/mcrypt/files/MCrypt/2.6.8/mcrypt-2.6.8.tar.gz/download
tar&lt;span class="w"&gt; &lt;/span&gt;-zxvf&lt;span class="w"&gt; &lt;/span&gt;mcrypt-2.6.8.tar.gz
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;mcrypt-2.6.8
./configure
make
make&lt;span class="w"&gt; &lt;/span&gt;install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åä¸‹è½½php:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;wget http://cn2.php.net/get/php-5.4.0.tar.bz2/from/this/mirror
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…ä¾èµ–:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum â€“y install libxml2-devel curl-devel libpng-devel openldap-devel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æˆ‘ä»¬ä½¿ç”¨nginxè°ƒç”¨phpçš„æ—¶å€™ä½¿ç”¨fpmçš„æ–¹å¼,åœ¨php 5.4ä¸­åŠ å…¥äº†å¯¹php-fpmçš„æ”¯æŒ,æ‰€ä»¥å°±ä¸éœ€è¦æ‰“è¡¥ä¸äº†.å®‰è£…PHP:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;tar -jxvf php-5.4.0.tar.bz2
cd php-5.4.0
./configure --prefix=/usr/local/php --with-mysql=/usr/local/mysql/ --with-zlib --enable-xml --disable-rpath --enable-safe-mode --enable-bcmath --enable-shmop --enable-sysvsem --with-curl --with-curlwrappers --enable-fpm --enable-fastcgi --with-mcrypt --with-gd --with-openssl --with-mhash --enable-sockets --with-ldap --with-ldap-sasl --with-xmlrpc -enable-zip --enable-soap
make
make install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åˆ°è¿™é‡Œæ•´ä¸ªLNMPå·²ç»å®‰è£…å®Œæˆ.ä¸‹é¢æˆ‘ä»¬å°±é…ç½®phpå’Œnginxèƒ½è¿è¡Œphpç½‘ç«™:
é¦–å…ˆä¸ºphpåˆ›å»ºé…ç½®æ–‡ä»¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;cp php.ini-production /usr/local/php/php.ini # å¦‚æœæ˜¯å¼€å‘å°±å¤åˆ¶php.ini-development
cp /usr/local/php/etc/php-fpm.conf.default /usr/local/php/etc/php-fpm.conf
ln -s /usr/local/php/bin/php /usr/bin/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é…ç½®php-fpm,ç¼–è¾‘php-fpm.conf&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi /usr/local/php/etc/php-fpm.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ‰¾åˆ°listené‚£ä¸€è¡Œ,ä¿®æ”¹æˆå¦‚ä¸‹å†…å®¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;listen&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;php&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fpm&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;php&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fpm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# ä½¿ç”¨unix socket&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¯åŠ¨php-fpm&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;mkdir&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;php&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fpm&lt;/span&gt;
&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;usr&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;local&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;php&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;sbin&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;php&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fpm&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åé…ç½®nginx,ç¼–è¾‘nginxé…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi /usr/local/nginx/conf/nginx.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¿®æ”¹nginxé…ç½®æ–‡ä»¶æ”¯æŒphp:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;listen&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="mi"&gt;80&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;server_name&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;localhost&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;#charset koi8-r;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;#access_log  logs/host.access.log  main;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;location&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;php&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;html&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;htm&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="c1"&gt;# æ·»åŠ index.phpçš„é¦–é¡µæ–‡ä»¶&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# æ·»åŠ ä¸‹é¢å†…å®¹&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;location&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;~&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;\&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;php&lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;fastcgi_pass&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="n"&gt;unix&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="k"&gt;var&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;run&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;php&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fpm&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;php&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;fpm&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;fastcgi_index&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="n"&gt;index&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;php&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;fastcgi_param&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;SCRIPT_FILENAME&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;$&lt;/span&gt;&lt;span class="n"&gt;document_root&lt;/span&gt;&lt;span class="o"&gt;/$&lt;/span&gt;&lt;span class="n"&gt;fastcgi_script_name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fastcgi_params&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="n"&gt;include&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;fastcgi&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;conf&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¿®æ”¹å®Œæ¯•åä¿å­˜é€€å‡ºé‡å¯nginx:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;pkill -9 nignx
/usr/local/nginx/sbin/nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶ååœ¨/usr/local/nginx/htmlä¸‹åˆ›å»ºindex.php,&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi /usr/local/nginx/html/index.php
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ·»åŠ ä¸‹é¢å†…å®¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="cp"&gt;&amp;lt;?php&lt;/span&gt;
&lt;span class="nb"&gt;phpinfo&lt;/span&gt;&lt;span class="p"&gt;();&lt;/span&gt;
&lt;span class="cp"&gt;?&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¿å­˜é€€å‡ºåè®¿é—®&lt;a href=""&gt;http://192.168.3.120/index.php&lt;/a&gt;,çœ‹åˆ°ä¸‹é¢é¡µé¢è¡¨ç¤ºå·²ç»å®‰è£…é…ç½®æˆåŠŸ:&lt;/p&gt;
&lt;p&gt;&lt;img alt="linuxzen.com" src="/upload/QQæˆªå›¾20120313133251.jpg"&gt;
åˆ°è¿™é‡Œæˆ‘ä»¬çš„LNMPç¯å¢ƒå°±å®Œå…¨æ­å»ºæˆåŠŸ,è¿è¡Œä½ çš„ç½‘ç«™æˆ–è€…å­¦ä¹ ä½ çš„PHPå§.&lt;/p&gt;</content><category term="Linux"></category><category term="æºç åŒ…"></category><category term="å®‰è£…"></category><category term="php"></category><category term="nginx"></category><category term="MySQL"></category><category term="Linux"></category><category term="CentOS"></category></entry><entry><title>lnmpç¯å¢ƒæ­å»ºå®Œå…¨æ‰‹å†Œ(ä¸‰)â€”â€”åº”ç”¨å®‰è£…(yumé…ç½®å’ŒåŒ…å®‰è£…)</title><link href="https://www.linuxzen.com/lnmphuan-jing-da-jian-wan-quan-shou-ce-san-ying-yong-an-zhuang-yumpei-zhi-he-bao-an-zhuang.html" rel="alternate"></link><published>2012-03-13T10:06:00+08:00</published><updated>2012-03-13T10:06:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-03-13:/lnmphuan-jing-da-jian-wan-quan-shou-ce-san-ying-yong-an-zhuang-yumpei-zhi-he-bao-an-zhuang.html</id><summary type="html">&lt;p&gt;ä¸Šä¸¤ç¯‡æ–‡ç« æˆ‘ç»™å¤§å®¶è®²è§£äº†ç³»ç»Ÿçš„å®‰è£…,ç½‘ç»œå’Œsshçš„é…ç½®å’Œè¿æ¥,è¿™ç¯‡å°±ç»™å¤§å®¶è®²ä¸€ä¸‹Linuxå¦‚ä½•å®‰è£…åŒ….CentOSä½¿ç”¨rpmåŒ…ç®¡ç†,rpmåŒ…å®‰è£…ä½¿ç”¨rpmå‘½ä»¤&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ä½ æœ‰ä¸€ä¸ªåŒ…ä¸º:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;abc-0.1.3-el5.centos.rpm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åŒ…çš„åç§° â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;ä¸Šä¸¤ç¯‡æ–‡ç« æˆ‘ç»™å¤§å®¶è®²è§£äº†ç³»ç»Ÿçš„å®‰è£…,ç½‘ç»œå’Œsshçš„é…ç½®å’Œè¿æ¥,è¿™ç¯‡å°±ç»™å¤§å®¶è®²ä¸€ä¸‹Linuxå¦‚ä½•å®‰è£…åŒ….CentOSä½¿ç”¨rpmåŒ…ç®¡ç†,rpmåŒ…å®‰è£…ä½¿ç”¨rpmå‘½ä»¤&lt;/p&gt;
&lt;p&gt;æ¯”å¦‚ä½ æœ‰ä¸€ä¸ªåŒ…ä¸º:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;abc-0.1.3-el5.centos.rpm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åŒ…çš„åç§°ç”±3éƒ¨åˆ†ç»„æˆ,ç¬¬ä¸€éƒ¨åˆ†æ˜¯åŒ…å,ç¬¬äºŒéƒ¨åˆ†æ˜¯ç‰ˆæœ¬å·,ç¬¬ä¸‰éƒ¨åˆ†æ˜¯ä½¿ç”¨å¹³å°.å¦‚æœæƒ³å®‰è£…è¿™ä¸ªåŒ…ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å®‰è£…:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;rpm&lt;span class="w"&gt; &lt;/span&gt;-ivh&lt;span class="w"&gt; &lt;/span&gt;abc-0.1.3-el5.centos.rpm&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# iæ˜¯å®‰è£… væ˜¯æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯,-hæ˜¾ç¤ºå®‰è£…è¿›åº¦&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¸è½½è¿™ä¸ªåŒ…ä½¿ç”¨:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;rpm&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;abc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¸è½½åªè¦æŒ‡å®šåŒ…åå³å¯å¸è½½.&lt;/p&gt;
&lt;p&gt;å› ä¸ºLinuxä¸‹çš„åŒ…ä¾èµ–å…³ç³»å¾ˆå¤æ‚,ä¸€ä¸ªåŒ…å¯èƒ½ä¼šæœ‰å¾ˆå¤šçš„ä¾èµ–åŒ…,å¿…é¡»æŠŠæ‰€æœ‰ä¾èµ–åŒ…éƒ½è£…äº†æ‰èƒ½å®‰è£…è¿™ä¸ªåŒ….æ‰€ä»¥ä½¿ç”¨rpmå®‰è£…åŒ…,å°±å˜å¾—å¾ˆéº»çƒ¦å¾ˆå¤´ç–¼.å¦‚æœæƒ³å·¥ä½œå˜çš„è½»æ¾,æˆ‘ä»¬å¯ä»¥å€ŸåŠ©å·¥å…·,åœ¨rhel5å‘è¡Œçš„æ—¶å€™å°±é›†æˆäº†ä¸€ä¸ªå·¥å…·yum.Yumï¼ˆå…¨ç§°ä¸º Yellow dog Updater, Modifiedï¼‰æ˜¯ä¸€ä¸ªåœ¨Fedoraå’ŒRedHatä»¥åŠSUSEã€CentOSä¸­çš„Shellå‰ç«¯è½¯ä»¶åŒ…ç®¡ç†å™¨ã€‚åŸºæ–¼RPMåŒ…ç®¡ç†ï¼Œèƒ½å¤Ÿä»æŒ‡å®šçš„æœåŠ¡å™¨è‡ªåŠ¨ä¸‹è½½RPMåŒ…å¹¶ä¸”å®‰è£…ï¼Œå¯ä»¥è‡ªåŠ¨å¤„ç†ä¾èµ–æ€§å…³ç³»ï¼Œå¹¶ä¸”ä¸€æ¬¡å®‰è£…æ‰€æœ‰ä¾èµ–çš„è½¯ä½“åŒ…ï¼Œæ— é¡»ç¹çåœ°ä¸€æ¬¡æ¬¡ä¸‹è½½ã€å®‰è£…ã€‚&lt;/p&gt;
&lt;p&gt;yumçš„ä½¿ç”¨éœ€è¦æŒ‡å®šä¸€ä¸ªyumä»“åº“,æˆ‘ä»¬é¦–å…ˆæ¥é…ç½®ä¸€ä¸ªyumä»“åº“,yumä»“åº“å¯ä»¥æ˜¯internetä¸Šæä¾›çš„,ä½†æ˜¯rhelçš„yumåº“æ˜¯æ”¶è´¹çš„,ä½†æ˜¯æˆ‘ä»¬ç”¨çš„CentOSçš„yumåº“æ˜¯å…è´¹çš„.yumä»“åº“è¿˜å¯ä»¥ä½¿ç”¨æœ¬åœ°çš„yumåº“.æˆ‘ä»¬è¿™é‡Œä½¿ç”¨æœ¬åœ°yumåº“.èµ„æºå°±æ˜¯ä½¿ç”¨æˆ‘ä»¬çš„å®‰è£…DVDç›˜.é¦–å…ˆå°†æˆ‘ä»¬çš„DVDç›˜æ”¾åˆ°è™šæ‹Ÿå…‰é©±,ç„¶ååœ¨Linuxä¸‹æŒ‚è½½å…‰ç›˜.
å³é”®è™šæ‹Ÿæœºæ ‡ç­¾-&amp;gt;Setting(è®¾ç½®),é€‰æ‹©CD/DVD(IDE),åœ¨å³è¾¹ç‚¹é€‰Use ISO image file,ç„¶åç‚¹"Browse..",æµè§ˆæ‰¾åˆ°CentOS 5.5 å®‰è£…DVDç›˜.ç„¶åé€‰æ‹©å³ä¸Šè§’çš„connect:
&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120311164241.jpg"&gt;
&lt;img alt="wwww.linuxzen.com" src="/upload/QQæˆªå›¾20120311164417.jpg"&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åokä¿å­˜,åœ¨ç»ˆç«¯æˆ–åœ¨ä½ çš„sshå®¢æˆ·ç«¯ä¸Šè¾“å…¥ä¸‹é¢å‘½ä»¤:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mount&lt;span class="w"&gt; &lt;/span&gt;/dev/hdc&lt;span class="w"&gt; &lt;/span&gt;/mnt&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# å°†å…‰ç›˜æŒ‚è½½åˆ°/mntä¸‹&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åä¿®æ”¹yumé…ç½®æ–‡ä»¶,é¦–å…ˆæˆ‘ä»¬ä¸æ˜¯ç”¨é»˜è®¤æä¾›çš„å®˜æ–¹æº,æˆ‘ä»¬æŠŠCentOS-Base.repoé‡å‘½åä¸€ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mv&lt;span class="w"&gt; &lt;/span&gt;/etc/yum.repos.d/CentOS-Base.repo&lt;span class="w"&gt; &lt;/span&gt;/etc/yum.repos.d/CentOS-Base.repo.bak
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åä¿®æ”¹æœ¬åœ°æºé…ç½®æ–‡ä»¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/etc/yum.repos.d/CentOS-Media.repo
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æŒ‰iè¿›å…¥è¾“å…¥æ¨¡å¼,ä¿®æ”¹æˆå¦‚ä¸‹å†…å®¹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;[&lt;/span&gt;c5-media&lt;span class="o"&gt;]&lt;/span&gt;
&lt;span class="nv"&gt;name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;CentOS-&lt;span class="nv"&gt;$releasever&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-&lt;span class="w"&gt; &lt;/span&gt;Media
&lt;span class="nv"&gt;baseurl&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;file:///mnt&lt;span class="w"&gt;                           &lt;/span&gt;&lt;span class="c1"&gt;# æºä¸ºæŒ‚è½½å…‰ç›˜çš„ç›®å½•/mntä¸‹&lt;/span&gt;
&lt;span class="c1"&gt;#       file:///media/CentOS/&lt;/span&gt;
&lt;span class="c1"&gt;#       file:///media/cdrom/&lt;/span&gt;
&lt;span class="c1"&gt;#       file:///media/cdrecorder/&lt;/span&gt;
&lt;span class="nv"&gt;gpgcheck&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;span class="nv"&gt;enabled&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt;                                     &lt;/span&gt;&lt;span class="c1"&gt;# æ”¹ä¸º1å¯ç”¨è¿™ä¸ªæº&lt;/span&gt;
&lt;span class="nv"&gt;gpgkey&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-5
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;ä¿®æ”¹å®Œæ¯•æŒ‰&lt;/span&gt;&lt;span class="n n-Quoted"&gt;`Esc`&lt;/span&gt;&lt;span class="n"&gt;è¿›å…¥å‘½ä»¤æ¨¡å¼&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;è¾“å…¥&lt;/span&gt;&lt;span class="n n-Quoted"&gt;`:`&lt;/span&gt;&lt;span class="n"&gt;è¿›å…¥æœ«è¡Œæ¨¡å¼&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;&lt;span class="n"&gt;åœ¨æœ«è¡Œæ¨¡å¼è¾“å…¥&lt;/span&gt;&lt;span class="n n-Quoted"&gt;`wq`&lt;/span&gt;&lt;span class="n"&gt;ä¿å­˜é€€å‡º&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;

&lt;span class="n"&gt;ä¿®æ”¹å®Œæ¯•åæ‰§è¡Œ&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="n n-Quoted"&gt;`&lt;/span&gt;&lt;span class="n n-Quoted n-Quoted-Escape"&gt;``&lt;/span&gt;&lt;span class="n n-Quoted"&gt;bash&lt;/span&gt;
&lt;span class="n n-Quoted"&gt;yum update&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¼šçœ‹åˆ°ç±»ä¼¼ä¸‹é¢çš„è¾“å…¥,è¡¨ç¤ºæˆ‘ä»¬çš„é…ç½®æ˜¯æˆåŠŸçš„:
&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120313095321.jpg"&gt;&lt;/p&gt;
&lt;p&gt;é…ç½®å®Œæˆåæˆ‘ä»¬ç”¨ä»–æ¥å®‰è£…å‡ ä¸ªå¸¸ç”¨çš„å·¥å…·,&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;setuptool&lt;span class="w"&gt; &lt;/span&gt;lrzsz&lt;span class="w"&gt; &lt;/span&gt;wget&lt;span class="w"&gt; &lt;/span&gt;gcc&lt;span class="w"&gt; &lt;/span&gt;gcc-c++&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;which&lt;span class="w"&gt; &lt;/span&gt;bzip2&lt;span class="w"&gt; &lt;/span&gt;groff&lt;span class="w"&gt; &lt;/span&gt;man
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ¥ä»‹ç»ä¸€ä¸‹è¿™å‡ ä¸ªå·¥å…·,setuptoolå¯ä»¥åœ¨ç»ˆç«¯ç•Œé¢ä¸‹æä¾›ä¸€ä¸ªç±»ä¼¼å®‰è£…ç•Œé¢çš„å›¾å½¢åŒ–é…ç½®ç•Œé¢.
lrzszå¯ä»¥é€šè¿‡å…¶æä¾›çš„å‘½ä»¤rz/szè¿‡sshå®¢æˆ·ç«¯å¯¹æœåŠ¡å™¨è¿›è¡Œä¸Šä¼ å’Œä¸‹è½½
wgetæ˜¯Linuxä¸‹ä¼˜ç§€çš„ä¸‹è½½å·¥å…·(http/ftp)
gccæ˜¯ä¸€æ¬¾C/C++çš„ç¼–è¯‘å™¨
makeä½¿ç”¨gccæ ¹æ®makefileè¿›è¡Œç¼–è¯‘æºä»£ç 
whichæ˜¯ä¸€ä¸ªæŸ¥æ‰¾å‘½ä»¤çš„å·¥å…·
bzip2æ˜¯ä¸€ä¸ªå‹ç¼©è½¯ä»¶ä¸€èˆ¬ä¾›tarè°ƒç”¨
manæ˜¯ä¸€ä¸ªæŸ¥çœ‹æ‰‹å†Œå‘½ä»¤,å¦‚æœç¢°åˆ°ä¸æ‡‚çš„å‘½ä»¤å¯ä»¥manä¸€ä¸‹.æ¯”å¦‚ä½ ä¸çŸ¥é“wgetå‘½ä»¤çš„ç”¨æ³•å¯ä»¥:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;man&lt;span class="w"&gt; &lt;/span&gt;wget
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åmanå‘½ä»¤å°±ç»™æä¾›è¿™ä¸ªå‘½ä»¤çš„è¯¦ç»†æ‰‹å†Œ.å¥½äº†ä¸€äº›å‡†å¤‡å·¥ä½œåˆ°è¿™é‡Œå·²ç»åšå¥½äº†.æ¥ä¸‹æ¥çš„æ–‡ç« æˆ‘ä»¬å°±ä»‹ç»å®‰è£…nginx.&lt;/p&gt;</content><category term="Linux"></category><category term="yum"></category><category term="nginx"></category><category term="man"></category><category term="lnmp"></category><category term="Linux"></category><category term="CentOS"></category></entry><entry><title>lnmpç¯å¢ƒæ­å»ºå®Œå…¨æ‰‹å†Œ(äºŒ)â€”â€”ç³»ç»Ÿé…ç½®(å®ç°è™šæ‹Ÿæœºä¸Šç½‘/ssh/)</title><link href="https://www.linuxzen.com/lnmphuan-jing-da-jian-wan-quan-shou-ce-er-xi-tong-pei-zhi-shi-xian-xu-ni-ji-shang-wang-ssh.html" rel="alternate"></link><published>2012-03-10T11:31:00+08:00</published><updated>2012-03-10T11:31:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-03-10:/lnmphuan-jing-da-jian-wan-quan-shou-ce-er-xi-tong-pei-zhi-shi-xian-xu-ni-ji-shang-wang-ssh.html</id><summary type="html">&lt;p&gt;ä¸Šä¸€ç¯‡ä»‹ç»äº†å¦‚ä½•å®‰è£…Linux,å®‰è£…Linuxåæˆ‘ä»¬å¦‚æœåªåœ¨ç»ˆç«¯ç•Œé¢ä¸‹é…ç½®ä¼šå¾ˆéº»çƒ¦,æˆ‘ä»¬å¯ä»¥é€šè¿‡windowsè¿æ¥linuxçš„sshè¿›è¡Œé…ç½®linux.SSH æ˜¯ç›®å‰è¾ƒå¯é ï¼Œä¸“ä¸ºè¿œç¨‹ç™»å½•ä¼šè¯å’Œå…¶ä»–ç½‘ç»œæœåŠ¡æä¾›å®‰å…¨æ€§çš„å â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;ä¸Šä¸€ç¯‡ä»‹ç»äº†å¦‚ä½•å®‰è£…Linux,å®‰è£…Linuxåæˆ‘ä»¬å¦‚æœåªåœ¨ç»ˆç«¯ç•Œé¢ä¸‹é…ç½®ä¼šå¾ˆéº»çƒ¦,æˆ‘ä»¬å¯ä»¥é€šè¿‡windowsè¿æ¥linuxçš„sshè¿›è¡Œé…ç½®linux.SSH æ˜¯ç›®å‰è¾ƒå¯é ï¼Œä¸“ä¸ºè¿œç¨‹ç™»å½•ä¼šè¯å’Œå…¶ä»–ç½‘ç»œæœåŠ¡æä¾›å®‰å…¨æ€§çš„åè®®ã€‚&lt;/p&gt;
&lt;p&gt;è¦æƒ³è¿æ¥ssh,é¦–å…ˆå°±éœ€è¦ä¿è¯windowsèƒ½å’Œè™šæ‹ŸæœºLinuxè¿›è¡Œé€šä¿¡,æˆ‘ä»¬å¦‚æœæƒ³è¦æœ¬æœºèƒ½å’Œè™šæ‹Ÿæœºé€šä¿¡éœ€è¦è®¾ç½®è™šæ‹Ÿæœºçš„ç½‘å¡è¿æ¥å…³ç³»,æœ‰3ä¸­è¿æ¥å…³ç³»å¯ä»¥å’Œæœ¬æœºè¿é€š:
ä¸€ç§æ˜¯Bridged(æ¡¥æ¥),å°±æ˜¯ä½¿ç”¨ä½ æœ¬æœºçš„è¿æ¥,å¦‚æœæœ¬åœ°ç”¨çš„æ˜¯å±€åŸŸç½‘DHCPä¸Šç½‘å¯ä»¥é€‰æ‹©è¿™ç§æ–¹å¼.
ä¸€ç§æ˜¯NAT,å°±æ˜¯ç”¨NATæ¨¡å¼ï¼Œå°±æ˜¯è®©è™šæ‹Ÿç³»ç»Ÿå€ŸåŠ©NAT(ç½‘ç»œåœ°å€è½¬æ¢)åŠŸèƒ½ï¼Œé€šè¿‡å®¿ä¸»æœºå™¨æ‰€åœ¨çš„ç½‘ç»œæ¥è®¿é—®å…¬ç½‘ã€‚å¦‚æœæœ¬åœ°ç”¨çš„æ˜¯é™æ€å…¬ç½‘ip,æœ¬åœ°æœ‰æ— DHCPè¿™ä¸ªæ˜¯é¦–é€‰
ä¸€ç§host-only:è¿™ç§æ¨¡å¼ä¸èƒ½è®¿é—®å¤–ç½‘,åªèƒ½ä½•å®¿ä¸»(ä¹Ÿå°±æ˜¯æœ¬æœº)ä¸»æœºé€šä¿¡.ä¹Ÿå°±ä¸èƒ½è®¿é—®Internet&lt;/p&gt;
&lt;p&gt;è¿™é‡Œä»‹ç»å¦‚ä½•è®¾ç½®NATæ¨¡å¼ä¸Šç½‘.æŒ‰è¯´ç½‘å¡é€‰æ‹©NATæ¨¡å¼ç›´æ¥é‡å¯ç½‘å¡å°±å¯ä»¥dhcpè·å–,ä½†æ˜¯æˆ‘ä»¬åœ¨ä»¥åé…ç½®LinuxæœåŠ¡å™¨çš„æ—¶å€™ä¸ºäº†æ–¹ä¾¿ç®¡ç†è‚¯å®šä¸ä¼šä½¿ç”¨DHCP,æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨é™æ€ipçš„æ–¹å¼æ¥è®¾ç½®NATä¸Šç½‘.
é¦–å…ˆå³é”®ä½ çš„è™šæ‹Ÿæœºæ ‡ç­¾-&amp;gt;Setting-&amp;gt;é€‰ä¸­Network Adapter.åœ¨å³è¾¹é€‰ä¸­NAT(ä¹Ÿå¯ç›´æ¥åŒå‡»å³ä¸‹è§’çš„ç½‘å¡å›¾æ ‡)
&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120310101223.jpg"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120310101241.jpg"&gt;&lt;/p&gt;
&lt;p&gt;åšå®Œè¿™æ­¥ä¹‹åæˆ‘ä»¬è¿˜è¦ç¼–è¾‘ä¸€ä¸‹è™šæ‹Ÿæœºçš„è™šæ‹Ÿå¡è®¾ç½®,ä»¥è¾¾åˆ°æˆ‘ä»¬ä½¿ç”¨é™æ€ipä¸Šç½‘çš„éœ€æ±‚:&lt;/p&gt;
&lt;p&gt;ç‚¹å‡»è™šæ‹Ÿæœºçš„Edit(ç¼–è¾‘)-&amp;gt;Virtual Network Editor(è™šæ‹Ÿç½‘å¡ç¼–è¾‘å™¨):
&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120310101559.jpg"&gt;
åœ¨å¼¹å‡ºçš„ç•Œé¢é€‰ä¸­VMnet8 NAT,ç„¶åä¿®æ”¹æœ€ä¸‹é¢çš„Subnet IP,æ”¹æˆä½ æƒ³è¦çš„ç½‘æ®µ,è¿™é‡Œä½¿ç”¨&lt;code&gt;192.168.3.0/24&lt;/code&gt;.
&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120310101834.jpg"&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åç‚¹å‡»NAT Settting:è®¾ç½®Gateway IPä¸º&lt;code&gt;192.168.3.0&lt;/code&gt;ç½‘æ®µçš„ä¸€ä¸ªip,è¿™é‡Œä½¿ç”¨&lt;code&gt;192.168.3.254&lt;/code&gt;.
&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120310102222.jpg"&gt;&lt;/p&gt;
&lt;p&gt;è®¾ç½®å¥½åç„¶åç‚¹å‡»OKä¿å­˜é€€å‡º.&lt;/p&gt;
&lt;p&gt;ä¸€åˆ‡å·²ç»å°±ç»ª,ä¸‹é¢æˆ‘ä»¬å°±å¼€å§‹æˆ‘ä»¬çš„Linuxä¹‹æ—….é¦–å…ˆè¿›å…¥ç³»ç»Ÿ,åœ¨login:ç•Œé¢è¾“å…¥rootç”¨æˆ·,ç„¶åè¾“å…¥å®‰è£…æ—¶è¾“å…¥çš„rootå¯†ç .è¿›å…¥ç³»ç»Ÿ.é¦–å…ˆæˆ‘ä»¬æ¥é…ç½®ç½‘å¡.CentOSçš„ç½‘å¡è·¯å¾„åœ¨"/etc/sysconifg/network-scripts/"ä¸‹é¢,ç¬¬ä¸€ä¸ªç½‘å¡ä¸€èˆ¬å‘½åä¸ºeth0,ç½‘å¡é…ç½®æ–‡ä»¶åˆ™æ˜¯ifcfg-eth0,ç¬¬äºŒä¸ªæ˜¯eth1,é…ç½®æ–‡ä»¶ifcfg-eth1,åé¢çš„ä»¥æ­¤ç±»æ¨.ä¸‹é¢æˆ‘ä»¬æ¥é…ç½®ç½‘å¡:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/etc/sysconfig/network-scripts/ifcfg-eth0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;(åœ¨è¿™é‡Œè¯´ä¸€ä¸‹,Linuxæœ‰ä¸€ä¸ªå¾ˆæ–¹ä¾¿çš„åŠŸèƒ½å½“è·¯å¾„å¤ªé•¿ä¸æ–¹ä¾¿è®°å¿†æ—¶,å¯æ‰“å‡ºä¸€éƒ¨åˆ†æ•²Tabé”®å¦‚æœè¿™ä¸ªæ˜¯å”¯ä¸€çš„å°±ä¼šè‡ªåŠ¨è¡¥å…¨,å¦‚æœä¸æ˜¯å°±æ•²ä¸¤ä¸‹Tab,å°±ä¼šåˆ—å‡ºæ‰€æœ‰å¯é€‰å†…å®¹,æ–‡ä»¶å’Œå‘½ä»¤ä¸€æ ·)
æŒ‰iè¿›å…¥è¾“å…¥æ¨¡å¼,å°†é…ç½®æ–‡ä»¶æ”¹æˆå¦‚ä¸‹å†…å®¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nv"&gt;DEVICE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;eth0&lt;span class="w"&gt;                   &lt;/span&gt;&lt;span class="c1"&gt;# è®¾å¤‡å&lt;/span&gt;
&lt;span class="nv"&gt;HWADDR&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;00&lt;/span&gt;:00:00:00:01&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="c1"&gt;# MACåœ°å€&lt;/span&gt;
&lt;span class="nv"&gt;BOOTPROTO&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;static&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="c1"&gt;# IPè·å–æ–¹å¼ä¸ºstatic,å¦‚æœæ˜¯dhcpåˆ™æ˜¯ä½¿ç”¨DHCPè·å–&lt;/span&gt;
&lt;span class="nv"&gt;ONBOOT&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;yes&lt;span class="w"&gt;                    &lt;/span&gt;&lt;span class="c1"&gt;# æ˜¯å¦å¯ç”¨ç½‘å¡(ä¹Ÿå°±æ˜¯æ˜¯å¦åœ¨é‡å¯è®¾å¤‡æˆ–é‡å¯ç½‘å¡æ—¶å¯åŠ¨è¿™ä¸ªç½‘å¡)&lt;/span&gt;
&lt;span class="nv"&gt;IPADDR&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.120&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="c1"&gt;# IPåœ°å€&lt;/span&gt;
&lt;span class="nv"&gt;NETMASK&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;255&lt;/span&gt;.255.255.0&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="c1"&gt;# æ©ç &lt;/span&gt;
&lt;span class="nv"&gt;GATEWAY&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.254&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="c1"&gt;# ç½‘å…³(ä¹Ÿå°±æ˜¯åˆšæ‰è™šæ‹Ÿç½‘å¡ç¼–è¾‘å™¨é‡ŒNAT Settingé‡Œè®¾ç½®çš„ç½‘å…³)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç¼–è¾‘å®ŒæˆåæŒ‰Escè¿›å…¥æœ«è¡Œæ¨¡å¼ç„¶åè¾“å…¥:wqä¿å­˜é€€å‡º
ç„¶åé‡å¯ç½‘å¡,å¦‚æœéƒ½æ˜¯[OK]çš„å°±æ²¡æœ‰é—®é¢˜&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;service&lt;span class="w"&gt; &lt;/span&gt;network&lt;span class="w"&gt; &lt;/span&gt;restart
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æŸ¥çœ‹ç½‘ç»œé…ç½®çš„å‘½ä»¤æ˜¯&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ifconfig
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120310104548.jpg"&gt;&lt;/p&gt;
&lt;p&gt;pingå‘½ä»¤ç”¨æ¥æ£€æµ‹ç½‘ç»œè¿é€šæ€§,é…ç½®å¥½åæˆ‘ä»¬pingç½‘å…³æµ‹è¯•:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ping&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.254
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœæ˜¾ç¤ºå¦‚ä¸‹åˆ™è¡¨ç¤ºæ˜¯é€šçš„,å¦‚æœä¸æ˜¯åˆ™è¡¨ç¤ºä¸é€š
&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120310104753.jpg"&gt;
å¦‚æœèƒ½æ­£å¸¸è®¿é—®ç½‘ç»œæˆ‘ä»¬è¿˜éœ€è¦é…ç½®ä¸€ä¸ªDNSæœåŠ¡å™¨,æŒ‡å®šä¸€ä¸ªDNSæœåŠ¡å™¨çš„é…ç½®æ–‡ä»¶ä¸º:/etc/resolv.conf.Linuxå¯ä»¥é…ç½®3ä¸ªDNS.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/etc/resolv.conf
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åŒæ ·æŒ‰iæˆ–aè¿›å…¥è¾“å…¥æ¨¡å¼æ·»åŠ å¦‚ä¸‹å†…å®¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;nameserver&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.254&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# æœ¬åœ°DNS&lt;/span&gt;
nameserver&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;202&lt;/span&gt;.106.0.20&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="c1"&gt;# åŒ—äº¬åœ°åŒºç½‘é€šDNS&lt;/span&gt;
nameserver&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;8&lt;/span&gt;.8.8.8&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="c1"&gt;# googleçš„æ ¹DNS&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæŒ‰Esc,è¾“å…¥:wqä¿å­˜é€€å‡º,ç„¶åping &lt;a href="http://www.linuxzen.com"&gt;www.linuxzen.com&lt;/a&gt;çœ‹èƒ½å¦è§£æ:
&lt;img alt="www.linuxzen.com" src="/upload/æœªå‘½å.jpg"&gt;
ä¸Šå›¾è¡¨ç¤ºè§£ææˆåŠŸ.&lt;/p&gt;
&lt;p&gt;å¥½äº†åˆ°è¿™ä¸€æ­¥Linuxå·²ç»å¯ä»¥è®¿é—®internetäº†.ä¸‹é¢æˆ‘ä»¬å°±é…ç½®sshè¿æ¥è™šæ‹Ÿæœº.è¿æ¥sshçš„è½¯ä»¶æœ‰å‡ æ¬¾éƒ½æ˜¯æ¯”è¾ƒä¸é”™çš„,ä¸ªäººè§‰å¾—æœ€å¥½çš„è¿˜æ˜¯Secure CRT,è¿™ä¸ªæ˜¯æ”¶è´¹çš„ä½†è¾ƒä½ç‰ˆæœ¬è¿˜æ˜¯å¯ä»¥åœ¨ç™¾åº¦/è°·æ­Œä¸Šæ‰¾åˆ°ç‰¹åˆ«ç (ä½ æ‡‚å¾—),è¿˜æœ‰ä¸€æ¬¾æ˜¯putty,è¿™ä¸€ä¸ªæ¬¾å¼€æºè½¯ä»¶è€Œä¸”åªæœ‰å‡ ç™¾KB,å¾ˆè½»é‡çº§.&lt;/p&gt;
&lt;p&gt;æˆ‘ä»¬é¦–å…ˆè¦å…³é—­selinux(ä¸€æ¬¾ç¾å›½å›½å®¶å®‰å…¨å±€è´¡çŒ®å‡ºæ¥çš„è½¯ä»¶,å¦‚æœä¼šé…ç½®å¯ä»¥å¼€å¯,å¦‚æœä¸ä¼šå°±å…³é—­)
ç¼–è¾‘/etc/selinux/config:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/etc/selinux/config
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæŒ‰iè¿›å…¥è¾“å…¥æ¨¡å¼,ä¿®æ”¹SELINUXå‚æ•°ä¸ºdisabled:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# This file controls the state of SELinux on the system.&lt;/span&gt;
&lt;span class="c1"&gt;# SELINUX= can take one of these three values:&lt;/span&gt;
&lt;span class="c1"&gt;#       enforcing - SELinux security policy is enforced.&lt;/span&gt;
&lt;span class="c1"&gt;#       permissive - SELinux prints warnings instead of enforcing.&lt;/span&gt;
&lt;span class="c1"&gt;#       disabled - SELinux is fully disabled.&lt;/span&gt;
&lt;span class="nv"&gt;SELINUX&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;disabled&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# ä¿®æ”¹æ­¤è¡Œ&lt;/span&gt;
&lt;span class="c1"&gt;# SELINUXTYPE= type of policy in use. Possible values are:&lt;/span&gt;
&lt;span class="c1"&gt;#       targeted - Only targeted network daemons are protected.&lt;/span&gt;
&lt;span class="c1"&gt;#       strict - Full SELinux protection.&lt;/span&gt;
&lt;span class="nv"&gt;SELINUXTYPE&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;disabled
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åé‡å¯ç³»ç»Ÿ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;reboot
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæ¸…ç©ºç³»ç»Ÿè‡ªå¸¦é˜²ç«å¢™&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;iptables&lt;span class="w"&gt; &lt;/span&gt;-Z
iptables&lt;span class="w"&gt; &lt;/span&gt;-F
iptables&lt;span class="w"&gt; &lt;/span&gt;-X
service&lt;span class="w"&gt; &lt;/span&gt;iptables&lt;span class="w"&gt; &lt;/span&gt;save
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨sshè¿æ¥Linuxè™šæ‹Ÿæœº
é¦–å…ˆç¡®ä¿Linuxå¯åŠ¨äº†ssh,sshå ç”¨TCPçš„22ç«¯å£.æ‰§è¡Œå‘½ä»¤æŸ¥çœ‹22ç«¯å£æ˜¯å¦å¼€æ”¾:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;netstat&lt;span class="w"&gt; &lt;/span&gt;-antlp&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;22&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœå‡ºç°å¦‚ä¸‹å†…å®¹åˆ™è¡¨ç¤ºsshå·²ç»å¯åŠ¨:
&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120310111326.jpg"&gt;
å¦‚æœæ²¡æœ‰å¯åŠ¨å°è¯•è¿è¡Œä¸‹é¢å‘½ä»¤:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;service&lt;span class="w"&gt; &lt;/span&gt;sshd&lt;span class="w"&gt; &lt;/span&gt;start&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# å¯åŠ¨sshæœåŠ¡&lt;/span&gt;
chkconfig&lt;span class="w"&gt; &lt;/span&gt;--add&lt;span class="w"&gt; &lt;/span&gt;sshd&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;# åŠ å…¥å¼€æœºå¯åŠ¨&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœæ²¡æŠ¥é”™åˆ™sshdå¯åŠ¨æˆåŠŸ&lt;/p&gt;
&lt;p&gt;sshä¹Ÿé…ç½®æˆåŠŸäº†,ä¸‹é¢å°±éœ€è¦æœ¬åœ°è¿æ¥sshäº†,é¦–å…ˆæˆ‘ä»¬è¦é…ç½®æœ¬åœ°èƒ½è®¿é—®è™šæ‹Ÿæœº,ä¸çŸ¥é“å¤§å®¶æ³¨æ„åˆ°ä»¬è£…å®Œè™šæ‹Ÿæœºæˆ‘ä»¬å¤šå‡ºä¸¤ä¸ªé“¾æ¥åˆ†åˆ«æ˜¯VMware Network Adapter VMnet1å’ŒVMware Network Adapter VMnet8,VMnet1æ˜¯host only,VMnet8æ˜¯NAT,æˆ‘ä»¬ä½¿ç”¨çš„æ˜¯NAT,æ‰€ä»¥é…ç½®VMware Network Adapter VMnet8å°±å¯ä»¥äº†,æŠŠVMware Network Adapter VMnet8é…ç½®æˆ192.168.3.xçš„ip,è¿™é‡Œä½¿ç”¨192.168.3.111,é…ç½®è¿‡ç¨‹è¿™é‡Œä¸åšè§£é‡Šäº†.åœ¨windowsçš„cmdä¸‹ping 192.168.3.120,èƒ½pingé€šå°±æ‰“å¼€ä½ çš„sshå®¢æˆ·ç«¯è½¯ä»¶.è¿™é‡Œä½¿ç”¨SecureCRT.æ‰“å¼€SecureCRTç‚¹å‡»å¿«é€Ÿè¿æ¥:
&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120310112142.jpg"&gt;
åœ¨å¼¹å‡ºçš„ç•Œé¢è¾“å…¥ä¸»æœºåå¤„è¾“å…¥ipåœ°å€:192.168.3.120,ç”¨æˆ·åå¤„è¾“å…¥root:ç„¶åç‚¹å‡»è¿æ¥
&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120310112351.jpg"&gt;&lt;/p&gt;
&lt;p&gt;ä¼šå¼¹å‡ºæ˜¯å¦ä¿å­˜å¯†é’¥:ç‚¹å‡»æ¥æ”¶å¹¶ä¿å­˜:
&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120310112605.jpg"&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åè¾“å…¥rootå¯†ç æ—¢å¯ä»¥è¿æ¥ç™»å½•
&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120310112713.jpg"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120310112752.jpg"&gt;
å¥½äº†åˆ°è¿™é‡Œå°±å¯ä»¥ç”¨sshè¿æ¥Linuxäº†,å°½æƒ…æ¢ç´¢æŠŠ,ä¸‹ä¸€èŠ‚å°†ä¼šè®²è§£yumåº“çš„é…ç½®å’ŒåŒ…å®‰è£….&lt;/p&gt;</content><category term="Linux"></category><category term="è™šæ‹Ÿæœº"></category><category term="ä¸Šç½‘"></category><category term="ssh"></category><category term="NAT"></category><category term="lnmp"></category></entry><entry><title>lnmpç¯å¢ƒæ­å»ºå®Œå…¨æ‰‹å†Œ(ä¸€)------ç³»ç»Ÿå®‰è£…</title><link href="https://www.linuxzen.com/lnmphuan-jing-da-jian-wan-quan-shou-ce-yi-xi-tong-an-zhuang.html" rel="alternate"></link><published>2012-03-08T12:05:00+08:00</published><updated>2012-03-08T12:05:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-03-08:/lnmphuan-jing-da-jian-wan-quan-shou-ce-yi-xi-tong-an-zhuang.html</id><summary type="html">&lt;p&gt;åœ¨ä¹‹å‰çš„æ–‡ç« é‡Œä¹Ÿé™†é™†ç»­ç»­çš„ä»‹ç»äº†nginx/mysqlå’Œphpçš„å®‰è£…å’Œé…ç½®,è¿™é‡Œåšä¸€ä¸ªæ•´åˆ.ä¹Ÿæ˜¯ä¸€ä¸ªè¯¦ç»†çš„æ•™ç¨‹,å¯ä»¥è®©ä½ 0åŸºç¡€æ­å»ºlnmpç¯å¢ƒ.
é¦–å…ˆé€‰æ‹©ä¸€ä¸ªå‘è¡Œç‰ˆ,ä¸ªäºº â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;åœ¨ä¹‹å‰çš„æ–‡ç« é‡Œä¹Ÿé™†é™†ç»­ç»­çš„ä»‹ç»äº†nginx/mysqlå’Œphpçš„å®‰è£…å’Œé…ç½®,è¿™é‡Œåšä¸€ä¸ªæ•´åˆ.ä¹Ÿæ˜¯ä¸€ä¸ªè¯¦ç»†çš„æ•™ç¨‹,å¯ä»¥è®©ä½ 0åŸºç¡€æ­å»ºlnmpç¯å¢ƒ.
é¦–å…ˆé€‰æ‹©ä¸€ä¸ªå‘è¡Œç‰ˆ,ä¸ªäººæ¯”è¾ƒå–œæ¬¢CentOS,CentOSæ˜¯Red Hatçš„å†å‘è¡Œç‰ˆ,é‡æ–°ç¼–è¯‘äº†Red Hat,ä¿®å¤nå¤šé”™è¯¯,å…è´¹çš„yumåº“,è¿™é‡Œä½¿ç”¨CentOS5.5,è™šæ‹Ÿæœºä½¿ç”¨VMware WorkstationÂ 8.0.VMwareæ˜¯ä¸€ä¸ªâ€œè™šæ‹ŸPCâ€è½¯ä»¶å…¬å¸.å®ƒå¯ä»¥ä½¿ä½ åœ¨ä¸€å°æœºå™¨ä¸ŠåŒæ—¶è¿è¡ŒäºŒä¸ªæˆ–æ›´å¤šWindowsã€DOSã€LINUXç³»ç»Ÿã€‚ä¸â€œå¤šå¯åŠ¨â€ç³»ç»Ÿç›¸æ¯”ï¼ŒVMWareé‡‡ç”¨äº†å®Œå…¨ä¸åŒçš„æ¦‚å¿µã€‚å¤šå¯åŠ¨ç³»ç»Ÿåœ¨ä¸€ä¸ªæ—¶åˆ»åªèƒ½è¿è¡Œä¸€ä¸ªç³»ç»Ÿï¼Œåœ¨ç³»ç»Ÿåˆ‡æ¢æ—¶éœ€è¦é‡æ–°å¯åŠ¨æœºå™¨ã€‚VMWareæ˜¯çœŸæ­£â€œåŒæ—¶â€è¿è¡Œï¼Œå¤šä¸ªæ“ä½œç³»ç»Ÿåœ¨ä¸»ç³»ç»Ÿçš„å¹³å°ä¸Šï¼Œå°±è±¡æ ‡å‡†Windowsåº”ç”¨ç¨‹åºé‚£æ ·åˆ‡æ¢.&lt;/p&gt;
&lt;p&gt;å®‰è£…VMwareè¿™é‡Œå°±ä¸ä»‹ç»äº†,ç»™å‡ºVMware Workstation 8.0çš„&lt;a href="http://www.vmware.com/downloads/downloadBinary.do?downloadGroup=WKST-802-WIN&amp;amp;vmware=downloadBinary&amp;amp;file=VMware-workstation-full-8.0.2-591240.exe&amp;amp;pot=1&amp;amp;code=VMware-workstation-full-8.0.2-591240.exe&amp;amp;hashKey=5d70214cc3ce52f8154f38b7cd52efbe&amp;amp;tranId=70310191&amp;amp;downloadURL&amp;quot;"&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;VMwareä¸æ˜¯å…è´¹è½¯ä»¶,ä½†æ˜¯ç½‘ä¸Šä¼šæœ‰åºåˆ—å·,å¤§å®¶ä¸æƒ³èŠ±é’±å°±æœä¸€ä¸‹å°±okäº†.
æˆ‘ä»¬è¿˜è¦å‡†å¤‡CentOS5.5 çš„isoé•œåƒç”¨æ¥å®‰è£…ç³»ç»Ÿ.&lt;a href="&amp;quot;http://download.chinaunix.net/down.php?id=31679&amp;amp;ResourceID=12271&amp;amp;site=6"&gt;ä¸‹è½½åœ°å€&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;ä¸‹é¢æˆ‘ä»¬å°±æ¥æ–°å»ºä¸€ä¸ªè™šæ‹Ÿæœºå®‰è£…CentOS
æ‰“å¼€è™šæ‹Ÿæœºé€‰æ‹©File-&amp;gt;New Virtual Machine
&lt;img alt="www.linuxzen.com" src="/upload/1.jpg"&gt;&lt;/p&gt;
&lt;p&gt;åœ¨æ¥ä¸‹æ¥çš„ç•Œé¢é€‰æ‹©&lt;code&gt;Typical&lt;/code&gt;,ç„¶åç‚¹&lt;code&gt;Next&lt;/code&gt;:
&lt;img alt="www.linuxzen.com" src="/upload/2.jpg"&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åç‚¹é€‰&lt;code&gt;I will install the operating system later&lt;/code&gt;,ç„¶åNext&amp;gt;,é€‰æ‹©æ“ä½œç³»ç»Ÿ,ä¸ºLinux,Versioné€‰æ‹©ä¸ºCentOS:
&lt;img alt="www.linuxzen.com" src="/upload/3.jpg"&gt;&lt;/p&gt;
&lt;p&gt;ç‚¹å‡»Nextè¿›ç»™è™šæ‹Ÿæœºå‘½å,ç„¶åé€‰æ‹©ä¿å­˜è·¯å¾„(æœ€å¥½é€‰æ‹©ä¸€ä¸ªç©ºé—²ç©ºé—´è¶³å¤Ÿçš„åˆ†åŒº)ç‚¹å‡»Nextä¼šè®©ä½ é€‰æ‹©ç¡¬ç›˜å¤§å°,ä¿æŒé»˜è®¤å³å¯,ç‚¹å‡»Next&amp;gt;åœ¨å¼¹å‡ºçš„ç•Œé¢å¯ä»¥æŸ¥çœ‹è™šæ‹Ÿæœºçš„è™šæ‹Ÿç¡¬ä»¶å¯ä»¥ç‚¹å‡»"Customize Hardware"è¿›è¡Œè‡ªå®šä¹‰ç¡¬ä»¶,å»ºè®®åˆ é™¤è½¯é©±,USBç­‰æ— ç”¨ç¡¬ä»¶.ç‚¹å‡»Finishå®Œæˆè™šæ‹Ÿæœºåˆ›å»º.&lt;/p&gt;
&lt;p&gt;åˆ›å»ºå®Œæˆåè™šæ‹Ÿæœºç•Œé¢çš„å·¦è¾¹åŒå‡»"CD/DVD(IDE)":
&lt;img alt="www.linuxzen.com" src="/upload/4.jpg"&gt;
åœ¨å¼¹å‡ºç•Œé¢çš„å³è¾¹é€‰æ‹©&lt;code&gt;Use ISO image file&lt;/code&gt;,ç‚¹å‡»"Browse.."é€‰æ‹©ä¸‹è½½å¥½çš„CentOS5.5é•œåƒ,ç‚¹å‡»OKç¡®å®š:&lt;/p&gt;
&lt;p&gt;&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120308101907.jpg"&gt;&lt;/p&gt;
&lt;p&gt;ç„¶åå•å‡»è™šæ‹Ÿæœºç•Œé¢çš„å·¦ä¸Šè§’çš„&lt;code&gt;Power on this virtual machine&lt;/code&gt;å¯åŠ¨è™šæ‹Ÿæœº,ç¬¬ä¸€æ¬¡é»˜è®¤ä¼šè®¤åˆ°å…‰é©±ä»å…‰é©±å¯åŠ¨,å¯åŠ¨åçœ‹åˆ°å¦‚ä¸‹ç•Œé¢:&lt;/p&gt;
&lt;p&gt;&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120308102129.jpg"&gt;&lt;/p&gt;
&lt;p&gt;æ­å–œä½ ,å¯ä»¥å¼€å§‹ä½ çš„linuxä¹‹æ—…äº†,æˆ‘æ¯”è¾ƒå–œæ¬¢å­—ç¬¦ç•Œé¢å®‰è£…,èŠ‚çœèµ„æº,è¾“å…¥&lt;code&gt;linux text&lt;/code&gt;,æ•²å›è½¦è¿›å…¥å­—ç¬¦ç•Œé¢å®‰è£…,æƒ³å›¾å½¢åŒ–å®‰è£…ç›´æ¥å›è½¦å³å¯:
åœ¨æ¥ä¸‹æ¥çš„ç•Œé¢ä¸‹ä¼šå¼¹å‡ºä¸‹é¢å¯¹è¯æ¡†,æŒ‰Tabé€‰æ‹©Skipè·³è¿‡æ£€æµ‹:
&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120308102415.jpg"&gt;
ç„¶åä¼šä¸€æ¬¡å¼¹å‡ºè¯­è¨€,é”®ç›˜é€‰æ‹©æ¡†é€‰æ‹©é»˜è®¤æ—¢å¯ä»¥,ç„¶ålinuxä¼šå†ä½ çš„ç¡¬ç›˜ä¸Šæ£€æµ‹ä¸åˆ°åˆ†åŒºè¡¨è¯¢é—®ä½ æ˜¯å¦æ ¼å¼åŒ–æ•´ä¸ªç¡¬ç›˜,é€‰æ‹©Yes:
&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120308103037.jpg"&gt;
ç„¶åå°±ä¼šè·³åˆ°åˆ†åŒºè¿™ä¸€å—,æˆ‘ä»¬é€‰æ‹©ç¬¬å››ä¸ªè‡ªå®šä¹‰åˆ†åŒº(Create Custom layout):
&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120308103159.jpg"&gt;&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥æŒ‰F2å³å¯å»ºç«‹åˆ†åŒº,ä¸€èˆ¬åˆ†åŒºæœ‰å„ç§å„æ ·çš„å»ºè®®,Linuxå¿…é¡»æœ‰ä¸€ä¸ª/(æ ¹)åˆ†åŒº,å»ºè®®æœ‰ä¸€ä¸ªswapåˆ†åŒºæ˜¯ç‰©ç†å†…å­˜çš„ä¸¤å€.&lt;/p&gt;
&lt;p&gt;&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120308103443.jpg"&gt;&lt;/p&gt;
&lt;p&gt;ä¸Šå›¾å»ºç«‹ä¸€ä¸ª/å¤§å°ä¸º&lt;code&gt;4G&lt;/code&gt;,&lt;code&gt;Mount Point&lt;/code&gt;æŒ‡å®šæŒ‚è½½ç‚¹,è¿™é‡Œä¸º&lt;code&gt;/&lt;/code&gt;,&lt;code&gt;File System Type&lt;/code&gt;æŒ‡å®šæ–‡ä»¶ç³»ç»Ÿç±»å‹,è¿™é‡Œä¸º&lt;code&gt;ext3&lt;/code&gt;.å¤§å°æŒ‡å®šä¸º&lt;code&gt;4G&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;ç„¶åå»ºè®®ä¸€ä¸ª&lt;code&gt;swap&lt;/code&gt;åˆ†åŒº,åŒæ ·æŒ‰&lt;code&gt;F2&lt;/code&gt;åœ¨&lt;code&gt;File System Type&lt;/code&gt;é‡Œé€‰æ‹©ä¸º&lt;code&gt;swap&lt;/code&gt;:
&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120308103741.jpg"&gt;
åœ¨æ ¹æ®ç¬¬ä¸€æ­¥çš„æ–¹æ³•åˆ›å»ºä¸€ä¸ª/usråˆ†åŒº,åœ¨Sizeé‡Œé€‰æ‹©"Fill all available space"æŠŠå‰©ä½™çš„å¤§å°éƒ½ç»™/usr
&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120308103957.jpg"&gt;
åˆ›å»ºå®Œæ¯•é€‰æ‹©okå®Œæˆåˆ†åŒº,è·³å‡ºæ˜¯å¦å®‰è£…å¼•å¯¼(Boot loader Configuration),ä¸€ç›´é€‰æ‹©é»˜è®¤ç»§ç»­.æ¥ä¸‹æ¥è¯¢é—®æ˜¯å¦é…ç½®ç½‘å¡,é€‰æ‹©Noè·³è¿‡.ä¼šè®©ä½ å¡«Gatewayå’ŒDNSä¸ç”¨ç®¡ç›´æ¥okå°±è¡Œ,æ¥ä¸‹æ¥ä¼šè®©è¾“å…¥ä¸»æœºå,è¾“å…¥ä½ æƒ³è¦çš„ä¸»æœºåå³å¯
&lt;img alt="www.linuxzen.com" src="/upload/QQæˆªå›¾20120308104357.jpg"&gt;&lt;/p&gt;
&lt;p&gt;æ¥ä¸‹æ¥é€‰æ‹©æ—¶åŒº,é€‰æ‹©Asia/Chongqing.ç„¶åè¾“å…¥rootå¯†ç ,è¾“å…¥å®Œæ¯•åOKç»§ç»­,ä¸‹é¢å°±æ˜¯é€‰æ‹©è¦å®‰è£…çš„åŒ…,æƒ³ç©æ¡Œé¢çš„è¯å°±ç›´æ¥é»˜è®¤,è¿™é‡Œé€‰æ‹©Customize software selection,æ¥ä¸‹æ¥çš„ç•Œé¢æŒ‰ç©ºæ ¼å»æ‰æ‰€æœ‰çš„åŒ…å‰é¢çš„*å®ç°æœ€å°åŒ–å®‰è£…,é€‰æ‹©OKå¼€å§‹å®‰è£….å®Œæˆåé‡å¯,linuxç³»ç»Ÿå°±å®‰è£…å®Œæˆ&lt;/p&gt;</content><category term="Linux"></category><category term="è™šæ‹Ÿæœº"></category><category term="æ“ä½œç³»ç»Ÿ"></category><category term="å®‰è£…"></category><category term="VMware"></category><category term="Linux"></category><category term="CentOS"></category></entry><entry><title>nginxå¹³å°æ­å»ºnagiosç›‘æ§ç³»ç»Ÿ</title><link href="https://www.linuxzen.com/nginxping-tai-da-jian-nagiosjian-kong-xi-tong.html" rel="alternate"></link><published>2012-02-26T10:48:00+08:00</published><updated>2012-02-26T10:48:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-02-26:/nginxping-tai-da-jian-nagiosjian-kong-xi-tong.html</id><summary type="html">&lt;p&gt;Nagiosæ˜¯ä¸€æ¬¾å¼€æºçš„å…è´¹ç½‘ç»œç›‘è§†å·¥å…·ï¼Œèƒ½æœ‰æ•ˆç›‘æ§Windowsã€Linuxå’ŒUnixçš„ä¸»æœºçŠ¶æ€ï¼Œäº¤æ¢æœºè·¯ç”±å™¨ç­‰ç½‘ç»œè®¾ç½®ï¼Œæ‰“å°æœºç­‰ã€‚åœ¨ç³»ç»Ÿæˆ–æœåŠ¡çŠ¶æ€å¼‚å¸¸æ—¶å‘å‡ºé‚®ä»¶æˆ–çŸ­ä¿¡æŠ¥è­¦ç¬¬ä¸€æ—¶é—´é€šçŸ¥ç½‘ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;Nagiosæ˜¯ä¸€æ¬¾å¼€æºçš„å…è´¹ç½‘ç»œç›‘è§†å·¥å…·ï¼Œèƒ½æœ‰æ•ˆç›‘æ§Windowsã€Linuxå’ŒUnixçš„ä¸»æœºçŠ¶æ€ï¼Œäº¤æ¢æœºè·¯ç”±å™¨ç­‰ç½‘ç»œè®¾ç½®ï¼Œæ‰“å°æœºç­‰ã€‚åœ¨ç³»ç»Ÿæˆ–æœåŠ¡çŠ¶æ€å¼‚å¸¸æ—¶å‘å‡ºé‚®ä»¶æˆ–çŸ­ä¿¡æŠ¥è­¦ç¬¬ä¸€æ—¶é—´é€šçŸ¥ç½‘ç«™è¿ç»´äººå‘˜ï¼Œåœ¨çŠ¶æ€æ¢å¤åå‘å‡ºæ­£å¸¸çš„é‚®ä»¶æˆ–çŸ­ä¿¡é€šçŸ¥ã€‚&lt;/p&gt;
&lt;p&gt;Nagios åŠŸèƒ½:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç›‘è§†ç½‘ç»œæœåŠ¡ (SMTP, POP3, HTTP, NNTP, PINGç­‰)&lt;/li&gt;
&lt;li&gt;ç›‘è§†ä¸»æœºèµ„æº (è¿›ç¨‹, ç£ç›˜ç­‰)&lt;/li&gt;
&lt;li&gt;ç®€å•çš„æ’ä»¶è®¾è®¡å¯ä»¥è½»æ¾æ‰©å±•Nagiosçš„ç›‘è§†åŠŸèƒ½&lt;/li&gt;
&lt;li&gt;æœåŠ¡ç­‰ç›‘è§†çš„å¹¶å‘å¤„ç†&lt;/li&gt;
&lt;li&gt;é”™è¯¯é€šçŸ¥åŠŸèƒ½ (é€šè¿‡email, pager, æˆ–å…¶ä»–ç”¨æˆ·è‡ªå®šä¹‰æ–¹æ³•)&lt;/li&gt;
&lt;li&gt;å¯æŒ‡å®šè‡ªå®šä¹‰çš„äº‹ä»¶å¤„ç†æ§åˆ¶å™¨&lt;/li&gt;
&lt;li&gt;å¯é€‰çš„åŸºäºæµè§ˆå™¨çš„WEBç•Œé¢ä»¥æ–¹ä¾¿ç³»ç»Ÿç®¡ç†äººå‘˜æŸ¥çœ‹ç½‘ç»œçŠ¶æ€ï¼Œå„ç§ç³»ç»Ÿé—®é¢˜ï¼Œä»¥åŠæ—¥å¿—ç­‰ç­‰&lt;/li&gt;
&lt;li&gt;å¯ä»¥é€šè¿‡æ‰‹æœºæŸ¥çœ‹ç³»ç»Ÿç›‘æ§ä¿¡æ¯&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ¬æ–‡ç¯å¢ƒ:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç³»ç»Ÿ:CentOS 5.5 32bit&lt;/li&gt;
&lt;li&gt;ip:192.168.3.3&lt;/li&gt;
&lt;li&gt;nagios core:nagios-3.3.1.tar.gz&lt;/li&gt;
&lt;li&gt;web:nginx(nginx-1.0.5.tar.gz)&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="_1"&gt;å®‰è£…:&lt;/h2&gt;
&lt;h3 id="_2"&gt;å®‰è£…å‡†å¤‡&lt;/h3&gt;
&lt;p&gt;åˆ›å»ºnagiosç³»ç»Ÿç”¨æˆ·:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;useradd&lt;span class="w"&gt;  &lt;/span&gt;nagios
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…ä¾èµ–:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;gd-devel&lt;span class="w"&gt; &lt;/span&gt;libpng-devel&lt;span class="w"&gt; &lt;/span&gt;libtool-ltdl-devel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸‹è½½nagioså†…æ ¸:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;wget&lt;span class="w"&gt; &lt;/span&gt;http://prdownloads.sourceforge.net/sourceforge/nagios/nagios-3.3.1.tar.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="nagios"&gt;å®‰è£…nagioså†…æ ¸:&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;tar&lt;span class="w"&gt; &lt;/span&gt;-zxvf&lt;span class="w"&gt; &lt;/span&gt;nagios-3.3.1.tar.gz
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;nagios
./configure&lt;span class="w"&gt; &lt;/span&gt;--prefix&lt;span class="o"&gt;=&lt;/span&gt;/usr/local/nagios
make&lt;span class="w"&gt; &lt;/span&gt;all
make&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="c1"&gt;# å®‰è£…ä¸»è¦ç¨‹åº,CGIå’ŒHTML&lt;/span&gt;
make&lt;span class="w"&gt; &lt;/span&gt;install-commandmode&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# ä½¿å¤–éƒ¨å‘½ä»¤æœ‰è®¿é—®nagiosé…ç½®æ–‡ä»¶çš„æƒé™&lt;/span&gt;
make&lt;span class="w"&gt; &lt;/span&gt;install-config&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# å®‰è£…é…ç½®æ–‡ä»¶&lt;/span&gt;
make&lt;span class="w"&gt; &lt;/span&gt;install-init&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="c1"&gt;# å®‰è£…nagioså¯åŠ¨è„šæœ¬&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_3"&gt;å®‰è£…æ’ä»¶:&lt;/h3&gt;
&lt;p&gt;nagiosæ²¡æœ‰ä»€ä¹ˆéƒ½åšä¸äº†çš„,æ’ä»¶æå¤§çš„æ‰©å±•äº†nagiosåŠŸèƒ½,é™¤äº†å®‰è£…å®˜æ–¹å¸¸ç”¨æ’ä»¶å¤–,ä¹Ÿå¯ä»¥æ ¹æ®è‡ªå·±éœ€æ±‚ç¼–å†™æ’ä»¶.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;wget&lt;span class="w"&gt; &lt;/span&gt;http://prdownloads.sourceforge.net/sourceforge/nagiosplug/nagios-plugins-1.4.15.tar.gz
tar&lt;span class="w"&gt; &lt;/span&gt;-zxvf&lt;span class="w"&gt; &lt;/span&gt;nagios-plugins-1.4.15.tar.gz
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;nagios-plugins-1.4.15
./configure&lt;span class="w"&gt; &lt;/span&gt;--prefix&lt;span class="o"&gt;=&lt;/span&gt;/usr/local/nagios
make&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="web"&gt;å®‰è£…WEBæœåŠ¡å™¨&lt;/h3&gt;
&lt;p&gt;webæœåŠ¡å™¨ä¸æ˜¯nagiosæ‰€å¿…é¡»çš„,ä½†æ˜¯å¦‚æœä½ æ— æ³•å¿å—é€šè¿‡æ—¥å¿—æ–‡ä»¶æ¥ç›‘æ§å„ä¸ªä¸»æœºçŠ¶æ€,é‚£ä¹ˆwebæœåŠ¡å™¨å°±è‡³å…³é‡è¦,æ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯èŠ±ä¸Šä¸€ç‚¹æ—¶é—´ä¸ºä¹‹åçš„èŠ‚çœæ›´å¤šçš„æ—¶é—´.&lt;/p&gt;
&lt;p&gt;è¿™é‡ŒwebæœåŠ¡å™¨ä½¿ç”¨å½“å‰ä¸»æµçš„nginx:&lt;/p&gt;
&lt;p&gt;å®‰è£…nginx&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;wget&lt;span class="w"&gt; &lt;/span&gt;http://nginx.org/download/nginx-1.0.11.tar.gz
&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;nbsp&lt;span class="p"&gt;;&lt;/span&gt;yum&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;nbsp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;nbsp&lt;span class="p"&gt;;&lt;/span&gt;-y&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;nbsp&lt;span class="p"&gt;;&lt;/span&gt;install&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;nbsp&lt;span class="p"&gt;;&lt;/span&gt;zlib-devel&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;nbsp&lt;span class="p"&gt;;&lt;/span&gt;pcre-devel&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;nbsp&lt;span class="p"&gt;;&lt;/span&gt;openssl-devel&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;nbsp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="c1"&gt;# å®‰è£…ä¾èµ–&lt;/span&gt;
tar&lt;span class="w"&gt; &lt;/span&gt;-zxvf&lt;span class="w"&gt; &lt;/span&gt;nginx-1.0.11.tar.gz
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;nginx-1.0.11
./configure&lt;span class="w"&gt; &lt;/span&gt;--prefix&lt;span class="o"&gt;=&lt;/span&gt;/usr/local/nginx&lt;span class="w"&gt; &lt;/span&gt;--with-http_ssl_module&lt;span class="w"&gt; &lt;/span&gt;--with-http_flv_module&lt;span class="w"&gt; &lt;/span&gt;--with-http_gzip_static_module
make&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é…ç½®nginxæ”¯æŒcgi:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;wget&lt;span class="w"&gt; &lt;/span&gt;http://www.cpan.org/modules/by-module/FCGI/FCGI-0.67.tar.gz
tar&lt;span class="w"&gt; &lt;/span&gt;-zxvf&lt;span class="w"&gt; &lt;/span&gt;FCGI-0.67.tar.gz
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;FCGI-0.67
perl&lt;span class="w"&gt; &lt;/span&gt;Makefile.PL
make&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;install
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;..
wget&lt;span class="w"&gt; &lt;/span&gt;http://cpan.wenzk.com/authors/id/G/GB/GBJK/FCGI-ProcManager-0.19.tar.gz
tar&lt;span class="w"&gt; &lt;/span&gt;-zxvf&lt;span class="w"&gt; &lt;/span&gt;FCGI-ProcManager-0.19.tar.gz
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;FCGI-ProcManager-0.19
perl&lt;span class="w"&gt; &lt;/span&gt;Makefile.PL
make&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;install
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;..
wget&lt;span class="w"&gt; &lt;/span&gt;http://search.cpan.org/CPAN/authors/id/I/IN/INGY/IO-All-0.39.tar.gz
tar&lt;span class="w"&gt; &lt;/span&gt;zxvf&lt;span class="w"&gt; &lt;/span&gt;IO-All-0.39.tar.gz
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;IO-All-0.39
perl&lt;span class="w"&gt; &lt;/span&gt;Makefile.PL
make&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åˆ›å»ºcgiwarp-fcgi.pl(å†…å®¹å‚ç…§&lt;a href="http://wiki.nginx.org/NginxSimpleCGI"&gt;è¿™é‡Œ&lt;/a&gt;),å°†cgiwarp-fcgi.plæ”¾åˆ°/usr/local/binä¸‹ç»™æ‰§è¡Œæƒé™,å¹¶æ‰§è¡Œ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;chmod&lt;span class="w"&gt; &lt;/span&gt;+x&lt;span class="w"&gt; &lt;/span&gt;/usr/local/bin/cgiwarp-fcgi.pl
mkdir&lt;span class="w"&gt; &lt;/span&gt;-p&lt;span class="w"&gt; &lt;/span&gt;/var/run/nginx/
perl&lt;span class="w"&gt; &lt;/span&gt;/usr/local/bin/cgiwarp-fcgi.pl
chown&lt;span class="w"&gt; &lt;/span&gt;nobody.nobody&lt;span class="w"&gt; &lt;/span&gt;/var/run/nginx/cgiwrap-dispatch.sock&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# æ”¹å˜å±ä¸»ä¸ºnobody,æ˜¯nginxæ­£å¸¸ä½¿ç”¨&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é…ç½®nginxæ”¯æŒèº«ä»½éªŒè¯&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;httpd
chkconfig&lt;span class="w"&gt; &lt;/span&gt;--del&lt;span class="w"&gt; &lt;/span&gt;httpd
mkdir&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nginx/conf/htpasswd
htpasswd&lt;span class="w"&gt; &lt;/span&gt;-c&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nginx/conf/htpasswd/nagios&lt;span class="w"&gt; &lt;/span&gt;nagiosadmin&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# æ·»åŠ nagiosadminç”¨æˆ·&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿˜éœ€è¦é…ç½®nginxæ”¯æŒphp,è¿™é‡Œä½¿ç”¨php-fpmçš„æ–¹å¼,è¿™é‡Œå°±ä¸ä»‹ç».&lt;/p&gt;
&lt;h2 id="_4"&gt;é…ç½®&lt;/h2&gt;
&lt;p&gt;é¦–å…ˆé…ç½®nginx:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="w"&gt;    &lt;/span&gt;server&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;listen&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.3:80&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;server_name&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.3&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;auth_basic&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Nagios&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;auth_basic_user_file&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nginx/conf/htpasswd/nagios&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# ä¸ºäº†æ­£å¸¸ä½¿ç”¨csså’Œæ˜¾ç¤ºå›¾ç‰‡åšä¸€ä¸ªurlé‡å†™&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$request_filename&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;~&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\.&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;gifÂ¦pngÂ¦jpgÂ¦jpegÂ¦ico&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;rewrite&lt;span class="w"&gt; &lt;/span&gt;^/nagios/&lt;span class="o"&gt;(&lt;/span&gt;images/.*&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/&lt;span class="nv"&gt;$1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;break&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$request_filename&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;~&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\.&lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;css&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;rewrite&lt;span class="w"&gt; &lt;/span&gt;^/nagios/&lt;span class="o"&gt;(&lt;/span&gt;stylesheets/.*&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/&lt;span class="nv"&gt;$1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;break&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# æ”¯æŒphpçš„é…ç½®&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;location&lt;span class="w"&gt; &lt;/span&gt;/&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nagios/share/&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;index&lt;span class="w"&gt; &lt;/span&gt;index.php&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_pass&lt;span class="w"&gt; &lt;/span&gt;unix:/var/run/php/php-fpm.sock&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_index&lt;span class="w"&gt; &lt;/span&gt;index.php&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_param&lt;span class="w"&gt; &lt;/span&gt;SCRIPT_FILENAME&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$document_root&lt;/span&gt;/&lt;span class="nv"&gt;$fastcgi_script_name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;include&lt;span class="w"&gt; &lt;/span&gt;fastcgi_params&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;include&lt;span class="w"&gt; &lt;/span&gt;fastcgi.conf&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# æ”¯æŒcgiçš„é…ç½®&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;location&lt;span class="w"&gt; &lt;/span&gt;~&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\.&lt;/span&gt;cgi$&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nagios/sbin/&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;rewrite&lt;span class="w"&gt; &lt;/span&gt;^/nagios/cgi-bin/&lt;span class="o"&gt;(&lt;/span&gt;.*&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="se"&gt;\.&lt;/span&gt;cgi&lt;span class="o"&gt;(&lt;/span&gt;.*&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/&lt;span class="nv"&gt;$1&lt;/span&gt;.cgi&lt;span class="nv"&gt;$2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;break&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_pass&lt;span class="w"&gt; &lt;/span&gt;unix:/var/run/nginx/cgiwrap-dispatch.sock&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_index&lt;span class="w"&gt;   &lt;/span&gt;index.cgi&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_param&lt;span class="w"&gt; &lt;/span&gt;SCRIPT_FILENAME&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="nv"&gt;$document_root&lt;/span&gt;/&lt;span class="nv"&gt;$fastcgi_script_name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_param&lt;span class="w"&gt; &lt;/span&gt;QUERY_STRING&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="nv"&gt;$query_string&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_param&lt;span class="w"&gt; &lt;/span&gt;REQUEST_METHOD&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="nv"&gt;$request_method&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_param&lt;span class="w"&gt; &lt;/span&gt;CONTENT_TYPE&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="nv"&gt;$content_type&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_param&lt;span class="w"&gt; &lt;/span&gt;CONTENT_LENGTH&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="nv"&gt;$content_length&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_param&lt;span class="w"&gt; &lt;/span&gt;GATEWAY_INTERFACE&lt;span class="w"&gt;  &lt;/span&gt;CGI/1.1&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_param&lt;span class="w"&gt; &lt;/span&gt;SERVER_SOFTWARE&lt;span class="w"&gt;    &lt;/span&gt;nginx&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_param&lt;span class="w"&gt; &lt;/span&gt;SCRIPT_NAME&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nv"&gt;$fastcgi_script_name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_param&lt;span class="w"&gt; &lt;/span&gt;REQUEST_URI&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nv"&gt;$request_uri&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_param&lt;span class="w"&gt; &lt;/span&gt;DOCUMENT_URI&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="nv"&gt;$document_uri&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_param&lt;span class="w"&gt; &lt;/span&gt;DOCUMENT_ROOT&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="nv"&gt;$document_root&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_param&lt;span class="w"&gt; &lt;/span&gt;SERVER_PROTOCOL&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="nv"&gt;$server_protocol&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_param&lt;span class="w"&gt; &lt;/span&gt;REMOTE_ADDR&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nv"&gt;$remote_addr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_param&lt;span class="w"&gt; &lt;/span&gt;REMOTE_PORT&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nv"&gt;$remote_port&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_param&lt;span class="w"&gt; &lt;/span&gt;SERVER_ADDR&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nv"&gt;$server_addr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_param&lt;span class="w"&gt; &lt;/span&gt;SERVER_PORT&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nv"&gt;$server_port&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;fastcgi_param&lt;span class="w"&gt; &lt;/span&gt;SERVER_NAME&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nv"&gt;$server_name&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¿®æ”¹nagiosä¸»é…æ–‡ä»¶,ä¿®æ”¹nagiosè¿è¡Œè´¦æˆ·:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nagios/etc/nagios.cfg

&lt;span class="c1"&gt;# ç¼–è¾‘ä¸‹é¢é€‰é¡¹:&lt;/span&gt;
&lt;span class="nv"&gt;nagios_user&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;nobody
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¿®æ”¹cgi.cfgé…ç½®æ–‡ä»¶
ä¿®æ”¹é»˜è®¤è®¤è¯cgiç”¨æˆ·çš„ä¸ºåˆšæ‰ç”¨htpasswdåˆ›å»ºçš„nagiosadmin,æˆ–ç”¨htpasswdæ–°å»ºä¸€ä¸ªç”¨æˆ·ç”¨æ¥è®¤è¯cgiæ–‡ä»¶(ä¸ç„¶nagiosæŠ¥é”™:&lt;code&gt;It appears as though you do not have permission to view information for any of the hosts you requested...&lt;/code&gt;)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nagios/etc/cgi.cfg
&lt;span class="nv"&gt;default_user_name&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;nagiosadmin
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¿®æ”¹localhost.cfgæ·»åŠ ä¸€ä¸ªæ–°çš„ç›‘æ§ä¸»æœº:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nagios/etc/objects/localhost.cfg

&lt;span class="c1"&gt;#  é€šè¿‡å®šä¹‰hostæ·»åŠ ä¸€ä¸ªä¸»æœº&lt;/span&gt;
&lt;span class="c1"&gt;#  æ·»åŠ ä¸€ä¸ªipä¸º192.168.3.102çš„ç›‘æ§ä¸»æœº&lt;/span&gt;
define&lt;span class="w"&gt; &lt;/span&gt;host&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;use&lt;span class="w"&gt;                     &lt;/span&gt;linux-server
&lt;span class="w"&gt;        &lt;/span&gt;host_name&lt;span class="w"&gt;               &lt;/span&gt;slave.org
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;alias&lt;/span&gt;&lt;span class="w"&gt;                   &lt;/span&gt;&lt;span class="m"&gt;102&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;address&lt;span class="w"&gt;                 &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.102
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
....
&lt;span class="c1"&gt;# é€šè¿‡å®šä¹‰serviceå®šä¹‰ç›‘æ§çš„æœåŠ¡:&lt;/span&gt;
&lt;span class="c1"&gt;# é€šè¿‡pingæ¥ç›‘æ§ä¸»æœºæ˜¯å¦å­˜æ´»&lt;/span&gt;
define&lt;span class="w"&gt; &lt;/span&gt;service&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;use&lt;span class="w"&gt;                             &lt;/span&gt;local-service
&lt;span class="w"&gt;        &lt;/span&gt;host_name&lt;span class="w"&gt;                       &lt;/span&gt;slave.org
&lt;span class="w"&gt;        &lt;/span&gt;service_description&lt;span class="w"&gt;             &lt;/span&gt;PING
&lt;span class="w"&gt;        &lt;/span&gt;check_command&lt;span class="w"&gt;                   &lt;/span&gt;check_ping!100.0,20%!500.0,%60
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¿®æ”¹nagioså®‰è£…ç›®å½•æƒé™:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;chown&lt;span class="w"&gt; &lt;/span&gt;-R&lt;span class="w"&gt; &lt;/span&gt;nobody.nagios&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nagios
chmod&lt;span class="w"&gt; &lt;/span&gt;-R&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;775&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nagios/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ£€æŸ¥nagiosé…ç½®æ–‡ä»¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;/usr/local/nagios/bin/nagios&lt;span class="w"&gt; &lt;/span&gt;-v&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nagios/etc/nagios.cfg
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åœ¨æœ€åçœ‹åˆ°å¦‚ä¸‹åˆ™è¡¨ç¤ºæˆåŠŸ:&lt;/p&gt;
&lt;p&gt;Total Warnings: 0
Total Errors:Â Â  0
Things look okay - No serious problems were detected during the pre-flight check&lt;/p&gt;
&lt;p&gt;å¯åŠ¨nagios:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;service&lt;span class="w"&gt; &lt;/span&gt;nagios&lt;span class="w"&gt; &lt;/span&gt;start
Starting&lt;span class="w"&gt; &lt;/span&gt;nagios:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ—¶å€™åœ¨æµè§ˆå™¨é‡Œè¾“å…¥&lt;code&gt;http://ip/&lt;/code&gt;æŸ¥çœ‹çŠ¶æ€,ç°åœ¨èƒ½çœ‹åˆ°æ‰€æœ‰ç›‘æ§ä¸»æœºçš„çš„çŠ¶æ€äº†.&lt;/p&gt;
&lt;p&gt;&lt;img alt="www.linuxzen.com" src="/upload/blog001.jpg"&gt;&lt;/p&gt;</content><category term="Linux"></category><category term="é…ç½®"></category><category term="ç›‘æ§"></category><category term="rewrite"></category><category term="nginxè®¤è¯"></category><category term="nginxæ”¯æŒcgi"></category><category term="nginx"></category><category term="nagios"></category><category term="Linux"></category></entry><entry><title>æ­å»ºntopç›‘æµ‹å±€åŸŸç½‘å†…æµé‡</title><link href="https://www.linuxzen.com/da-jian-ntopjian-ce-ju-yu-wang-nei-liu-liang.html" rel="alternate"></link><published>2012-02-20T17:37:00+08:00</published><updated>2012-02-20T17:37:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-02-20:/da-jian-ntopjian-ce-ju-yu-wang-nei-liu-liang.html</id><summary type="html">&lt;p&gt;ntopæ˜¯ä¸€ç§ç›‘æ§ç½‘ç»œæµé‡çš„å·¥å…·ï¼Œç”¨ntopæ˜¾ç¤ºç½‘ç»œçš„ä½¿ç”¨æƒ…å†µæ¯”å…¶ä»–ä¸€äº›ç½‘ç®¡è½¯ä»¶æ›´åŠ ç›´è§‚ã€è¯¦ç»†ã€‚ntopç”šè‡³å¯ä»¥åˆ—å‡ºæ¯ä¸ªèŠ‚ç‚¹è®¡ç®—æœºçš„ç½‘ç»œå¸¦å®½åˆ©ç”¨ç‡ã€‚ntopæ˜¯ä¸€ä¸ªçµæ´»çš„ã€åŠŸèƒ½é½å…¨çš„ï¼Œç”¨æ¥ç›‘æ§å’Œè§£å†³å±€åŸŸç½‘é—®é¢˜çš„å·¥å…·ã€‚å®ƒåŒæ—¶æä¾›å‘½ä»¤è¡Œè¾“å…¥å’ŒWebç•Œé¢ï¼Œå¯åº”ç”¨äºåµŒå…¥å¼WebæœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ç¯ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;ntopæ˜¯ä¸€ç§ç›‘æ§ç½‘ç»œæµé‡çš„å·¥å…·ï¼Œç”¨ntopæ˜¾ç¤ºç½‘ç»œçš„ä½¿ç”¨æƒ…å†µæ¯”å…¶ä»–ä¸€äº›ç½‘ç®¡è½¯ä»¶æ›´åŠ ç›´è§‚ã€è¯¦ç»†ã€‚ntopç”šè‡³å¯ä»¥åˆ—å‡ºæ¯ä¸ªèŠ‚ç‚¹è®¡ç®—æœºçš„ç½‘ç»œå¸¦å®½åˆ©ç”¨ç‡ã€‚ntopæ˜¯ä¸€ä¸ªçµæ´»çš„ã€åŠŸèƒ½é½å…¨çš„ï¼Œç”¨æ¥ç›‘æ§å’Œè§£å†³å±€åŸŸç½‘é—®é¢˜çš„å·¥å…·ã€‚å®ƒåŒæ—¶æä¾›å‘½ä»¤è¡Œè¾“å…¥å’ŒWebç•Œé¢ï¼Œå¯åº”ç”¨äºåµŒå…¥å¼WebæœåŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ç¯å¢ƒ:CentOS5.5 32ä½&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ip:192.168.3.101&lt;/li&gt;
&lt;li&gt;rrdtool:rrdtool-1.4.7.tar.gz&lt;/li&gt;
&lt;li&gt;GeoIP:GeoIP-1.4.8.tar.gz&lt;/li&gt;
&lt;li&gt;ntop:ntop-4.1.0.tar.gz&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="_1"&gt;ä¸€.å®‰è£…ä¾èµ–:&lt;/h2&gt;
&lt;h3 id="rrdtool"&gt;å®‰è£…rrdtool&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;libxml2&lt;span class="w"&gt; &lt;/span&gt;glib-devel&lt;span class="w"&gt; &lt;/span&gt;pango-devel
wget&lt;span class="w"&gt; &lt;/span&gt;http://oss.oetiker.ch/rrdtool/pub/rrdtool-1.4.7.tar.gz&lt;span class="w"&gt;                  &lt;/span&gt;&lt;span class="c1"&gt;# ä¸‹è½½&lt;/span&gt;
tar&lt;span class="w"&gt; &lt;/span&gt;-zxvf&lt;span class="w"&gt; &lt;/span&gt;rrdtool-1.4.7.tar.gz
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;rrdtool-1.4.7
./configure&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="geoip"&gt;å®‰è£…geoip:&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;wget&lt;span class="w"&gt; &lt;/span&gt;http://geolite.maxmind.com/download/geoip/api/c/GeoIP-1.4.8.tar.gz
tar&lt;span class="w"&gt; &lt;/span&gt;-zxvf&lt;span class="w"&gt; &lt;/span&gt;GeoIP-1.4.8.tar.gz
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;GeoIP-1.4.8
./configure&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_2"&gt;å®‰è£…å…¶ä½™ä¾èµ–:&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;libtool&lt;span class="w"&gt; &lt;/span&gt;libpcap-devel&lt;span class="w"&gt; &lt;/span&gt;gd-devel&lt;span class="w"&gt; &lt;/span&gt;gdbm-devel&lt;span class="w"&gt; &lt;/span&gt;openssl-devel
&lt;span class="w"&gt; &lt;/span&gt;intltool
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;h2 id="_3"&gt;äºŒ.ä¸‹è½½å®‰è£…:&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;wget&lt;span class="w"&gt; &lt;/span&gt;http://sourceforge.net/projects/ntop/files/ntop/Stable/ntop-4.1.0.tar.gz/download
tar&lt;span class="w"&gt; &lt;/span&gt;-zxvf&lt;span class="w"&gt; &lt;/span&gt;ntop-4.1.0.tar.gz
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;ntop-4.1.0
./autogen.sh&lt;span class="w"&gt; &lt;/span&gt;--with-tcpwrap&lt;span class="w"&gt; &lt;/span&gt;--with-rrd-home&lt;span class="o"&gt;=&lt;/span&gt;/opt/rrdtool-1.4.7/
make&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="_4"&gt;ä¸‰.é…ç½®å¯åŠ¨&lt;/h2&gt;
&lt;p&gt;æ›´æ”¹æ£€æµ‹æ•°æ®ä¿å­˜ç›®å½•çš„æƒé™:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;chown&lt;span class="w"&gt; &lt;/span&gt;-R&lt;span class="w"&gt; &lt;/span&gt;nobody&lt;span class="w"&gt; &lt;/span&gt;/usr/local/var/ntop/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åˆ›å»ºadminç®¡ç†å¯†ç :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ntop&lt;span class="w"&gt; &lt;/span&gt;-A
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åœ¨eth0ä¸Šå¯åŠ¨ntop:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ntop&lt;span class="w"&gt; &lt;/span&gt;-d&lt;span class="w"&gt; &lt;/span&gt;-i&lt;span class="w"&gt; &lt;/span&gt;eth0&lt;span class="w"&gt; &lt;/span&gt;-M
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®¢æˆ·ç«¯æµè§ˆç›‘æµ‹ç»“æœ:
åœ¨æµè§ˆå™¨ä¸Šè¾“å…¥:http://192.168.3.101:3000è®¿é—®å³å¯æŸ¥çœ‹ç›‘æµ‹ç»“æœ,Adminå¯ä»¥é…ç½®ntop.åˆ°æ­¤è¿™ä¸ªç›‘æ§å±€åŸŸç½‘æµé‡çš„ntopå°±æ­å»ºå®Œæˆ,è¿™æ ·å°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„æŸ¥çœ‹å±€åŸŸç½‘æµé‡,å¯ä»¥å‘ç°æ˜¯å¦æœ‰äººåœ¨æ‰§è¡Œarpæ”»å‡»ç­‰ç­‰å¸¸è§æ”»å‡».å‰©ä½™çš„åŠŸèƒ½å¤§å®¶å°±è‡ªå·±å‘ç°å§,è¿™é‡Œä¸é”™ä»‹ç».&lt;/p&gt;
&lt;p&gt;å¦‚æœè‹±è¯­é˜…è¯»å›°éš¾çš„è¯å¯ä»¥,æœ‰ç‰›äººå·²ç»åšå‡ºæ¥äº†ä¸­æ–‡ç‰ˆ,å¤§å®¶å¯ä»¥ä¸‹è½½å®‰è£….&lt;/p&gt;</content><category term="Linux"></category><category term="ç›‘æ§"></category><category term="æµé‡"></category><category term="å±€åŸŸç½‘"></category><category term="ntop"></category><category term="Linux"></category></entry><entry><title>Linuxä¸€äº›æ¯”è¾ƒå®ç”¨çš„å°æŠ€å·§</title><link href="https://www.linuxzen.com/linuxyi-xie-bi-jiao-shi-yong-de-xiao-ji-qiao.html" rel="alternate"></link><published>2012-02-20T11:30:00+08:00</published><updated>2012-02-20T11:30:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-02-20:/linuxyi-xie-bi-jiao-shi-yong-de-xiao-ji-qiao.html</id><summary type="html">&lt;p&gt;åœ¨Linuxä¸­å„ç§å„æ ·çš„å°æŠ€å·§å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½æ›´å¿«çš„å®Œæˆæˆ‘ä»¬çš„å·¥ä½œ,ä¸‹é¢å°±ä»‹ç»ä¸€äº›æˆ‘æ‰€çŸ¥é“çš„å°æŠ€å·§&lt;/p&gt;
&lt;h2 id="_1"&gt;æ–‡ä»¶æŸ¥æ‰¾&lt;/h2&gt;
&lt;p&gt;æ‰¾å‡ºæœ€è¿‘ä¿®æ”¹çš„æ–‡ä»¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;find&lt;span class="w"&gt; &lt;/span&gt;/&lt;span class="w"&gt; &lt;/span&gt;-ctime&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# æ‰¾å‡ºæ ¹ä¸‹æœ€è¿‘24å°æ—¶ä¿®æ”¹è¿‡inodeä¿¡æ¯çš„æ–‡ä»¶(æ›´æ”¹æƒé™)&lt;/span&gt;
find&lt;span class="w"&gt; &lt;/span&gt;/&lt;span class="w"&gt; &lt;/span&gt;-mtime&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# æ‰¾å‡ºæ ¹ â€¦&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;åœ¨Linuxä¸­å„ç§å„æ ·çš„å°æŠ€å·§å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½æ›´å¿«çš„å®Œæˆæˆ‘ä»¬çš„å·¥ä½œ,ä¸‹é¢å°±ä»‹ç»ä¸€äº›æˆ‘æ‰€çŸ¥é“çš„å°æŠ€å·§&lt;/p&gt;
&lt;h2 id="_1"&gt;æ–‡ä»¶æŸ¥æ‰¾&lt;/h2&gt;
&lt;p&gt;æ‰¾å‡ºæœ€è¿‘ä¿®æ”¹çš„æ–‡ä»¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;find&lt;span class="w"&gt; &lt;/span&gt;/&lt;span class="w"&gt; &lt;/span&gt;-ctime&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# æ‰¾å‡ºæ ¹ä¸‹æœ€è¿‘24å°æ—¶ä¿®æ”¹è¿‡inodeä¿¡æ¯çš„æ–‡ä»¶(æ›´æ”¹æƒé™)&lt;/span&gt;
find&lt;span class="w"&gt; &lt;/span&gt;/&lt;span class="w"&gt; &lt;/span&gt;-mtime&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# æ‰¾å‡ºæ ¹ä¸‹æœ€è¿‘24å°æ—¶ä¿®æ”¹è¿‡çš„æ–‡ä»¶(å†…å®¹)&lt;/span&gt;
find&lt;span class="w"&gt; &lt;/span&gt;/&lt;span class="w"&gt; &lt;/span&gt;-atime&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# æ‰¾å‡ºæ ¹ä¸‹æœ€è¿‘24å°æ—¶è®¿é—®è¿‡çš„æ–‡ä»¶&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä½¿ç”¨é€šé…ç¬¦æŸ¥æ‰¾æ–‡ä»¶&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;find&lt;span class="w"&gt; &lt;/span&gt;/&lt;span class="w"&gt; &lt;/span&gt;-name&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;*.log&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# æ‰¾å‡ºæ ¹ä¸‹ä»¥logä¸ºåç¼€çš„æ–‡ä»¶,è¿™é‡Œå¿…é¡»è¦åŠ åŒå¼•å·,ä¸ç„¶ä¼šæŠ¥é”™,å› ä¸ºæ‰¾çš„æ˜¯å¤šä¸ªæ–‡ä»¶,éœ€è¦ç”¨åŒå¼•å·å¼•èµ·æ¥&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="_2"&gt;æ–‡æœ¬æ›¿æ¢&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sed&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;2s/ext3/ext4/&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/etc/fstab&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# å°†ç¬¬äºŒè¡Œçš„ext3æ”¹æˆext4&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="_3"&gt;æ˜¾ç¤ºæŒ‡å®šè¡Œ&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sed&lt;span class="w"&gt; &lt;/span&gt;-n&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;3p&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/etc/fstab&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="c1"&gt;# æ˜¾ç¤ºç¬¬3è¡Œ&lt;/span&gt;
sed&lt;span class="w"&gt; &lt;/span&gt;-n&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;3,5p&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/etc/gfstab&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# æ˜¾ç¤ºç¬¬3åˆ°5è¡Œ&lt;/span&gt;
sed&lt;span class="w"&gt; &lt;/span&gt;-n&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;3p;5p&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/etc/fstab&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# æ˜¾ç¤ºç¬¬3è¡Œå’Œç¬¬5è¡Œ&lt;/span&gt;
awk&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;NR==3&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/etc/fstab&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="c1"&gt;# æ˜¾ç¤ºç¬¬3è¡Œ&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="_4"&gt;åœ¨è¡Œé¦–æˆ–è¡Œå°¾æ·»åŠ :&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sed&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;s/^/hello&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;test&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# åœ¨testæ–‡ä»¶çš„è¡Œé¦–æ·»åŠ hello&lt;/span&gt;
sed&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;s/$/hello&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;test&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# åœ¨testæ–‡ä»¶çš„è¡Œå°¾æ·»åŠ hello&lt;/span&gt;
sed&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;3s/^/hello&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;test&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# åœ¨testæ–‡ä»¶çš„ç¬¬3è¡Œè¡Œé¦–æ·»åŠ hello&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="vi"&gt;åœ¨vié‡Œæ‰§è¡Œå‘½ä»¤:&lt;/h2&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/etc/sysconfig/networ-scripts/ifcfg-eth0
&lt;span class="c1"&gt;# æ‰“å¼€vi,åœ¨æœ«è¡Œæ¨¡å¼ä¸‹(ESC-&amp;amp;gt;:)&lt;/span&gt;

:r!cat&lt;span class="w"&gt; &lt;/span&gt;/mnt/ip.txt&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="c1"&gt;# åœ¨å½“å‰è¡Œçš„ä¸‹é¢è¾“å…¥ip.txtçš„å†…å®¹,rä»£è¡¨å‘½ä»¤è¾“å‡ºæ”¾åˆ°ä¸‹ä¸€è¡Œ,!åé¢æ˜¯è¦æ‰§è¡Œçš„å‘½ä»¤&lt;/span&gt;
:.!cat&lt;span class="w"&gt; &lt;/span&gt;/mnt/ip.txt&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="c1"&gt;# åœ¨å½“å‰è¡Œè¾“å…¥ip.txtçš„å†…å®¹,.ä»£è¡¨å°†å‘½ä»¤è¾“å‡ºæ”¾åˆ°å½“å‰èˆª&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="_5"&gt;æ‰§è¡Œä¸Šä¸€æ¡å‘½ä»¤:&lt;/h2&gt;
&lt;p&gt;å¦‚æœåˆšæ‰§è¡Œäº†ä¸€æ¡server network restart,å¦‚æœåˆåšäº†ä¸€äº›æ“ä½œ,éœ€è¦å†æ¬¡æ‰§è¡Œ,æŒ‰ä¸Šé”®è°ƒå¤„å¯ä»¥,è¿˜æœ‰æ›´å¿«æ·çš„å°±æ˜¯:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;!ser
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;!ä¼šåœ¨å‘½ä»¤å†å²æ‰¾ä¸!åé¢åŒ¹é…çš„æœ€è¿‘ä¸€æ¡å‘½ä»¤.&lt;/p&gt;
&lt;h2 id="ssh"&gt;é€šè¿‡sshè¿æ¥æœåŠ¡å™¨ä¸Šä¼ ä¸‹è½½æ–‡ä»¶:&lt;/h2&gt;
&lt;p&gt;å½“ä½ é€šè¿‡sshè¿æ¥ä½ çš„Linuxçš„æ—¶å€™ä½ æƒ³ä¸‹è½½ä¸€ä¸ªæ–‡ä»¶åˆ°æœ¬åœ°,æˆ–è€…åƒæŠŠæœ¬åœ°æ–‡ä»¶ä¸Šä¼ åˆ°è¿œç«¯,ä½ æƒ³åˆ°ç”¨ftpå—?outäº†,å½“ä½ é€šè¿‡sshè¿æ¥çš„æ—¶å€™Linuxæä¾›äº†ä¸¤ä¸ªå‘½ä»¤ rz/sz,å‘½ä»¤ä¾èµ–äºåŒ…lrzsz.rzå‘½ä»¤å¯ä»¥å°†æœ¬åœ°æ–‡ä»¶é€šè¿‡sshä¸Šä¼ åˆ°Linuxä¸Š,sz pkg å¯ä»¥å°†è¿œç«¯çš„pkgä¸‹è½½åˆ°æœ¬åœ°.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;lrzsz&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="c1"&gt;# å®‰è£…&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åå°±å¯ä»¥é€šè¿‡rz/szæ¥ä¸Šä¼ ä¸‹è½½æ–‡ä»¶,çœå»äº†æ–‡ä»¶æœåŠ¡å™¨,ä¹Ÿå¯æ›´æ–¹ä¾¿æ›´å¿«æ·çš„ç®¡ç†ä½ çš„æœåŠ¡å™¨&lt;/p&gt;
&lt;h2 id="windowslinux"&gt;windowsæ–‡ä»¶è½¬æ¢ä¸ºLinuxæ ¼å¼çš„æ–‡ä»¶&lt;/h2&gt;
&lt;p&gt;windowsçš„æ–‡ä»¶æ ¼å¼æ¯”Linuxæ ¼å¼çš„æ–‡ä»¶å¤šäº†ä¸€ä¸ªå›è½¦ç¬¦\r,å¯ä»¥é€šè¿‡å‘½ä»¤æ¥å®ç°è½¬æ¢:
ç›´æ¥è½¬æ¢,dos2unixä¾èµ–äºåŒ…dos2unix:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;dos2unix&lt;span class="w"&gt; &lt;/span&gt;file.txt&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="c1"&gt;# éœ€è¦å®‰è£…dos2unixåŒ…&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é€šè¿‡åˆ é™¤\ræ¥å®ç°è½¬æ¢:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;tr&lt;span class="w"&gt; &lt;/span&gt;-d&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;\r&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;file.txt&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;file1.txt&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# é€šè¿‡trå‘½ä»¤åˆ é™¤\rå­—ç¬¦,å¹¶é‡å®šå‘è¿½åŠ åˆ°file1.txt&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Linux"></category><category term="å‘½ä»¤"></category><category term="sz"></category><category term="sshä¸Šä¼ ä¸‹è½½"></category><category term="shell"></category><category term="sed"></category><category term="rz"></category><category term="lrzsz"></category><category term="Linux"></category><category term="find"></category><category term="awk"></category></entry><entry><title>ç¼–å†™Linux shellè„šæœ¬æ¥å®ç°nginxæ—¥å¿—åˆ†å‰²</title><link href="https://www.linuxzen.com/bian-xie-linux-shelljiao-ben-lai-shi-xian-nginxri-zhi-fen-ge.html" rel="alternate"></link><published>2012-02-17T10:27:00+08:00</published><updated>2012-02-17T10:27:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-02-17:/bian-xie-linux-shelljiao-ben-lai-shi-xian-nginxri-zhi-fen-ge.html</id><summary type="html">&lt;p&gt;nginxçš„accssæ—¥å¿—æ¯å¤©éƒ½ä¼šäº§ç”Ÿå¤§é‡çš„æ—¥å¿—,ä¸è¿‡ä¸è¿›è¡Œåˆ‡å‰²ä¼šä½¿æŸ¥çœ‹æ—¥å¿—å˜å¾—å¼‚å¸¸è‰°éš¾,è¿™é‡Œç¼–å†™ä¸€ä¸ªè„šæœ¬ç»“åˆcrondæ¥å®ç°nginxçš„æ—¥å¿—åˆ‡å‰²,åˆ‡å‰²çš„æ ¼å¼ä¸ºæ—¥å¿—åç¼€çš„æ•°å­—è¶Šå°è¡¨ç¤ºç¦»å½“ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;nginxçš„accssæ—¥å¿—æ¯å¤©éƒ½ä¼šäº§ç”Ÿå¤§é‡çš„æ—¥å¿—,ä¸è¿‡ä¸è¿›è¡Œåˆ‡å‰²ä¼šä½¿æŸ¥çœ‹æ—¥å¿—å˜å¾—å¼‚å¸¸è‰°éš¾,è¿™é‡Œç¼–å†™ä¸€ä¸ªè„šæœ¬ç»“åˆcrondæ¥å®ç°nginxçš„æ—¥å¿—åˆ‡å‰²,åˆ‡å‰²çš„æ ¼å¼ä¸ºæ—¥å¿—åç¼€çš„æ•°å­—è¶Šå°è¡¨ç¤ºç¦»å½“å‰æ—¥æœŸè¶Šè¿‘,æ¯”å¦‚access.log.2å­˜æ”¾çš„å†…å®¹è¦æ¯”access.log.1çš„å†…å®¹è¦æ—©.&lt;/p&gt;
&lt;p&gt;å¥½äº†,åºŸè¯ä¸å¤šè¯´,è„šæœ¬å†…å®¹å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/sh&lt;/span&gt;
&lt;span class="c1"&gt;# Author   : cold night&lt;/span&gt;
&lt;span class="c1"&gt;# Filename : nglogcut.sh&lt;/span&gt;
&lt;span class="nb"&gt;export&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;PATH&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;/usr/kerberos/sbin:/usr/kerberos/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/root/bin
&lt;span class="nv"&gt;LogPath&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/usr/local/nginx/logs/access.log&amp;#39;&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# å®šä¹‰æ—¥å¿—ç»å¯¹è·¯å¾„&lt;/span&gt;

&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;i&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;ls&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$LogPath&lt;/span&gt;*&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;awk&lt;span class="w"&gt; &lt;/span&gt;-F&lt;span class="s1"&gt;&amp;#39;/&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;{print $NF}&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;sort&lt;span class="w"&gt; &lt;/span&gt;-nr&lt;span class="sb"&gt;`&lt;/span&gt;
&lt;span class="k"&gt;do&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nv"&gt;LastNum&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;awk&lt;span class="w"&gt; &lt;/span&gt;-F&lt;span class="s1"&gt;&amp;#39;.&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;{print $NF}&amp;#39;&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$LastNum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;-E&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;[0-9]+&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&amp;gt;/dev/null&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&amp;gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$?&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-eq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]]&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="nv"&gt;OnNum&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;expr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$LastNum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;mv&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$LogPath&lt;/span&gt;.&lt;span class="nv"&gt;$LastNum&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$LogPath&lt;/span&gt;.&lt;span class="nv"&gt;$OnNum&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;else&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;mv&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$LogPath&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$LogPath&lt;/span&gt;.1
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="nb"&gt;kill&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-HUP&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;cat&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nginx/logs/nginx.pid&lt;span class="sb"&gt;`&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="k"&gt;fi&lt;/span&gt;
&lt;span class="k"&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åä¿å­˜ä¸ºnglogcut.shå­˜æ”¾åœ¨/root/ä¸‹,ä¸‹é¢ç»™è„šæœ¬èµ‹äºˆæ‰§è¡Œæƒé™&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;chmod&lt;span class="w"&gt; &lt;/span&gt;+x&lt;span class="w"&gt; &lt;/span&gt;/root/nglogcut.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é…ç½®crondè‡ªåŠ¨æ‰§è¡Œ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;crontab&lt;span class="w"&gt; &lt;/span&gt;-e&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# æ‰§è¡Œcrontab -eä¸ºå½“å‰ç”¨æˆ·æ·»åŠ ,ä½†å¿…é¡»è¦å†è„šæœ¬å‰é¢å£°æ˜PATHè·¯å¾„,æˆ–å‘½ä»¤ç”¨ç»å¯¹è·¯å¾„&lt;/span&gt;

&lt;span class="c1"&gt;# æ·»åŠ å¦‚ä¸‹å†…å®¹:&lt;/span&gt;
&lt;span class="m"&gt;00&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;*/3&lt;span class="w"&gt; &lt;/span&gt;*&lt;span class="w"&gt; &lt;/span&gt;*&lt;span class="w"&gt; &lt;/span&gt;/bin/sh&lt;span class="w"&gt; &lt;/span&gt;/root/nglogcut.sh&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;/dev/null&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&amp;gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# æ¯3å¤©æ‰§è¡Œæ—¥å¿—åˆ†å‰²(å¯æ ¹æ®è‡ªå·±æƒ…å†µæ¥å®šä¹‰æ‰§è¡Œå‘¨æœŸ)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;Update 2019-02-20&lt;/strong&gt;: æœ€ä½³å®è·µåº”è¯¥æ˜¯ä½¿ç”¨ &lt;a href="https://linux.die.net/man/8/logrotate"&gt;logrotate&lt;/a&gt;&lt;/p&gt;</content><category term="Linux"></category><category term="æ—¥å¿—"></category><category term="åˆ†å‰²"></category><category term="shell"></category><category term="nginx"></category><category term="log"></category><category term="Linux"></category><category term="cut"></category></entry><entry><title>heartbeatå®ç°MySQLåŒæœºé«˜å¯ç”¨</title><link href="https://www.linuxzen.com/heartbeatshi-xian-mysqlshuang-ji-gao-ke-yong.html" rel="alternate"></link><published>2012-02-12T17:01:00+08:00</published><updated>2012-02-12T17:01:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-02-12:/heartbeatshi-xian-mysqlshuang-ji-gao-ke-yong.html</id><summary type="html">&lt;p&gt;å¯¹äºä¸€ä¸ªç½‘ç«™æˆ–ä¸€ä¸ªä¼ä¸šæœ€é‡è¦çš„æ— ç–‘å°±æ˜¯æ•°æ®,é‚£ä¹ˆæ•°æ®åº“çš„æ•°æ®å®‰å…¨æ— ç–‘å°±æ›´åŠ é‡è¦,æ‰€ä»¥æˆ‘ä»¬å¿…é¡»ä¿è¯æ•°æ®åº“çš„ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;å¯¹äºä¸€ä¸ªç½‘ç«™æˆ–ä¸€ä¸ªä¼ä¸šæœ€é‡è¦çš„æ— ç–‘å°±æ˜¯æ•°æ®,é‚£ä¹ˆæ•°æ®åº“çš„æ•°æ®å®‰å…¨æ— ç–‘å°±æ›´åŠ é‡è¦,æ‰€ä»¥æˆ‘ä»¬å¿…é¡»ä¿è¯æ•°æ®åº“çš„æ•°æ®å®Œæ•´,è¿™é‡Œå°±ä»‹ç»ä½¿ç”¨heartbeatæ¥å®ç°MySQLåŒæœºé«˜å¯ç”¨.&lt;/p&gt;
&lt;p&gt;å½“æˆ‘ä»¬çš„MySQLæ•°æ®åº“æ•…éšœæˆ–MySQLæ•°æ®åº“æœåŠ¡å™¨å‡ºç°æ•…éšœçš„æ—¶å€™æˆ‘ä»¬å¸Œæœ›æœ‰ä¸€ä¸ªå¤‡ç”¨èƒ½è‡ªåŠ¨ä»£æ›¿ä¸»MySQLæ•°æ®æ¥å®Œæˆå½“å‰çš„ä»»åŠ¡,å½“ä¸»MySQLæœåŠ¡å™¨æ¢å¤æ•…éšœçš„æ—¶å€™å¤‡ç”¨çš„èƒ½åˆ‡æ¢åˆ°å¤‡ç”¨ç­‰å¾…ä¸‹ä¸€æ¬¡æ•…éšœå‡ºç°.è¿™é‡Œæˆ‘ä»¬å°±ç»“åˆæ•…éšœæ£€æµ‹HAæ¥å®ç°.&lt;/p&gt;
&lt;p&gt;HAä¼šå®šæ—¶å‘é€å¿ƒè·³åŒ…æ£€æµ‹ä¸»å¤‡æœåŠ¡å™¨çš„å¥åº·çŠ¶æ€,å½“ä¸»æœåŠ¡å™¨å‡ºç°æ•…éšœæ—¶ä¼šè‡ªåŠ¨å°†vipåˆ‡æ¢åˆ°å¤‡ç”¨æœåŠ¡å™¨,ç”±å¤‡ç”¨æœåŠ¡å™¨æ‰§è¡Œä¸»æœåŠ¡å™¨çš„ä»»åŠ¡,MySQLè¦å®ç°è¿™æ ·çš„åŠŸèƒ½å°±å¿…é¡»ä¿è¯ä¸»å¤‡æœåŠ¡å™¨çš„æ•°æ®ä¸€è‡´.è¿™å°±è¦ç”¨åˆ°MySQLä¸»ä»åŒæœº.&lt;/p&gt;
&lt;!--more--&gt;
&lt;p&gt;æœ¬æ–‡ä½¿ç”¨ç¯å¢ƒ:
ç³»ç»Ÿ:CentOS 5.5 32ä½
ä¸»MySQL: ip 192.168.3.101/24 ä¸»æœºå:master.org
å¤‡ç”¨MySQL:192.168.3.102/24Â Â Â ä¸»æœºå:slave.org
vip:192.168.3.103/24
MySQL:mysql-5.0.95.tar.gz
heartbeat:Heartbeat-3-0-7e3a82377fa8.tar.bz2&lt;/p&gt;
&lt;h3 id="mysql"&gt;ä¸€ã€å®‰è£…éƒ¨ç½²MySQL&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;ncurses-devel&lt;span class="w"&gt; &lt;/span&gt;openssl-devel
wget&lt;span class="w"&gt; &lt;/span&gt;http://dev.mysql.com/get/Downloads/MySQL-5.0/mysql-5.0.95.tar.gz/from/http://mysql.cdpa.nsysu.edu.tw/
useradd&lt;span class="w"&gt; &lt;/span&gt;-M&lt;span class="w"&gt; &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;/sbin/nologin&lt;span class="w"&gt; &lt;/span&gt;mysql
tar&lt;span class="w"&gt; &lt;/span&gt;-zxvf&lt;span class="w"&gt; &lt;/span&gt;mysql-5.0.95.tar.gz
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;mysql-5.0.95
./configure&lt;span class="w"&gt; &lt;/span&gt;--prefix&lt;span class="o"&gt;=&lt;/span&gt;/usr/local/mysql&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
--without-debug&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
--with-extra-charsets&lt;span class="o"&gt;=&lt;/span&gt;utf8,gbk&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
--enable-assembler&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
--with-mysqld-ldflags&lt;span class="o"&gt;=&lt;/span&gt;-all-static&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
--with-client-ldflags&lt;span class="o"&gt;=&lt;/span&gt;-all-static&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
--with-unix-socket-path&lt;span class="o"&gt;=&lt;/span&gt;/tmp/mysql.sock&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
--with-ssl
make&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;install
cp&lt;span class="w"&gt; &lt;/span&gt;support-files/my-medium.cnf&lt;span class="w"&gt; &lt;/span&gt;/etc/my.cnf&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="c1"&gt;# åˆ›å»ºé…ç½®æ–‡ä»¶&lt;/span&gt;
cp&lt;span class="w"&gt; &lt;/span&gt;support-files/mysql.server&lt;span class="w"&gt; &lt;/span&gt;/etc/init.d/mysqld&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="c1"&gt;# åˆ›å»ºå¯åŠ¨è„šæœ¬&lt;/span&gt;
chmod&lt;span class="w"&gt; &lt;/span&gt;+x&lt;span class="w"&gt; &lt;/span&gt;/etc/init.d/mysqld
&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/usr/local/mysql/lib/mysql/&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/etc/ld.so.conf
ldconfig
/usr/local/mysql/bin/mysql_install_db&lt;span class="w"&gt; &lt;/span&gt;--user&lt;span class="o"&gt;=&lt;/span&gt;mysql&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# åˆå§‹åŒ–æ•°æ®åº“&lt;/span&gt;
chown&lt;span class="w"&gt; &lt;/span&gt;-R&lt;span class="w"&gt; &lt;/span&gt;root.mysql&lt;span class="w"&gt; &lt;/span&gt;/usr/local/mysql/
chown&lt;span class="w"&gt; &lt;/span&gt;-R&lt;span class="w"&gt; &lt;/span&gt;mysql.mysql&lt;span class="w"&gt; &lt;/span&gt;/usr/local/mysql/var/
ln&lt;span class="w"&gt; &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;/usr/local/mysql/bin/*&lt;span class="w"&gt; &lt;/span&gt;/usr/local/bin/&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# ä¸ºäºŒè¿›åˆ¶æ–‡ä»¶åšä¸€ä¸ªè½¯é“¾æ¥&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é…ç½®MySQlä¸»ä»å®ç°æ•°æ®åŒæ­¥,åœ¨ä¸»ä»æœåŠ¡å™¨ä¸Šä¿®æ”¹my.cnf(è¿™é‡Œæ˜¯æ–°å®‰è£…çš„æ•°æ®åº“,å¦‚æœæ˜¯ä»…ä»…åŠ ä»åº“,éœ€è¦æŠŠä¸»åº“çš„æ•°æ®å¤‡ä»½å¯¼å…¥åˆ°ä»åº“,è¿™é‡Œä¸å†è®²è¿°)&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/etc/my.cnf
&lt;span class="c1"&gt;# [mysqld]é‡Œä¿®æ”¹:&lt;/span&gt;
&lt;span class="nv"&gt;log_bin&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/var/log/mysql/mysql-bin.log&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;# å¯åŠ¨äºŒè¿›åˆ¶æ–‡ä»¶&lt;/span&gt;
server-id&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1921683101&lt;/span&gt;&lt;span class="w"&gt;                      &lt;/span&gt;&lt;span class="c1"&gt;# è®¾ç½®æœåŠ¡å™¨id&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¯åŠ¨ä¸»åº“:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;service&lt;span class="w"&gt; &lt;/span&gt;mysqld&lt;span class="w"&gt; &lt;/span&gt;start
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åœ¨ä¸»åº“ä¸Šåˆ›å»ºä¸€ä¸ªç”¨æˆ·æˆæƒç»™ä»åº“,ç”¨æˆ·ä¸ºbackupå¯†ç ä¸ºbackup:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mysql&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;grant&lt;span class="w"&gt; &lt;/span&gt;replication&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;on&lt;span class="w"&gt; &lt;/span&gt;*.*&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;backup&amp;#39;&lt;/span&gt;@&lt;span class="s1"&gt;&amp;#39;192.168.3.102&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;identified&lt;span class="w"&gt; &lt;/span&gt;by&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;backup&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
Query&lt;span class="w"&gt; &lt;/span&gt;OK,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;rows&lt;span class="w"&gt; &lt;/span&gt;affected&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.16&lt;span class="w"&gt; &lt;/span&gt;sec&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æŸ¥çœ‹ä¸»åº“çŠ¶æ€:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mysql&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;show&lt;span class="w"&gt; &lt;/span&gt;master&lt;span class="w"&gt; &lt;/span&gt;status&lt;span class="p"&gt;;&lt;/span&gt;
+------------------+-----------+--------------+------------------+
Â¦&lt;span class="w"&gt; &lt;/span&gt;File&lt;span class="w"&gt;             &lt;/span&gt;Â¦&lt;span class="w"&gt; &lt;/span&gt;Position&lt;span class="w"&gt;  &lt;/span&gt;Â¦&lt;span class="w"&gt; &lt;/span&gt;Binlog_Do_DB&lt;span class="w"&gt; &lt;/span&gt;Â¦&lt;span class="w"&gt; &lt;/span&gt;Binlog_Ignore_DB&lt;span class="w"&gt; &lt;/span&gt;Â¦
+------------------+-----------+--------------+------------------+
Â¦&lt;span class="w"&gt; &lt;/span&gt;mysql-bin.000003&lt;span class="w"&gt; &lt;/span&gt;Â¦&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;236&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Â¦&lt;span class="w"&gt;              &lt;/span&gt;Â¦&lt;span class="w"&gt;                  &lt;/span&gt;Â¦
+------------------+-----------+--------------+------------------+
&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;row&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.00&lt;span class="w"&gt; &lt;/span&gt;sec&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¿®æ”¹ä»åº“é…ç½®æ–‡ä»¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;server-id&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1921683102&lt;/span&gt;&lt;span class="w"&gt;                 &lt;/span&gt;&lt;span class="c1"&gt;# server idå¿…é¡»ä¿æŒå”¯ä¸€&lt;/span&gt;
&lt;span class="nv"&gt;log_bin&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/var/log/mysql/mysql-bin.log&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—&lt;/span&gt;
master-host&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.101&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="c1"&gt;# ä¸»åº“ip&lt;/span&gt;
master-user&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;backup&lt;span class="w"&gt;                  &lt;/span&gt;&lt;span class="c1"&gt;# è´¦å·&lt;/span&gt;
master-pass&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;backup&lt;span class="w"&gt;                 &lt;/span&gt;&lt;span class="c1"&gt;# å¯†ç &lt;/span&gt;
master-port&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3306&lt;/span&gt;&lt;span class="w"&gt;                      &lt;/span&gt;&lt;span class="c1"&gt;# è¿æ¥ä¸»åº“çš„ç«¯å£&lt;/span&gt;
master-connect-retry&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;60&lt;/span&gt;&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="c1"&gt;# è¿æ¥å¤±è´¥åè¿›è¡Œé‡è¯•ç­‰å¾…çš„æè¿°&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¯åŠ¨ä»åº“,å¹¶æŸ¥çœ‹çŠ¶æ€:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;service&lt;span class="w"&gt; &lt;/span&gt;mysqld&lt;span class="w"&gt; &lt;/span&gt;start
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åœ¨ä»åº“ä¸Šæ‰§è¡Œä¸‹æ“ä½œ,æŒ‡å®šä¸»åº“çš„äºŒè¿›åˆ¶æ–‡ä»¶åå’Œåç§»é‡(åˆšæ‰åœ¨ä¸»åº“show master status;æŸ¥çœ‹çš„å‚æ•°):&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mysql&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;show&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;status&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\G&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
***************************&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.&lt;span class="w"&gt; &lt;/span&gt;row&lt;span class="w"&gt; &lt;/span&gt;***************************
&lt;span class="w"&gt;             &lt;/span&gt;Slave_IO_State:&lt;span class="w"&gt; &lt;/span&gt;Waiting&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;master&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;send&lt;span class="w"&gt; &lt;/span&gt;event
&lt;span class="w"&gt;                &lt;/span&gt;Master_Host:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.101
&lt;span class="w"&gt;                &lt;/span&gt;Master_User:&lt;span class="w"&gt; &lt;/span&gt;backup
&lt;span class="w"&gt;                &lt;/span&gt;Master_Port:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3306&lt;/span&gt;
&lt;span class="w"&gt;              &lt;/span&gt;Connect_Retry:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;60&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;Master_Log_File:&lt;span class="w"&gt; &lt;/span&gt;mysql-bin.000003
&lt;span class="w"&gt;        &lt;/span&gt;Read_Master_Log_Pos:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;236&lt;/span&gt;
&lt;span class="w"&gt;             &lt;/span&gt;Relay_Log_File:&lt;span class="w"&gt; &lt;/span&gt;cfhost-relay-bin.000002
&lt;span class="w"&gt;              &lt;/span&gt;Relay_Log_Pos:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;235&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;Relay_Master_Log_File:&lt;span class="w"&gt; &lt;/span&gt;mysql-bin.000003
&lt;span class="w"&gt;           &lt;/span&gt;Slave_IO_Running:&lt;span class="w"&gt; &lt;/span&gt;Yes
&lt;span class="w"&gt;          &lt;/span&gt;Slave_SQL_Running:&lt;span class="w"&gt; &lt;/span&gt;Yes
&lt;span class="w"&gt;            &lt;/span&gt;Replicate_Do_DB:
&lt;span class="w"&gt;        &lt;/span&gt;Replicate_Ignore_DB:
&lt;span class="w"&gt;         &lt;/span&gt;Replicate_Do_Table:
&lt;span class="w"&gt;     &lt;/span&gt;Replicate_Ignore_Table:
&lt;span class="w"&gt;    &lt;/span&gt;Replicate_Wild_Do_Table:
Replicate_Wild_Ignore_Table:
&lt;span class="w"&gt;                 &lt;/span&gt;Last_Errno:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="w"&gt;                 &lt;/span&gt;Last_Error:
&lt;span class="w"&gt;               &lt;/span&gt;Skip_Counter:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;Exec_Master_Log_Pos:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;236&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;Relay_Log_Space:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;235&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;Until_Condition:&lt;span class="w"&gt; &lt;/span&gt;None
&lt;span class="w"&gt;             &lt;/span&gt;Until_Log_File:
&lt;span class="w"&gt;              &lt;/span&gt;Until_Log_Pos:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="w"&gt;         &lt;/span&gt;Master_SSL_Allowed:&lt;span class="w"&gt; &lt;/span&gt;No
&lt;span class="w"&gt;         &lt;/span&gt;Master_SSL_CA_File:
&lt;span class="w"&gt;         &lt;/span&gt;Master_SSL_CA_Path:
&lt;span class="w"&gt;            &lt;/span&gt;Master_SSL_Cert:
&lt;span class="w"&gt;          &lt;/span&gt;Master_SSL_Cipher:
&lt;span class="w"&gt;             &lt;/span&gt;Master_SSL_Key:
&lt;span class="w"&gt;      &lt;/span&gt;Seconds_Behind_Master:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;row&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.00&lt;span class="w"&gt; &lt;/span&gt;sec&lt;span class="o"&gt;)&lt;/span&gt;

ERROR:
No&lt;span class="w"&gt; &lt;/span&gt;query&lt;span class="w"&gt; &lt;/span&gt;specified
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¦‚æœshow slave status \G;&lt;span style="color: #ff0000;"&gt;Slave_SQL_Running: No&lt;/span&gt;&lt;span style="color: #000000;"&gt;,åˆ™æ‰§åœ¨ä»åº“ä¸Šæ‰§è¡Œä¸‹é¢å‘½ä»¤(ä¸¤ä¸ªå‚æ•°å€¼é€šè¿‡åœ¨ä¸»åº“æ‰§è¡Œshow master status; å‘½ä»¤æŸ¥çœ‹è·å¾—):
&lt;/span&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mysql&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;stop&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="p"&gt;;&lt;/span&gt;
Query&lt;span class="w"&gt; &lt;/span&gt;OK,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;rows&lt;span class="w"&gt; &lt;/span&gt;affected&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.00&lt;span class="w"&gt; &lt;/span&gt;sec&lt;span class="o"&gt;)&lt;/span&gt;

mysql&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;change&lt;span class="w"&gt; &lt;/span&gt;master&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;master_log_file&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;mysql-bin.000003&amp;#39;&lt;/span&gt;,master_log_pos&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;236&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
Query&lt;span class="w"&gt; &lt;/span&gt;OK,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;rows&lt;span class="w"&gt; &lt;/span&gt;affected&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.01&lt;span class="w"&gt; &lt;/span&gt;sec&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;åœ¨ä¸»åº“ä¸Šåˆ›å»ºä¸€ä¸ªæ•°æ®åº“çœ‹çœ‹æ˜¯å¦åŒæ­¥.&lt;/p&gt;
&lt;h3 id="heartbeat"&gt;äºŒã€å®‰è£…éƒ¨ç½²heartbeatå®ç°åŒæœºçƒ­å¤‡ä»½&lt;/h3&gt;
&lt;h3 id="_1"&gt;å®‰è£…ä¾èµ–&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum&lt;span class="w"&gt;  &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;pkgconfig&lt;span class="w"&gt; &lt;/span&gt;glib2-devel&lt;span class="w"&gt; &lt;/span&gt;python-devel&lt;span class="w"&gt; &lt;/span&gt;pam-devel&lt;span class="w"&gt; &lt;/span&gt;gnutls-devel&lt;span class="w"&gt; &lt;/span&gt;swig
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…libnet&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;wget&lt;span class="w"&gt; &lt;/span&gt;http://download.fedora.redhat.com/pub/epel/5/i386/libnet-1.1.5-1.el5.i386.rpm
rpm&lt;span class="w"&gt; &lt;/span&gt;-ivh&lt;span class="w"&gt; &lt;/span&gt;libnet-1.1.5-1.el5.i386.rpm
wget&lt;span class="w"&gt; &lt;/span&gt;http://download.fedora.redhat.com/pub/epel/5/i386/libnet-devel-1.1.5-1.el5.i386.rpm
rpm&lt;span class="w"&gt; &lt;/span&gt;-ivh&lt;span class="w"&gt; &lt;/span&gt;libnet-devel-1.1.5-1.el5.i386.rpm
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="_2"&gt;å®‰è£…:&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;useradd&lt;span class="w"&gt; &lt;/span&gt;-M&lt;span class="w"&gt; &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;/sbin/nologin&lt;span class="w"&gt; &lt;/span&gt;hacluster
useradd&lt;span class="w"&gt; &lt;/span&gt;-M&lt;span class="w"&gt; &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;/sbin/nologin&lt;span class="w"&gt; &lt;/span&gt;haclient
wget&lt;span class="w"&gt; &lt;/span&gt;http://www.ultramonkey.org/download/heartbeat/2.0.8/heartbeat-2.0.8.tar.gz
tar&lt;span class="w"&gt; &lt;/span&gt;-zxvf&lt;span class="w"&gt; &lt;/span&gt;heartbeat-2.0.8.tar.gz
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;heartbeat-2.0.8
./configure&lt;span class="w"&gt; &lt;/span&gt;--sysconfdir&lt;span class="o"&gt;=&lt;/span&gt;/etc
make&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åˆ›å»ºé…ç½®æ–‡ä»¶:
å®‰è£…åè¦é…ç½®ä¸‰ä¸ªæ–‡ä»¶ï¼ˆå¦‚æ²¡æœ‰å¯æ‰‹åŠ¨å»ºç«‹ï¼‰ï¼šha.cfã€haresourcesã€authkeysã€‚è¿™ä¸‰ä¸ªé…ç½®æ–‡ä»¶éœ€è¦åœ¨/etc/ha.dç›®å½•ä¸‹é¢ï¼Œä½†æ˜¯é»˜è®¤æ˜¯æ²¡æœ‰è¿™ä¸‰ä¸ªæ–‡ä»¶çš„ï¼Œå¯ä»¥åˆ°å®˜ç½‘ä¸Šä¸‹è¿™ä¸‰ä¸ªæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥åœ¨æºç åŒ…é‡Œæ‰¾è¿™ä¸‰ä¸ªæ–‡ä»¶ï¼Œåœ¨æºç ç›®å½•ä¸‹çš„DOCå­ç›®å½•é‡Œã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;cat&lt;span class="w"&gt; &lt;/span&gt;/usr/local/share/doc/heartbeat-2.0.8/ha.cf&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;egrep&lt;span class="w"&gt; &lt;/span&gt;-v&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^#\W&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;-v&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^#$&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/etc/ha.d/ha.cf
cat&lt;span class="w"&gt; &lt;/span&gt;/usr/local/share/doc/heartbeat-2.0.8/haresources&lt;span class="w"&gt;Â  &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;egrep&lt;span class="w"&gt; &lt;/span&gt;-v&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^#\W&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;-v&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^#$&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/etc/ha.d/haresources
cat&lt;span class="w"&gt; &lt;/span&gt;/usr/local/share/doc/heartbeat-2.0.8/authkeys&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;egrep&lt;span class="w"&gt; &lt;/span&gt;-v&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^#\W&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;^#$&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-v&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/etc/ha.d/authkeys
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç¼–è¾‘é…ç½®æ–‡ä»¶:&lt;/p&gt;
&lt;p&gt;ç¼–è¾‘ha.cf,è¯¥æ–‡ä»¶ä¸­åŒ…æ‹¬ä¸ºHeartbeatä½¿ç”¨ä½•ç§ä»‹è´¨é€šè·¯å’Œå¦‚ä½•é…ç½®ä»–ä»¬çš„ä¿¡æ¯.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="w"&gt; &lt;/span&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/etc/ha.d/ha.cf&lt;span class="w"&gt; &lt;/span&gt;

debugfile&lt;span class="w"&gt; &lt;/span&gt;/var/log/ha-debug&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# ç”¨äºè®°å½•heartbeatçš„è°ƒè¯•ä¿¡æ¯&lt;/span&gt;
logfile&lt;span class="w"&gt; &lt;/span&gt;/var/log/ha-log&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="c1"&gt;# ç”¨äºè®°å½•heartbeatçš„æ—¥å¿—ä¿¡æ¯&lt;/span&gt;
logfacility&lt;span class="w"&gt;     &lt;/span&gt;local0
keepalive&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="c1"&gt;# è®¾ç½®å¿ƒè·³é—´éš”&lt;/span&gt;
watchdog&lt;span class="w"&gt; &lt;/span&gt;/dev/watchdog
deadtime&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt;&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="c1"&gt;#  åœ¨30ç§’åå®£å¸ƒèŠ‚ç‚¹æ­»äº¡&lt;/span&gt;
warntime&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="c1"&gt;# åœ¨æ—¥å¿—ä¸­å‘å‡ºâ€œlate heartbeatâ€œè­¦å‘Šä¹‹å‰ç­‰å¾…çš„æ—¶é—´ï¼Œå•ä½ä¸ºç§’&lt;/span&gt;
initdead&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;120&lt;/span&gt;&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="c1"&gt;# ç½‘ç»œå¯åŠ¨æ—¶é—´&lt;/span&gt;
udpport&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="m"&gt;694&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="c1"&gt;# å¹¿æ’­/å•æ’­é€šè®¯ä½¿ç”¨çš„udpç«¯å£&lt;/span&gt;
&lt;span class="c1"&gt;#baud   19200&lt;/span&gt;
&lt;span class="c1"&gt;#serial  /dev/ttyS0      # ä½¿ç”¨ä¸²å£heartbeat&lt;/span&gt;
bcast&lt;span class="w"&gt;   &lt;/span&gt;eth0&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="c1"&gt;# ä½¿ç”¨ç½‘å¡heartbeat,å¹¶åœ¨eth0æ¥å£ä¸Šä½¿ç”¨å¹¿æ’­heartbeat&lt;/span&gt;
auto_failback&lt;span class="w"&gt; &lt;/span&gt;on&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="c1"&gt;# å½“ä¸»èŠ‚ç‚¹ä»æ•…éšœä¸­æ¢å¤æ—¶,å°†è‡ªåŠ¨åˆ‡æ¢åˆ°ä¸»èŠ‚ç‚¹&lt;/span&gt;
watchdog&lt;span class="w"&gt; &lt;/span&gt;/dev/watchdog&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# è¯¥æŒ‡ä»¤æ˜¯ç”¨äºè®¾ç½®çœ‹é—¨ç‹—å®šæ—¶å™¨ï¼Œå¦‚æœèŠ‚ç‚¹ä¸€åˆ†é’Ÿå†…éƒ½æ²¡æœ‰å¿ƒè·³ï¼Œé‚£ä¹ˆèŠ‚ç‚¹å°†é‡æ–°å¯åŠ¨&lt;/span&gt;
node&lt;span class="w"&gt; &lt;/span&gt;master.org&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="c1"&gt;# é›†ç¾¤ä¸­æœºå™¨çš„ä¸»æœºåï¼Œä¸â€œuname â€“nâ€çš„è¾“å‡ºç›¸åŒã€‚&lt;/span&gt;
node&lt;span class="w"&gt; &lt;/span&gt;slave.org
ping&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.254&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="c1"&gt;# pingç½‘å…³æ¥æ£€æµ‹é“¾è·¯æ­£å¸¸&lt;/span&gt;
respawn&lt;span class="w"&gt; &lt;/span&gt;hacluster&lt;span class="w"&gt; &lt;/span&gt;/usr/local/lib/heartbeat/ipfail&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# respawnè°ƒç”¨/usr/lib/heartbeat/ipfailæ¥ä¸»åŠ¨è¿›è¡Œåˆ‡æ¢&lt;/span&gt;
apiauth&lt;span class="w"&gt; &lt;/span&gt;ipfail&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;gid&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;haclient&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;uid&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;hacluster&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# è®¾ç½®å¯åŠ¨ipfailçš„ç”¨æˆ·å’Œç»„&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é…ç½®haresources ,è¯¥æ–‡ä»¶åˆ—å‡ºæ‰€æœ‰èŠ‚ç‚¹æ‰€æä¾›çš„æœåŠ¡ä»¥åŠæœåŠ¡çš„é»˜è®¤æ‰€æœ‰è€….æ‰€æœ‰èŠ‚ç‚¹ä¸Šçš„è¯¥æ–‡ä»¶å¿…é¡»ç›¸åŒ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/etc/ha.d/haresources

master.org&lt;span class="w"&gt;    &lt;/span&gt;IPaddr::192.168.3.103&lt;span class="w"&gt; &lt;/span&gt;mysql&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# vip&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;æ³¨æ„:!!&lt;/code&gt;haresourcesæœ€åä¸€ä¸ªå­—æ®µæ˜¯æŸä¸ªæœåŠ¡çš„å¿ƒè·³,å¦‚æœmysql,å¦‚æœä¸»ä»åº“ä½¿ç”¨çš„æ˜¯åŒä¸€å°ç›˜é˜µæˆ–è€…ä¸€ä¸ªåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ,è¿™é‡Œä¸€å®šè¦å¡«å†™çœŸå®çš„å¯åŠ¨è„šæœ¬(/etc/init.dä¸‹),å¦‚æœæ˜¯ä¸»ä»åŒæ­¥çš„è¯è¯·åŠ¡å¿…ä¸å¡«å†™çœŸæ­£çš„å¯åŠ¨è„šæœ¬,å› ä¸ºä¸»åº“å¿ƒè·³å­˜æ´»çš„è¯heartbeatä¼šè‡ªåŠ¨åœæ­¢ä»åº“çš„mysql,è¿™æ ·å°±æ— æ³•åŒæ­¥,ä¸»åº“å‘ç”Ÿæ•…éšœæ—¶è½¬ç§»æ•…éšœå°±æ²¡æœ‰æ„ä¹‰.&lt;/p&gt;
&lt;p&gt;é…ç½®authkeys,Â authkeyså†³å®šäº†æ‚¨çš„è®¤è¯å¯†é’¥ã€‚å…±æœ‰ä¸‰ç§è®¤è¯æ–¹å¼ï¼šcrcï¼Œmd5ï¼Œå’Œsha1æœæ‚¨çš„Heartbeatè¿è¡Œäº å®‰å…¨ ç½‘ç»œä¹‹ä¸Šï¼Œå¦‚æœ¬ä¾‹ä¸­çš„äº¤å‰çº¿ï¼Œå¯ä»¥ä½¿ç”¨crcï¼Œä»èµ„æºçš„è§’åº¦æ¥çœ‹ï¼Œè¿™æ˜¯ä»£ä»·æœ€ä½çš„æ–¹æ³•ã€‚å¦‚æœç½‘ç»œå¹¶ä¸ å®‰å…¨ ï¼Œä½†æ‚¨ä¹Ÿå¸Œæœ›é™ä½CPUä½¿ç”¨ï¼Œåˆ™ä½¿ç”¨md5ã€‚æœ€åï¼Œå¦‚æœæ‚¨æƒ³å¾—åˆ°æœ€å¥½çš„è®¤è¯ï¼Œè€Œä¸è€ƒè™‘CPUä½¿ç”¨æƒ…å†µï¼Œåˆ™ä½¿ç”¨sha1ï¼Œå®ƒåœ¨ä¸‰è€…ä¹‹ä¸­æœ€éš¾ç ´è§£ã€‚&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/etc/ha.d/authkeys

auth&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;crc
chmod&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;600&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/etc/ha.d/authkeys
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸è®ºæ‚¨åœ¨å…³é”®å­—authåé¢æŒ‡å®šçš„æ˜¯ä»€ä¹ˆç´¢å¼•å€¼ï¼Œåœ¨åé¢å¿…é¡»è¦ä½œä¸ºé”®å€¼å†æ¬¡å‡ºç°ã€‚å¦‚æœæ‚¨æŒ‡å®šâ€œauth 4â€ï¼Œåˆ™åœ¨åé¢ä¸€å®šè¦æœ‰ä¸€è¡Œçš„å†…å®¹ä¸ºâ€œ4 â€ã€‚
é…ç½®ä»åº“:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;scp&lt;span class="w"&gt; &lt;/span&gt;root@192.168.3.101:/etc/ha.d/ha.cf&lt;span class="w"&gt; &lt;/span&gt;/etc/ha.d/
scp&lt;span class="w"&gt; &lt;/span&gt;root@192.168.3.101:/etc/ha.d/authkeys&lt;span class="w"&gt; &lt;/span&gt;/etc/ha.d/
scp&lt;span class="w"&gt; &lt;/span&gt;root@192.168.3.101:/etc/ha.d/haresources&lt;span class="w"&gt; &lt;/span&gt;/etc/ha.d/
vi&lt;span class="w"&gt; &lt;/span&gt;/etc/ha.d/ha.cf
debugfile&lt;span class="w"&gt; &lt;/span&gt;/var/log/ha-debug
logfile&lt;span class="w"&gt; &lt;/span&gt;/var/log/ha-log
logfacility&lt;span class="w"&gt;Â Â Â Â  &lt;/span&gt;local0
keepalive&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;
deadtime&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt;
warntime&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;
initdead&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;120&lt;/span&gt;
udpport&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;694&lt;/span&gt;
bcast&lt;span class="w"&gt;Â Â  &lt;/span&gt;eth0&lt;span class="w"&gt;Â Â Â Â Â Â Â Â Â Â &lt;/span&gt;
auto_failback&lt;span class="w"&gt; &lt;/span&gt;on
node&lt;span class="w"&gt;Â Â Â  &lt;/span&gt;master.org
node&lt;span class="w"&gt;Â Â Â  &lt;/span&gt;slave.org
ping&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.254
respawn&lt;span class="w"&gt; &lt;/span&gt;hacluser&lt;span class="w"&gt; &lt;/span&gt;/usr/local/lib/heartbeat/ipfail&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# respawnè°ƒç”¨/usr/lib/heartbeat/ipfailæ¥ä¸»åŠ¨è¿›è¡Œåˆ‡æ¢&lt;/span&gt;
apiauth&lt;span class="w"&gt; &lt;/span&gt;ipfail&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;gid&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;haclient&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;uid&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;hacluster
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¯åŠ¨ä¸»åº“heartbeat:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;server&lt;span class="w"&gt; &lt;/span&gt;heartbeat&lt;span class="w"&gt; &lt;/span&gt;start
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æŸ¥çœ‹æ—¥å¿—:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;cat&lt;span class="w"&gt; &lt;/span&gt;/var/log/ha-log

heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32239&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:29&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Link&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.254:192.168.3.254&lt;span class="w"&gt; &lt;/span&gt;up.
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32239&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:29&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Status&lt;span class="w"&gt; &lt;/span&gt;update&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;node&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.254:&lt;span class="w"&gt; &lt;/span&gt;status&lt;span class="w"&gt; &lt;/span&gt;ping
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32239&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:29&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Link&lt;span class="w"&gt; &lt;/span&gt;master.org:eth0&lt;span class="w"&gt; &lt;/span&gt;up.
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32239&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:41&lt;span class="w"&gt; &lt;/span&gt;WARN:&lt;span class="w"&gt; &lt;/span&gt;node&lt;span class="w"&gt; &lt;/span&gt;slave.org:&lt;span class="w"&gt; &lt;/span&gt;is&lt;span class="w"&gt; &lt;/span&gt;dead
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32239&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:41&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Comm_now_up&lt;span class="o"&gt;()&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;updating&lt;span class="w"&gt; &lt;/span&gt;status&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;active
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32239&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:41&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Local&lt;span class="w"&gt; &lt;/span&gt;status&lt;span class="w"&gt; &lt;/span&gt;now&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;to:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;active&amp;#39;&lt;/span&gt;
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32239&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:41&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Starting&lt;span class="w"&gt; &lt;/span&gt;child&lt;span class="w"&gt; &lt;/span&gt;client&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/usr/local/lib/heartbeat/ipfail&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;503&lt;/span&gt;,503&lt;span class="o"&gt;)&lt;/span&gt;
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32239&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:41&lt;span class="w"&gt; &lt;/span&gt;WARN:&lt;span class="w"&gt; &lt;/span&gt;No&lt;span class="w"&gt; &lt;/span&gt;STONITH&lt;span class="w"&gt; &lt;/span&gt;device&lt;span class="w"&gt; &lt;/span&gt;configured.
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32239&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:41&lt;span class="w"&gt; &lt;/span&gt;WARN:&lt;span class="w"&gt; &lt;/span&gt;Shared&lt;span class="w"&gt; &lt;/span&gt;disks&lt;span class="w"&gt; &lt;/span&gt;are&lt;span class="w"&gt; &lt;/span&gt;not&lt;span class="w"&gt; &lt;/span&gt;protected.
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32239&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:41&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Resources&lt;span class="w"&gt; &lt;/span&gt;being&lt;span class="w"&gt; &lt;/span&gt;acquired&lt;span class="w"&gt; &lt;/span&gt;from&lt;span class="w"&gt; &lt;/span&gt;slave.org.
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32247&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:41&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Starting&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/usr/local/lib/heartbeat/ipfail&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;as&lt;span class="w"&gt; &lt;/span&gt;uid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;503&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;gid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;503&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;32247&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
harc&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32248&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:42&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Running&lt;span class="w"&gt; &lt;/span&gt;/etc/ha.d/rc.d/status&lt;span class="w"&gt; &lt;/span&gt;status
mach_down&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32275&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:42&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;/usr/local/lib/heartbeat/mach_down:&lt;span class="w"&gt; &lt;/span&gt;nice_failback:&lt;span class="w"&gt; &lt;/span&gt;foreign&lt;span class="w"&gt; &lt;/span&gt;resources&lt;span class="w"&gt; &lt;/span&gt;acquired
mach_down&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32275&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:42&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;mach_down&lt;span class="w"&gt; &lt;/span&gt;takeover&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;complete&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;node&lt;span class="w"&gt; &lt;/span&gt;slave.org.
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32239&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:42&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;mach_down&lt;span class="w"&gt; &lt;/span&gt;takeover&lt;span class="w"&gt; &lt;/span&gt;complete.
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32239&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:42&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Initial&lt;span class="w"&gt; &lt;/span&gt;resource&lt;span class="w"&gt; &lt;/span&gt;acquisition&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;complete&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;mach_down&lt;span class="o"&gt;)&lt;/span&gt;
IPaddr&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32300&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:42&lt;span class="w"&gt; &lt;/span&gt;INFO:&lt;span class="w"&gt;  &lt;/span&gt;Resource&lt;span class="w"&gt; &lt;/span&gt;is&lt;span class="w"&gt; &lt;/span&gt;stopped
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32249&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:42&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Local&lt;span class="w"&gt; &lt;/span&gt;Resource&lt;span class="w"&gt; &lt;/span&gt;acquisition&lt;span class="w"&gt; &lt;/span&gt;completed.
harc&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32338&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:42&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Running&lt;span class="w"&gt; &lt;/span&gt;/etc/ha.d/rc.d/ip-request-resp&lt;span class="w"&gt; &lt;/span&gt;ip-request-resp
ip-request-resp&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32338&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:42&lt;span class="w"&gt; &lt;/span&gt;received&lt;span class="w"&gt; &lt;/span&gt;ip-request-resp&lt;span class="w"&gt; &lt;/span&gt;IPaddr::192.168.3.103&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;yes
ResourceManager&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32353&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:42&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Acquiring&lt;span class="w"&gt; &lt;/span&gt;resource&lt;span class="w"&gt; &lt;/span&gt;group:&lt;span class="w"&gt; &lt;/span&gt;master.org&lt;span class="w"&gt; &lt;/span&gt;IPaddr::192.168.3.103&lt;span class="w"&gt; &lt;/span&gt;mysqld
IPaddr&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32377&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:42&lt;span class="w"&gt; &lt;/span&gt;INFO:&lt;span class="w"&gt;  &lt;/span&gt;Resource&lt;span class="w"&gt; &lt;/span&gt;is&lt;span class="w"&gt; &lt;/span&gt;stopped
ResourceManager&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32353&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:42&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Running&lt;span class="w"&gt; &lt;/span&gt;/etc/ha.d/resource.d/IPaddr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.103&lt;span class="w"&gt; &lt;/span&gt;start
IPaddr&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32429&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:42&lt;span class="w"&gt; &lt;/span&gt;INFO:&lt;span class="w"&gt; &lt;/span&gt;Using&lt;span class="w"&gt; &lt;/span&gt;calculated&lt;span class="w"&gt; &lt;/span&gt;nic&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.103:&lt;span class="w"&gt; &lt;/span&gt;eth0
IPaddr&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32429&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:42&lt;span class="w"&gt; &lt;/span&gt;DEBUG:&lt;span class="w"&gt; &lt;/span&gt;Using&lt;span class="w"&gt; &lt;/span&gt;calculated&lt;span class="w"&gt; &lt;/span&gt;netmask&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.103:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;255&lt;/span&gt;.255.255.0
IPaddr&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32429&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:42&lt;span class="w"&gt; &lt;/span&gt;DEBUG:&lt;span class="w"&gt; &lt;/span&gt;Using&lt;span class="w"&gt; &lt;/span&gt;calculated&lt;span class="w"&gt; &lt;/span&gt;broadcast&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.103:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.255
IPaddr&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32429&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:42&lt;span class="w"&gt; &lt;/span&gt;INFO:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;eval&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/sbin/ifconfig&lt;span class="w"&gt; &lt;/span&gt;eth0:0&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.103&lt;span class="w"&gt; &lt;/span&gt;netmask&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;255&lt;/span&gt;.255.255.0&lt;span class="w"&gt; &lt;/span&gt;broadcast&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.255
IPaddr&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32429&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:43&lt;span class="w"&gt; &lt;/span&gt;DEBUG:&lt;span class="w"&gt; &lt;/span&gt;Sending&lt;span class="w"&gt; &lt;/span&gt;Gratuitous&lt;span class="w"&gt; &lt;/span&gt;Arp&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.103&lt;span class="w"&gt; &lt;/span&gt;on&lt;span class="w"&gt; &lt;/span&gt;eth0:0&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;eth0&lt;span class="o"&gt;]&lt;/span&gt;
IPaddr&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32420&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:43&lt;span class="w"&gt; &lt;/span&gt;INFO:&lt;span class="w"&gt;  &lt;/span&gt;Success
ResourceManager&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32353&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:43&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Running&lt;span class="w"&gt; &lt;/span&gt;/etc/init.d/mysqld&lt;span class="w"&gt;  &lt;/span&gt;start
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32239&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:56&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Local&lt;span class="w"&gt; &lt;/span&gt;Resource&lt;span class="w"&gt; &lt;/span&gt;acquisition&lt;span class="w"&gt; &lt;/span&gt;completed.&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;none&lt;span class="o"&gt;)&lt;/span&gt;
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;32239&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_13:45:56&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;local&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;resource&lt;span class="w"&gt; &lt;/span&gt;transition&lt;span class="w"&gt; &lt;/span&gt;completed.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;ä»æ—¥å¿—ä¸­çœ‹å‡ºæ¥slave.orgæ²¡èµ·æ¥æ˜¯æ­»äº¡çš„,å¹¶æ·»åŠ 192.168.3.103vip&lt;/p&gt;
&lt;p&gt;å¯åŠ¨ä»åº“heartbeat&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;server&lt;span class="w"&gt; &lt;/span&gt;heartbeat&lt;span class="w"&gt; &lt;/span&gt;start
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¯åŠ¨ä¹‹åæŸ¥çœ‹æ—¥å¿—ä¿¡æ¯&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:22&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Local&lt;span class="w"&gt; &lt;/span&gt;status&lt;span class="w"&gt; &lt;/span&gt;now&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;to:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;up&amp;#39;&lt;/span&gt;
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:23&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Link&lt;span class="w"&gt; &lt;/span&gt;master.org:eth0&lt;span class="w"&gt; &lt;/span&gt;up.
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:23&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Status&lt;span class="w"&gt; &lt;/span&gt;update&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;node&lt;span class="w"&gt; &lt;/span&gt;master.org:&lt;span class="w"&gt; &lt;/span&gt;status&lt;span class="w"&gt; &lt;/span&gt;active
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:23&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Link&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.254:192.168.3.254&lt;span class="w"&gt; &lt;/span&gt;up.
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:23&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Status&lt;span class="w"&gt; &lt;/span&gt;update&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;node&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.254:&lt;span class="w"&gt; &lt;/span&gt;status&lt;span class="w"&gt; &lt;/span&gt;ping
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:23&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Link&lt;span class="w"&gt; &lt;/span&gt;slave.org:eth0&lt;span class="w"&gt; &lt;/span&gt;up.
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:23&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;harc&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29171&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Running&lt;span class="w"&gt; &lt;/span&gt;/etc/ha.d/rc.d/status&lt;span class="w"&gt; &lt;/span&gt;status
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:24&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Comm_now_up&lt;span class="o"&gt;()&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;updating&lt;span class="w"&gt; &lt;/span&gt;status&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;active
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:24&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Local&lt;span class="w"&gt; &lt;/span&gt;status&lt;span class="w"&gt; &lt;/span&gt;now&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;to:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;active&amp;#39;&lt;/span&gt;
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:24&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Starting&lt;span class="w"&gt; &lt;/span&gt;child&lt;span class="w"&gt; &lt;/span&gt;client&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/usr/local/lib/heartbeat/ipfail&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;501&lt;/span&gt;,501&lt;span class="o"&gt;)&lt;/span&gt;
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:24&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;WARN:&lt;span class="w"&gt; &lt;/span&gt;G_CH_dispatch_int:&lt;span class="w"&gt; &lt;/span&gt;Dispatch&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;function&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;read&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;child&lt;span class="w"&gt; &lt;/span&gt;took&lt;span class="w"&gt; &lt;/span&gt;too&lt;span class="w"&gt; &lt;/span&gt;long&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;execute:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;140&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;ms&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;50&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;ms&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;GSource:&lt;span class="w"&gt; &lt;/span&gt;0x9b98448&lt;span class="o"&gt;)&lt;/span&gt;
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:24&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29182&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Starting&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/usr/local/lib/heartbeat/ipfail&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;as&lt;span class="w"&gt; &lt;/span&gt;uid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;501&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;gid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;501&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;pid&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;29182&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:24&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;remote&lt;span class="w"&gt; &lt;/span&gt;resource&lt;span class="w"&gt; &lt;/span&gt;transition&lt;span class="w"&gt; &lt;/span&gt;completed.
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:24&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;remote&lt;span class="w"&gt; &lt;/span&gt;resource&lt;span class="w"&gt; &lt;/span&gt;transition&lt;span class="w"&gt; &lt;/span&gt;completed.
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:24&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Local&lt;span class="w"&gt; &lt;/span&gt;Resource&lt;span class="w"&gt; &lt;/span&gt;acquisition&lt;span class="w"&gt; &lt;/span&gt;completed.&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;none&lt;span class="o"&gt;)&lt;/span&gt;
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:25&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;master.org&lt;span class="w"&gt; &lt;/span&gt;wants&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;go&lt;span class="w"&gt; &lt;/span&gt;standby&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;foreign&lt;span class="o"&gt;]&lt;/span&gt;
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:26&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;standby:&lt;span class="w"&gt; &lt;/span&gt;acquire&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;foreign&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;resources&lt;span class="w"&gt; &lt;/span&gt;from&lt;span class="w"&gt; &lt;/span&gt;master.org
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:26&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29183&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;acquire&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;local&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;HA&lt;span class="w"&gt; &lt;/span&gt;resources&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;standby&lt;span class="o"&gt;)&lt;/span&gt;.
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:26&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29183&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;local&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;HA&lt;span class="w"&gt; &lt;/span&gt;resource&lt;span class="w"&gt; &lt;/span&gt;acquisition&lt;span class="w"&gt; &lt;/span&gt;completed&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;standby&lt;span class="o"&gt;)&lt;/span&gt;.
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:26&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Standby&lt;span class="w"&gt; &lt;/span&gt;resource&lt;span class="w"&gt; &lt;/span&gt;acquisition&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;foreign&lt;span class="o"&gt;]&lt;/span&gt;.
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:26&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Initial&lt;span class="w"&gt; &lt;/span&gt;resource&lt;span class="w"&gt; &lt;/span&gt;acquisition&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;complete&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;auto_failback&lt;span class="o"&gt;)&lt;/span&gt;
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:27&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;remote&lt;span class="w"&gt; &lt;/span&gt;resource&lt;span class="w"&gt; &lt;/span&gt;transition&lt;span class="w"&gt; &lt;/span&gt;completed.
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:36&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;ipfail:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29182&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Ping&lt;span class="w"&gt; &lt;/span&gt;node&lt;span class="w"&gt; &lt;/span&gt;count&lt;span class="w"&gt; &lt;/span&gt;is&lt;span class="w"&gt; &lt;/span&gt;balanced.
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:37&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;ipfail:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29182&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Giving&lt;span class="w"&gt; &lt;/span&gt;up&lt;span class="w"&gt; &lt;/span&gt;foreign&lt;span class="w"&gt; &lt;/span&gt;resources&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;auto_failback&lt;span class="o"&gt;)&lt;/span&gt;.
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:37&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;ipfail:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29182&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Delayed&lt;span class="w"&gt; &lt;/span&gt;giveup&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;seconds.
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:42&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;ipfail:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29182&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;giveup&lt;span class="o"&gt;()&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;called&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;timeout&lt;span class="w"&gt; &lt;/span&gt;worked&lt;span class="o"&gt;)&lt;/span&gt;
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:42&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;slave.org&lt;span class="w"&gt; &lt;/span&gt;wants&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;go&lt;span class="w"&gt; &lt;/span&gt;standby&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;foreign&lt;span class="o"&gt;]&lt;/span&gt;
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:43&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;standby:&lt;span class="w"&gt; &lt;/span&gt;master.org&lt;span class="w"&gt; &lt;/span&gt;can&lt;span class="w"&gt; &lt;/span&gt;take&lt;span class="w"&gt; &lt;/span&gt;our&lt;span class="w"&gt; &lt;/span&gt;foreign&lt;span class="w"&gt; &lt;/span&gt;resources
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:43&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29194&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;give&lt;span class="w"&gt; &lt;/span&gt;up&lt;span class="w"&gt; &lt;/span&gt;foreign&lt;span class="w"&gt; &lt;/span&gt;HA&lt;span class="w"&gt; &lt;/span&gt;resources&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;standby&lt;span class="o"&gt;)&lt;/span&gt;.
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:43&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;ResourceManager&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29204&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Releasing&lt;span class="w"&gt; &lt;/span&gt;resource&lt;span class="w"&gt; &lt;/span&gt;group:&lt;span class="w"&gt; &lt;/span&gt;master.org&lt;span class="w"&gt; &lt;/span&gt;IPaddr::192.168.3.103&lt;span class="w"&gt; &lt;/span&gt;mysqld
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:43&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;ResourceManager&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29204&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Running&lt;span class="w"&gt; &lt;/span&gt;/etc/init.d/mysqld&lt;span class="w"&gt;  &lt;/span&gt;stop
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:45&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;ResourceManager&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29204&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Running&lt;span class="w"&gt; &lt;/span&gt;/etc/ha.d/resource.d/IPaddr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.103&lt;span class="w"&gt; &lt;/span&gt;stop
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:45&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;IPaddr&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29279&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;INFO:&lt;span class="w"&gt;  &lt;/span&gt;Success
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:45&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29194&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;foreign&lt;span class="w"&gt; &lt;/span&gt;HA&lt;span class="w"&gt; &lt;/span&gt;resource&lt;span class="w"&gt; &lt;/span&gt;release&lt;span class="w"&gt; &lt;/span&gt;completed&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;standby&lt;span class="o"&gt;)&lt;/span&gt;.
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:45&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Local&lt;span class="w"&gt; &lt;/span&gt;standby&lt;span class="w"&gt; &lt;/span&gt;process&lt;span class="w"&gt; &lt;/span&gt;completed&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;foreign&lt;span class="o"&gt;]&lt;/span&gt;.
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:46&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;WARN:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;lost&lt;span class="w"&gt; &lt;/span&gt;packet&lt;span class="o"&gt;(&lt;/span&gt;s&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;master.org&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;162&lt;/span&gt;:164&lt;span class="o"&gt;]&lt;/span&gt;
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:46&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;remote&lt;span class="w"&gt; &lt;/span&gt;resource&lt;span class="w"&gt; &lt;/span&gt;transition&lt;span class="w"&gt; &lt;/span&gt;completed.
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:46&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;No&lt;span class="w"&gt; &lt;/span&gt;pkts&lt;span class="w"&gt; &lt;/span&gt;missing&lt;span class="w"&gt; &lt;/span&gt;from&lt;span class="w"&gt; &lt;/span&gt;master.org!
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;:50:46&lt;span class="w"&gt; &lt;/span&gt;slave&lt;span class="w"&gt; &lt;/span&gt;heartbeat:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Other&lt;span class="w"&gt; &lt;/span&gt;node&lt;span class="w"&gt; &lt;/span&gt;completed&lt;span class="w"&gt; &lt;/span&gt;standby&lt;span class="w"&gt; &lt;/span&gt;takeover&lt;span class="w"&gt; &lt;/span&gt;of&lt;span class="w"&gt; &lt;/span&gt;foreign&lt;span class="w"&gt; &lt;/span&gt;resources.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç°åœ¨å°è¯•åœæ­¢ä¸»åº“çš„MySQLæœåŠ¡&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;pkill&lt;span class="w"&gt; &lt;/span&gt;mysqld
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æŸ¥çœ‹æ—¥å¿—å¹¶æ— å˜åŒ–,æ‰€ä»¥å¾—å‡ºç»“è®ºheartbeatåªæ£€æµ‹å¿ƒè·³ä¹Ÿå°±æ˜¯åªæ£€æµ‹è®¾å¤‡æ˜¯å¦å®•æœº,ä¸ä¼šæ£€æµ‹MySQLæœåŠ¡,æ‰€ä»¥æˆ‘ä»¬åŒæ ·è¦æœ‰ä¸€ä¸ªè„šæœ¬æ¥æ£€æµ‹MySQLæœåŠ¡,å¦‚æœmysqlæœåŠ¡å®•æ‰,åˆ™å°è¯•å¯åŠ¨æœåŠ¡,è‹¥å¯åŠ¨æœåŠ¡å¤±è´¥åˆ™killæ‰heartbeatè¿›ç¨‹å®ç°æ•…éšœè½¬ç§»(å’Œä¸Šä¸€énginx+keepalivedåŸç†ä¸€è‡´),è„šæœ¬å†…å®¹å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="c1"&gt;# filename:mysqlsc.sh&lt;/span&gt;
ps&lt;span class="w"&gt; &lt;/span&gt;aux&lt;span class="w"&gt; &lt;/span&gt;Â¦&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;mysqld&lt;span class="w"&gt; &lt;/span&gt;Â¦&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;-v&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/dev/null&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# è¿‡æ»¤mysqlè¿›ç¨‹&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$?&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-eq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="c1"&gt;# å¦‚æœè¿‡æ»¤æœ‰mysqlè¿›ç¨‹ä¼šè¿”å›0åˆ™è®¤ä¸ºmysqlå­˜æ´»&lt;/span&gt;
&lt;span class="k"&gt;then&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;sleep&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="w"&gt;                     &lt;/span&gt;&lt;span class="c1"&gt;# ä½¿è„šæœ¬è¿›å…¥ä¼‘çœ &lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;
&lt;span class="c1"&gt;# å¦‚æœnginxæ²¡æœ‰å­˜æ´»å°è¯•å¯åŠ¨mysql,å¦‚æœå¤±è´¥åˆ™æ€æ­»heartbeatçš„è¿›ç¨‹&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;/etc/init.d/mysqld&lt;span class="w"&gt; &lt;/span&gt;start
&lt;span class="w"&gt;    &lt;/span&gt;ps&lt;span class="w"&gt; &lt;/span&gt;aux&lt;span class="w"&gt; &lt;/span&gt;Â¦&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;mysqld&lt;span class="w"&gt; &lt;/span&gt;Â¦&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;-v&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/dev/null&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$?&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-eq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]]&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;pkill&lt;span class="w"&gt; &lt;/span&gt;heartbeat
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;fi&lt;/span&gt;
&lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç»™è¿™ä¸ªè„šæœ¬æ‰§è¡Œæƒé™ç„¶ååå°è¿è¡Œ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;chmod&lt;span class="w"&gt; &lt;/span&gt;+x&lt;span class="w"&gt; &lt;/span&gt;mysqlsc.sh
nohup&lt;span class="w"&gt; &lt;/span&gt;sh&lt;span class="w"&gt; &lt;/span&gt;mysqlsc.sh&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# åå°è¿è¡Œ&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸‹é¢æ¥å°è¯•åœæ­¢ä¸»åº“çš„heartbeat:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;service&lt;span class="w"&gt; &lt;/span&gt;heartbeat&lt;span class="w"&gt; &lt;/span&gt;stop
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æŸ¥çœ‹ä»åº“æ—¥å¿—:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:05&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Received&lt;span class="w"&gt; &lt;/span&gt;shutdown&lt;span class="w"&gt; &lt;/span&gt;notice&lt;span class="w"&gt; &lt;/span&gt;from&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;master.org&amp;#39;&lt;/span&gt;.
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:05&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Resources&lt;span class="w"&gt; &lt;/span&gt;being&lt;span class="w"&gt; &lt;/span&gt;acquired&lt;span class="w"&gt; &lt;/span&gt;from&lt;span class="w"&gt; &lt;/span&gt;master.org.
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29308&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:05&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;acquire&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;local&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;HA&lt;span class="w"&gt; &lt;/span&gt;resources&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;standby&lt;span class="o"&gt;)&lt;/span&gt;.
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29308&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:05&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;local&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;HA&lt;span class="w"&gt; &lt;/span&gt;resource&lt;span class="w"&gt; &lt;/span&gt;acquisition&lt;span class="w"&gt; &lt;/span&gt;completed&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;standby&lt;span class="o"&gt;)&lt;/span&gt;.
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:05&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Standby&lt;span class="w"&gt; &lt;/span&gt;resource&lt;span class="w"&gt; &lt;/span&gt;acquisition&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;foreign&lt;span class="o"&gt;]&lt;/span&gt;.
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29309&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:05&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;No&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;local&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;resources&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;/usr/local/lib/heartbeat/ResourceManager&lt;span class="w"&gt; &lt;/span&gt;listkeys&lt;span class="w"&gt; &lt;/span&gt;slave.org&lt;span class="o"&gt;]&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;acquire.
harc&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29328&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:05&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Running&lt;span class="w"&gt; &lt;/span&gt;/etc/ha.d/rc.d/status&lt;span class="w"&gt; &lt;/span&gt;status
mach_down&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29338&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:05&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Taking&lt;span class="w"&gt; &lt;/span&gt;over&lt;span class="w"&gt; &lt;/span&gt;resource&lt;span class="w"&gt; &lt;/span&gt;group&lt;span class="w"&gt; &lt;/span&gt;IPaddr::192.168.3.103
ResourceManager&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29358&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:05&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Acquiring&lt;span class="w"&gt; &lt;/span&gt;resource&lt;span class="w"&gt; &lt;/span&gt;group:&lt;span class="w"&gt; &lt;/span&gt;master.org&lt;span class="w"&gt; &lt;/span&gt;IPaddr::192.168.3.103&lt;span class="w"&gt; &lt;/span&gt;mysqld
IPaddr&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29382&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:05&lt;span class="w"&gt; &lt;/span&gt;INFO:&lt;span class="w"&gt;  &lt;/span&gt;Resource&lt;span class="w"&gt; &lt;/span&gt;is&lt;span class="w"&gt; &lt;/span&gt;stopped
ResourceManager&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29358&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:06&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Running&lt;span class="w"&gt; &lt;/span&gt;/etc/ha.d/resource.d/IPaddr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.103&lt;span class="w"&gt; &lt;/span&gt;start
IPaddr&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29434&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:06&lt;span class="w"&gt; &lt;/span&gt;INFO:&lt;span class="w"&gt; &lt;/span&gt;Using&lt;span class="w"&gt; &lt;/span&gt;calculated&lt;span class="w"&gt; &lt;/span&gt;nic&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.103:&lt;span class="w"&gt; &lt;/span&gt;eth0
IPaddr&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29434&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:06&lt;span class="w"&gt; &lt;/span&gt;DEBUG:&lt;span class="w"&gt; &lt;/span&gt;Using&lt;span class="w"&gt; &lt;/span&gt;calculated&lt;span class="w"&gt; &lt;/span&gt;netmask&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.103:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;255&lt;/span&gt;.255.255.0
IPaddr&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29434&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:06&lt;span class="w"&gt; &lt;/span&gt;DEBUG:&lt;span class="w"&gt; &lt;/span&gt;Using&lt;span class="w"&gt; &lt;/span&gt;calculated&lt;span class="w"&gt; &lt;/span&gt;broadcast&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.103:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.255
IPaddr&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29434&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:06&lt;span class="w"&gt; &lt;/span&gt;INFO:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;eval&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/sbin/ifconfig&lt;span class="w"&gt; &lt;/span&gt;eth0:0&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.103&lt;span class="w"&gt; &lt;/span&gt;netmask&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;255&lt;/span&gt;.255.255.0&lt;span class="w"&gt; &lt;/span&gt;broadcast&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.255
IPaddr&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29434&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:06&lt;span class="w"&gt; &lt;/span&gt;DEBUG:&lt;span class="w"&gt; &lt;/span&gt;Sending&lt;span class="w"&gt; &lt;/span&gt;Gratuitous&lt;span class="w"&gt; &lt;/span&gt;Arp&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.103&lt;span class="w"&gt; &lt;/span&gt;on&lt;span class="w"&gt; &lt;/span&gt;eth0:0&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;eth0&lt;span class="o"&gt;]&lt;/span&gt;
IPaddr&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29425&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:06&lt;span class="w"&gt; &lt;/span&gt;INFO:&lt;span class="w"&gt;  &lt;/span&gt;Success
ResourceManager&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29358&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:06&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Running&lt;span class="w"&gt; &lt;/span&gt;/etc/init.d/mysqld&lt;span class="w"&gt;  &lt;/span&gt;start
mach_down&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29338&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:07&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;/usr/local/lib/heartbeat/mach_down:&lt;span class="w"&gt; &lt;/span&gt;nice_failback:&lt;span class="w"&gt; &lt;/span&gt;foreign&lt;span class="w"&gt; &lt;/span&gt;resources&lt;span class="w"&gt; &lt;/span&gt;acquired
mach_down&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29338&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:07&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;mach_down&lt;span class="w"&gt; &lt;/span&gt;takeover&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;complete&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;node&lt;span class="w"&gt; &lt;/span&gt;master.org.
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:07&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;mach_down&lt;span class="w"&gt; &lt;/span&gt;takeover&lt;span class="w"&gt; &lt;/span&gt;complete.
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:17&lt;span class="w"&gt; &lt;/span&gt;WARN:&lt;span class="w"&gt; &lt;/span&gt;node&lt;span class="w"&gt; &lt;/span&gt;master.org:&lt;span class="w"&gt; &lt;/span&gt;is&lt;span class="w"&gt; &lt;/span&gt;dead
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:17&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Dead&lt;span class="w"&gt; &lt;/span&gt;node&lt;span class="w"&gt; &lt;/span&gt;master.org&lt;span class="w"&gt; &lt;/span&gt;gave&lt;span class="w"&gt; &lt;/span&gt;up&lt;span class="w"&gt; &lt;/span&gt;resources.
heartbeat&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="m"&gt;29159&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;/02/19_14:03:17&lt;span class="w"&gt; &lt;/span&gt;info:&lt;span class="w"&gt; &lt;/span&gt;Link&lt;span class="w"&gt; &lt;/span&gt;master.org:eth0&lt;span class="w"&gt; &lt;/span&gt;dead.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content><category term="Linux"></category><category term="é«˜å¯ç”¨"></category><category term="å¿ƒè·³"></category><category term="åŒæœº"></category><category term="vip"></category><category term="MySQL"></category><category term="heartbeat"></category></entry><entry><title>nginx+keepalivedé…ç½®é«˜å¯ç”¨HTTPç¾¤é›†</title><link href="https://www.linuxzen.com/nginxkeepalivedpei-zhi-gao-ke-yong-httpqun-ji.html" rel="alternate"></link><published>2012-02-09T17:35:00+08:00</published><updated>2012-02-09T17:35:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-02-09:/nginxkeepalivedpei-zhi-gao-ke-yong-httpqun-ji.html</id><summary type="html">&lt;p&gt;Nginxä¸ä»…æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„WEBæœåŠ¡å™¨,åŒæ—¶å¯ä»¥æ ¹æ®nginxçš„åä»£ç†å¯ä»¥é…ç½®æˆå¼ºå¤§çš„è´Ÿè½½å‡è¡¡å™¨.è¿™é‡Œå°±ä»‹ç»å¦‚ä½•æŠŠnginxé…ç½®æˆè´Ÿè½½å‡è¡¡å™¨,å¹¶ç»“åˆkeepalivedé…ç½®é«˜å¯ç”¨çš„é›†ç¾¤.
ä¸€èˆ¬é›†ç¾¤ä¸»è¦æ¶æ„ä¸º:&lt;/p&gt;
&lt;p&gt;å‰ç«¯ä¸ºè´Ÿè½½å‡è¡¡å™¨ä¸¤ä¸ª:ä¸»/å¤‡,ä¸¤ç§å·¥ä½œæ–¹å¼,ä¸€ç§ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;Nginxä¸ä»…æ˜¯ä¸€æ¬¾ä¼˜ç§€çš„WEBæœåŠ¡å™¨,åŒæ—¶å¯ä»¥æ ¹æ®nginxçš„åä»£ç†å¯ä»¥é…ç½®æˆå¼ºå¤§çš„è´Ÿè½½å‡è¡¡å™¨.è¿™é‡Œå°±ä»‹ç»å¦‚ä½•æŠŠnginxé…ç½®æˆè´Ÿè½½å‡è¡¡å™¨,å¹¶ç»“åˆkeepalivedé…ç½®é«˜å¯ç”¨çš„é›†ç¾¤.
ä¸€èˆ¬é›†ç¾¤ä¸»è¦æ¶æ„ä¸º:&lt;/p&gt;
&lt;p&gt;å‰ç«¯ä¸ºè´Ÿè½½å‡è¡¡å™¨ä¸¤ä¸ª:ä¸»/å¤‡,ä¸¤ç§å·¥ä½œæ–¹å¼,ä¸€ç§æ˜¯å¤‡æœºå¾…æœºçŠ¶æ€,ä¸»æœºæ•…éšœæ—¶å¤‡æœºæ¥ç®¡ä¸»æœºå·¥ä½œå®ç°æ•…éšœåº„æ¯…,åœ¨ä¸»æœºæ•…éšœæ¢å¤å®Œæˆæ—¶å¤‡æœºç»§ç»­ä»…éœ€å¾…æœºçŠ¶æ€,ç¬¬äºŒç§æ˜¯ä¸»å¤‡åŒæ—¶å·¥ä½œ,ä¸€å°å®•æœºå¦å¤–ä¸€å°è‡ªåŠ¨æ¥ç®¡å¦ä¸€å°çš„å·¥ä½œå®ç°æ•…éšœè½¬ç§».
ç¬¬ä¸€ç§æ–¹å¼å¯ä»¥é€šè¿‡å°†åŸŸåè§£æåˆ°ä¸€ä¸ªè™šæ‹Ÿip(vip)ä¸Š,ä¸»è´Ÿè½½å‡è¡¡å™¨ç»‘å®šè™šæ‹Ÿip,å½“ä¸»è´Ÿè½½å‡è¡¡å™¨å‡ºç°æ•…éšœæ—¶,é€šè¿‡keepalivedè‡ªåŠ¨å°†vipç»‘å®šåˆ°å¤‡ç”¨è´Ÿè½½å‡è¡¡å™¨ä¸ŠåŒæ—¶arpingç½‘å…³åˆ·æ–°MACåœ°å€.,é¿å…å•ç‚¹æ•…éšœ.
ç¬¬äºŒç§æ–¹å¼ä¸»å¤‡åŒæ—¶ç»‘å®šä¸€ä¸ªvip,æŠŠåŸŸåé€šè¿‡DNSè½®è¯¢çš„æ–¹å¼è§£æåˆ°è¿™ä¸¤ä¸ªæœåŠ¡å™¨ä¸Š,ä¸»æœºå‡ºç°æ•…éšœ,å¤‡æœºå°±å°†ä¸»æœºç»‘å®švipç»‘å®šåˆ°å¤‡æœºä¸Š,åŒæ—¶arpingç½‘å…³åˆ·æ–°MACåœ°å€.å®ç°æ•…éšœè½¬ç§».&lt;/p&gt;
&lt;p&gt;ä¸­é—´ä¸ºWEBæœåŠ¡å™¨ä½œä¸ºreal server,å¤„ç†è¯·æ±‚.
åç«¯ä¸ºæ•°æ®åº“å’Œåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ.æ•°æ®åº“ä¸€èˆ¬ä¸ºä¸»ä»ä¸¤å°.åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿæœ‰æ•ˆè§£å†³WEBæœåŠ¡å™¨ä¹‹é—´çš„æ•°æ®åŒæ­¥.æœ‰çš„è¿˜ä¼šå°†å›¾ç‰‡æœåŠ¡å™¨å•ç‹¬åˆ†ç¦»å‡ºæ¥æ”¾åœ¨åç«¯.&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä½¿ç”¨ç¯å¢ƒ:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;CentOS 5.5 32ä½&lt;/li&gt;
&lt;li&gt;nginx:nginx-1.0.11&lt;/li&gt;
&lt;li&gt;keepalivedï¼škeepalived-1.1.19.tar.gz&lt;/li&gt;
&lt;li&gt;ä¸»è°ƒåº¦å™¨:192.168.3.1&lt;/li&gt;
&lt;li&gt;å¤‡è°ƒåº¦å™¨:192.168.3.2&lt;/li&gt;
&lt;li&gt;real server:192.168.3.4/5/6&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ¬æ–‡é‡‡ç”¨ç¬¬ä¸€ç§æ–¹å¼æ¥è¿›è¡Œvipä¸º:192.168.3.253&lt;/p&gt;
&lt;h2 id="nginx"&gt;ä¸€ã€åœ¨ä¸»å¤‡æœåŠ¡å™¨ä¸Šéƒ¨ç½²nginx&lt;/h2&gt;
&lt;h3 id="1"&gt;1.ä¸‹è½½&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;wget&lt;span class="w"&gt; &lt;/span&gt;http://nginx.org/download/nginx-1.0.11.tar.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="2"&gt;2.å®‰è£…&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="w"&gt;Â &lt;/span&gt;yum&lt;span class="w"&gt;Â Â &lt;/span&gt;-y&lt;span class="w"&gt;Â &lt;/span&gt;install&lt;span class="w"&gt;Â &lt;/span&gt;zlib-devel&lt;span class="w"&gt;Â &lt;/span&gt;pcre-devel&lt;span class="w"&gt;Â &lt;/span&gt;openssl-devel&lt;span class="w"&gt; Â &lt;/span&gt;&lt;span class="c1"&gt;# å®‰è£…ä¾èµ–&lt;/span&gt;
tar&lt;span class="w"&gt; &lt;/span&gt;-zxvf&lt;span class="w"&gt; &lt;/span&gt;nginx-1.0.11.tar.gz
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;nginx-1.0.11
./configure&lt;span class="w"&gt; &lt;/span&gt;--prefix&lt;span class="o"&gt;=&lt;/span&gt;/usr/local/nginx&lt;span class="w"&gt; &lt;/span&gt;--with-http_ssl_module&lt;span class="w"&gt; &lt;/span&gt;--with-http_flv_module&lt;span class="w"&gt; &lt;/span&gt;--with-http_gzip_static_module
make&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;3.é…ç½®&lt;/p&gt;
&lt;p&gt;é…ç½®ä¸»è°ƒåº¦å™¨çš„nginx,ç¼–è¾‘nginx.conf&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nginx/conf/nginx.conf

http&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;include&lt;span class="w"&gt;       &lt;/span&gt;mime.types&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;default_type&lt;span class="w"&gt;  &lt;/span&gt;application/octet-stream&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;#log_format  main  &amp;#39;$remote_addr - $remote_user [$time_local] &amp;quot;$request&amp;quot; &amp;#39;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;#                  &amp;#39;$status $body_bytes_sent &amp;quot;$http_referer&amp;quot; &amp;#39;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;#                  &amp;#39;&amp;quot;$http_user_agent&amp;quot; &amp;quot;$http_x_forwarded_for&amp;quot;&amp;#39;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;#access_log  logs/access.log  main;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;sendfile&lt;span class="w"&gt;        &lt;/span&gt;on&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;#tcp_nopush     on;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;#keepalive_timeout  0;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;keepalive_timeout&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;65&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;#gzip  on;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# æ·»åŠ ä¸€ç»„çœŸå®çš„æœåŠ¡å™¨åœ°å€æ± &lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# ä¾›proxy_passå’Œfastcgi_passæŒ‡ä»¤ä¸­ä½¿ç”¨çš„ä»£ç†æœåŠ¡å™¨&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;upstream&lt;span class="w"&gt; &lt;/span&gt;real_server_pool&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;# åå°å¦‚æœæœ‰åŠ¨æ€åº”ç”¨çš„æ—¶å€™,ip_hashæŒ‡ä»¤å¯ä»¥é€šè¿‡hashç®—æ³•&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;# å°†å®¢æˆ·ç«¯è¯·æ±‚å®šä½åˆ°åŒä¸€å°åç«¯æœåŠ¡å™¨ä¸Š,è§£å†³sessionå…±äº«,&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;# ä½†å»ºè®®ç”¨åŠ¨æ€åº”ç”¨åšsessionå…±äº«&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;# ip_hash;&lt;/span&gt;

&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;# serverç”¨äºæŒ‡å®šä¸€ä¸ªåç«¯æœåŠ¡å™¨çš„åç§°å’Œå‚æ•°&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;# weightä»£è¡¨æƒ,é‡é»˜è®¤ä¸º1,æƒé‡è¶Šé«˜è¢«åˆ†é…çš„å®¢æˆ·ç«¯è¶Šå¤š&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;# max_fails æŒ‡å®šæ—¶é—´å†…å¯¹åç«¯è¯·æ±‚å¤±è´¥çš„æ¬¡æ•°&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;# fail_timeout è¾¾åˆ°max_failsæŒ‡å®šçš„å¤±è´¥æ¬¡æ•°åæš‚åœçš„æ—¶é—´&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;server&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.4:80&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;weight&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;max_fails&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;fail_timeout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;30s&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;# downå‚æ•°ç”¨æ¥æ ‡è®°ä¸ºç¦»çº¿,ä¸å‚ä¸è´Ÿè½½å‡è¡¡.åœ¨ip_hashä¸‹ä½¿ç”¨&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;# åœ¨æ­¤åšæ¼”ç¤º,åé¢æµ‹è¯•ä¼šå»æ‰&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;server&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.5:80&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;weight&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;max_fails&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;fail_timeout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;30s&lt;span class="w"&gt; &lt;/span&gt;down&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;# backupä»…ä»…åœ¨ébackupæœåŠ¡å™¨å®•æœºæˆ–ç¹å¿™çš„æ—¶å€™ä½¿ç”¨&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;# (åœ¨æ­¤åšæ¼”ç¤º,åé¢æµ‹è¯•ä¼šå»æ‰)&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;server&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.6:80&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;weight&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;max_fails&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;fail_timeout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;30s&lt;span class="w"&gt; &lt;/span&gt;backup&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;server&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;listen&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.1:80&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;server_name&lt;span class="w"&gt;  &lt;/span&gt;localhost&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;#charset koi8-r;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;#access_log  logs/host.access.log  main;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;location&lt;span class="w"&gt; &lt;/span&gt;/&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="c1"&gt;#root   html;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="c1"&gt;#index  index.html index.htm;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="c1"&gt;# ä½¿ç”¨upstreamè®¾ç½®çš„ä¸€ç»„ä»£ç†æœåŠ¡å™¨&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="c1"&gt;# å¦‚æœåç«¯æœåŠ¡å™¨å‡ºç°502æˆ–504ç­‰æ‰§è¡Œé”™è¯¯æ—¶,&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="c1"&gt;# å°†è‡ªåŠ¨å°†è¯·æ±‚è½¬å‘ç»™è´Ÿè½½å‡è¡¡æ± ä¸­çš„å¦ä¸€å°æœåŠ¡å™¨.&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;proxy_next_upstream&lt;span class="w"&gt; &lt;/span&gt;http_502&lt;span class="w"&gt; &lt;/span&gt;http_504&lt;span class="w"&gt; &lt;/span&gt;error&lt;span class="w"&gt; &lt;/span&gt;timeout&lt;span class="w"&gt; &lt;/span&gt;invalid_header&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;proxy_pass&lt;span class="w"&gt; &lt;/span&gt;http://real_server_pool&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;proxy_set_header&lt;span class="w"&gt; &lt;/span&gt;Host&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$host&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;proxy_set_header&lt;span class="w"&gt; &lt;/span&gt;X-Forwarded-For&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$remote_addr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;(&lt;code&gt;æ³¨æ„:&lt;/code&gt;é…ç½®æ–‡ä»¶ä¸­æ³¨é‡Šip_hash,ä»¥ä¸ºip_hashè¿™ä¸ªåŠŸèƒ½å°†ä¿è¯è¿™ä¸ªå®¢æˆ·ç«¯è¯·æ±‚æ€»æ˜¯è¢«è½¬å‘åˆ°ä¸€å°æœåŠ¡å™¨ä¸Š,æ‰€ä»¥å¦‚æœå¯ç”¨äº†ip_hashæŒ‡ä»¤,å°†ä¸èƒ½å†ä½¿ç”¨weight(æƒé‡å‚æ•°),é…ç½®æ–‡ä»¶ä¸­åŠ å…¥ä¸ºè§£é‡Šip_hashæŒ‡ä»¤)
é…ç½®å¤‡ç”¨nginx,å°†ç›‘å¬ipæ”¹ä¸ºå¤‡ç”¨è°ƒåº¦å™¨çš„ip&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;http&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;include&lt;span class="w"&gt;       &lt;/span&gt;mime.types&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;default_type&lt;span class="w"&gt;  &lt;/span&gt;application/octet-stream&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;#log_format  main  &amp;#39;$remote_addr - $remote_user [$time_local] &amp;quot;$request&amp;quot; &amp;#39;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;#                  &amp;#39;$status $body_bytes_sent &amp;quot;$http_referer&amp;quot; &amp;#39;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;#                  &amp;#39;&amp;quot;$http_user_agent&amp;quot; &amp;quot;$http_x_forwarded_for&amp;quot;&amp;#39;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;#access_log  logs/access.log  main;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;sendfile&lt;span class="w"&gt;        &lt;/span&gt;on&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;#tcp_nopush     on;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;#keepalive_timeout  0;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;keepalive_timeout&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;65&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;#gzip  on;&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;upstream&lt;span class="w"&gt; &lt;/span&gt;real_server_pool&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;#ip_hash;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;server&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.4:80&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;weight&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;max_fails&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;fail_timeout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;30s&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;server&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.5:80&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;weight&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;max_fails&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;fail_timeout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;30s&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;server&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.6:80&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;weight&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;max_fails&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;fail_timeout&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;30s&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;server&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;listen&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.2:80&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="c1"&gt;# ç›‘å¬ipæ”¹ä¸ºæœ¬åœ°ip&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;server_name&lt;span class="w"&gt;  &lt;/span&gt;localhost&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;#charset koi8-r;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;#access_log  logs/host.access.log  main;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;location&lt;span class="w"&gt; &lt;/span&gt;/&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="c1"&gt;#root   html;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="c1"&gt;#index  index.html index.htm;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;proxy_next_upstream&lt;span class="w"&gt; &lt;/span&gt;http_502&lt;span class="w"&gt; &lt;/span&gt;http_504&lt;span class="w"&gt; &lt;/span&gt;error&lt;span class="w"&gt; &lt;/span&gt;timeout&lt;span class="w"&gt; &lt;/span&gt;invalid_header&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;proxy_pass&lt;span class="w"&gt; &lt;/span&gt;http://real_server_pool&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;proxy_set_header&lt;span class="w"&gt; &lt;/span&gt;Host&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$host&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;proxy_set_header&lt;span class="w"&gt; &lt;/span&gt;X-Forwarded-For&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$remote_addr&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åå¯åŠ¨ä¸»å¤‡nginx:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;/usr/local/nginx/sbin/nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="keepalived"&gt;äºŒã€åœ¨ä¸»å¤‡æœåŠ¡å™¨ä¸Šéƒ¨ç½²keepalived&lt;/h2&gt;
&lt;p&gt;å®‰è£…
å®‰è£…ä¾èµ–:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;kernel-devel&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="c1"&gt;# å®‰è£…ä¾èµ–&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¼€å¯è·¯ç”±è½¬å‘:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/etc/sysctl.conf
net.ipv4.ip_forward&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# æ­¤å‚æ•°æ”¹ä¸º1&lt;/span&gt;
sysctl&lt;span class="w"&gt; &lt;/span&gt;-p&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# ä½¿ä¿®æ”¹ç”Ÿæ•ˆ&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é¦–å…ˆå®‰è£…ipvs:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ln&lt;span class="w"&gt; &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;/usr/src/kernels/2.6.18-194.el5-i686/&lt;span class="w"&gt; &lt;/span&gt;/usr/src/linux&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# ipvséœ€è¦å†…æ ¸æ–‡ä»¶,åšä¸€ä¸ªè½¯è¿æ¥&lt;/span&gt;
&lt;span class="c1"&gt;# ä¸‹è½½&lt;/span&gt;
wget&lt;span class="w"&gt; &lt;/span&gt;http://www.linuxvirtualserver.org/software/kernel-2.6/ipvsadm-1.24.tar.gz
tar&lt;span class="w"&gt; &lt;/span&gt;-zxvf&lt;span class="w"&gt; &lt;/span&gt;ipvsadm-1.24.tar.gz
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;ipvsadm-1.24
make
make&lt;span class="w"&gt; &lt;/span&gt;install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åå®‰è£…keepalived&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# ä¸‹è½½&lt;/span&gt;
wget&lt;span class="w"&gt; &lt;/span&gt;http://www.keepalived.org/software/keepalived-1.1.19.tar.gz
tar&lt;span class="w"&gt; &lt;/span&gt;-zxvf&lt;span class="w"&gt; &lt;/span&gt;keepalived-1.1.19.tar.gz
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;keepalived-1.1.19
./configure&lt;span class="w"&gt; &lt;/span&gt;--prefix&lt;span class="o"&gt;=&lt;/span&gt;/&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="c1"&gt;# å®‰è£…åœ¨é»˜è®¤ä½ç½®(é…ç½®æ–‡ä»¶,äºŒè¿›åˆ¶æ–‡ä»¶,å¯åŠ¨è„šæœ¬æ”¾åˆ°é»˜è®¤ä½ç½®)&lt;/span&gt;
--mandir&lt;span class="o"&gt;=&lt;/span&gt;/usr/local/share/man/&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
--with-kernel-dir&lt;span class="o"&gt;=&lt;/span&gt;/usr/src/kernels/2.6.18-194.el5-i686/&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# éœ€è¦å†…æ ¸çš„å¤´æ–‡ä»¶&lt;/span&gt;
make&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h3 id="keepalived_1"&gt;é…ç½®keepalived&lt;/h3&gt;
&lt;p&gt;ç¼–è¾‘ä¸»è°ƒåº¦å™¨é…ç½®æ–‡ä»¶/etc/keepalived/keepalived.conf ###&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;global_defs&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;notification_email&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;cold_night@linuxzen.com&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="c1"&gt;# å®šä¹‰é€šçŸ¥é‚®ç®±,æœ‰å¤šä¸ªå¯ä»¥æ¢è¡Œæ·»åŠ &lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;notification_email_from&lt;span class="w"&gt; &lt;/span&gt;root@linuxzen.com#&lt;span class="w"&gt; &lt;/span&gt;å®šä¹‰å‘é€é‚®ä»¶çš„é‚®ç®±
&lt;span class="w"&gt;   &lt;/span&gt;smtp_server&lt;span class="w"&gt; &lt;/span&gt;www.linuxzen.com&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="c1"&gt;# å®šä¹‰å‘ä»¶æœåŠ¡å™¨&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;smtp_connect_timeout&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt;&lt;span class="w"&gt;                  &lt;/span&gt;&lt;span class="c1"&gt;# å®šä¹‰è¿æ¥smtpæœåŠ¡å™¨è¶…æ—¶æ—¶é—´&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;router_id&lt;span class="w"&gt; &lt;/span&gt;LVS_DEVEL
&lt;span class="o"&gt;}&lt;/span&gt;

vrrp_instance&lt;span class="w"&gt; &lt;/span&gt;VI_1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;state&lt;span class="w"&gt; &lt;/span&gt;MASTER&lt;span class="w"&gt;                   &lt;/span&gt;&lt;span class="c1"&gt;# æ ‡ç¤ºä¸»å¤‡,å¤‡æœºä¸Šæ”¹ä¸ºBACKUP&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;interface&lt;span class="w"&gt; &lt;/span&gt;eth0&lt;span class="w"&gt;                 &lt;/span&gt;&lt;span class="c1"&gt;# HAç›‘æµ‹çš„ç«¯å£&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;virtual_router_id&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;51&lt;/span&gt;&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="c1"&gt;# ä¸»å¤‡çš„virtual_router_idçš„å€¼å¿…é¡»ç›¸åŒ&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;priority&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="w"&gt;                   &lt;/span&gt;&lt;span class="c1"&gt;# ä¼˜å…ˆçº§,é€šå¸¸ä¸»è¦æ¯”å¤‡ç¨å¤§&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;advert_int&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt;                   &lt;/span&gt;&lt;span class="c1"&gt;# VRRP Multicast å¹¿æ’­å‘¨æœŸç§’æ•°&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;authentication&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="c1"&gt;# å®šä¹‰è®¤è¯&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;auth_type&lt;span class="w"&gt; &lt;/span&gt;PASS&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="c1"&gt;# è®¤è¯æ–¹å¼&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;auth_pass&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1111&lt;/span&gt;&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="c1"&gt;# è®¤è¯å£ä»¤å­—&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;virtual_ipaddress&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="c1"&gt;# å®šä¹‰vip&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.253&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="c1"&gt;# å¤šä¸ªå¯æ¢è¡Œæ·»åŠ ,ä¸€è¡Œä¸€ä¸ª&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

virtual_server&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.253&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;80&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;delay_loop&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;6&lt;/span&gt;&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="c1"&gt;# æ¯éš” 6 ç§’æŸ¥è¯¢ realserver çŠ¶æ€&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;lb_algo&lt;span class="w"&gt; &lt;/span&gt;rr
&lt;span class="w"&gt;    &lt;/span&gt;lb_kind&lt;span class="w"&gt; &lt;/span&gt;NAT
&lt;span class="w"&gt;    &lt;/span&gt;nat_mask&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;255&lt;/span&gt;.255.255.0
&lt;span class="w"&gt;    &lt;/span&gt;persistence_timeout&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;50&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# åŒä¸€IP çš„è¿æ¥50ç§’å†…è¢«åˆ†é…åˆ°åŒä¸€å°realserver&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;protocol&lt;span class="w"&gt; &lt;/span&gt;TCP&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="c1"&gt;# ç”¨TCPç›‘æµ‹realserverçš„çŠ¶æ€&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;real_server&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;80&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;weight&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="c1"&gt;# æƒé‡&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;TCP_CHECK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;connect_timeout&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# 10ç§’æ— å“åº”è¶…æ—¶&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;nb_get_retry&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;delay_before_retry&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;connect_port&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;80&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;real_server&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.2&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;80&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;weight&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;TCP_CHECK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;connect_timeout&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;delay_before_retry&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;connect_port&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;80&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é…ç½®å¤‡ç”¨è°ƒåº¦å™¨çš„keepalived,åªéœ€è¦å°†state MASTER æ”¹ä¸ºstate BACKUP,é™ä½priority 100 çš„å€¼:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;global_defs&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;notification_email&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;cold_night@linuxzen.com
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;notification_email_from&lt;span class="w"&gt; &lt;/span&gt;root@linuxzen.com
&lt;span class="w"&gt;   &lt;/span&gt;smtp_server&lt;span class="w"&gt; &lt;/span&gt;www.linuxzen.com
&lt;span class="w"&gt;   &lt;/span&gt;smtp_connect_timeout&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;router_id&lt;span class="w"&gt; &lt;/span&gt;LVS_DEVEL
&lt;span class="o"&gt;}&lt;/span&gt;

vrrp_instance&lt;span class="w"&gt; &lt;/span&gt;VI_1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;state&lt;span class="w"&gt; &lt;/span&gt;BACKUP&lt;span class="w"&gt;                   &lt;/span&gt;&lt;span class="c1"&gt;# å¤‡æœºä¸Šæ”¹ä¸ºBACKUP&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;interface&lt;span class="w"&gt; &lt;/span&gt;eth0
&lt;span class="w"&gt;    &lt;/span&gt;virtual_router_id&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;51&lt;/span&gt;&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="c1"&gt;# ä¸»å¤‡çš„virtual_router_idçš„å€¼å¿…é¡»ç›¸åŒ&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;priority&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;99&lt;/span&gt;&lt;span class="w"&gt;                    &lt;/span&gt;&lt;span class="c1"&gt;# å¤‡ç”¨ä¼˜å…ˆçº§å°äºä¸»è°ƒåº¦å™¨&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;advert_int&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;authentication&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;auth_type&lt;span class="w"&gt; &lt;/span&gt;PASS
&lt;span class="w"&gt;        &lt;/span&gt;auth_pass&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1111&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;virtual_ipaddress&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.253
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

virtual_server&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.253&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;80&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;delay_loop&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;6&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;lb_algo&lt;span class="w"&gt; &lt;/span&gt;rr
&lt;span class="w"&gt;    &lt;/span&gt;lb_kind&lt;span class="w"&gt; &lt;/span&gt;NAT
&lt;span class="w"&gt;    &lt;/span&gt;nat_mask&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;255&lt;/span&gt;.255.255.0
&lt;span class="w"&gt;    &lt;/span&gt;persistence_timeout&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;50&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;protocol&lt;span class="w"&gt; &lt;/span&gt;TCP&lt;span class="w"&gt;        &lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;real_server&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;80&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;weight&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;TCP_CHECK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;connect_timeout&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;nb_get_retry&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;delay_before_retry&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;connect_port&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;80&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;real_server&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.2&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;80&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;weight&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;TCP_CHECK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;connect_timeout&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;delay_before_retry&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;connect_port&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;80&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸»å¤‡ä¸Šå¯åŠ¨keepalived:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;service&lt;span class="w"&gt; &lt;/span&gt;keepalived&lt;span class="w"&gt; &lt;/span&gt;start
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;h2 id="-"&gt;ä¸‰ã€æµ‹è¯•-----éƒ¨ç½²åç«¯æœåŠ¡å™¨&lt;/h2&gt;
&lt;p&gt;åœ¨åç«¯æœåŠ¡å™¨å®‰è£…nginx,è¿™é‡Œä»…éƒ¨ç½²ä¸€å°ç„¶ååˆ›å»º3ä¸ªåŸºäºipçš„è™šæ‹Ÿä¸»æœºä¾›æµ‹è¯•:
ç»‘å®šip:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ifconfig&lt;span class="w"&gt; &lt;/span&gt;eth0:1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.4/24
ifconfig&lt;span class="w"&gt; &lt;/span&gt;eth0:2&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.5/24
ifconfig&lt;span class="w"&gt; &lt;/span&gt;eth0:3&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.6/24
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…nginxåç¼–è¾‘é…ç½®æ–‡ä»¶,åœ¨httpå—é‡Œæ·»åŠ :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;http&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;server&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;listen&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.4:80&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;server_name&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.4&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;location&lt;span class="w"&gt; &lt;/span&gt;/&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;             &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;html/s1&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;             &lt;/span&gt;index&lt;span class="w"&gt; &lt;/span&gt;index.html&lt;span class="w"&gt; &lt;/span&gt;index.htm&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;server&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;listen&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.5:80&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;server_name&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.5&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;location&lt;span class="w"&gt; &lt;/span&gt;/&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;html/s2&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;index&lt;span class="w"&gt; &lt;/span&gt;index.html&lt;span class="w"&gt; &lt;/span&gt;index.htm&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;

&lt;span class="w"&gt;    &lt;/span&gt;server&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;listen&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.6:80&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;server_name&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.5&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;location&lt;span class="w"&gt; &lt;/span&gt;/&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;html/s3&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;index&lt;span class="w"&gt; &lt;/span&gt;index.html&lt;span class="w"&gt; &lt;/span&gt;index.htm&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åˆ›å»ºè™šæ‹Ÿä¸»æœºæ ¹ç›®å½•,å¹¶åˆ›å»ºä¸é€šçš„é¦–é¡µæ–‡æ¡£:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/usr/local/nginx/html/
mkdir&lt;span class="w"&gt; &lt;/span&gt;s1&lt;span class="w"&gt; &lt;/span&gt;s2&lt;span class="w"&gt; &lt;/span&gt;s3
&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;server1&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;s1/index.html
&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;server2&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;s2/index.html
&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;server3&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;s3/index.html
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¯åŠ¨nginx:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;/usr/local/nginx/sbin/nginx
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ‰“å¼€æµè§ˆå™¨è®¿é—®&lt;code&gt;http://192.168.3.253&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;åˆ·æ–°ä¼šçœ‹åˆ°æ˜¾ç¤ºä¸åŒçš„å†…å®¹:server1,server2,server3(ç”Ÿäº§ä¸­çš„æœåŠ¡å™¨åº”è¯¥æ˜¯ä¸€æ ·çš„)
[gallery link="file" order="DESC"]
ç°åœ¨åœæ‰ä¸»è°ƒåº¦å™¨çš„keepalived&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;pkill&lt;span class="w"&gt; &lt;/span&gt;keepalived
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æŸ¥çœ‹å¤‡è°ƒåº¦å™¨çš„æ—¥å¿—:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;cat&lt;span class="w"&gt; &lt;/span&gt;/var/log/messages
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;:36:27&lt;span class="w"&gt; &lt;/span&gt;cfhost&lt;span class="w"&gt; &lt;/span&gt;Keepalived_vrrp:&lt;span class="w"&gt; &lt;/span&gt;VRRP_Instance&lt;span class="o"&gt;(&lt;/span&gt;VI_1&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Transition&lt;span class="w"&gt; &lt;/span&gt;to&lt;span class="w"&gt; &lt;/span&gt;MASTER&lt;span class="w"&gt; &lt;/span&gt;STATE
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;:36:28&lt;span class="w"&gt; &lt;/span&gt;cfhost&lt;span class="w"&gt; &lt;/span&gt;Keepalived_vrrp:&lt;span class="w"&gt; &lt;/span&gt;VRRP_Instance&lt;span class="o"&gt;(&lt;/span&gt;VI_1&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Entering&lt;span class="w"&gt; &lt;/span&gt;MASTER&lt;span class="w"&gt; &lt;/span&gt;STATE
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;:36:28&lt;span class="w"&gt; &lt;/span&gt;cfhost&lt;span class="w"&gt; &lt;/span&gt;Keepalived_vrrp:&lt;span class="w"&gt; &lt;/span&gt;VRRP_Instance&lt;span class="o"&gt;(&lt;/span&gt;VI_1&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;setting&lt;span class="w"&gt; &lt;/span&gt;protocol&lt;span class="w"&gt; &lt;/span&gt;VIPs.
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;:36:28&lt;span class="w"&gt; &lt;/span&gt;cfhost&lt;span class="w"&gt; &lt;/span&gt;Keepalived_vrrp:&lt;span class="w"&gt; &lt;/span&gt;VRRP_Instance&lt;span class="o"&gt;(&lt;/span&gt;VI_1&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Sending&lt;span class="w"&gt; &lt;/span&gt;gratuitous&lt;span class="w"&gt; &lt;/span&gt;ARPs&lt;span class="w"&gt; &lt;/span&gt;on&lt;span class="w"&gt; &lt;/span&gt;eth0&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.253
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;:36:28&lt;span class="w"&gt; &lt;/span&gt;cfhost&lt;span class="w"&gt; &lt;/span&gt;Keepalived_vrrp:&lt;span class="w"&gt; &lt;/span&gt;Netlink&lt;span class="w"&gt; &lt;/span&gt;reflector&lt;span class="w"&gt; &lt;/span&gt;reports&lt;span class="w"&gt; &lt;/span&gt;IP&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.253&lt;span class="w"&gt; &lt;/span&gt;added
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;:36:28&lt;span class="w"&gt; &lt;/span&gt;cfhost&lt;span class="w"&gt; &lt;/span&gt;Keepalived_healthcheckers:&lt;span class="w"&gt; &lt;/span&gt;Netlink&lt;span class="w"&gt; &lt;/span&gt;reflector&lt;span class="w"&gt; &lt;/span&gt;reports&lt;span class="w"&gt; &lt;/span&gt;IP&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.253&lt;span class="w"&gt; &lt;/span&gt;added
Feb&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;:36:33&lt;span class="w"&gt; &lt;/span&gt;cfhost&lt;span class="w"&gt; &lt;/span&gt;Keepalived_vrrp:&lt;span class="w"&gt; &lt;/span&gt;VRRP_Instance&lt;span class="o"&gt;(&lt;/span&gt;VI_1&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Sending&lt;span class="w"&gt; &lt;/span&gt;gratuitous&lt;span class="w"&gt; &lt;/span&gt;ARPs&lt;span class="w"&gt; &lt;/span&gt;on&lt;span class="w"&gt; &lt;/span&gt;eth0&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.253
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;p&gt;ç°åœ¨è®¿é—®&lt;code&gt;http://192.168.3.253&lt;/code&gt;ä¾ç„¶å¯ä»¥è®¿é—®.
å¤§å®¶ä¹Ÿçœ‹åˆ°äº†å¤‡æœºkeepalivedåªæœ‰æ£€æµ‹ä¸»æœºçš„keepalivedåœæ­¢çš„æ—¶å€™æ‰ä¼šåˆ‡æ¢vip,è€Œä¸æ˜¯æ£€æµ‹ä¸€å°real serverçš„æŸä¸€æœåŠ¡(æ¯”å¦‚æ£€æµ‹80ç«¯å£çš„HTTP)åˆ‡æ¢vip,æ‰€ä»¥åœ¨nginxè¿›ç¨‹åœæ­¢çš„æ—¶å€™,å¦‚æœæœåŠ¡å™¨æ²¡æœ‰å®•æœºè¿™æ—¶å€™å°±æ— æ³•å®ç°æ•…éšœè½¬ç§»,æ‰€ä»¥æˆ‘ä»¬ç¼–å†™ä¸€ä¸ªæ£€æµ‹nginxçŠ¶æ€çš„è„šæœ¬ç»“åˆkeepalivedå®ç°æ•…éšœè½¬ç§»:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="ch"&gt;#!/bin/bash&lt;/span&gt;
&lt;span class="c1"&gt;#filename:nsc.sh&lt;/span&gt;
ps&lt;span class="w"&gt; &lt;/span&gt;aux&lt;span class="w"&gt; &lt;/span&gt;Â¦&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;nginx&lt;span class="w"&gt; &lt;/span&gt;Â¦&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;-v&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/dev/null&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# è¿‡æ»¤nginxè¿›ç¨‹&lt;/span&gt;
&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$?&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-eq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]]&lt;/span&gt;&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="c1"&gt;# å¦‚æœè¿‡æ»¤æœ‰nginxè¿›ç¨‹ä¼šè¿”å›0åˆ™è®¤ä¸ºnginxå­˜æ´»&lt;/span&gt;
&lt;span class="k"&gt;then&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;sleep&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="w"&gt;                     &lt;/span&gt;&lt;span class="c1"&gt;# ä½¿è„šæœ¬è¿›å…¥ä¼‘çœ &lt;/span&gt;
&lt;span class="k"&gt;else&lt;/span&gt;
&lt;span class="c1"&gt;# å¦‚æœnginxæ²¡æœ‰å­˜æ´»å°è¯•å¯åŠ¨nginx,å¦‚æœå¤±è´¥åˆ™æ€æ­»keepalivedçš„è¿›ç¨‹&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/nginx/sbin/nginx
&lt;span class="w"&gt;    &lt;/span&gt;ps&lt;span class="w"&gt; &lt;/span&gt;aux&lt;span class="w"&gt; &lt;/span&gt;Â¦&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;nginx&lt;span class="w"&gt; &lt;/span&gt;Â¦&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;-v&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/dev/null&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;if&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$?&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-eq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]]&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;then&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;pkill&lt;span class="w"&gt; &lt;/span&gt;keepalived
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="k"&gt;fi&lt;/span&gt;
&lt;span class="k"&gt;fi&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶ååå°è¿è¡Œæ­¤è„šæœ¬:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;nohup&lt;span class="w"&gt; &lt;/span&gt;sh&lt;span class="w"&gt; &lt;/span&gt;nsc.sh&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™æ ·å°±å®ç°äº†ç¾¤é›†çš„é«˜å¯é å’Œé«˜å¯ç”¨.&lt;/p&gt;</content><category term="Linux"></category><category term="é«˜å¯ç”¨"></category><category term="è´Ÿè½½å‡è¡¡"></category><category term="ç¾¤é›†"></category><category term="åå‘ä»£ç†"></category><category term="åŒæœº"></category><category term="nginx"></category><category term="keepalived"></category></entry><entry><title>MySQLä¼˜åŒ–ç¬”è®°</title><link href="https://www.linuxzen.com/mysqlyou-hua-bi-ji.html" rel="alternate"></link><published>2012-02-04T13:36:00+08:00</published><updated>2012-02-04T13:36:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-02-04:/mysqlyou-hua-bi-ji.html</id><summary type="html">&lt;p&gt;ä¹‹å‰å®‰è£…æ—¶æ²¡æ³¨æ„MySQLçš„ä¼˜åŒ–,å…ˆæƒ³å¯¹MySQLåšä¸€ä¸‹ä¼˜åŒ–.é¦–å…ˆçœ‹ä¸€ä¸‹æ²¡æœ‰ä¼˜åŒ–ä¹‹å‰å„ä¸ªå‚æ•°:
MySQLé¢„ç¼–è¯‘å‚æ•°:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="w"&gt; &lt;/span&gt;./configure&lt;span class="w"&gt;  &lt;/span&gt;--prefix&lt;span class="o"&gt;=&lt;/span&gt;/usr/local/mysql&lt;span class="w"&gt; &lt;/span&gt;--with-ssl&lt;span class="w"&gt; &lt;/span&gt;--with-readline&lt;span class="w"&gt; &lt;/span&gt;--with-big-tables&lt;span class="w"&gt; &lt;/span&gt;--enable-assembler
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;top&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="m"&gt;32553&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;mysql&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;125m&lt;span class="w"&gt;  &lt;/span&gt;17m&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;4064&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;S&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1 â€¦&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</summary><content type="html">&lt;p&gt;ä¹‹å‰å®‰è£…æ—¶æ²¡æ³¨æ„MySQLçš„ä¼˜åŒ–,å…ˆæƒ³å¯¹MySQLåšä¸€ä¸‹ä¼˜åŒ–.é¦–å…ˆçœ‹ä¸€ä¸‹æ²¡æœ‰ä¼˜åŒ–ä¹‹å‰å„ä¸ªå‚æ•°:
MySQLé¢„ç¼–è¯‘å‚æ•°:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="w"&gt; &lt;/span&gt;./configure&lt;span class="w"&gt;  &lt;/span&gt;--prefix&lt;span class="o"&gt;=&lt;/span&gt;/usr/local/mysql&lt;span class="w"&gt; &lt;/span&gt;--with-ssl&lt;span class="w"&gt; &lt;/span&gt;--with-readline&lt;span class="w"&gt; &lt;/span&gt;--with-big-tables&lt;span class="w"&gt; &lt;/span&gt;--enable-assembler
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;top&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="m"&gt;32553&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;mysql&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;125m&lt;span class="w"&gt;  &lt;/span&gt;17m&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;4064&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;S&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.7&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;:13.01&lt;span class="w"&gt; &lt;/span&gt;mysqld
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä½¿ç”¨mysqlreportè·å–MySQLè¿è¡Œå‚æ•°:&lt;!--more--&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;MySQL&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;.0.40-log&lt;span class="w"&gt;         &lt;/span&gt;uptime&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;15&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;22&lt;/span&gt;:1:21&lt;span class="w"&gt;      &lt;/span&gt;Sat&lt;span class="w"&gt; &lt;/span&gt;Feb&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;:04:23&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;

__&lt;span class="w"&gt; &lt;/span&gt;Key&lt;span class="w"&gt; &lt;/span&gt;_________________________________________________________________
Buffer&lt;span class="w"&gt; &lt;/span&gt;used&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;62&lt;/span&gt;.00k&lt;span class="w"&gt; &lt;/span&gt;of&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;.00M&lt;span class="w"&gt;  &lt;/span&gt;%Used:&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.38
&lt;span class="w"&gt;  &lt;/span&gt;Current&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.90M&lt;span class="w"&gt;            &lt;/span&gt;%Usage:&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;.89
Write&lt;span class="w"&gt; &lt;/span&gt;hit&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="m"&gt;22&lt;/span&gt;.29%
Read&lt;span class="w"&gt; &lt;/span&gt;hit&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;99&lt;/span&gt;.83%

__&lt;span class="w"&gt; &lt;/span&gt;Questions&lt;span class="w"&gt; &lt;/span&gt;___________________________________________________________
Total&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="m"&gt;85&lt;/span&gt;.58k&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.1/s
&lt;span class="w"&gt;  &lt;/span&gt;DMS&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="m"&gt;77&lt;/span&gt;.61k&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.1/s&lt;span class="w"&gt;  &lt;/span&gt;%Total:&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;90&lt;/span&gt;.69
&lt;span class="w"&gt;  &lt;/span&gt;Com_&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;.37k&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;6&lt;/span&gt;.28
&lt;span class="w"&gt;  &lt;/span&gt;COM_QUIT&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.52k&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.95
&lt;span class="w"&gt;  &lt;/span&gt;+Unknown&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="m"&gt;78&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.09
Slow&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;s&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;/s&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.00&lt;span class="w"&gt;  &lt;/span&gt;%DMS:&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.00&lt;span class="w"&gt;  &lt;/span&gt;Log:&lt;span class="w"&gt; &lt;/span&gt;OFF
DMS&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;77&lt;/span&gt;.61k&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.1/s&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="m"&gt;90&lt;/span&gt;.69
&lt;span class="w"&gt;  &lt;/span&gt;SELECT&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;72&lt;/span&gt;.77k&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.1/s&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="m"&gt;85&lt;/span&gt;.03&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="m"&gt;93&lt;/span&gt;.76
&lt;span class="w"&gt;  &lt;/span&gt;UPDATE&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.68k&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;.13&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;.45
&lt;span class="w"&gt;  &lt;/span&gt;INSERT&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.09k&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.27&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.41
&lt;span class="w"&gt;  &lt;/span&gt;DELETE&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.07k&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.25&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.38
&lt;span class="w"&gt;  &lt;/span&gt;REPLACE&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;/s&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.00&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.00
Com_&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;.37k&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;6&lt;/span&gt;.28
&lt;span class="w"&gt;  &lt;/span&gt;set_option&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.60k&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;.04
&lt;span class="w"&gt;  &lt;/span&gt;change_db&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.52k&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.94
&lt;span class="w"&gt;  &lt;/span&gt;show_fields&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="m"&gt;77&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.09

__&lt;span class="w"&gt; &lt;/span&gt;SELECT&lt;span class="w"&gt; &lt;/span&gt;and&lt;span class="w"&gt; &lt;/span&gt;Sort&lt;span class="w"&gt; &lt;/span&gt;_____________________________________________________
Scan&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;.17k&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s&lt;span class="w"&gt; &lt;/span&gt;%SELECT:&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;7&lt;/span&gt;.10
Range&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.75k&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;.77
Full&lt;span class="w"&gt; &lt;/span&gt;join&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;/s&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.00
Range&lt;span class="w"&gt; &lt;/span&gt;check&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;/s&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.00
Full&lt;span class="w"&gt; &lt;/span&gt;rng&lt;span class="w"&gt; &lt;/span&gt;join&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;/s&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.00
Sort&lt;span class="w"&gt; &lt;/span&gt;scan&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;.97k&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s
Sort&lt;span class="w"&gt; &lt;/span&gt;range&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="m"&gt;4&lt;/span&gt;.30k&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s
Sort&lt;span class="w"&gt; &lt;/span&gt;mrg&lt;span class="w"&gt; &lt;/span&gt;pass&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;/s

__&lt;span class="w"&gt; &lt;/span&gt;Table&lt;span class="w"&gt; &lt;/span&gt;Locks&lt;span class="w"&gt; &lt;/span&gt;_________________________________________________________
Waited&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="m"&gt;24&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s&lt;span class="w"&gt;  &lt;/span&gt;%Total:&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.03
Immediate&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="m"&gt;91&lt;/span&gt;.00k&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.1/s

__&lt;span class="w"&gt; &lt;/span&gt;Tables&lt;span class="w"&gt; &lt;/span&gt;______________________________________________________________
Open&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="m"&gt;36&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;of&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;64&lt;/span&gt;&lt;span class="w"&gt;    &lt;/span&gt;%Cache:&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;56&lt;/span&gt;.25
Opened&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="m"&gt;42&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s

__&lt;span class="w"&gt; &lt;/span&gt;Connections&lt;span class="w"&gt; &lt;/span&gt;_________________________________________________________
Max&lt;span class="w"&gt; &lt;/span&gt;used&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;of&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;%Max:&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;.00
Total&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.52k&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s

__&lt;span class="w"&gt; &lt;/span&gt;Created&lt;span class="w"&gt; &lt;/span&gt;Temp&lt;span class="w"&gt; &lt;/span&gt;________________________________________________________
Disk&lt;span class="w"&gt; &lt;/span&gt;table&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="m"&gt;4&lt;/span&gt;.15k&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s
Table&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="m"&gt;7&lt;/span&gt;.11k&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s&lt;span class="w"&gt;    &lt;/span&gt;Size:&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;32&lt;/span&gt;.0M
File&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="m"&gt;5&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s

__&lt;span class="w"&gt; &lt;/span&gt;Threads&lt;span class="w"&gt; &lt;/span&gt;_____________________________________________________________
Running&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;of&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
Cached&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;of&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;%Hit:&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.04
Created&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;.52k&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s
Slow&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;/s

__&lt;span class="w"&gt; &lt;/span&gt;Aborted&lt;span class="w"&gt; &lt;/span&gt;_____________________________________________________________
Clients&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;/s
Connects&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;/s

__&lt;span class="w"&gt; &lt;/span&gt;Bytes&lt;span class="w"&gt; &lt;/span&gt;_______________________________________________________________
Sent&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="m"&gt;226&lt;/span&gt;.71M&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;164&lt;/span&gt;.8/s
Received&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;12&lt;/span&gt;.59M&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;9&lt;/span&gt;.2/s

__&lt;span class="w"&gt; &lt;/span&gt;InnoDB&lt;span class="w"&gt; &lt;/span&gt;Buffer&lt;span class="w"&gt; &lt;/span&gt;Pool&lt;span class="w"&gt; &lt;/span&gt;__________________________________________________
Usage&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="m"&gt;304&lt;/span&gt;.00k&lt;span class="w"&gt; &lt;/span&gt;of&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;8&lt;/span&gt;.00M&lt;span class="w"&gt;  &lt;/span&gt;%Used:&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;.71
Read&lt;span class="w"&gt; &lt;/span&gt;hit&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;84&lt;/span&gt;.42%
Pages
&lt;span class="w"&gt;  &lt;/span&gt;Free&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;493&lt;/span&gt;&lt;span class="w"&gt;            &lt;/span&gt;%Total:&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;96&lt;/span&gt;.29
&lt;span class="w"&gt;  &lt;/span&gt;Data&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt;                      &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;.71&lt;span class="w"&gt; &lt;/span&gt;%Drty:&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.00
&lt;span class="w"&gt;  &lt;/span&gt;Misc&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;                      &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.00
&lt;span class="w"&gt;  &lt;/span&gt;Latched&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;                      &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.00
Reads&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="m"&gt;77&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s
&lt;span class="w"&gt;  &lt;/span&gt;From&lt;span class="w"&gt; &lt;/span&gt;file&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="m"&gt;12&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="m"&gt;15&lt;/span&gt;.58
&lt;span class="w"&gt;  &lt;/span&gt;Ahead&lt;span class="w"&gt; &lt;/span&gt;Rnd&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s
&lt;span class="w"&gt;  &lt;/span&gt;Ahead&lt;span class="w"&gt; &lt;/span&gt;Sql&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;/s
Writes&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;/s
Flushes&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;/s
Wait&lt;span class="w"&gt; &lt;/span&gt;Free&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;/s

__&lt;span class="w"&gt; &lt;/span&gt;InnoDB&lt;span class="w"&gt; &lt;/span&gt;Lock&lt;span class="w"&gt; &lt;/span&gt;_________________________________________________________
Waits&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;/s
Current&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
Time&lt;span class="w"&gt; &lt;/span&gt;acquiring
&lt;span class="w"&gt;  &lt;/span&gt;Total&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;ms
&lt;span class="w"&gt;  &lt;/span&gt;Average&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;ms
&lt;span class="w"&gt;  &lt;/span&gt;Max&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;ms

__&lt;span class="w"&gt; &lt;/span&gt;InnoDB&lt;span class="w"&gt; &lt;/span&gt;Data,&lt;span class="w"&gt; &lt;/span&gt;Pages,&lt;span class="w"&gt; &lt;/span&gt;Rows&lt;span class="w"&gt; &lt;/span&gt;____________________________________________
Data
&lt;span class="w"&gt;  &lt;/span&gt;Reads&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;25&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s
&lt;span class="w"&gt;  &lt;/span&gt;Writes&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s
&lt;span class="w"&gt;  &lt;/span&gt;fsync&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s
&lt;span class="w"&gt;  &lt;/span&gt;Pending
&lt;span class="w"&gt;    &lt;/span&gt;Reads&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;Writes&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;fsync&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;

Pages
&lt;span class="w"&gt;  &lt;/span&gt;Created&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;/s
&lt;span class="w"&gt;  &lt;/span&gt;Read&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0/s
&lt;span class="w"&gt;  &lt;/span&gt;Written&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;/s

Rows
&lt;span class="w"&gt;  &lt;/span&gt;Deleted&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;/s
&lt;span class="w"&gt;  &lt;/span&gt;Inserted&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;/s
&lt;span class="w"&gt;  &lt;/span&gt;Read&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;/s
&lt;span class="w"&gt;  &lt;/span&gt;Updated&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;       &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;/s
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é¦–å…ˆåœ¨é¢„ç¼–è¯‘å‚æ•°ä¸Šè¿›è¡Œä¼˜åŒ–&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;./configure&lt;span class="w"&gt; &lt;/span&gt;--prefix&lt;span class="o"&gt;=&lt;/span&gt;/usr/local/mysql&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
--without-debug&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="w"&gt;                                &lt;/span&gt;&lt;span class="c1"&gt;# å–æ¶ˆè°ƒè¯•æ¨¡å¼æé«˜æ€§èƒ½&lt;/span&gt;
--with-extra-charsets&lt;span class="o"&gt;=&lt;/span&gt;utf8,gbk&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="w"&gt;                 &lt;/span&gt;&lt;span class="c1"&gt;# ä»…ä»…æŒ‡å®šéœ€è¦çš„é»˜è®¤å­—ç¬¦é›†æé«˜æ€§èƒ½&lt;/span&gt;
--enable-assembler&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="w"&gt;                             &lt;/span&gt;&lt;span class="c1"&gt;# ä½¿ç”¨æ±‡ç¼–æ¨¡å¼æé«˜æ€§èƒ½&lt;/span&gt;
--with-mysqld-ldflags&lt;span class="o"&gt;=&lt;/span&gt;-all-static&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="c1"&gt;# ä»¥é™æ€æ–¹å¼ç¼–è¯‘æé«˜æ€§èƒ½&lt;/span&gt;
--with-client-ldflags&lt;span class="o"&gt;=&lt;/span&gt;-all-static&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\&lt;/span&gt;
--with-unix-socket-path&lt;span class="o"&gt;=&lt;/span&gt;/tmp/mysql.sock&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="se"&gt;\ &lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# ä½¿ç”¨unix socketæé«˜æ€§èƒ½&lt;/span&gt;
--with-ssl
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…å®Œæˆåè¿›ä¸€æ­¥ä¼˜åŒ–my.cnf:
å› ä¸ºMySQL åªä¼š Cache ç´¢å¼•(*.MYI)ï¼Œå› æ­¤æ‚¨åªè¦å°†æ•°æ®åº“ä¸­æ‰€æœ‰çš„ MYI æ¡£æ¡ˆåŠ æ€»èµ·æ¥å°±æ˜¯key buffer çš„å€¼,è®¡ç®—MYIæ¡£æ¡ˆçš„æ€»å¤§å°:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;du&lt;span class="w"&gt; &lt;/span&gt;-hc&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;find&lt;span class="w"&gt; &lt;/span&gt;/usr/local/mysql/var/&lt;span class="w"&gt; &lt;/span&gt;-name&lt;span class="w"&gt; &lt;/span&gt;*.MYI&lt;span class="sb"&gt;`&lt;/span&gt;
&lt;span class="m"&gt;4&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/myblog/wp_term_taxonomy.MYI
&lt;span class="m"&gt;8&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/myblog/wp_posts.MYI
&lt;span class="m"&gt;8&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/myblog/wp_usermeta.MYI
&lt;span class="m"&gt;8&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/myblog/wp_commentmeta.MYI
16K&lt;span class="w"&gt;     &lt;/span&gt;/usr/local/mysql/var/myblog/wp_options.MYI
12K&lt;span class="w"&gt;     &lt;/span&gt;/usr/local/mysql/var/myblog/wp_postmeta.MYI
&lt;span class="m"&gt;8&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/myblog/wp_comments.MYI
&lt;span class="m"&gt;4&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/myblog/wp_links.MYI
&lt;span class="m"&gt;4&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/myblog/wp_term_relationships.MYI
&lt;span class="m"&gt;4&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/myblog/wp_users.MYI
&lt;span class="m"&gt;8&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/myblog/wp_terms.MYI
16K&lt;span class="w"&gt;     &lt;/span&gt;/usr/local/mysql/var/mysql/help_relation.MYI
&lt;span class="m"&gt;4&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/mysql/time_zone_name.MYI
16K&lt;span class="w"&gt;     &lt;/span&gt;/usr/local/mysql/var/mysql/help_keyword.MYI
&lt;span class="m"&gt;4&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/mysql/func.MYI
&lt;span class="m"&gt;4&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/mysql/time_zone.MYI
20K&lt;span class="w"&gt;     &lt;/span&gt;/usr/local/mysql/var/mysql/help_topic.MYI
&lt;span class="m"&gt;4&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/mysql/columns_priv.MYI
&lt;span class="m"&gt;4&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/mysql/procs_priv.MYI
&lt;span class="m"&gt;4&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/mysql/time_zone_leap_second.MYI
&lt;span class="m"&gt;4&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/mysql/user.MYI
&lt;span class="m"&gt;4&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/mysql/tables_priv.MYI
&lt;span class="m"&gt;4&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/mysql/host.MYI
&lt;span class="m"&gt;4&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/mysql/time_zone_transition_type.MYI
&lt;span class="m"&gt;4&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/mysql/proc.MYI
&lt;span class="m"&gt;4&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/mysql/help_category.MYI
&lt;span class="m"&gt;4&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/mysql/db.MYI
&lt;span class="m"&gt;4&lt;/span&gt;.0K&lt;span class="w"&gt;    &lt;/span&gt;/usr/local/mysql/var/mysql/time_zone_transition.MYI
192K&lt;span class="w"&gt;    &lt;/span&gt;total
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¿®æ”¹my.cnfå‚æ•°å¤§å°:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/etc/my.cnf
&lt;span class="c1"&gt;# é™ä½key_bufferçš„å€¼&lt;/span&gt;
&lt;span class="nv"&gt;key_buffer&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;4M
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é‡å¯MySQLæ‰§è¡Œtopå‘½ä»¤:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="m"&gt;18125&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;mysql&lt;span class="w"&gt;     &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;109m&lt;span class="w"&gt;  &lt;/span&gt;11m&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2152&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;S&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;.0&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;.1&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;0&lt;/span&gt;:00.08&lt;span class="w"&gt; &lt;/span&gt;mysqld
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;çœ‹åˆ°MySQLçš„å†…å­˜åˆ©ç”¨ç‡é™ä½åˆ°1.1,è¿™æ—¶å€™è¿˜ä¸é€‚å®œæ‰§è¡ŒmysqlreportæŸ¥çœ‹ç­‰å¾…å¯åŠ¨ä¸€å¤©åæŸ¥çœ‹.ç”±äºç°åœ¨è®¿é—®é‡è¾ƒä½,æ‰€ä»¥å‚æ•°é€‚é‡è°ƒä½,éœ€è¦å®æ—¶ç›‘æ§MySQLè¿è¡ŒçŠ¶å†µé€‚å½“è¿è¡Œå‚æ•°.&lt;/p&gt;</content><category term="Linux"></category><category term="ç¼–è¯‘å‚æ•°"></category><category term="ä¼˜åŒ–"></category><category term="mysqlé…ç½®æ–‡ä»¶"></category><category term="MySQLæœåŠ¡"></category><category term="MySQL"></category><category term="my.cnf"></category></entry><entry><title>ç”¨pxeå®‰è£…è‡ªå·±å®šåˆ¶çš„å‘è¡Œç‰ˆå¿«é€Ÿéƒ¨ç½²ç³»ç»Ÿç¯å¢ƒ</title><link href="https://www.linuxzen.com/yong-pxean-zhuang-zi-ji-ding-zhi-de-fa-xing-ban-kuai-su-bu-shu-xi-tong-huan-jing.html" rel="alternate"></link><published>2012-02-02T11:37:00+08:00</published><updated>2012-02-02T11:37:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-02-02:/yong-pxean-zhuang-zi-ji-ding-zhi-de-fa-xing-ban-kuai-su-bu-shu-xi-tong-huan-jing.html</id><summary type="html">&lt;p&gt;è‡ªå·±çš„å‘è¡Œç‰ˆå‡ºæ¥ä¹‹åå¦‚ä½•å¿«é€Ÿåº”ç”¨åˆ°ä¼ä¸šä¸­,å¯ä»¥ä½¿ç”¨PXEç½‘ç»œå®‰è£…å®ç°æ— äººå€¼å®ˆå®‰è£…. å…ˆè§£é‡Šä¸‹PXEå®‰è£…,è¿™æ˜¯ç”±Intelå¼€å‘çš„ä¸€é¡¹æŠ€æœ¯,æ”¯æŒé€šè¿‡ç½‘ç»œä»è¿œç¨‹æœåŠ¡å™¨ä¸‹è½½å¯åŠ¨ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;è‡ªå·±çš„å‘è¡Œç‰ˆå‡ºæ¥ä¹‹åå¦‚ä½•å¿«é€Ÿåº”ç”¨åˆ°ä¼ä¸šä¸­,å¯ä»¥ä½¿ç”¨PXEç½‘ç»œå®‰è£…å®ç°æ— äººå€¼å®ˆå®‰è£…. å…ˆè§£é‡Šä¸‹PXEå®‰è£…,è¿™æ˜¯ç”±Intelå¼€å‘çš„ä¸€é¡¹æŠ€æœ¯,æ”¯æŒé€šè¿‡ç½‘ç»œä»è¿œç¨‹æœåŠ¡å™¨ä¸‹è½½å¯åŠ¨æ–‡ä»¶ç³»ç»Ÿæœ¬æœº,ä»è€Œå®ç°ç½‘ç»œå®‰è£…æ“ä½œç³»ç»Ÿ.&lt;/p&gt;
&lt;p&gt;è¿™é‡Œéœ€è¦ç½‘ç»œä¼ è¾“å°±éœ€è¦ip,æ‰€ä»¥éœ€è¦DHCPæœåŠ¡å™¨,ä¼ è¾“æ–‡ä»¶éœ€è¦ç®€å•çš„ä¼ è¾“åè®®å°±éœ€è¦tftpæœåŠ¡å™¨,å®‰è£…çš„è¿‡ç¨‹ä¸­éœ€è¦ä¼ è¾“å®‰è£…æ–‡ä»¶å°±éœ€è¦ä¸€ä¸ªæ–‡ä»¶æœåŠ¡å™¨(ftp/http/nfsç­‰)
åŸºæœ¬æµç¨‹å°±æ˜¯é€šè¿‡DHCPè·å–ipå¹¶è·å–ä¸‹ä¸€æ­¥çš„æœåŠ¡å™¨åœ°å€(ä¹Ÿå°±æ˜¯tftp),ç„¶åä¸‹è½½å¯åŠ¨æ–‡ä»¶,é€šè¿‡å¯åŠ¨æ–‡ä»¶è·å–æŒ‡å®šçš„ä¸‹ä¸€ä¸ªæœåŠ¡å™¨çš„åœ°å€(å®‰è£…æ–‡ä»¶çš„è¿œç¨‹è·¯å¾„)&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ç¯å¢ƒ:CentOS 5.5 32ä½&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨ç³»ç»Ÿ:æ ¹æ®CentOSå®šåˆ¶çš„å‘è¡Œç‰ˆColdOS 0.1 32ä½&lt;/p&gt;
&lt;p&gt;ip: é™æ€ip192.168.3.1&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡ä½¿ç”¨dhcpdåˆ†é…ip,ä½¿ç”¨tftp-serveræä¾›ä¸‹è½½å¯åŠ¨æ–‡ä»¶,apacheæä¾›ä¸‹è½½å®‰è£…æ–‡ä»¶
1.å®‰è£…é…ç½®tftp&lt;/p&gt;
&lt;p&gt;å®‰è£…tftp-server&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;tftp-server
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é…ç½®tftp-server,ç¼–è¾‘/etc/xinetd.d/tftp&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/etc/xinetd.d/tftp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¿®æ”¹é…ç½®æ–‡ä»¶&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;service&lt;span class="w"&gt; &lt;/span&gt;tftp
&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nv"&gt;socket_type&lt;/span&gt;&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;dgram
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nv"&gt;protocol&lt;/span&gt;&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;udp
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nb"&gt;wait&lt;/span&gt;&lt;span class="w"&gt;                    &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;yes
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nv"&gt;user&lt;/span&gt;&lt;span class="w"&gt;                    &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nv"&gt;server&lt;/span&gt;&lt;span class="w"&gt;                  &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/usr/sbin/in.tftpd
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nv"&gt;server_args&lt;/span&gt;&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-s&lt;span class="w"&gt; &lt;/span&gt;/tftpboot&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="c1"&gt;# æ ¹ç›®å½•&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nv"&gt;disable&lt;/span&gt;&lt;span class="w"&gt;                 &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;no&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="c1"&gt;# æŠŠyesæ”¹ä¸ºnoå¯åŠ¨tftp&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nv"&gt;per_source&lt;/span&gt;&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;11&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nv"&gt;cps&lt;/span&gt;&lt;span class="w"&gt;                     &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;100&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="nv"&gt;flags&lt;/span&gt;&lt;span class="w"&gt;                   &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;IPv4
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¯åŠ¨tftp&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;service&lt;span class="w"&gt; &lt;/span&gt;xinetd&lt;span class="w"&gt; &lt;/span&gt;restart
Stopping&lt;span class="w"&gt; &lt;/span&gt;xinetd:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;OK&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
Starting&lt;span class="w"&gt; &lt;/span&gt;xinetd:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;OK&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;2.åœ¨tftpæ ¹ç›®å½•ä¸‹åˆ›å»ºå¯åŠ¨æ–‡ä»¶ä¾›å®¢æˆ·ç«¯ä¸‹è½½:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# å¤åˆ¶ç½‘å¡å¯åŠ¨æ–‡ä»¶&lt;/span&gt;
cp&lt;span class="w"&gt; &lt;/span&gt;/usr/lib/syslinux/pxelinux.0&lt;span class="w"&gt; &lt;/span&gt;/tftpboot
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å°†å®‰è£…å…‰ç›˜ä¸Š/image/pxeboot/initrd.imgå’Œvmlinuxå¤åˆ¶åˆ°/tftpboot/ä¸­&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# æŒ‚è½½å…‰ç›˜&lt;/span&gt;
mount&lt;span class="w"&gt; &lt;/span&gt;/dev/hdc&lt;span class="w"&gt; &lt;/span&gt;/mnt
&lt;span class="c1"&gt;# å¤åˆ¶æ–‡ä»¶&lt;/span&gt;
cp&lt;span class="w"&gt; &lt;/span&gt;/mnt/isolinux/vmlinuz&lt;span class="w"&gt; &lt;/span&gt;/tftpboot/
cp&lt;span class="w"&gt; &lt;/span&gt;/mnt/isolinux/initrd.img&lt;span class="w"&gt; &lt;/span&gt;/tftpboot/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åˆ›å»ºpxeå¯åŠ¨èœå•:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# åˆ›å»ºå­˜æ”¾å¯åŠ¨èœå•çš„ç›®å½•&lt;/span&gt;
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/tftpboot
mkdir&lt;span class="w"&gt; &lt;/span&gt;pxelinux.cfg
&lt;span class="c1"&gt;# ä»å®‰è£…å…‰ç›˜å†…å¤åˆ¶å¯åŠ¨èœå•å‘½åä¸ºdefault&lt;/span&gt;
cp&lt;span class="w"&gt; &lt;/span&gt;/mnt/isolinux/isolinux.cfg&lt;span class="w"&gt; &lt;/span&gt;/tftpboot/pxelinux.cfg/default
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç¼–è¾‘å¯åŠ¨èœå•:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/tftpboot/pxelinux.cfg/default
default&lt;span class="w"&gt; &lt;/span&gt;ColdOS
prompt&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
timeout&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;600&lt;/span&gt;
label&lt;span class="w"&gt; &lt;/span&gt;ColdOS
&lt;span class="w"&gt;  &lt;/span&gt;kernel&lt;span class="w"&gt; &lt;/span&gt;vmlinuz
&lt;span class="w"&gt;  &lt;/span&gt;append&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;ks&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;http://192.168.3.1/cold/isolinux/ks.cfg&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;initrd&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;initrd.img&lt;span class="w"&gt; &lt;/span&gt;text&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# æŒ‡å®šksæ–‡ä»¶ä½ç½®&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;3.å®‰è£…é…ç½®dhcpæœåŠ¡å™¨
å®‰è£…&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;dhcp
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é…ç½®&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# åˆ›å»ºé…ç½®æ–‡ä»¶&lt;/span&gt;
cp&lt;span class="w"&gt; &lt;/span&gt;/usr/share/doc/dhcp-3.0.5/dhcpd.conf.sample&lt;span class="w"&gt; &lt;/span&gt;/etc/dhcpd.conf
&lt;span class="c1"&gt;# ç¼–è¾‘é…ç½®æ–‡ä»¶&lt;/span&gt;
vi&lt;span class="w"&gt; &lt;/span&gt;/etc/dhcpd.conf
&lt;span class="c1"&gt;# ä¿®æ”¹é…ç½®æ–‡ä»¶:&lt;/span&gt;
ddns-update-style&lt;span class="w"&gt; &lt;/span&gt;interim&lt;span class="p"&gt;;&lt;/span&gt;
ignore&lt;span class="w"&gt; &lt;/span&gt;client-updates&lt;span class="p"&gt;;&lt;/span&gt;
next-server&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.1&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="c1"&gt;# æŒ‡å®štftpæœåŠ¡å™¨&lt;/span&gt;
filename&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/pxelinux.0&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="c1"&gt;# æŒ‡å®šå¯åŠ¨æ–‡ä»¶&lt;/span&gt;

subnet&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.0&lt;span class="w"&gt; &lt;/span&gt;netmask&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;255&lt;/span&gt;.255.255.0&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;option&lt;span class="w"&gt; &lt;/span&gt;routers&lt;span class="w"&gt;                  &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.1&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;option&lt;span class="w"&gt; &lt;/span&gt;subnet-mask&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="m"&gt;255&lt;/span&gt;.255.255.0&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;option&lt;span class="w"&gt; &lt;/span&gt;nis-domain&lt;span class="w"&gt;               &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;domain.org&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;option&lt;span class="w"&gt; &lt;/span&gt;domain-name&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;domain.org&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;option&lt;span class="w"&gt; &lt;/span&gt;domain-name-servers&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.1.1&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;option&lt;span class="w"&gt; &lt;/span&gt;time-offset&lt;span class="w"&gt;              &lt;/span&gt;-18000&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="c1"&gt;# Eastern Standard Time&lt;/span&gt;

&lt;span class="w"&gt;        &lt;/span&gt;range&lt;span class="w"&gt; &lt;/span&gt;dynamic-bootp&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.128&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;192&lt;/span&gt;.168.3.254&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;default-lease-time&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;21600&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;        &lt;/span&gt;max-lease-time&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;43200&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="o"&gt;}&lt;/span&gt;
&lt;span class="c1"&gt;# å¯åŠ¨dhcpæœåŠ¡å™¨&lt;/span&gt;
service&lt;span class="w"&gt; &lt;/span&gt;dhcpd&lt;span class="w"&gt; &lt;/span&gt;start
Starting&lt;span class="w"&gt; &lt;/span&gt;dhcpd:&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;[&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;OK&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;4.å®‰è£…é…ç½®httpæœåŠ¡å™¨
å®‰è£…:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;httpd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é¦–å…ˆæŠŠå®‰è£…å…‰ç›˜é‡Œçš„å†…å®¹æ‹·åˆ°æœ¬åœ°æœåŠ¡å™¨ä¸Š:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# åˆ›å»ºç›®å½•&lt;/span&gt;
mkdir&lt;span class="w"&gt; &lt;/span&gt;-p&lt;span class="w"&gt; &lt;/span&gt;/pxe/cold/
&lt;span class="c1"&gt;# å¤åˆ¶æ–‡ä»¶&lt;/span&gt;
&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/mnt/&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;tar&lt;span class="w"&gt; &lt;/span&gt;-cf&lt;span class="w"&gt; &lt;/span&gt;-&lt;span class="w"&gt; &lt;/span&gt;.&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Â¦&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/pxe/cold&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&amp;amp;&lt;/span&gt;amp&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;tar&lt;span class="w"&gt; &lt;/span&gt;-xvf&lt;span class="w"&gt; &lt;/span&gt;-&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é…ç½®apache&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# ç¼–è¾‘é…ç½®æ–‡ä»¶:&lt;/span&gt;
vi&lt;span class="w"&gt; &lt;/span&gt;/etc/httpd/conf/httpd.conf
&lt;span class="c1"&gt;# æ›´æ”¹apacheæ ¹ç›®å½•(å°†é…ç½®æ–‡ä»¶ä¸­çš„ä¸¤å¤„/var/wwwæ”¹æˆ/pxe)&lt;/span&gt;
DocumentRoot&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/pxe&amp;quot;&lt;/span&gt;
&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;lt&lt;span class="p"&gt;;&lt;/span&gt;Directory&lt;span class="w"&gt; &lt;/span&gt;/&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;Options&lt;span class="w"&gt; &lt;/span&gt;FollowSymLinks
&lt;span class="w"&gt;    &lt;/span&gt;AllowOverride&lt;span class="w"&gt; &lt;/span&gt;None
&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;lt&lt;span class="p"&gt;;&lt;/span&gt;/Directory&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;lt&lt;span class="p"&gt;;&lt;/span&gt;Directory&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;/pxe&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="w"&gt;    &lt;/span&gt;Options&lt;span class="w"&gt; &lt;/span&gt;Indexes&lt;span class="w"&gt; &lt;/span&gt;FollowSymLinks
&lt;span class="w"&gt;    &lt;/span&gt;AllowOverride&lt;span class="w"&gt; &lt;/span&gt;None
&lt;span class="w"&gt;    &lt;/span&gt;Order&lt;span class="w"&gt; &lt;/span&gt;allow,deny
&lt;span class="w"&gt;    &lt;/span&gt;Allow&lt;span class="w"&gt; &lt;/span&gt;from&lt;span class="w"&gt; &lt;/span&gt;all
&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;lt&lt;span class="p"&gt;;&lt;/span&gt;/Directory&lt;span class="p"&gt;&amp;amp;&lt;/span&gt;gt&lt;span class="p"&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é…ç½®å®Œæˆåå¯åŠ¨apache&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;service&lt;span class="w"&gt; &lt;/span&gt;httpd&lt;span class="w"&gt; &lt;/span&gt;start
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;5.æ›´æ”¹ksæ–‡ä»¶(ksæ–‡ä»¶å¯åœ¨CentOSå›¾å½¢ç•Œé¢ä¸‹ç”¨kickstartç¨‹åºç›´æ¥ç”Ÿæˆ,è¿™é‡Œä¸åšä»‹ç»)&lt;/p&gt;
&lt;p&gt;å› ä¸ºç½‘ç»œå®‰è£…,åˆéœ€è¦éƒ¨ç½²cfengineçš„è¯,å°±éœ€è¦æ›´æ”¹cfengineçš„è·å–æ–¹å¼,é¦–å…ˆè¦å°†æ–‡ä»¶å¤¹æ‰“åŒ…:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/pxe/cold
tar&lt;span class="w"&gt; &lt;/span&gt;-cvf&lt;span class="w"&gt; &lt;/span&gt;cfengine.tar&lt;span class="w"&gt; &lt;/span&gt;cfengine/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åç¼–è¾‘ksæ–‡ä»¶&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# ç¼–è¾‘ksæ–‡ä»¶&lt;/span&gt;
vi&lt;span class="w"&gt; &lt;/span&gt;/pxe/cold/isolinux/ks.cfg
install
cdrom
lang&lt;span class="w"&gt; &lt;/span&gt;en_US.UTF-8
keyboard&lt;span class="w"&gt; &lt;/span&gt;us
rootpw&lt;span class="w"&gt; &lt;/span&gt;--iscrypted&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$1$OKNHES6P$tPdz9HxIp6&lt;/span&gt;.QUvulqxNwa.
firewall&lt;span class="w"&gt; &lt;/span&gt;--disable
authconfig&lt;span class="w"&gt; &lt;/span&gt;--enableshadow&lt;span class="w"&gt; &lt;/span&gt;--enablemd5
selinux&lt;span class="w"&gt; &lt;/span&gt;--disabled
timezone&lt;span class="w"&gt; &lt;/span&gt;--utc&lt;span class="w"&gt; &lt;/span&gt;Asia/Chongqing
bootloader&lt;span class="w"&gt; &lt;/span&gt;--location&lt;span class="o"&gt;=&lt;/span&gt;mbr&lt;span class="w"&gt; &lt;/span&gt;--driveorder&lt;span class="o"&gt;=&lt;/span&gt;sda
url&lt;span class="w"&gt; &lt;/span&gt;--url&lt;span class="w"&gt; &lt;/span&gt;http://192.168.3.1/cold/&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="c1"&gt;# æ·»åŠ æŒ‡å®šå®‰è£…æ–‡ä»¶çš„è¯­å¥&lt;/span&gt;
&lt;span class="c1"&gt;# The following is the partition information you requested&lt;/span&gt;
&lt;span class="c1"&gt;# Note that any partitions you deleted are not expressed&lt;/span&gt;
&lt;span class="c1"&gt;# here so unless you clear all partitions first, this is&lt;/span&gt;
&lt;span class="c1"&gt;# not guaranteed to work&lt;/span&gt;
clearpart&lt;span class="w"&gt; &lt;/span&gt;--linux&lt;span class="w"&gt; &lt;/span&gt;--drives&lt;span class="o"&gt;=&lt;/span&gt;sda
part&lt;span class="w"&gt; &lt;/span&gt;/&lt;span class="w"&gt; &lt;/span&gt;--fstype&lt;span class="w"&gt; &lt;/span&gt;ext3&lt;span class="w"&gt; &lt;/span&gt;--size&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;--grow&lt;span class="w"&gt; &lt;/span&gt;--maxsize&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;4096&lt;/span&gt;
part&lt;span class="w"&gt; &lt;/span&gt;/usr&lt;span class="w"&gt; &lt;/span&gt;--fstype&lt;span class="w"&gt; &lt;/span&gt;ext3&lt;span class="w"&gt; &lt;/span&gt;--size&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;--grow
part&lt;span class="w"&gt; &lt;/span&gt;swap&lt;span class="w"&gt; &lt;/span&gt;--size&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;--grow&lt;span class="w"&gt; &lt;/span&gt;--maxsize&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;512&lt;/span&gt;

%packages
@core
@useful
@cfengine

%post&lt;span class="w"&gt; &lt;/span&gt;--nochroot
mkdir&lt;span class="w"&gt; &lt;/span&gt;-p&lt;span class="w"&gt; &lt;/span&gt;/mnt/sysimage/var/cfengine/masterfiles
mkdir&lt;span class="w"&gt; &lt;/span&gt;-p&lt;span class="w"&gt; &lt;/span&gt;/mnt/sysimage/var/cfengine/inputs
mkdir&lt;span class="w"&gt; &lt;/span&gt;-p&lt;span class="w"&gt; &lt;/span&gt;/mnt/sysimage/var/cfengine/outputs
mkdir&lt;span class="w"&gt; &lt;/span&gt;-p&lt;span class="w"&gt; &lt;/span&gt;/mnt/sysimage/var/cfengine/bin

wget&lt;span class="w"&gt;  &lt;/span&gt;http://192.168.3.1/cold/cfengine.tar&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="c1"&gt;# æ›´æ”¹cfengineè·å–æ–¹å¼&lt;/span&gt;
tar&lt;span class="w"&gt; &lt;/span&gt;-xvf&lt;span class="w"&gt; &lt;/span&gt;cfengine.tar
cp&lt;span class="w"&gt; &lt;/span&gt;/cfengine/sbin/cf-*&lt;span class="w"&gt; &lt;/span&gt;/mnt/sysimage/var/cfengine/bin/
cp&lt;span class="w"&gt; &lt;/span&gt;-r&lt;span class="w"&gt; &lt;/span&gt;/cfengine&lt;span class="w"&gt; &lt;/span&gt;/mnt/sysimage/usr/local/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;6.æµ‹è¯•
å¼€å¯å¦ä¸€å°è®¾å¤‡æµ‹è¯•,æœºå™¨å¯åŠ¨æ—¶ä¸€èˆ¬æŒ‰F12å³å¯è¿›å…¥ç½‘å¡å¯åŠ¨.&lt;/p&gt;</content><category term="Linux"></category><category term="ç½‘ç»œå®‰è£…"></category><category term="ç½‘å¡å¯åŠ¨"></category><category term="æ— äººå€¼å®ˆ"></category><category term="pxe"></category><category term="Linux"></category><category term="cfengine"></category></entry><entry><title>å°†cfengineé›†æˆåˆ°è‡ªå·±å®šåˆ¶çš„å‘è¡Œç‰ˆ</title><link href="https://www.linuxzen.com/jiang-cfengineji-cheng-dao-zi-ji-ding-zhi-de-fa-xing-ban.html" rel="alternate"></link><published>2012-01-19T11:35:00+08:00</published><updated>2012-01-19T11:35:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-01-19:/jiang-cfengineji-cheng-dao-zi-ji-ding-zhi-de-fa-xing-ban.html</id><summary type="html">&lt;p&gt;ä¸Šä¸€ç¯‡æ–‡ç« ä»‹ç»å¦‚ä½•å®šåˆ¶è‡ªå·±çš„å‘è¡Œç‰ˆ,å¹¶ä¸”å®Œå…¨æ ¹æ®CentOSè¿›è¡Œå®šåˆ¶,æˆ‘ä»¬çœ‹åˆ°äº†ç”¨cfengineç®¡ç†Linuxç³»ç»Ÿçš„ä¼˜åŠ¿,å¦‚ä½•å¿«é€Ÿéƒ¨ç½²cfengineå‘¢,æˆ‘ä»¬æŠŠcfengineé›†æˆåˆ°è‡ªå·±çš„å®šåˆ¶çš„Linuxä¸­.
æœ¬æ–‡æ ¹æ®ç¼–è¯‘å¥½çš„ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;ä¸Šä¸€ç¯‡æ–‡ç« ä»‹ç»å¦‚ä½•å®šåˆ¶è‡ªå·±çš„å‘è¡Œç‰ˆ,å¹¶ä¸”å®Œå…¨æ ¹æ®CentOSè¿›è¡Œå®šåˆ¶,æˆ‘ä»¬çœ‹åˆ°äº†ç”¨cfengineç®¡ç†Linuxç³»ç»Ÿçš„ä¼˜åŠ¿,å¦‚ä½•å¿«é€Ÿéƒ¨ç½²cfengineå‘¢,æˆ‘ä»¬æŠŠcfengineé›†æˆåˆ°è‡ªå·±çš„å®šåˆ¶çš„Linuxä¸­.
æœ¬æ–‡æ ¹æ®ç¼–è¯‘å¥½çš„cfengineæ¥è¿›è¡Œå®šåˆ¶,å¤§å®¶éƒ½çŸ¥é“ç¼–è¯‘ä¹‹å‰ä¼šæœ‰å¾ˆå¤šä¾èµ–,æ‰€ä»¥æˆ‘ä»¬éœ€è¦å®‰è£…ç³»ç»Ÿçš„æ—¶å€™æŠŠä¾èµ–è£…å¥½,ç„¶åæŠŠç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶å¤åˆ¶åˆ°å½“å‰ç³»ç»Ÿä¸­.&lt;/p&gt;
&lt;p&gt;æœ¬æ–‡å®Œå…¨æ ¹æ®&lt;a title="æ ¹æ®CentOSå®šåˆ¶è‡ªå·±çš„å‘è¡Œç‰ˆ" href="/post/36" target="_blank"&gt;ä¸Šä¸€ç¯‡&lt;/a&gt;æ–‡ç« è€Œæ¥,æŒ‚è½½å…‰é©±å®‰è£…å·¥å…·ç­‰ç­‰è¿™é‡Œå°±ä¸ä»‹ç»äº†.&lt;/p&gt;
&lt;!--more--&gt;
&lt;p&gt;é¦–å…ˆ.è®°å½•cfengineä¾èµ–åŒ…çš„ä¾èµ–å…³ç³»,ç„¶åæŠŠè¿™äº›åŒ…å¤åˆ¶åˆ°å®šåˆ¶å‘è¡Œç‰ˆçš„ç›®å½•ä¸‹,cfengineæ‰€ä¾èµ–çš„åŒ…å¦‚ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# æŠŠä¾èµ–åŒ…æ·»åŠ åˆ°cfpkgs.list&lt;/span&gt;
vi&lt;span class="w"&gt; &lt;/span&gt;cfpkgs.list
&lt;span class="c1"&gt;# æ·»åŠ å¦‚ä¸‹å†…å®¹&lt;/span&gt;
keyutils-libs-devel
zlib-devel
e2fsprogs-devel
libsepol-devel
libselinux-devel
db4-devel
pcre-devel
krb5-devel
flex
openssl-devel
&lt;span class="c1"&gt;# ç„¶åæ ¹æ®cfpkgs.listæŠŠåŒ…å¤åˆ¶åˆ°å‘è¡Œç‰ˆçš„CentOSç›®å½•ä¸‹:&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;i&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;cat&lt;span class="w"&gt; &lt;/span&gt;cfpkgs.list&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;:&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;do&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;file&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;&lt;span class="nb"&gt;echo&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Â¦&lt;span class="w"&gt; &lt;/span&gt;sed&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;s/://g&amp;#39;&lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;cp&lt;span class="w"&gt; &lt;/span&gt;/mnt/CentOS/&lt;span class="nv"&gt;$file&lt;/span&gt;*&lt;span class="w"&gt; &lt;/span&gt;/usr/cold/CentOS/&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¤åˆ¶å®ŒåŒ…ä¹‹åå°±éœ€è¦ç¼–è¾‘comps.xml,&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/usr/cold/
&lt;span class="c1"&gt;# ç¼–è¾‘comps.xml&lt;/span&gt;
vi&lt;span class="w"&gt; &lt;/span&gt;repodata/comps.xml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å‘comps.xmlæ·»åŠ è¿™å‡ ä¸ªåŒ…groupèŠ‚ç‚¹&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="w"&gt;  &lt;/span&gt;&amp;lt;group&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;id&amp;gt;cfengine&amp;lt;/id&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;name&amp;gt;Cfengine&amp;lt;/name&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;name&lt;span class="w"&gt; &lt;/span&gt;xml:lang&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;en_GB&amp;quot;&lt;/span&gt;&amp;gt;Cfengine&amp;lt;/name&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;description&amp;gt;Cfengine&lt;span class="w"&gt; &lt;/span&gt;&amp;lt;/description&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;description&lt;span class="w"&gt; &lt;/span&gt;xml:lang&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;en_GB&amp;quot;&lt;/span&gt;&amp;gt;Cfengine&amp;lt;/description&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;default&amp;gt;true&amp;lt;/default&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;uservisible&amp;gt;false&amp;lt;/uservisible&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;packagelist&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;keyutils-libs-devel&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;zlib-devel&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;e2fsprogs-devel&lt;span class="w"&gt; &lt;/span&gt;&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;libsepol-devel&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;libselinux-devel&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;db4-devel&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;pcre-devel&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;krb5-devel&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;flex&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;openssl-devel&lt;span class="w"&gt; &lt;/span&gt;&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;/packagelist&amp;gt;
&lt;span class="w"&gt;  &lt;/span&gt;&amp;lt;/group&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åé€šè¿‡å‘½ä»¤åˆ›å»ºæº:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;createrepo&lt;span class="w"&gt; &lt;/span&gt;-g&lt;span class="w"&gt; &lt;/span&gt;repodata/comps.xml&lt;span class="w"&gt;  &lt;/span&gt;CentOS/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è®¡ç®—comps.xmlçš„shaå€¼&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;sha1sum&lt;span class="w"&gt; &lt;/span&gt;repodata/comps.xml
f6f086a3c2b7eee2050580aa3e74c841dd406dfc&lt;span class="w"&gt;  &lt;/span&gt;repodata/comps.xml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç¼–è¾‘repomd.xml&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;repodata/repomd.xml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å°†æ–°çš„shaå€¼æ›´æ–°åˆ°repomd.xml&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="w"&gt;  &lt;/span&gt;&amp;lt;data&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;group&amp;quot;&lt;/span&gt;&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;location&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;repodata/comps.xml&amp;quot;&lt;/span&gt;/&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;checksum&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;sha&amp;quot;&lt;/span&gt;&amp;gt;f6f086a3c2b7eee2050580aa3e74c841dd406dfc&amp;lt;/checksum&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;timestamp&amp;gt;1272586365&amp;lt;/timestamp&amp;gt;
&lt;span class="w"&gt;  &lt;/span&gt;&amp;lt;/data&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æ¥ä¸‹æ¥æŠŠæˆ‘ä»¬ç¼–è¯‘å¥½çš„cfengine(æ ¹æ®&lt;a title="å®‰è£…é…ç½®cfengineå®ç°è‡ªåŠ¨åŒ–é…ç½®Linux/UnixæœåŠ¡å™¨" href="/post/17" target="_blank"&gt;å®‰è£…é…ç½®cfengineå®ç°è‡ªåŠ¨åŒ–é…ç½®Linux/UnixæœåŠ¡å™¨&lt;/a&gt;)å¤åˆ¶åˆ°å®šåˆ¶çš„å‘è¡Œç‰ˆçš„ç›®å½•ä¸‹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;cp&lt;span class="w"&gt; &lt;/span&gt;-r&lt;span class="w"&gt; &lt;/span&gt;/usr/local/cfengine/&lt;span class="w"&gt; &lt;/span&gt;/usr/cold/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åç¼–è¾‘ksæ–‡ä»¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;isolinux/ks.cfg
&lt;span class="c1"&gt;# åœ¨æœ«å°¾æ·»åŠ å¦‚ä¸‹å†…å®¹&lt;/span&gt;
%packages
@core
@useful
@cfengine&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# æ·»åŠ cfengineè½¯ä»¶ç»„&lt;/span&gt;
&lt;span class="c1"&gt;# %postæ˜¯å®‰è£…åæ‰§è¡Œçš„è„šæœ¬,&lt;/span&gt;
&lt;span class="c1"&gt;# è¿˜æœ‰ä¸€ç§æ ‡è®° %preæ˜¯å®‰è£…å‰æ‰§è¡Œçš„è„šæœ¬,ä½†ä¸æ¨èä½¿ç”¨è¿™ç§è„šæœ¬,&lt;/span&gt;
&lt;span class="c1"&gt;# å› ä¸ºè„šæœ¬å‡ºé”™ä¼šå¯¼è‡´å®‰è£…å¤±è´¥&lt;/span&gt;
&lt;span class="c1"&gt;# --nochrootæ˜¯ä¸åˆ‡æ¢æ ¹ç›®å½•,è¿™æ—¶å€™å®‰è£…å¥½çš„ç³»ç»Ÿä¼šæŒ‚è½½åœ¨ /mnt/sysimageä¸‹&lt;/span&gt;
%post&lt;span class="w"&gt; &lt;/span&gt;--nochroot

&lt;span class="c1"&gt;# åˆ›å»ºcfengineçš„å·¥ä½œç›®å½•&lt;/span&gt;
mkdir&lt;span class="w"&gt; &lt;/span&gt;-p&lt;span class="w"&gt; &lt;/span&gt;/mnt/sysimage/var/cfengine/masterfiles
mkdir&lt;span class="w"&gt; &lt;/span&gt;-p&lt;span class="w"&gt; &lt;/span&gt;/mnt/sysimage/var/cfengine/inputs
mkdir&lt;span class="w"&gt; &lt;/span&gt;-p&lt;span class="w"&gt; &lt;/span&gt;/mnt/sysimage/var/cfengine/outputs
mkdir&lt;span class="w"&gt; &lt;/span&gt;-p&lt;span class="w"&gt; &lt;/span&gt;/mnt/sysimage/var/cfengine/bin
mkdir&lt;span class="w"&gt; &lt;/span&gt;/a
mount&lt;span class="w"&gt; &lt;/span&gt;/tmp/cdrom&lt;span class="w"&gt; &lt;/span&gt;/a
&lt;span class="c1"&gt;# å¤åˆ¶äºŒè¿›åˆ¶æ–‡ä»¶å’Œcfengine&lt;/span&gt;
cp&lt;span class="w"&gt; &lt;/span&gt;/a/cfengine/sbin/cf-*&lt;span class="w"&gt; &lt;/span&gt;/mnt/sysimage/var/cfengine/bin/
cp&lt;span class="w"&gt; &lt;/span&gt;-r&lt;span class="w"&gt; &lt;/span&gt;/a/cfengine&lt;span class="w"&gt; &lt;/span&gt;/mnt/sysimage/usr/local/
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶ååˆ¶ä½œé•œåƒ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mkisofs&lt;span class="w"&gt; &lt;/span&gt;-R&lt;span class="w"&gt; &lt;/span&gt;-J&lt;span class="w"&gt; &lt;/span&gt;-T&lt;span class="w"&gt; &lt;/span&gt;-r&lt;span class="w"&gt; &lt;/span&gt;-l&lt;span class="w"&gt; &lt;/span&gt;-d&lt;span class="w"&gt; &lt;/span&gt;-allow-multidot&lt;span class="w"&gt; &lt;/span&gt;-allow-leading-dots&lt;span class="w"&gt; &lt;/span&gt;-no-bak&lt;span class="w"&gt; &lt;/span&gt;-o&lt;span class="w"&gt; &lt;/span&gt;/usr/ColdOS-0.1-i386.iso&lt;span class="w"&gt; &lt;/span&gt;-b&lt;span class="w"&gt; &lt;/span&gt;isolinux/isolinux.bin&lt;span class="w"&gt; &lt;/span&gt;-c&lt;span class="w"&gt; &lt;/span&gt;isolinux/boot.cat&lt;span class="w"&gt; &lt;/span&gt;-no-emul-boot&lt;span class="w"&gt; &lt;/span&gt;-boot-load-size&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-boot-info-table&lt;span class="w"&gt; &lt;/span&gt;.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæŠŠé•œåƒä¸‹è½½ä¸‹æ¥è¿›è¡Œå®‰è£…,å®‰è£…å®Œæˆåæ‰§è¡Œ&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;/var/cfengine/bin/cf-key&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="c1"&gt;# ç”Ÿæˆè®¤è¯è¯ä¹¦&lt;/span&gt;
/var/cfengine/bin/cf-agent&lt;span class="w"&gt; &lt;/span&gt;--bootstrap&lt;span class="w"&gt; &lt;/span&gt;--policy-server&lt;span class="w"&gt; &lt;/span&gt;cfhubip
/var/cfengine/bin/cf-agent&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="c1"&gt;# æ‰§è¡Œæ‰¿è¯º&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å³å¯ä»cfhubipé‚£é‡Œä¸‹è½½æ‰¿è¯ºæ–‡ä»¶æ‰§è¡Œæ‰¿è¯º,æ ¹æ®cfhubè¿›è¡Œæœ¬åœ°é…ç½®
è¿˜å¯ä»¥æ ¹æ®%postæ›´åŠ è‡ªç”±çš„å®šåˆ¶è‡ªå·±çš„ç³»ç»Ÿ,æ¯”å¦‚æœ€å°åŒ–å®‰è£…åä¼šæ— æ³•ä½¿ç”¨æœ¬åœ°é•œåƒæ¥ä½¿ç”¨yumå¯ä»¥å®šä¹‰ä¸€ä¸ªå±€åŸŸç½‘yum,åœ¨%post --nochrootæ·»åŠ å¦‚ä¸‹å†…å®¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;cat&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;&amp;lt;&amp;lt;__EOF__ &amp;gt; /mnt/sysimage/etc/yum.repos.d/CentOS-Media.repo&lt;/span&gt;
&lt;span class="s"&gt;# CentOS-Media.repo&lt;/span&gt;
&lt;span class="s"&gt;#  yum --disablerepo=\* --enablerepo=cold [command]&lt;/span&gt;
&lt;span class="s"&gt;[cold]&lt;/span&gt;
&lt;span class="s"&gt;name=CentOS-$releasever - Media&lt;/span&gt;
&lt;span class="s"&gt;baseurl=http://192.168.0.254/CentOS&lt;/span&gt;
&lt;span class="s"&gt;gpgcheck=1&lt;/span&gt;
&lt;span class="s"&gt;enabled=1&lt;/span&gt;
&lt;span class="s"&gt;gpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-CentOS-5&lt;/span&gt;
&lt;span class="s"&gt;__EOF__&lt;/span&gt;

mv&lt;span class="w"&gt; &lt;/span&gt;/mnt/sysimage/etc/yum.repos.d/CentOS-Base.repo&lt;span class="w"&gt; &lt;/span&gt;/mnt/sysimage/etc/yum.repos.d/CentOS-Base.repo.bak
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;è¿™é‡Œå°±ä¸è¯¦ç»†ä»‹ç»,å¤§å®¶å¯æ ¹æ®è¿™ä¸ªæ›´åŠ è‡ªç”±çš„æ¥å®šåˆ¶è‡ªå·±çš„Linuxå‘è¡Œç‰ˆ.&lt;/p&gt;</content><category term="Linux"></category><category term="é›†æˆ"></category><category term="å®šåˆ¶"></category><category term="å‘è¡Œç‰ˆ"></category><category term="Linux"></category><category term="cfengine"></category></entry><entry><title>æ ¹æ®CentOSå®šåˆ¶è‡ªå·±çš„å‘è¡Œç‰ˆ</title><link href="https://www.linuxzen.com/gen-ju-centosding-zhi-zi-ji-de-fa-xing-ban.html" rel="alternate"></link><published>2012-01-18T11:13:00+08:00</published><updated>2012-01-18T11:13:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-01-18:/gen-ju-centosding-zhi-zi-ji-de-fa-xing-ban.html</id><summary type="html">&lt;p&gt;æœ¬æ–‡ä½¿ç”¨çš„ç¯å¢ƒä¸ºCentOS5.5 32ä½.
é¦–å…ˆè¦åšçš„æ˜¯æœ€å°åŒ–å®‰è£…CentOS,å°±æ˜¯å®‰è£…è¿‡ç¨‹ä¸­é€‰æ‹©è¦å®‰è£…åŒ…çš„æ—¶å€™ä½¿ç”¨è‡ªå®šä¹‰,ç„¶åå»é™¤æ‰€æœ‰ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;æœ¬æ–‡ä½¿ç”¨çš„ç¯å¢ƒä¸ºCentOS5.5 32ä½.
é¦–å…ˆè¦åšçš„æ˜¯æœ€å°åŒ–å®‰è£…CentOS,å°±æ˜¯å®‰è£…è¿‡ç¨‹ä¸­é€‰æ‹©è¦å®‰è£…åŒ…çš„æ—¶å€™ä½¿ç”¨è‡ªå®šä¹‰,ç„¶åå»é™¤æ‰€æœ‰è¦å®‰è£…çš„åŒ…,ç³»ç»Ÿå°±ä¼šé»˜è®¤æœ€å°åŒ–å®‰è£…ç³»ç»Ÿ.
è£…å®Œç³»ç»Ÿä¼šå†rootçš„æ ¹ç›®å½•ä¸‹ç”Ÿæˆ3ä¸ªæ–‡ä»¶,æˆ‘ä»¬ç”¨åˆ°ä¸¤ä¸ª:
anaconda-ks.cfg : kisckstartè„šæœ¬,è®°å½•å®‰è£…è¿‡ç¨‹çš„é…ç½®,åŒ…æ‹¬é€‰æ‹©è¯­è¨€,é€‰æ‹©é”®ç›˜,åˆ†åŒº,rootå¯†ç ç­‰ç­‰ç­‰ç­‰
install.logÂ Â Â Â Â Â Â Â Â Â Â  : è®°å½•å®‰è£…è¿‡ç¨‹ä¸­æ‰€å®‰è£…çš„åŒ…
æˆ‘ä»¬é¦–å…ˆè¦åšçš„å°±æ˜¯å»ºç«‹æˆ‘ä»¬çš„è‡ªå·±å‘è¡Œç‰ˆçš„ç›®å½•,åœ¨ä¸€ä¸ªå‰©ä½™å¤§å°å¤§äº4Gçš„åˆ†åŒºåˆ›å»ºè‡ªå·±å‘è¡Œç‰ˆçš„ç›®å½•,æ¯”å¦‚æˆ‘çš„å‘è¡Œç‰ˆå«ColdOS,ç„¶åæŒ‚è½½DVDå…‰ç›˜,æŠŠå…‰ç›˜ä¸Šçš„å†…å®¹å¤åˆ¶åˆ°è‡ªå·±å‘è¡Œç‰ˆçš„ç›®å½•:&lt;!--more--&gt;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mkdir&lt;span class="w"&gt; &lt;/span&gt;/usr/cold&lt;span class="w"&gt;                 &lt;/span&gt;&lt;span class="c1"&gt;# åˆ›å»ºå‘è¡Œç‰ˆç›®å½•&lt;/span&gt;
mount&lt;span class="w"&gt; &lt;/span&gt;/dev/hdc&lt;span class="w"&gt; &lt;/span&gt;/mnt&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="c1"&gt;# æŒ‚è½½IDEå…‰é©±&lt;/span&gt;
&lt;span class="c1"&gt;# æˆ–&lt;/span&gt;
mount&lt;span class="w"&gt; &lt;/span&gt;/dev/cdrom&lt;span class="w"&gt; &lt;/span&gt;/mnt
&lt;span class="c1"&gt;# å¦‚æŒ‚è½½æœ¬åœ°ISOé•œåƒä½¿ç”¨ä¸‹é¢å‘½ä»¤&lt;/span&gt;
mount&lt;span class="w"&gt; &lt;/span&gt;-o&lt;span class="w"&gt; &lt;/span&gt;loop&lt;span class="w"&gt; &lt;/span&gt;isoè·¯å¾„&lt;span class="w"&gt; &lt;/span&gt;/mnt

&lt;span class="c1"&gt;# ç„¶åä½¿ç”¨ tarå‘½ä»¤æŠŠå…‰ç›˜çš„å†…å®¹å¤åˆ¶åˆ°/usr/cold&lt;/span&gt;
&lt;span class="c1"&gt;# éƒ½è¯´è¿™ä¸ªå‘½ä»¤æ¯”cpå¿«,åœ¨256å†…å­˜çš„è™šæ‹Ÿæœºæµ‹è¯•ä¹Ÿå°±å¿«äº†å‡ åç§’,ä¸ªäººè§‰å¾—æœ€å¤§çš„ç”¨å¤„&lt;/span&gt;
&lt;span class="c1"&gt;# å°±æ˜¯è§£å†³äº†cpæ— æ³•å¤åˆ¶éšè—æ–‡ä»¶çš„é—®é¢˜&lt;/span&gt;
&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/mnt/&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;tar&lt;span class="w"&gt; &lt;/span&gt;-cf&lt;span class="w"&gt; &lt;/span&gt;-&lt;span class="w"&gt; &lt;/span&gt;.&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Â¦&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/usr/cold&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;tar&lt;span class="w"&gt; &lt;/span&gt;-xvfp&lt;span class="w"&gt; &lt;/span&gt;-&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="c1"&gt;# tar -pé€‰é¡¹æ˜¯ä¿ç•™åŸæœ‰æƒé™&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¤åˆ¶å®Œæˆåå‘è¡Œç‰ˆç›®å½•åº”è¯¥æ˜¯:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ls&lt;span class="w"&gt; &lt;/span&gt;-la&lt;span class="w"&gt; &lt;/span&gt;/usr/cold
total&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;511&lt;/span&gt;
drwxr-xr-x&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;7&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;6144&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;.
drwxr-xr-x&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;21&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;4096&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Dec&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;18&lt;/span&gt;:07&lt;span class="w"&gt; &lt;/span&gt;..
drwxrwxr-x&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;501&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;501&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;421888&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;CentOS
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;112&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;.discinfo
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;212&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Jun&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;15&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2008&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;EULA
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;18009&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Jun&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;15&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2008&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;GPL
drwxr-xr-x&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;2048&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;images
drwxr-xr-x&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;2048&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;isolinux
drwxr-xr-x&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;22528&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;27&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;NOTES
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;655&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;27&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RELEASE-NOTES-cs
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;1401&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;27&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RELEASE-NOTES-cs.html
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;839&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;27&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RELEASE-NOTES-de
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;1571&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;27&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RELEASE-NOTES-de.html
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;694&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;27&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RELEASE-NOTES-en
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;1367&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;27&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RELEASE-NOTES-en.html
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;694&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;27&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RELEASE-NOTES-en_US
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;1367&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;27&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RELEASE-NOTES-en_US.html
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;788&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;27&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RELEASE-NOTES-es
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;1619&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;27&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RELEASE-NOTES-es.html
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;852&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;27&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RELEASE-NOTES-fr
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;1641&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;27&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RELEASE-NOTES-fr.html
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;766&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;27&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RELEASE-NOTES-ja
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;1565&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;27&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RELEASE-NOTES-ja.html
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;706&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;27&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RELEASE-NOTES-nl
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;1433&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;27&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RELEASE-NOTES-nl.html
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;752&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;27&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RELEASE-NOTES-pt_BR
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;1480&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;27&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RELEASE-NOTES-pt_BR.html
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;801&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;27&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RELEASE-NOTES-ro
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;1473&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;27&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RELEASE-NOTES-ro.html
drwxr-xr-x&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;2048&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;repodata
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;1512&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Jun&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;15&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2008&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RPM-GPG-KEY-beta
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;1504&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Jun&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;15&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2008&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;RPM-GPG-KEY-CentOS-5
-r--r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;7048&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;TRANS.TBL
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;413&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;.treeinfo
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç°åœ¨å¯¹ç³»ç»Ÿè¿›è¡Œç²¾ç®€:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;rm&lt;span class="w"&gt; &lt;/span&gt;-f&lt;span class="w"&gt; &lt;/span&gt;RELEASE-NOTES-*
&lt;span class="w"&gt; &lt;/span&gt;rm&lt;span class="w"&gt; &lt;/span&gt;-rf&lt;span class="w"&gt; &lt;/span&gt;NOTES/
rm&lt;span class="w"&gt; &lt;/span&gt;-f&lt;span class="w"&gt; &lt;/span&gt;RPM-GPG-KEY-*
rm&lt;span class="w"&gt; &lt;/span&gt;-f&lt;span class="w"&gt; &lt;/span&gt;EULA
rm&lt;span class="w"&gt; &lt;/span&gt;-f&lt;span class="w"&gt; &lt;/span&gt;GPL
rm&lt;span class="w"&gt; &lt;/span&gt;-f&lt;span class="w"&gt; &lt;/span&gt;CentOS/*&lt;span class="w"&gt;                          &lt;/span&gt;&lt;span class="c1"&gt;# åˆ é™¤æ‰€æœ‰rpmåŒ…,ç­‰ä¼šæ ¹æ®install.logå¤åˆ¶è¿‡æ¥,ä¿è¯ç³»ç»Ÿæœ€å°åŒ–&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç²¾ç®€å®Œååº”è¯¥æ˜¯è¿™æ ·å­çš„:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;s&lt;span class="w"&gt; &lt;/span&gt;-la&lt;span class="w"&gt; &lt;/span&gt;/usr/cold/
total&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt;
drwxr-xr-x&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;6&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;4096&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Dec&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;19&lt;/span&gt;:39&lt;span class="w"&gt; &lt;/span&gt;.
drwxr-xr-x&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;16&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;4096&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Dec&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;23&lt;/span&gt;:14&lt;span class="w"&gt; &lt;/span&gt;..
drwxrwxr-x&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;501&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;501&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;172032&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Dec&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;14&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;02&lt;/span&gt;:23&lt;span class="w"&gt; &lt;/span&gt;CentOS
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;112&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;.discinfo
drwxr-xr-x&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;4096&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;images
drwxr-xr-x&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;4096&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Dec&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;14&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;00&lt;/span&gt;:36&lt;span class="w"&gt; &lt;/span&gt;isolinux
drwxr-xr-x&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;4096&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Dec&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;14&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;01&lt;/span&gt;:42&lt;span class="w"&gt; &lt;/span&gt;repodata
-r--r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;   &lt;/span&gt;&lt;span class="m"&gt;7048&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;TRANS.TBL
-rw-r--r--&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="m"&gt;413&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Apr&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;30&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2010&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;.treeinfo
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç°åœ¨æ ¹æ®install.logåˆ›å»ºpackages.list,ç”¨æ¥å®‰è£…æ‰€éœ€è¦çš„rpmåŒ…:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# æ ¹æ®install.log,æå–å…¶ä¸­çš„rpmåŒ…å,&lt;/span&gt;
cat&lt;span class="w"&gt; &lt;/span&gt;install.log&lt;span class="w"&gt; &lt;/span&gt;Â¦&lt;span class="w"&gt; &lt;/span&gt;grep&lt;span class="w"&gt; &lt;/span&gt;Installing&lt;span class="w"&gt; &lt;/span&gt;Â¦&lt;span class="w"&gt; &lt;/span&gt;awk&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;{print $2}&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Â¦&lt;span class="w"&gt; &lt;/span&gt;awk&lt;span class="w"&gt; &lt;/span&gt;-F&lt;span class="s1"&gt;&amp;#39;:&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;{ if (NF==2){ print $2} else {print $1}}&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;packages.list
&lt;span class="c1"&gt;# å¦‚æœä»…ä»…æœ€å°åŒ–å®‰è£…å°±å¤±å»äº†å®šåˆ¶è‡ªå·±çš„å‘è¡Œç‰ˆçš„æ„ä¹‰&lt;/span&gt;
&lt;span class="c1"&gt;# å‘packages.listæ·»åŠ å‡ ä¸ªå¸¸ç”¨çš„å·¥å…·,éœ€è¦å…ˆç”¨yumå®‰è£…ä¸€éè®°ä½åŒ…çš„ä¾èµ–å…³ç³»&lt;/span&gt;
&lt;span class="c1"&gt;# æŠŠä¾èµ–å…³ç³»çš„åŒ…ä¹Ÿæ”¾å…¥packages.list&lt;/span&gt;
&lt;span class="c1"&gt;# æ¯”å¦‚manä¾èµ–bzip2 groff&lt;/span&gt;
vi&lt;span class="w"&gt; &lt;/span&gt;packages.list
&lt;span class="c1"&gt;# æœ«å°¾æ·»åŠ å¦‚ä¸‹å†…å®¹:&lt;/span&gt;
setuptool
lszrz&lt;span class="w"&gt; &lt;/span&gt;wget
kernel-devel
kernel-headers
libgomp
cpp
glibc-headers
glibc-devel
gcc
make
which
bzip2
groff
man
&lt;span class="c1"&gt;# æ ¹æ®packages.listè¿›è¡Œå¤åˆ¶&lt;/span&gt;
&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;i&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;in&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;cat&lt;span class="w"&gt; &lt;/span&gt;packages.list&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="sb"&gt;`&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="k"&gt;do&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;cp&lt;span class="w"&gt; &lt;/span&gt;-p&lt;span class="w"&gt; &lt;/span&gt;-f&lt;span class="w"&gt;  &lt;/span&gt;/mnt/CentOS/&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="nv"&gt;$i&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;*&lt;span class="w"&gt; &lt;/span&gt;/usr/cold/CentOS/&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="k"&gt;done&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¤åˆ¶å®Œæ‰€éœ€çš„RPMåŒ…ä¹‹åæˆ‘ä»¬å¦‚ä½•æ¥è®©ç³»ç»Ÿå®‰è£…çš„æ—¶å€™å®‰è£…æˆ‘ä»¬è‡ªå®šä¹‰æ·»åŠ çš„åŒ…å‘¢?
é¦–å…ˆæˆ‘ä»¬éœ€è¦ç¼–è¾‘repodata/comps.xml,ä½†æ˜¯comps.xmlæ–‡ä»¶å†…å®¹å¤ªæ‚,å¤§æ¦‚ 2ä¸‡å¤šè¡Œ,æ‰€ä»¥æˆ‘ä»¬éœ€è¦å¯¹comps.xmlè¿›è¡Œä¸€ä¸ªé¢„å¤„ç†:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# comps.xmlåŒ…å«æœ€å¤šçš„æ˜¯å„å›½è¯­è¨€&lt;/span&gt;
&lt;span class="c1"&gt;# æˆ‘ä»¬å…ˆå»é™¤ä¸éœ€è¦çš„è¯­è¨€,è¿™é‡Œæˆ‘åªéœ€è¦è‹±æ–‡,&lt;/span&gt;
sed&lt;span class="w"&gt; &lt;/span&gt;-ri&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s1"&gt;&amp;#39;/xml:lang/ {/en_GB/!d}&amp;#39;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;comps.xml&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# å¦‚æœéœ€è¦ä¿ç•™å…¶ä»–è¯­è¨€æ¯”å¦‚ä¸­æ–‡,åœ¨en_GBåæ·»åŠ &amp;quot;Â¦zh_CN&amp;quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å»é™¤äº†å„å›½è¯­è¨€çš„comps.xmlå¤§æ¦‚åŒ…å«2000å¤šè¡Œ,ç°åœ¨æˆ‘ä»¬è¦è¿›ä¸€æ­¥å¤„ç†,åˆ é™¤é™¤äº†idä¸ºcoreçš„groupçš„å…¶ä»–èŠ‚ç‚¹,åˆ é™¤å®Œåcomps.xmlå¤§æ¦‚åªå‰©ä¸‹73è¡Œ.ç°åœ¨æˆ‘ä»¬è¦æŠŠæˆ‘ä»¬è‡ªå·±æ·»åŠ çš„åŒ…é¡¶ä¸€ä¸ªgroupèŠ‚ç‚¹,åœ¨ç´§è·Ÿidä¸ºcoreçš„groupèŠ‚ç‚¹(ä¹Ÿå°±æ˜¯&lt;code&gt;&amp;lt;/group&amp;gt;&lt;/code&gt;åé¢)æ·»åŠ å¦‚ä¸‹å†…å®¹:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&amp;lt;group&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;id&amp;gt;useful&amp;lt;/id&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;name&amp;gt;Useful&amp;lt;/name&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;name&lt;span class="w"&gt; &lt;/span&gt;xml:lang&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;en_GB&amp;quot;&lt;/span&gt;&amp;gt;Useful&amp;lt;/name&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;description&amp;gt;Useful&lt;span class="w"&gt; &lt;/span&gt;tools&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;administartor&lt;span class="w"&gt; &lt;/span&gt;&amp;lt;/description&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;description&lt;span class="w"&gt; &lt;/span&gt;xml:lang&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;en_GB&amp;quot;&lt;/span&gt;&amp;gt;Useful&lt;span class="w"&gt; &lt;/span&gt;tools&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="k"&gt;for&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;administartor&amp;lt;/description&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;default&amp;gt;true&amp;lt;/default&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;uservisible&amp;gt;false&amp;lt;/uservisible&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;packagelist&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;setuptool&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;lszrz&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;wget&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;kernel-headers&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;libgomp&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;cpp&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;glibc-headers&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;glibc-devel&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;gcc&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;make&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;which&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;bzip2&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;groff&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;packagereq&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;default&amp;quot;&lt;/span&gt;&amp;gt;man&amp;lt;/packagereq&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;/packagelist&amp;gt;
&lt;span class="w"&gt;  &lt;/span&gt;&amp;lt;/group&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸Šé¢æ·»åŠ äº†ä¸€ä¸ªidä¸ºusefulçš„groupèŠ‚ç‚¹,ä¸‹é¢æŠŠè¿™ä¸¤ä¸ªèŠ‚ç‚¹æ”¾åˆ°ä¸€ä¸ªç±»åˆ«é‡Œ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="w"&gt;  &lt;/span&gt;&amp;lt;category&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;id&amp;gt;cold&amp;lt;/id&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;name&amp;gt;Cold&amp;lt;/name&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;name&lt;span class="w"&gt; &lt;/span&gt;xml:lang&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;en_GB&amp;quot;&lt;/span&gt;&amp;gt;Cold&amp;lt;/name&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;description&amp;gt;Cold&lt;span class="w"&gt; &lt;/span&gt;Linux&amp;lt;/description&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;description&lt;span class="w"&gt; &lt;/span&gt;xml:lang&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;en_GB&amp;quot;&lt;/span&gt;&amp;gt;Cold&lt;span class="w"&gt; &lt;/span&gt;Linux&amp;lt;/description&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;display_order&amp;gt;92&amp;lt;/display_order&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;grouplist&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;groupid&amp;gt;core&amp;lt;/groupid&amp;gt;
&lt;span class="w"&gt;      &lt;/span&gt;&amp;lt;groupid&amp;gt;useful&amp;lt;/groupid&amp;gt;
&lt;span class="w"&gt;     &lt;/span&gt;&amp;lt;/grouplist&amp;gt;
&lt;span class="w"&gt;  &lt;/span&gt;&amp;lt;/category&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæ ¹æ®æˆ‘ä»¬çš„comps.xmlåˆ›å»ºæº:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# å®‰è£…æ‰€éœ€è¦çš„å·¥å…·&lt;/span&gt;
yum&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;createrepo&lt;span class="w"&gt; &lt;/span&gt;anaconda&lt;span class="w"&gt; &lt;/span&gt;anaconda-runtime
&lt;span class="c1"&gt;# åˆ›å»ºæº&lt;/span&gt;
createrepo&lt;span class="w"&gt; &lt;/span&gt;-g&lt;span class="w"&gt; &lt;/span&gt;/usr/cold/repodata/comps.xml&lt;span class="w"&gt; &lt;/span&gt;/usr/cold/CentOS
&lt;span class="c1"&gt;# å®Œæˆåä¼šæœ‰å¦‚ä¸‹æç¤º:&lt;/span&gt;
&lt;span class="m"&gt;224&lt;/span&gt;/224&lt;span class="w"&gt; &lt;/span&gt;-&lt;span class="w"&gt; &lt;/span&gt;kudzu-1.2.57.1.24-1.el5.centos.i386.rpm
Saving&lt;span class="w"&gt; &lt;/span&gt;Primary&lt;span class="w"&gt; &lt;/span&gt;metadata
Saving&lt;span class="w"&gt; &lt;/span&gt;file&lt;span class="w"&gt; &lt;/span&gt;lists&lt;span class="w"&gt; &lt;/span&gt;metadata
Saving&lt;span class="w"&gt; &lt;/span&gt;other&lt;span class="w"&gt; &lt;/span&gt;metadata
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç”±äºæˆ‘ä»¬ç¼–è¾‘äº†comps.xml,æ‰€ä»¥comps.xmlçš„shaå€¼ä¼šæ”¹å˜,è¿™æ ·å°±ä¼šå¯¼è‡´è·Ÿrepomd.xmlä¸­æ‰€è®°å½•çš„ä¸åŒ,å®‰è£…çš„æ—¶å€™ä¼šæŠ¥é”™:An error occurred umounting the CD. Please make sure you'are not accessingÂ  /mnt/source from the shell on tty2 an the click OK retry.
æ‰€ä»¥æˆ‘ä»¬æ›´æ”¹å®Œcomps.xmlè¦è®¡ç®—comps.xmlçš„shaå€¼&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# è®¡ç®—comps.xmlçš„shaå€¼&lt;/span&gt;
sha1sum&lt;span class="w"&gt; &lt;/span&gt;repodata/comps.xml
c1d304cae50f969370a72d95e3cd2f71087fc73a&lt;span class="w"&gt;  &lt;/span&gt;repodata/comps.xml
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæ›´æ–°åˆ°repomd.xmlä¸­ç¼–è¾‘repodata/repomd.xmlæ‰¾åˆ°location href="repodata/comps.xml"/çš„ä¸€ä¸ªdataèŠ‚ç‚¹æŠŠshaå€¼æ›´æ–°ä¸ºåˆšåˆšè®¡ç®—çš„&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&amp;lt;data&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;group&amp;quot;&lt;/span&gt;&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;location&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;href&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;repodata/comps.xml&amp;quot;&lt;/span&gt;/&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;checksum&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;type&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;sha&amp;quot;&lt;/span&gt;&amp;gt;c1d304cae50f969370a72d95e3cd2f71087fc73a&amp;lt;/checksum&amp;gt;
&lt;span class="w"&gt;    &lt;/span&gt;&amp;lt;timestamp&amp;gt;1272586365&amp;lt;/timestamp&amp;gt;
&lt;span class="w"&gt;  &lt;/span&gt;&amp;lt;/data&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;comps.xmlé‡Œæ–°åŠ äº†ä¸€ä¸ªå’±ä»¬çš„useful ç»„,æ€ä¹ˆä½¿ç³»ç»Ÿå®‰è£…æˆ‘ä»¬å®šä¹‰çš„åŒ…å‘¢?æ€ä¹ˆè‡ªå®šä¹‰å®‰è£…è¿‡ç¨‹å‘¢?ä¸‹é¢å°†è®²è§£æ ¹æ®anaconda-ks.cfgæ–‡ä»¶å®šä¹‰å®‰è£…è¿‡ç¨‹:
é¦–å…ˆå¤åˆ¶anaconda-ks.cfgåˆ°æˆ‘ä»¬çš„å‘è¡Œç‰ˆç›®å½•:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;cp&lt;span class="w"&gt; &lt;/span&gt;~/anaconda-ks.cfg&lt;span class="w"&gt; &lt;/span&gt;/usr/cold/isolinux/ks.cfg&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="c1"&gt;# å¤åˆ¶åˆ°isolinuxä¸‹å¹¶å‘½åä¸ºks.cfg&lt;/span&gt;
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/usr/cold
&lt;span class="c1"&gt;# ç¼–è¾‘kickstartè„šæœ¬&lt;/span&gt;
vi&lt;span class="w"&gt; &lt;/span&gt;isolinux/ks.cfg
install&lt;span class="w"&gt;                            &lt;/span&gt;&lt;span class="c1"&gt;# å®šä¹‰å®‰è£…&lt;/span&gt;
cdrom&lt;span class="w"&gt;                              &lt;/span&gt;&lt;span class="c1"&gt;# ä»å…‰ç›˜å®‰è£…&lt;/span&gt;
lang&lt;span class="w"&gt; &lt;/span&gt;en_US.UTF-8&lt;span class="w"&gt;                   &lt;/span&gt;&lt;span class="c1"&gt;# å®‰è£…è¯­è¨€ä¸ºè‹±æ–‡&lt;/span&gt;
keyboard&lt;span class="w"&gt; &lt;/span&gt;us&lt;span class="w"&gt;                        &lt;/span&gt;&lt;span class="c1"&gt;# å®šä¹‰é”®ç›˜å¸ƒå±€&lt;/span&gt;
rootpw&lt;span class="w"&gt; &lt;/span&gt;--iscrypted&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;$1$OKNHES6P$tPdz9HxIp6&lt;/span&gt;.QUvulqxNwa.&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="c1"&gt;# å®šä¹‰rootå¯†ç (ä½ å®‰è£…çš„æ—¶å€™æä¾›çš„å¯†ç )&lt;/span&gt;
firewall&lt;span class="w"&gt; &lt;/span&gt;--disable&lt;span class="w"&gt;                                                                                    &lt;/span&gt;&lt;span class="c1"&gt;# ç¦ç”¨é˜²ç«å¢™&lt;/span&gt;
authconfig&lt;span class="w"&gt; &lt;/span&gt;--enableshadow&lt;span class="w"&gt; &lt;/span&gt;--enablemd5&lt;span class="w"&gt;                                              &lt;/span&gt;&lt;span class="c1"&gt;# ä½¿ç”¨md5åŠ å¯†&lt;/span&gt;
selinux&lt;span class="w"&gt; &lt;/span&gt;--disabled&lt;span class="w"&gt;                                                                                   &lt;/span&gt;&lt;span class="c1"&gt;# ç¦ç”¨selinux&lt;/span&gt;
timezone&lt;span class="w"&gt; &lt;/span&gt;--utc&lt;span class="w"&gt; &lt;/span&gt;Asia/Chongqing&lt;span class="w"&gt;                                                              &lt;/span&gt;&lt;span class="c1"&gt;# å®šä¹‰æ—¶åŒº&lt;/span&gt;
bootloader&lt;span class="w"&gt; &lt;/span&gt;--location&lt;span class="o"&gt;=&lt;/span&gt;mbr&lt;span class="w"&gt; &lt;/span&gt;--driveorder&lt;span class="o"&gt;=&lt;/span&gt;sda&lt;span class="w"&gt;                                           &lt;/span&gt;&lt;span class="c1"&gt;# åœ¨ä¸€å—ç¡¬ç›˜ä¸Šå®‰è£…mbr&lt;/span&gt;
&lt;span class="c1"&gt;# The following is the partition information you requested&lt;/span&gt;
&lt;span class="c1"&gt;# Note that any partitions you deleted are not expressed&lt;/span&gt;
&lt;span class="c1"&gt;# here so unless you clear all partitions first, this is&lt;/span&gt;
&lt;span class="c1"&gt;# not guaranteed to work&lt;/span&gt;
&lt;span class="c1"&gt;# å¦‚æœæƒ³å®‰è£…è¿‡ç¨‹ä¸­æ‰‹åŠ¨åˆ†åŒºå°±æŠŠä¸‹é¢å‡ è¡Œæ³¨é‡Šæ‰&lt;/span&gt;
clearpart&lt;span class="w"&gt; &lt;/span&gt;--linux&lt;span class="w"&gt; &lt;/span&gt;--drives&lt;span class="o"&gt;=&lt;/span&gt;sda&lt;span class="w"&gt;                       &lt;/span&gt;&lt;span class="c1"&gt;# æ ¼å¼åŒ–sda&lt;/span&gt;
part&lt;span class="w"&gt; &lt;/span&gt;/&lt;span class="w"&gt; &lt;/span&gt;--fstype&lt;span class="w"&gt; &lt;/span&gt;ext3&lt;span class="w"&gt; &lt;/span&gt;--size&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;--grow&lt;span class="w"&gt; &lt;/span&gt;--maxsize&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;4096&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# åˆ›å»º/åˆ†åŒºå¤§å°ä¸º4ä¸ªG&lt;/span&gt;
part&lt;span class="w"&gt; &lt;/span&gt;/usr&lt;span class="w"&gt; &lt;/span&gt;--fstype&lt;span class="w"&gt; &lt;/span&gt;ext3&lt;span class="w"&gt; &lt;/span&gt;--size&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;--grow&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="c1"&gt;# åˆ›å»º/usråˆ†åŒº,å¤§å°ä¸ºå‰©ä½™ç©ºé—´&lt;/span&gt;
part&lt;span class="w"&gt; &lt;/span&gt;swap&lt;span class="w"&gt; &lt;/span&gt;--size&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;--grow&lt;span class="w"&gt; &lt;/span&gt;--maxsize&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;512&lt;/span&gt;&lt;span class="w"&gt;              &lt;/span&gt;&lt;span class="c1"&gt;# åˆ›å»ºswapå¤§å°ä¸º512M&lt;/span&gt;

%packages&lt;span class="w"&gt;                                            &lt;/span&gt;&lt;span class="c1"&gt;# å®šä¹‰å®‰è£…æ—¶å®‰è£…çš„åŒ…&lt;/span&gt;
@core&lt;span class="w"&gt;                                                &lt;/span&gt;&lt;span class="c1"&gt;# æœ€å°åŒ–å®‰è£…çš„åŒ…&lt;/span&gt;
@useful&lt;span class="w"&gt;                                              &lt;/span&gt;&lt;span class="c1"&gt;# è‡ªå®šä¹‰çš„åŒ…&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åå°±è¦ä¿®æ”¹é…ç½®æ–‡ä»¶ä½¿å®‰è£…æ—¶ä½¿ç”¨ks.cfgçš„é…ç½®æ¥å®‰è£…,ä¿®æ”¹isolinux.cfg:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;isolinux/isolinux.cfg
default&lt;span class="w"&gt; &lt;/span&gt;linux&lt;span class="w"&gt;                                 &lt;/span&gt;&lt;span class="c1"&gt;# é»˜è®¤å¯åŠ¨çš„label&lt;/span&gt;
prompt&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
timeout&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;10&lt;/span&gt;&lt;span class="w"&gt;                                    &lt;/span&gt;&lt;span class="c1"&gt;# ç­‰å¾…æ—¶é—´ä¸º1ç§’é’Ÿ&lt;/span&gt;
display&lt;span class="w"&gt; &lt;/span&gt;boot.msg
F1&lt;span class="w"&gt; &lt;/span&gt;boot.msg
F2&lt;span class="w"&gt; &lt;/span&gt;options.msg
F3&lt;span class="w"&gt; &lt;/span&gt;general.msg
F4&lt;span class="w"&gt; &lt;/span&gt;param.msg
F5&lt;span class="w"&gt; &lt;/span&gt;rescue.msg
label&lt;span class="w"&gt; &lt;/span&gt;linux
&lt;span class="w"&gt;  &lt;/span&gt;kernel&lt;span class="w"&gt; &lt;/span&gt;vmlinuz
&lt;span class="w"&gt;  &lt;/span&gt;append&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;ks&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;cdrom:/isolinux/ks.cfg&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;initrd&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;initrd.img&lt;span class="w"&gt; &lt;/span&gt;text&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="c1"&gt;#ä¿®æ”¹é»˜è®¤linuxçš„label,ksä½¿ç”¨è‡ªå®šä¹‰çš„ks,å¹¶æ–‡æœ¬å¯åŠ¨&lt;/span&gt;
label&lt;span class="w"&gt; &lt;/span&gt;text
&lt;span class="w"&gt;  &lt;/span&gt;kernel&lt;span class="w"&gt; &lt;/span&gt;vmlinuz
&lt;span class="w"&gt;  &lt;/span&gt;append&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;initrd&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;initrd.img&lt;span class="w"&gt; &lt;/span&gt;text
label&lt;span class="w"&gt; &lt;/span&gt;ks
&lt;span class="w"&gt;  &lt;/span&gt;kernel&lt;span class="w"&gt; &lt;/span&gt;vmlinuz
&lt;span class="w"&gt;  &lt;/span&gt;append&lt;span class="w"&gt; &lt;/span&gt;ks&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;initrd&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;initrd.img
label&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;local&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;localboot&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;
label&lt;span class="w"&gt; &lt;/span&gt;memtest86
&lt;span class="w"&gt;  &lt;/span&gt;kernel&lt;span class="w"&gt; &lt;/span&gt;memtest
&lt;span class="w"&gt;  &lt;/span&gt;append&lt;span class="w"&gt; &lt;/span&gt;-
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åˆ°è¿™é‡Œé…ç½®å°±åŸºæœ¬å®Œæˆ,ä¸‹é¢å°±æ˜¯åˆ¶ä½œisoé•œåƒè¿›è¡Œå®‰è£…æµ‹è¯•:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c1"&gt;# é¦–å…ˆå®‰è£…å·¥å…·&lt;/span&gt;
yum&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;mkisofs
&lt;span class="c1"&gt;# åˆ›å»ºisoé•œåƒ:&lt;/span&gt;
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;/usr/cold
mkisofs&lt;span class="w"&gt; &lt;/span&gt;-R&lt;span class="w"&gt; &lt;/span&gt;-J&lt;span class="w"&gt; &lt;/span&gt;-T&lt;span class="w"&gt; &lt;/span&gt;-r&lt;span class="w"&gt; &lt;/span&gt;-l&lt;span class="w"&gt; &lt;/span&gt;-d&lt;span class="w"&gt; &lt;/span&gt;-allow-multidot&lt;span class="w"&gt; &lt;/span&gt;-allow-leading-dots&lt;span class="w"&gt; &lt;/span&gt;-no-bak&lt;span class="w"&gt; &lt;/span&gt;-o&lt;span class="w"&gt; &lt;/span&gt;/usr/ColdOS-0.1-i386.iso&lt;span class="w"&gt; &lt;/span&gt;-b&lt;span class="w"&gt; &lt;/span&gt;isolinux/isolinux.bin&lt;span class="w"&gt;  &lt;/span&gt;-c&lt;span class="w"&gt; &lt;/span&gt;isolinux/boot.cat&lt;span class="w"&gt; &lt;/span&gt;-no-emul-boot&lt;span class="w"&gt; &lt;/span&gt;-boot-load-size&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-boot-info-table&lt;span class="w"&gt; &lt;/span&gt;.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åå°±å¯ä»¥æŠŠé•œåƒä¸‹è½½ä¸‹æ¥è¿›è¡Œå®‰è£…æµ‹è¯•äº†...ä¸‹ä¸€ç¯‡å°±ä¼šä»‹ç»å¦‚ä½•æŠŠä¹‹å‰ä¸€ç¯‡æ–‡ç« ä»‹ç»çš„cfengineé›†æˆåˆ°è‡ªå·±çš„å‘è¡Œç‰ˆ&lt;/p&gt;</content><category term="Linux"></category><category term="å®šåˆ¶"></category><category term="mkisofs"></category><category term="createrepo"></category><category term="comps.xml"></category><category term="CentOS"></category></entry><entry><title>å®‰è£…é…ç½®cfengineå®ç°è‡ªåŠ¨åŒ–é…ç½®Linux/UnixæœåŠ¡å™¨</title><link href="https://www.linuxzen.com/an-zhuang-pei-zhi-cfengineshi-xian-zi-dong-hua-pei-zhi-linuxunixfu-wu-qi.html" rel="alternate"></link><published>2012-01-17T23:06:00+08:00</published><updated>2012-01-17T23:06:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-01-17:/an-zhuang-pei-zhi-cfengineshi-xian-zi-dong-hua-pei-zhi-linuxunixfu-wu-qi.html</id><summary type="html">&lt;p&gt;cfengineï¼ˆé…ç½®å¼•æ“ï¼‰æ˜¯ä¸€ç§ UNIX ç®¡ç†å·¥å…·ï¼Œå…¶ç›®çš„æ˜¯ä½¿ç®€å•çš„ç®¡ç†çš„ä»»åŠ¡è‡ªåŠ¨åŒ–ï¼Œä½¿å›°éš¾çš„ä»»åŠ¡å˜å¾—è¾ƒå®¹æ˜“ã€‚Cfengine é€‚ç”¨äºç®¡ç†å„ç§ç¯å¢ƒ â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;cfengineï¼ˆé…ç½®å¼•æ“ï¼‰æ˜¯ä¸€ç§ UNIX ç®¡ç†å·¥å…·ï¼Œå…¶ç›®çš„æ˜¯ä½¿ç®€å•çš„ç®¡ç†çš„ä»»åŠ¡è‡ªåŠ¨åŒ–ï¼Œä½¿å›°éš¾çš„ä»»åŠ¡å˜å¾—è¾ƒå®¹æ˜“ã€‚Cfengine é€‚ç”¨äºç®¡ç†å„ç§ç¯å¢ƒï¼Œä»ä¸€å°ä¸»æœºåˆ°ä¸Šä¸‡å°ä¸»æœºçš„æœºç¾¤å‡å¯ä½¿ç”¨. cfengineçš„ç‰ˆæœ¬2å’Œç‰ˆæœ¬3å­˜åœ¨å¾ˆå¤§å·®å¼‚,è¿™é‡Œä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„cfengine3:&lt;/p&gt;
&lt;p&gt;cfengineæ‰§è¡Œå’Œåˆ†å‘çš„ç­–ç•¥è¢«ç§°ä¸ºæ‰¿è¯º,cfengineå»ºè®®çš„ç»“æ„æ˜¯:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ä¸€ä¸ªç‰ˆæœ¬æ§åˆ¶å™¨(subversion)ç”¨æ¥åˆ›å»ºç­–ç•¥&lt;/li&gt;
&lt;li&gt;å¤šä¸ªç­–ç•¥åˆ†å‘å™¨(cfenginehub)ç”¨æ¥åˆ†å‘ç­–ç•¥----server&lt;/li&gt;
&lt;li&gt;å¤šä¸ªç­–ç•¥æ‰§è¡Œå™¨(cfengine host)ç”¨æ¥æ‰§è¡Œç­–ç•¥-----client,&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;æœ¬æ–‡ä½¿ç”¨çš„ç¯å¢ƒä¸º:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;cfhub: 172.16.1.1/24&lt;/li&gt;
&lt;li&gt;cfhost: 172.16.1.2/24&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç³»ç»Ÿä¸ºCentOS 5.5 32ä½æœ€å°åŒ–å®‰è£…,æœ¬æ–‡å°†ä¸ä¼šè§£é‡Šä¸€äº›åŸºæœ¬å‘½ä»¤,å¦‚æœ‰ç–‘é—®è¯·ç§»æ­¥google.&lt;/p&gt;
&lt;p&gt;ä¸‹è½½:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;wget&lt;span class="w"&gt; &lt;/span&gt;https://cfengine.com/source-code/download?file&lt;span class="o"&gt;=&lt;/span&gt;cfengine-3.2.3.tar.gz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å®‰è£…ä¾èµ–:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;yum&lt;span class="w"&gt; &lt;/span&gt;-y&lt;span class="w"&gt; &lt;/span&gt;install&lt;span class="w"&gt; &lt;/span&gt;db4-devel&lt;span class="w"&gt; &lt;/span&gt;pcre-devel&lt;span class="w"&gt; &lt;/span&gt;openssl-devel&lt;span class="w"&gt; &lt;/span&gt;flex
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç¼–è¯‘å®‰è£…:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;tar&lt;span class="w"&gt; &lt;/span&gt;-zxvf&lt;span class="w"&gt; &lt;/span&gt;download&lt;span class="se"&gt;\?&lt;/span&gt;file&lt;span class="se"&gt;\=&lt;/span&gt;cfengine-3.2.3.tar.gz
&lt;span class="nb"&gt;cd&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;cfengine-3.2.3/
./configure&lt;span class="w"&gt; &lt;/span&gt;--prefix&lt;span class="o"&gt;=&lt;/span&gt;/usr/local/cfengine
make&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;&amp;amp;&amp;amp;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;make&lt;span class="w"&gt; &lt;/span&gt;install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸ºäº†ä¿è¯cfengineæ­£å¸¸å·¥ä½œåˆ›å»ºcfengineå·¥ä½œç›®å½•:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;mkdir&lt;span class="w"&gt; &lt;/span&gt;-p&lt;span class="w"&gt; &lt;/span&gt;/var/cfengine/masterfiles&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="c1"&gt;# å­˜æ”¾è¦åˆ†å‘çš„æ‰¿è¯º&lt;/span&gt;
mkdir&lt;span class="w"&gt; &lt;/span&gt;/var/cfengine/inputs&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="c1"&gt;# å­˜æ”¾è¦æ‰§è¡Œçš„æ‰¿è¯º&lt;/span&gt;
mkdir&lt;span class="w"&gt; &lt;/span&gt;/var/cfengine/outputs&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="c1"&gt;# å­˜æ”¾æ‰§è¡Œæ‰¿è¯ºçš„è¾“å‡º&lt;/span&gt;
mkdir&lt;span class="w"&gt; &lt;/span&gt;/var/cfengine/bin&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="c1"&gt;# å­˜æ”¾äºŒè¿›åˆ¶æ–‡ä»¶&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¤åˆ¶äºŒè¿›åˆ¶æ–‡ä»¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;cp&lt;span class="w"&gt; &lt;/span&gt;/usr/local/cfengine/sbin/cf-*&lt;span class="w"&gt; &lt;/span&gt;/var/cfengine/bin/
ls&lt;span class="w"&gt; &lt;/span&gt;-l&lt;span class="w"&gt; &lt;/span&gt;/var/cfengine/bin/
total&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;964&lt;/span&gt;
-rwxr-xr-x&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;235958&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Jan&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;cf-agent&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="c1"&gt;# æ‰§è¡Œæ‰¿è¯º&lt;/span&gt;
-rwxr-xr-x&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;63095&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Jan&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;cf-execd&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="c1"&gt;# ç”¨äºæ›¿ä»£cronçš„ç¨‹åº,å®šæ—¶æ‰§è¡Œcf-agent&lt;/span&gt;
-rwxr-xr-x&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;39076&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Jan&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;cf-key&lt;span class="w"&gt;             &lt;/span&gt;&lt;span class="c1"&gt;# ç”Ÿæˆç”¨äºè®¤è¯çš„è¯ä¹¦&lt;/span&gt;
-rwxr-xr-x&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;78711&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Jan&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;cf-know&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="c1"&gt;# ä»å¤§é‡æ‰¿è¯ºï¼ˆçŸ¥è¯†å»ºæ¨¡ä»£ç†ï¼‰ç”Ÿæˆä¸€ä¸ª ISO æ ‡å‡†çš„ Topic Map çš„å‘½ä»¤&lt;/span&gt;
-rwxr-xr-x&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;150846&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Jan&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;cf-monitord&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# è´Ÿè´£æ”¶é›†æœ‰å…³ç³»ç»ŸçŠ¶æ€ä¿¡æ¯çš„å®ˆæŠ¤è¿›ç¨‹&lt;/span&gt;
-rwxr-xr-x&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;16078&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Jan&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;cf-promises&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# æ£€æŸ¥æ‰¿è¯ºè¯­æ³•çš„ç¨‹åº&lt;/span&gt;
-rwxr-xr-x&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;107349&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Jan&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;cf-report&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="c1"&gt;# ç”ŸæˆæŠ¥å‘Š&lt;/span&gt;
-rwxr-xr-x&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;44160&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Jan&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;cf-runagent&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# ç”¨æ¥æ‰§è¡Œè¿œç¨‹çš„cf-agent&lt;/span&gt;
-rwxr-xr-x&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;root&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;172251&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;Jan&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;13&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="m"&gt;2012&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;cf-serverd&lt;span class="w"&gt;         &lt;/span&gt;&lt;span class="c1"&gt;# åˆ†å‘æ‰¿è¯ºçš„å®ˆæŠ¤è¿›ç¨‹&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸€ä¸ªcfengineçš„hello, world:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/var/cfengine/inputs/test.cf&lt;span class="w"&gt;                                               &lt;/span&gt;&lt;span class="c1"&gt;# æ–°å»ºä¸€ä¸ªæ‰¿è¯ºæ–‡ä»¶,æ·»åŠ ä¸‹é¢å†…å®¹&lt;/span&gt;
&lt;span class="c1"&gt;###################&lt;/span&gt;
&lt;span class="c1"&gt;# è¿™é‡Œé¡ºä¾¿è§£é‡Šä¸€ä¸‹cfengineçš„è¯­æ³•,cfengineçš„è¯­æ³•å¤§éƒ½å¦‚ä¸‹&lt;/span&gt;
&lt;span class="c1"&gt;# &amp;lt;å®ƒæ˜¯ä»€ä¹ˆ&amp;gt; &amp;lt;å®ƒå¯¹ä»€ä¹ˆèµ·ä½œç”¨&amp;gt; &amp;lt;å®ƒå«ä»€ä¹ˆ&amp;gt;&lt;/span&gt;
body&lt;span class="w"&gt; &lt;/span&gt;common&lt;span class="w"&gt; &lt;/span&gt;control&lt;span class="w"&gt;                                   &lt;/span&gt;&lt;span class="c1"&gt;# ä¸€ä¸ªbody å¯¹commonç»„å¯ä½œç”¨,åå­—æ˜¯control(åå­—ä¸ºcontrolçš„commonçš„ç»„æ˜¯æœ€é‡è¦çš„ä¸€ä¸ªç»„,cfengineä»¥è¿™ä¸ªç»„ä¸ºèµ·ç‚¹&lt;/span&gt;
&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="nv"&gt;bundlesequence&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;test&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;                         &lt;/span&gt;&lt;span class="c1"&gt;# å®šä¹‰è¦æ‰§è¡Œçš„æ‰¿è¯ºæŸä¸ºtest&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

bundle&lt;span class="w"&gt; &lt;/span&gt;agent&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;test&lt;/span&gt;&lt;span class="w"&gt;                                     &lt;/span&gt;&lt;span class="c1"&gt;# ä¸€ä¸ªæ‰¿è¯ºæŸ,å¯¹cf-agentèµ·ä½œç”¨,å«test&lt;/span&gt;
&lt;span class="o"&gt;{&lt;/span&gt;
reports:&lt;span class="w"&gt;                                              &lt;/span&gt;&lt;span class="c1"&gt;# ä¸€ä¸ªæŠ¥å‘Š(ä»…ä»…æ˜¾ç¤ºæ¶ˆæ¯,ä¸å¯¹ç³»ç»Ÿåšæ”¹å˜)&lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;cfengine_3::&lt;span class="w"&gt;                                        &lt;/span&gt;&lt;span class="c1"&gt;# ä¸€ä¸ªç±»,å¯¹cfengine ç‰ˆæœ¬3çš„ç­–ç•¥æ‰§è¡Œç‚¹èµ·ä½œç”¨(cfengineç”¨è¿™ä¸ªæ¥æ›¿ä»£ç¨‹åºè¯­è¨€é‡Œçš„if-else)&lt;/span&gt;
&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Hello world!&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;                                 &lt;/span&gt;&lt;span class="c1"&gt;# æ‰¿è¯ºå†…å®¹,æ˜¾ç¤º&amp;quot;hello world!&amp;quot;&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;

/var/cfengine/bin/cf-promises&lt;span class="w"&gt; &lt;/span&gt;-f&lt;span class="w"&gt; &lt;/span&gt;/var/cfengine/inputs/test.cf&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="c1"&gt;# æ£€æŸ¥æ‰¿è¯ºè¯­æ³•&lt;/span&gt;
/var/cfengine/bin/cf-agent&lt;span class="w"&gt; &lt;/span&gt;-f&lt;span class="w"&gt; &lt;/span&gt;/var/cfengine/inputs/test.cf&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="c1"&gt;# æ‰§è¡Œæ‰¿è¯º&lt;/span&gt;
R:&lt;span class="w"&gt; &lt;/span&gt;Hello&lt;span class="w"&gt; &lt;/span&gt;world!&lt;span class="w"&gt;                                                      &lt;/span&gt;&lt;span class="c1"&gt;# R:ä»£è¡¨ä¸€ä¸ªreport.&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ä¸ºç­–ç•¥åˆ†å‘ç‚¹åˆ›å»ºé…ç½®æ–‡ä»¶:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;cp&lt;span class="w"&gt; &lt;/span&gt;/usr/local/cfengine/share/cfengine/masterfiles/*&lt;span class="w"&gt; &lt;/span&gt;/var/cfengine/masterfile
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç¼–è¾‘ç­–ç•¥æ–‡ä»¶:
æ–°å»ºä¸€ä¸ªcftest1.cfæ‰¿è¯ºæ–‡ä»¶&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/var/cfengine/masterfiles/cftest1.cf&lt;span class="w"&gt;                  &lt;/span&gt;&lt;span class="c1"&gt;# æ–°å»ºä¸€ä¸ªcftest1.cf&lt;/span&gt;
&lt;span class="c1"&gt;# æ·»åŠ å¦‚ä¸‹å†…å®¹:&lt;/span&gt;
bundle&lt;span class="w"&gt; &lt;/span&gt;agent&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nb"&gt;test&lt;/span&gt;
&lt;span class="o"&gt;{&lt;/span&gt;
reports:
&lt;span class="w"&gt;  &lt;/span&gt;cfengine_3::
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;I&amp;#39;am cfengine 3 client&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åç¼–è¾‘promises.cfæ–‡ä»¶åŠ å…¥æ‰§è¡Œè¿™ä¸ªæ‰¿è¯ºæŸçš„æ”¯æŒ:&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/var/cfengine/masterfiles/promises.cf
body&lt;span class="w"&gt; &lt;/span&gt;common&lt;span class="w"&gt; &lt;/span&gt;control
&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;bundlesequence&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;main&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;test&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;&lt;span class="w"&gt;                                &lt;/span&gt;&lt;span class="c1"&gt;# å°†teståŠ å…¥çš„æ‰¿è¯ºæŸé˜Ÿåˆ—&lt;/span&gt;

&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;inputs&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;cfengine_stdlib.cf&amp;quot;&lt;/span&gt;,
&lt;span class="w"&gt;            &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;cftest1.cf&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt;                                             &lt;/span&gt;&lt;span class="c1"&gt;# å°†cftest1.cfå¼•å…¥è¿›æ¥&lt;/span&gt;
&lt;span class="w"&gt;           &lt;/span&gt;&lt;span class="o"&gt;}&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;

&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;version&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;Community Promises.cf 1.0.0&amp;quot;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt;
&lt;span class="o"&gt;}&lt;/span&gt;
.......
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;åšå¥½ä¹‹åå…ˆæœ¬åœ°åŒæ­¥,ç„¶åå¯åŠ¨server:&lt;/p&gt;
&lt;pre&gt;/var/cfengine/bin/cf-agent  --bootstrap --policy-server 172.16.1.1

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="err"&gt;åˆ°å¦‚ä¸‹æç¤ºè¡¨ç¤ºæˆåŠŸ&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;
&lt;span class="err"&gt;```&lt;/span&gt;&lt;span class="n"&gt;bash&lt;/span&gt;
&lt;span class="o"&gt;-&amp;gt;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Bootstrap&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;to&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mf"&gt;172.16.1.1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;completed&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;successfully&lt;/span&gt;
&lt;span class="n"&gt;netstat&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;antlp&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;|&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;grep&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;cf&lt;/span&gt;
&lt;span class="n"&gt;tcp&lt;/span&gt;&lt;span class="w"&gt;        &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;:::&lt;/span&gt;&lt;span class="mi"&gt;5308&lt;/span&gt;&lt;span class="w"&gt;                     &lt;/span&gt;&lt;span class="o"&gt;:::*&lt;/span&gt;&lt;span class="w"&gt;                        &lt;/span&gt;&lt;span class="n"&gt;LISTEN&lt;/span&gt;&lt;span class="w"&gt;      &lt;/span&gt;&lt;span class="mi"&gt;20173&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;cf&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;serverd&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


ç„¶åæ‰§è¡Œç­–ç•¥:

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;/var/cfengine/bin/cf-agent
R:&lt;span class="w"&gt; &lt;/span&gt;--&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;CFE&lt;span class="w"&gt; &lt;/span&gt;is&lt;span class="w"&gt; &lt;/span&gt;running&lt;span class="w"&gt; &lt;/span&gt;on&lt;span class="w"&gt; &lt;/span&gt;cfhub
R:&lt;span class="w"&gt; &lt;/span&gt;I&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;am&lt;span class="w"&gt; &lt;/span&gt;cfengine&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;3&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;client
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;



cfengineé»˜è®¤æ˜¯è®©æœ¬æœºåœ°å€çš„16ä½ç½‘ç»œè¿æ¥åŒæ­¥çš„,å¦‚æœæ–°åŠ å…¥ä¸€ä¸ªå¦ä¸€ç½‘æ®µçš„è®¾å¤‡å…è®¸åŒæ­¥,æ¯”å¦‚å…è®¸192.168.1.ç½‘æ®µåŒæ­¥,ç¼–è¾‘/var/cfengine/masterfiles/promises.cf,æ‰¾åˆ°bundle common def

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;vi&lt;span class="w"&gt; &lt;/span&gt;/var/cfengine/masterfiles/promises.cf
bundle&lt;span class="w"&gt; &lt;/span&gt;common&lt;span class="w"&gt; &lt;/span&gt;def
&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt; &lt;/span&gt;vars:&lt;span class="w"&gt;                                            &lt;/span&gt;&lt;span class="c1"&gt;# å®šä¹‰å˜é‡&lt;/span&gt;
&lt;span class="w"&gt;   &lt;/span&gt;...&lt;span class="w"&gt; &lt;/span&gt;...
&lt;span class="w"&gt;    &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;acl&amp;quot;&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nv"&gt;slist&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&amp;gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;{&lt;/span&gt;
&lt;span class="w"&gt;                &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;sys.policy_hub&lt;span class="k"&gt;)&lt;/span&gt;&lt;span class="s2"&gt;/16&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;192.168.1.&amp;quot;&lt;/span&gt;,&lt;span class="w"&gt;          &lt;/span&gt;&lt;span class="c1"&gt;# è¿™è¿™ä¸ªåé¢æ·»åŠ &lt;/span&gt;
&lt;span class="w"&gt;  &lt;/span&gt;...&lt;span class="w"&gt; &lt;/span&gt;...
&lt;span class="o"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


æœåŠ¡ç«¯åŸºæœ¬é…ç½®å®Œæˆ,å®¢æˆ·ç«¯(cfengine host),æŒ‰ç…§æœ¬æ–‡å‰é¢å®‰è£…çš„éƒ¨åˆ†è¿›è¡Œå®‰è£…,åˆ›å»ºå·¥ä½œç›®å½•,å¤åˆ¶äºŒè¿›åˆ¶æ–‡ä»¶,ä¸ç”¨åˆ›å»ºé…ç½®æ–‡ä»¶å’Œæ‰¿è¯º,ç„¶åæ‰§è¡Œ:

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;/var/cfengine/bin/cf-agent&lt;span class="w"&gt;  &lt;/span&gt;--bootstrap&lt;span class="w"&gt; &lt;/span&gt;--policy-server&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="m"&gt;172&lt;/span&gt;.16.1.1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


ä¼šå‡ºç°å’ŒæœåŠ¡å™¨æ‰§è¡Œä¸€æ ·çš„æç¤º,å°±è¡¨ç¤ºæˆåŠŸ,å¦‚æœæç¤ºè¿æ¥ä¸æˆåŠŸ,å°è¯•å…³é—­é˜²ç«å¢™.åŒæ­¥åæ‰§è¡Œæœ¬åœ°ç­–ç•¥:

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;/var/cfengine/bin/cf-agent
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;


cfengineå®˜æ–¹è¿˜æ˜¯å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒåŠ ä¸€ä¸ªç‰ˆæœ¬æ§åˆ¶å™¨ç”¨æ¥åˆ›å»ºæ‰¿è¯ºæ–‡ä»¶,ç„¶åç»™ç­–ç•¥åˆ†å‘ç‚¹ç”¨æ¥åˆ†å‘ç»™ç­–ç•¥æ‰§è¡Œç‚¹.æ›´å¤šcfengineçš„è¯­æ³•è¯·å‚è§æ‰‹å†Œ.</content><category term="Linux"></category><category term="è‡ªåŠ¨é…ç½®"></category><category term="è‡ªåŠ¨åŒ–"></category><category term="æœåŠ¡å™¨"></category><category term="Unix"></category><category term="Linux"></category><category term="cfengine"></category></entry><entry><title>Linux shellè„šæœ¬è°ƒè¯•æŠ€å·§</title><link href="https://www.linuxzen.com/linux-shelljiao-ben-diao-shi-ji-qiao.html" rel="alternate"></link><published>2012-01-17T17:04:00+08:00</published><updated>2012-01-17T17:04:00+08:00</updated><author><name>cold</name></author><id>tag:www.linuxzen.com,2012-01-17:/linux-shelljiao-ben-diao-shi-ji-qiao.html</id><summary type="html">&lt;p&gt;æœ‰æ—¶å€™shellè„šæœ¬ä¸ä¼šç»™äºˆæ˜æ˜¾çš„è°ƒè¯•ä¿¡æ¯,è€Œä¸”æœ‰æ—¶ä¸æŠ¥é”™,ä½†æ˜¯è„šæœ¬æ²¡æœ‰è¾¾åˆ°é¢„æœŸçš„æ•ˆæœè¿™æ—¶å€™è„šæœ¬è°ƒè¯•å°±å¯ä»¥å¸®ä½ å‡†ç¡®å®šä½é”™è¯¯.&lt;/p&gt;
&lt;p&gt;åœ¨è„šæœ¬çš„æœ€é¡¶éƒ¨åŠ  â€¦&lt;/p&gt;</summary><content type="html">&lt;p&gt;æœ‰æ—¶å€™shellè„šæœ¬ä¸ä¼šç»™äºˆæ˜æ˜¾çš„è°ƒè¯•ä¿¡æ¯,è€Œä¸”æœ‰æ—¶ä¸æŠ¥é”™,ä½†æ˜¯è„šæœ¬æ²¡æœ‰è¾¾åˆ°é¢„æœŸçš„æ•ˆæœè¿™æ—¶å€™è„šæœ¬è°ƒè¯•å°±å¯ä»¥å¸®ä½ å‡†ç¡®å®šä½é”™è¯¯.&lt;/p&gt;
&lt;p&gt;åœ¨è„šæœ¬çš„æœ€é¡¶éƒ¨åŠ ä¸Š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;-x
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å¼€å¯è°ƒè¯•
åœ¨è„šæœ¬çš„æœ€åº•éƒ¨åŠ ä¸Š&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;set&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;+x
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;å…³é—­è°ƒè¯•
å¦‚æœåœ¨ç»ˆç«¯ç•Œé¢ä¸‹,è°ƒè¯•ä¿¡æ¯è¿‡å¤š,è°ƒè¯•ä¿¡æ¯æ˜¯æ— æ³•é‡å®šå‘åˆ°æ–‡ä»¶çš„,æ‰€ä»¥è¯¥æ€æ ·æŸ¥çœ‹è°ƒè¯•å‘¢,å½“ç„¶è¿™å¯¹SecureCRTè¿æ¥çš„å½“ç„¶ä¸æ˜¯é—®é¢˜,ä½†æ˜¯å¦‚æœæ˜¯ç»ˆç«¯ç•Œé¢çš„è¯,å¯ä»¥ä½¿ç”¨å‘½ä»¤&lt;/p&gt;
&lt;p&gt;&amp;nbsp;&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;script
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;ç„¶åæ‰§è¡Œè¦æ•æ‰å†…å®¹çš„å‘½ä»¤,å®Œæˆåé€šè¿‡&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;exit&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;é€€å‡º,å½“å‰ç›®å½•ä¸‹ä¼šç”Ÿæˆtypescript,é€šè¿‡&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;more&lt;span class="w"&gt; &lt;/span&gt;typescript
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;æŸ¥çœ‹è°ƒè¯•å‘½ä»¤.&lt;/p&gt;</content><category term="Linux"></category><category term="è°ƒè¯•"></category><category term="æŠ€å·§"></category><category term="shell"></category><category term="Linux"></category></entry></feed>